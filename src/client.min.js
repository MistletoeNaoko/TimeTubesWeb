!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=362)}([function(t,e,n){"use strict";t.exports=n(185)},function(t,e,n){"use strict";n.r(e),n.d(e,"ACESFilmicToneMapping",(function(){return at})),n.d(e,"AddEquation",(function(){return T})),n.d(e,"AddOperation",(function(){return K})),n.d(e,"AdditiveAnimationBlendMode",(function(){return Ye})),n.d(e,"AdditiveBlending",(function(){return S})),n.d(e,"AlphaFormat",(function(){return Ft})),n.d(e,"AlwaysDepth",(function(){return G})),n.d(e,"AlwaysStencilFunc",(function(){return Tn})),n.d(e,"AmbientLight",(function(){return _h})),n.d(e,"AmbientLightProbe",(function(){return Gh})),n.d(e,"AnimationClip",(function(){return kc})),n.d(e,"AnimationLoader",(function(){return Dc})),n.d(e,"AnimationMixer",(function(){return xd})),n.d(e,"AnimationObjectGroup",(function(){return yd})),n.d(e,"AnimationUtils",(function(){return mc})),n.d(e,"ArcCurve",(function(){return Gc})),n.d(e,"ArrayCamera",(function(){return As})),n.d(e,"ArrowHelper",(function(){return uf})),n.d(e,"Audio",(function(){return td})),n.d(e,"AudioAnalyser",(function(){return od})),n.d(e,"AudioContext",(function(){return jh})),n.d(e,"AudioListener",(function(){return Kh})),n.d(e,"AudioLoader",(function(){return Uh})),n.d(e,"AxesHelper",(function(){return cf})),n.d(e,"AxisHelper",(function(){return ap})),n.d(e,"BackSide",(function(){return v})),n.d(e,"BasicDepthPacking",(function(){return ln})),n.d(e,"BasicShadowMap",(function(){return d})),n.d(e,"BinaryTextureLoader",(function(){return cp})),n.d(e,"Bone",(function(){return pl})),n.d(e,"BooleanKeyframeTrack",(function(){return _c})),n.d(e,"BoundingBoxHelper",(function(){return op})),n.d(e,"Box2",(function(){return Pd})),n.d(e,"Box3",(function(){return Vi})),n.d(e,"Box3Helper",(function(){return rf})),n.d(e,"BoxBufferGeometry",(function(){return va})),n.d(e,"BoxGeometry",(function(){return ga})),n.d(e,"BoxHelper",(function(){return nf})),n.d(e,"BufferAttribute",(function(){return Mr})),n.d(e,"BufferGeometry",(function(){return Gr})),n.d(e,"BufferGeometryLoader",(function(){return Ph})),n.d(e,"ByteType",(function(){return kt})),n.d(e,"Cache",(function(){return Ac})),n.d(e,"Camera",(function(){return wa})),n.d(e,"CameraHelper",(function(){return Kd})),n.d(e,"CanvasRenderer",(function(){return fp})),n.d(e,"CanvasTexture",(function(){return Vl})),n.d(e,"CatmullRomCurve3",(function(){return Xc})),n.d(e,"CineonToneMapping",(function(){return rt})),n.d(e,"CircleBufferGeometry",(function(){return nc})),n.d(e,"CircleGeometry",(function(){return ec})),n.d(e,"ClampToEdgeWrapping",(function(){return mt})),n.d(e,"Clock",(function(){return Qh})),n.d(e,"ClosedSplineCurve3",(function(){return np})),n.d(e,"Color",(function(){return gr})),n.d(e,"ColorKeyframeTrack",(function(){return wc})),n.d(e,"CompressedTexture",(function(){return Fl})),n.d(e,"CompressedTextureLoader",(function(){return zc})),n.d(e,"ConeBufferGeometry",(function(){return tc})),n.d(e,"ConeGeometry",(function(){return Ku})),n.d(e,"CubeCamera",(function(){return Ea})),n.d(e,"CubeGeometry",(function(){return ga})),n.d(e,"CubeReflectionMapping",(function(){return st})),n.d(e,"CubeRefractionMapping",(function(){return lt})),n.d(e,"CubeTexture",(function(){return Qa})),n.d(e,"CubeTextureLoader",(function(){return Vc})),n.d(e,"CubeUVReflectionMapping",(function(){return dt})),n.d(e,"CubeUVRefractionMapping",(function(){return ft})),n.d(e,"CubicBezierCurve",(function(){return th})),n.d(e,"CubicBezierCurve3",(function(){return eh})),n.d(e,"CubicInterpolant",(function(){return vc})),n.d(e,"CullFaceBack",(function(){return s})),n.d(e,"CullFaceFront",(function(){return l})),n.d(e,"CullFaceFrontBack",(function(){return u})),n.d(e,"CullFaceNone",(function(){return o})),n.d(e,"Curve",(function(){return Uc})),n.d(e,"CurvePath",(function(){return lh})),n.d(e,"CustomBlending",(function(){return C})),n.d(e,"CylinderBufferGeometry",(function(){return Ju})),n.d(e,"CylinderGeometry",(function(){return Zu})),n.d(e,"Cylindrical",(function(){return Td})),n.d(e,"DataTexture",(function(){return Ca})),n.d(e,"DataTexture2DArray",(function(){return Ya})),n.d(e,"DataTexture3D",(function(){return Xa})),n.d(e,"DataTextureLoader",(function(){return Bc})),n.d(e,"DecrementStencilOp",(function(){return gn})),n.d(e,"DecrementWrapStencilOp",(function(){return yn})),n.d(e,"DefaultLoadingManager",(function(){return Lc})),n.d(e,"DepthFormat",(function(){return Wt})),n.d(e,"DepthStencilFormat",(function(){return qt})),n.d(e,"DepthTexture",(function(){return jl})),n.d(e,"DirectionalLight",(function(){return xh})),n.d(e,"DirectionalLightHelper",(function(){return Xd})),n.d(e,"DirectionalLightShadow",(function(){return bh})),n.d(e,"DiscreteInterpolant",(function(){return bc})),n.d(e,"DodecahedronBufferGeometry",(function(){return tu})),n.d(e,"DodecahedronGeometry",(function(){return Kl})),n.d(e,"DoubleSide",(function(){return y})),n.d(e,"DstAlphaFactor",(function(){return B})),n.d(e,"DstColorFactor",(function(){return V})),n.d(e,"DynamicBufferAttribute",(function(){return qf})),n.d(e,"DynamicCopyUsage",(function(){return Nn})),n.d(e,"DynamicDrawUsage",(function(){return Pn})),n.d(e,"DynamicReadUsage",(function(){return Ln})),n.d(e,"EdgesGeometry",(function(){return Xu})),n.d(e,"EdgesHelper",(function(){return sp})),n.d(e,"EllipseCurve",(function(){return Hc})),n.d(e,"EqualDepth",(function(){return $})),n.d(e,"EqualStencilFunc",(function(){return wn})),n.d(e,"EquirectangularReflectionMapping",(function(){return ut})),n.d(e,"EquirectangularRefractionMapping",(function(){return ct})),n.d(e,"Euler",(function(){return ci})),n.d(e,"EventDispatcher",(function(){return zn})),n.d(e,"ExtrudeBufferGeometry",(function(){return Du})),n.d(e,"ExtrudeGeometry",(function(){return Nu})),n.d(e,"Face3",(function(){return xr})),n.d(e,"Face4",(function(){return Of})),n.d(e,"FaceColors",(function(){return Nf})),n.d(e,"FileLoader",(function(){return Nc})),n.d(e,"FlatShading",(function(){return b})),n.d(e,"Float32Attribute",(function(){return tp})),n.d(e,"Float32BufferAttribute",(function(){return Rr})),n.d(e,"Float64Attribute",(function(){return ep})),n.d(e,"Float64BufferAttribute",(function(){return Ir})),n.d(e,"FloatType",(function(){return Rt})),n.d(e,"Fog",(function(){return Ds})),n.d(e,"FogExp2",(function(){return Ns})),n.d(e,"Font",(function(){return Bh})),n.d(e,"FontLoader",(function(){return Vh})),n.d(e,"FrontFaceDirectionCCW",(function(){return h})),n.d(e,"FrontFaceDirectionCW",(function(){return c})),n.d(e,"FrontSide",(function(){return g})),n.d(e,"Frustum",(function(){return Pa})),n.d(e,"GammaEncoding",(function(){return en})),n.d(e,"Geometry",(function(){return ma})),n.d(e,"GeometryUtils",(function(){return dp})),n.d(e,"GreaterDepth",(function(){return Y})),n.d(e,"GreaterEqualDepth",(function(){return Q})),n.d(e,"GreaterEqualStencilFunc",(function(){return Cn})),n.d(e,"GreaterStencilFunc",(function(){return En})),n.d(e,"GridHelper",(function(){return Wd})),n.d(e,"Group",(function(){return Os})),n.d(e,"HalfFloatType",(function(){return It})),n.d(e,"HemisphereLight",(function(){return dh})),n.d(e,"HemisphereLightHelper",(function(){return Gd})),n.d(e,"HemisphereLightProbe",(function(){return Hh})),n.d(e,"IcosahedronBufferGeometry",(function(){return Jl})),n.d(e,"IcosahedronGeometry",(function(){return Zl})),n.d(e,"ImageBitmapLoader",(function(){return Dh})),n.d(e,"ImageLoader",(function(){return Fc})),n.d(e,"ImageUtils",(function(){return Gn})),n.d(e,"ImmediateRenderObject",(function(){return Rd})),n.d(e,"IncrementStencilOp",(function(){return mn})),n.d(e,"IncrementWrapStencilOp",(function(){return vn})),n.d(e,"InstancedBufferAttribute",(function(){return kh})),n.d(e,"InstancedBufferGeometry",(function(){return Th})),n.d(e,"InstancedInterleavedBuffer",(function(){return wd})),n.d(e,"InstancedMesh",(function(){return bl})),n.d(e,"Int16Attribute",(function(){return Xf})),n.d(e,"Int16BufferAttribute",(function(){return Pr})),n.d(e,"Int32Attribute",(function(){return Jf})),n.d(e,"Int32BufferAttribute",(function(){return Or})),n.d(e,"Int8Attribute",(function(){return $f})),n.d(e,"Int8BufferAttribute",(function(){return Cr})),n.d(e,"IntType",(function(){return Ot})),n.d(e,"InterleavedBuffer",(function(){return zs})),n.d(e,"InterleavedBufferAttribute",(function(){return Vs})),n.d(e,"Interpolant",(function(){return gc})),n.d(e,"InterpolateDiscrete",(function(){return Ue})),n.d(e,"InterpolateLinear",(function(){return He})),n.d(e,"InterpolateSmooth",(function(){return Ge})),n.d(e,"InvertStencilOp",(function(){return bn})),n.d(e,"JSONLoader",(function(){return pp})),n.d(e,"KeepStencilOp",(function(){return fn})),n.d(e,"KeyframeTrack",(function(){return xc})),n.d(e,"LOD",(function(){return ul})),n.d(e,"LatheBufferGeometry",(function(){return qu})),n.d(e,"LatheGeometry",(function(){return Wu})),n.d(e,"Layers",(function(){return hi})),n.d(e,"LensFlare",(function(){return gp})),n.d(e,"LessDepth",(function(){return W})),n.d(e,"LessEqualDepth",(function(){return q})),n.d(e,"LessEqualStencilFunc",(function(){return Sn})),n.d(e,"LessStencilFunc",(function(){return _n})),n.d(e,"Light",(function(){return hh})),n.d(e,"LightProbe",(function(){return Eh})),n.d(e,"LightShadow",(function(){return fh})),n.d(e,"Line",(function(){return Cl})),n.d(e,"Line3",(function(){return Ld})),n.d(e,"LineBasicMaterial",(function(){return xl})),n.d(e,"LineCurve",(function(){return nh})),n.d(e,"LineCurve3",(function(){return ih})),n.d(e,"LineDashedMaterial",(function(){return fc})),n.d(e,"LineLoop",(function(){return Al})),n.d(e,"LinePieces",(function(){return Rf})),n.d(e,"LineSegments",(function(){return Pl})),n.d(e,"LineStrip",(function(){return Lf})),n.d(e,"LinearEncoding",(function(){return Ke})),n.d(e,"LinearFilter",(function(){return wt})),n.d(e,"LinearInterpolant",(function(){return yc})),n.d(e,"LinearMipMapLinearFilter",(function(){return Ct})),n.d(e,"LinearMipMapNearestFilter",(function(){return Et})),n.d(e,"LinearMipmapLinearFilter",(function(){return Mt})),n.d(e,"LinearMipmapNearestFilter",(function(){return St})),n.d(e,"LinearToneMapping",(function(){return et})),n.d(e,"Loader",(function(){return Rc})),n.d(e,"LoaderUtils",(function(){return Ch})),n.d(e,"LoadingManager",(function(){return Oc})),n.d(e,"LogLuvEncoding",(function(){return rn})),n.d(e,"LoopOnce",(function(){return Fe})),n.d(e,"LoopPingPong",(function(){return je})),n.d(e,"LoopRepeat",(function(){return Ve})),n.d(e,"LuminanceAlphaFormat",(function(){return Ht})),n.d(e,"LuminanceFormat",(function(){return Ut})),n.d(e,"MOUSE",(function(){return r})),n.d(e,"Material",(function(){return wr})),n.d(e,"MaterialLoader",(function(){return Mh})),n.d(e,"Math",(function(){return jn})),n.d(e,"MathUtils",(function(){return jn})),n.d(e,"Matrix3",(function(){return Hn})),n.d(e,"Matrix4",(function(){return si})),n.d(e,"MaxEquation",(function(){return O})),n.d(e,"Mesh",(function(){return la})),n.d(e,"MeshBasicMaterial",(function(){return Sr})),n.d(e,"MeshDepthMaterial",(function(){return Es})),n.d(e,"MeshDistanceMaterial",(function(){return Ms})),n.d(e,"MeshFaceMaterial",(function(){return zf})),n.d(e,"MeshLambertMaterial",(function(){return hc})),n.d(e,"MeshMatcapMaterial",(function(){return dc})),n.d(e,"MeshNormalMaterial",(function(){return cc})),n.d(e,"MeshPhongMaterial",(function(){return lc})),n.d(e,"MeshPhysicalMaterial",(function(){return sc})),n.d(e,"MeshStandardMaterial",(function(){return oc})),n.d(e,"MeshToonMaterial",(function(){return uc})),n.d(e,"MinEquation",(function(){return A})),n.d(e,"MirroredRepeatWrapping",(function(){return gt})),n.d(e,"MixOperation",(function(){return J})),n.d(e,"MultiMaterial",(function(){return Bf})),n.d(e,"MultiplyBlending",(function(){return M})),n.d(e,"MultiplyOperation",(function(){return Z})),n.d(e,"NearestFilter",(function(){return vt})),n.d(e,"NearestMipMapLinearFilter",(function(){return _t})),n.d(e,"NearestMipMapNearestFilter",(function(){return bt})),n.d(e,"NearestMipmapLinearFilter",(function(){return xt})),n.d(e,"NearestMipmapNearestFilter",(function(){return yt})),n.d(e,"NeverDepth",(function(){return H})),n.d(e,"NeverStencilFunc",(function(){return xn})),n.d(e,"NoBlending",(function(){return _})),n.d(e,"NoColors",(function(){return If})),n.d(e,"NoToneMapping",(function(){return tt})),n.d(e,"NormalAnimationBlendMode",(function(){return Qe})),n.d(e,"NormalBlending",(function(){return w})),n.d(e,"NotEqualDepth",(function(){return X})),n.d(e,"NotEqualStencilFunc",(function(){return Mn})),n.d(e,"NumberKeyframeTrack",(function(){return Sc})),n.d(e,"Object3D",(function(){return Mi})),n.d(e,"ObjectLoader",(function(){return Oh})),n.d(e,"ObjectSpaceNormalMap",(function(){return hn})),n.d(e,"OctahedronBufferGeometry",(function(){return Xl})),n.d(e,"OctahedronGeometry",(function(){return Yl})),n.d(e,"OneFactor",(function(){return R})),n.d(e,"OneMinusDstAlphaFactor",(function(){return F})),n.d(e,"OneMinusDstColorFactor",(function(){return j})),n.d(e,"OneMinusSrcAlphaFactor",(function(){return z})),n.d(e,"OneMinusSrcColorFactor",(function(){return N})),n.d(e,"OrthographicCamera",(function(){return yh})),n.d(e,"PCFShadowMap",(function(){return f})),n.d(e,"PCFSoftShadowMap",(function(){return p})),n.d(e,"PMREMGenerator",(function(){return Sf})),n.d(e,"ParametricBufferGeometry",(function(){return Gl})),n.d(e,"ParametricGeometry",(function(){return Hl})),n.d(e,"Particle",(function(){return Vf})),n.d(e,"ParticleBasicMaterial",(function(){return Hf})),n.d(e,"ParticleSystem",(function(){return jf})),n.d(e,"ParticleSystemMaterial",(function(){return Gf})),n.d(e,"Path",(function(){return uh})),n.d(e,"PerspectiveCamera",(function(){return Sa})),n.d(e,"Plane",(function(){return er})),n.d(e,"PlaneBufferGeometry",(function(){return Ia})),n.d(e,"PlaneGeometry",(function(){return Ra})),n.d(e,"PlaneHelper",(function(){return af})),n.d(e,"PointCloud",(function(){return Ff})),n.d(e,"PointCloudMaterial",(function(){return Uf})),n.d(e,"PointLight",(function(){return vh})),n.d(e,"PointLightHelper",(function(){return Vd})),n.d(e,"Points",(function(){return Dl})),n.d(e,"PointsMaterial",(function(){return Ol})),n.d(e,"PolarGridHelper",(function(){return qd})),n.d(e,"PolyhedronBufferGeometry",(function(){return ql})),n.d(e,"PolyhedronGeometry",(function(){return Wl})),n.d(e,"PositionalAudio",(function(){return ad})),n.d(e,"PropertyBinding",(function(){return vd})),n.d(e,"PropertyMixer",(function(){return sd})),n.d(e,"QuadraticBezierCurve",(function(){return rh})),n.d(e,"QuadraticBezierCurve3",(function(){return ah})),n.d(e,"Quaternion",(function(){return Xn})),n.d(e,"QuaternionKeyframeTrack",(function(){return Mc})),n.d(e,"QuaternionLinearInterpolant",(function(){return Ec})),n.d(e,"REVISION",(function(){return i})),n.d(e,"RGBADepthPacking",(function(){return un})),n.d(e,"RGBAFormat",(function(){return jt})),n.d(e,"RGBAIntegerFormat",(function(){return Jt})),n.d(e,"RGBA_ASTC_10x10_Format",(function(){return _e})),n.d(e,"RGBA_ASTC_10x5_Format",(function(){return ye})),n.d(e,"RGBA_ASTC_10x6_Format",(function(){return be})),n.d(e,"RGBA_ASTC_10x8_Format",(function(){return xe})),n.d(e,"RGBA_ASTC_12x10_Format",(function(){return we})),n.d(e,"RGBA_ASTC_12x12_Format",(function(){return Se})),n.d(e,"RGBA_ASTC_4x4_Format",(function(){return ce})),n.d(e,"RGBA_ASTC_5x4_Format",(function(){return he})),n.d(e,"RGBA_ASTC_5x5_Format",(function(){return de})),n.d(e,"RGBA_ASTC_6x5_Format",(function(){return fe})),n.d(e,"RGBA_ASTC_6x6_Format",(function(){return pe})),n.d(e,"RGBA_ASTC_8x5_Format",(function(){return me})),n.d(e,"RGBA_ASTC_8x6_Format",(function(){return ge})),n.d(e,"RGBA_ASTC_8x8_Format",(function(){return ve})),n.d(e,"RGBA_BPTC_Format",(function(){return Ee})),n.d(e,"RGBA_ETC2_EAC_Format",(function(){return ue})),n.d(e,"RGBA_PVRTC_2BPPV1_Format",(function(){return oe})),n.d(e,"RGBA_PVRTC_4BPPV1_Format",(function(){return ae})),n.d(e,"RGBA_S3TC_DXT1_Format",(function(){return te})),n.d(e,"RGBA_S3TC_DXT3_Format",(function(){return ee})),n.d(e,"RGBA_S3TC_DXT5_Format",(function(){return ne})),n.d(e,"RGBDEncoding",(function(){return sn})),n.d(e,"RGBEEncoding",(function(){return nn})),n.d(e,"RGBEFormat",(function(){return Gt})),n.d(e,"RGBFormat",(function(){return Vt})),n.d(e,"RGBIntegerFormat",(function(){return Zt})),n.d(e,"RGBM16Encoding",(function(){return on})),n.d(e,"RGBM7Encoding",(function(){return an})),n.d(e,"RGB_ETC1_Format",(function(){return se})),n.d(e,"RGB_ETC2_Format",(function(){return le})),n.d(e,"RGB_PVRTC_2BPPV1_Format",(function(){return re})),n.d(e,"RGB_PVRTC_4BPPV1_Format",(function(){return ie})),n.d(e,"RGB_S3TC_DXT1_Format",(function(){return Kt})),n.d(e,"RGFormat",(function(){return Yt})),n.d(e,"RGIntegerFormat",(function(){return Xt})),n.d(e,"RawShaderMaterial",(function(){return ac})),n.d(e,"Ray",(function(){return Zi})),n.d(e,"Raycaster",(function(){return Sd})),n.d(e,"RectAreaLight",(function(){return wh})),n.d(e,"RedFormat",(function(){return $t})),n.d(e,"RedIntegerFormat",(function(){return Qt})),n.d(e,"ReinhardToneMapping",(function(){return nt})),n.d(e,"RepeatWrapping",(function(){return pt})),n.d(e,"ReplaceStencilOp",(function(){return pn})),n.d(e,"ReverseSubtractEquation",(function(){return P})),n.d(e,"RingBufferGeometry",(function(){return Gu})),n.d(e,"RingGeometry",(function(){return Hu})),n.d(e,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return De})),n.d(e,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Re})),n.d(e,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return Ie})),n.d(e,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Ne})),n.d(e,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return ze})),n.d(e,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Be})),n.d(e,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Me})),n.d(e,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Ce})),n.d(e,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return Te})),n.d(e,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return ke})),n.d(e,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Pe})),n.d(e,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return Ae})),n.d(e,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Oe})),n.d(e,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Le})),n.d(e,"Scene",(function(){return Ci})),n.d(e,"SceneUtils",(function(){return mp})),n.d(e,"ShaderChunk",(function(){return Na})),n.d(e,"ShaderLib",(function(){return Da})),n.d(e,"ShaderMaterial",(function(){return _a})),n.d(e,"ShadowMaterial",(function(){return rc})),n.d(e,"Shape",(function(){return ch})),n.d(e,"ShapeBufferGeometry",(function(){return Qu})),n.d(e,"ShapeGeometry",(function(){return $u})),n.d(e,"ShapePath",(function(){return zh})),n.d(e,"ShapeUtils",(function(){return Lu})),n.d(e,"ShortType",(function(){return Pt})),n.d(e,"Skeleton",(function(){return fl})),n.d(e,"SkeletonHelper",(function(){return Fd})),n.d(e,"SkinnedMesh",(function(){return cl})),n.d(e,"SmoothShading",(function(){return x})),n.d(e,"Sphere",(function(){return Hi})),n.d(e,"SphereBufferGeometry",(function(){return Uu})),n.d(e,"SphereGeometry",(function(){return ju})),n.d(e,"Spherical",(function(){return Cd})),n.d(e,"SphericalHarmonics3",(function(){return Sh})),n.d(e,"SphericalReflectionMapping",(function(){return ht})),n.d(e,"Spline",(function(){return rp})),n.d(e,"SplineCurve",(function(){return oh})),n.d(e,"SplineCurve3",(function(){return ip})),n.d(e,"SpotLight",(function(){return mh})),n.d(e,"SpotLightHelper",(function(){return Nd})),n.d(e,"SpotLightShadow",(function(){return ph})),n.d(e,"Sprite",(function(){return tl})),n.d(e,"SpriteMaterial",(function(){return js})),n.d(e,"SrcAlphaFactor",(function(){return D})),n.d(e,"SrcAlphaSaturateFactor",(function(){return U})),n.d(e,"SrcColorFactor",(function(){return I})),n.d(e,"StaticCopyUsage",(function(){return In})),n.d(e,"StaticDrawUsage",(function(){return kn})),n.d(e,"StaticReadUsage",(function(){return On})),n.d(e,"StereoCamera",(function(){return $h})),n.d(e,"StreamCopyUsage",(function(){return Dn})),n.d(e,"StreamDrawUsage",(function(){return An})),n.d(e,"StreamReadUsage",(function(){return Rn})),n.d(e,"StringKeyframeTrack",(function(){return Cc})),n.d(e,"SubtractEquation",(function(){return k})),n.d(e,"SubtractiveBlending",(function(){return E})),n.d(e,"TOUCH",(function(){return a})),n.d(e,"TangentSpaceNormalMap",(function(){return cn})),n.d(e,"TetrahedronBufferGeometry",(function(){return Ql})),n.d(e,"TetrahedronGeometry",(function(){return $l})),n.d(e,"TextBufferGeometry",(function(){return Vu})),n.d(e,"TextGeometry",(function(){return Fu})),n.d(e,"Texture",(function(){return qn})),n.d(e,"TextureLoader",(function(){return jc})),n.d(e,"TorusBufferGeometry",(function(){return ou})),n.d(e,"TorusGeometry",(function(){return au})),n.d(e,"TorusKnotBufferGeometry",(function(){return ru})),n.d(e,"TorusKnotGeometry",(function(){return iu})),n.d(e,"Triangle",(function(){return dr})),n.d(e,"TriangleFanDrawMode",(function(){return Je})),n.d(e,"TriangleStripDrawMode",(function(){return Ze})),n.d(e,"TrianglesDrawMode",(function(){return Xe})),n.d(e,"TubeBufferGeometry",(function(){return nu})),n.d(e,"TubeGeometry",(function(){return eu})),n.d(e,"UVMapping",(function(){return ot})),n.d(e,"Uint16Attribute",(function(){return Zf})),n.d(e,"Uint16BufferAttribute",(function(){return Ar})),n.d(e,"Uint32Attribute",(function(){return Kf})),n.d(e,"Uint32BufferAttribute",(function(){return Lr})),n.d(e,"Uint8Attribute",(function(){return Qf})),n.d(e,"Uint8BufferAttribute",(function(){return Tr})),n.d(e,"Uint8ClampedAttribute",(function(){return Yf})),n.d(e,"Uint8ClampedBufferAttribute",(function(){return kr})),n.d(e,"Uncharted2ToneMapping",(function(){return it})),n.d(e,"Uniform",(function(){return _d})),n.d(e,"UniformsLib",(function(){return Aa})),n.d(e,"UniformsUtils",(function(){return xa})),n.d(e,"UnsignedByteType",(function(){return Tt})),n.d(e,"UnsignedInt248Type",(function(){return Bt})),n.d(e,"UnsignedIntType",(function(){return Lt})),n.d(e,"UnsignedShort4444Type",(function(){return Nt})),n.d(e,"UnsignedShort5551Type",(function(){return Dt})),n.d(e,"UnsignedShort565Type",(function(){return zt})),n.d(e,"UnsignedShortType",(function(){return At})),n.d(e,"VSMShadowMap",(function(){return m})),n.d(e,"Vector2",(function(){return Un})),n.d(e,"Vector3",(function(){return Kn})),n.d(e,"Vector4",(function(){return $n})),n.d(e,"VectorKeyframeTrack",(function(){return Tc})),n.d(e,"Vertex",(function(){return Wf})),n.d(e,"VertexColors",(function(){return Df})),n.d(e,"VideoTexture",(function(){return Bl})),n.d(e,"WebGLCubeRenderTarget",(function(){return Ma})),n.d(e,"WebGLMultisampleRenderTarget",(function(){return Yn})),n.d(e,"WebGLRenderTarget",(function(){return Qn})),n.d(e,"WebGLRenderTargetCube",(function(){return hp})),n.d(e,"WebGLRenderer",(function(){return Is})),n.d(e,"WebGLUtils",(function(){return Ps})),n.d(e,"WireframeGeometry",(function(){return Ul})),n.d(e,"WireframeHelper",(function(){return lp})),n.d(e,"WrapAroundEnding",(function(){return $e})),n.d(e,"XHRLoader",(function(){return up})),n.d(e,"ZeroCurvatureEnding",(function(){return We})),n.d(e,"ZeroFactor",(function(){return L})),n.d(e,"ZeroSlopeEnding",(function(){return qe})),n.d(e,"ZeroStencilOp",(function(){return dn})),n.d(e,"sRGBEncoding",(function(){return tn})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e});var i="116",r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,s=1,l=2,u=3,c=0,h=1,d=0,f=1,p=2,m=3,g=0,v=1,y=2,b=1,x=2,_=0,w=1,S=2,E=3,M=4,C=5,T=100,k=101,P=102,A=103,O=104,L=200,R=201,I=202,N=203,D=204,z=205,B=206,F=207,V=208,j=209,U=210,H=0,G=1,W=2,q=3,$=4,Q=5,Y=6,X=7,Z=0,J=1,K=2,tt=0,et=1,nt=2,it=3,rt=4,at=5,ot=300,st=301,lt=302,ut=303,ct=304,ht=305,dt=306,ft=307,pt=1e3,mt=1001,gt=1002,vt=1003,yt=1004,bt=1004,xt=1005,_t=1005,wt=1006,St=1007,Et=1007,Mt=1008,Ct=1008,Tt=1009,kt=1010,Pt=1011,At=1012,Ot=1013,Lt=1014,Rt=1015,It=1016,Nt=1017,Dt=1018,zt=1019,Bt=1020,Ft=1021,Vt=1022,jt=1023,Ut=1024,Ht=1025,Gt=jt,Wt=1026,qt=1027,$t=1028,Qt=1029,Yt=1030,Xt=1031,Zt=1032,Jt=1033,Kt=33776,te=33777,ee=33778,ne=33779,ie=35840,re=35841,ae=35842,oe=35843,se=36196,le=37492,ue=37496,ce=37808,he=37809,de=37810,fe=37811,pe=37812,me=37813,ge=37814,ve=37815,ye=37816,be=37817,xe=37818,_e=37819,we=37820,Se=37821,Ee=36492,Me=37840,Ce=37841,Te=37842,ke=37843,Pe=37844,Ae=37845,Oe=37846,Le=37847,Re=37848,Ie=37849,Ne=37850,De=37851,ze=37852,Be=37853,Fe=2200,Ve=2201,je=2202,Ue=2300,He=2301,Ge=2302,We=2400,qe=2401,$e=2402,Qe=2500,Ye=2501,Xe=0,Ze=1,Je=2,Ke=3e3,tn=3001,en=3007,nn=3002,rn=3003,an=3004,on=3005,sn=3006,ln=3200,un=3201,cn=0,hn=1,dn=0,fn=7680,pn=7681,mn=7682,gn=7683,vn=34055,yn=34056,bn=5386,xn=512,_n=513,wn=514,Sn=515,En=516,Mn=517,Cn=518,Tn=519,kn=35044,Pn=35048,An=35040,On=35045,Ln=35049,Rn=35041,In=35046,Nn=35050,Dn=35042;function zn(){}Object.assign(zn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t)}}}});for(var Bn=[],Fn=0;Fn<256;Fn++)Bn[Fn]=(Fn<16?"0":"")+Fn.toString(16);var Vn,jn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Bn[255&t]+Bn[t>>8&255]+Bn[t>>16&255]+Bn[t>>24&255]+"-"+Bn[255&e]+Bn[e>>8&255]+"-"+Bn[e>>16&15|64]+Bn[e>>24&255]+"-"+Bn[63&n|128]+Bn[n>>8&255]+"-"+Bn[n>>16&255]+Bn[n>>24&255]+Bn[255&i]+Bn[i>>8&255]+Bn[i>>16&255]+Bn[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*jn.DEG2RAD},radToDeg:function(t){return t*jn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((e+i)/2),c=o((e+i)/2),h=a((e-i)/2),d=o((e-i)/2),f=a((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(s*c,l*h,l*d,s*u);break;case"YZY":t.set(l*d,s*c,l*h,s*u);break;case"ZXZ":t.set(l*h,l*d,s*c,s*u);break;case"XZX":t.set(s*c,l*p,l*f,s*u);break;case"YXY":t.set(l*f,s*c,l*p,s*u);break;case"ZYZ":t.set(l*p,l*f,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};function Un(t,e){this.x=t||0,this.y=e||0}function Hn(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Un.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Un.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*n-a*i+t.x,this.y=r*i+a*n+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Hn.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=i,u[2]=o,u[3]=e,u[4]=r,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],b=i[7],x=i[2],_=i[5],w=i[8];return r[0]=a*p+o*v+s*x,r[3]=a*m+o*y+s*_,r[6]=a*g+o*b+s*w,r[1]=l*p+u*v+c*x,r[4]=l*m+u*y+c*_,r[7]=l*g+u*b+c*w,r[2]=h*p+d*v+f*x,r[5]=h*m+d*y+f*_,r[8]=h*g+d*b+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*a*u-e*o*l-n*r*u+n*o*s+i*r*l-i*a*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,i=this.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=d*l-u*h,p=u*c-d*s,m=h*s-l*c,g=r*f+a*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var v=1/g;return i[0]=f*v,i[1]=(o*h-d*a)*v,i[2]=(u*a-o*l)*v,i[3]=p*v,i[4]=(d*r-o*c)*v,i[5]=(o*s-u*r)*v,i[6]=m*v,i[7]=(a*c-h*r)*v,i[8]=(l*r-a*s)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,i,r,a,o){var s=Math.cos(r),l=Math.sin(r);this.set(n*s,n*l,-n*(s*a+l*o)+a+t,-i*l,i*s,-i*(-l*a+s*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],u=i[7];return i[0]=e*r+n*s,i[3]=e*a+n*l,i[6]=e*o+n*u,i[1]=-n*r+e*s,i[4]=-n*a+e*l,i[7]=-n*o+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Gn={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Vn&&(Vn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Vn.width=t.width,Vn.height=t.height;var n=Vn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Vn}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},Wn=0;function qn(t,e,n,i,r,a,o,s,l,u){Object.defineProperty(this,"id",{value:Wn++}),this.uuid=jn.generateUUID(),this.name="",this.image=void 0!==t?t:qn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:qn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:mt,this.wrapT=void 0!==i?i:mt,this.magFilter=void 0!==r?r:wt,this.minFilter=void 0!==a?a:Mt,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:jt,this.internalFormat=null,this.type=void 0!==s?s:Tt,this.offset=new Un(0,0),this.repeat=new Un(1,1),this.center=new Un(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ke,this.version=0,this.onUpdate=null}function $n(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function Qn(t,e,n){this.width=t,this.height=e,this.scissor=new $n(0,0,t,e),this.scissorTest=!1,this.viewport=new $n(0,0,t,e),n=n||{},this.texture=new qn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:wt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Yn(t,e,n){Qn.call(this,t,e,n),this.samples=4}function Xn(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}qn.DEFAULT_IMAGE=void 0,qn.DEFAULT_MAPPING=ot,qn.prototype=Object.assign(Object.create(zn.prototype),{constructor:qn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var i=this.image;if(void 0===i.uuid&&(i.uuid=jn.generateUUID()),!e&&void 0===t.images[i.uuid]){var r;if(Array.isArray(i)){r=[];for(var a=0,o=i.length;a<o;a++)r.push(Gn.getDataURL(i[a]))}else r=Gn.getDataURL(i);t.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==ot)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case pt:t.x=t.x-Math.floor(t.x);break;case mt:t.x=t.x<0?0:1;break;case gt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case pt:t.y=t.y-Math.floor(t.y);break;case mt:t.y=t.y<0?0:1;break;case gt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(qn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties($n.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign($n.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*e+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*e+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*e+a[7]*n+a[11]*i+a[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,a=t.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],f=a[6],p=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,g=(c+1)/2,v=(p+1)/2,y=(s+u)/4,b=(l+d)/4,x=(h+f)/4;return m>g&&m>v?m<.01?(n=0,i=.707106781,r=.707106781):(i=y/(n=Math.sqrt(m)),r=b/n):g>v?g<.01?(n=.707106781,i=0,r=.707106781):(n=y/(i=Math.sqrt(g)),r=x/i):v<.01?(n=.707106781,i=.707106781,r=0):(n=b/(r=Math.sqrt(v)),i=x/r),this.set(n,i,r,e),this}var _=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(_)<.001&&(_=1),this.x=(f-h)/_,this.y=(l-d)/_,this.z=(u-s)/_,this.w=Math.acos((o+c+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Qn.prototype=Object.assign(Object.create(zn.prototype),{constructor:Qn,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Yn.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Yn,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Qn.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(Xn,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,a,o){var s=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3],h=r[a+0],d=r[a+1],f=r[a+2],p=r[a+3];if(c!==p||s!==h||l!==d||u!==f){var m=1-o,g=s*h+l*d+u*f+c*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,o=Math.sin(o*x)/b}var _=o*v;if(s=s*m+h*_,l=l*m+d*_,u=u*m+f*_,c=c*m+p*_,m===1-o){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=c},multiplyQuaternionsFlat:function(t,e,n,i,r,a){var o=n[i],s=n[i+1],l=n[i+2],u=n[i+3],c=r[a],h=r[a+1],d=r[a+2],f=r[a+3];return t[e]=o*f+u*c+s*d-l*h,t[e+1]=s*f+u*h+l*c-o*d,t[e+2]=l*f+u*d+o*h-s*c,t[e+3]=u*f-o*c-s*h-l*d,t}}),Object.defineProperties(Xn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(Xn.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,i=t._y,r=t._z,a=t.order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(i/2),c=o(r/2),h=s(n/2),d=s(i/2),f=s(r/2);switch(a){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],a=n[8],o=n[1],s=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=i+s+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-l)*e,this._y=(a-u)*e,this._z=(o-r)*e):i>s&&i>h?(e=2*Math.sqrt(1+i-s-h),this._w=(c-l)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(a+u)/e):s>h?(e=2*Math.sqrt(1+s-i-h),this._w=(a-u)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+h-i-s),this._w=(o-r)/e,this._x=(a+u)/e,this._y=(l+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(jn.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var i=Math.min(1,e/n);return this.slerp(t,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,a=t._w,o=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+a*o+i*l-r*s,this._y=i*u+a*s+r*o-n*l,this._z=r*u+a*l+n*s-i*o,this._w=a*u-n*o-i*s-r*l,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,a=this._w,o=a*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-e;return this._w=l*a+e*this._w,this._x=l*n+e*this._x,this._y=l*i+e*this._y,this._z=l*r+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-e)*c)/u,d=Math.sin(e*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=i*h+this._y*d,this._z=r*h+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Zn=new Kn,Jn=new Xn;function Kn(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(Kn.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Jn.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Jn.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,a=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*a,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*i-o*n,u=s*n+o*e-r*i,c=s*i+r*n-a*e,h=-r*e-a*n-o*i;return this.x=l*s+h*-r+u*-o-c*-a,this.y=u*s+h*-a+c*-r-l*-o,this.z=c*s+h*-o+l*-a-u*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return Zn.copy(this).projectOnVector(t),this.sub(Zn)},reflect:function(t){return this.sub(Zn.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(jn.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var ti=new Kn,ei=new si,ni=new Kn(0,0,0),ii=new Kn(1,1,1),ri=new Kn,ai=new Kn,oi=new Kn;function si(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(si.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,a,o,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new si).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,i=1/ti.setFromMatrixColumn(t,0).length(),r=1/ti.setFromMatrixColumn(t,1).length(),a=1/ti.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){var h=a*u,d=a*c,f=o*u,p=o*c;e[0]=s*u,e[4]=-s*c,e[8]=l,e[1]=d+f*l,e[5]=h-p*l,e[9]=-o*s,e[2]=p-h*l,e[6]=f+d*l,e[10]=a*s}else if("YXZ"===t.order){var m=s*u,g=s*c,v=l*u,y=l*c;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*l,e[1]=a*c,e[5]=a*u,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*u,g=s*c,v=l*u,y=l*c;e[0]=m-y*o,e[4]=-a*c,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*u,e[9]=y-m*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){h=a*u,d=a*c,f=o*u,p=o*c;e[0]=s*u,e[4]=f*l-d,e[8]=h*l+p,e[1]=s*c,e[5]=p*l+h,e[9]=d*l-f,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var b=a*s,x=a*l,_=o*s,w=o*l;e[0]=s*u,e[4]=w-b*c,e[8]=_*c+x,e[1]=c,e[5]=a*u,e[9]=-o*u,e[2]=-l*u,e[6]=x*c+_,e[10]=b-w*c}else if("XZY"===t.order){b=a*s,x=a*l,_=o*s,w=o*l;e[0]=s*u,e[4]=-c,e[8]=l*u,e[1]=b*c+w,e[5]=a*u,e[9]=x*c-_,e[2]=_*c-x,e[6]=o*u,e[10]=w*c+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(ni,t,ii)},lookAt:function(t,e,n){var i=this.elements;return oi.subVectors(t,e),0===oi.lengthSq()&&(oi.z=1),oi.normalize(),ri.crossVectors(n,oi),0===ri.lengthSq()&&(1===Math.abs(n.z)?oi.x+=1e-4:oi.z+=1e-4,oi.normalize(),ri.crossVectors(n,oi)),ri.normalize(),ai.crossVectors(oi,ri),i[0]=ri.x,i[4]=ai.x,i[8]=oi.x,i[1]=ri.y,i[5]=ai.y,i[9]=oi.y,i[2]=ri.z,i[6]=ai.z,i[10]=oi.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],_=i[0],w=i[4],S=i[8],E=i[12],M=i[1],C=i[5],T=i[9],k=i[13],P=i[2],A=i[6],O=i[10],L=i[14],R=i[3],I=i[7],N=i[11],D=i[15];return r[0]=a*_+o*M+s*P+l*R,r[4]=a*w+o*C+s*A+l*I,r[8]=a*S+o*T+s*O+l*N,r[12]=a*E+o*k+s*L+l*D,r[1]=u*_+c*M+h*P+d*R,r[5]=u*w+c*C+h*A+d*I,r[9]=u*S+c*T+h*O+d*N,r[13]=u*E+c*k+h*L+d*D,r[2]=f*_+p*M+m*P+g*R,r[6]=f*w+p*C+m*A+g*I,r[10]=f*S+p*T+m*O+g*N,r[14]=f*E+p*k+m*L+g*D,r[3]=v*_+y*M+b*P+x*R,r[7]=v*w+y*C+b*A+x*I,r[11]=v*S+y*T+b*O+x*N,r[15]=v*E+y*k+b*L+x*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+r*s*c-i*l*c-r*o*h+n*l*h+i*o*d-n*s*d)+t[7]*(+e*s*d-e*l*h+r*a*h-i*a*d+i*l*u-r*s*u)+t[11]*(+e*l*c-e*o*d-r*a*c+n*a*d+r*o*u-n*l*u)+t[15]*(-i*o*u-e*s*c+e*o*h+i*a*c-n*a*h+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,i=t.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],u=i[5],c=i[6],h=i[7],d=i[8],f=i[9],p=i[10],m=i[11],g=i[12],v=i[13],y=i[14],b=i[15],x=f*y*h-v*p*h+v*c*m-u*y*m-f*c*b+u*p*b,_=g*p*h-d*y*h-g*c*m+l*y*m+d*c*b-l*p*b,w=d*v*h-g*f*h+g*u*m-l*v*m-d*u*b+l*f*b,S=g*f*c-d*v*c-g*u*p+l*v*p+d*u*y-l*f*y,E=r*x+a*_+o*w+s*S;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var M=1/E;return n[0]=x*M,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*b-a*p*b)*M,n[2]=(u*y*s-v*c*s+v*o*h-a*y*h-u*o*b+a*c*b)*M,n[3]=(f*c*s-u*p*s-f*o*h+a*p*h+u*o*m-a*c*m)*M,n[4]=_*M,n[5]=(d*y*s-g*p*s+g*o*m-r*y*m-d*o*b+r*p*b)*M,n[6]=(g*c*s-l*y*s-g*o*h+r*y*h+l*o*b-r*c*b)*M,n[7]=(l*p*s-d*c*s+d*o*h-r*p*h-l*o*m+r*c*m)*M,n[8]=w*M,n[9]=(g*f*s-d*v*s-g*a*m+r*v*m+d*a*b-r*f*b)*M,n[10]=(l*v*s-g*u*s+g*a*h-r*v*h-l*a*b+r*u*b)*M,n[11]=(d*u*s-l*f*s-d*a*h+r*f*h+l*a*m-r*u*m)*M,n[12]=S*M,n[13]=(d*v*o-g*f*o+g*a*p-r*v*p-d*a*y+r*f*y)*M,n[14]=(g*u*o-l*v*o-g*a*c+r*v*c+l*a*y-r*u*y)*M,n[15]=(l*f*o-d*u*o+d*a*c-r*f*c-l*a*p+r*u*p)*M,this},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,a=t.x,o=t.y,s=t.z,l=r*a,u=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,u*o+n,u*s-i*a,0,l*s-i*o,u*s+i*a,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,l=r+r,u=a+a,c=o+o,h=r*l,d=r*u,f=r*c,p=a*u,m=a*c,g=o*c,v=s*l,y=s*u,b=s*c,x=n.x,_=n.y,w=n.z;return i[0]=(1-(p+g))*x,i[1]=(d+b)*x,i[2]=(f-y)*x,i[3]=0,i[4]=(d-b)*_,i[5]=(1-(h+g))*_,i[6]=(m+v)*_,i[7]=0,i[8]=(f+y)*w,i[9]=(m-v)*w,i[10]=(1-(h+p))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:function(t,e,n){var i=this.elements,r=ti.set(i[0],i[1],i[2]).length(),a=ti.set(i[4],i[5],i[6]).length(),o=ti.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],ei.copy(this);var s=1/r,l=1/a,u=1/o;return ei.elements[0]*=s,ei.elements[1]*=s,ei.elements[2]*=s,ei.elements[4]*=l,ei.elements[5]*=l,ei.elements[6]*=l,ei.elements[8]*=u,ei.elements[9]*=u,ei.elements[10]*=u,e.setFromRotationMatrix(ei),n.x=r,n.y=a,n.z=o,this},makePerspective:function(t,e,n,i,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(e-t),l=2*r/(n-i),u=(e+t)/(e-t),c=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,i,r,a){var o=this.elements,s=1/(e-t),l=1/(n-i),u=1/(a-r),c=(e+t)*s,h=(n+i)*l,d=(a+r)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var li=new si,ui=new Xn;function ci(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||ci.DefaultOrder}function hi(){this.mask=1}ci.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ci.DefaultOrder="XYZ",Object.defineProperties(ci.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(ci.prototype,{isEuler:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=jn.clamp,r=t.elements,a=r[0],o=r[4],s=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],f=r[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0);break;case"ZXY":this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return li.makeRotationFromQuaternion(t),this.setFromRotationMatrix(li,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return ui.setFromEuler(this),this.setFromQuaternion(ui,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Kn(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(hi.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var di=0,fi=new Kn,pi=new Xn,mi=new si,gi=new Kn,vi=new Kn,yi=new Kn,bi=new Xn,xi=new Kn(1,0,0),_i=new Kn(0,1,0),wi=new Kn(0,0,1),Si={type:"added"},Ei={type:"removed"};function Mi(){Object.defineProperty(this,"id",{value:di++}),this.uuid=jn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mi.DefaultUp.clone();var t=new Kn,e=new ci,n=new Xn,i=new Kn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new si},normalMatrix:{value:new Hn}}),this.matrix=new si,this.matrixWorld=new si,this.matrixAutoUpdate=Mi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Ci(){Mi.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Mi.DefaultUp=new Kn(0,1,0),Mi.DefaultMatrixAutoUpdate=!0,Mi.prototype=Object.assign(Object.create(zn.prototype),{constructor:Mi,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return pi.setFromAxisAngle(t,e),this.quaternion.multiply(pi),this},rotateOnWorldAxis:function(t,e){return pi.setFromAxisAngle(t,e),this.quaternion.premultiply(pi),this},rotateX:function(t){return this.rotateOnAxis(xi,t)},rotateY:function(t){return this.rotateOnAxis(_i,t)},rotateZ:function(t){return this.rotateOnAxis(wi,t)},translateOnAxis:function(t,e){return fi.copy(t).applyQuaternion(this.quaternion),this.position.add(fi.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(xi,t)},translateY:function(t){return this.translateOnAxis(_i,t)},translateZ:function(t){return this.translateOnAxis(wi,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(mi.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?gi.copy(t):gi.set(t,e,n);var i=this.parent;this.updateWorldMatrix(!0,!1),vi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mi.lookAt(vi,gi,this.up):mi.lookAt(gi,vi,this.up),this.quaternion.setFromRotationMatrix(mi),i&&(mi.extractRotation(i.matrixWorld),pi.setFromRotationMatrix(mi),this.quaternion.premultiply(pi.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Si)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Ei)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),mi.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),mi.multiply(t.parent.matrixWorld)),t.applyMatrix4(mi),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Kn),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Xn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vi,t,yi),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Kn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vi,bi,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Kn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var i=this.children,r=0,a=i.length;r<a;r++)i[r].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];r(t.shapes,u)}else r(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(r(t.materials,this.material[s]));i.material=c}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),d=m(t.materials),f=m(t.textures),p=m(t.images);o=m(t.shapes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=i,n;function m(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}}),Ci.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Ci,isScene:!0,copy:function(t,e){return Mi.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Mi.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Ti=[new Kn,new Kn,new Kn,new Kn,new Kn,new Kn,new Kn,new Kn],ki=new Kn,Pi=new Vi,Ai=new Kn,Oi=new Kn,Li=new Kn,Ri=new Kn,Ii=new Kn,Ni=new Kn,Di=new Kn,zi=new Kn,Bi=new Kn,Fi=new Kn;function Vi(t,e){this.min=void 0!==t?t:new Kn(1/0,1/0,1/0),this.max=void 0!==e?e:new Kn(-1/0,-1/0,-1/0)}function ji(t,e,n,i,r){var a,o;for(a=0,o=t.length-3;a<=o;a+=3){Fi.fromArray(t,a);var s=r.x*Math.abs(Fi.x)+r.y*Math.abs(Fi.y)+r.z*Math.abs(Fi.z),l=e.dot(Fi),u=n.dot(Fi),c=i.dot(Fi);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}Object.assign(Vi.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(e,n,i),this.max.set(r,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(e,n,i),this.max.set(r,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=ki.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Kn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Kn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Pi.copy(e.boundingBox),Pi.applyMatrix4(t.matrixWorld),this.union(Pi));for(var n=t.children,i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Kn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,ki),ki.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(Di),zi.subVectors(this.max,Di),Ai.subVectors(t.a,Di),Oi.subVectors(t.b,Di),Li.subVectors(t.c,Di),Ri.subVectors(Oi,Ai),Ii.subVectors(Li,Oi),Ni.subVectors(Ai,Li);var e=[0,-Ri.z,Ri.y,0,-Ii.z,Ii.y,0,-Ni.z,Ni.y,Ri.z,0,-Ri.x,Ii.z,0,-Ii.x,Ni.z,0,-Ni.x,-Ri.y,Ri.x,0,-Ii.y,Ii.x,0,-Ni.y,Ni.x,0];return!!ji(e,Ai,Oi,Li,zi)&&(!!ji(e=[1,0,0,0,1,0,0,0,1],Ai,Oi,Li,zi)&&(Bi.crossVectors(Ri,Ii),ji(e=[Bi.x,Bi.y,Bi.z],Ai,Oi,Li,zi)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Kn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return ki.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(ki).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Ti[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ti[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ti[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ti[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ti[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ti[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ti[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ti[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ti)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ui=new Vi;function Hi(t,e){this.center=void 0!==t?t:new Kn,this.radius=void 0!==e?e:-1}Object.assign(Hi.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):Ui.setFromPoints(t).getCenter(n);for(var i=0,r=0,a=t.length;r<a;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Kn),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Vi),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Gi=new Kn,Wi=new Kn,qi=new Kn,$i=new Kn,Qi=new Kn,Yi=new Kn,Xi=new Kn;function Zi(t,e){this.origin=void 0!==t?t:new Kn,this.direction=void 0!==e?e:new Kn(0,0,-1)}Object.assign(Zi.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Kn),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Gi)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Kn),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Gi.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Gi.copy(this.direction).multiplyScalar(e).add(this.origin),Gi.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,i){Wi.copy(t).add(e).multiplyScalar(.5),qi.copy(e).sub(t).normalize(),$i.copy(this.origin).sub(Wi);var r,a,o,s,l=.5*t.distanceTo(e),u=-this.direction.dot(qi),c=$i.dot(this.direction),h=-$i.dot(qi),d=$i.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*c-h,s=l*f,(r=u*h-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(r*=p)*(r+u*(a*=p)+2*c)+a*(u*r+a+2*h)+d}else a=l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;else a=-l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;else a<=-s?o=-(r=Math.max(0,-(-u*l+c)))*r+(a=r>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(r=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(r=Math.max(0,-(u*l+c)))*r+(a=r>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(qi).multiplyScalar(a).add(Wi),o},intersectSphere:function(t,e){Gi.subVectors(t.center,this.origin);var n=Gi.dot(this.direction),i=Gi.dot(Gi)-n*n,r=t.radius*t.radius;if(i>r)return null;var a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),u>=0?(r=(t.min.y-h.y)*u,a=(t.max.y-h.y)*u):(r=(t.max.y-h.y)*u,a=(t.min.y-h.y)*u),n>a||r>i?null:((r>n||n!=n)&&(n=r),(a<i||i!=i)&&(i=a),c>=0?(o=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(o=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||o>i?null:((o>n||n!=n)&&(n=o),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Gi)},intersectTriangle:function(t,e,n,i,r){Qi.subVectors(e,t),Yi.subVectors(n,t),Xi.crossVectors(Qi,Yi);var a,o=this.direction.dot(Xi);if(o>0){if(i)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}$i.subVectors(this.origin,t);var s=a*this.direction.dot(Yi.crossVectors($i,Yi));if(s<0)return null;var l=a*this.direction.dot(Qi.cross($i));if(l<0)return null;if(s+l>o)return null;var u=-a*$i.dot(Xi);return u<0?null:this.at(u/o,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Ji=new Kn,Ki=new Kn,tr=new Hn;function er(t,e){this.normal=void 0!==t?t:new Kn(1,0,0),this.constant=void 0!==e?e:0}Object.assign(er.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var i=Ji.subVectors(n,e).cross(Ki.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Kn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Kn);var n=t.delta(Ji),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?void 0:e.copy(n).multiplyScalar(r).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Kn),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||tr.getNormalMatrix(t),i=this.coplanarPoint(Ji).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var nr=new Kn,ir=new Kn,rr=new Kn,ar=new Kn,or=new Kn,sr=new Kn,lr=new Kn,ur=new Kn,cr=new Kn,hr=new Kn;function dr(t,e,n){this.a=void 0!==t?t:new Kn,this.b=void 0!==e?e:new Kn,this.c=void 0!==n?n:new Kn}Object.assign(dr,{getNormal:function(t,e,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Kn),i.subVectors(n,e),nr.subVectors(t,e),i.cross(nr);var r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)},getBarycoord:function(t,e,n,i,r){nr.subVectors(i,e),ir.subVectors(n,e),rr.subVectors(t,e);var a=nr.dot(nr),o=nr.dot(ir),s=nr.dot(rr),l=ir.dot(ir),u=ir.dot(rr),c=a*l-o*o;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Kn),0===c)return r.set(-2,-1,-1);var h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return r.set(1-d-f,f,d)},containsPoint:function(t,e,n,i){return dr.getBarycoord(t,e,n,i,ar),ar.x>=0&&ar.y>=0&&ar.x+ar.y<=1},getUV:function(t,e,n,i,r,a,o,s){return this.getBarycoord(t,e,n,i,ar),s.set(0,0),s.addScaledVector(r,ar.x),s.addScaledVector(a,ar.y),s.addScaledVector(o,ar.z),s},isFrontFacing:function(t,e,n,i){return nr.subVectors(n,e),ir.subVectors(t,e),nr.cross(ir).dot(i)<0}}),Object.assign(dr.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return nr.subVectors(this.c,this.b),ir.subVectors(this.a,this.b),.5*nr.cross(ir).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Kn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return dr.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new er),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return dr.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,i,r){return dr.getUV(t,this.a,this.b,this.c,e,n,i,r)},containsPoint:function(t){return dr.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return dr.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Kn);var n,i,r=this.a,a=this.b,o=this.c;or.subVectors(a,r),sr.subVectors(o,r),ur.subVectors(t,r);var s=or.dot(ur),l=sr.dot(ur);if(s<=0&&l<=0)return e.copy(r);cr.subVectors(t,a);var u=or.dot(cr),c=sr.dot(cr);if(u>=0&&c<=u)return e.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),e.copy(r).addScaledVector(or,n);hr.subVectors(t,o);var d=or.dot(hr),f=sr.dot(hr);if(f>=0&&d<=f)return e.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return i=l/(l-f),e.copy(r).addScaledVector(sr,i);var m=u*f-d*c;if(m<=0&&c-u>=0&&d-f>=0)return lr.subVectors(o,a),i=(c-u)/(c-u+(d-f)),e.copy(a).addScaledVector(lr,i);var g=1/(m+p+h);return n=p*g,i=h*g,e.copy(r).addScaledVector(or,n).addScaledVector(sr,i)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var fr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pr={h:0,s:0,l:0},mr={h:0,s:0,l:0};function gr(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function vr(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function yr(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function br(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function xr(t,e,n,i,r,a){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new Kn,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new gr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Object.assign(gr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=jn.euclideanModulo(t,1),e=jn.clamp(e,0,1),n=jn.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=vr(r,i,t+1/3),this.g=vr(r,i,t),this.b=vr(r,i,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],a=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=fr[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=yr(t.r),this.g=yr(t.g),this.b=yr(t.b),this},copyLinearToSRGB:function(t){return this.r=br(t.r),this.g=br(t.g),this.b=br(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,i=this.r,r=this.g,a=this.b,o=Math.max(i,r,a),s=Math.min(i,r,a),l=(s+o)/2;if(s===o)e=0,n=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case i:e=(r-a)/u+(r<a?6:0);break;case r:e=(a-i)/u+2;break;case a:e=(i-r)/u+4}e/=6}return t.h=e,t.s=n,t.l=l,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(pr),pr.h+=t,pr.s+=e,pr.l+=n,this.setHSL(pr.h,pr.s,pr.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(pr),t.getHSL(mr);var n=jn.lerp(pr.h,mr.h,e),i=jn.lerp(pr.s,mr.s,e),r=jn.lerp(pr.l,mr.l,e);return this.setHSL(n,i,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),gr.NAMES=fr,Object.assign(xr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var _r=0;function wr(){Object.defineProperty(this,"id",{value:_r++}),this.uuid=jn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=w,this.side=g,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=z,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=q,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Tn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=fn,this.stencilZFail=fn,this.stencilZPass=fn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Sr(t){wr.call(this),this.type="MeshBasicMaterial",this.color=new gr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}wr.prototype=Object.assign(Object.create(zn.prototype),{constructor:wr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===b;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==w&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==g&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var r=i(t.textures),a=i(t.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(wr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Sr.prototype=Object.create(wr.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isMeshBasicMaterial=!0,Sr.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Er=new Kn;function Mr(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=kn,this.updateRange={offset:0,count:-1},this.version=0}function Cr(t,e,n){Mr.call(this,new Int8Array(t),e,n)}function Tr(t,e,n){Mr.call(this,new Uint8Array(t),e,n)}function kr(t,e,n){Mr.call(this,new Uint8ClampedArray(t),e,n)}function Pr(t,e,n){Mr.call(this,new Int16Array(t),e,n)}function Ar(t,e,n){Mr.call(this,new Uint16Array(t),e,n)}function Or(t,e,n){Mr.call(this,new Int32Array(t),e,n)}function Lr(t,e,n){Mr.call(this,new Uint32Array(t),e,n)}function Rr(t,e,n){Mr.call(this,new Float32Array(t),e,n)}function Ir(t,e,n){Mr.call(this,new Float64Array(t),e,n)}function Nr(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Dr(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Mr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Mr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new gr),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new Un),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new Kn),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new $n),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)Er.x=this.getX(e),Er.y=this.getY(e),Er.z=this.getZ(e),Er.applyMatrix3(t),this.setXYZ(e,Er.x,Er.y,Er.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Er.x=this.getX(e),Er.y=this.getY(e),Er.z=this.getZ(e),Er.applyMatrix4(t),this.setXYZ(e,Er.x,Er.y,Er.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Er.x=this.getX(e),Er.y=this.getY(e),Er.z=this.getZ(e),Er.applyNormalMatrix(t),this.setXYZ(e,Er.x,Er.y,Er.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Er.x=this.getX(e),Er.y=this.getY(e),Er.z=this.getZ(e),Er.transformDirection(t),this.setXYZ(e,Er.x,Er.y,Er.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Cr.prototype=Object.create(Mr.prototype),Cr.prototype.constructor=Cr,Tr.prototype=Object.create(Mr.prototype),Tr.prototype.constructor=Tr,kr.prototype=Object.create(Mr.prototype),kr.prototype.constructor=kr,Pr.prototype=Object.create(Mr.prototype),Pr.prototype.constructor=Pr,Ar.prototype=Object.create(Mr.prototype),Ar.prototype.constructor=Ar,Or.prototype=Object.create(Mr.prototype),Or.prototype.constructor=Or,Lr.prototype=Object.create(Mr.prototype),Lr.prototype.constructor=Lr,Rr.prototype=Object.create(Mr.prototype),Rr.prototype.constructor=Rr,Ir.prototype=Object.create(Mr.prototype),Ir.prototype.constructor=Ir,Object.assign(Nr.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==i&&(i=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,n.push(e)),e={start:3*a,materialIndex:i})}void 0!==e&&(e.count=3*a-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,i=t.vertices,r=t.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=t.morphTargets,l=s.length;if(l>0){e=[];for(var u=0;u<l;u++)e[u]={name:s[u].name,data:[]};this.morphTargets.position=e}var c,h=t.morphNormals,d=h.length;if(d>0){c=[];for(u=0;u<d;u++)c[u]={name:h[u].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,p=t.skinWeights,m=f.length===i.length,g=p.length===i.length;i.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(x=r[0][u])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Un,new Un,new Un));if(!0===o)void 0!==(x=r[1][u])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Un,new Un,new Un));for(var S=0;S<l;S++){var E=s[S].vertices;e[S].data.push(E[v.a],E[v.b],E[v.c])}for(S=0;S<d;S++){var M=h[S].vertexNormals[u];c[S].data.push(M.a,M.b,M.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var zr=1,Br=new si,Fr=new Mi,Vr=new Kn,jr=new Vi,Ur=new Vi,Hr=new Kn;function Gr(){Object.defineProperty(this,"id",{value:zr+=2}),this.uuid=jn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Gr.prototype=Object.assign(Object.create(zn.prototype),{constructor:Gr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Dr(t)>65535?Lr:Ar)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new Hn).getNormalMatrix(t);n.applyNormalMatrix(i),n.needsUpdate=!0}var r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Br.makeRotationX(t),this.applyMatrix4(Br),this},rotateY:function(t){return Br.makeRotationY(t),this.applyMatrix4(Br),this},rotateZ:function(t){return Br.makeRotationZ(t),this.applyMatrix4(Br),this},translate:function(t,e,n){return Br.makeTranslation(t,e,n),this.applyMatrix4(Br),this},scale:function(t,e,n){return Br.makeScale(t,e,n),this.applyMatrix4(Br),this},lookAt:function(t){return Fr.lookAt(t),Fr.updateMatrix(),this.applyMatrix4(Fr.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vr).negate(),this.translate(Vr.x,Vr.y,Vr.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new Rr(3*e.vertices.length,3),i=new Rr(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new Rr(e.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Rr(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Nr).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Mr(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Mr(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(3*t.colors.length);this.setAttribute("color",new Mr(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Mr(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Mr(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],l=t.morphTargets[o],u=0,c=l.length;u<c;u++){var h=l[u],d=new Rr(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var f=new Rr(4*t.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new Rr(4*t.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vi);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var r=e[n];jr.setFromBufferAttribute(r),this.morphTargetsRelative?(Hr.addVectors(this.boundingBox.min,jr.min),this.boundingBox.expandByPoint(Hr),Hr.addVectors(this.boundingBox.max,jr.max),this.boundingBox.expandByPoint(Hr)):(this.boundingBox.expandByPoint(jr.min),this.boundingBox.expandByPoint(jr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Hi);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(jr.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var a=e[i];Ur.setFromBufferAttribute(a),this.morphTargetsRelative?(Hr.addVectors(jr.min,Ur.min),jr.expandByPoint(Hr),Hr.addVectors(jr.max,Ur.max),jr.expandByPoint(Hr)):(jr.expandByPoint(Ur.min),jr.expandByPoint(Ur.max))}jr.getCenter(n);var o=0;for(i=0,r=t.count;i<r;i++)Hr.fromBufferAttribute(t,i),o=Math.max(o,n.distanceToSquared(Hr));if(e)for(i=0,r=e.length;i<r;i++){a=e[i];for(var s=this.morphTargetsRelative,l=0,u=a.count;l<u;l++)Hr.fromBufferAttribute(a,l),s&&(Vr.fromBufferAttribute(t,l),Hr.add(Vr)),o=Math.max(o,n.distanceToSquared(Hr))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Mr(new Float32Array(n.length),3));else for(var i=e.normal.array,r=0,a=i.length;r<a;r++)i[r]=0;var o,s,l,u=e.normal.array,c=new Kn,h=new Kn,d=new Kn,f=new Kn,p=new Kn;if(t){var m=t.array;for(r=0,a=t.count;r<a;r+=3)o=3*m[r+0],s=3*m[r+1],l=3*m[r+2],c.fromArray(n,o),h.fromArray(n,s),d.fromArray(n,l),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[o]+=f.x,u[o+1]+=f.y,u[o+2]+=f.z,u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z}else for(r=0,a=n.length;r<a;r+=9)c.fromArray(n,r),h.fromArray(n,r+3),d.fromArray(n,r+6),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[r]=f.x,u[r+1]=f.y,u[r+2]=f.z,u[r+3]=f.x,u[r+4]=f.y,u[r+5]=f.z,u[r+6]=f.x,u[r+7]=f.y,u[r+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var r=n[i].array,a=t.attributes[i],o=a.array,s=a.itemSize*e,l=Math.min(o.length,r.length-s),u=0,c=s;u<l;u++,c++)r[c]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Hr.x=t.getX(e),Hr.y=t.getY(e),Hr.z=t.getZ(e),Hr.normalize(),t.setXYZ(e,Hr.x,Hr.y,Hr.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,i=t.itemSize,r=new n.constructor(e.length*i),a=0,o=0,s=0,l=e.length;s<l;s++){a=e[s]*i;for(var u=0;u<i;u++)r[o++]=n[a++]}return new Mr(r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Gr,n=this.index.array,i=this.attributes;for(var r in i){var a=t(i[r],n);e.setAttribute(r,a)}var o=this.morphAttributes;for(r in o){for(var s=[],l=o[r],u=0,c=l.length;u<c;u++){a=t(l[u],n);s.push(a)}e.morphAttributes[r]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,d=(u=0,h.length);u<d;u++){var f=h[u];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var r=this.attributes;for(var n in r){var a=(d=r[n]).toJSON();""!==d.name&&(a.name=d.name),t.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var l=this.morphAttributes[n],u=[],c=0,h=l.length;c<h;c++){var d;a=(d=l[c]).toJSON();""!==d.name&&(a.name=d.name),u.push(a)}u.length>0&&(o[n]=u,s=!0)}s&&(t.data.morphAttributes=o,t.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var p=this.boundingSphere;return null!==p&&(t.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),t},clone:function(){return(new Gr).copy(this)},copy:function(t){var e,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var a=t.attributes;for(e in a){var o=a[e];this.setAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var l=[],u=s[e];for(n=0,i=u.length;n<i;n++)l.push(u[n].clone());this.morphAttributes[e]=l}this.morphTargetsRelative=t.morphTargetsRelative;var c=t.groups;for(n=0,i=c.length;n<i;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Wr=new si,qr=new Zi,$r=new Hi,Qr=new Kn,Yr=new Kn,Xr=new Kn,Zr=new Kn,Jr=new Kn,Kr=new Kn,ta=new Kn,ea=new Kn,na=new Kn,ia=new Un,ra=new Un,aa=new Un,oa=new Kn,sa=new Kn;function la(t,e){Mi.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Gr,this.material=void 0!==e?e:new Sr,this.updateMorphTargets()}function ua(t,e,n,i,r,a,o,s){if(null===(e.side===v?i.intersectTriangle(o,a,r,!0,s):i.intersectTriangle(r,a,o,e.side!==y,s)))return null;sa.copy(s),sa.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(sa);return l<n.near||l>n.far?null:{distance:l,point:sa.clone(),object:t}}function ca(t,e,n,i,r,a,o,s,l,u,c,h){Qr.fromBufferAttribute(r,u),Yr.fromBufferAttribute(r,c),Xr.fromBufferAttribute(r,h);var d=t.morphTargetInfluences;if(e.morphTargets&&a&&d){ta.set(0,0,0),ea.set(0,0,0),na.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var m=d[f],g=a[f];0!==m&&(Zr.fromBufferAttribute(g,u),Jr.fromBufferAttribute(g,c),Kr.fromBufferAttribute(g,h),o?(ta.addScaledVector(Zr,m),ea.addScaledVector(Jr,m),na.addScaledVector(Kr,m)):(ta.addScaledVector(Zr.sub(Qr),m),ea.addScaledVector(Jr.sub(Yr),m),na.addScaledVector(Kr.sub(Xr),m)))}Qr.add(ta),Yr.add(ea),Xr.add(na)}t.isSkinnedMesh&&(t.boneTransform(u,Qr),t.boneTransform(c,Yr),t.boneTransform(h,Xr));var v=ua(t,e,n,i,Qr,Yr,Xr,oa);if(v){s&&(ia.fromBufferAttribute(s,u),ra.fromBufferAttribute(s,c),aa.fromBufferAttribute(s,h),v.uv=dr.getUV(oa,Qr,Yr,Xr,ia,ra,aa,new Un)),l&&(ia.fromBufferAttribute(l,u),ra.fromBufferAttribute(l,c),aa.fromBufferAttribute(l,h),v.uv2=dr.getUV(oa,Qr,Yr,Xr,ia,ra,aa,new Un));var y=new xr(u,c,h);dr.getNormal(Qr,Yr,Xr,y.normal),v.face=y}return v}la.prototype=Object.assign(Object.create(Mi.prototype),{constructor:la,isMesh:!0,copy:function(t){return Mi.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=i.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,i=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r&&(null===i.boundingSphere&&i.computeBoundingSphere(),$r.copy(i.boundingSphere),$r.applyMatrix4(a),!1!==t.ray.intersectsSphere($r)&&(Wr.getInverse(a),qr.copy(t.ray).applyMatrix4(Wr),null===i.boundingBox||!1!==qr.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var o,s,l,u,c,h,d,f,p,m=i.index,g=i.attributes.position,v=i.morphAttributes.position,y=i.morphTargetsRelative,b=i.attributes.uv,x=i.attributes.uv2,_=i.groups,w=i.drawRange;if(null!==m)if(Array.isArray(r))for(u=0,h=_.length;u<h;u++)for(p=r[(f=_[u]).materialIndex],c=Math.max(f.start,w.start),d=Math.min(f.start+f.count,w.start+w.count);c<d;c+=3)o=m.getX(c),s=m.getX(c+1),l=m.getX(c+2),(n=ca(this,p,t,qr,g,v,y,b,x,o,s,l))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(u=Math.max(0,w.start),h=Math.min(m.count,w.start+w.count);u<h;u+=3)o=m.getX(u),s=m.getX(u+1),l=m.getX(u+2),(n=ca(this,r,t,qr,g,v,y,b,x,o,s,l))&&(n.faceIndex=Math.floor(u/3),e.push(n));else if(void 0!==g)if(Array.isArray(r))for(u=0,h=_.length;u<h;u++)for(p=r[(f=_[u]).materialIndex],c=Math.max(f.start,w.start),d=Math.min(f.start+f.count,w.start+w.count);c<d;c+=3)(n=ca(this,p,t,qr,g,v,y,b,x,o=c,s=c+1,l=c+2))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(u=Math.max(0,w.start),h=Math.min(g.count,w.start+w.count);u<h;u+=3)(n=ca(this,r,t,qr,g,v,y,b,x,o=u,s=u+1,l=u+2))&&(n.faceIndex=Math.floor(u/3),e.push(n))}else if(i.isGeometry){var S,E,M,C,T=Array.isArray(r),k=i.vertices,P=i.faces,A=i.faceVertexUvs[0];A.length>0&&(C=A);for(var O=0,L=P.length;O<L;O++){var R=P[O],I=T?r[R.materialIndex]:r;if(void 0!==I&&(S=k[R.a],E=k[R.b],M=k[R.c],n=ua(this,I,t,qr,S,E,M,oa))){if(C&&C[O]){var N=C[O];ia.copy(N[0]),ra.copy(N[1]),aa.copy(N[2]),n.uv=dr.getUV(oa,S,E,M,ia,ra,aa,new Un)}n.face=R,n.faceIndex=O,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ha=0,da=new si,fa=new Mi,pa=new Kn;function ma(){Object.defineProperty(this,"id",{value:ha+=2}),this.uuid=jn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ma.prototype=Object.assign(Object.create(zn.prototype),{constructor:ma,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Hn).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(t)}for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(var a=0,o=r.vertexNormals.length;a<o;a++)r.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return da.makeRotationX(t),this.applyMatrix4(da),this},rotateY:function(t){return da.makeRotationY(t),this.applyMatrix4(da),this},rotateZ:function(t){return da.makeRotationZ(t),this.applyMatrix4(da),this},translate:function(t,e,n){return da.makeTranslation(t,e,n),this.applyMatrix4(da),this},scale:function(t,e,n){return da.makeScale(t,e,n),this.applyMatrix4(da),this},lookAt:function(t){return fa.lookAt(t),fa.updateMatrix(),this.applyMatrix4(fa.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,i=t.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=i.position.array,a=void 0!==i.normal?i.normal.array:void 0,o=void 0!==i.color?i.color.array:void 0,s=void 0!==i.uv?i.uv.array:void 0,l=void 0!==i.uv2?i.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0;u<r.length;u+=3)e.vertices.push((new Kn).fromArray(r,u)),void 0!==o&&e.colors.push((new gr).fromArray(o,u));function c(t,n,i,r){var u=void 0===o?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[i].clone()],c=new xr(t,n,i,void 0===a?[]:[(new Kn).fromArray(a,3*t),(new Kn).fromArray(a,3*n),(new Kn).fromArray(a,3*i)],u,r);e.faces.push(c),void 0!==s&&e.faceVertexUvs[0].push([(new Un).fromArray(s,2*t),(new Un).fromArray(s,2*n),(new Un).fromArray(s,2*i)]),void 0!==l&&e.faceVertexUvs[1].push([(new Un).fromArray(l,2*t),(new Un).fromArray(l,2*n),(new Un).fromArray(l,2*i)])}var h=t.groups;if(h.length>0)for(u=0;u<h.length;u++)for(var d=h[u],f=d.start,p=f,m=f+d.count;p<m;p+=3)void 0!==n?c(n[p],n[p+1],n[p+2],d.materialIndex):c(p,p+1,p+2,d.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)c(n[u],n[u+1],n[u+2]);else for(u=0;u<r.length/3;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(pa).negate(),this.translate(pa.x,pa.y,pa.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new si;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var t=new Kn,e=new Kn,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,n,i,r,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)o[e]=new Kn;if(t){var s,l,u,c=new Kn,h=new Kn;for(i=0,r=this.faces.length;i<r;i++)a=this.faces[i],s=this.vertices[a.a],l=this.vertices[a.b],u=this.vertices[a.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),o[a.a].add(c),o[a.b].add(c),o[a.c].add(c)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)o[(a=this.faces[i]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,n=this.vertices.length;e<n;e++)o[e].normalize();for(i=0,r=this.faces.length;i<r;i++){var d=(a=this.faces[i]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var i=(n=this.faces[t]).vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new ma;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)l=new Kn,u={a:new Kn,b:new Kn,c:new Kn},o.push(l),s.push(u)}var l,u,c=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(r.normal),u.a.copy(r.vertexNormals[0]),u.b.copy(r.vertexNormals[1]),u.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vi),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Hi),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var i,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,u=this.colors,c=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new Hn).getNormalMatrix(e));for(var h=0,d=o.length;h<d;h++){var f=o[h].clone();void 0!==e&&f.applyMatrix4(e),a.push(f)}for(h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(h=0,d=l.length;h<d;h++){var p,m,g,v=l[h],y=v.vertexNormals,b=v.vertexColors;(p=new xr(v.a+r,v.b+r,v.c+r)).normal.copy(v.normal),void 0!==i&&p.normal.applyMatrix3(i).normalize();for(var x=0,_=y.length;x<_;x++)m=y[x].clone(),void 0!==i&&m.applyMatrix3(i).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(x=0,_=b.length;x<_;x++)g=b[x],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(h=0,d=t.faceVertexUvs.length;h<d;h++){var w=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(x=0,_=w.length;x<_;x++){for(var S=w[x],E=[],M=0,C=S.length;M<C;M++)E.push(S[M].clone());this.faceVertexUvs[h].push(E)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,i,r,a,o,s,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)t=this.vertices[n],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[e]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=c[r.a],r.b=c[r.b],r.c=c[r.c],a=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var i=t[e];this.vertices.push(new Kn(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var i,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===e&&(i=[]),o&&o.length===e&&(r=[]);for(n=0;n<e;n++){var s=t[n]._id;i&&i.push(a[s]),r&&r.push(o[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var i=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];i.push(a.x,a.y,a.z)}var o=[],s=[],l={},u=[],c={},h=[],d={};for(r=0;r<this.faces.length;r++){var f=this.faces[r],p=void 0!==this.faceVertexUvs[0][r],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,p),b=S(b,4,m),b=S(b,5,g),b=S(b,6,v),b=S(b,7,y),o.push(b),o.push(f.a,f.b,f.c),o.push(f.materialIndex),p){var x=this.faceVertexUvs[0][r];o.push(C(x[0]),C(x[1]),C(x[2]))}if(m&&o.push(E(f.normal)),g){var _=f.vertexNormals;o.push(E(_[0]),E(_[1]),E(_[2]))}if(v&&o.push(M(f.color)),y){var w=f.vertexColors;o.push(M(w[0]),M(w[1]),M(w[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function E(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=u.length,u.push(t.getHex())),c[e]}function C(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=i,t.data.normals=s,u.length>0&&(t.data.colors=u),h.length>0&&(t.data.uvs=[h]),t.data.faces=o,t},clone:function(){return(new ma).copy(this)},copy:function(t){var e,n,i,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var l=t.colors;for(e=0,n=l.length;e<n;e++)this.colors.push(l[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),i=0,r=c.length;i<r;i++){var h=c[i],d=[];for(a=0,o=h.length;a<o;a++){var f=h[a];d.push(f.clone())}this.faceVertexUvs[e].push(d)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],i=0,r=p[e].vertices.length;i<r;i++)m.vertices.push(p[e].vertices[i].clone());if(void 0!==p[e].normals)for(m.normals=[],i=0,r=p[e].normals.length;i<r;i++)m.normals.push(p[e].normals[i].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],i=0,r=g[e].vertexNormals.length;i<r;i++){var y=g[e].vertexNormals[i],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],i=0,r=g[e].faceNormals.length;i<r;i++)v.faceNormals.push(g[e].faceNormals[i].clone());this.morphNormals.push(v)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ga extends ma{constructor(t,e,n,i,r,a){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new va(t,e,n,i,r,a)),this.mergeVertices()}}class va extends Gr{constructor(t,e,n,i,r,a){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};var o=this;t=t||1,e=e||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var s=[],l=[],u=[],c=[],h=0,d=0;function f(t,e,n,i,r,a,f,p,m,g,v){var y,b,x=a/m,_=f/g,w=a/2,S=f/2,E=p/2,M=m+1,C=g+1,T=0,k=0,P=new Kn;for(b=0;b<C;b++){var A=b*_-S;for(y=0;y<M;y++){var O=y*x-w;P[t]=O*i,P[e]=A*r,P[n]=E,l.push(P.x,P.y,P.z),P[t]=0,P[e]=0,P[n]=p>0?1:-1,u.push(P.x,P.y,P.z),c.push(y/m),c.push(1-b/g),T+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var L=h+y+M*b,R=h+y+M*(b+1),I=h+(y+1)+M*(b+1),N=h+(y+1)+M*b;s.push(L,R,N),s.push(R,I,N),k+=6}o.addGroup(d,k,v),d+=k,h+=T}f("z","y","x",-1,-1,n,e,t,a,r,0),f("z","y","x",1,-1,n,e,-t,a,r,1),f("x","z","y",1,1,t,n,e,i,a,2),f("x","z","y",1,-1,t,n,-e,i,a,3),f("x","y","z",1,-1,t,e,n,i,r,4),f("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new Rr(l,3)),this.setAttribute("normal",new Rr(u,3)),this.setAttribute("uv",new Rr(c,2))}}function ya(t){var e={};for(var n in t)for(var i in e[n]={},t[n]){var r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}return e}function ba(t){for(var e={},n=0;n<t.length;n++){var i=ya(t[n]);for(var r in i)e[r]=i[r]}return e}var xa={clone:ya,merge:ba};function _a(t){wr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function wa(){Mi.call(this),this.type="Camera",this.matrixWorldInverse=new si,this.projectionMatrix=new si,this.projectionMatrixInverse=new si}function Sa(t,e,n,i){wa.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}_a.prototype=Object.create(wr.prototype),_a.prototype.constructor=_a,_a.prototype.isShaderMaterial=!0,_a.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ya(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},_a.prototype.toJSON=function(t){var e=wr.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:"m4",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var r={};for(var a in this.extensions)!0===this.extensions[a]&&(r[a]=!0);return Object.keys(r).length>0&&(e.extensions=r),e},wa.prototype=Object.assign(Object.create(Mi.prototype),{constructor:wa,isCamera:!0,copy:function(t,e){return Mi.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Kn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Mi.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Mi.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Sa.prototype=Object.assign(Object.create(wa.prototype),{constructor:Sa,isPerspectiveCamera:!0,copy:function(t,e){return wa.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*jn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*jn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*jn.RAD2DEG*Math.atan(Math.tan(.5*jn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*jn.DEG2RAD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*i/o,e-=a.offsetY*n/s,i*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(r+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Mi.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function Ea(t,e,n,i){Mi.call(this),this.type="CubeCamera";var r=new Sa(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new Kn(1,0,0)),this.add(r);var a=new Sa(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new Kn(-1,0,0)),this.add(a);var o=new Sa(90,1,t,e);o.up.set(0,0,1),o.lookAt(new Kn(0,1,0)),this.add(o);var s=new Sa(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new Kn(0,-1,0)),this.add(s);var l=new Sa(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new Kn(0,0,1)),this.add(l);var u=new Sa(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new Kn(0,0,-1)),this.add(u),i=i||{format:Vt,magFilter:wt,minFilter:wt},this.renderTarget=new Ma(n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),i=this.renderTarget,c=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,r),t.setRenderTarget(i,1),t.render(e,a),t.setRenderTarget(i,2),t.render(e,o),t.setRenderTarget(i,3),t.render(e,s),t.setRenderTarget(i,4),t.render(e,l),i.texture.generateMipmaps=c,t.setRenderTarget(i,5),t.render(e,u),t.setRenderTarget(n)},this.clear=function(t,e,n,i){for(var r=t.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)t.setRenderTarget(a,o),t.clear(e,n,i);t.setRenderTarget(r)}}function Ma(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),Qn.call(this,t,t,e)}function Ca(t,e,n,i,r,a,o,s,l,u,c,h){qn.call(this,null,a,o,s,l,u,i,r,c,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==l?l:vt,this.minFilter=void 0!==u?u:vt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ea.prototype=Object.create(Mi.prototype),Ea.prototype.constructor=Ea,Ma.prototype=Object.create(Qn.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isWebGLCubeRenderTarget=!0,Ma.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new Ci,i={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},r=new _a({type:"CubemapFromEquirect",uniforms:ya(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:v,blending:_});r.uniforms.tEquirect.value=e;var a=new la(new va(5,5,5),r);n.add(a);var o=new Ea(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(t,n),a.geometry.dispose(),a.material.dispose(),this},Ca.prototype=Object.create(qn.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isDataTexture=!0;var Ta=new Hi,ka=new Kn;function Pa(t,e,n,i,r,a){this.planes=[void 0!==t?t:new er,void 0!==e?e:new er,void 0!==n?n:new er,void 0!==i?i:new er,void 0!==r?r:new er,void 0!==a?a:new er]}Object.assign(Pa.prototype,{set:function(t,e,n,i,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(o-i,c-s,p-h,y-m).normalize(),e[1].setComponents(o+i,c+s,p+h,y+m).normalize(),e[2].setComponents(o+r,c+l,p+d,y+g).normalize(),e[3].setComponents(o-r,c-l,p-d,y-g).normalize(),e[4].setComponents(o-a,c-u,p-f,y-v).normalize(),e[5].setComponents(o+a,c+u,p+f,y+v).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ta.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ta)},intersectsSprite:function(t){return Ta.center.set(0,0,0),Ta.radius=.7071067811865476,Ta.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ta)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var i=e[n];if(ka.x=i.normal.x>0?t.max.x:t.min.x,ka.y=i.normal.y>0?t.max.y:t.min.y,ka.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(ka)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Aa={common:{diffuse:{value:new gr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Hn},uv2Transform:{value:new Hn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Un(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new gr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new gr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hn}},sprite:{diffuse:{value:new gr(15658734)},opacity:{value:1},center:{value:new Un(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hn}}};function Oa(){var t=null,e=!1,n=null;function i(r,a){!1!==e&&(n(r,a),t.requestAnimationFrame(i))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(i),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function La(t,e){var n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){e.isInterleavedBufferAttribute&&(e=e.data);var a=i.get(e);void 0===a?i.set(e,function(e,n){var i=e.array,r=e.usage,a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,i,r),e.onUploadCallback();var o=5126;return i instanceof Float32Array?o=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?o=5123:i instanceof Int16Array?o=5122:i instanceof Uint32Array?o=5125:i instanceof Int32Array?o=5124:i instanceof Int8Array?o=5120:i instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,r)):a.version<e.version&&(!function(e,i,r){var a=i.array,o=i.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,a):(n?t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,e,r),a.version=e.version)}}}function Ra(t,e,n,i){ma.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Ia(t,e,n,i)),this.mergeVertices()}function Ia(t,e,n,i){Gr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r,a,o=(t=t||1)/2,s=(e=e||1)/2,l=Math.floor(n)||1,u=Math.floor(i)||1,c=l+1,h=u+1,d=t/l,f=e/u,p=[],m=[],g=[],v=[];for(a=0;a<h;a++){var y=a*f-s;for(r=0;r<c;r++){var b=r*d-o;m.push(b,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-a/u)}}for(a=0;a<u;a++)for(r=0;r<l;r++){var x=r+c*a,_=r+c*(a+1),w=r+1+c*(a+1),S=r+1+c*a;p.push(x,_,S),p.push(_,w,S)}this.setIndex(p),this.setAttribute("position",new Rr(m,3)),this.setAttribute("normal",new Rr(g,3)),this.setAttribute("uv",new Rr(v,2))}Ra.prototype=Object.create(ma.prototype),Ra.prototype.constructor=Ra,Ia.prototype=Object.create(Gr.prototype),Ia.prototype.constructor=Ia;var Na={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Da={basic:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.fog]),vertexShader:Na.meshbasic_vert,fragmentShader:Na.meshbasic_frag},lambert:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.fog,Aa.lights,{emissive:{value:new gr(0)}}]),vertexShader:Na.meshlambert_vert,fragmentShader:Na.meshlambert_frag},phong:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,Aa.lights,{emissive:{value:new gr(0)},specular:{value:new gr(1118481)},shininess:{value:30}}]),vertexShader:Na.meshphong_vert,fragmentShader:Na.meshphong_frag},standard:{uniforms:ba([Aa.common,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.roughnessmap,Aa.metalnessmap,Aa.fog,Aa.lights,{emissive:{value:new gr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Na.meshphysical_vert,fragmentShader:Na.meshphysical_frag},toon:{uniforms:ba([Aa.common,Aa.specularmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.gradientmap,Aa.fog,Aa.lights,{emissive:{value:new gr(0)},specular:{value:new gr(1118481)},shininess:{value:30}}]),vertexShader:Na.meshtoon_vert,fragmentShader:Na.meshtoon_frag},matcap:{uniforms:ba([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,{matcap:{value:null}}]),vertexShader:Na.meshmatcap_vert,fragmentShader:Na.meshmatcap_frag},points:{uniforms:ba([Aa.points,Aa.fog]),vertexShader:Na.points_vert,fragmentShader:Na.points_frag},dashed:{uniforms:ba([Aa.common,Aa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Na.linedashed_vert,fragmentShader:Na.linedashed_frag},depth:{uniforms:ba([Aa.common,Aa.displacementmap]),vertexShader:Na.depth_vert,fragmentShader:Na.depth_frag},normal:{uniforms:ba([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,{opacity:{value:1}}]),vertexShader:Na.normal_vert,fragmentShader:Na.normal_frag},sprite:{uniforms:ba([Aa.sprite,Aa.fog]),vertexShader:Na.sprite_vert,fragmentShader:Na.sprite_frag},background:{uniforms:{uvTransform:{value:new Hn},t2D:{value:null}},vertexShader:Na.background_vert,fragmentShader:Na.background_frag},cube:{uniforms:ba([Aa.envmap,{opacity:{value:1}}]),vertexShader:Na.cube_vert,fragmentShader:Na.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Na.equirect_vert,fragmentShader:Na.equirect_frag},distanceRGBA:{uniforms:ba([Aa.common,Aa.displacementmap,{referencePosition:{value:new Kn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Na.distanceRGBA_vert,fragmentShader:Na.distanceRGBA_frag},shadow:{uniforms:ba([Aa.lights,Aa.fog,{color:{value:new gr(0)},opacity:{value:1}}]),vertexShader:Na.shadow_vert,fragmentShader:Na.shadow_frag}};function za(t,e,n,i){var r,a,o=new gr(0),s=0,l=null,u=0,c=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,i)}return{getClearColor:function(){return o},setClearColor:function(t,e){o.set(t),h(o,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){h(o,s=t)},render:function(e,i,d,f){var p=i.background,m=t.xr,y=m.getSession&&m.getSession();if(y&&"additive"===y.environmentBlendMode&&(p=null),null===p?h(o,s):p&&p.isColor&&(h(p,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===dt)){void 0===a&&((a=new la(new va(1,1,1),new _a({type:"BackgroundCubeMaterial",uniforms:ya(Da.cube.uniforms),vertexShader:Da.cube.vertexShader,fragmentShader:Da.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));var b=p.isWebGLCubeRenderTarget?p.texture:p;a.material.uniforms.envMap.value=b,a.material.uniforms.flipEnvMap.value=b.isCubeTexture?-1:1,l===p&&u===b.version&&c===t.toneMapping||(a.material.needsUpdate=!0,l=p,u=b.version,c=t.toneMapping),e.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===r&&((r=new la(new Ia(2,2),new _a({type:"BackgroundMaterial",uniforms:ya(Da.background.uniforms),vertexShader:Da.background.vertexShader,fragmentShader:Da.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(r.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(r)),r.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),r.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&u===p.version&&c===t.toneMapping||(r.material.needsUpdate=!0,l=p,u=p.version,c=t.toneMapping),e.unshift(r,r.geometry,r.material,0,0,null))}}}function Ba(t,e,n,i){var r,a=i.isWebGL2;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r)},this.renderInstances=function(i,o,s,l){if(0!==l){var u,c;if(a)u=t,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](r,o,s,l),n.update(s,r,l)}}}function Fa(t,e,n){var i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),c=t.getParameter(35660),h=t.getParameter(3379),d=t.getParameter(34076),f=t.getParameter(34921),p=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=c>0,y=a||!!e.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var n=e.get("EXT_texture_filter_anisotropic");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?t.getParameter(36183):0}}function Va(){var t=this,e=null,n=0,i=!1,r=!1,a=new er,o=new Hn,s={value:null,needsUpdate:!1};function l(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,n,i,r){var l=null!==e?e.length:0,u=null;if(0!==l){if(u=s.value,!0!==r||null===u){var c=i+4*l,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,f=i;d!==l;++d,f+=4)a.copy(e[d]).applyMatrix4(h,o),a.normal.toArray(u,f),u[f+3]=a.constant}s.value=u,s.needsUpdate=!0}return t.numPlanes=l,t.numIntersection=0,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,r,a){var o=0!==t.length||r||0!==n||i;return i=r,e=u(t,a,0),n=t.length,o},this.beginShadows=function(){r=!0,u(null)},this.endShadows=function(){r=!1,l()},this.setState=function(t,a,o,c,h,d){if(!i||null===t||0===t.length||r&&!o)r?u(null):l();else{var f=r?0:n,p=4*f,m=h.clippingState||null;s.value=m,m=u(t,c,p,d);for(var g=0;g!==p;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=f}}}function ja(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}}}function Ua(t,e,n){var i=new WeakMap,r=new WeakMap;function a(t){var o=t.target,s=i.get(o);for(var l in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[l]);o.removeEventListener("dispose",a),i.delete(o);var u=r.get(s);u&&(e.remove(u),r.delete(s)),n.memory.geometries--}function o(t){var n=[],i=t.index,a=t.attributes.position,o=0;if(null!==i){var s=i.array;o=i.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{s=a.array;o=a.version;for(l=0,u=s.length/3-1;l<u;l+=3){c=l+0,h=l+1,d=l+2;n.push(c,h,h,d,d,c)}}var f=new(Dr(n)>65535?Lr:Ar)(n,1);f.version=o,e.update(f,34963);var p=r.get(t);p&&e.remove(p),r.set(t,f)}return{get:function(t,e){var r=i.get(e);return r||(e.addEventListener("dispose",a),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Gr).setFromObject(t)),r=e._bufferGeometry),i.set(e,r),n.memory.geometries++,r)},update:function(t){var n=t.index,i=t.attributes;for(var r in null!==n&&e.update(n,34963),i)e.update(i[r],34962);var a=t.morphAttributes;for(var r in a)for(var o=a[r],s=0,l=o.length;s<l;s++)e.update(o[s],34962)},getWireframeAttribute:function(t){var e=r.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return r.get(t)}}}function Ha(t,e,n,i){var r,a,o,s=i.isWebGL2;this.setMode=function(t){r=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,i){t.drawElements(r,i,a,e*o),n.update(i,r)},this.renderInstances=function(i,l,u,c){if(0!==c){var h,d;if(s)h=t,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[d](r,u,a,l*o,c),n.update(u,r,c)}}}function Ga(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(i=i||1,e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Wa(t,e){return Math.abs(e[1])-Math.abs(t[1])}function qa(t){var e={},n=new Float32Array(8);return{update:function(i,r,a,o){var s=i.morphTargetInfluences,l=void 0===s?0:s.length,u=e[r.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];e[r.id]=u}var h=a.morphTargets&&r.morphAttributes.position,d=a.morphNormals&&r.morphAttributes.normal;for(c=0;c<l;c++){0!==(p=u[c])[1]&&(h&&r.deleteAttribute("morphTarget"+c),d&&r.deleteAttribute("morphNormal"+c))}for(c=0;c<l;c++){(p=u[c])[0]=c,p[1]=s[c]}u.sort(Wa);var f=0;for(c=0;c<8;c++){var p;if(p=u[c]){var m=p[0],g=p[1];if(g){h&&r.setAttribute("morphTarget"+c,h[m]),d&&r.setAttribute("morphNormal"+c,d[m]),n[c]=g,f+=g;continue}}n[c]=0}var v=r.morphTargetsRelative?1:1-f;o.getUniforms().setValue(t,"morphTargetBaseInfluence",v),o.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function $a(t,e,n,i){var r=new WeakMap;return{update:function(t){var a=i.render.frame,o=t.geometry,s=e.get(t,o);return r.get(s)!==a&&(o.isGeometry&&s.updateFromObject(t),e.update(s),r.set(s,a)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){r=new WeakMap}}}function Qa(t,e,n,i,r,a,o,s,l,u){t=void 0!==t?t:[],e=void 0!==e?e:st,o=void 0!==o?o:Vt,qn.call(this,t,e,n,i,r,a,o,s,l,u),this.flipY=!1}function Ya(t,e,n,i){qn.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.magFilter=vt,this.minFilter=vt,this.wrapR=mt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Xa(t,e,n,i){qn.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.magFilter=vt,this.minFilter=vt,this.wrapR=mt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Da.physical={uniforms:ba([Da.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Un(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new gr(0)},transparency:{value:0}}]),vertexShader:Na.meshphysical_vert,fragmentShader:Na.meshphysical_frag},Qa.prototype=Object.create(qn.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isCubeTexture=!0,Object.defineProperty(Qa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Ya.prototype=Object.create(qn.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isDataTexture2DArray=!0,Xa.prototype=Object.create(qn.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isDataTexture3D=!0;var Za=new qn,Ja=new Ya,Ka=new Xa,to=new Qa,eo=[],no=[],io=new Float32Array(16),ro=new Float32Array(9),ao=new Float32Array(4);function oo(t,e,n){var i=t[0];if(i<=0||i>0)return t;var r=e*n,a=eo[r];if(void 0===a&&(a=new Float32Array(r),eo[r]=a),0!==e){i.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=n,t[o].toArray(a,s)}return a}function so(t,e){if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function lo(t,e){for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}function uo(t,e){var n=no[e];void 0===n&&(n=new Int32Array(e),no[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function co(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function ho(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(so(n,e))return;t.uniform2fv(this.addr,e),lo(n,e)}}function fo(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(so(n,e))return;t.uniform3fv(this.addr,e),lo(n,e)}}function po(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(so(n,e))return;t.uniform4fv(this.addr,e),lo(n,e)}}function mo(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(so(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),lo(n,e)}else{if(so(n,i))return;ao.set(i),t.uniformMatrix2fv(this.addr,!1,ao),lo(n,i)}}function go(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(so(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),lo(n,e)}else{if(so(n,i))return;ro.set(i),t.uniformMatrix3fv(this.addr,!1,ro),lo(n,i)}}function vo(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(so(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),lo(n,e)}else{if(so(n,i))return;io.set(i),t.uniformMatrix4fv(this.addr,!1,io),lo(n,i)}}function yo(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||Za,r)}function bo(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Ja,r)}function xo(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Ka,r)}function _o(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||to,r)}function wo(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function So(t,e){var n=this.cache;so(n,e)||(t.uniform2iv(this.addr,e),lo(n,e))}function Eo(t,e){var n=this.cache;so(n,e)||(t.uniform3iv(this.addr,e),lo(n,e))}function Mo(t,e){var n=this.cache;so(n,e)||(t.uniform4iv(this.addr,e),lo(n,e))}function Co(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function To(t,e){t.uniform1fv(this.addr,e)}function ko(t,e){t.uniform1iv(this.addr,e)}function Po(t,e){t.uniform2iv(this.addr,e)}function Ao(t,e){t.uniform3iv(this.addr,e)}function Oo(t,e){t.uniform4iv(this.addr,e)}function Lo(t,e){var n=oo(e,this.size,2);t.uniform2fv(this.addr,n)}function Ro(t,e){var n=oo(e,this.size,3);t.uniform3fv(this.addr,n)}function Io(t,e){var n=oo(e,this.size,4);t.uniform4fv(this.addr,n)}function No(t,e){var n=oo(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Do(t,e){var n=oo(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function zo(t,e){var n=oo(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Bo(t,e,n){var i=e.length,r=uo(n,i);t.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTexture2D(e[a]||Za,r[a])}function Fo(t,e,n){var i=e.length,r=uo(n,i);t.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTextureCube(e[a]||to,r[a])}function Vo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return co;case 35664:return ho;case 35665:return fo;case 35666:return po;case 35674:return mo;case 35675:return go;case 35676:return vo;case 5124:case 35670:return wo;case 35667:case 35671:return So;case 35668:case 35672:return Eo;case 35669:case 35673:return Mo;case 5125:return Co;case 35678:case 36198:case 36298:case 36306:case 35682:return yo;case 35679:case 36299:case 36307:return xo;case 35680:case 36300:case 36308:case 36293:return _o;case 36289:case 36303:case 36311:case 36292:return bo}}(e.type)}function jo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return To;case 35664:return Lo;case 35665:return Ro;case 35666:return Io;case 35674:return No;case 35675:return Do;case 35676:return zo;case 5124:case 35670:return ko;case 35667:case 35671:return Po;case 35668:case 35672:return Ao;case 35669:case 35673:return Oo;case 35678:case 36198:case 36298:case 36306:case 35682:return Bo;case 35680:case 36300:case 36308:case 36293:return Fo}}(e.type)}function Uo(t){this.id=t,this.seq=[],this.map={}}jo.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),lo(e,t)},Uo.prototype.setValue=function(t,e,n){for(var i=this.seq,r=0,a=i.length;r!==a;++r){var o=i[r];o.setValue(t,e[o.id],n)}};var Ho=/([\w\d_]+)(\])?(\[|\.)?/g;function Go(t,e){t.seq.push(e),t.map[e.id]=e}function Wo(t,e,n){var i=t.name,r=i.length;for(Ho.lastIndex=0;;){var a=Ho.exec(i),o=Ho.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===r){Go(n,void 0===u?new Vo(s,t,e):new jo(s,t,e));break}var c=n.map[s];void 0===c&&Go(n,c=new Uo(s)),n=c}}function qo(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),i=0;i<n;++i){var r=t.getActiveUniform(e,i);Wo(r,t.getUniformLocation(e,r.name),this)}}function $o(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}qo.prototype.setValue=function(t,e,n,i){var r=this.map[e];void 0!==r&&r.setValue(t,n,i)},qo.prototype.setOptional=function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)},qo.upload=function(t,e,n,i){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,i)}},qo.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var a=t[i];a.id in e&&n.push(a)}return n};var Qo=0;function Yo(t){switch(t){case Ke:return["Linear","( value )"];case tn:return["sRGB","( value )"];case nn:return["RGBE","( value )"];case an:return["RGBM","( value, 7.0 )"];case on:return["RGBM","( value, 16.0 )"];case sn:return["RGBD","( value, 256.0 )"];case en:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case rn:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function Xo(t,e,n){var i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+r+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Zo(t,e){var n=Yo(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Jo(t,e){var n;switch(e){case et:n="Linear";break;case nt:n="Reinhard";break;case it:n="Uncharted2";break;case rt:n="OptimizedCineon";break;case at:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ko(t){return""!==t}function ts(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function es(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var ns=/^[ \t]*#include +<([\w\d./]+)>/gm;function is(t){return t.replace(ns,rs)}function rs(t,e){var n=Na[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return is(n)}var as=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,os=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function ss(t){return t.replace(os,us).replace(as,ls)}function ls(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),us(t,e,n,i)}function us(t,e,n,i){for(var r="",a=parseInt(e);a<parseInt(n);a++)r+=i.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function cs(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function hs(t,e,n){var i,r,a,o,s,l=t.getContext(),u=n.defines,c=n.vertexShader,h=n.fragmentShader,d=function(t){var e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===f?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===p?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===m&&(e="SHADOWMAP_TYPE_VSM"),e}(n),g=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case st:case lt:e="ENVMAP_TYPE_CUBE";break;case dt:case ft:e="ENVMAP_TYPE_CUBE_UV";break;case ut:case ct:e="ENVMAP_TYPE_EQUIREC";break;case ht:e="ENVMAP_TYPE_SPHERE"}return e}(n),v=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case lt:case ct:e="ENVMAP_MODE_REFRACTION"}return e}(n),y=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Z:e="ENVMAP_BLENDING_MULTIPLY";break;case J:e="ENVMAP_BLENDING_MIX";break;case K:e="ENVMAP_BLENDING_ADD"}return e}(n),b=t.gammaFactor>0?t.gammaFactor:1,x=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ko).join("\n")}(n),_=function(t){var e=[];for(var n in t){var i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(u),w=l.createProgram();if(n.isRawShaderMaterial?((i=[_].filter(Ko).join("\n")).length>0&&(i+="\n"),(r=[x,_].filter(Ko).join("\n")).length>0&&(r+="\n")):(i=[cs(n),"#define SHADER_NAME "+n.shaderName,_,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ko).join("\n"),r=[x,cs(n),"#define SHADER_NAME "+n.shaderName,_,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+v:"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==tt?"#define TONE_MAPPING":"",n.toneMapping!==tt?Na.tonemapping_pars_fragment:"",n.toneMapping!==tt?Jo("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Na.encodings_pars_fragment:"",n.mapEncoding?Zo("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Zo("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Zo("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Zo("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Zo("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(a="linearToOutputTexel",o=n.outputEncoding,s=Yo(o),"vec4 "+a+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ko).join("\n")),c=es(c=ts(c=is(c),n),n),h=es(h=ts(h=is(h),n),n),c=ss(c),h=ss(h),n.isWebGL2&&!n.isRawShaderMaterial){var S=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==c.match(E)&&null!==h.match(E)&&(S=!0,c=c.replace(E,""),h=h.replace(E,"")),i=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,r=["#version 300 es\n","#define varying in",S?"":"out highp vec4 pc_fragColor;",S?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+r}var M,C,T=r+h,k=$o(l,35633,i+c),P=$o(l,35632,T);if(l.attachShader(w,k),l.attachShader(w,P),void 0!==n.index0AttributeName?l.bindAttribLocation(w,0,n.index0AttributeName):!0===n.morphTargets&&l.bindAttribLocation(w,0,"position"),l.linkProgram(w),t.debug.checkShaderErrors){var A=l.getProgramInfoLog(w).trim(),O=l.getShaderInfoLog(k).trim(),L=l.getShaderInfoLog(P).trim(),R=!0,I=!0;if(!1===l.getProgramParameter(w,35714)){R=!1;var N=Xo(l,k,"vertex"),D=Xo(l,P,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(w,35715),"gl.getProgramInfoLog",A,N,D)}else""!==A?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",A):""!==O&&""!==L||(I=!1);I&&(this.diagnostics={runnable:R,programLog:A,vertexShader:{log:O,prefix:i},fragmentShader:{log:L,prefix:r}})}return l.deleteShader(k),l.deleteShader(P),this.getUniforms=function(){return void 0===M&&(M=new qo(l,w)),M},this.getAttributes=function(){return void 0===C&&(C=function(t,e){for(var n={},i=t.getProgramParameter(e,35721),r=0;r<i;r++){var a=t.getActiveAttrib(e,r).name;n[a]=t.getAttribLocation(e,a)}return n}(l,w)),C},this.destroy=function(){l.deleteProgram(w),this.program=void 0},this.name=n.shaderName,this.id=Qo++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=k,this.fragmentShader=P,this}function ds(t,e,n){var i=[],r=n.isWebGL2,a=n.logarithmicDepthBuffer,o=n.floatVertexTextures,s=n.precision,l=n.maxVertexUniforms,u=n.vertexTextures,c={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function d(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=Ke,e}this.getParameters=function(i,h,f,p,m,g,b){var x=p.fog,_=i.isMeshStandardMaterial?p.environment:null,w=i.envMap||_,S=c[i.type],E=b.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(o)return 1024;var n=l,i=Math.floor((n-20)/4),r=Math.min(i,e.length);return r<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+r+"."),0):r}(b):0;null!==i.precision&&(s=n.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",s,"instead.");var M=function(t,e){var n;if(e){var i=Da[e];n={name:t.type,uniforms:xa.clone(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(i,S);i.onBeforeCompile(M,t);var C=t.getRenderTarget();return{isWebGL2:r,shaderID:S,shaderName:M.name,uniforms:M.uniforms,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,defines:i.defines,isRawShaderMaterial:i.isRawShaderMaterial,isShaderMaterial:i.isShaderMaterial,precision:s,instancing:!0===b.isInstancedMesh,supportsVertexTextures:u,outputEncoding:null!==C?d(C.texture):t.outputEncoding,map:!!i.map,mapEncoding:d(i.map),matcap:!!i.matcap,matcapEncoding:d(i.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:d(w),envMapCubeUV:!!w&&(w.mapping===dt||w.mapping===ft),lightMap:!!i.lightMap,lightMapEncoding:d(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:d(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:i.normalMapType===hn,tangentSpaceNormalMap:i.normalMapType===cn,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||!i.displacementMap),fog:!!x,useFog:i.fog,fogExp2:x&&x.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:a,skinning:i.skinning&&E>0,maxBones:E,useVertexTexture:o,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:tt,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===y,flipSided:i.side===v,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:r||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:r||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:r||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:i.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);if(void 0===e.isRawShaderMaterial){for(var r=0;r<h.length;r++)n.push(e[h[r]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var r,a=0,o=i.length;a<o;a++){var s=i[a];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new hs(t,n,e),i.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},this.programs=i}function fs(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function ps(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ms(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function gs(){var t=[],e=0,n=[],i=[],r={id:-1};function a(n,i,a,o,s,l){var u=t[e];return void 0===u?(u={id:n.id,object:n,geometry:i,material:a,program:a.program||r,groupOrder:o,renderOrder:n.renderOrder,z:s,group:l},t[e]=u):(u.id=n.id,u.object=n,u.geometry=i,u.material=a,u.program=a.program||r,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=s,u.group=l),e++,u}return{opaque:n,transparent:i,init:function(){e=0,n.length=0,i.length=0},push:function(t,e,r,o,s,l){var u=a(t,e,r,o,s,l);(!0===r.transparent?i:n).push(u)},unshift:function(t,e,r,o,s,l){var u=a(t,e,r,o,s,l);(!0===r.transparent?i:n).unshift(u)},finish:function(){for(var n=e,i=t.length;n<i;n++){var r=t[n];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(t,e){n.length>1&&n.sort(t||ps),i.length>1&&i.sort(e||ms)}}}function vs(){var t=new WeakMap;function e(n){var i=n.target;i.removeEventListener("dispose",e),t.delete(i)}return{get:function(n,i){var r,a=t.get(n);return void 0===a?(r=new gs,t.set(n,new WeakMap),t.get(n).set(i,r),n.addEventListener("dispose",e)):void 0===(r=a.get(i))&&(r=new gs,a.set(i,r)),r},dispose:function(){t=new WeakMap}}}function ys(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Kn,color:new gr};break;case"SpotLight":n={position:new Kn,direction:new Kn,color:new gr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Kn,color:new gr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Kn,skyColor:new gr,groundColor:new gr};break;case"RectAreaLight":n={color:new gr,position:new Kn,halfWidth:new Kn,halfHeight:new Kn}}return t[e.id]=n,n}}}var bs=0;function xs(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function _s(){for(var t,e=new ys,n=(t={},{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Un};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Un,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;r<9;r++)i.probe.push(new Kn);var a=new Kn,o=new si,s=new si;return{setup:function(t,r,l){for(var u=0,c=0,h=0,d=0;d<9;d++)i.probe[d].set(0,0,0);var f=0,p=0,m=0,g=0,v=0,y=0,b=0,x=0,_=l.matrixWorldInverse;t.sort(xs),d=0;for(var w=t.length;d<w;d++){var S=t[d],E=S.color,M=S.intensity,C=S.distance,T=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)u+=E.r*M,c+=E.g*M,h+=E.b*M;else if(S.isLightProbe)for(var k=0;k<9;k++)i.probe[k].addScaledVector(S.sh.coefficients[k],M);else if(S.isDirectionalLight){if((O=e.get(S)).color.copy(S.color).multiplyScalar(S.intensity),O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(_),S.castShadow){var P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,i.directionalShadow[f]=A,i.directionalShadowMap[f]=T,i.directionalShadowMatrix[f]=S.shadow.matrix,y++}i.directional[f]=O,f++}else if(S.isSpotLight){if((O=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),O.color.copy(E).multiplyScalar(M),O.distance=C,O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(_),O.coneCos=Math.cos(S.angle),O.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),O.decay=S.decay,S.castShadow){P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,i.spotShadow[m]=A,i.spotShadowMap[m]=T,i.spotShadowMatrix[m]=S.shadow.matrix,x++}i.spot[m]=O,m++}else if(S.isRectAreaLight){(O=e.get(S)).color.copy(E).multiplyScalar(M),O.position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),s.identity(),o.copy(S.matrixWorld),o.premultiply(_),s.extractRotation(o),O.halfWidth.set(.5*S.width,0,0),O.halfHeight.set(0,.5*S.height,0),O.halfWidth.applyMatrix4(s),O.halfHeight.applyMatrix4(s),i.rectArea[g]=O,g++}else if(S.isPointLight){if((O=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),O.color.copy(S.color).multiplyScalar(S.intensity),O.distance=S.distance,O.decay=S.decay,S.castShadow){var A;P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,A.shadowCameraNear=P.camera.near,A.shadowCameraFar=P.camera.far,i.pointShadow[p]=A,i.pointShadowMap[p]=T,i.pointShadowMatrix[p]=S.shadow.matrix,b++}i.point[p]=O,p++}else if(S.isHemisphereLight){var O;(O=e.get(S)).direction.setFromMatrixPosition(S.matrixWorld),O.direction.transformDirection(_),O.direction.normalize(),O.skyColor.copy(S.color).multiplyScalar(M),O.groundColor.copy(S.groundColor).multiplyScalar(M),i.hemi[v]=O,v++}}i.ambient[0]=u,i.ambient[1]=c,i.ambient[2]=h;var L=i.hash;L.directionalLength===f&&L.pointLength===p&&L.spotLength===m&&L.rectAreaLength===g&&L.hemiLength===v&&L.numDirectionalShadows===y&&L.numPointShadows===b&&L.numSpotShadows===x||(i.directional.length=f,i.spot.length=m,i.rectArea.length=g,i.point.length=p,i.hemi.length=v,i.directionalShadow.length=y,i.directionalShadowMap.length=y,i.pointShadow.length=b,i.pointShadowMap.length=b,i.spotShadow.length=x,i.spotShadowMap.length=x,i.directionalShadowMatrix.length=y,i.pointShadowMatrix.length=b,i.spotShadowMatrix.length=x,L.directionalLength=f,L.pointLength=p,L.spotLength=m,L.rectAreaLength=g,L.hemiLength=v,L.numDirectionalShadows=y,L.numPointShadows=b,L.numSpotShadows=x,i.version=bs++)},state:i}}function ws(){var t=new _s,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(i){t.setup(e,n,i)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Ss(){var t=new WeakMap;function e(n){var i=n.target;i.removeEventListener("dispose",e),t.delete(i)}return{get:function(n,i){var r;return!1===t.has(n)?(r=new ws,t.set(n,new WeakMap),t.get(n).set(i,r),n.addEventListener("dispose",e)):!1===t.get(n).has(i)?(r=new ws,t.get(n).set(i,r)):r=t.get(n).get(i),r},dispose:function(){t=new WeakMap}}}function Es(t){wr.call(this),this.type="MeshDepthMaterial",this.depthPacking=ln,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ms(t){wr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Kn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Es.prototype=Object.create(wr.prototype),Es.prototype.constructor=Es,Es.prototype.isMeshDepthMaterial=!0,Es.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ms.prototype=Object.create(wr.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isMeshDistanceMaterial=!0,Ms.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Cs(t,e,n){var i=new Pa,r=new Un,a=new Un,o=new $n,s=[],l=[],u={},c={0:v,1:g,2:y},h=new _a({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Un},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONAL_PASS=1;var p=new Gr;p.setAttribute("position",new Mr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new la(p,h),x=this;function w(n,i){var r=e.update(b);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,h,b,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,d,b,null)}function S(t,e,n){var i=t<<0|e<<1|n<<2,r=s[i];return void 0===r&&(r=new Es({depthPacking:un,morphTargets:t,skinning:e}),s[i]=r),r}function E(t,e,n){var i=t<<0|e<<1|n<<2,r=l[i];return void 0===r&&(r=new Ms({morphTargets:t,skinning:e}),l[i]=r),r}function M(e,n,i,r,a,o,s){var l=null,h=S,d=e.customDepthMaterial;if(!0===r.isPointLight&&(h=E,d=e.customDistanceMaterial),void 0===d){var f=!1;!0===i.morphTargets&&(f=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var p=!1;!0===e.isSkinnedMesh&&(!0===i.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),l=h(f,p,!0===e.isInstancedMesh)}else l=d;if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var g=l.uuid,v=i.uuid,y=u[g];void 0===y&&(y={},u[g]=y);var b=y[v];void 0===b&&(b=l.clone(),y[v]=b),l=b}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=s===m?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:c[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===r.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(r.matrixWorld),l.nearDistance=a,l.farDistance=o),l}function C(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===m)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=e.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var f=c[h],p=u[f.materialIndex];if(p&&p.visible){var g=M(n,l,p,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,g,n,f)}}else if(u.visible){g=M(n,l,u,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,g,n,null)}}for(var v=n.children,y=0,b=v.length;y<b;y++)C(v[y],r,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f,this.render=function(e,s,l){if(!1!==x.enabled&&(!1!==x.autoUpdate||!1!==x.needsUpdate)&&0!==e.length){var u=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(_),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=e.length;f<p;f++){var g=e[f],v=g.shadow;if(void 0!==v){r.copy(v.mapSize);var y=v.getFrameExtents();if(r.multiply(y),a.copy(v.mapSize),(r.x>n||r.y>n)&&(r.x>n&&(a.x=Math.floor(n/y.x),r.x=a.x*y.x,v.mapSize.x=a.x),r.y>n&&(a.y=Math.floor(n/y.y),r.y=a.y*y.y,v.mapSize.y=a.y)),null===v.map&&!v.isPointLightShadow&&this.type===m){var b={minFilter:wt,magFilter:wt,format:jt};v.map=new Qn(r.x,r.y,b),v.map.texture.name=g.name+".shadowMap",v.mapPass=new Qn(r.x,r.y,b),v.camera.updateProjectionMatrix()}if(null===v.map){b={minFilter:vt,magFilter:vt,format:jt};v.map=new Qn(r.x,r.y,b),v.map.texture.name=g.name+".shadowMap",v.camera.updateProjectionMatrix()}t.setRenderTarget(v.map),t.clear();for(var S=v.getViewportCount(),E=0;E<S;E++){var M=v.getViewport(E);o.set(a.x*M.x,a.y*M.y,a.x*M.z,a.y*M.w),d.viewport(o),v.updateMatrices(g,E),i=v.getFrustum(),C(s,l,v.camera,g,this.type)}v.isPointLightShadow||this.type!==m||w(v,l)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}x.needsUpdate=!1,t.setRenderTarget(u,c,h)}}}function Ts(t,e,n){var i=n.isWebGL2;var r=new function(){var e=!1,n=new $n,i=null,r=new $n(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,a,o,s){!0===s&&(e*=o,i*=o,a*=o),n.set(e,i,a,o),!1===r.equals(n)&&(t.clearColor(e,i,a,o),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},a=new function(){var e=!1,n=null,i=null,r=null;return{setTest:function(t){t?bt(2929):xt(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case H:t.depthFunc(512);break;case G:t.depthFunc(519);break;case W:t.depthFunc(513);break;case q:t.depthFunc(515);break;case $:t.depthFunc(514);break;case Q:t.depthFunc(518);break;case Y:t.depthFunc(516);break;case X:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},u=new function(){var e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?bt(2960):xt(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,o){i===e&&r===n&&a===o||(t.stencilFunc(e,n,o),i=e,r=n,a=o)},setOp:function(e,n,i){o===e&&s===n&&l===i||(t.stencilOp(e,n,i),o=e,s=n,l=i)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null}}},c=t.getParameter(34921),h=new Uint8Array(c),d=new Uint8Array(c),f=new Uint8Array(c),p={},m=null,g=null,b=null,x=null,Z=null,J=null,K=null,tt=null,et=null,nt=!1,it=null,rt=null,at=null,ot=null,st=null,lt=t.getParameter(35661),ut=!1,ct=0,ht=t.getParameter(7938);-1!==ht.indexOf("WebGL")?(ct=parseFloat(/^WebGL\ ([0-9])/.exec(ht)[1]),ut=ct>=1):-1!==ht.indexOf("OpenGL ES")&&(ct=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ht)[1]),ut=ct>=2);var dt=null,ft={},pt=new $n,mt=new $n;function gt(e,n,i){var r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var o=0;o<i;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,r);return a}var vt={};function yt(n,r){(h[n]=1,0===d[n]&&(t.enableVertexAttribArray(n),d[n]=1),f[n]!==r)&&((i?t:e.get("ANGLE_instanced_arrays"))[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),f[n]=r)}function bt(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function xt(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}vt[3553]=gt(3553,3553,1),vt[34067]=gt(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),u.setClear(0),bt(2929),a.setFunc(q),Mt(!1),Ct(s),bt(2884),Et(_);var _t={[T]:32774,[k]:32778,[P]:32779};if(i)_t[A]=32775,_t[O]=32776;else{var wt=e.get("EXT_blend_minmax");null!==wt&&(_t[A]=wt.MIN_EXT,_t[O]=wt.MAX_EXT)}var St={[L]:0,[R]:1,[I]:768,[D]:770,[U]:776,[V]:774,[B]:772,[N]:769,[z]:771,[j]:775,[F]:773};function Et(e,n,i,r,a,o,s,l){if(e!==_){if(g||(bt(3042),g=!0),e===C)a=a||n,o=o||i,s=s||r,n===x&&a===K||(t.blendEquationSeparate(_t[n],_t[a]),x=n,K=a),i===Z&&r===J&&o===tt&&s===et||(t.blendFuncSeparate(St[i],St[r],St[o],St[s]),Z=i,J=r,tt=o,et=s),b=e,nt=null;else if(e!==b||l!==nt){if(x===T&&K===T||(t.blendEquation(32774),x=T,K=T),l)switch(e){case w:t.blendFuncSeparate(1,771,1,771);break;case S:t.blendFunc(1,1);break;case E:t.blendFuncSeparate(0,0,769,771);break;case M:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case w:t.blendFuncSeparate(770,771,1,771);break;case S:t.blendFunc(770,1);break;case E:t.blendFunc(0,769);break;case M:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}Z=null,J=null,tt=null,et=null,b=e,nt=l}}else g&&(xt(3042),g=!1)}function Mt(e){it!==e&&(e?t.frontFace(2304):t.frontFace(2305),it=e)}function Ct(e){e!==o?(bt(2884),e!==rt&&(e===s?t.cullFace(1029):e===l?t.cullFace(1028):t.cullFace(1032))):xt(2884),rt=e}function Tt(e,n,i){e?(bt(32823),ot===n&&st===i||(t.polygonOffset(n,i),ot=n,st=i)):xt(32823)}function kt(e){void 0===e&&(e=33984+lt-1),dt!==e&&(t.activeTexture(e),dt=e)}return{buffers:{color:r,depth:a,stencil:u},initAttributes:function(){for(var t=0,e=h.length;t<e;t++)h[t]=0},enableAttribute:function(t){yt(t,0)},enableAttributeAndDivisor:yt,disableUnusedAttributes:function(){for(var e=0,n=d.length;e!==n;++e)d[e]!==h[e]&&(t.disableVertexAttribArray(e),d[e]=0)},vertexAttribPointer:function(e,n,r,a,o,s){!0!==i||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,a,o,s):t.vertexAttribIPointer(e,n,r,a,o,s)},enable:bt,disable:xt,useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:Et,setMaterial:function(t,e){t.side===y?xt(2884):bt(2884);var n=t.side===v;e&&(n=!n),Mt(n),t.blending===w&&!1===t.transparent?Et(_):Et(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),r.setMask(t.colorWrite);var i=t.stencilWrite;u.setTest(i),i&&(u.setMask(t.stencilWriteMask),u.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),u.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Tt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:Mt,setCullFace:Ct,setLineWidth:function(e){e!==at&&(ut&&t.lineWidth(e),at=e)},setPolygonOffset:Tt,setScissorTest:function(t){t?bt(3089):xt(3089)},activeTexture:kt,bindTexture:function(e,n){null===dt&&kt();var i=ft[dt];void 0===i&&(i={type:void 0,texture:void 0},ft[dt]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||vt[e]),i.type=e,i.texture=n)},unbindTexture:function(){var e=ft[dt];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===pt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),pt.copy(e))},viewport:function(e){!1===mt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),mt.copy(e))},reset:function(){for(var e=0;e<d.length;e++)1===d[e]&&(t.disableVertexAttribArray(e),d[e]=0);p={},dt=null,ft={},m=null,b=null,it=null,rt=null,r.reset(),a.reset(),u.reset()}}}function ks(t,e,n,i,r,a,o){var s,l=r.isWebGL2,u=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,d=r.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function m(t,e){return p?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,i){var r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?jn.floorPowerOfTwo:Math.floor,o=a(r*t.width),l=a(r*t.height);void 0===s&&(s=m(o,l));var u=n?m(o,l):s;return u.width=o,u.height=l,u.getContext("2d").drawImage(t,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+l+")."),u}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function v(t){return jn.isPowerOfTwo(t.width)&&jn.isPowerOfTwo(t.height)}function y(t,e){return t.generateMipmaps&&e&&t.minFilter!==vt&&t.minFilter!==wt}function b(e,n,r,a){t.generateMipmap(e),i.get(n).__maxMipLevel=Math.log(Math.max(r,a))*Math.LOG2E}function x(n,i,r){if(!1===l)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===i&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||e.get("EXT_color_buffer_float"),a}function _(t){return t===vt||t===yt||t===xt?9728:9729}function w(e){var n=e.target;n.removeEventListener("dispose",w),function(e){var n=i.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),i.remove(e)}(n),n.isVideoTexture&&f.delete(n),o.memory.textures--}function S(e){var n=e.target;n.removeEventListener("dispose",S),function(e){var n=i.get(e),r=i.get(e.texture);if(!e)return;void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)t.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[a]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);i.remove(e.texture),i.remove(e)}(n),o.memory.textures--}var E=0;function M(t,e){var r=i.get(t);if(t.isVideoTexture&&function(t){var e=o.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void L(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function C(e,r){if(6===e.image.length){var o=i.get(e);if(e.version>0&&o.__version!==e.version){O(o,e),n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),u=e.image[0]&&e.image[0].isDataTexture,h=[],d=0;d<6;d++)h[d]=s||u?u?e.image[d].image:e.image[d]:g(e.image[d],!1,!0,c);var f,p=h[0],m=v(p)||l,_=a.convert(e.format),w=a.convert(e.type),S=x(e.internalFormat,_,w);if(A(34067,e,m),s){for(d=0;d<6;d++){f=h[d].mipmaps;for(var E=0;E<f.length;E++){var M=f[E];e.format!==jt&&e.format!==Vt?null!==_?n.compressedTexImage2D(34069+d,E,S,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+d,E,S,M.width,M.height,0,_,w,M.data)}}o.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(d=0;d<6;d++)if(u){n.texImage2D(34069+d,0,S,h[d].width,h[d].height,0,_,w,h[d].data);for(E=0;E<f.length;E++){var C=(M=f[E]).image[d].image;n.texImage2D(34069+d,E+1,S,C.width,C.height,0,_,w,C.data)}}else{n.texImage2D(34069+d,0,S,_,w,h[d]);for(E=0;E<f.length;E++){M=f[E];n.texImage2D(34069+d,E+1,S,_,w,M.image[d])}}o.__maxMipLevel=f.length}y(e,m)&&b(34067,e,p.width,p.height),o.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture)}}function T(t,e){n.activeTexture(33984+e),n.bindTexture(34067,i.get(t).__webglTexture)}var k={[pt]:10497,[mt]:33071,[gt]:33648},P={[vt]:9728,[yt]:9984,[xt]:9986,[wt]:9729,[St]:9985,[Mt]:9987};function A(n,a,o){o?(t.texParameteri(n,10242,k[a.wrapS]),t.texParameteri(n,10243,k[a.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,k[a.wrapR]),t.texParameteri(n,10240,P[a.magFilter]),t.texParameteri(n,10241,P[a.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),a.wrapS===mt&&a.wrapT===mt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,_(a.magFilter)),t.texParameteri(n,10241,_(a.minFilter)),a.minFilter!==vt&&a.minFilter!==wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=e.get("EXT_texture_filter_anisotropic");if(s){if(a.type===Rt&&null===e.get("OES_texture_float_linear"))return;if(a.type===It&&null===(l||e.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function O(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),o.memory.textures++)}function L(e,i,r){var o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),O(e,i),n.activeTexture(33984+r),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment);var s=function(t){return!l&&(t.wrapS!==mt||t.wrapT!==mt||t.minFilter!==vt&&t.minFilter!==wt)}(i)&&!1===v(i.image),u=g(i.image,s,!1,h),c=v(u)||l,d=a.convert(i.format),f=a.convert(i.type),p=x(i.internalFormat,d,f);A(o,i,c);var m,_=i.mipmaps;if(i.isDepthTexture)p=6402,l?p=i.type===Rt?36012:i.type===Lt?33190:i.type===Bt?35056:33189:i.type===Rt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Wt&&6402===p&&i.type!==At&&i.type!==Lt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=At,f=a.convert(i.type)),i.format===qt&&6402===p&&(p=34041,i.type!==Bt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Bt,f=a.convert(i.type))),n.texImage2D(3553,0,p,u.width,u.height,0,d,f,null);else if(i.isDataTexture)if(_.length>0&&c){for(var w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,m.width,m.height,0,d,f,m.data);i.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,u.width,u.height,0,d,f,u.data),e.__maxMipLevel=0;else if(i.isCompressedTexture){for(w=0,S=_.length;w<S;w++)m=_[w],i.format!==jt&&i.format!==Vt?null!==d?n.compressedTexImage2D(3553,w,p,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,p,m.width,m.height,0,d,f,m.data);e.__maxMipLevel=_.length-1}else if(i.isDataTexture2DArray)n.texImage3D(35866,0,p,u.width,u.height,u.depth,0,d,f,u.data),e.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(32879,0,p,u.width,u.height,u.depth,0,d,f,u.data),e.__maxMipLevel=0;else if(_.length>0&&c){for(w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,d,f,m);i.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,d,f,u),e.__maxMipLevel=0;y(i,c)&&b(o,i,u.width,u.height),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function R(e,r,o,s){var l=a.convert(r.texture.format),u=a.convert(r.texture.type),c=x(r.texture.internalFormat,l,u);n.texImage2D(s,0,c,r.width,r.height,0,l,u,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,s,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function I(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var r=33189;if(i){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Rt?r=36012:o.type===Lt&&(r=33190));var s=D(n);t.renderbufferStorageMultisample(36161,s,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(i){s=D(n);t.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var l=a.convert(n.texture.format),u=a.convert(n.texture.type);r=x(n.texture.internalFormat,l,u);if(i){s=D(n);t.renderbufferStorageMultisample(36161,s,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height)}t.bindRenderbuffer(36161,null)}function N(e){var n=i.get(e),r=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),M(n.depthTexture,0);var r=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Wt)t.framebufferTexture2D(36160,36096,3553,r,0);else{if(n.depthTexture.format!==qt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,r,0)}}(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=t.createRenderbuffer(),I(n.__webglDepthbuffer[a],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),I(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function D(t){return l&&t.isWebGLMultisampleRenderTarget?Math.min(d,t.samples):0}var z=!1,B=!1;this.allocateTextureUnit=function(){var t=E;return t>=u&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+u),E+=1,t},this.resetTextureUnits=function(){E=0},this.setTexture2D=M,this.setTexture2DArray=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=C,this.setTextureCubeDynamic=T,this.setupRenderTarget=function(e){var r=i.get(e),s=i.get(e.texture);e.addEventListener("dispose",S),s.__webglTexture=t.createTexture(),o.memory.textures++;var u=!0===e.isWebGLCubeRenderTarget,c=!0===e.isWebGLMultisampleRenderTarget,h=v(e)||l;if(!l||e.texture.format!==Vt||e.texture.type!==Rt&&e.texture.type!==It||(e.texture.format=jt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){r.__webglFramebuffer=[];for(var d=0;d<6;d++)r.__webglFramebuffer[d]=t.createFramebuffer()}else if(r.__webglFramebuffer=t.createFramebuffer(),c)if(l){r.__webglMultisampledFramebuffer=t.createFramebuffer(),r.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,r.__webglColorRenderbuffer);var f=a.convert(e.texture.format),p=a.convert(e.texture.type),m=x(e.texture.internalFormat,f,p),g=D(e);t.renderbufferStorageMultisample(36161,g,m,e.width,e.height),t.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(r.__webglDepthRenderbuffer=t.createRenderbuffer(),I(r.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,s.__webglTexture),A(34067,e.texture,h);for(d=0;d<6;d++)R(r.__webglFramebuffer[d],e,36064,34069+d);y(e.texture,h)&&b(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),A(3553,e.texture,h),R(r.__webglFramebuffer,e,36064,3553),y(e.texture,h)&&b(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&N(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(y(e,v(t)||l)){var r=t.isWebGLCubeRenderTarget?34067:3553,a=i.get(e).__webglTexture;n.bindTexture(r,a),b(r,e,t.width,t.height),n.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(l){var n=i.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var r=e.width,a=e.height,o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024),t.blitFramebuffer(0,0,r,a,0,0,r,a,o,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),M(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?C(t,e):T(t,e)}}function Ps(t,e,n){var i=n.isWebGL2;return{convert:function(t){var n;if(t===Tt)return 5121;if(t===Nt)return 32819;if(t===Dt)return 32820;if(t===zt)return 33635;if(t===kt)return 5120;if(t===Pt)return 5122;if(t===At)return 5123;if(t===Ot)return 5124;if(t===Lt)return 5125;if(t===Rt)return 5126;if(t===It)return i?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(t===Ft)return 6406;if(t===Vt)return 6407;if(t===jt)return 6408;if(t===Ut)return 6409;if(t===Ht)return 6410;if(t===Wt)return 6402;if(t===qt)return 34041;if(t===$t)return 6403;if(t===Qt)return 36244;if(t===Yt)return 33319;if(t===Xt)return 33320;if(t===Zt)return 36248;if(t===Jt)return 36249;if(t===Kt||t===te||t===ee||t===ne){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===Kt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===te)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===ee)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===ne)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===ie||t===re||t===ae||t===oe){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===ie)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===re)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ae)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===oe)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===se)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===le||t===ue)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(t===le)return n.COMPRESSED_RGB8_ETC2;if(t===ue)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===ce||t===he||t===de||t===fe||t===pe||t===me||t===ge||t===ve||t===ye||t===be||t===xe||t===_e||t===we||t===Se||t===Me||t===Ce||t===Te||t===ke||t===Pe||t===Ae||t===Oe||t===Le||t===Re||t===Ie||t===Ne||t===De||t===ze||t===Be?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:t===Ee?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:t===Bt?i?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function As(t){Sa.call(this),this.cameras=t||[]}function Os(){Mi.call(this),this.type="Group"}function Ls(){this._targetRay=null,this._grip=null}function Rs(t,e){var n=this,i=null,r=1,a=null,o="local-floor",s=null,l=[],u=new Map,c=new Sa;c.layers.enable(1),c.viewport=new $n;var h=new Sa;h.layers.enable(2),h.viewport=new $n;var d=[c,h],f=new As;f.layers.enable(1),f.layers.enable(2);var p=null,m=null;function g(t){var e=u.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function v(){u.forEach((function(t,e){t.disconnect(e)})),u.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(t){a=t,E.setContext(i),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function b(t){for(var e=i.inputSources,n=0;n<l.length;n++)u.set(e[n],l[n]);for(n=0;n<t.removed.length;n++){var r=t.removed[n];(a=u.get(r))&&(a.dispatchEvent({type:"disconnected",data:r}),u.delete(r))}for(n=0;n<t.added.length;n++){var a;r=t.added[n];(a=u.get(r))&&a.dispatchEvent({type:"connected",data:r})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=l[t];return void 0===e&&(e=new Ls,l[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=l[t];return void 0===e&&(e=new Ls,l[t]=e),e.getGripSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return i},this.setSession=function(t){if(null!==(i=t)){i.addEventListener("select",g),i.addEventListener("selectstart",g),i.addEventListener("selectend",g),i.addEventListener("squeeze",g),i.addEventListener("squeezestart",g),i.addEventListener("squeezeend",g),i.addEventListener("end",v);var n=e.getContextAttributes(),a={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:r},s=new XRWebGLLayer(i,e,a);i.updateRenderState({baseLayer:s}),i.requestReferenceSpace(o).then(y),i.addEventListener("inputsourceschange",b)}};var x=new Kn,_=new Kn;function w(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=h.near=c.near=t.near,f.far=h.far=c.far=t.far,p===f.near&&m===f.far||(i.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,m=f.far);var e=t.parent,n=f.cameras;w(f,e);for(var r=0;r<n.length;r++)w(n[r],e);t.matrixWorld.copy(f.matrixWorld);for(var a=t.children,o=(r=0,a.length);r<o;r++)a[r].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){x.setFromMatrixPosition(e.matrixWorld),_.setFromMatrixPosition(n.matrixWorld);var i=x.distanceTo(_),r=e.projectionMatrix.elements,a=n.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],c=(r[8]-1)/r[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=i/(-c+h),m=p*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=o+p,v=s+p,y=d-m,b=f+(i-m),w=l*s/v*g,S=u*s/v*g;t.projectionMatrix.makePerspective(y,b,w,S,g,v)}(f,c,h):f.projectionMatrix.copy(c.projectionMatrix),f};var S=null;var E=new Oa;E.setAnimationLoop((function(e,n){if(null!==(s=n.getViewerPose(a))){var r=s.views,o=i.renderState.baseLayer;t.setFramebuffer(o.framebuffer);var u=!1;r.length!==f.cameras.length&&(f.cameras.length=0,u=!0);for(var c=0;c<r.length;c++){var h=r[c],p=o.getViewport(h),m=d[c];m.matrix.fromArray(h.transform.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(p.x,p.y,p.width,p.height),0===c&&f.matrix.copy(m.matrix),!0===u&&f.cameras.push(m)}}var g=i.inputSources;for(c=0;c<l.length;c++){var v=l[c],y=g[c];v.update(y,n,a)}S&&S(e,n)})),this.setAnimationLoop=function(t){S=t},this.dispose=function(){}}function Is(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",c=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,h=null,d=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ke,this.physicallyCorrectLights=!1,this.toneMapping=tt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,p,m,g,y,b,x,_,w,S,E,M,C,T,k,P,A,O,L=this,R=!1,I=null,N=0,D=0,z=null,B=null,F=-1,V={geometry:null,program:null,wireframe:!1},j=null,U=null,H=new $n,G=new $n,W=null,q=e.width,$=e.height,Q=1,Y=null,X=null,Z=new $n(0,0,q,$),J=new $n(0,0,q,$),K=!1,et=new Pa,nt=new Va,it=!1,rt=!1,at=new si,ot=new Kn;function st(){return null===z?Q:1}try{var lt={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(e.addEventListener("webglcontextlost",dt,!1),e.addEventListener("webglcontextrestored",ft,!1),null===(f=n||e.getContext("webgl",lt)||e.getContext("experimental-webgl",lt)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function ut(){p=new ja(f),!1===(m=new Fa(f,p,t)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),O=new Ps(f,p,m),(g=new Ts(f,p,m)).scissor(G.copy(J).multiplyScalar(Q).floor()),g.viewport(H.copy(Z).multiplyScalar(Q).floor()),y=new Ga(f),b=new fs,x=new ks(f,p,g,b,m,O,y),_=new La(f,m),w=new Ua(f,_,y),S=new $a(f,w,_,y),k=new qa(f),E=new ds(L,p,m),M=new vs,C=new Ss,T=new za(L,g,S,s),P=new Ba(f,p,y,m),A=new Ha(f,p,y,m),y.programs=E.programs,L.capabilities=m,L.extensions=p,L.properties=b,L.renderLists=M,L.state=g,L.info=y}ut();var ct=new Rs(L,f);this.xr=ct;var ht=new Cs(L,S,m.maxTextureSize);function dt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function ft(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1,ut()}function pt(t){var e=t.target;e.removeEventListener("dispose",pt),function(t){mt(t),b.remove(t)}(e)}function mt(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&E.releaseProgram(e)}this.shadowMap=ht,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var t=p.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=p.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(t){void 0!==t&&(Q=t,this.setSize(q,$,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Un),t.set(q,$)},this.setSize=function(t,n,i){ct.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(q=t,$=n,e.width=Math.floor(t*Q),e.height=Math.floor(n*Q),!1!==i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Un),t.set(q*Q,$*Q).floor()},this.setDrawingBufferSize=function(t,n,i){q=t,$=n,Q=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new $n),t.copy(H)},this.getViewport=function(t){return t.copy(Z)},this.setViewport=function(t,e,n,i){t.isVector4?Z.set(t.x,t.y,t.z,t.w):Z.set(t,e,n,i),g.viewport(H.copy(Z).multiplyScalar(Q).floor())},this.getScissor=function(t){return t.copy(J)},this.setScissor=function(t,e,n,i){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,n,i),g.scissor(G.copy(J).multiplyScalar(Q).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(t){g.setScissorTest(K=t)},this.setOpaqueSort=function(t){Y=t},this.setTransparentSort=function(t){X=t},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),f.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",dt,!1),e.removeEventListener("webglcontextrestored",ft,!1),M.dispose(),C.dispose(),b.dispose(),S.dispose(),ct.dispose(),yt.stop()},this.renderBufferImmediate=function(t,e){g.initAttributes();var n=b.get(t);t.hasPositions&&!n.position&&(n.position=f.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),t.hasColors&&!n.color&&(n.color=f.createBuffer());var i=e.getAttributes();t.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,t.positionArray,35048),g.enableAttribute(i.position),f.vertexAttribPointer(i.position,3,5126,!1,0,0)),t.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,t.normalArray,35048),g.enableAttribute(i.normal),f.vertexAttribPointer(i.normal,3,5126,!1,0,0)),t.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,t.uvArray,35048),g.enableAttribute(i.uv),f.vertexAttribPointer(i.uv,2,5126,!1,0,0)),t.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,t.colorArray,35048),g.enableAttribute(i.color),f.vertexAttribPointer(i.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,t.count),t.count=0};var gt=new Ci;this.renderBufferDirect=function(t,e,n,i,r,a){null===e&&(e=gt);var o=r.isMesh&&r.matrixWorld.determinant()<0,s=St(t,e,i,r);g.setMaterial(i,o);var l=!1;V.geometry===n.id&&V.program===s.id&&V.wireframe===(!0===i.wireframe)||(V.geometry=n.id,V.program=s.id,V.wireframe=!0===i.wireframe,l=!0),(i.morphTargets||i.morphNormals)&&(k.update(r,n,i,s),l=!0),!0===r.isInstancedMesh&&(l=!0);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var h,d=1;!0===i.wireframe&&(u=w.getWireframeAttribute(n),d=2);var v=P;null!==u&&(h=_.get(u),(v=A).setIndex(h)),l&&(!function(t,e,n,i){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;g.initAttributes();var r=e.attributes,a=i.getAttributes(),o=n.defaultAttributeValues;for(var s in a){var l=a[s];if(l>=0){var u=r[s];if(void 0!==u){var c=u.normalized,h=u.itemSize;if(void 0===(S=_.get(u)))continue;var d=S.buffer,v=S.type,y=S.bytesPerElement;if(u.isInterleavedBufferAttribute){var b=u.data,x=b.stride,w=u.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(l,b.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(l),f.bindBuffer(34962,d),g.vertexAttribPointer(l,h,v,c,x*y,w*y)}else u.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=u.meshPerAttribute*u.count)):g.enableAttribute(l),f.bindBuffer(34962,d),g.vertexAttribPointer(l,h,v,c,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=_.get(t.instanceMatrix)))continue;d=S.buffer,v=S.type;g.enableAttributeAndDivisor(l+0,1),g.enableAttributeAndDivisor(l+1,1),g.enableAttributeAndDivisor(l+2,1),g.enableAttributeAndDivisor(l+3,1),f.bindBuffer(34962,d),f.vertexAttribPointer(l+0,4,v,!1,64,0),f.vertexAttribPointer(l+1,4,v,!1,64,16),f.vertexAttribPointer(l+2,4,v,!1,64,32),f.vertexAttribPointer(l+3,4,v,!1,64,48)}else if(void 0!==o){var E=o[s];if(void 0!==E)switch(E.length){case 2:f.vertexAttrib2fv(l,E);break;case 3:f.vertexAttrib3fv(l,E);break;case 4:f.vertexAttrib4fv(l,E);break;default:f.vertexAttrib1fv(l,E)}}}}g.disableUnusedAttributes()}(r,n,i,s),null!==u&&f.bindBuffer(34963,h.buffer));var y=null!==u?u.count:c.count,b=n.drawRange.start*d,x=n.drawRange.count*d,S=null!==a?a.start*d:0,E=null!==a?a.count*d:1/0,M=Math.max(b,S),C=Math.min(y,b+x,S+E)-1,T=Math.max(0,C-M+1);if(0!==T){if(r.isMesh)!0===i.wireframe?(g.setLineWidth(i.wireframeLinewidth*st()),v.setMode(1)):v.setMode(4);else if(r.isLine){var O=i.linewidth;void 0===O&&(O=1),g.setLineWidth(O*st()),r.isLineSegments?v.setMode(1):r.isLineLoop?v.setMode(2):v.setMode(3)}else r.isPoints?v.setMode(0):r.isSprite&&v.setMode(4);r.isInstancedMesh?v.renderInstances(n,M,T,r.count):n.isInstancedBufferGeometry?v.renderInstances(n,M,T,n.maxInstancedCount):v.render(M,T)}},this.compile=function(t,e){(d=C.get(t,e)).init(),t.traverse((function(t){t.isLight&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var i=0;i<e.material.length;i++)e.material[i].uuid in n==!1&&(wt(e.material[i],t,e),n[e.material[i].uuid]=!0);else e.material.uuid in n==!1&&(wt(e.material,t,e),n[e.material.uuid]=!0)}))};var vt=null;var yt=new Oa;function bt(t,e,n,i){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||et.intersectsSprite(t)){i&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at);var r=S.update(t);(a=t.material).visible&&h.push(t,r,a,n,ot.z,null)}}else if(t.isImmediateRenderObject)i&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at),h.push(t,null,t.material,n,ot.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==y.render.frame&&(t.skeleton.update(),t.skeleton.frame=y.render.frame),!t.frustumCulled||et.intersectsObject(t))){i&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at);r=S.update(t);var a=t.material;if(Array.isArray(a))for(var o=r.groups,s=0,l=o.length;s<l;s++){var u=o[s],c=a[u.materialIndex];c&&c.visible&&h.push(t,r,c,n,ot.z,u)}else a.visible&&h.push(t,r,a,n,ot.z,null)}var f=t.children;for(s=0,l=f.length;s<l;s++)bt(f[s],e,n,i)}}function xt(t,e,n,i){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,l=o.geometry,u=void 0===i?o.material:i,c=o.group;if(n.isArrayCamera){U=n;for(var h=n.cameras,f=0,p=h.length;f<p;f++){var m=h[f];s.layers.test(m.layers)&&(g.viewport(H.copy(m.viewport)),d.setupLights(m),_t(s,e,m,l,u,c))}}else U=null,_t(s,e,n,l,u,c)}}function _t(t,e,n,i,r,a){if(t.onBeforeRender(L,e,n,i,r,a),d=C.get(e,U||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=St(n,e,r,t);g.setMaterial(r),V.geometry=null,V.program=null,V.wireframe=!1,function(t,e){t.render((function(t){L.renderBufferImmediate(t,e)}))}(t,o)}else L.renderBufferDirect(n,e,i,r,t,a);t.onAfterRender(L,e,n,i,r,a),d=C.get(e,U||n)}function wt(t,e,n){var i=b.get(t),r=d.state.lights,a=d.state.shadowsArray,o=r.state.version,s=E.getParameters(t,r.state,a,e,nt.numPlanes,nt.numIntersection,n),l=E.getProgramCacheKey(s),u=i.program,c=!0;if(void 0===u)t.addEventListener("dispose",pt);else if(u.cacheKey!==l)mt(t);else if(i.lightsStateVersion!==o)i.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(u=E.acquireProgram(s,l),i.program=u,i.uniforms=s.uniforms,i.outputEncoding=s.outputEncoding,t.program=u);var h=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var f=0;f<L.maxMorphTargets;f++)h["morphTarget"+f]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(f=0;f<L.maxMorphNormals;f++)h["morphNormal"+f]>=0&&t.numSupportedMorphNormals++}var p=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(i.numClippingPlanes=nt.numPlanes,i.numIntersection=nt.numIntersection,p.clippingPlanes=nt.uniform),i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=o,i.needsLights&&(p.ambientLightColor.value=r.state.ambient,p.lightProbe.value=r.state.probe,p.directionalLights.value=r.state.directional,p.directionalLightShadows.value=r.state.directionalShadow,p.spotLights.value=r.state.spot,p.spotLightShadows.value=r.state.spotShadow,p.rectAreaLights.value=r.state.rectArea,p.pointLights.value=r.state.point,p.pointLightShadows.value=r.state.pointShadow,p.hemisphereLights.value=r.state.hemi,p.directionalShadowMap.value=r.state.directionalShadowMap,p.directionalShadowMatrix.value=r.state.directionalShadowMatrix,p.spotShadowMap.value=r.state.spotShadowMap,p.spotShadowMatrix.value=r.state.spotShadowMatrix,p.pointShadowMap.value=r.state.pointShadowMap,p.pointShadowMatrix.value=r.state.pointShadowMatrix);var m=i.program.getUniforms(),g=qo.seqWithValue(m.seq,p);i.uniformsList=g}function St(t,e,n,i){x.resetTextureUnits();var r=e.fog,a=n.isMeshStandardMaterial?e.environment:null,o=null===z?L.outputEncoding:z.texture.encoding,s=b.get(n),l=d.state.lights;if(it&&(rt||t!==j)){var u=t===j&&n.id===F;nt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,s,u)}n.version===s.__version?void 0===s.program||n.fog&&s.fog!==r||s.environment!==a||s.needsLights&&s.lightsStateVersion!==l.state.version?wt(n,e,i):void 0===s.numClippingPlanes||s.numClippingPlanes===nt.numPlanes&&s.numIntersection===nt.numIntersection?s.outputEncoding!==o&&wt(n,e,i):wt(n,e,i):(wt(n,e,i),s.__version=n.version);var c,h,p=!1,y=!1,_=!1,w=s.program,S=w.getUniforms(),E=s.uniforms;if(g.useProgram(w.program)&&(p=!0,y=!0,_=!0),n.id!==F&&(F=n.id,y=!0),p||j!==t){if(S.setValue(f,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&S.setValue(f,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),j!==t&&(j=t,y=!0,_=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var M=S.map.cameraPosition;void 0!==M&&M.setValue(f,ot.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&S.setValue(f,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&S.setValue(f,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){S.setOptional(f,i,"bindMatrix"),S.setOptional(f,i,"bindMatrixInverse");var C=i.skeleton;if(C){var T=C.bones;if(m.floatVertexTextures){if(void 0===C.boneTexture){var k=Math.sqrt(4*T.length);k=jn.ceilPowerOfTwo(k),k=Math.max(k,4);var P=new Float32Array(k*k*4);P.set(C.boneMatrices);var A=new Ca(P,k,k,jt,Rt);C.boneMatrices=P,C.boneTexture=A,C.boneTextureSize=k}S.setValue(f,"boneTexture",C.boneTexture,x),S.setValue(f,"boneTextureSize",C.boneTextureSize)}else S.setOptional(f,C,"boneMatrices")}}return(y||s.receiveShadow!==i.receiveShadow)&&(s.receiveShadow=i.receiveShadow,S.setValue(f,"receiveShadow",i.receiveShadow)),y&&(S.setValue(f,"toneMappingExposure",L.toneMappingExposure),S.setValue(f,"toneMappingWhitePoint",L.toneMappingWhitePoint),s.needsLights&&(h=_,(c=E).ambientLightColor.needsUpdate=h,c.lightProbe.needsUpdate=h,c.directionalLights.needsUpdate=h,c.directionalLightShadows.needsUpdate=h,c.pointLights.needsUpdate=h,c.pointLightShadows.needsUpdate=h,c.spotLights.needsUpdate=h,c.spotLightShadows.needsUpdate=h,c.rectAreaLights.needsUpdate=h,c.hemisphereLights.needsUpdate=h),r&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(E,r),n.isMeshBasicMaterial?Et(E,n):n.isMeshLambertMaterial?(Et(E,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(E,n)):n.isMeshToonMaterial?(Et(E,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshPhongMaterial?(Et(E,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshStandardMaterial?(Et(E,n,a),n.isMeshPhysicalMaterial?function(t,e,n){Mt(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===v&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(E,n,a):Mt(E,n,a)):n.isMeshMatcapMaterial?(Et(E,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshDepthMaterial?(Et(E,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshDistanceMaterial?(Et(E,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(E,n)):n.isMeshNormalMaterial?(Et(E,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(E,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(E,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*Q,t.scale.value=.5*$,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(E,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(E,n):n.isShadowMaterial&&(E.color.value.copy(n.color),E.opacity.value=n.opacity),void 0!==E.ltc_1&&(E.ltc_1.value=Aa.LTC_1),void 0!==E.ltc_2&&(E.ltc_2.value=Aa.LTC_2),qo.upload(f,s.uniformsList,E,x),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(qo.upload(f,s.uniformsList,E,x),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&S.setValue(f,"center",i.center),S.setValue(f,"modelViewMatrix",i.modelViewMatrix),S.setValue(f,"normalMatrix",i.normalMatrix),S.setValue(f,"modelMatrix",i.matrixWorld),w}function Et(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var i,r,a=e.envMap||n;a&&(t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=b.get(a).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix)),e.aoMap?r=e.aoMap:e.lightMap&&(r=e.lightMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uv2Transform.value.copy(r.matrix))}function Mt(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}yt.setAnimationLoop((function(t){ct.isPresenting||vt&&vt(t)})),"undefined"!=typeof window&&yt.setContext(window),this.setAnimationLoop=function(t){vt=t,ct.setAnimationLoop(t),yt.start()},this.render=function(t,e){var n,i;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),e&&e.isCamera){if(!R){V.geometry=null,V.program=null,V.wireframe=!1,F=-1,j=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ct.enabled&&ct.isPresenting&&(e=ct.getCamera(e)),t.onBeforeRender(L,t,e,n||z),(d=C.get(t,e)).init(),at.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),et.setFromProjectionMatrix(at),rt=this.localClippingEnabled,it=nt.init(this.clippingPlanes,rt,e),(h=M.get(t,e)).init(),bt(t,e,0,L.sortObjects),h.finish(),!0===L.sortObjects&&h.sort(Y,X),it&&nt.beginShadows();var r=d.state.shadowsArray;ht.render(r,t,e),d.setupLights(e),it&&nt.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),T.render(h,t,e,i);var a=h.opaque,o=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&xt(a,t,e,s),o.length&&xt(o,t,e,s)}else a.length&&xt(a,t,e),o.length&&xt(o,t,e);t.onAfterRender(L,t,e),null!==z&&(x.updateRenderTargetMipmap(z),x.updateMultisampleRenderTarget(z)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){I!==t&&null===z&&f.bindFramebuffer(36160,t),I=t},this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return z},this.setRenderTarget=function(t,e,n){z=t,N=e,D=n,t&&void 0===b.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var i=I,r=!1;if(t){var a=b.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=a[e||0],r=!0):i=t.isWebGLMultisampleRenderTarget?b.get(t).__webglMultisampledFramebuffer:a,H.copy(t.viewport),G.copy(t.scissor),W=t.scissorTest}else H.copy(Z).multiplyScalar(Q).floor(),G.copy(J).multiplyScalar(Q).floor(),W=K;if(B!==i&&(f.bindFramebuffer(36160,i),B=i),g.viewport(H),g.scissor(G),g.setScissorTest(W),r){var o=b.get(t.texture);f.framebufferTexture2D(36160,36064,34069+(e||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,i,r,a,o){if(t&&t.isWebGLRenderTarget){var s=b.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){var l=!1;s!==B&&(f.bindFramebuffer(36160,s),l=!0);try{var u=t.texture,c=u.format,h=u.type;if(c!==jt&&O.convert(c)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===Tt||O.convert(h)===f.getParameter(35738)||h===Rt&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||h===It&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&f.readPixels(e,n,i,r,O.convert(c),O.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&f.bindFramebuffer(36160,B)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var i=Math.pow(2,-n),r=Math.floor(e.image.width*i),a=Math.floor(e.image.height*i),o=O.convert(e.format);x.setTexture2D(e,0),f.copyTexImage2D(3553,n,o,t.x,t.y,r,a,0),g.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i){void 0===i&&(i=0);var r=e.image.width,a=e.image.height,o=O.convert(n.format),s=O.convert(n.type);x.setTexture2D(n,0),e.isDataTexture?f.texSubImage2D(3553,i,t.x,t.y,r,a,o,s,e.image.data):e.isCompressedTexture?f.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):f.texSubImage2D(3553,i,t.x,t.y,o,s,e.image),0===i&&n.generateMipmaps&&f.generateMipmap(3553),g.unbindTexture()},this.initTexture=function(t){x.setTexture2D(t,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ns(t,e){this.name="",this.color=new gr(t),this.density=void 0!==e?e:25e-5}function Ds(t,e,n){this.name="",this.color=new gr(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function zs(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=kn,this.updateRange={offset:0,count:-1},this.version=0}As.prototype=Object.assign(Object.create(Sa.prototype),{constructor:As,isArrayCamera:!0}),Os.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Os,isGroup:!0}),Object.assign(Ls.prototype,{constructor:Ls,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Os,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Os,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(t,e,n){var i=null,r=null,a=this._targetRay,o=this._grip;return t&&(null!==a&&null!==(i=e.getPose(t.targetRaySpace,n))&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)),null!==o&&t.gripSpace&&null!==(r=e.getPose(t.gripSpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),this}}),Object.assign(Rs.prototype,zn.prototype),Object.assign(Ns.prototype,{isFogExp2:!0,clone:function(){return new Ns(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ds.prototype,{isFog:!0,clone:function(){return new Ds(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(zs.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(zs.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Bs,Fs=new Kn;function Vs(t,e,n,i){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}function js(t){wr.call(this),this.type="SpriteMaterial",this.color=new gr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Vs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Vs.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Fs.x=this.getX(e),Fs.y=this.getY(e),Fs.z=this.getZ(e),Fs.applyMatrix4(t),this.setXYZ(e,Fs.x,Fs.y,Fs.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}}),js.prototype=Object.create(wr.prototype),js.prototype.constructor=js,js.prototype.isSpriteMaterial=!0,js.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Us=new Kn,Hs=new Kn,Gs=new Kn,Ws=new Un,qs=new Un,$s=new si,Qs=new Kn,Ys=new Kn,Xs=new Kn,Zs=new Un,Js=new Un,Ks=new Un;function tl(t){if(Mi.call(this),this.type="Sprite",void 0===Bs){Bs=new Gr;var e=new zs(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Bs.setIndex([0,1,2,0,2,3]),Bs.setAttribute("position",new Vs(e,3,0,!1)),Bs.setAttribute("uv",new Vs(e,2,3,!1))}this.geometry=Bs,this.material=void 0!==t?t:new js,this.center=new Un(.5,.5)}function el(t,e,n,i,r,a){Ws.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(qs.x=a*Ws.x-r*Ws.y,qs.y=r*Ws.x+a*Ws.y):qs.copy(Ws),t.copy(e),t.x+=qs.x,t.y+=qs.y,t.applyMatrix4($s)}tl.prototype=Object.assign(Object.create(Mi.prototype),{constructor:tl,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hs.setFromMatrixScale(this.matrixWorld),$s.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Gs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Hs.multiplyScalar(-Gs.z);var n,i,r=this.material.rotation;0!==r&&(i=Math.cos(r),n=Math.sin(r));var a=this.center;el(Qs.set(-.5,-.5,0),Gs,a,Hs,n,i),el(Ys.set(.5,-.5,0),Gs,a,Hs,n,i),el(Xs.set(.5,.5,0),Gs,a,Hs,n,i),Zs.set(0,0),Js.set(1,0),Ks.set(1,1);var o=t.ray.intersectTriangle(Qs,Ys,Xs,!1,Us);if(null!==o||(el(Ys.set(-.5,.5,0),Gs,a,Hs,n,i),Js.set(0,1),null!==(o=t.ray.intersectTriangle(Qs,Xs,Ys,!1,Us)))){var s=t.ray.origin.distanceTo(Us);s<t.near||s>t.far||e.push({distance:s,point:Us.clone(),uv:dr.getUV(Us,Qs,Ys,Xs,Zs,Js,Ks,new Un),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Mi.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var nl,il,rl,al,ol,sl=new Kn,ll=new Kn;function ul(){Mi.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function cl(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),la.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new si,this.bindMatrixInverse=new si}ul.prototype=Object.assign(Object.create(Mi.prototype),{constructor:ul,isLOD:!0,copy:function(t){Mi.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,i=e.length;n<i;n++){var r=e[n];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);return n.splice(i,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){sl.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(sl);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){sl.setFromMatrixPosition(t.matrixWorld),ll.setFromMatrixPosition(this.matrixWorld);var n=sl.distanceTo(ll)/t.zoom;e[0].object.visible=!0;for(var i=1,r=e.length;i<r&&n>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)e[i].object.visible=!1}},toJSON:function(t){var e=Mi.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var a=n[i];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),cl.prototype=Object.assign(Object.create(la.prototype),{constructor:cl,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new $n,e=this.geometry.attributes.skinWeight,n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){la.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:(nl=new Kn,il=new $n,rl=new $n,al=new Kn,ol=new si,function(t,e){var n=this.skeleton,i=this.geometry;il.fromBufferAttribute(i.attributes.skinIndex,t),rl.fromBufferAttribute(i.attributes.skinWeight,t),nl.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(var r=0;r<4;r++){var a=rl.getComponent(r);if(0!==a){var o=il.getComponent(r);ol.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),e.addScaledVector(al.copy(nl).applyMatrix4(ol),a)}}return e.applyMatrix4(this.bindMatrixInverse)})});var hl=new si,dl=new si;function fl(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new si)}}function pl(){Mi.call(this),this.type="Bone"}Object.assign(fl.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new si;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,a=t.length;r<a;r++){var o=t[r]?t[r].matrixWorld:dl;hl.multiplyMatrices(o,e[r]),hl.toArray(n,16*r)}void 0!==i&&(i.needsUpdate=!0)},clone:function(){return new fl(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var i=this.bones[e];if(i.name===t)return i}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),pl.prototype=Object.assign(Object.create(Mi.prototype),{constructor:pl,isBone:!0});var ml=new si,gl=new si,vl=[],yl=new la;function bl(t,e,n){la.call(this,t,e),this.instanceMatrix=new Mr(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function xl(t){wr.call(this),this.type="LineBasicMaterial",this.color=new gr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}bl.prototype=Object.assign(Object.create(la.prototype),{constructor:bl,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,i=this.count;if(yl.geometry=this.geometry,yl.material=this.material,void 0!==yl.material)for(var r=0;r<i;r++){this.getMatrixAt(r,ml),gl.multiplyMatrices(n,ml),yl.matrixWorld=gl,yl.raycast(t,vl);for(var a=0,o=vl.length;a<o;a++){var s=vl[a];s.instanceId=r,s.object=this,e.push(s)}vl.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),xl.prototype=Object.create(wr.prototype),xl.prototype.constructor=xl,xl.prototype.isLineBasicMaterial=!0,xl.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var _l=new Kn,wl=new Kn,Sl=new si,El=new Zi,Ml=new Hi;function Cl(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Mi.call(this),this.type="Line",this.geometry=void 0!==t?t:new Gr,this.material=void 0!==e?e:new xl}Cl.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Cl,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],i=1,r=e.count;i<r;i++)_l.fromBufferAttribute(e,i-1),wl.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=_l.distanceTo(wl);t.setAttribute("lineDistance",new Rr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;(n=t.lineDistances)[0]=0;for(i=1,r=a.length;i<r;i++)n[i]=n[i-1],n[i]+=a[i-1].distanceTo(a[i])}return this},raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ml.copy(n.boundingSphere),Ml.applyMatrix4(i),Ml.radius+=r,!1!==t.ray.intersectsSphere(Ml)){Sl.getInverse(i),El.copy(t.ray).applyMatrix4(Sl);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new Kn,l=new Kn,u=new Kn,c=new Kn,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,f=n.attributes.position.array;if(null!==d)for(var p=d.array,m=0,g=p.length-1;m<g;m+=h){var v=p[m],y=p[m+1];if(s.fromArray(f,3*v),l.fromArray(f,3*y),!(El.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=f.length/3-1;m<g;m+=h){if(s.fromArray(f,3*m),l.fromArray(f,3*m+3),!(El.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var b=n.vertices,x=b.length;for(m=0;m<x-1;m+=h){var _;if(!(El.distanceSqToSegment(b[m],b[m+1],c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Tl=new Kn,kl=new Kn;function Pl(t,e){Cl.call(this,t,e),this.type="LineSegments"}function Al(t,e){Cl.call(this,t,e),this.type="LineLoop"}function Ol(t){wr.call(this),this.type="PointsMaterial",this.color=new gr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Pl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Pl,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],i=0,r=e.count;i<r;i+=2)Tl.fromBufferAttribute(e,i),kl.fromBufferAttribute(e,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+Tl.distanceTo(kl);t.setAttribute("lineDistance",new Rr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;for(n=t.lineDistances,i=0,r=a.length;i<r;i+=2)Tl.copy(a[i]),kl.copy(a[i+1]),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+Tl.distanceTo(kl)}return this}}),Al.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Al,isLineLoop:!0}),Ol.prototype=Object.create(wr.prototype),Ol.prototype.constructor=Ol,Ol.prototype.isPointsMaterial=!0,Ol.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Ll=new si,Rl=new Zi,Il=new Hi,Nl=new Kn;function Dl(t,e){Mi.call(this),this.type="Points",this.geometry=void 0!==t?t:new Gr,this.material=void 0!==e?e:new Ol,this.updateMorphTargets()}function zl(t,e,n,i,r,a,o){var s=Rl.distanceSqToPoint(t);if(s<n){var l=new Kn;Rl.closestPointToPoint(t,l),l.applyMatrix4(i);var u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}function Bl(t,e,n,i,r,a,o,s,l){qn.call(this,t,e,n,i,r,a,o,s,l),this.format=void 0!==o?o:Vt,this.minFilter=void 0!==a?a:wt,this.magFilter=void 0!==r?r:wt,this.generateMipmaps=!1}function Fl(t,e,n,i,r,a,o,s,l,u,c,h){qn.call(this,null,a,o,s,l,u,i,r,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Vl(t,e,n,i,r,a,o,s,l){qn.call(this,t,e,n,i,r,a,o,s,l),this.needsUpdate=!0}function jl(t,e,n,i,r,a,o,s,l,u){if((u=void 0!==u?u:Wt)!==Wt&&u!==qt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Wt&&(n=At),void 0===n&&u===qt&&(n=Bt),qn.call(this,null,i,r,a,o,s,u,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:vt,this.minFilter=void 0!==s?s:vt,this.flipY=!1,this.generateMipmaps=!1}function Ul(t){Gr.call(this),this.type="WireframeGeometry";var e,n,i,r,a,o,s,l,u,c,h=[],d=[0,0],f={},p=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,i=m.length;e<i;e++){var g=m[e];for(n=0;n<3;n++)s=g[p[n]],l=g[p[(n+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]})}for(u in f)o=f[u],c=t.vertices[o.index1],h.push(c.x,c.y,c.z),c=t.vertices[o.index2],h.push(c.x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,b,x,_,w,S;if(c=new Kn,null!==t.index){for(v=t.attributes.position,y=t.index,0===(b=t.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),r=0,a=b.length;r<a;++r)for(e=_=(x=b[r]).start,i=_+x.count;e<i;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),l=y.getX(e+(n+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]});for(u in f)o=f[u],c.fromBufferAttribute(v,o.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,o.index2),h.push(c.x,c.y,c.z)}else for(e=0,i=(v=t.attributes.position).count/3;e<i;e++)for(n=0;n<3;n++)w=3*e+n,c.fromBufferAttribute(v,w),h.push(c.x,c.y,c.z),S=3*e+(n+1)%3,c.fromBufferAttribute(v,S),h.push(c.x,c.y,c.z)}this.setAttribute("position",new Rr(h,3))}function Hl(t,e,n){ma.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Gl(t,e,n)),this.mergeVertices()}function Gl(t,e,n){Gr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,a=[],o=[],s=[],l=[],u=1e-5,c=new Kn,h=new Kn,d=new Kn,f=new Kn,p=new Kn;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(i=0;i<=n;i++){var g=i/n;for(r=0;r<=e;r++){var v=r/e;t(v,g,h),o.push(h.x,h.y,h.z),v-u>=0?(t(v-u,g,d),f.subVectors(h,d)):(t(v+u,g,d),f.subVectors(d,h)),g-u>=0?(t(v,g-u,d),p.subVectors(h,d)):(t(v,g+u,d),p.subVectors(d,h)),c.crossVectors(f,p).normalize(),s.push(c.x,c.y,c.z),l.push(v,g)}}for(i=0;i<n;i++)for(r=0;r<e;r++){var y=i*m+r,b=i*m+r+1,x=(i+1)*m+r+1,_=(i+1)*m+r;a.push(y,b,_),a.push(b,x,_)}this.setIndex(a),this.setAttribute("position",new Rr(o,3)),this.setAttribute("normal",new Rr(s,3)),this.setAttribute("uv",new Rr(l,2))}function Wl(t,e,n,i){ma.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},this.fromBufferGeometry(new ql(t,e,n,i)),this.mergeVertices()}function ql(t,e,n,i){Gr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},n=n||1;var r=[],a=[];function o(t,e,n,i){var r,a,o=Math.pow(2,i),l=[];for(r=0;r<=o;r++){l[r]=[];var u=t.clone().lerp(n,r/o),c=e.clone().lerp(n,r/o),h=o-r;for(a=0;a<=h;a++)l[r][a]=0===a&&r===o?u:u.clone().lerp(c,a/h)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var d=Math.floor(a/2);a%2==0?(s(l[r][d+1]),s(l[r+1][d]),s(l[r][d])):(s(l[r][d+1]),s(l[r+1][d+1]),s(l[r+1][d]))}}function s(t){r.push(t.x,t.y,t.z)}function l(e,n){var i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function u(t,e,n,i){i<0&&1===t.x&&(a[e]=t.x-1),0===n.x&&0===n.z&&(a[e]=i/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}function h(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){for(var n=new Kn,i=new Kn,r=new Kn,a=0;a<e.length;a+=3)l(e[a+0],n),l(e[a+1],i),l(e[a+2],r),o(n,i,r,t)}(i=i||0),function(t){for(var e=new Kn,n=0;n<r.length;n+=3)e.x=r[n+0],e.y=r[n+1],e.z=r[n+2],e.normalize().multiplyScalar(t),r[n+0]=e.x,r[n+1]=e.y,r[n+2]=e.z}(n),function(){for(var t=new Kn,e=0;e<r.length;e+=3){t.x=r[e+0],t.y=r[e+1],t.z=r[e+2];var n=c(t)/2/Math.PI+.5,i=h(t)/Math.PI+.5;a.push(n,1-i)}(function(){for(var t=new Kn,e=new Kn,n=new Kn,i=new Kn,o=new Un,s=new Un,l=new Un,h=0,d=0;h<r.length;h+=9,d+=6){t.set(r[h+0],r[h+1],r[h+2]),e.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),i.copy(t).add(e).add(n).divideScalar(3);var f=c(i);u(o,d+0,t,f),u(s,d+2,e,f),u(l,d+4,n,f)}})(),function(){for(var t=0;t<a.length;t+=6){var e=a[t+0],n=a[t+2],i=a[t+4],r=Math.max(e,n,i),o=Math.min(e,n,i);r>.9&&o<.1&&(e<.2&&(a[t+0]+=1),n<.2&&(a[t+2]+=1),i<.2&&(a[t+4]+=1))}}()}(),this.setAttribute("position",new Rr(r,3)),this.setAttribute("normal",new Rr(r.slice(),3)),this.setAttribute("uv",new Rr(a,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function $l(t,e){ma.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ql(t,e)),this.mergeVertices()}function Ql(t,e){ql.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Yl(t,e){ma.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Xl(t,e)),this.mergeVertices()}function Xl(t,e){ql.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Zl(t,e){ma.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Jl(t,e)),this.mergeVertices()}function Jl(t,e){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];ql.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Kl(t,e){ma.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new tu(t,e)),this.mergeVertices()}function tu(t,e){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];ql.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function eu(t,e,n,i,r,a){ma.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new nu(t,e,n,i,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function nu(t,e,n,i,r){Gr.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},e=e||64,n=n||1,i=i||8,r=r||!1;var a=t.computeFrenetFrames(e,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,l=new Kn,u=new Kn,c=new Un,h=new Kn,d=[],f=[],p=[],m=[];function g(r){h=t.getPointAt(r/e,h);var o=a.normals[r],c=a.binormals[r];for(s=0;s<=i;s++){var p=s/i*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);u.x=g*o.x+m*c.x,u.y=g*o.y+m*c.y,u.z=g*o.z+m*c.z,u.normalize(),f.push(u.x,u.y,u.z),l.x=h.x+n*u.x,l.y=h.y+n*u.y,l.z=h.z+n*u.z,d.push(l.x,l.y,l.z)}}!function(){for(o=0;o<e;o++)g(o);g(!1===r?e:0),function(){for(o=0;o<=e;o++)for(s=0;s<=i;s++)c.x=o/e,c.y=s/i,p.push(c.x,c.y)}(),function(){for(s=1;s<=e;s++)for(o=1;o<=i;o++){var t=(i+1)*(s-1)+(o-1),n=(i+1)*s+(o-1),r=(i+1)*s+o,a=(i+1)*(s-1)+o;m.push(t,n,a),m.push(n,r,a)}}()}(),this.setIndex(m),this.setAttribute("position",new Rr(d,3)),this.setAttribute("normal",new Rr(f,3)),this.setAttribute("uv",new Rr(p,2))}function iu(t,e,n,i,r,a,o){ma.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ru(t,e,n,i,r,a)),this.mergeVertices()}function ru(t,e,n,i,r,a){Gr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,a=a||3;var o,s,l=[],u=[],c=[],h=[],d=new Kn,f=new Kn,p=new Kn,m=new Kn,g=new Kn,v=new Kn,y=new Kn;for(o=0;o<=n;++o){var b=o/n*r*Math.PI*2;for(T(b,r,a,t,p),T(b+.01,r,a,t,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=i;++s){var x=s/i*Math.PI*2,_=-e*Math.cos(x),w=e*Math.sin(x);d.x=p.x+(_*y.x+w*g.x),d.y=p.y+(_*y.y+w*g.y),d.z=p.z+(_*y.z+w*g.z),u.push(d.x,d.y,d.z),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(o/n),h.push(s/i)}}for(s=1;s<=n;s++)for(o=1;o<=i;o++){var S=(i+1)*(s-1)+(o-1),E=(i+1)*s+(o-1),M=(i+1)*s+o,C=(i+1)*(s-1)+o;l.push(S,E,C),l.push(E,M,C)}function T(t,e,n,i,r){var a=Math.cos(t),o=Math.sin(t),s=n/e*t,l=Math.cos(s);r.x=i*(2+l)*.5*a,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(s)*.5}this.setIndex(l),this.setAttribute("position",new Rr(u,3)),this.setAttribute("normal",new Rr(c,3)),this.setAttribute("uv",new Rr(h,2))}function au(t,e,n,i,r){ma.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new ou(t,e,n,i,r)),this.mergeVertices()}function ou(t,e,n,i,r){Gr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||1,e=e||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var a,o,s=[],l=[],u=[],c=[],h=new Kn,d=new Kn,f=new Kn;for(a=0;a<=n;a++)for(o=0;o<=i;o++){var p=o/i*r,m=a/n*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(p),d.y=(t+e*Math.cos(m))*Math.sin(p),d.z=e*Math.sin(m),l.push(d.x,d.y,d.z),h.x=t*Math.cos(p),h.y=t*Math.sin(p),f.subVectors(d,h).normalize(),u.push(f.x,f.y,f.z),c.push(o/i),c.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=i;o++){var g=(i+1)*a+o-1,v=(i+1)*(a-1)+o-1,y=(i+1)*(a-1)+o,b=(i+1)*a+o;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.setAttribute("position",new Rr(l,3)),this.setAttribute("normal",new Rr(u,3)),this.setAttribute("uv",new Rr(c,2))}Dl.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Dl,isPoints:!0,raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Il.copy(n.boundingSphere),Il.applyMatrix4(i),Il.radius+=r,!1!==t.ray.intersectsSphere(Il)){Ll.getInverse(i),Rl.copy(t.ray).applyMatrix4(Ll);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,l=n.attributes.position.array;if(null!==s)for(var u=s.array,c=0,h=u.length;c<h;c++){var d=u[c];Nl.fromArray(l,3*d),zl(Nl,d,o,i,t,e,this)}else{c=0;for(var f=l.length/3;c<f;c++)Nl.fromArray(l,3*c),zl(Nl,c,o,i,t,e,this)}}else{var p=n.vertices;for(c=0,f=p.length;c<f;c++)zl(p[c],c,o,i,t,e,this)}}},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=i.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Bl.prototype=Object.assign(Object.create(qn.prototype),{constructor:Bl,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Fl.prototype=Object.create(qn.prototype),Fl.prototype.constructor=Fl,Fl.prototype.isCompressedTexture=!0,Vl.prototype=Object.create(qn.prototype),Vl.prototype.constructor=Vl,Vl.prototype.isCanvasTexture=!0,jl.prototype=Object.create(qn.prototype),jl.prototype.constructor=jl,jl.prototype.isDepthTexture=!0,Ul.prototype=Object.create(Gr.prototype),Ul.prototype.constructor=Ul,Hl.prototype=Object.create(ma.prototype),Hl.prototype.constructor=Hl,Gl.prototype=Object.create(Gr.prototype),Gl.prototype.constructor=Gl,Wl.prototype=Object.create(ma.prototype),Wl.prototype.constructor=Wl,ql.prototype=Object.create(Gr.prototype),ql.prototype.constructor=ql,$l.prototype=Object.create(ma.prototype),$l.prototype.constructor=$l,Ql.prototype=Object.create(ql.prototype),Ql.prototype.constructor=Ql,Yl.prototype=Object.create(ma.prototype),Yl.prototype.constructor=Yl,Xl.prototype=Object.create(ql.prototype),Xl.prototype.constructor=Xl,Zl.prototype=Object.create(ma.prototype),Zl.prototype.constructor=Zl,Jl.prototype=Object.create(ql.prototype),Jl.prototype.constructor=Jl,Kl.prototype=Object.create(ma.prototype),Kl.prototype.constructor=Kl,tu.prototype=Object.create(ql.prototype),tu.prototype.constructor=tu,eu.prototype=Object.create(ma.prototype),eu.prototype.constructor=eu,nu.prototype=Object.create(Gr.prototype),nu.prototype.constructor=nu,nu.prototype.toJSON=function(){var t=Gr.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},iu.prototype=Object.create(ma.prototype),iu.prototype.constructor=iu,ru.prototype=Object.create(Gr.prototype),ru.prototype.constructor=ru,au.prototype=Object.create(ma.prototype),au.prototype.constructor=au,ou.prototype=Object.create(Gr.prototype),ou.prototype.constructor=ou;var su=function(t,e,n){n=n||2;var i,r,a,o,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,d=lu(t,0,h,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(t,e,n,i){var r,a,o,s,l,u=[];for(r=0,a=e.length;r<a;r++)o=e[r]*i,s=r<a-1?e[r+1]*i:t.length,(l=lu(t,o,s,i,!1))===l.next&&(l.steiner=!0),u.push(bu(l));for(u.sort(mu),r=0;r<u.length;r++)gu(u[r],n),n=uu(n,n.next);return n}(t,e,d,n)),t.length>80*n){i=a=t[0],r=o=t[1];for(var p=n;p<h;p+=n)(s=t[p])<i&&(i=s),(l=t[p+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-i,o-r))?1/u:0}return cu(d,f,n,i,r,u),f};function lu(t,e,n,i,r){var a,o;if(r===function(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}(t,e,n,i)>0)for(a=e;a<n;a+=i)o=Pu(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=Pu(a,t[a],t[a+1],o);return o&&Su(o,o.next)&&(Au(o),o=o.next),o}function uu(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Su(i,i.next)&&0!==wu(i.prev,i,i.next))i=i.next;else{if(Au(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function cu(t,e,n,i,r,a,o){if(t){!o&&a&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=yu(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,o,s,l,u=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(t,i,r,a);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?du(t,i,r,a):hu(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Au(t),t=l.next,u=l.next;else if((t=l)===u){o?1===o?cu(t=fu(uu(t),e,n),e,n,i,r,a,2):2===o&&pu(t,e,n,i,r,a):cu(uu(t),e,n,i,r,a,1);break}}}function hu(t){var e=t.prev,n=t,i=t.next;if(wu(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(xu(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&wu(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function du(t,e,n,i){var r=t.prev,a=t,o=t.next;if(wu(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,u=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,c=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=yu(s,l,e,n,i),d=yu(u,c,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&xu(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&wu(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&xu(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&wu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&xu(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&wu(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&xu(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&wu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function fu(t,e,n){var i=t;do{var r=i.prev,a=i.next.next;!Su(r,a)&&Eu(r,i,i.next,a)&&Tu(r,a)&&Tu(a,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(a.i/n),Au(i),Au(i.next),i=t=a),i=i.next}while(i!==t);return uu(i)}function pu(t,e,n,i,r,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&_u(o,s)){var l=ku(o,s);return o=uu(o,o.next),l=uu(l,l.next),cu(o,e,n,i,r,a),void cu(l,e,n,i,r,a)}s=s.next}o=o.next}while(o!==t)}function mu(t,e){return t.x-e.x}function gu(t,e){if(e=function(t,e){var n,i=e,r=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var l,u=n,c=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&xu(a<h?r:o,a,c,h,a<h?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),Tu(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&vu(n,i)))&&(n=i,d=l)),i=i.next}while(i!==u);return n}(t,e)){var n=ku(e,t);uu(e,e.next),uu(n,n.next)}}function vu(t,e){return wu(t.prev,t,e.prev)<0&&wu(e.next,t,t.next)<0}function yu(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function bu(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function xu(t,e,n,i,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function _u(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Eu(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Tu(t,e)&&Tu(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(wu(t.prev,t,e.prev)||wu(t,e.prev,e))||Su(t,e)&&wu(t.prev,t,t.next)>0&&wu(e.prev,e,e.next)>0)}function wu(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Su(t,e){return t.x===e.x&&t.y===e.y}function Eu(t,e,n,i){var r=Cu(wu(t,e,n)),a=Cu(wu(t,e,i)),o=Cu(wu(n,i,t)),s=Cu(wu(n,i,e));return r!==a&&o!==s||(!(0!==r||!Mu(t,n,e))||(!(0!==a||!Mu(t,i,e))||(!(0!==o||!Mu(n,t,i))||!(0!==s||!Mu(n,e,i)))))}function Mu(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Cu(t){return t>0?1:t<0?-1:0}function Tu(t,e){return wu(t.prev,t,t.next)<0?wu(t,e,t.next)>=0&&wu(t,t.prev,e)>=0:wu(t,e,t.prev)<0||wu(t,t.next,e)<0}function ku(t,e){var n=new Ou(t.i,t.x,t.y),i=new Ou(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function Pu(t,e,n,i){var r=new Ou(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Au(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ou(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Lu={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return Lu.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[];Ru(t),Iu(n,t);var a=t.length;e.forEach(Ru);for(var o=0;o<e.length;o++)i.push(a),a+=e[o].length,Iu(n,e[o]);var s=su(n,i);for(o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function Ru(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Iu(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Nu(t,e){ma.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Du(t,e)),this.mergeVertices()}function Du(t,e){Gr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,i=[],r=[],a=0,o=t.length;a<o;a++){s(t[a])}function s(t){var a=[],o=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,l=void 0!==e.depth?e.depth:100,u=void 0===e.bevelEnabled||e.bevelEnabled,c=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:c-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3,p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:zu;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);var g,v,y,b,x,_,w,S,E=!1;p&&(g=p.getSpacedPoints(s),E=!0,u=!1,v=p.computeFrenetFrames(s,!1),y=new Kn,b=new Kn,x=new Kn),u||(f=0,c=0,h=0,d=0);var M=t.extractPoints(o),C=M.shape,T=M.holes;if(!Lu.isClockWise(C))for(C=C.reverse(),w=0,S=T.length;w<S;w++)_=T[w],Lu.isClockWise(_)&&(T[w]=_.reverse());var k=Lu.triangulateShape(C,T),P=C;for(w=0,S=T.length;w<S;w++)_=T[w],C=C.concat(_);function A(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var O,L,R,I,N,D,z=C.length,B=k.length;function F(t,e,n){var i,r,a,o=t.x-e.x,s=t.y-e.y,l=n.x-t.x,u=n.y-t.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=e.x-s/d,m=e.y+o/d,g=((n.x-u/f-p)*u-(n.y+l/f-m)*l)/(o*u-s*l),v=(i=p+o*g-t.x)*i+(r=m+s*g-t.y)*r;if(v<=2)return new Un(i,r);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(i=-s,r=o,a=Math.sqrt(c)):(i=o,r=s,a=Math.sqrt(c/2))}return new Un(i/a,r/a)}for(var V=[],j=0,U=P.length,H=U-1,G=j+1;j<U;j++,H++,G++)H===U&&(H=0),G===U&&(G=0),V[j]=F(P[j],P[H],P[G]);var W,q,$=[],Q=V.concat();for(w=0,S=T.length;w<S;w++){for(_=T[w],W=[],j=0,H=(U=_.length)-1,G=j+1;j<U;j++,H++,G++)H===U&&(H=0),G===U&&(G=0),W[j]=F(_[j],_[H],_[G]);$.push(W),Q=Q.concat(W)}for(O=0;O<f;O++){for(R=O/f,I=c*Math.cos(R*Math.PI/2),L=h*Math.sin(R*Math.PI/2)+d,j=0,U=P.length;j<U;j++)X((N=A(P[j],V[j],L)).x,N.y,-I);for(w=0,S=T.length;w<S;w++)for(_=T[w],W=$[w],j=0,U=_.length;j<U;j++)X((N=A(_[j],W[j],L)).x,N.y,-I)}for(L=h+d,j=0;j<z;j++)N=u?A(C[j],Q[j],L):C[j],E?(b.copy(v.normals[0]).multiplyScalar(N.x),y.copy(v.binormals[0]).multiplyScalar(N.y),x.copy(g[0]).add(b).add(y),X(x.x,x.y,x.z)):X(N.x,N.y,0);for(q=1;q<=s;q++)for(j=0;j<z;j++)N=u?A(C[j],Q[j],L):C[j],E?(b.copy(v.normals[q]).multiplyScalar(N.x),y.copy(v.binormals[q]).multiplyScalar(N.y),x.copy(g[q]).add(b).add(y),X(x.x,x.y,x.z)):X(N.x,N.y,l/s*q);for(O=f-1;O>=0;O--){for(R=O/f,I=c*Math.cos(R*Math.PI/2),L=h*Math.sin(R*Math.PI/2)+d,j=0,U=P.length;j<U;j++)X((N=A(P[j],V[j],L)).x,N.y,l+I);for(w=0,S=T.length;w<S;w++)for(_=T[w],W=$[w],j=0,U=_.length;j<U;j++)N=A(_[j],W[j],L),E?X(N.x,N.y+g[s-1].y,g[s-1].x+I):X(N.x,N.y,l+I)}function Y(t,e){var n,i;for(j=t.length;--j>=0;){n=j,(i=j-1)<0&&(i=t.length-1);var r=0,a=s+2*f;for(r=0;r<a;r++){var o=z*r,l=z*(r+1);J(e+n+o,e+i+o,e+i+l,e+n+l)}}}function X(t,e,n){a.push(t),a.push(e),a.push(n)}function Z(t,e,r){K(t),K(e),K(r);var a=i.length/3,o=m.generateTopUV(n,i,a-3,a-2,a-1);tt(o[0]),tt(o[1]),tt(o[2])}function J(t,e,r,a){K(t),K(e),K(a),K(e),K(r),K(a);var o=i.length/3,s=m.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function K(t){i.push(a[3*t+0]),i.push(a[3*t+1]),i.push(a[3*t+2])}function tt(t){r.push(t.x),r.push(t.y)}!function(){var t=i.length/3;if(u){var e=0,r=z*e;for(j=0;j<B;j++)Z((D=k[j])[2]+r,D[1]+r,D[0]+r);for(r=z*(e=s+2*f),j=0;j<B;j++)Z((D=k[j])[0]+r,D[1]+r,D[2]+r)}else{for(j=0;j<B;j++)Z((D=k[j])[2],D[1],D[0]);for(j=0;j<B;j++)Z((D=k[j])[0]+z*s,D[1]+z*s,D[2]+z*s)}n.addGroup(t,i.length/3-t,0)}(),function(){var t=i.length/3,e=0;for(Y(P,e),e+=P.length,w=0,S=T.length;w<S;w++)Y(_=T[w],e),e+=_.length;n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new Rr(i,3)),this.setAttribute("uv",new Rr(r,2)),this.computeVertexNormals()}Nu.prototype=Object.create(ma.prototype),Nu.prototype.constructor=Nu,Nu.prototype.toJSON=function(){var t=ma.prototype.toJSON.call(this);return Bu(this.parameters.shapes,this.parameters.options,t)},Du.prototype=Object.create(Gr.prototype),Du.prototype.constructor=Du,Du.prototype.toJSON=function(){var t=Gr.prototype.toJSON.call(this);return Bu(this.parameters.shapes,this.parameters.options,t)};var zu={generateTopUV:function(t,e,n,i,r){var a=e[3*n],o=e[3*n+1],s=e[3*i],l=e[3*i+1],u=e[3*r],c=e[3*r+1];return[new Un(a,o),new Un(s,l),new Un(u,c)]},generateSideWallUV:function(t,e,n,i,r,a){var o=e[3*n],s=e[3*n+1],l=e[3*n+2],u=e[3*i],c=e[3*i+1],h=e[3*i+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-c)<.01?[new Un(o,1-l),new Un(u,1-h),new Un(d,1-p),new Un(m,1-v)]:[new Un(s,1-l),new Un(c,1-h),new Un(f,1-p),new Un(g,1-v)]}};function Bu(t,e,n){if(n.shapes=[],Array.isArray(t))for(var i=0,r=t.length;i<r;i++){var a=t[i];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Fu(t,e){ma.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Vu(t,e)),this.mergeVertices()}function Vu(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ma;var i=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Du.call(this,i,e),this.type="TextBufferGeometry"}function ju(t,e,n,i,r,a,o){ma.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Uu(t,e,n,i,r,a,o)),this.mergeVertices()}function Uu(t,e,n,i,r,a,o){Gr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,l,u=Math.min(a+o,Math.PI),c=0,h=[],d=new Kn,f=new Kn,p=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],b=l/n,x=0;for(0==l&&0==a?x=.5/e:l==n&&u==Math.PI&&(x=-.5/e),s=0;s<=e;s++){var _=s/e;d.x=-t*Math.cos(i+_*r)*Math.sin(a+b*o),d.y=t*Math.cos(a+b*o),d.z=t*Math.sin(i+_*r)*Math.sin(a+b*o),m.push(d.x,d.y,d.z),f.copy(d).normalize(),g.push(f.x,f.y,f.z),v.push(_+x,1-b),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(s=0;s<e;s++){var w=h[l][s+1],S=h[l][s],E=h[l+1][s],M=h[l+1][s+1];(0!==l||a>0)&&p.push(w,S,M),(l!==n-1||u<Math.PI)&&p.push(S,E,M)}this.setIndex(p),this.setAttribute("position",new Rr(m,3)),this.setAttribute("normal",new Rr(g,3)),this.setAttribute("uv",new Rr(v,2))}function Hu(t,e,n,i,r,a){ma.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Gu(t,e,n,i,r,a)),this.mergeVertices()}function Gu(t,e,n,i,r,a){Gr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},t=t||.5,e=e||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,l,u=[],c=[],h=[],d=[],f=t,p=(e-t)/(i=void 0!==i?Math.max(1,i):1),m=new Kn,g=new Un;for(s=0;s<=i;s++){for(l=0;l<=n;l++)o=r+l/n*a,m.x=f*Math.cos(o),m.y=f*Math.sin(o),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);f+=p}for(s=0;s<i;s++){var v=s*(n+1);for(l=0;l<n;l++){var y=o=l+v,b=o+n+1,x=o+n+2,_=o+1;u.push(y,b,_),u.push(b,x,_)}}this.setIndex(u),this.setAttribute("position",new Rr(c,3)),this.setAttribute("normal",new Rr(h,3)),this.setAttribute("uv",new Rr(d,2))}function Wu(t,e,n,i){ma.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new qu(t,e,n,i)),this.mergeVertices()}function qu(t,e,n,i){Gr.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e)||12,n=n||0,i=i||2*Math.PI,i=jn.clamp(i,0,2*Math.PI);var r,a,o,s=[],l=[],u=[],c=1/e,h=new Kn,d=new Un;for(a=0;a<=e;a++){var f=n+a*c*i,p=Math.sin(f),m=Math.cos(f);for(o=0;o<=t.length-1;o++)h.x=t[o].x*p,h.y=t[o].y,h.z=t[o].x*m,l.push(h.x,h.y,h.z),d.x=a/e,d.y=o/(t.length-1),u.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var g=r=o+a*t.length,v=r+t.length,y=r+t.length+1,b=r+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.setAttribute("position",new Rr(l,3)),this.setAttribute("uv",new Rr(u,2)),this.computeVertexNormals(),i===2*Math.PI){var x=this.attributes.normal.array,_=new Kn,w=new Kn,S=new Kn;for(r=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)_.x=x[o+0],_.y=x[o+1],_.z=x[o+2],w.x=x[r+o+0],w.y=x[r+o+1],w.z=x[r+o+2],S.addVectors(_,w).normalize(),x[o+0]=x[r+o+0]=S.x,x[o+1]=x[r+o+1]=S.y,x[o+2]=x[r+o+2]=S.z}}function $u(t,e){ma.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Qu(t,e)),this.mergeVertices()}function Qu(t,e){Gr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],i=[],r=[],a=[],o=0,s=0;if(!1===Array.isArray(t))u(t);else for(var l=0;l<t.length;l++)u(t[l]),this.addGroup(o,s,l),o+=s,s=0;function u(t){var o,l,u,c=i.length/3,h=t.extractPoints(e),d=h.shape,f=h.holes;for(!1===Lu.isClockWise(d)&&(d=d.reverse()),o=0,l=f.length;o<l;o++)u=f[o],!0===Lu.isClockWise(u)&&(f[o]=u.reverse());var p=Lu.triangulateShape(d,f);for(o=0,l=f.length;o<l;o++)u=f[o],d=d.concat(u);for(o=0,l=d.length;o<l;o++){var m=d[o];i.push(m.x,m.y,0),r.push(0,0,1),a.push(m.x,m.y)}for(o=0,l=p.length;o<l;o++){var g=p[o],v=g[0]+c,y=g[1]+c,b=g[2]+c;n.push(v,y,b),s+=3}}this.setIndex(n),this.setAttribute("position",new Rr(i,3)),this.setAttribute("normal",new Rr(r,3)),this.setAttribute("uv",new Rr(a,2))}function Yu(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++){var r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}function Xu(t,e){Gr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,i,r,a,o=[],s=Math.cos(jn.DEG2RAD*e),l=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(a=new ma).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,d=a.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],g=0;g<3;g++)n=m[c[g]],i=m[c[(g+1)%3]],l[0]=Math.min(n,i),l[1]=Math.max(n,i),void 0===u[r=l[0]+","+l[1]]?u[r]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[r].face2=f;for(r in u){var v=u[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.setAttribute("position",new Rr(o,3))}function Zu(t,e,n,i,r,a,o,s){ma.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Ju(t,e,n,i,r,a,o,s)),this.mergeVertices()}function Ju(t,e,n,i,r,a,o,s){Gr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var l=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var u=[],c=[],h=[],d=[],f=0,p=[],m=n/2,g=0;function v(n){var r,a,p,v=new Un,y=new Kn,b=0,x=!0===n?t:e,_=!0===n?1:-1;for(a=f,r=1;r<=i;r++)c.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),f++;for(p=f,r=0;r<=i;r++){var w=r/i*s+o,S=Math.cos(w),E=Math.sin(w);y.x=x*E,y.y=m*_,y.z=x*S,c.push(y.x,y.y,y.z),h.push(0,_,0),v.x=.5*S+.5,v.y=.5*E*_+.5,d.push(v.x,v.y),f++}for(r=0;r<i;r++){var M=a+r,C=p+r;!0===n?u.push(C,C+1,M):u.push(C+1,C,M),b+=3}l.addGroup(g,b,!0===n?1:2),g+=b}!function(){var a,v,y=new Kn,b=new Kn,x=0,_=(e-t)/n;for(v=0;v<=r;v++){var w=[],S=v/r,E=S*(e-t)+t;for(a=0;a<=i;a++){var M=a/i,C=M*s+o,T=Math.sin(C),k=Math.cos(C);b.x=E*T,b.y=-S*n+m,b.z=E*k,c.push(b.x,b.y,b.z),y.set(T,_,k).normalize(),h.push(y.x,y.y,y.z),d.push(M,1-S),w.push(f++)}p.push(w)}for(a=0;a<i;a++)for(v=0;v<r;v++){var P=p[v][a],A=p[v+1][a],O=p[v+1][a+1],L=p[v][a+1];u.push(P,A,L),u.push(A,O,L),x+=6}l.addGroup(g,x,0),g+=x}(),!1===a&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new Rr(c,3)),this.setAttribute("normal",new Rr(h,3)),this.setAttribute("uv",new Rr(d,2))}function Ku(t,e,n,i,r,a,o){Zu.call(this,0,t,e,n,i,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function tc(t,e,n,i,r,a,o){Ju.call(this,0,t,e,n,i,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function ec(t,e,n,i){ma.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new nc(t,e,n,i)),this.mergeVertices()}function nc(t,e,n,i){Gr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,a,o=[],s=[],l=[],u=[],c=new Kn,h=new Un;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),a=0,r=3;a<=e;a++,r+=3){var d=n+a/e*i;c.x=t*Math.cos(d),c.y=t*Math.sin(d),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[r]/t+1)/2,h.y=(s[r+1]/t+1)/2,u.push(h.x,h.y)}for(r=1;r<=e;r++)o.push(r,r+1,0);this.setIndex(o),this.setAttribute("position",new Rr(s,3)),this.setAttribute("normal",new Rr(l,3)),this.setAttribute("uv",new Rr(u,2))}Fu.prototype=Object.create(ma.prototype),Fu.prototype.constructor=Fu,Vu.prototype=Object.create(Du.prototype),Vu.prototype.constructor=Vu,ju.prototype=Object.create(ma.prototype),ju.prototype.constructor=ju,Uu.prototype=Object.create(Gr.prototype),Uu.prototype.constructor=Uu,Hu.prototype=Object.create(ma.prototype),Hu.prototype.constructor=Hu,Gu.prototype=Object.create(Gr.prototype),Gu.prototype.constructor=Gu,Wu.prototype=Object.create(ma.prototype),Wu.prototype.constructor=Wu,qu.prototype=Object.create(Gr.prototype),qu.prototype.constructor=qu,$u.prototype=Object.create(ma.prototype),$u.prototype.constructor=$u,$u.prototype.toJSON=function(){var t=ma.prototype.toJSON.call(this);return Yu(this.parameters.shapes,t)},Qu.prototype=Object.create(Gr.prototype),Qu.prototype.constructor=Qu,Qu.prototype.toJSON=function(){var t=Gr.prototype.toJSON.call(this);return Yu(this.parameters.shapes,t)},Xu.prototype=Object.create(Gr.prototype),Xu.prototype.constructor=Xu,Zu.prototype=Object.create(ma.prototype),Zu.prototype.constructor=Zu,Ju.prototype=Object.create(Gr.prototype),Ju.prototype.constructor=Ju,Ku.prototype=Object.create(Zu.prototype),Ku.prototype.constructor=Ku,tc.prototype=Object.create(Ju.prototype),tc.prototype.constructor=tc,ec.prototype=Object.create(ma.prototype),ec.prototype.constructor=ec,nc.prototype=Object.create(Gr.prototype),nc.prototype.constructor=nc;var ic=Object.freeze({__proto__:null,WireframeGeometry:Ul,ParametricGeometry:Hl,ParametricBufferGeometry:Gl,TetrahedronGeometry:$l,TetrahedronBufferGeometry:Ql,OctahedronGeometry:Yl,OctahedronBufferGeometry:Xl,IcosahedronGeometry:Zl,IcosahedronBufferGeometry:Jl,DodecahedronGeometry:Kl,DodecahedronBufferGeometry:tu,PolyhedronGeometry:Wl,PolyhedronBufferGeometry:ql,TubeGeometry:eu,TubeBufferGeometry:nu,TorusKnotGeometry:iu,TorusKnotBufferGeometry:ru,TorusGeometry:au,TorusBufferGeometry:ou,TextGeometry:Fu,TextBufferGeometry:Vu,SphereGeometry:ju,SphereBufferGeometry:Uu,RingGeometry:Hu,RingBufferGeometry:Gu,PlaneGeometry:Ra,PlaneBufferGeometry:Ia,LatheGeometry:Wu,LatheBufferGeometry:qu,ShapeGeometry:$u,ShapeBufferGeometry:Qu,ExtrudeGeometry:Nu,ExtrudeBufferGeometry:Du,EdgesGeometry:Xu,ConeGeometry:Ku,ConeBufferGeometry:tc,CylinderGeometry:Zu,CylinderBufferGeometry:Ju,CircleGeometry:ec,CircleBufferGeometry:nc,BoxGeometry:ga,BoxBufferGeometry:va});function rc(t){wr.call(this),this.type="ShadowMaterial",this.color=new gr(0),this.transparent=!0,this.setValues(t)}function ac(t){_a.call(this,t),this.type="RawShaderMaterial"}function oc(t){wr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new gr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function sc(t){oc.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Un(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function lc(t){wr.call(this),this.type="MeshPhongMaterial",this.color=new gr(16777215),this.specular=new gr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function uc(t){wr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new gr(16777215),this.specular=new gr(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function cc(t){wr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function hc(t){wr.call(this),this.type="MeshLambertMaterial",this.color=new gr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function dc(t){wr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new gr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fc(t){xl.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}rc.prototype=Object.create(wr.prototype),rc.prototype.constructor=rc,rc.prototype.isShadowMaterial=!0,rc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this},ac.prototype=Object.create(_a.prototype),ac.prototype.constructor=ac,ac.prototype.isRawShaderMaterial=!0,oc.prototype=Object.create(wr.prototype),oc.prototype.constructor=oc,oc.prototype.isMeshStandardMaterial=!0,oc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},sc.prototype=Object.create(oc.prototype),sc.prototype.constructor=sc,sc.prototype.isMeshPhysicalMaterial=!0,sc.prototype.copy=function(t){return oc.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new gr).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},lc.prototype=Object.create(wr.prototype),lc.prototype.constructor=lc,lc.prototype.isMeshPhongMaterial=!0,lc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},uc.prototype=Object.create(wr.prototype),uc.prototype.constructor=uc,uc.prototype.isMeshToonMaterial=!0,uc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},cc.prototype=Object.create(wr.prototype),cc.prototype.constructor=cc,cc.prototype.isMeshNormalMaterial=!0,cc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},hc.prototype=Object.create(wr.prototype),hc.prototype.constructor=hc,hc.prototype.isMeshLambertMaterial=!0,hc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dc.prototype=Object.create(wr.prototype),dc.prototype.constructor=dc,dc.prototype.isMeshMatcapMaterial=!0,dc.prototype.copy=function(t){return wr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fc.prototype=Object.create(xl.prototype),fc.prototype.constructor=fc,fc.prototype.isLineDashedMaterial=!0,fc.prototype.copy=function(t){return xl.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var pc=Object.freeze({__proto__:null,ShadowMaterial:rc,SpriteMaterial:js,RawShaderMaterial:ac,ShaderMaterial:_a,PointsMaterial:Ol,MeshPhysicalMaterial:sc,MeshStandardMaterial:oc,MeshPhongMaterial:lc,MeshToonMaterial:uc,MeshNormalMaterial:cc,MeshLambertMaterial:hc,MeshDepthMaterial:Es,MeshDistanceMaterial:Ms,MeshBasicMaterial:Sr,MeshMatcapMaterial:dc,LineDashedMaterial:fc,LineBasicMaterial:xl,Material:wr}),mc={arraySlice:function(t,e,n){return mc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),i=0;i!==e;++i)n[i]=i;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),a=0,o=0;o!==i;++a)for(var s=n[a]*e,l=0;l!==e;++l)r[o++]=t[s+l];return r},flattenJSON:function(t,e,n,i){for(var r=1,a=t[0];void 0!==a&&void 0===a[i];)a=t[r++];if(void 0!==a){var o=a[i];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[i])&&(e.push(a.time),n.push.apply(n,o)),a=t[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[i])&&(e.push(a.time),o.toArray(n,n.length)),a=t[r++]}while(void 0!==a);else do{void 0!==(o=a[i])&&(e.push(a.time),n.push(o)),a=t[r++]}while(void 0!==a)}},subclip:function(t,e,n,i,r){r=r||30;var a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var f=l.times[d]*r;if(!(f<n||f>=i)){c.push(l.times[d]);for(var p=0;p<u;++p)h.push(l.values[d*u+p])}}0!==c.length&&(l.times=mc.convertArray(c,l.times.constructor),l.values=mc.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=t),(void 0===i||i<=0)&&(i=30);for(var r=t.tracks.length,a=e/i,o=0;o<r;++o){var s=n.tracks[o],l=s.ValueTypeName;if("bool"!==l&&"string"!==l){var u=t.tracks.find((function(t){return t.name===s.name&&t.ValueTypeName===l}));if(void 0!==u){var c,h=s.getValueSize(),d=s.times.length-1;if(a<=s.times[0])c=mc.arraySlice(s.values,0,s.valueSize);else if(a>=s.times[d]){var f=d*h;c=mc.arraySlice(s.values,f)}else{var p=s.createInterpolant();p.evaluate(a),c=p.resultBuffer}if("quaternion"===l)new Xn(c[0],c[1],c[2],c[3]).normalize().conjugate().toArray(c);for(var m=u.times.length,g=0;g<m;++g){var v=g*h;if("quaternion"===l)Xn.multiplyQuaternionsFlat(u.values,v,c,0,u.values,v);else for(var y=0;y<h;++y)u.values[v+y]-=c[y]}}}}return t.blendMode=Ye,t}};function gc(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function vc(t,e,n,i){gc.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function yc(t,e,n,i){gc.call(this,t,e,n,i)}function bc(t,e,n,i){gc.call(this,t,e,n,i)}function xc(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=mc.convertArray(e,this.TimeBufferType),this.values=mc.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function _c(t,e,n){xc.call(this,t,e,n)}function wc(t,e,n,i){xc.call(this,t,e,n,i)}function Sc(t,e,n,i){xc.call(this,t,e,n,i)}function Ec(t,e,n,i){gc.call(this,t,e,n,i)}function Mc(t,e,n,i){xc.call(this,t,e,n,i)}function Cc(t,e,n,i){xc.call(this,t,e,n,i)}function Tc(t,e,n,i){xc.call(this,t,e,n,i)}function kc(t,e,n,i){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==i?i:Qe,this.uuid=jn.generateUUID(),this.duration<0&&this.resetDuration()}function Pc(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sc;case"vector":case"vector2":case"vector3":case"vector4":return Tc;case"color":return wc;case"quaternion":return Mc;case"bool":case"boolean":return _c;case"string":return Cc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],i=[];mc.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(gc.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{var a;n:{i:if(!(t<i)){for(var o=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===o)break;if(r=i,t<(i=e[++n]))break e}a=e.length;break n}if(t>=r)break t;var s=e[1];t<s&&(n=2,r=s);for(o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===o)break;if(i=r,t>=(r=e[--n-1]))break e}a=n,n=0}for(;n<a;){var l=n+a>>>1;t<e[l]?a=l:n=l+1}if(i=e[n],void 0===(r=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,a=0;a!==i;++a)e[a]=n[r+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(gc.prototype,{beforeStart_:gc.prototype.copySampleValue_,afterEnd_:gc.prototype.copySampleValue_}),vc.prototype=Object.assign(Object.create(gc.prototype),{constructor:vc,DefaultSettings_:{endingStart:We,endingEnd:We},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,a=t+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case qe:r=t,o=2*e-n;break;case $e:o=e+i[r=i.length-2]-i[r+1];break;default:r=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case qe:a=t,s=2*n-e;break;case $e:a=1,s=n+i[1]-i[0];break;default:a=t-1,s=e}var l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-n),this._offsetPrev=r*u,this._offsetNext=a*u},interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(i-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,x=0;x!==o;++x)r[x]=g*a[u+x]+v*a[l+x]+y*a[s+x]+b*a[c+x];return r}}),yc.prototype=Object.assign(Object.create(gc.prototype),{constructor:yc,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=(n-e)/(i-e),c=1-u,h=0;h!==o;++h)r[h]=a[l+h]*c+a[s+h]*u;return r}}),bc.prototype=Object.assign(Object.create(gc.prototype),{constructor:bc,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(xc,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:mc.convertArray(t.times,Array),values:mc.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e}}),Object.assign(xc.prototype,{constructor:xc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:He,InterpolantFactoryMethodDiscrete:function(t){return new bc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new yc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new vc(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Ue:e=this.InterpolantFactoryMethodDiscrete;break;case He:e=this.InterpolantFactoryMethodLinear;break;case Ge:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ue;case this.InterpolantFactoryMethodLinear:return He;case this.InterpolantFactoryMethodSmooth:return Ge}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,i=n.length,r=0,a=i-1;r!==i&&n[r]<t;)++r;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==r||a!==i){r>=a&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=mc.arraySlice(n,r,a),this.values=mc.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==i&&mc.isTypedArray(i)){o=0;for(var l=i.length;o!==l;++o){var u=i[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),t=!1;break}}}return t},optimize:function(){for(var t=mc.arraySlice(this.times),e=mc.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===Ge,r=1,a=t.length-1,o=1;o<a;++o){var s=!1,l=t[o];if(l!==t[o+1]&&(1!==o||l!==l[0]))if(i)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var f=e[u+d];if(f!==e[c+d]||f!==e[h+d]){s=!0;break}}if(s){if(o!==r){t[r]=t[o];var p=o*n,m=r*n;for(d=0;d!==n;++d)e[m+d]=e[p+d]}++r}}if(a>0){t[r]=t[a];for(p=a*n,m=r*n,d=0;d!==n;++d)e[m+d]=e[p+d];++r}return r!==t.length?(this.times=mc.arraySlice(t,0,r),this.values=mc.arraySlice(e,0,r*n)):(this.times=t,this.values=e),this},clone:function(){var t=mc.arraySlice(this.times,0),e=mc.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),_c.prototype=Object.assign(Object.create(xc.prototype),{constructor:_c,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ue,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),wc.prototype=Object.assign(Object.create(xc.prototype),{constructor:wc,ValueTypeName:"color"}),Sc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Sc,ValueTypeName:"number"}),Ec.prototype=Object.assign(Object.create(gc.prototype),{constructor:Ec,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=(n-e)/(i-e),u=s+o;s!==u;s+=4)Xn.slerpFlat(r,0,a,s-o,a,s,l);return r}}),Mc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Mc,ValueTypeName:"quaternion",DefaultInterpolation:He,InterpolantFactoryMethodLinear:function(t){return new Ec(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Cc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Cc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ue,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Tc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Tc,ValueTypeName:"vector"}),Object.assign(kc,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,a=n.length;r!==a;++r)e.push(Pc(n[r]).scale(i));return new kc(t.name,t.duration,e,t.blendMode)},toJSON:function(t){for(var e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode},r=0,a=n.length;r!==a;++r)e.push(xc.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(t,e,n,i){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var u=mc.getKeyframeOrder(s);s=mc.sortedArray(s,1,u),l=mc.sortedArray(l,1,u),i||0!==s[0]||(s.push(r),l.push(l[0])),a.push(new Sc(".morphTargetInfluences["+e[o].name+"]",s,l).scale(1/n))}return new kc(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var i=t;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],l=s.name.match(r);if(l&&l.length>1){var u=i[h=l[1]];u||(i[h]=u=[]),u.push(s)}}var c=[];for(var h in i)c.push(kc.CreateFromMorphTargetSequence(h,i[h],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,i,r){if(0!==n.length){var a=[],o=[];mc.flattenJSON(n,a,o,i),0!==a.length&&r.push(new t(e,a,o))}},i=[],r=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.blendMode,l=t.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},d=0;d<c.length;d++)if(c[d].morphTargets)for(var f=0;f<c[d].morphTargets.length;f++)h[c[d].morphTargets[f]]=-1;for(var p in h){var m=[],g=[];for(f=0;f!==c[d].morphTargets.length;++f){var v=c[d];m.push(v.time),g.push(v.morphTarget===p?1:0)}i.push(new Sc(".morphTargetInfluence["+p+"]",m,g))}a=h.length*(o||1)}else{var y=".bones["+e[u].name+"]";n(Tc,y+".position",c,"pos",i),n(Mc,y+".quaternion",c,"rot",i),n(Tc,y+".scale",c,"scl",i)}}return 0===i.length?null:new kc(r,a,i,s)}}),Object.assign(kc.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new kc(this.name,this.duration,t,this.blendMode)}});var Ac={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Oc(t,e,n){var i=this,r=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===r&&void 0!==i.onStart&&i.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){var e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=l.length;e<n;e+=2){var i=l[e],r=l[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return r}return null}}var Lc=new Oc;function Rc(t){this.manager=void 0!==t?t:Lc,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Rc.prototype,{load:function(){},loadAsync:function(t,e){var n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var Ic={};function Nc(t){Rc.call(this,t)}function Dc(t){Rc.call(this,t)}function zc(t){Rc.call(this,t)}function Bc(t){Rc.call(this,t)}function Fc(t){Rc.call(this,t)}function Vc(t){Rc.call(this,t)}function jc(t){Rc.call(this,t)}function Uc(){this.type="Curve",this.arcLengthDivisions=200}function Hc(t,e,n,i,r,a,o,s){Uc.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Gc(t,e,n,i,r,a){Hc.call(this,t,e,n,n,i,r,a),this.type="ArcCurve"}function Wc(){var t=0,e=0,n=0,i=0;function r(r,a,o,s){t=r,e=o,n=-3*r+3*a-2*o-s,i=2*r-2*a+o+s}return{initCatmullRom:function(t,e,n,i,a){r(e,n,a*(n-t),a*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,a,o,s){var l=(e-t)/a-(n-t)/(a+o)+(n-e)/o,u=(n-e)/o-(i-e)/(o+s)+(i-n)/s;r(e,n,l*=o,u*=o)},calc:function(r){var a=r*r;return t+e*r+n*a+i*(a*r)}}}Nc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Nc,load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Ac.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;if(void 0===Ic[t]){var o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],l=!!o[2],u=o[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),f=0;f<u.length;f++)d[f]=u.charCodeAt(f);c="blob"===h?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}setTimeout((function(){e&&e(c),r.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}),0)}}else{Ic[t]=[],Ic[t].push({onLoad:e,onProgress:n,onError:i});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,i=Ic[t];if(delete Ic[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ac.add(t,n);for(var a=0,o=i.length;a<o;a++){(s=i[a]).onLoad&&s.onLoad(n)}r.manager.itemEnd(t)}else{for(a=0,o=i.length;a<o;a++){var s;(s=i[a]).onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=Ic[t],i=0,r=n.length;i<r;i++){var a=n[i];a.onProgress&&a.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=Ic[t];delete Ic[t];for(var i=0,a=n.length;i<a;i++){var o=n[i];o.onError&&o.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=Ic[t];delete Ic[t];for(var i=0,a=n.length;i<a;i++){var o=n[i];o.onError&&o.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return r.manager.itemStart(t),m}Ic[t].push({onLoad:e,onProgress:n,onError:i})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Dc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Dc,load:function(t,e,n,i){var r=this,a=new Nc(r.manager);a.setPath(r.path),a.load(t,(function(t){e(r.parse(JSON.parse(t)))}),n,i)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var i=kc.parse(t[n]);e.push(i)}return e}}),zc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:zc,load:function(t,e,n,i){var r=this,a=[],o=new Fl;o.image=a;var s=new Nc(this.manager);function l(l){s.load(t[l],(function(t){var n=r.parse(t,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=wt),o.format=n.format,o.needsUpdate=!0,e&&e(o))}),n,i)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=0,h=t.length;c<h;++c)l(c);else s.load(t,(function(t){var n=r.parse(t,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,s=0;s<i;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=wt),o.format=n.format,o.needsUpdate=!0,e&&e(o)}),n,i);return o}}),Bc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Bc,load:function(t,e,n,i){var r=this,a=new Ca,o=new Nc(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,(function(t){var n=r.parse(t);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:mt,a.wrapT=void 0!==n.wrapT?n.wrapT:mt,a.magFilter=void 0!==n.magFilter?n.magFilter:wt,a.minFilter=void 0!==n.minFilter?n.minFilter:wt,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Mt),1===n.mipmapCount&&(a.minFilter=wt),a.needsUpdate=!0,e&&e(a,n))}),n,i),a}}),Fc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Fc,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Ac.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Ac.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}),Vc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Vc,load:function(t,e,n,i){var r=new Qa,a=new Fc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(t[n],(function(t){r.images[n]=t,6===++o&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(var l=0;l<t.length;++l)s(l);return r}}),jc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:jc,load:function(t,e,n,i){var r=new qn,a=new Fc(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,(function(n){r.image=n;var i=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);r.format=i?Vt:jt,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}),Object.assign(Uc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),a=0;for(i.push(0),n=1;n<=t;n++)a+=(e=this.getPoint(n/t)).distanceTo(r),i.push(a),r=e;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i=this.getLengths(),r=0,a=i.length;n=e||t*i[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=i[r=Math.floor(s+(l-s)/2)]-n)<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(i[r=l]===n)return r/(a-1);var u=i[r];return(r+(n-u)/(i[r+1]-u))/(a-1)},getTangent:function(t,e){var n=t-1e-4,i=t+1e-4;n<0&&(n=0),i>1&&(i=1);var r=this.getPoint(n),a=this.getPoint(i),o=e||(r.isVector2?new Un:new Kn);return o.copy(a).sub(r).normalize(),o},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){var n,i,r,a=new Kn,o=[],s=[],l=[],u=new Kn,c=new si;for(n=0;n<=t;n++)i=n/t,o[n]=this.getTangentAt(i,new Kn),o[n].normalize();s[0]=new Kn,l[0]=new Kn;var h=Number.MAX_VALUE,d=Math.abs(o[0].x),f=Math.abs(o[0].y),p=Math.abs(o[0].z);for(d<=h&&(h=d,a.set(1,0,0)),f<=h&&(h=f,a.set(0,1,0)),p<=h&&a.set(0,0,1),u.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],u),l[0].crossVectors(o[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(o[n-1],o[n]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(jn.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,r))),l[n].crossVectors(o[n],s[n]);if(!0===e)for(r=Math.acos(jn.clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(u.crossVectors(s[0],s[t]))>0&&(r=-r),n=1;n<=t;n++)s[n].applyMatrix4(c.makeRotationAxis(o[n],r*n)),l[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Hc.prototype=Object.create(Uc.prototype),Hc.prototype.constructor=Hc,Hc.prototype.isEllipseCurve=!0,Hc.prototype.getPoint=function(t,e){for(var n=e||new Un,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=a?0:i),!0!==this.aClockwise||a||(r===i?r=-i:r-=i);var o=this.aStartAngle+t*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)},Hc.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Hc.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Hc.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Gc.prototype=Object.create(Hc.prototype),Gc.prototype.constructor=Gc,Gc.prototype.isArcCurve=!0;var qc=new Kn,$c=new Wc,Qc=new Wc,Yc=new Wc;function Xc(t,e,n,i){Uc.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Zc(t,e,n,i,r){var a=.5*(i-e),o=.5*(r-n),s=t*t;return(2*n-2*i+a+o)*(t*s)+(-3*n+3*i-2*a-o)*s+a*t+n}function Jc(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function Kc(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}function th(t,e,n,i){Uc.call(this),this.type="CubicBezierCurve",this.v0=t||new Un,this.v1=e||new Un,this.v2=n||new Un,this.v3=i||new Un}function eh(t,e,n,i){Uc.call(this),this.type="CubicBezierCurve3",this.v0=t||new Kn,this.v1=e||new Kn,this.v2=n||new Kn,this.v3=i||new Kn}function nh(t,e){Uc.call(this),this.type="LineCurve",this.v1=t||new Un,this.v2=e||new Un}function ih(t,e){Uc.call(this),this.type="LineCurve3",this.v1=t||new Kn,this.v2=e||new Kn}function rh(t,e,n){Uc.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Un,this.v1=e||new Un,this.v2=n||new Un}function ah(t,e,n){Uc.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Kn,this.v1=e||new Kn,this.v2=n||new Kn}function oh(t){Uc.call(this),this.type="SplineCurve",this.points=t||[]}Xc.prototype=Object.create(Uc.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isCatmullRomCurve3=!0,Xc.prototype.getPoint=function(t,e){var n,i,r,a,o=e||new Kn,s=this.points,l=s.length,u=(l-(this.closed?0:1))*t,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?n=s[(c-1)%l]:(qc.subVectors(s[0],s[1]).add(s[0]),n=qc),i=s[c%l],r=s[(c+1)%l],this.closed||c+2<l?a=s[(c+2)%l]:(qc.subVectors(s[l-1],s[l-2]).add(s[l-1]),a=qc),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(i),d),p=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(a),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),$c.initNonuniformCatmullRom(n.x,i.x,r.x,a.x,f,p,m),Qc.initNonuniformCatmullRom(n.y,i.y,r.y,a.y,f,p,m),Yc.initNonuniformCatmullRom(n.z,i.z,r.z,a.z,f,p,m)}else"catmullrom"===this.curveType&&($c.initCatmullRom(n.x,i.x,r.x,a.x,this.tension),Qc.initCatmullRom(n.y,i.y,r.y,a.y,this.tension),Yc.initCatmullRom(n.z,i.z,r.z,a.z,this.tension));return o.set($c.calc(h),Qc.calc(h),Yc.calc(h)),o},Xc.prototype.copy=function(t){Uc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Xc.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Xc.prototype.fromJSON=function(t){Uc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push((new Kn).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},th.prototype=Object.create(Uc.prototype),th.prototype.constructor=th,th.prototype.isCubicBezierCurve=!0,th.prototype.getPoint=function(t,e){var n=e||new Un,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Kc(t,i.x,r.x,a.x,o.x),Kc(t,i.y,r.y,a.y,o.y)),n},th.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},th.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},th.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},eh.prototype=Object.create(Uc.prototype),eh.prototype.constructor=eh,eh.prototype.isCubicBezierCurve3=!0,eh.prototype.getPoint=function(t,e){var n=e||new Kn,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Kc(t,i.x,r.x,a.x,o.x),Kc(t,i.y,r.y,a.y,o.y),Kc(t,i.z,r.z,a.z,o.z)),n},eh.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},eh.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},eh.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},nh.prototype=Object.create(Uc.prototype),nh.prototype.constructor=nh,nh.prototype.isLineCurve=!0,nh.prototype.getPoint=function(t,e){var n=e||new Un;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},nh.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},nh.prototype.getTangent=function(t,e){return(e||new Un).copy(this.v2).sub(this.v1).normalize()},nh.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},nh.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},nh.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ih.prototype=Object.create(Uc.prototype),ih.prototype.constructor=ih,ih.prototype.isLineCurve3=!0,ih.prototype.getPoint=function(t,e){var n=e||new Kn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},ih.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ih.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ih.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ih.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},rh.prototype=Object.create(Uc.prototype),rh.prototype.constructor=rh,rh.prototype.isQuadraticBezierCurve=!0,rh.prototype.getPoint=function(t,e){var n=e||new Un,i=this.v0,r=this.v1,a=this.v2;return n.set(Jc(t,i.x,r.x,a.x),Jc(t,i.y,r.y,a.y)),n},rh.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},rh.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},rh.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ah.prototype=Object.create(Uc.prototype),ah.prototype.constructor=ah,ah.prototype.isQuadraticBezierCurve3=!0,ah.prototype.getPoint=function(t,e){var n=e||new Kn,i=this.v0,r=this.v1,a=this.v2;return n.set(Jc(t,i.x,r.x,a.x),Jc(t,i.y,r.y,a.y),Jc(t,i.z,r.z,a.z)),n},ah.prototype.copy=function(t){return Uc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ah.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ah.prototype.fromJSON=function(t){return Uc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},oh.prototype=Object.create(Uc.prototype),oh.prototype.constructor=oh,oh.prototype.isSplineCurve=!0,oh.prototype.getPoint=function(t,e){var n=e||new Un,i=this.points,r=(i.length-1)*t,a=Math.floor(r),o=r-a,s=i[0===a?a:a-1],l=i[a],u=i[a>i.length-2?i.length-1:a+1],c=i[a>i.length-3?i.length-1:a+2];return n.set(Zc(o,s.x,l.x,u.x,c.x),Zc(o,s.y,l.y,u.y,c.y)),n},oh.prototype.copy=function(t){Uc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push(i.clone())}return this},oh.prototype.toJSON=function(){var t=Uc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var i=this.points[e];t.points.push(i.toArray())}return t},oh.prototype.fromJSON=function(t){Uc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push((new Un).fromArray(i))}return this};var sh=Object.freeze({__proto__:null,ArcCurve:Gc,CatmullRomCurve3:Xc,CubicBezierCurve:th,CubicBezierCurve3:eh,EllipseCurve:Hc,LineCurve:nh,LineCurve3:ih,QuadraticBezierCurve:rh,QuadraticBezierCurve3:ah,SplineCurve:oh});function lh(){Uc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function uh(t){lh.call(this),this.type="Path",this.currentPoint=new Un,t&&this.setFromPoints(t)}function ch(t){uh.call(this,t),this.uuid=jn.generateUUID(),this.type="Shape",this.holes=[]}function hh(t,e){Mi.call(this),this.type="Light",this.color=new gr(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function dh(t,e,n){hh.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Mi.DefaultUp),this.updateMatrix(),this.groundColor=new gr(e)}function fh(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Un(512,512),this.map=null,this.mapPass=null,this.matrix=new si,this._frustum=new Pa,this._frameExtents=new Un(1,1),this._viewportCount=1,this._viewports=[new $n(0,0,1,1)]}function ph(){fh.call(this,new Sa(50,1,.5,500))}function mh(t,e,n,i,r,a){hh.call(this,t,e),this.type="SpotLight",this.position.copy(Mi.DefaultUp),this.updateMatrix(),this.target=new Mi,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new ph}function gh(){fh.call(this,new Sa(90,1,.5,500)),this._frameExtents=new Un(4,2),this._viewportCount=6,this._viewports=[new $n(2,1,1,1),new $n(0,1,1,1),new $n(3,1,1,1),new $n(1,1,1,1),new $n(3,0,1,1),new $n(1,0,1,1)],this._cubeDirections=[new Kn(1,0,0),new Kn(-1,0,0),new Kn(0,0,1),new Kn(0,0,-1),new Kn(0,1,0),new Kn(0,-1,0)],this._cubeUps=[new Kn(0,1,0),new Kn(0,1,0),new Kn(0,1,0),new Kn(0,1,0),new Kn(0,0,1),new Kn(0,0,-1)]}function vh(t,e,n,i){hh.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new gh}function yh(t,e,n,i,r,a){wa.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function bh(){fh.call(this,new yh(-5,5,5,-5,.5,500))}function xh(t,e){hh.call(this,t,e),this.type="DirectionalLight",this.position.copy(Mi.DefaultUp),this.updateMatrix(),this.target=new Mi,this.shadow=new bh}function _h(t,e){hh.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function wh(t,e,n,i){hh.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function Sh(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Kn)}function Eh(t,e){hh.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new Sh}function Mh(t){Rc.call(this,t),this.textures={}}lh.prototype=Object.assign(Object.create(Uc.prototype),{constructor:lh,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new nh(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e){var r=n[i]-e,a=this.curves[i],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}i++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var a=r[i],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Uc.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Uc.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var i=this.curves[e];t.curves.push(i.toJSON())}return t},fromJSON:function(t){Uc.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var i=t.curves[e];this.curves.push((new sh[i.type]).fromJSON(i))}return this}}),uh.prototype=Object.assign(Object.create(lh.prototype),{constructor:uh,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new nh(this.currentPoint.clone(),new Un(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,i){var r=new rh(this.currentPoint.clone(),new Un(t,e),new Un(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(t,e,n,i,r,a){var o=new th(this.currentPoint.clone(),new Un(t,e),new Un(n,i),new Un(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this},splineThru:function(t){var e=new oh([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,i,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,n,i,r,a),this},absarc:function(t,e,n,i,r,a){return this.absellipse(t,e,n,n,i,r,a),this},ellipse:function(t,e,n,i,r,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,n,i,r,a,o,s),this},absellipse:function(t,e,n,i,r,a,o,s){var l=new Hc(t,e,n,i,r,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this},copy:function(t){return lh.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=lh.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return lh.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ch.prototype=Object.assign(Object.create(uh.prototype),{constructor:ch,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){uh.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var i=t.holes[e];this.holes.push(i.clone())}return this},toJSON:function(){var t=uh.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var i=this.holes[e];t.holes.push(i.toJSON())}return t},fromJSON:function(t){uh.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var i=t.holes[e];this.holes.push((new uh).fromJSON(i))}return this}}),hh.prototype=Object.assign(Object.create(Mi.prototype),{constructor:hh,isLight:!0,copy:function(t){return Mi.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Mi.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),dh.prototype=Object.assign(Object.create(hh.prototype),{constructor:dh,isHemisphereLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(fh.prototype,{_projScreenMatrix:new si,_lightPositionWorld:new Kn,_lookTarget:new Kn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),i.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ph.prototype=Object.assign(Object.create(fh.prototype),{constructor:ph,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*jn.RAD2DEG*t.angle,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),fh.prototype.updateMatrices.call(this,t)}}),mh.prototype=Object.assign(Object.create(hh.prototype),{constructor:mh,isSpotLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),gh.prototype=Object.assign(Object.create(fh.prototype),{constructor:gh,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,i=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(t.matrixWorld),n.position.copy(r),a.copy(n.position),a.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(a),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),vh.prototype=Object.assign(Object.create(hh.prototype),{constructor:vh,isPointLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),yh.prototype=Object.assign(Object.create(wa.prototype),{constructor:yh,isOrthographicCamera:!0,copy:function(t,e){return wa.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,a=n+t,o=i+e,s=i-e;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(r+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Mi.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),bh.prototype=Object.assign(Object.create(fh.prototype),{constructor:bh,isDirectionalLightShadow:!0,updateMatrices:function(t){fh.prototype.updateMatrices.call(this,t)}}),xh.prototype=Object.assign(Object.create(hh.prototype),{constructor:xh,isDirectionalLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),_h.prototype=Object.assign(Object.create(hh.prototype),{constructor:_h,isAmbientLight:!0}),wh.prototype=Object.assign(Object.create(hh.prototype),{constructor:wh,isRectAreaLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=hh.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(Sh.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,i=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScaledVector(a[1],.488603*i),e.addScaledVector(a[2],.488603*r),e.addScaledVector(a[3],.488603*n),e.addScaledVector(a[4],n*i*1.092548),e.addScaledVector(a[5],i*r*1.092548),e.addScaledVector(a[6],.315392*(3*r*r-1)),e.addScaledVector(a[7],n*r*1.092548),e.addScaledVector(a[8],.546274*(n*n-i*i)),e},getIrradianceAt:function(t,e){var n=t.x,i=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScaledVector(a[1],1.023328*i),e.addScaledVector(a[2],1.023328*r),e.addScaledVector(a[3],1.023328*n),e.addScaledVector(a[4],.858086*n*i),e.addScaledVector(a[5],.858086*i*r),e.addScaledVector(a[6],.743125*r*r-.247708),e.addScaledVector(a[7],.858086*n*r),e.addScaledVector(a[8],.429043*(n*n-i*i)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}}),Object.assign(Sh,{getBasisAt:function(t,e){var n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}),Eh.prototype=Object.assign(Object.create(hh.prototype),{constructor:Eh,isLightProbe:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){var e=hh.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),Mh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Mh,load:function(t,e,n,i){var r=this,a=new Nc(r.manager);a.setPath(r.path),a.load(t,(function(t){e(r.parse(JSON.parse(t)))}),n,i)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var i=new pc[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=(new gr).setHex(t.sheen)),void 0!==t.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),1!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(i.morphNormals=t.morphNormals),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.vertexTangents&&(i.vertexTangents=t.vertexTangents),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var r in t.uniforms){var a=t.uniforms[r];switch(i.uniforms[r]={},a.type){case"t":i.uniforms[r].value=n(a.value);break;case"c":i.uniforms[r].value=(new gr).setHex(a.value);break;case"v2":i.uniforms[r].value=(new Un).fromArray(a.value);break;case"v3":i.uniforms[r].value=(new Kn).fromArray(a.value);break;case"v4":i.uniforms[r].value=(new $n).fromArray(a.value);break;case"m3":i.uniforms[r].value=(new Hn).fromArray(a.value);case"m4":i.uniforms[r].value=(new si).fromArray(a.value);break;default:i.uniforms[r].value=a.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)i.extensions[o]=t.extensions[o];if(void 0!==t.shading&&(i.flatShading=1===t.shading),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=n(t.map)),void 0!==t.matcap&&(i.matcap=n(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),i.normalScale=(new Un).fromArray(s)}return void 0!==t.displacementMap&&(i.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=n(t.specularMap)),void 0!==t.envMap&&(i.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Un).fromArray(t.clearcoatNormalScale)),i},setTextures:function(t){return this.textures=t,this}});var Ch={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function Th(){Gr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function kh(t,e,n,i){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Mr.call(this,t,e,n),this.meshPerAttribute=i||1}function Ph(t){Rc.call(this,t)}Th.prototype=Object.assign(Object.create(Gr.prototype),{constructor:Th,isInstancedBufferGeometry:!0,copy:function(t){return Gr.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Gr.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),kh.prototype=Object.assign(Object.create(Mr.prototype),{constructor:kh,isInstancedBufferAttribute:!0,copy:function(t){return Mr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Mr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Ph.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Ph,load:function(t,e,n,i){var r=this,a=new Nc(r.manager);a.setPath(r.path),a.load(t,(function(t){e(r.parse(JSON.parse(t)))}),n,i)},parse:function(t){var e=t.isInstancedBufferGeometry?new Th:new Gr,n=t.data.index;if(void 0!==n){var i=new Ah[n.type](n.array);e.setIndex(new Mr(i,1))}var r=t.data.attributes;for(var a in r){var o=r[a],s=(i=new Ah[o.type](o.array),new(o.isInstancedBufferAttribute?kh:Mr)(i,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),e.setAttribute(a,s)}var l=t.data.morphAttributes;if(l)for(var a in l){for(var u=l[a],c=[],h=0,d=u.length;h<d;h++){o=u[h],s=new Mr(i=new Ah[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),c.push(s)}e.morphAttributes[a]=c}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var f=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==f){h=0;for(var p=f.length;h!==p;++h){var m=f[h];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new Kn;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new Hi(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var Ah={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Oh(t){Rc.call(this,t)}Oh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Oh,load:function(t,e,n,i){var r=this,a=""===this.path?Ch.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;var o=new Nc(r.manager);o.setPath(this.path),o.load(t,(function(n){var a=null;try{a=JSON.parse(n)}catch(e){return void 0!==i&&i(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,i)},parse:function(t,e){var n=this.parseShape(t.shapes),i=this.parseGeometries(t.geometries,n),r=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),a=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,i,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,i=t.length;n<i;n++){var r=(new ch).fromJSON(t[n]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var i=new Ph,r=0,a=t.length;r<a;r++){var o,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new ic[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new ic[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new ic[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new ic[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new ic[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new ic[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new ic[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new ic[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new ic[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new ic[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new ic[s.type]((new sh[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new ic[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new ic[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],u=0,c=s.shapes.length;u<c;u++){var h=e[s.shapes[u]];l.push(h)}o=new ic[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],u=0,c=s.shapes.length;u<c;u++){h=e[s.shapes[u]];l.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new sh[d.type]).fromJSON(d)),o=new ic[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(t,e){var n={},i={};if(void 0!==t){var r=new Mh;r.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=r.parse(c)),l.push(n[c.uuid])}i[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=kc.parse(i);void 0!==i.uuid&&(r.uuid=i.uuid),e.push(r)}return e},parseImages:function(t,e){var n=this,i={};function r(t){return n.manager.itemStart(t),a.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var a=new Fc(new Oc(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var l=t[o],u=l.url;if(Array.isArray(u)){i[l.uuid]=[];for(var c=0,h=u.length;c<h;c++){var d=u[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;i[l.uuid].push(r(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.resourcePath+l.url;i[l.uuid]=r(f)}}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var r=0,a=t.length;r<a;r++){var o,s=t[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(e[s.image])?new Qa(e[s.image]):new qn(e[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,Rh)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Ih),o.wrapT=n(s.wrap[1],Ih)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,Nh)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,Nh)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),i[s.uuid]=o}return i},parseObject:function(t,e,n){var i;function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],i=0,r=t.length;i<r;i++){var a=t[i];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(n[a])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":i=new Ci,void 0!==t.background&&Number.isInteger(t.background)&&(i.background=new gr(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new Ds(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new Ns(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new Sa(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new yh(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"AmbientLight":i=new _h(t.color,t.intensity);break;case"DirectionalLight":i=new xh(t.color,t.intensity);break;case"PointLight":i=new vh(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new wh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new mh(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new dh(t.color,t.groundColor,t.intensity);break;case"LightProbe":i=(new Eh).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":i=new la(o=r(t.geometry),s=a(t.material));break;case"InstancedMesh":var o=r(t.geometry),s=a(t.material),l=t.count,u=t.instanceMatrix;(i=new bl(o,s,l)).instanceMatrix=new Mr(new Float32Array(u.array),16);break;case"LOD":i=new ul;break;case"Line":i=new Cl(r(t.geometry),a(t.material),t.mode);break;case"LineLoop":i=new Al(r(t.geometry),a(t.material));break;case"LineSegments":i=new Pl(r(t.geometry),a(t.material));break;case"PointCloud":case"Points":i=new Dl(r(t.geometry),a(t.material));break;case"Sprite":i=new tl(a(t.material));break;case"Group":i=new Os;break;default:i=new Mi}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(i.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.frustumCulled&&(i.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(i.renderOrder=t.renderOrder),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.layers&&(i.layers.mask=t.layers),void 0!==t.children)for(var c=t.children,h=0;h<c.length;h++)i.add(this.parseObject(c[h],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(i.autoUpdate=t.autoUpdate);for(var d=t.levels,f=0;f<d.length;f++){var p=d[f],m=i.getObjectByProperty("uuid",p.object);void 0!==m&&i.addLevel(m,p.distance)}}return i}});var Lh,Rh={UVMapping:ot,CubeReflectionMapping:st,CubeRefractionMapping:lt,EquirectangularReflectionMapping:ut,EquirectangularRefractionMapping:ct,SphericalReflectionMapping:ht,CubeUVReflectionMapping:dt,CubeUVRefractionMapping:ft},Ih={RepeatWrapping:pt,ClampToEdgeWrapping:mt,MirroredRepeatWrapping:gt},Nh={NearestFilter:vt,NearestMipmapNearestFilter:yt,NearestMipmapLinearFilter:xt,LinearFilter:wt,LinearMipmapNearestFilter:St,LinearMipmapLinearFilter:Mt};function Dh(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Rc.call(this,t),this.options=void 0}function zh(){this.type="ShapePath",this.color=new gr,this.subPaths=[],this.currentPath=null}function Bh(t){this.type="Font",this.data=t}function Fh(t,e,n,i,r){var a=r.glyphs[t]||r.glyphs["?"];if(a){var o,s,l,u,c,h,d,f,p=new zh;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*e+n,s=m[g++]*e+i,p.moveTo(o,s);break;case"l":o=m[g++]*e+n,s=m[g++]*e+i,p.lineTo(o,s);break;case"q":l=m[g++]*e+n,u=m[g++]*e+i,c=m[g++]*e+n,h=m[g++]*e+i,p.quadraticCurveTo(c,h,l,u);break;case"b":l=m[g++]*e+n,u=m[g++]*e+i,c=m[g++]*e+n,h=m[g++]*e+i,d=m[g++]*e+n,f=m[g++]*e+i,p.bezierCurveTo(c,h,d,f,l,u)}}return{offsetX:a.ha*e,path:p}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+r.familyName+".")}function Vh(t){Rc.call(this,t)}Dh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Dh,setOptions:function(t){return this.options=t,this},load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Ac.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===r.options?createImageBitmap(t):createImageBitmap(t,r.options)})).then((function(n){Ac.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}),Object.assign(zh.prototype,{moveTo:function(t,e){return this.currentPath=new uh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this},bezierCurveTo:function(t,e,n,i,r,a){return this.currentPath.bezierCurveTo(t,e,n,i,r,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],a=new ch;a.curves=r.curves,e.push(a)}return e}function i(t,e){for(var n=e.length,i=!1,r=n-1,a=0;a<n;r=a++){var o=e[r],s=e[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=e[a],l=-l,s=e[r],u=-u),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var c=u*(t.x-o.x)-l*(t.y-o.y);if(0===c)return!0;if(c<0)continue;i=!i}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return i}var r=Lu.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return n(a);var o,s,l,u=[];if(1===a.length)return s=a[0],(l=new ch).curves=s.curves,u.push(l),u;var c=!r(a[0].getPoints());c=t?!c:c;var h,d,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=r(h=(s=a[v]).getPoints()),(o=t?!o:o)?(!c&&p[g]&&g++,p[g]={s:new ch,p:h},p[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!p[0])return n(a);if(p.length>1){for(var b=!1,x=[],_=0,w=p.length;_<w;_++)f[_]=[];for(_=0,w=p.length;_<w;_++)for(var S=m[_],E=0;E<S.length;E++){for(var M=S[E],C=!0,T=0;T<p.length;T++)i(M.p,p[T].p)&&(_!==T&&x.push({froms:_,tos:T,hole:E}),C?(C=!1,f[T].push(M)):b=!0);C&&f[_].push(M)}x.length>0&&(b||(m=f))}v=0;for(var k=p.length;v<k;v++){l=p[v].s,u.push(l);for(var P=0,A=(d=m[v]).length;P<A;P++)l.holes.push(d[P].h)}return u}}),Object.assign(Bh.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],i=function(t,e,n){for(var i=Array.from?Array.from(t):String(t).split(""),r=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[],s=0,l=0,u=0;u<i.length;u++){var c=i[u];if("\n"===c)s=0,l-=a;else{var h=Fh(c,r,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}(t,e,this.data),r=0,a=i.length;r<a;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}}),Vh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Vh,load:function(t,e,n,i){var r=this,a=new Nc(this.manager);a.setPath(this.path),a.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var i=r.parse(n);e&&e(i)}),n,i)},parse:function(t){return new Bh(t)}});var jh={getContext:function(){return void 0===Lh&&(Lh=new(window.AudioContext||window.webkitAudioContext)),Lh},setContext:function(t){Lh=t}};function Uh(t){Rc.call(this,t)}function Hh(t,e,n){Eh.call(this,void 0,n);var i=(new gr).set(t),r=(new gr).set(e),a=new Kn(i.r,i.g,i.b),o=new Kn(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function Gh(t,e){Eh.call(this,void 0,e);var n=(new gr).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Uh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Uh,load:function(t,e,n,i){var r=new Nc(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(t,(function(t){var n=t.slice(0);jh.getContext().decodeAudioData(n,(function(t){e(t)}))}),n,i)}}),Hh.prototype=Object.assign(Object.create(Eh.prototype),{constructor:Hh,isHemisphereLightProbe:!0,copy:function(t){return Eh.prototype.copy.call(this,t),this},toJSON:function(t){return Eh.prototype.toJSON.call(this,t)}}),Gh.prototype=Object.assign(Object.create(Eh.prototype),{constructor:Gh,isAmbientLightProbe:!0,copy:function(t){return Eh.prototype.copy.call(this,t),this},toJSON:function(t){return Eh.prototype.toJSON.call(this,t)}});var Wh=new si,qh=new si;function $h(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Sa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Sa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Qh(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign($h.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,i,r=t.projectionMatrix.clone(),a=e.eyeSep/2,o=a*e.near/e.focus,s=e.near*Math.tan(jn.DEG2RAD*e.fov*.5)/e.zoom;qh.elements[12]=-a,Wh.elements[12]=a,n=-s*e.aspect+o,i=s*e.aspect+o,r.elements[0]=2*e.near/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraL.projectionMatrix.copy(r),n=-s*e.aspect-o,i=s*e.aspect-o,r.elements[0]=2*e.near/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(qh),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Wh)}}),Object.assign(Qh.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Yh=new Kn,Xh=new Xn,Zh=new Kn,Jh=new Kn;function Kh(){Mi.call(this),this.type="AudioListener",this.context=jh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Qh}function td(t){Mi.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Kh.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Kh,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Mi.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Yh,Xh,Zh),Jh.set(0,0,-1).applyQuaternion(Xh),e.positionX){var i=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Yh.x,i),e.positionY.linearRampToValueAtTime(Yh.y,i),e.positionZ.linearRampToValueAtTime(Yh.z,i),e.forwardX.linearRampToValueAtTime(Jh.x,i),e.forwardY.linearRampToValueAtTime(Jh.y,i),e.forwardZ.linearRampToValueAtTime(Jh.z,i),e.upX.linearRampToValueAtTime(n.x,i),e.upY.linearRampToValueAtTime(n.y,i),e.upZ.linearRampToValueAtTime(n.z,i)}else e.setPosition(Yh.x,Yh.y,Yh.z),e.setOrientation(Jh.x,Jh.y,Jh.z,n.x,n.y,n.z)}}),td.prototype=Object.assign(Object.create(Mi.prototype),{constructor:td,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var ed=new Kn,nd=new Xn,id=new Kn,rd=new Kn;function ad(t){td.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function od(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function sd(t,e,n){var i,r,a;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}ad.prototype=Object.assign(Object.create(td.prototype),{constructor:ad,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Mi.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(ed,nd,id),rd.set(0,0,1).applyQuaternion(nd);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(ed.x,n),e.positionY.linearRampToValueAtTime(ed.y,n),e.positionZ.linearRampToValueAtTime(ed.z,n),e.orientationX.linearRampToValueAtTime(rd.x,n),e.orientationY.linearRampToValueAtTime(rd.y,n),e.orientationZ.linearRampToValueAtTime(rd.z,n)}else e.setPosition(ed.x,ed.y,ed.z),e.setOrientation(rd.x,rd.y,rd.z)}}}),Object.assign(od.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(sd.prototype,{accumulate:function(t,e){var n=this.buffer,i=this.valueSize,r=t*i+i,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==i;++o)n[r+o]=n[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=a},accumulateAdditive:function(t){var e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){var e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){var s=e*this._origIndex;this._mixBufferRegion(n,i,s,1-r,e)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(var l=e,u=e+e;l!==u;++l)if(n[l]!==n[l+e]){o.setValue(n,i);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(var r=n,a=i;r!==a;++r)e[r]=e[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){var t=this._addIndex*this.valueSize;this.buffer.fill(0,t,t+this.valueSize)},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;this.buffer.copyWithin(e,t,this.valueSize)},_select:function(t,e,n,i,r){if(i>=.5)for(var a=0;a!==r;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,i){Xn.slerpFlat(t,e,t,e,t,n,i)},_slerpAdditive:function(t,e,n,i,r){var a=this._workIndex*r;Xn.multiplyQuaternionsFlat(t,a,t,e,t,n),Xn.slerpFlat(t,e,t,e,t,a,i)},_lerp:function(t,e,n,i,r){for(var a=1-i,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*i}},_lerpAdditive:function(t,e,n,i,r){for(var a=0;a!==r;++a){var o=e+a;t[o]=t[o]+t[n+a]*i}}});var ld=new RegExp("[\\[\\]\\.:\\/]","g"),ud="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",cd=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),hd=/(WCOD+)?/.source.replace("WCOD",ud),dd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),fd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),pd=new RegExp("^"+cd+hd+dd+fd+"$"),md=["material","materials","bones"];function gd(t,e,n){var i=n||vd.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}function vd(t,e,n){this.path=e,this.parsedPath=n||vd.parseTrackName(e),this.node=vd.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function yd(){this.uuid=jn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function bd(t,e,n,i){this._mixer=t,this._clip=e,this._localRoot=n||null,this.blendMode=i||e.blendMode;for(var r=e.tracks,a=r.length,o=new Array(a),s={endingStart:We,endingEnd:We},l=0;l!==a;++l){var u=r[l].createInterpolant(null);o[l]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ve,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function xd(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function _d(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function wd(t,e,n){zs.call(this,t,e),this.meshPerAttribute=n||1}function Sd(t,e,n,i){this.ray=new Zi(t,e),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new hi,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ed(t,e){return t.distance-e.distance}function Md(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i)for(var r=t.children,a=0,o=r.length;a<o;a++)Md(r[a],e,n,!0)}function Cd(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Td(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}Object.assign(gd.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(vd,{Composite:gd,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new vd.Composite(t,e,n):new vd(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(ld,"")},parseTrackName:function(t){var e=pd.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==md.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var i=function(t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e||r.uuid===e)return r;var a=i(r.children);if(a)return a}return null},r=i(t.children);if(r)return r}return null}}),Object.assign(vd.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(t=vd.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[i];if(void 0!==s){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===r){r=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(vd.prototype,{_getValue_unbound:vd.prototype.getValue,_setValue_unbound:vd.prototype.setValue}),Object.assign(yd.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=i[d];if(void 0===f){f=e++,i[d]=f,t.push(h);for(var p=0,m=s;p!==m;++p)o[p].push(new vd(h,r[p],a[p]))}else if(f<n){l=t[f];var g=--n,v=t[g];i[v.uuid]=f,t[f]=v,i[d]=g,t[g]=h;for(p=0,m=s;p!==m;++p){var y=o[p],b=y[g],x=y[f];y[f]=b,void 0===x&&(x=new vd(h,r[p],a[p])),y[g]=x}}else t[f]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=n[l];if(void 0!==u&&u>=e){var c=e++,h=t[c];n[h.uuid]=u,t[u]=h,n[l]=c,t[c]=s;for(var d=0,f=r;d!==f;++d){var p=i[d],m=p[c],g=p[u];p[u]=m,p[c]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],u=l.uuid,c=i[u];if(void 0!==c)if(delete i[u],c<n){var h=--n,d=t[h],f=t[y=--e];i[d.uuid]=c,t[c]=d,i[f.uuid]=h,t[h]=f,t.pop();for(var p=0,m=a;p!==m;++p){var g=(b=r[p])[h],v=b[y];b[c]=g,b[h]=v,b.pop()}}else{var y;i[(f=t[y=--e]).uuid]=c,t[c]=f,t.pop();for(p=0,m=a;p!==m;++p){var b;(b=r[p])[c]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[t]=i,a.push(t),o.push(e),r.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new vd(f,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=n,a[n]=s,a.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}),Object.assign(bd.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var i=this._clip.duration,r=t._clip.duration,a=r/i,o=i/r;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+n,l[0]=t/o,l[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){if(this.enabled){var r=this._startTime;if(null!==r){var a=(t-r)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0){var l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case Ye:for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);break;case Qe:default:for(c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(i,s)}}}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,i=this.loop,r=this._loopCount,a=i===je;if(0===t)return-1===r?e:a&&1==(1&r)?n-e:e;if(i===Fe){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var l=t<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(a&&1==(1&r))return n-e}return e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=qe,i.endingEnd=qe):(i.endingStart=t?this.zeroSlopeAtStart?qe:We:$e,i.endingEnd=e?this.zeroSlopeAtEnd?qe:We:$e)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=n,this}}),xd.prototype=Object.assign(Object.create(zn.prototype),{constructor:xd,_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==r;++c){var h=i[c],d=h.name,f=u[d];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=e&&e._propertyBindings[c].binding.parsedPath;++(f=new sd(vd.create(n,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),a[c]=f}o[c].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(var r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=i.length,i.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],a=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[i],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete o[r],0===Object.keys(o).length&&delete a[i]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new yc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){var i=e||this._root,r=i.uuid,a="string"==typeof t?kc.findByName(i,t):t,o=null!==a?a.uuid:t,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:Qe),void 0!==s){var u=s.actionByRoot[r];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new bd(this,a,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c},existingAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?kc.findByName(n,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[i]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(i,t,r,a)}var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,e[u]=c,e.pop(),this._removeInactiveBindingsForAction(l)}delete i[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),_d.prototype.clone=function(){return new _d(void 0===this.value.clone?this.value:this.value.clone())},wd.prototype=Object.assign(Object.create(zs.prototype),{constructor:wd,isInstancedInterleavedBuffer:!0,copy:function(t){return zs.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Sd.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var i=n||[];return Md(t,this,i,e),i.sort(Ed),i},intersectObjects:function(t,e,n){var i=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,a=t.length;r<a;r++)Md(t[r],this,i,e);return i.sort(Ed),i}}),Object.assign(Cd.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(jn.clamp(e/this.radius,-1,1))),this}}),Object.assign(Td.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var kd=new Un;function Pd(t,e){this.min=void 0!==t?t:new Un(1/0,1/0),this.max=void 0!==e?e:new Un(-1/0,-1/0)}Object.assign(Pd.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=kd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Un),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Un),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Un),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Un),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return kd.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ad=new Kn,Od=new Kn;function Ld(t,e){this.start=void 0!==t?t:new Kn,this.end=void 0!==e?e:new Kn}function Rd(t){Mi.call(this),this.material=t,this.render=function(){}}Object.assign(Ld.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Kn),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Kn),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Kn),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){Ad.subVectors(t,this.start),Od.subVectors(this.end,this.start);var n=Od.dot(Od),i=Od.dot(Ad)/n;return e&&(i=jn.clamp(i,0,1)),i},closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Kn),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Rd.prototype=Object.create(Mi.prototype),Rd.prototype.constructor=Rd,Rd.prototype.isImmediateRenderObject=!0;var Id=new Kn;function Nd(t,e){Mi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Gr,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1;r<32;r++,a++){var o=r/32*Math.PI*2,s=a/32*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new Rr(i,3));var l=new xl({fog:!1,toneMapped:!1});this.cone=new Pl(n,l),this.add(this.cone),this.update()}Nd.prototype=Object.create(Mi.prototype),Nd.prototype.constructor=Nd,Nd.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Nd.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Id.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Id),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Dd=new Kn,zd=new si,Bd=new si;function Fd(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var i=0;i<e.children.length;i++)n.push.apply(n,t(e.children[i]));return n}(t),n=new Gr,i=[],r=[],a=new gr(0,0,1),o=new gr(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Rr(i,3)),n.setAttribute("color",new Rr(r,3));var u=new xl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Pl.call(this,n,u),this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Vd(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var i=new Uu(e,4,2),r=new Sr({wireframe:!0,fog:!1,toneMapped:!1});la.call(this,i,r),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Fd.prototype=Object.create(Pl.prototype),Fd.prototype.constructor=Fd,Fd.prototype.isSkeletonHelper=!0,Fd.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,i=n.getAttribute("position");Bd.getInverse(this.root.matrixWorld);for(var r=0,a=0;r<e.length;r++){var o=e[r];o.parent&&o.parent.isBone&&(zd.multiplyMatrices(Bd,o.matrixWorld),Dd.setFromMatrixPosition(zd),i.setXYZ(a,Dd.x,Dd.y,Dd.z),zd.multiplyMatrices(Bd,o.parent.matrixWorld),Dd.setFromMatrixPosition(zd),i.setXYZ(a+1,Dd.x,Dd.y,Dd.z),a+=2)}n.getAttribute("position").needsUpdate=!0,Mi.prototype.updateMatrixWorld.call(this,t)},Vd.prototype=Object.create(la.prototype),Vd.prototype.constructor=Vd,Vd.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Vd.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var jd=new Kn,Ud=new gr,Hd=new gr;function Gd(t,e,n){Mi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new Xl(e);i.rotateY(.5*Math.PI),this.material=new Sr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var r=i.getAttribute("position"),a=new Float32Array(3*r.count);i.setAttribute("color",new Mr(a,3)),this.add(new la(i,this.material)),this.update()}function Wd(t,e,n,i){t=t||10,e=e||10,n=new gr(void 0!==n?n:4473924),i=new gr(void 0!==i?i:8947848);for(var r=e/2,a=t/e,o=t/2,s=[],l=[],u=0,c=0,h=-o;u<=e;u++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=u===r?n:i;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var f=new Gr;f.setAttribute("position",new Rr(s,3)),f.setAttribute("color",new Rr(l,3));var p=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,f,p),this.type="GridHelper"}function qd(t,e,n,i,r,a){t=t||10,e=e||16,n=n||8,i=i||64,r=new gr(void 0!==r?r:4473924),a=new gr(void 0!==a?a:8947848);var o,s,l,u,c,h,d,f=[],p=[];for(u=0;u<=e;u++)l=u/e*(2*Math.PI),o=Math.sin(l)*t,s=Math.cos(l)*t,f.push(0,0,0),f.push(o,0,s),d=1&u?r:a,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?r:a,h=t-t/n*u,c=0;c<i;c++)l=c/i*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b),l=(c+1)/i*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b);var m=new Gr;m.setAttribute("position",new Rr(f,3)),m.setAttribute("color",new Rr(p,3));var g=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,m,g),this.type="PolarGridHelper"}Gd.prototype=Object.create(Mi.prototype),Gd.prototype.constructor=Gd,Gd.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Gd.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Ud.copy(this.light.color),Hd.copy(this.light.groundColor);for(var n=0,i=e.count;n<i;n++){var r=n<i/2?Ud:Hd;e.setXYZ(n,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(jd.setFromMatrixPosition(this.light.matrixWorld).negate())},Wd.prototype=Object.assign(Object.create(Pl.prototype),{constructor:Wd,copy:function(t){return Pl.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),qd.prototype=Object.create(Pl.prototype),qd.prototype.constructor=qd;var $d=new Kn,Qd=new Kn,Yd=new Kn;function Xd(t,e,n){Mi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var i=new Gr;i.setAttribute("position",new Rr([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new xl({fog:!1,toneMapped:!1});this.lightPlane=new Cl(i,r),this.add(this.lightPlane),(i=new Gr).setAttribute("position",new Rr([0,0,0,0,0,1],3)),this.targetLine=new Cl(i,r),this.add(this.targetLine),this.update()}Xd.prototype=Object.create(Mi.prototype),Xd.prototype.constructor=Xd,Xd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Xd.prototype.update=function(){$d.setFromMatrixPosition(this.light.matrixWorld),Qd.setFromMatrixPosition(this.light.target.matrixWorld),Yd.subVectors(Qd,$d),this.lightPlane.lookAt(Qd),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Qd),this.targetLine.scale.z=Yd.length()};var Zd=new Kn,Jd=new wa;function Kd(t){var e=new Gr,n=new xl({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],a={},o=new gr(16755200),s=new gr(16711680),l=new gr(43775),u=new gr(16777215),c=new gr(3355443);function h(t,e,n){d(t,n),d(e,n)}function d(t,e){i.push(0,0,0),r.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(i.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.setAttribute("position",new Rr(i,3)),e.setAttribute("color",new Rr(r,3)),Pl.call(this,e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function tf(t,e,n,i,r,a,o){Zd.set(r,a,o).unproject(i);var s=e[t];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Zd.x,Zd.y,Zd.z)}Kd.prototype=Object.create(Pl.prototype),Kd.prototype.constructor=Kd,Kd.prototype.update=function(){var t=this.geometry,e=this.pointMap;Jd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),tf("c",e,t,Jd,0,0,-1),tf("t",e,t,Jd,0,0,1),tf("n1",e,t,Jd,-1,-1,-1),tf("n2",e,t,Jd,1,-1,-1),tf("n3",e,t,Jd,-1,1,-1),tf("n4",e,t,Jd,1,1,-1),tf("f1",e,t,Jd,-1,-1,1),tf("f2",e,t,Jd,1,-1,1),tf("f3",e,t,Jd,-1,1,1),tf("f4",e,t,Jd,1,1,1),tf("u1",e,t,Jd,.7,1.1,-1),tf("u2",e,t,Jd,-.7,1.1,-1),tf("u3",e,t,Jd,0,2,-1),tf("cf1",e,t,Jd,-1,0,1),tf("cf2",e,t,Jd,1,0,1),tf("cf3",e,t,Jd,0,-1,1),tf("cf4",e,t,Jd,0,1,1),tf("cn1",e,t,Jd,-1,0,-1),tf("cn2",e,t,Jd,1,0,-1),tf("cn3",e,t,Jd,0,-1,-1),tf("cn4",e,t,Jd,0,1,-1),t.getAttribute("position").needsUpdate=!0};var ef=new Vi;function nf(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Gr;r.setIndex(new Mr(n,1)),r.setAttribute("position",new Mr(i,3)),Pl.call(this,r,new xl({color:e,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function rf(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Gr;i.setIndex(new Mr(n,1)),i.setAttribute("position",new Rr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Pl.call(this,i,new xl({color:e,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function af(t,e,n){this.plane=t,this.size=void 0===e?1:e;var i=void 0!==n?n:16776960,r=new Gr;r.setAttribute("position",new Rr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),Cl.call(this,r,new xl({color:i,toneMapped:!1})),this.type="PlaneHelper";var a=new Gr;a.setAttribute("position",new Rr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new la(a,new Sr({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}nf.prototype=Object.create(Pl.prototype),nf.prototype.constructor=nf,nf.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ef.setFromObject(this.object),!ef.isEmpty()){var e=ef.min,n=ef.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},nf.prototype.setFromObject=function(t){return this.object=t,this.update(),this},nf.prototype.copy=function(t){return Pl.prototype.copy.call(this,t),this.object=t.object,this},nf.prototype.clone=function(){return(new this.constructor).copy(this)},rf.prototype=Object.create(Pl.prototype),rf.prototype.constructor=rf,rf.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Mi.prototype.updateMatrixWorld.call(this,t))},af.prototype=Object.create(Cl.prototype),af.prototype.constructor=af,af.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?v:g,this.lookAt(this.plane.normal),Mi.prototype.updateMatrixWorld.call(this,t)};var of,sf,lf=new Kn;function uf(t,e,n,i,r,a){Mi.call(this),this.type="ArrowHelper",void 0===t&&(t=new Kn(0,0,1)),void 0===e&&(e=new Kn(0,0,0)),void 0===n&&(n=1),void 0===i&&(i=16776960),void 0===r&&(r=.2*n),void 0===a&&(a=.2*r),void 0===of&&((of=new Gr).setAttribute("position",new Rr([0,0,0,0,1,0],3)),(sf=new Ju(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Cl(of,new xl({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new la(sf,new Sr({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,a)}function cf(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Gr;n.setAttribute("position",new Rr(e,3)),n.setAttribute("color",new Rr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,n,i),this.type="AxesHelper"}uf.prototype=Object.create(Mi.prototype),uf.prototype.constructor=uf,uf.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{lf.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(lf,e)}},uf.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},uf.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},uf.prototype.copy=function(t){return Mi.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},uf.prototype.clone=function(){return(new this.constructor).copy(this)},cf.prototype=Object.create(Pl.prototype),cf.prototype.constructor=cf;var hf=Math.pow(2,8),df=[.125,.215,.35,.446,.526,.582],ff=5+df.length,pf={[Ke]:0,[tn]:1,[nn]:2,[an]:3,[on]:4,[sn]:5,[en]:6},mf=new yh,{_lodPlanes:gf,_sizeLods:vf,_sigmas:yf}=function(){for(var t=[],e=[],n=[],i=8,r=0;r<ff;r++){var a=Math.pow(2,i);e.push(a);var o=1/a;r>4?o=df[r-8+4-1]:0==r&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=new Float32Array(108),d=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,g=p>2?0:-1,v=[m,g,0,m+2/3,g,0,m+2/3,g+1,0,m,g,0,m+2/3,g+1,0,m,g+1,0];h.set(v,18*p),d.set(c,12*p);var y=[p,p,p,p,p,p];f.set(y,6*p)}var b=new Gr;b.setAttribute("position",new Mr(h,3)),b.setAttribute("uv",new Mr(d,2)),b.setAttribute("faceIndex",new Mr(f,1)),t.push(b),i>4&&i--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),bf=null,xf=(1+Math.sqrt(5))/2,_f=1/xf,wf=[new Kn(1,1,1),new Kn(-1,1,1),new Kn(1,1,-1),new Kn(-1,1,-1),new Kn(0,xf,_f),new Kn(0,xf,-_f),new Kn(_f,0,xf),new Kn(-_f,0,xf),new Kn(xf,_f,0),new Kn(-xf,_f,0)];function Sf(t){var e,n,i,r;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(e=20,n=new Float32Array(e),i=new Kn(0,1,0),(r=new ac({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${Af()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",r),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function Ef(t){return void 0!==t&&t.type===Tt&&(t.encoding===Ke||t.encoding===tn||t.encoding===en)}function Mf(t){var e=new Qn(3*hf,3*hf,t);return e.texture.mapping=dt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Cf(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function Tf(){var t=new ac({uniforms:{envMap:{value:null},texelSize:{value:new Un(1,1)},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${Af()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function kf(){var t=new ac({uniforms:{envMap:{value:null},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${Af()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function Pf(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function Af(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function Of(t,e,n,i,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new xr(t,e,n,r,a,o)}Sf.prototype={constructor:Sf,fromScene:function(t,e=0,n=.1,i=100){bf=this._renderer.getRenderTarget();var r=this._allocateTargets();return this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r},fromEquirectangular:function(t){return t.magFilter=vt,t.minFilter=vt,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){bf=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=kf(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Tf(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<gf.length;t++)gf[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(bf),t.scissorTest=!1,t.setSize(t.width,t.height)},_allocateTargets:function(t){var e={magFilter:vt,minFilter:vt,generateMipmaps:!1,type:Tt,format:Gt,encoding:Ef(t)?t.encoding:nn,depthBuffer:!1,stencilBuffer:!1},n=Mf(e);return n.depthBuffer=!t,this._pingPongRenderTarget=Mf(e),n},_compileMaterial:function(t){var e=new Ci;e.add(new la(gf[0],t)),this._renderer.compile(e,mf)},_sceneToCubeUV:function(t,e,n,i){var r=new Sa(90,1,e,n),a=[1,1,1,1,-1,1],o=[1,1,-1,-1,-1,1],s=this._renderer,l=s.outputEncoding,u=s.toneMapping,c=s.toneMappingExposure,h=s.getClearColor(),d=s.getClearAlpha();s.toneMapping=et,s.toneMappingExposure=1,s.outputEncoding=Ke,t.scale.z*=-1;var f=t.background;if(f&&f.isColor){f.convertSRGBToLinear();var p=Math.max(f.r,f.g,f.b),m=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);f=f.multiplyScalar(Math.pow(2,-m));var g=(m+128)/255;s.setClearColor(f,g),t.background=null}for(var v=0;v<6;v++){var y=v%3;0==y?(r.up.set(0,a[v],0),r.lookAt(o[v],0,0)):1==y?(r.up.set(0,0,a[v]),r.lookAt(0,o[v],0)):(r.up.set(0,a[v],0),r.lookAt(0,0,o[v])),Cf(i,y*hf,v>2?hf:0,hf,hf),s.setRenderTarget(i),s.render(t,r)}s.toneMapping=u,s.toneMappingExposure=c,s.outputEncoding=l,s.setClearColor(h,d),t.scale.z*=-1},_textureToCubeUV:function(t,e){var n=new Ci,i=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=kf()):null==this._equirectShader&&(this._equirectShader=Tf());var r=t.isCubeTexture?this._cubemapShader:this._equirectShader;n.add(new la(gf[0],r));var a=r.uniforms;a.envMap.value=t,t.isCubeTexture||a.texelSize.value.set(1/t.image.width,1/t.image.height),a.inputEncoding.value=pf[t.encoding],a.outputEncoding.value=pf[e.texture.encoding],Cf(e,0,0,3*hf,2*hf),i.setRenderTarget(e),i.render(n,mf)},_applyPMREM:function(t){var e=this._renderer,n=e.autoClear;e.autoClear=!1;for(var i=1;i<ff;i++){var r=Math.sqrt(yf[i]*yf[i]-yf[i-1]*yf[i-1]),a=wf[(i-1)%wf.length];this._blur(t,i-1,i,r,a)}e.autoClear=n},_blur:function(t,e,n,i,r){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,i,"latitudinal",r),this._halfBlur(a,t,n,n,i,"longitudinal",r)},_halfBlur:function(t,e,n,i,r,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Ci;u.add(new la(gf[i],l));var c=l.uniforms,h=vf[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,f=r/d,p=isFinite(r)?1+Math.floor(3*f):20;p>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);for(var m=[],g=0,v=0;v<20;++v){var y=v/f,b=Math.exp(-y*y/2);m.push(b),0==v?g+=b:v<p&&(g+=2*b)}for(v=0;v<m.length;v++)m[v]=m[v]/g;c.envMap.value=t.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=pf[t.texture.encoding],c.outputEncoding.value=pf[t.texture.encoding];var x=vf[i];Cf(e,y=3*Math.max(0,hf-2*x),(0===i?0:2*hf)+2*x*(i>4?i-8+4:0),3*x,2*x),s.setRenderTarget(e),s.render(u,mf)}};var Lf=0,Rf=1,If=0,Nf=1,Df=2;function zf(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Bf(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Ff(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Dl(t,e)}function Vf(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new tl(t)}function jf(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Dl(t,e)}function Uf(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function Hf(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function Gf(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function Wf(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Kn(t,e,n)}function qf(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Mr(t,e).setUsage(Pn)}function $f(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Cr(t,e)}function Qf(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Tr(t,e)}function Yf(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new kr(t,e)}function Xf(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Pr(t,e)}function Zf(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ar(t,e)}function Jf(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Or(t,e)}function Kf(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Lr(t,e)}function tp(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Rr(t,e)}function ep(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ir(t,e)}function np(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom",this.closed=!0}function ip(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom"}function rp(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom"}function ap(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new cf(t)}function op(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new nf(t,e)}function sp(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Pl(new Xu(t.geometry),new xl({color:void 0!==e?e:16777215}))}function lp(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Pl(new Ul(t.geometry),new xl({color:void 0!==e?e:16777215}))}function up(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Nc(t)}function cp(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Bc(t)}function hp(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ma(t,n)}Uc.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Uc.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(lh.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ma,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new Kn(r.x,r.y,r.z||0))}return e}}),Object.assign(uh.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),np.prototype=Object.create(Xc.prototype),ip.prototype=Object.create(Xc.prototype),rp.prototype=Object.create(Xc.prototype),Object.assign(rp.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Wd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Fd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Rc.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ch.extractUrlBase(t)}}),Rc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Oh.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Pd.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Vi.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Hi.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Pa.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Ld.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(jn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),jn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),jn.ceilPowerOfTwo(t)}}),Object.assign(Hn.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(si.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Kn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,a)}}),er.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Xn.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Zi.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(dr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(dr,{barycoordFromPoint:function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),dr.getBarycoord(t,e,n,i,r)},normal:function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),dr.getNormal(t,e,n,i)}}),Object.assign(ch.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Nu(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new $u(this,t)}}),Object.assign(Un.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Kn.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign($n.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ma.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Mi.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Mi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(la.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(la.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xe},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ul.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(fl.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),cl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Uc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Sa.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(hh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Mr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Pn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Pn)}}}),Object.assign(Mr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Pn:kn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Gr.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Mr(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Gr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Sd.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(zs.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Pn},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(zs.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Pn:kn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Du.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(_d.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(wr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new gr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===b}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(lc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(_a.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Is.prototype,{clearTarget:function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Is.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?tn:Ke}}}),Object.defineProperties(Cs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Qn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(td.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Uh).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),od.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ea.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var dp={merge:function(t,e,n){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function fp(){console.error("THREE.CanvasRenderer has been removed")}function pp(){console.error("THREE.JSONLoader has been removed.")}Gn.crossOrigin=void 0,Gn.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new jc;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,n,void 0,i);return e&&(a.mapping=e),a},Gn.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Vc;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,n,void 0,i);return e&&(a.mapping=e),a},Gn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var mp={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function gp(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}}))},function(t,e,n){var i,r,a;(function(o,s){var l=(o=o||n(357)).window,u=o.document,c=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],n=e.slice,i=Object.create,r=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=e.forEach||function(t,e){for(var n=0,i=this.length;n<i;n++)t.call(e,this[n],n,this)},l=function(t,e){for(var n in this)this.hasOwnProperty(n)&&t.call(e,this[n],n,this)},u=Object.assign||function(t){for(var e=1,n=arguments.length;e<n;e++){var i=arguments[e];for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t},c=function(t,e,n){if(t){var i=r(t,"length");(i&&"number"==typeof i.value?o:l).call(t,e,n=n||t)}return n};function h(e,n,i,o,s){var l={};function u(t,u){"string"==typeof(u=u||(u=r(n,t))&&(u.get?u:u.value))&&"#"===u[0]&&(u=e[u.substring(1)]||u);var c,h="function"==typeof u,f=u,p=s||h&&!u.base?u&&u.get?t in e:e[t]:null;s&&p||(h&&p&&(u.base=p),h&&!1!==o&&(c=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(l[c[3].toLowerCase()+c[4]]=c[2]),f&&!h&&f.get&&"function"==typeof f.get&&d.isPlainObject(f)||(f={value:f,writable:!0}),(r(e,t)||{configurable:!0}).configurable&&(f.configurable=!0,f.enumerable=null!=i?i:!c),a(e,t,f))}if(n){for(var c in n)n.hasOwnProperty(c)&&!t.test(c)&&u(c);for(var c in l){var h=l[c],f=e["set"+h],p=e["get"+h]||f&&e["is"+h];!p||!0!==o&&0!==p.length||u(c,{get:p,set:f})}}return e}function d(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&u(this,n)}return this}return h(d,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,n=t.beans,i=t.preserve;e!==t&&h(this.prototype,t,t.enumerable,n,i),h(this,e,null,n,i)}for(var r=1,a=arguments.length;r<a;r++)this.inject(arguments[r]);return this},extend:function(){for(var t,e,n,r=this,o=0,s=arguments.length;o<s&&(!t||!e);o++)n=arguments[o],t=t||n.initialize,e=e||n.prototype;return e=(t=t||function(){r.apply(this,arguments)}).prototype=e||i(this.prototype),a(e,"constructor",{value:t,writable:!0,configurable:!0}),h(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=r,t}}).inject({enumerable:!1,initialize:d,set:d,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&h(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var t=i(this);return t.inject.apply(t,arguments)},each:function(t,e){return c(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:u,each:c,create:i,define:a,describe:r,clone:function(t){return u(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===d||"Object"===e.name)},pick:function(t,e){return t!==s?t:e},slice:function(t,e,i){return n.call(t,e,i)}}})};t.exports=c,c.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+c.each(this,(function(t,e){if(!/^_/.test(e)){var n=typeof t;this.push(e+": "+("number"===n?m.instance.number(t):"string"===n?"'"+t+"'":t))}}),[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return c.importJSON(t,this)},exportJSON:function(t){return c.exportJSON(this,t)},toJSON:function(){return c.serialize(this)},set:function(t,e){return t&&c.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),n=e.prototype._class;return n&&!c.exports[n]&&(c.exports[n]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){if((n=t.length)!==e.length)return!1;for(;n--;)if(!c.equals(t[n],e[n]))return!1}else{var n,i=Object.keys(t);if((n=i.length)!==Object.keys(e).length)return!1;for(;n--;){var r=i[n];if(!e.hasOwnProperty(r)||!c.equals(t[r],e[r]))return!1}}return!0}return!1},read:function(t,e,n,i){if(this===c){var r=this.peek(t,e);return t.__index++,r}var a=this.prototype,o=a._readIndex,l=e||o&&t.__index||0,u=t.length,h=t[l];if(i=i||u-l,h instanceof this||n&&n.readNull&&null==h&&i<=1)return o&&(t.__index=l+1),h&&n&&n.clone?h.clone():h;if(h=c.create(a),o&&(h.__read=!0),h=h.initialize.apply(h,l>0||l+i<u?c.slice(t,l,l+i):t)||h,o){t.__index=l+h.__read;var d=h.__filtered;d&&(t.__filtered=d,h.__filtered=s),h.__read=s}return h},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,n,i){for(var r,a=[],o=e||0,s=i?o+i:t.length,l=o;l<s;l++)a.push(Array.isArray(r=t[l])?this.read(r,0,n):this.read(t,l,n,1));return a},readNamed:function(t,e,n,i,r){var a=this.getNamed(t,e),o=a!==s;if(o){var l=t.__filtered;if(!l){var u=this.getSource(t);(l=t.__filtered=c.create(u)).__unfiltered=u}l[e]=s}return this.read(o?[a]:t,n,i,r)},readSupported:function(t,e){var n=this.getSource(t),i=this,r=!1;return n&&Object.keys(n).forEach((function(n){if(n in e){var a=i.readNamed(t,n);a!==s&&(e[n]=a),r=!0}})),r},getSource:function(t){var e=t.__source;if(e===s){var n=1===t.length&&t[0];e=t.__source=n&&c.isPlainObject(n)?n:null}return e},getNamed:function(t,e){var n=this.getSource(t);if(n)return e?n[e]:t.__filtered||n},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,n,i){var r;function a(i){if(!(n&&i in n||r&&i in r)){var a=e[i];a!==s&&(t[i]=a)}}if(i){for(var o,l={},u=0,c=i.length;u<c;u++)(o=i[u])in e&&(a(o),l[o]=!0);r=l}return Object.keys(e.__unfiltered||e).forEach(a),t},isPlainValue:function(t,e){return c.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,n,i){e=e||{};var r,a=!i;if(a&&(e.formatter=new m(e.precision),i={length:0,definitions:{},references:{},add:function(t,e){var n="#"+t._id,i=this.references[n];if(!i){this.length++;var r=e.call(t),a=t._class;a&&r[0]!==a&&r.unshift(a),this.definitions[n]=r,i=this.references[n]=[n]}return i}}),t&&t._serialize){r=t._serialize(e,i);var o=t._class;!o||t._compactSerialize||!a&&n||r[0]===o||r.unshift(o)}else if(Array.isArray(t)){r=[];for(var s=0,l=t.length;s<l;s++)r[s]=c.serialize(t[s],e,n,i)}else if(c.isPlainObject(t)){r={};var u=Object.keys(t);for(s=0,l=u.length;s<l;s++){var h=u[s];r[h]=c.serialize(t[h],e,n,i)}}else r="number"==typeof t?e.formatter.number(t,e.precision):t;return a&&i.length>0?[["dictionary",i.definitions],r]:r},deserialize:function(t,e,n,i,r){var a=t,o=!n,s=o&&t&&t.length&&"dictionary"===t[0][0];if(n=n||{},Array.isArray(t)){var l=t[0],u="dictionary"===l;if(1==t.length&&/^#/.test(l))return n.dictionary[l];a=[];for(var h=(l=c.exports[l])?1:0,d=t.length;h<d;h++)a.push(c.deserialize(t[h],e,n,u,s));if(l){var f=a;a=e?e(l,f,o||r):new l(f)}}else if(c.isPlainObject(t))for(var p in a={},i&&(n.dictionary=a),t)a[p]=c.deserialize(t[p],e,n);return s?a[1]:a},exportJSON:function(t,e){var n=c.serialize(t,e);return e&&0==e.asString?n:JSON.stringify(n)},importJSON:function(t,e){return c.deserialize("string"==typeof t?JSON.parse(t):t,(function(t,n,i){var r=i&&e&&e.constructor===t,a=r?e:c.create(t.prototype);if(1===n.length&&a instanceof T&&(r||!(a instanceof P))){var o=n[0];c.isPlainObject(o)&&(o.insert=!1,r&&(n=n.concat([{insert:!0}])))}return(r?a.set:t).apply(a,n),r&&(e=null),a}))},push:function(t,e){var n=e.length;if(n<4096)t.push.apply(t,e);else{var i=t.length;t.length+=n;for(var r=0;r<n;r++)t[i+r]=e[r]}return t},splice:function(t,e,n,i){var r=e&&e.length,a=n===s;(n=a?t.length:n)>t.length&&(n=t.length);for(var o=0;o<r;o++)e[o]._index=n+o;if(a)return c.push(t,e),[];var l=[n,i];e&&c.push(l,e);for(var u=t.splice.apply(t,l),h=(o=0,u.length);o<h;o++)u[o]._index=s;for(o=n+r,h=t.length;o<h;o++)t[o]._index=o;return u},capitalize:function(t){return t.replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}))},camelize:function(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var h={on:function(t,e){if("string"!=typeof t)c.each(t,(function(t,e){this.on(e,t)}),this);else{var n=this._eventTypes,i=n&&n[t],r=this._callbacks=this._callbacks||{};-1===(r=r[t]=r[t]||[]).indexOf(e)&&(r.push(e),i&&i.install&&1===r.length&&i.install.call(this,t))}return this},off:function(t,e){if("string"==typeof t){var n,i=this._eventTypes,r=i&&i[t],a=this._callbacks&&this._callbacks[t];return a&&(!e||-1!==(n=a.indexOf(e))&&1===a.length?(r&&r.uninstall&&r.uninstall.call(this,t),delete this._callbacks[t]):-1!==n&&a.splice(n,1)),this}c.each(t,(function(t,e){this.off(e,t)}),this)},once:function(t,e){return this.on(t,(function n(){e.apply(this,arguments),this.off(t,n)}))},emit:function(t,e){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;var i=c.slice(arguments,1),r=e&&e.target&&!e.currentTarget;n=n.slice(),r&&(e.currentTarget=this);for(var a=0,o=n.length;a<o;a++)if(0==n[a].apply(this,i)){e&&e.stop&&e.stop();break}return r&&delete e.currentTarget,!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,n=this._callbacks,i=t?"install":"uninstall";if(e)for(var r in n)if(n[r].length>0){var a=e[r],o=a&&a[i];o&&o.call(this,r)}},statics:{inject:function t(e){var n=e._events;if(n){var i={};c.each(n,(function(t,n){var r="string"==typeof t,a=r?t:n,o=c.capitalize(a),s=a.substring(2).toLowerCase();i[s]=r?{}:t,a="_"+a,e["get"+o]=function(){return this[a]},e["set"+o]=function(t){var e=this[a];e&&this.off(s,e),t&&this.on(s,t),this[a]=t}})),e._eventTypes=i}return t.base.apply(this,arguments)}}},d=c.extend({_class:"PaperScope",initialize:function t(){dt=this,this.settings=new c({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var e=t.prototype;if(!this.support){var n=lt.getContext(1,1)||{};e.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:ut.nativeModes},lt.release(n)}if(!this.agent){var i=o.navigator.userAgent.toLowerCase(),r=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(i)||[])[0],a="darwin"===r?"mac":r,s=e.agent=e.browser={platform:a};a&&(s[a]=!0),i.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,(function(t,e,n,i,r){if(!s.chrome){var a="opera"===e?i:/^(node|trident)$/.test(e)?r:n;s.version=a,s.versionNumber=parseFloat(a),e={trident:"msie",jsdom:"node"}[e]||e,s.name=e,s[e]=!0}})),s.chrome&&delete s.webkit,s.atom&&delete s.chrome}},version:"0.12.11",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var n=dt.PaperScript.execute(t,this,e);return J.updateFocus(),n},install:function(t){var e=this;for(var n in c.each(["project","view","tool"],(function(n){c.define(t,n,{configurable:!0,get:function(){return e[n]}})})),this)!/^_/.test(n)&&this[n]&&(t[n]=this[n])},setup:function(t){return dt=this,this.project=new C(t),this},createCanvas:function(t,e){return lt.getCanvas(t,e)},activate:function(){dt=this},clear:function(){for(var t=this.projects,e=this.tools,n=t.length-1;n>=0;n--)t[n].remove();for(n=e.length-1;n>=0;n--)e[n].remove()},remove:function(){this.clear(),delete d._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,n){return e[t](n)||e[t]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),f=c.extend(h,{initialize:function(t){this._scope=dt,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(c.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),p={findItemBoundsCollisions:function(t,e,n){function i(t){for(var e=new Array(t.length),n=0;n<t.length;n++){var i=t[n].getBounds();e[n]=[i.left,i.top,i.right,i.bottom]}return e}var r=i(t),a=e&&e!==t?i(e):r;return this.findBoundsCollisions(r,a,n||0)},findCurveBoundsCollisions:function(t,e,n,i){function r(t){for(var e=Math.min,n=Math.max,i=new Array(t.length),r=0;r<t.length;r++){var a=t[r];i[r]=[e(a[0],a[2],a[4],a[6]),e(a[1],a[3],a[5],a[7]),n(a[0],a[2],a[4],a[6]),n(a[1],a[3],a[5],a[7])]}return i}var a=r(t),o=e&&e!==t?r(e):a;if(i){for(var s=this.findBoundsCollisions(a,o,n||0,!1,!0),l=this.findBoundsCollisions(a,o,n||0,!0,!0),u=[],c=0,h=s.length;c<h;c++)u[c]={hor:s[c],ver:l[c]};return u}return this.findBoundsCollisions(a,o,n||0)},findBoundsCollisions:function(t,e,n,i,r){var a=!e||t===e,o=a?t:t.concat(e),s=t.length,l=o.length;function u(t,e,n){for(var i=0,r=t.length;i<r;){var a=r+i>>>1;o[t[a]][e]<n?i=a+1:r=a}return i-1}for(var c=i?1:0,h=c+2,d=i?0:1,f=d+2,p=new Array(l),m=0;m<l;m++)p[m]=m;p.sort((function(t,e){return o[t][c]-o[e][c]}));var g=[],v=new Array(s);for(m=0;m<l;m++){var y=p[m],b=o[y],x=a?y:y-s,_=y<s,w=a||!_,S=_?[]:null;if(g.length){var E=u(g,h,b[c]-n)+1;if(g.splice(0,E),a&&r){S=S.concat(g);for(var M=0;M<g.length;M++){v[k=g[M]].push(x)}}else{var C=b[f],T=b[d];for(M=0;M<g.length;M++){var k=g[M],P=o[k],A=k<s,O=a||k>=s;(r||(_&&O||w&&A)&&C>=P[d]-n&&T<=P[f]+n)&&(_&&O&&S.push(a?k:k-s),w&&A&&v[k].push(x))}}}if(_&&(t===e&&S.push(y),v[y]=S),g.length){var L=u(g,h,b[h]);g.splice(L+1,0,y)}else g.push(y)}for(m=0;m<v.length;m++){var R=v[m];R&&R.sort((function(t,e){return t-e}))}return v}},m=c.extend({initialize:function(t){this.precision=c.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,n){return this.number(t)+(n||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});m.instance=new m;var g=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,i=Math.sqrt,r=Math.pow,a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function o(t,e,n){return t<e?e:t>n?n:t}function s(t,e,i){function r(t){var e=134217729*t,n=t-e+e;return[n,t-n]}var a=e*e-t*i,o=e*e+t*i;if(3*n(a)<o){var s=r(t),l=r(e),u=r(i),c=e*e,h=t*i;a=c-h+(l[0]*l[0]-c+2*l[0]*l[1]+l[1]*l[1]-(s[0]*u[0]-h+s[0]*u[1]+s[1]*u[0]+s[1]*u[1]))}return a}function l(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?r(2,-Math.round(a(t))):0}return{EPSILON:1e-12,MACHINE_EPSILON:112e-18,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(i(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=1e-12},isMachineZero:function(t){return t>=-112e-18&&t<=112e-18},clamp:o,integrate:function(n,i,r,a){for(var o=t[a-2],s=e[a-2],l=.5*(r-i),u=l+i,c=0,h=a+1>>1,d=1&a?s[c++]*n(u):0;c<h;){var f=l*o[c];d+=s[c++]*(n(u+f)+n(u-f))}return l*d},findRoot:function(t,e,i,r,a,s,l){for(var u=0;u<s;u++){var c=t(i),h=c/e(i),d=i-h;if(n(h)<l){i=d;break}c>0?(a=i,i=d<=r?.5*(r+a):d):(r=i,i=d>=a?.5*(r+a):d)}return o(i,r,a)},solveQuadratic:function(t,e,r,a,u,c){var h,d=1/0;if(n(t)<1e-12){if(n(e)<1e-12)return n(r)<1e-12?-1:0;h=-r/e}else{var f=s(t,e*=-.5,r);if(f&&n(f)<112e-18){var p=l(n(t),n(e),n(r));p&&(f=s(t*=p,e*=p,r*=p))}if(f>=-112e-18){var m=f<0?0:i(f),g=e+(e<0?-m:m);0===g?d=-(h=r/t):(h=g/t,d=r/g)}}var v=0,y=null==u,b=u-1e-12,x=c+1e-12;return isFinite(h)&&(y||h>b&&h<x)&&(a[v++]=y?h:o(h,u,c)),d!==h&&isFinite(d)&&(y||d>b&&d<x)&&(a[v++]=y?d:o(d,u,c)),v},solveCubic:function(t,e,a,s,u,c,h){var d,f,p,m,v,y=l(n(t),n(e),n(a),n(s));function b(n){var i=t*(d=n);m=(i+(f=i+e))*d+(p=f*d+a),v=p*d+s}if(y&&(t*=y,e*=y,a*=y,s*=y),n(t)<1e-12)t=e,f=a,p=s,d=1/0;else if(n(s)<1e-12)f=e,p=a,d=0;else{b(-e/t/3);var x=v/t,_=r(n(x),1/3),w=x<0?-1:1,S=-m/t,E=S>0?1.324717957244746*Math.max(_,i(S)):_,M=d-w*E;if(M!==d){do{b(M),M=0===m?d:d-v/m/(1+112e-18)}while(w*M>w*d);n(t)*d*d>n(s/d)&&(f=((p=-s/d)-a)/d)}}var C=g.solveQuadratic(t,f,p,u,c,h),T=null==c;return isFinite(d)&&(0===C||C>0&&d!==u[0]&&d!==u[1])&&(T||d>c-1e-12&&d<h+1e-12)&&(u[C++]=T?d:o(d,c,h)),C}}},v={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}return this._id++}},y=c.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var n=typeof t,i=this.__read,r=0;if("number"===n){var a="number"==typeof e;this._set(t,a?e:t),i&&(r=a?2:1)}else if("undefined"===n||null===t)this._set(0,0),i&&(r=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"x"in o?this._set(o.x||0,o.y||0):"width"in o?this._set(o.width||0,o.height||0):"angle"in o?(this._set(o.length||0,0),this.setAngle(o.angle||0)):(this._set(0,0),r=0)}return i&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new y(this.x,this.y)},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var n=t/this.getLength();g.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=y.read(arguments),e=this.getLength()*t.getLength();if(g.isZero(e))return NaN;var n=this.dot(t)/e;return Math.acos(n<-1?-1:n>1?1:n)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=y.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=y.read(t),n=e.x-this.x,i=e.y-this.y,r=n*n+i*i,a=c.read(t);return a?r:Math.sqrt(r)},normalize:function(t){t===s&&(t=1);var e=this.getLength(),n=0!==e?t/e:0,i=new y(this.x*n,this.y*n);return n>=0&&(i._angle=this._angle),i},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var n=e?this.subtract(e):this,i=Math.sin(t),r=Math.cos(t);return n=new y(n.x*r-n.y*i,n.x*i+n.y*r),e?n.add(e):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=y.read(arguments);return new y(this.x+t.x,this.y+t.y)},subtract:function(){var t=y.read(arguments);return new y(this.x-t.x,this.y-t.y)},multiply:function(){var t=y.read(arguments);return new y(this.x*t.x,this.y*t.y)},divide:function(){var t=y.read(arguments);return new y(this.x/t.x,this.y/t.y)},modulo:function(){var t=y.read(arguments);return new y(this.x%t.x,this.y%t.y)},negate:function(){return new y(-this.x,-this.y)},isInside:function(){return w.read(arguments).contains(this)},isClose:function(){var t=arguments,e=y.read(t),n=c.read(t);return this.getDistance(e)<=n},isCollinear:function(){var t=y.read(arguments);return y.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=y.read(arguments);return y.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=g.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=y.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=y.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=y.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new y(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=y.read(t),n=y.read(t);return new y(Math.min(e.x,n.x),Math.min(e.y,n.y))},max:function(){var t=arguments,e=y.read(t),n=y.read(t);return new y(Math.max(e.x,n.x),Math.max(e.y,n.y))},random:function(){return new y(Math.random(),Math.random())},isCollinear:function(t,e,n,i){return Math.abs(t*i-e*n)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+i*i))},isOrthogonal:function(t,e,n,i){return Math.abs(t*n+e*i)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+i*i))}}},c.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new y(e(this.x),e(this.y))}}),{})),b=y.extend({initialize:function(t,e,n,i){this._x=t,this._y=e,this._owner=n,this._setter=i},_set:function(t,e,n){return this._x=t,this._y=e,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),x=c.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var n=typeof t,i=this.__read,r=0;if("number"===n){var a="number"==typeof e;this._set(t,a?e:t),i&&(r=a?2:1)}else if("undefined"===n||null===t)this._set(0,0),i&&(r=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"width"in o?this._set(o.width||0,o.height||0):"x"in o?this._set(o.x||0,o.y||0):(this._set(0,0),r=0)}return i&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new x(this.width,this.height)},toString:function(){var t=m.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=x.read(arguments);return new x(this.width+t.width,this.height+t.height)},subtract:function(){var t=x.read(arguments);return new x(this.width-t.width,this.height-t.height)},multiply:function(){var t=x.read(arguments);return new x(this.width*t.width,this.height*t.height)},divide:function(){var t=x.read(arguments);return new x(this.width/t.width,this.height/t.height)},modulo:function(){var t=x.read(arguments);return new x(this.width%t.width,this.height%t.height)},negate:function(){return new x(-this.width,-this.height)},isZero:function(){var t=g.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new x(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new x(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new x(Math.random(),Math.random())}}},c.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new x(e(this.width),e(this.height))}}),{})),_=x.extend({initialize:function(t,e,n,i){this._width=t,this._height=e,this._owner=n,this._setter=i},_set:function(t,e,n){return this._width=t,this._height=e,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),w=c.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,e,n,i){var r,a=arguments,o=typeof t;if("number"===o?(this._set(t,e,n,i),r=4):"undefined"===o||null===t?(this._set(0,0,0,0),r=null===t?1:0):1===a.length&&(Array.isArray(t)?(this._set.apply(this,t),r=1):t.x!==s||t.width!==s?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),r=1):t.from===s&&t.to===s&&(this._set(0,0,0,0),c.readSupported(a,this)&&(r=1))),r===s){var l,u,h=y.readNamed(a,"from"),d=c.peek(a),f=h.x,p=h.y;if(d&&d.x!==s||c.hasNamed(a,"to")){var m=y.readNamed(a,"to");l=m.x-f,u=m.y-p,l<0&&(f=m.x,l=-l),u<0&&(p=m.y,u=-u)}else{var g=x.read(a);l=g.width,u=g.height}this._set(f,p,l,u),r=a.__index}var v=a.__filtered;return v&&(this.__filtered=v),this.__read&&(this.__read=r),this},set:"#initialize",_set:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},clone:function(){return new w(this.x,this.y,this.width,this.height)},equals:function(t){var e=c.isPlainValue(t)?w.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?y:b)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=y.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?x:_)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=x.read(arguments),e=this._sx,n=this._sy,i=t.width,r=t.height;e&&(this.x+=(this.width-i)*e),n&&(this.y+=(this.height-r)*n),this.width=i,this.height=r,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=2*(t-this.x)*this._sx),this.width=2*(t-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=2*(t-this.y)*this._sy),this.height=2*(t-this.y)),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?y:b)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=y.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==s||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(w.read(arguments)):this._containsPoint(y.read(arguments))},_containsPoint:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=w.read(arguments),e=c.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=w.read(arguments),e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),i=Math.min(this.x+this.width,t.x+t.width),r=Math.min(this.y+this.height,t.y+t.height);return new w(e,n,i-e,r-n)},unite:function(){var t=w.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width),r=Math.max(this.y+this.height,t.y+t.height);return new w(e,n,i-e,r-n)},include:function(){var t=y.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x),r=Math.max(this.y+this.height,t.y);return new w(e,n,i-e,r-n)},expand:function(){var t=x.read(arguments),e=t.width,n=t.height;return new w(this.x-e/2,this.y-n/2,this.width+e,this.height+n)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===s?t:e)-this.height)}},c.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],(function(t,e){var n=t.join(""),i=/^[RL]/.test(n);e>=4&&(t[1]+=i?"Y":"X");var r=t[i?0:1],a=t[i?1:0],o="get"+r,s="get"+a,l="set"+r,u="set"+a,c="set"+n;this["get"+n]=function(t){return new(t?y:b)(this[o](),this[s](),this,c)},this[c]=function(){var t=y.read(arguments);this[l](t.x),this[u](t.y)}}),{beans:!0})),S=w.extend({initialize:function(t,e,n,i,r,a){this._set(t,e,n,i,!0),this._owner=r,this._setter=a},_set:function(t,e,n,i,r){return this._x=t,this._y=e,this._width=n,this._height=i,r||this._owner[this._setter](this),this}},new function(){var t=w.prototype;return c.each(["x","y","width","height"],(function(t){var e=c.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._dontNotify||this._owner[this._setter](this)}}),c.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],(function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}}),{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),E=c.extend({_class:"Matrix",initialize:function t(e,n){var i=arguments,r=i.length,a=!0;if(r>=6?this._set.apply(this,i):1===r||2===r?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,n):Array.isArray(e)?this._set.apply(this,n?e.concat([n]):e):a=!1:r?a=!1:this.reset(),!a)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,n,i,r,a,o){return this._a=t,this._b=e,this._c=n,this._d=i,this._tx=r,this._ty=a,o||this._changed(),this},_serialize:function(t,e){return c.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new E(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=m.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var n=this._owner;return!!n&&(n.transform(null,c.pick(t,!0),e),this.isIdentity())},translate:function(){var t=y.read(arguments),e=t.x,n=t.y;return this._tx+=e*this._a+n*this._c,this._ty+=e*this._b+n*this._d,this._changed(),this},scale:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0});return n&&this.translate(n),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=y.read(arguments,1),n=e.x,i=e.y,r=Math.cos(t),a=Math.sin(t),o=n-n*r+i*a,s=i-n*a-i*r,l=this._a,u=this._b,c=this._c,h=this._d;return this._a=r*l+a*c,this._b=r*u+a*h,this._c=-a*l+r*c,this._d=-a*u+r*h,this._tx+=o*l+s*c,this._ty+=o*u+s*h,this._changed(),this},shear:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0});n&&this.translate(n);var i=this._a,r=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*i,this._d+=e.x*r,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0}),i=Math.PI/180,r=new y(Math.tan(e.x*i),Math.tan(e.y*i));return this.shear(r,n)},append:function(t,e){if(t){var n=this._a,i=this._b,r=this._c,a=this._d,o=t._a,s=t._c,l=t._b,u=t._d,c=t._tx,h=t._ty;this._a=o*n+l*r,this._c=s*n+u*r,this._b=o*i+l*a,this._d=s*i+u*a,this._tx+=c*n+h*r,this._ty+=c*i+h*a,e||this._changed()}return this},prepend:function(t,e){if(t){var n=this._a,i=this._b,r=this._c,a=this._d,o=this._tx,s=this._ty,l=t._a,u=t._c,c=t._b,h=t._d,d=t._tx,f=t._ty;this._a=l*n+u*i,this._c=l*r+u*a,this._b=c*n+h*i,this._d=c*r+h*a,this._tx=l*o+u*s+d,this._ty=c*o+h*s+f,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,n=this._c,i=this._d,r=this._tx,a=this._ty,o=t*i-e*n,s=null;return o&&!isNaN(o)&&isFinite(r)&&isFinite(a)&&(this._a=i/o,this._b=-e/o,this._c=-n/o,this._d=t/o,this._tx=(n*a-i*r)/o,this._ty=(e*r-t*a)/o,s=this),s},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new E(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,n){return arguments.length<3?this._transformPoint(y.read(arguments)):this._transformCoordinates(t,e,n)},_transformPoint:function(t,e,n){var i=t.x,r=t.y;return e||(e=new y),e._set(i*this._a+r*this._c+this._tx,i*this._b+r*this._d+this._ty,n)},_transformCoordinates:function(t,e,n){for(var i=0,r=2*n;i<r;i+=2){var a=t[i],o=t[i+1];e[i]=a*this._a+o*this._c+this._tx,e[i+1]=a*this._b+o*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,n=t.y,i=e+t.width,r=n+t.height,a=[e,n,i,n,i,r,e,r];return this._transformCoordinates(a,a,4)},_transformBounds:function(t,e,n){for(var i=this._transformCorners(t),r=i.slice(0,2),a=r.slice(),o=2;o<8;o++){var s=i[o],l=1&o;s<r[l]?r[l]=s:s>a[l]&&(a[l]=s)}return e||(e=new w),e._set(r[0],r[1],a[0]-r[0],a[1]-r[1],n)},inverseTransform:function(){return this._inverseTransform(y.read(arguments))},_inverseTransform:function(t,e,n){var i=this._a,r=this._b,a=this._c,o=this._d,s=this._tx,l=this._ty,u=i*o-r*a,c=null;if(u&&!isNaN(u)&&isFinite(s)&&isFinite(l)){var h=t.x-this._tx,d=t.y-this._ty;e||(e=new y),c=e._set((h*o-d*a)/u,(d*i-h*r)/u,n)}return c},decompose:function(){var t,e,n,i=this._a,r=this._b,a=this._c,o=this._d,s=i*o-r*a,l=Math.sqrt,u=Math.atan2,c=180/Math.PI;if(0!==i||0!==r){var h=l(i*i+r*r);t=Math.acos(i/h)*(r>0?1:-1),e=[h,s/h],n=[u(i*a+r*o,h*h),0]}else if(0!==a||0!==o){var d=l(a*a+o*o);t=Math.asin(a/d)*(o>0?1:-1),e=[s/d,d],n=[0,u(i*a+r*o,d*d)]}else t=0,n=e=[0,0];return{translation:this.getTranslation(),rotation:t*c,scaling:new y(e),skewing:new y(n[0]*c,n[1]*c)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new y(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},c.each(["a","b","c","d","tx","ty"],(function(t){var e=c.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._changed()}}),{})),M=c.extend({_class:"Line",initialize:function(t,e,n,i,r){var a=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=n,this._vy=i,a=r):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,a=n),a||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new y(this._px,this._py)},getVector:function(){return new y(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return M.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return M.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return M.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return y.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return y.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,n,i,r,a,o,s,l,u){l||(n-=t,i-=e,o-=r,s-=a);var c=n*s-i*o;if(!g.isMachineZero(c)){var h=t-r,d=e-a,f=(o*d-s*h)/c,p=(n*d-i*h)/c;if(u||-1e-12<f&&f<1+1e-12&&-1e-12<p&&p<1+1e-12)return u||(f=f<=0?0:f>=1?1:f),new y(t+f*n,e+f*i)}},getSide:function(t,e,n,i,r,a,o,s){o||(n-=t,i-=e);var l=r-t,u=l*i-(a-e)*n;return!s&&g.isMachineZero(u)&&(u=(l*n+l*n)/(n*n+i*i))>=0&&u<=1&&(u=0),u<0?-1:u>0?1:0},getSignedDistance:function(t,e,n,i,r,a,o){return o||(n-=t,i-=e),0===n?i>0?r-t:t-r:0===i?n<0?a-e:e-a:((r-t)*i-(a-e)*n)/(i>n?i*Math.sqrt(1+n*n/(i*i)):n*Math.sqrt(1+i*i/(n*n)))},getDistance:function(t,e,n,i,r,a,o){return Math.abs(M.getSignedDistance(t,e,n,i,r,a,o))}}}),C=f.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){f.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Y(null,null,this),this._view=J.create(this,t||lt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return c.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var i=this._changes;if(i&&e){var r=this._changesById,a=e._id,o=r[a];o?o.flags|=t:i.push(r[a]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new P({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:L,match:function(n){var i=n._definition,r=i._id;return e[r]||(e[r]=!0,t.push(i)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var n in t){var i=t[n],r=i._selection;1&r&&i.isInserted()?e.push(i):r||this._updateSelection(i)}return e},_updateSelection:function(t){var e=t._id,n=this._selectionItems;t._selection?n[e]!==t&&(this._selectionCount++,n[e]=t):n[e]===t&&(this._selectionCount--,delete n[e])},selectAll:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(s,t)},insertLayer:function(t,e){if(e instanceof P){e._remove(!1,!0),c.splice(this._children,[e],t,0),e._setProject(this,!0);var n=e._name;n&&e.setName(n),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,n){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(s,new P(T.NO_INSERT),!0)).insertChild(t,e),n&&e.activate&&e.activate(),e},getItems:function(t){return T._getItems(this,t)},getItem:function(t){return T._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return c.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var n=e[t];if(n){for(var i in n){var r=n[i];for(var a in e){var o=e[a];o&&o!=n&&delete o[r._id]}r.remove()}e[t]=null}}},draw:function(t,e,n){this._updateVersion++,t.save(),e.applyToContext(t);for(var i=this._children,r=new c({offset:new y(0,0),pixelRatio:n,viewMatrix:e.isIdentity()?null:e,matrices:[new E],updateMatrix:!0}),a=0,o=i.length;a<o;a++)i[a].draw(t,r);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var s=this._selectionItems,l=this._scope.settings.handleSize,u=this._updateVersion;for(var h in s)s[h]._drawSelection(t,e,l,s,u);t.restore()}}}),T=c.extend(h,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=c.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new E,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return c.each(t,(function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}}),{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var n=t&&c.isPlainObject(t),i=n&&!0===t.internal,r=this._matrix=new E,a=n&&t.project||dt.project,o=dt.settings;return this._id=i?null:v.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&o.applyMatrix,e&&r.translate(e),r._owner=this,this._style=new Y(a._currentStyle,this,a),i||n&&0==t.insert||!o.insertItems&&(!n||!0!==t.insert)?this._setProject(a):(n&&t.parent||a)._insertItem(s,this,!0),n&&t!==T.NO_INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(t,e){var n={},i=this;function r(r){for(var a in r){var o=i[a];c.equals(o,"leading"===a?1.2*r.fontSize:r[a])||(n[a]=c.serialize(o,t,"data"!==a,e))}}return r(this._serializeFields),this instanceof k||r(this._style._defaults),[this._class,n]},_changed:function(t){var e=this._symbol,n=this._parent||e,i=this._project;8&t&&(this._bounds=this._position=this._decomposed=s),16&t&&(this._globalMatrix=s),n&&72&t&&T._clearBoundsCache(n),2&t&&T._clearBoundsCache(this),i&&i._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var n=e._children,i=e._namedChildren;(i[t]=i[t]||[]).push(this),t in n||(n[t]=this)}this._name=t||s,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},c.each(["locked","visible","blendMode","opacity","guide"],(function(t){var e=c.capitalize(t),n="_"+t,i={locked:256,visible:265};this["get"+e]=function(){return this[n]},this["set"+e]=function(e){e!=this[n]&&(this[n]=e,this._changed(i[t]||257))}}),{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,n=t.length;e<n;e++)if(t[e].isSelected())return!0;return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,n=0,i=e.length;n<i;n++)e[n].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var n=0,i=t.length;n<i;n++)if(!t[n].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var n=0,i=e.length;n<i;n++)e[n].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?y:b,n=this._position||(this._position=this._getPositionFromBounds());return new e(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(y.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new b(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=y.read(arguments,0,{clone:!0,readNull:!0}),this._position=s}},c.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},(function(t,e){this[e]=function(e){return this.getBounds(e,t)}}),{beans:!0,getBounds:function(t,e){var n=e||t instanceof E,i=c.set({},n?e:t,this._boundsOptions);i.stroke&&!this.getStrokeScaling()||(i.cacheItem=this);var r=this._getCachedBounds(n&&t,i).rect;return arguments.length?r:new S(r.x,r.y,r.width,r.height,this,"setBounds")},setBounds:function(){var t=w.read(arguments),e=this.getBounds(),n=this._matrix,i=new E,r=t.getCenter();i.translate(r),t.width==e.width&&t.height==e.height||(n.isInvertible()||(n.set(n._backup||(new E).translate(n.getTranslation())),e=this.getBounds()),i.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),r=e.getCenter(),i.translate(-r.x,-r.y),this.transform(i)},_getBounds:function(t,e){var n=this._children;return n&&n.length?(T._updateBoundsCache(this,e.cacheItem),T._getBounds(n,t,e)):new w},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,n){t=t&&t._orNullIfIdentity();var i=e.internal&&!n,r=e.cacheItem,a=i?null:this._matrix._orNullIfIdentity(),o=r&&(!t||t.equals(a))&&this._getBoundsCacheKey(e,i),s=this._bounds;if(T._updateBoundsCache(this._parent||this._symbol,r),o&&s&&o in s)return{rect:(d=s[o]).rect.clone(),nonscaling:d.nonscaling};var l=this._getBounds(t||a,e),u=l.rect||l,c=this._style,h=l.nonscaling||c.hasStroke()&&!c.getStrokeScaling();if(o){s||(this._bounds=s={});var d=s[o]={rect:u.clone(),nonscaling:h,internal:i}}return{rect:u,nonscaling:h}},_getStrokeMatrix:function(t,e){var n=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,i=n?n.getViewMatrix().invert():t;return i&&i._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var n=e._id,i=t._boundsCache=t._boundsCache||{ids:{},list:[]};i.ids[n]||(i.list.push(e),i.ids[n]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=s;for(var n=0,i=e.list,r=i.length;n<r;n++){var a=i[n];a!==t&&(a._bounds=a._position=s,a._boundsCache&&T._clearBoundsCache(a))}}},_getBounds:function(t,e,n){var i=1/0,r=-i,a=i,o=r,s=!1;n=n||{};for(var l=0,u=t.length;l<u;l++){var c=t[l];if(c._visible&&!c.isEmpty(!0)){var h=c._getCachedBounds(e&&e.appended(c._matrix),n,!0),d=h.rect;i=Math.min(d.x,i),a=Math.min(d.y,a),r=Math.max(d.x+d.width,r),o=Math.max(d.y+d.height,o),h.nonscaling&&(s=!0)}}return{rect:isFinite(i)?new w(i,a,r-i,o-a):new w,nonscaling:s}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var n=this._decomposed;this.rotate(t-e),n&&(n.rotation=t,this._decomposed=n)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new b(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=y.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var n=this.getRotation(),i=this._decomposed,r=new E,a=g.isZero;if(a(t.x)||a(t.y))r.translate(i.translation),n&&r.rotate(n),r.scale(e.x,e.y),this._matrix.set(r);else{var o=this.getPosition(!0);r.translate(o),n&&r.rotate(n),r.scale(e.x/t.x,e.y/t.y),n&&r.rotate(-n),r.translate(o.negate()),this.transform(r)}i&&(i.scaling=e,this._decomposed=i)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var n=this._parent,i=[];n;){if(!n._globalMatrix){e=null;for(var r=0,a=i.length;r<a;r++)i[r]._globalMatrix=null;break}i.push(n),n=n._parent}e||(e=this._globalMatrix=this._matrix.clone(),(n=this._parent)&&e.prepend(n.getGlobalMatrix(!0)));return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof P)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return c.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(T.NO_INSERT),n=this._children,i=c.pick(t?t.insert:s,t===s||!0===t),r=c.pick(t?t.deep:s,!0);n&&e.copyAttributes(this),n&&!r||e.copyContent(this),n||e.copyAttributes(this),i&&e.insertAbove(this);var a=this._name,o=this._parent;if(a&&o){n=o._children;for(var l=a,u=1;n[a];)a=l+" "+u++;a!==l&&e.setName(a)}return e},copyContent:function(t){for(var e=t._children,n=0,i=e&&e.length;n<i;n++)this.addChild(e[n].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,r=n.length;i<r;i++){var a=n[i];t.hasOwnProperty(a)&&(this[a]=t[a])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,s=t._name;this._data=o?c.clone(o):null,s&&this.setName(s)},rasterize:function(t,e){var n=this.getStrokeBounds(),i=(t||this.getView().getResolution())/72,r=n.getTopLeft().floor(),a=n.getBottomRight().ceil(),o=new x(a.subtract(r)),l=new O(T.NO_INSERT);if(!o.isZero()){var u=lt.getCanvas(o.multiply(i)),h=u.getContext("2d"),d=(new E).scale(i).translate(r.negate());h.save(),d.applyToContext(h),this.draw(h,new c({matrices:[d]})),h.restore(),l.setCanvas(u)}return l.transform((new E).translate(r.add(o.divide(2))).scale(1/i)),(e===s||e)&&l.insertAbove(this),l},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(y.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var n=e.length-1;n>=0;n--)if(e[n].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return w.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new V.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof T&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(y.read(t),I.getOptions(t))}function e(){var t=arguments,e=y.read(t),n=I.getOptions(t),i=[];return this._hitTest(e,new c({all:i},n)),i}function n(t,e,n,i){var r=this._children;if(r)for(var a=r.length-1;a>=0;a--){var o=r[a],s=o!==i&&o._hitTest(t,e,n);if(s&&!e.all)return s}return null}return C.inject({hitTest:t,hitTestAll:e,_hitTest:n}),{hitTest:t,hitTestAll:e,_hitTestChildren:n}},{_hitTest:function(t,e,n){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var i=this._matrix,r=n?n.appended(i):this.getGlobalMatrix().prepend(this.getView()._matrix),a=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new x(V._getStrokePadding(a,i._shiftless().invert()));if(!(t=i._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var s,l,u=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==c.hyphenate(this._class)||e.class&&!(this instanceof e.class)),h=e.match,d=this;function f(t){return t&&h&&!h(t)&&(t=null),t&&e.all&&e.all.push(t),t}function p(e,n){var i=n?s["get"+n]():d.getPosition();if(t.subtract(i).divide(o).length<=1)return new I(e,d,{name:n?c.hyphenate(n):e,point:i})}var m=e.position,g=e.center,v=e.bounds;if(u&&this._parent&&(m||g||v)){if((g||v)&&(s=this.getInternalBounds()),!(l=m&&p("position")||g&&p("center","Center"))&&v)for(var y=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],b=0;b<8&&!l;b++)l=p("bounds",y[b]);l=f(l)}return l||(l=this._hitTestChildren(t,e,r)||u&&f(this._hitTestSelf(t,e,r,this.getStrokeScaling()?null:r._shiftless().invert()))||null),l&&l.point&&(l.point=i.transform(l.point)),l},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new I("fill",this)},matches:function(t,e){var n=typeof t;if("object"===n){for(var i in t)if(t.hasOwnProperty(i)&&!this.matches(i,t[i]))return!1;return!0}if("function"===n)return t(this);if("match"===t)return e(this);var r=/^(empty|editable)$/.test(t)?this["is"+c.capitalize(t)]():"type"===t?c.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;r=this._class}if("function"==typeof e)return!!e(r);if(e){if(e.test)return e.test(r);if(c.isPlainObject(e))return function t(e,n){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],a=n[i];if(c.isPlainObject(r)&&c.isPlainObject(a)){if(!t(r,a))return!1}else if(!c.equals(r,a))return!1}return!0}(e,r)}return c.equals(r,e)},getItems:function(t){return T._getItems(this,t,this._matrix)},getItem:function(t){return T._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,n,i,r,a){if(!r){var o="object"==typeof n&&n,s=o&&o.overlapping,l=o&&o.inside,u=(y=s||l)&&w.read([y]);r={items:[],recursive:o&&!1!==o.recursive,inside:!!l,overlapping:!!s,rect:u,path:s&&new V.Rectangle({rectangle:u,insert:!1})},o&&(n=c.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var h=e._children,d=r.items;i=(u=r.rect)&&(i||new E);for(var f=0,p=h&&h.length;f<p;f++){var m=h[f],g=i&&i.appended(m._matrix),v=!0;if(u){var y=m.getBounds(g);if(!u.intersects(y))continue;u.contains(y)||r.overlapping&&(y.contains(u)||r.path.intersects(m,g))||(v=!1)}if(v&&m.matches(n)&&(d.push(m),a))break;if(!1!==r.recursive&&t(m,n,g,r,a),a&&d.length>0)break}return d}}},{importJSON:function(t){var e=c.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(s,t)},insertChild:function(t,e){var n=e?this.insertChildren(t,[e]):null;return n&&n[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var n=this._children;if(n&&e&&e.length>0){for(var i={},r=(e=c.slice(e)).length-1;r>=0;r--){var a=(u=e[r])&&u._id;!u||i[a]?e.splice(r,1):(u._remove(!1,!0),i[a]=!0)}c.splice(n,e,t,0);for(var o=this._project,s=o._changes,l=(r=0,e.length);r<l;r++){var u,h=(u=e[r])._name;u._parent=this,u._setProject(o,!0),h&&u.setName(h),s&&u._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var n=t&&t._getOwner(),i=t!==this&&n?this:null;return i&&(i._remove(!1,!0),n._insertItem(t._index+e,i)),i},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(s,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(s,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var n=e[0].reduce(t);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,n=t._namedChildren,i=this._name,r=n[i],a=r?r.indexOf(this):-1;-1!==a&&(e[i]==this&&delete e[i],r.splice(a,1),r.length?e[i]=r[0]:delete n[i])}},_remove:function(t,e){var n=this._getOwner(),i=this._project,r=this._index;return this._style&&this._style._dispose(),!!n&&(this._name&&this._removeNamed(),null!=r&&(i._activeLayer===this&&(i._activeLayer=this.getNextSibling()||this.getPreviousSibling()),c.splice(n._children,null,r,1)),this._installEvents(!1),t&&i._changes&&this._changed(5),e&&n._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=c.pick(e,this._children.length);for(var n=c.splice(this._children,null,t,e-t),i=n.length-1;i>=0;i--)n[i]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,n=e?e.length:0;if(t){for(var i=0;i<n;i++)if(!e[i].isEmpty(t))return!1;return!0}return!n},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var n=e(this),i=e(t),r=0,a=Math.min(n.length,i.length);r<a;r++)if(n[r]!=i[r])return n[r]._index<i[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},c.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,i=(e?c:y).read(n),r=y.read(n,0,{readNull:!0});return this.transform((new E)[t](i,r||this.getPosition(!0)))}}),{translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,n){var i=this._matrix,r=t&&!t.isIdentity(),a=n&&this._canApplyMatrix||this._applyMatrix&&(r||!i.isIdentity()||e&&this._children);if(!r&&!a)return this;if(r){!t.isInvertible()&&i.isInvertible()&&(i._backup=i.getValues()),i.prepend(t,!0);var o=this._style,s=o.getFillColor(!0),l=o.getStrokeColor(!0);s&&s.transform(t),l&&l.transform(t)}if(a&&(a=this._transformContent(i,e,n))){var u=this._pivot;u&&i._transformPoint(u,u,!0),i.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var c=this._bounds,h=this._position;(r||a)&&this._changed(25);var d=r&&c&&t.decompose();if(d&&d.skewing.isZero()&&d.rotation%90==0){for(var f in c){var p=c[f];if(p.nonscaling)delete c[f];else if(a||!p.internal){var m=p.rect;t._transformBounds(m,m)}}this._bounds=c;var g=c[this._getBoundsCacheKey(this._boundsOptions||{})];g&&(this._position=this._getPositionFromBounds(g.rect))}else r&&h&&this._pivot&&(this._position=t._transformPoint(h,h));return this},_transformContent:function(t,e,n){var i=this._children;if(i){for(var r=0,a=i.length;r<a;r++)i[r].transform(t,e,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(y.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(y.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(y.read(arguments))},localToParent:function(){return this._matrix._transformPoint(y.read(arguments))},fitBounds:function(t,e){t=w.read(arguments);var n=this.getBounds(),i=n.height/n.width,r=t.height/t.width,a=(e?i>r:i<r)?t.width/n.width:t.height/n.height,o=new w(new y,new x(n.width*a,n.height*a));o.setCenter(t.getCenter()),this.setBounds(o)}}),{_setStyles:function(t,e,n){var i=this._style,r=this._matrix;if(i.hasFill()&&(t.fillStyle=i.getFillColor().toCanvasStyle(t,r)),i.hasStroke()){t.strokeStyle=i.getStrokeColor().toCanvasStyle(t,r),t.lineWidth=i.getStrokeWidth();var a=i.getStrokeJoin(),o=i.getStrokeCap(),s=i.getMiterLimit();if(a&&(t.lineJoin=a),o&&(t.lineCap=o),s&&(t.miterLimit=s),dt.support.nativeDash){var l=i.getDashArray(),u=i.getDashOffset();l&&l.length&&("setLineDash"in t?(t.setLineDash(l),t.lineDashOffset=u):(t.mozDash=l,t.mozDashOffset=u))}}if(i.hasShadow()){var c=e.pixelRatio||1,h=n._shiftless().prepend((new E).scale(c,c)),d=h.transform(new y(i.getShadowBlur(),0)),f=h.transform(this.getShadowOffset());t.shadowColor=i.getShadowColor().toCanvasStyle(t),t.shadowBlur=d.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,n){this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var i=e.matrices,r=e.viewMatrix,a=this._matrix,o=i[i.length-1].appended(a);if(o.isInvertible()){r=r?r.appended(o):o,i.push(o),e.updateMatrix&&(this._globalMatrix=o);var s,l,u,c=this._blendMode,h=g.clamp(this._opacity,0,1),d="normal"===c,f=ut.nativeModes[c],p=d&&1===h||e.dontStart||e.clip||(f||d&&h<1)&&this._canComposite(),m=e.pixelRatio||1;if(!p){var v=this.getStrokeBounds(r);if(!v.width||!v.height)return void i.pop();u=e.offset,l=e.offset=v.getTopLeft().floor(),s=t,t=lt.getContext(v.getSize().ceil().add(1).multiply(m)),1!==m&&t.scale(m,m)}t.save();var y=n?n.appended(a):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,b=!p&&e.clipItem,x=!y||b;if(p?(t.globalAlpha=h,f&&(t.globalCompositeOperation=c)):x&&t.translate(-l.x,-l.y),x&&(p?a:r).applyToContext(t),b&&e.clipItem.draw(t,e.extend({clip:!0})),y){t.setTransform(m,0,0,m,0,0);var _=e.offset;_&&t.translate(-_.x,-_.y)}this._draw(t,e,r,y),t.restore(),i.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),p||(ut.process(c,t,s,h,l.subtract(u).multiply(m)),lt.release(t),e.offset=u)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof j)return e._isUpdated(t);var n=this._updateVersion===t;return!n&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,e,n,i,r){var a=this._selection,o=1&a,s=2&a||o&&this._selectBounds,l=4&a;if(this._drawSelected||(o=!1),(o||s||l)&&this._isUpdated(r)){var u,c=this.getSelectedColor(!0)||(u=this.getLayer())&&u.getSelectedColor(!0),h=e.appended(this.getGlobalMatrix(!0)),d=n/2;if(t.strokeStyle=t.fillStyle=c?c.toCanvasStyle(t):"#009dec",o&&this._drawSelected(t,h,i),l){var f=this.getPosition(!0),p=this._parent,m=p?p.localToGlobal(f):f,g=m.x,v=m.y;t.beginPath(),t.arc(g,v,d,0,2*Math.PI,!0),t.stroke();for(var y=[[0,-1],[1,0],[0,1],[-1,0]],b=d,x=n+1,_=0;_<4;_++){var w=y[_],S=w[0],E=w[1];t.moveTo(g+S*b,v+E*b),t.lineTo(g+S*x,v+E*x),t.stroke()}}if(s){var M=h._transformCorners(this.getInternalBounds());t.beginPath();for(_=0;_<8;_++)t[_?"lineTo":"moveTo"](M[_],M[++_]);t.closePath(),t.stroke();for(_=0;_<8;_++)t.fillRect(M[_]-d,M[++_]-d,n,n)}}},_canComposite:function(){return!1}},c.each(["down","drag","up","move"],(function(t){this["removeOn"+c.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}}),{removeOn:function(t){for(var e in t)if(t[e]){var n="mouse"+e,i=this._project,r=i._removeSets=i._removeSets||{};r[n]=r[n]||{},r[n][this._id]=this}return this}}),{tween:function(t,e,n){n||(n=e,e=t,t=null,n||(n=e,e=null));var i=n&&n.easing,r=n&&n.start,a=null!=n&&("number"==typeof n?n:n.duration),o=new ot(this,t,e,a,i,r);return a&&this.on("frame",(function t(e){o._handleFrame(1e3*e.time),o.running||this.off("frame",t)})),o},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),k=T.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(e){t.base.call(this,e),2050&e&&(this._clipItem=s)},_getClipItem:function(){var t=this._clipItem;if(t===s){t=null;for(var e=this._children,n=0,i=e.length;n<i;n++)if(e[n]._clipMask){t=e[n];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,n){var i=this._getClipItem();return i?i._getCachedBounds(i._matrix.prepended(e),c.set({},n,{stroke:!1})):t.base.call(this,e,n)},_hitTestChildren:function t(e,n,i){var r=this._getClipItem();return(!r||r.contains(e))&&t.base.call(this,e,n,i,r)},_draw:function(t,e){var n=e.clip,i=!n&&this._getClipItem();e=e.extend({clipItem:i,clip:!1}),n?(t.beginPath(),e.dontStart=e.dontFinish=!0):i&&i.draw(t,e.extend({clip:!0}));for(var r=this._children,a=0,o=r.length;a<o;a++){var s=r[a];s!==i&&s.draw(t,e)}}}),P=k.extend({_class:"Layer",initialize:function(){k.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),A=T.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&c.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new _(t.width,t.height,this,"setSize")},setSize:function(){var t=x.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,n=t.width,i=t.height;"rectangle"===e?this._radius.set(x.min(this._radius,t.divide(2).abs())):"circle"===e?(n=i=(n+i)/2,this._radius=n/2):"ellipse"===e&&this._radius._set(n/2,i/2),this._size._set(n,i),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new _(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var n=2*t;this._radius=t,this._size._set(n,n)}else if(t=x.read(arguments),this._radius){if(this._radius.equals(t))return;if(this._radius.set(t),"rectangle"===e){n=x.max(this._size,t.multiply(2));this._size.set(n)}else"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new(V[c.capitalize(this._type)])({center:new y,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),dt.settings.applyMatrix&&e.setApplyMatrix(!0),(t===s||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,n,i){var r=this._style,a=r.hasFill(),o=r.hasStroke(),s=e.dontFinish||e.clip,l=!i;if(a||o||s){var u=this._type,c=this._radius,h="circle"===u;if(e.dontStart||t.beginPath(),l&&h)t.arc(0,0,c,0,2*Math.PI,!0);else{var d=h?c:c.width,f=h?c:c.height,p=this._size,m=p.width,g=p.height;if(l&&"rectangle"===u&&0===d&&0===f)t.rect(-m/2,-g/2,m,g);else{var v=m/2,y=g/2,b=.44771525016920644,x=d*b,_=f*b,w=[-v,-y+f,-v,-y+_,-v+x,-y,-v+d,-y,v-d,-y,v-x,-y,v,-y+_,v,-y+f,v,y-f,v,y-_,v-x,y,v-d,y,-v+d,y,-v+x,y,-v,y-_,-v,y-f];i&&i.transform(w,w,32),t.moveTo(w[0],w[1]),t.bezierCurveTo(w[2],w[3],w[4],w[5],w[6],w[7]),v!==d&&t.lineTo(w[8],w[9]),t.bezierCurveTo(w[10],w[11],w[12],w[13],w[14],w[15]),y!==f&&t.lineTo(w[16],w[17]),t.bezierCurveTo(w[18],w[19],w[20],w[21],w[22],w[23]),v!==d&&t.lineTo(w[24],w[25]),t.bezierCurveTo(w[26],w[27],w[28],w[29],w[30],w[31])}}t.closePath()}s||!a&&!o||(this._setStyles(t,e,n),a&&(t.fill(r.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var n=new w(this._size).setCenter(0,0),i=this._style,r=e.stroke&&i.hasStroke()&&i.getStrokeWidth();return t&&(n=t._transformBounds(n)),r?n.expand(V._getStrokePadding(r,this._getStrokeMatrix(t,e))):n}},new function(){function t(t,e,n){var i=t._radius;if(!i.isZero())for(var r=t._size.divide(2),a=1;a<=4;a++){var o=new y(a>1&&a<4?-1:1,a>2?-1:1),s=o.multiply(r),l=s.subtract(o.multiply(i));if(new w(n?s.add(o.multiply(n)):s,l).contains(e))return{point:l,quadrant:a}}}function e(t,e,n,i){var r=t.divide(e);return(!i||r.isInQuadrant(i))&&r.subtract(r.normalize()).multiply(e).divide(n).length<=1}return{_contains:function e(n){if("rectangle"===this._type){var i=t(this,n);return i?n.subtract(i.point).divide(this._radius).getLength()<=1:e.base.call(this,n)}return n.divide(this.size).getLength()<=.5},_hitTestSelf:function n(i,r,a,o){var s=!1,l=this._style,u=r.stroke&&l.hasStroke(),c=r.fill&&l.hasFill();if(u||c){var h=this._type,d=this._radius,f=u?l.getStrokeWidth()/2:0,p=r._tolerancePadding.add(V._getStrokePadding(f,!l.getStrokeScaling()&&o));if("rectangle"===h){var m=p.multiply(2),g=t(this,i,m);if(g)s=e(i.subtract(g.point),d,p,g.quadrant);else{var v=new w(this._size).setCenter(0,0),y=v.expand(m),b=v.expand(m.negate());s=y._containsPoint(i)&&!b._containsPoint(i)}}else s=e(i,d,p)}return s?new I(u?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,n,i,r){var a=c.create(A.prototype);return a._type=t,a._size=n,a._radius=i,a._initialize(c.getNamed(r),e),a}return{Circle:function(){var e=arguments,n=y.readNamed(e,"center"),i=c.readNamed(e,"radius");return t("circle",n,new x(2*i),i,e)},Rectangle:function(){var e=arguments,n=w.readNamed(e,"rectangle"),i=x.min(x.readNamed(e,"radius"),n.getSize(!0).divide(2));return t("rectangle",n.getCenter(!0),n.getSize(!0),i,e)},Ellipse:function(){var e=arguments,n=A._readEllipse(e),i=n.radius;return t("ellipse",n.center,i.multiply(2),i,e)},_readEllipse:function(t){var e,n;if(c.hasNamed(t,"radius"))e=y.readNamed(t,"center"),n=x.readNamed(t,"radius");else{var i=w.readNamed(t,"rectangle");e=i.getCenter(!0),n=i.getSize(!0).divide(2)}return{center:e,radius:n}}}}}),O=T.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:!0,beans:!0,initialize:function(t,e){if(!this._initialize(t,e!==s&&y.read(arguments))){var n,i=typeof t,r="string"===i?u.getElementById(t):"object"===i?t:null;if(r&&r!==T.NO_INSERT)if(r.getContext||null!=r.naturalHeight)n=r;else if(r){var a=x.read(arguments);a.isZero()||(n=lt.getCanvas(a))}n?this.setImage(n):this.setSource(t)}this._size||(this._size=new x,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,n=t._canvas;if(e)this._setImage(e);else if(n){var i=lt.getCanvas(t._size);i.getContext("2d").drawImage(n,0,0),this._setImage(i)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new _(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(){var t=x.read(arguments);if(!t.equals(this._size))if(t.width>0&&t.height>0){var e=this.getElement();this._setImage(lt.getCanvas(t)),e&&this.getContext(!0).drawImage(e,0,0,t.width,t.height)}else this._canvas&&lt.release(this._canvas),this._size=t.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new y(0,0).transform(t),n=new y(1,0).transform(t).subtract(e),i=new y(0,1).transform(t).subtract(e);return new x(72/n.getLength(),72/i.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function n(t){var n=e.getView(),i=t&&t.type||"load";n&&e.responds(i)&&(dt=n._scope,e.emit(i,new tt(t)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&Z.add(t,{load:function(i){e._setImage(t),n(i)},error:n})},_setImage:function(t){this._canvas&&lt.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new x(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=lt.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){lt.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var e=new o.Image,n=this._crossOrigin;n&&(e.crossOrigin=n),t&&(e.src=t),this.setImage(e)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=t,this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=w.read(arguments),e=lt.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=w.read(arguments),e=new O(T.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(t){var e=y.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,n;if(t?t instanceof F?(n=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new w(t):"x"in t&&(e=new w(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var i=Math.min(e.width,32),r=Math.min(e.height,32),a=O._sampleContext;a?a.clearRect(0,0,33,33):a=O._sampleContext=lt.getContext(new x(32)),a.save();var o=(new E).scale(i/e.width,r/e.height).translate(-e.x,-e.y);o.applyToContext(a),n&&n.draw(a,new c({clip:!0,matrices:[o]})),this._matrix.applyToContext(a);var s=this.getElement(),l=this._size;s&&a.drawImage(s,-l.width/2,-l.height/2),a.restore();for(var u=a.getImageData(.5,.5,Math.ceil(i),Math.ceil(r)).data,h=[0,0,0],d=0,f=0,p=u.length;f<p;f+=4){var m=u[f+3];d+=m,m/=255,h[0]+=u[f]*m,h[1]+=u[f+1]*m,h[2]+=u[f+2]*m}for(f=0;f<3;f++)h[f]/=d;return d?q.read(h):null},getPixel:function(){var t=y.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new q("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=y.read(t),n=q.read(t),i=n._convert("rgb"),r=n._alpha,a=this.getContext(!0),o=a.createImageData(1,1),s=o.data;s[0]=255*i[0],s[1]=255*i[1],s[2]=255*i[2],s[3]=null!=r?255*r:255,a.putImageData(o,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=x.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=w.read(arguments);return t.isEmpty()&&(t=new w(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},setImageData:function(t){var e=y.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},_getBounds:function(t,e){var n=new w(this._size).setCenter(0,0);return t?t._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new I("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,n){var i=this.getElement();i&&i.width>0&&i.height>0&&(t.globalAlpha=g.clamp(this._opacity,0,1),this._setStyles(t,e,n),X.setPrefixed(t,"imageSmoothingEnabled",this._smoothing),t.drawImage(i,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),L=T.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,e){this._initialize(t,e!==s&&y.read(arguments,1))||this.setDefinition(t instanceof R?t:new R(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(t),e)},_hitTestSelf:function(t,e,n){var i=e.extend({all:!1}),r=this._definition._item._hitTest(t,i,n);return r&&(r.item=this),r},_draw:function(t,e){this._definition._item.draw(t,e)}}),R=c.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=v.get(),this.project=dt.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,(function(){return c.serialize([this._class,this._item],t,!1,e)}))},_changed:function(t){8&t&&T._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new y),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new L(this,t)},clone:function(){return new R(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),I=c.extend({_class:"HitResult",initialize:function(t,e,n){this.type=t,this.item=e,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&c.read(t);return new c({type:null,tolerance:dt.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),N=c.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,e,n,i,r,a){var o,l,u,c,h=arguments.length;h>0&&(null==t||"object"==typeof t?1===h&&t&&"point"in t?(o=t.point,l=t.handleIn,u=t.handleOut,c=t.selection):(o=t,l=e,u=n,c=i):(o=[t,e],l=n!==s?[n,i]:null,u=r!==s?[r,a]:null)),new D(o,this,"_point"),new D(l,this,"_handleIn"),new D(u,this,"_handleOut"),c&&this.setSelection(c)},_serialize:function(t,e){var n=this._point,i=this._selection,r=i||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return i&&r.push(i),c.serialize(r,t,!0,e)},_changed:function(t){var e=this._path;if(e){var n,i=e._curves,r=this._index;i&&(t&&t!==this._point&&t!==this._handleIn||!(n=r>0?i[r-1]:e._closed?i[i.length-1]:null)||n._changed(),t&&t!==this._point&&t!==this._handleOut||!(n=i[r])||n._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(y.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(y.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(y.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,n=this._path;this._selection=t=t||0,n&&t!==e&&(n._updateSelection(this,e,t),n._changed(257))},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==s?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new B(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,n){var i=t||{},r=i.type,a=i.factor,o=this.getPrevious(),l=this.getNext(),u=(o||this)._point,c=this._point,h=(l||this)._point,d=u.getDistance(c),f=c.getDistance(h);if(r&&"catmull-rom"!==r){if("geometric"!==r)throw new Error("Smoothing method '"+r+"' not supported.");if(o&&l){var p=u.subtract(h),m=a===s?.4:a,g=m*d/(d+f);e||this.setHandleIn(p.multiply(g)),n||this.setHandleOut(p.multiply(g-m))}}else{var v=a===s?.5:a,b=Math.pow(d,v),x=b*b,_=Math.pow(f,v),w=_*_;if(!e&&o){var S=2*w+3*_*b+x,E=3*_*(_+b);this.setHandleIn(0!==E?new y((w*u._x+S*c._x-x*h._x)/E-c._x,(w*u._y+S*c._y-x*h._y)/E-c._y):new y)}if(!n&&l){S=2*x+3*b*_+w,E=3*b*(b+_);this.setHandleOut(0!==E?new y((x*h._x+S*c._x-w*u._x)/E-c._x,(x*h._y+S*c._y-w*u._y)/E-c._y):new y)}}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,n=t.clone();t.set(e),e.set(n)},reversed:function(){return new N(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new N(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,n){var i=1-n,r=n,a=t._point,o=e._point,s=t._handleIn,l=e._handleIn,u=e._handleOut,c=t._handleOut;this._point._set(i*a._x+r*o._x,i*a._y+r*o._y,!0),this._handleIn._set(i*s._x+r*l._x,i*s._y+r*l._y,!0),this._handleOut._set(i*c._x+r*u._x,i*c._y+r*u._y,!0),this._changed()},_transformCoordinates:function(t,e,n){var i=this._point,r=n&&this._handleIn.isZero()?null:this._handleIn,a=n&&this._handleOut.isZero()?null:this._handleOut,o=i._x,s=i._y,l=2;return e[0]=o,e[1]=s,r&&(e[l++]=r._x+o,e[l++]=r._y+s),a&&(e[l++]=a._x+o,e[l++]=a._y+s),t&&(t._transformCoordinates(e,e,l/2),o=e[0],s=e[1],n?(i._x=o,i._y=s,l=2,r&&(r._x=e[l++]-o,r._y=e[l++]-s),a&&(a._x=e[l++]-o,a._y=e[l++]-s)):(r||(e[l++]=o,e[l++]=s),a||(e[l++]=o,e[l++]=s))),e}}),D=y.extend({initialize:function(t,e,n){var i,r,a;if(t)if((i=t[0])!==s)r=t[1];else{var o=t;(i=o.x)===s&&(i=(o=y.read(arguments)).x),r=o.y,a=o.selected}else i=r=0;this._x=i,this._y=r,this._owner=e,e[n]=this,a&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=g.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),z=c.extend({_class:"Curve",beans:!0,initialize:function(t,e,n,i,r,a,o,s){var l,u,c,h,d,f,p=arguments.length;3===p?(this._path=t,l=e,u=n):p?1===p?"segment1"in t?(l=new N(t.segment1),u=new N(t.segment2)):"point1"in t?(c=t.point1,d=t.handle1,f=t.handle2,h=t.point2):Array.isArray(t)&&(c=[t[0],t[1]],h=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],f=[t[4]-t[6],t[5]-t[7]]):2===p?(l=new N(t),u=new N(e)):4===p?(c=t,d=e,f=n,h=i):8===p&&(c=[t,e],h=[o,s],d=[n-t,i-e],f=[r-o,a-s]):(l=new N,u=new N),this._segment1=l||new N(c,null,d),this._segment2=u||new N(h,f,null)},_serialize:function(t,e){return c.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=s},clone:function(){return new z(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return z.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,n=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(n)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(y.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(y.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(y.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(y.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return z.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],n=0;n<8;n+=2)e.push(new y(t[n],t[n+1]));return e}},{getLength:function(){return null==this._length&&(this._length=z.getLength(this.getValues(),0,1)),this._length},getArea:function(){return z.getArea(this.getValues())},getLine:function(){return new M(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new z(z.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return z.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var n=null;if(t>=1e-8&&t<=1-1e-8){var i=z.subdivide(this.getValues(),t),r=i[0],a=i[1],o=e||this.hasHandles(),s=this._segment1,l=this._segment2,u=this._path;o&&(s._handleOut._set(r[2]-r[0],r[3]-r[1]),l._handleIn._set(a[4]-a[6],a[5]-a[7]));var c=r[6],h=r[7],d=new N(new y(c,h),o&&new y(r[4]-c,r[5]-h),o&&new y(a[2]-c,a[3]-h));u?(u.insert(s._index+1,d),n=this.getNext()):(this._segment2=d,this._changed(),n=new z(d,l))}return n},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===s?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===s?.5:e?t:this.getTimeAt(t))},reversed:function(){return new z(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,n,i){var r=t._point,a=t._handleOut,o=e._handleIn,s=e._point,l=r.x,u=r.y,c=s.x,h=s.y,d=i?[l,u,l,u,c,h,c,h]:[l,u,l+a._x,u+a._y,c+o._x,h+o._y,c,h];return n&&n._transformCoordinates(d,d,4),d},subdivide:function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7];e===s&&(e=.5);var h=1-e,d=h*n+e*r,f=h*i+e*a,p=h*r+e*o,m=h*a+e*l,g=h*o+e*u,v=h*l+e*c,y=h*d+e*p,b=h*f+e*m,x=h*p+e*g,_=h*m+e*v,w=h*y+e*x,S=h*b+e*_;return[[n,i,d,f,y,b,w,S],[w,S,x,_,g,v,u,c]]},getMonoCurves:function(t,e){var n=[],i=e?0:1,r=t[i+0],a=t[i+2],o=t[i+4],s=t[i+6];if(r>=a==a>=o&&a>=o==o>=s||z.isStraight(t))n.push(t);else{var l=3*(a-o)-r+s,u=2*(r+o)-4*a,c=a-r,h=[],d=g.solveQuadratic(l,u,c,h,1e-8,1-1e-8);if(d){h.sort();var f=h[0],p=z.subdivide(t,f);n.push(p[0]),d>1&&(f=(h[1]-f)/(1-f),p=z.subdivide(p[1],f),n.push(p[0])),n.push(p[1])}else n.push(t)}return n},solveCubic:function(t,e,n,i,r,a){var o=t[e],s=t[e+2],l=t[e+4],u=t[e+6],c=0;if(!(o<n&&u<n&&s<n&&l<n||o>n&&u>n&&s>n&&l>n)){var h=3*(s-o),d=3*(l-s)-h,f=u-o-h-d;c=g.solveCubic(f,d,h,o-n,i,r,a)}return c},getTimeOf:function(t,e){var n=new y(t[0],t[1]),i=new y(t[6],t[7]);if(null===(e.isClose(n,1e-12)?0:e.isClose(i,1e-12)?1:null))for(var r=[e.x,e.y],a=[],o=0;o<2;o++)for(var s=z.solveCubic(t,o,r[o],a,0,1),l=0;l<s;l++){var u=a[l];if(e.isClose(z.getPoint(t,u),1e-7))return u}return e.isClose(n,1e-7)?0:e.isClose(i,1e-7)?1:null},getNearestTime:function(t,e){if(z.isStraight(t)){var n=t[0],i=t[1],r=t[6]-n,a=t[7]-i,o=r*r+a*a;if(0===o)return 0;var s=((e.x-n)*r+(e.y-i)*a)/o;return s<1e-12?0:s>.999999999999?1:z.getTimeOf(t,new y(n+s*r,i+s*a))}var l=1/0,u=0;function c(n){if(n>=0&&n<=1){var i=e.getDistance(z.getPoint(t,n),!0);if(i<l)return l=i,u=n,!0}}for(var h=0;h<=100;h++)c(h/100);for(var d=.005;d>1e-8;)c(u-d)||c(u+d)||(d/=2);return u},getPart:function(t,e,n){var i=e>n;if(i){var r=e;e=n,n=r}return e>0&&(t=z.subdivide(t,e)[1]),n<1&&(t=z.subdivide(t,(n-e)/(1-e))[0]),i?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=3*r-2*n-l,h=3*a-2*i-u,d=3*o-2*l-n,f=3*s-2*u-i;return Math.max(c*c,d*d)+Math.max(h*h,f*f)<=16*e*e},getArea:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7];return 3*((l-n)*(i+a)-(s-e)*(r+o)+r*(e-a)-i*(n-o)+l*(a+e/3)-s*(o+n/3))/20},getBounds:function(t){for(var e=t.slice(0,2),n=e.slice(),i=[0,0],r=0;r<2;r++)z._addBounds(t[r],t[r+2],t[r+4],t[r+6],r,0,e,n,i);return new w(e[0],e[1],n[0]-e[0],n[1]-e[1])},_addBounds:function(t,e,n,i,r,a,o,s,l){function u(t,e){var n=t-e,i=t+e;n<o[r]&&(o[r]=n),i>s[r]&&(s[r]=i)}a/=2;var c=o[r]+a,h=s[r]-a;if(t<c||e<c||n<c||i<c||t>h||e>h||n>h||i>h)if(e<t!=e<i&&n<t!=n<i)u(t,0),u(i,0);else{var d=3*(e-n)-t+i,f=2*(t+n)-4*e,p=e-t,m=g.solveQuadratic(d,f,p,l);u(i,0);for(var v=0;v<m;v++){var y=l[v],b=1-y;1e-8<=y&&y<=1-1e-8&&u(b*b*b*t+3*b*b*y*e+3*b*y*y*n+y*y*y*i,a)}}}}},c.each(["getBounds","getStrokeBounds","getHandleBounds"],(function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=V[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}}),{}),c.each({isStraight:function(t,e,n,i){if(e.isZero()&&n.isZero())return!0;var r=i.subtract(t);if(r.isZero())return!1;if(r.isCollinear(e)&&r.isCollinear(n)){var a=new M(t,i);if(a.getDistance(t.add(e))<1e-7&&a.getDistance(i.add(n))<1e-7){var o=r.dot(r),s=r.dot(e)/o,l=r.dot(n)/o;return s>=0&&s<=1&&l<=0&&l>=-1}}return!1},isLinear:function(t,e,n,i){var r=i.subtract(t).divide(3);return e.equals(r)&&n.negate().equals(r)}},(function(t,e){this[e]=function(e){var n=this._segment1,i=this._segment2;return t(n._point,n._handleOut,i._handleIn,i._point,e)},this.statics[e]=function(e,n){var i=e[0],r=e[1],a=e[6],o=e[7];return t(new y(i,r),new y(e[2]-i,e[3]-r),new y(e[4]-a,e[5]-o),new y(a,o),n)}}),{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new B(this,t):null},getTimeAt:function(t,e){return z.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=y.read(arguments);return t.isZero()?[]:z.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(y.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return z.getTimeOf(this.getValues(),y.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=y.read(arguments),e=this.getValues(),n=z.getNearestTime(e,t),i=z.getPoint(e,n);return new B(this,n,i,null,t.getDistance(i))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return c.each(t,(function(t){this[t+"At"]=function(e,n){var i=this.getValues();return z[t](i,n?e:z.getTimeAt(i,e))},this[t+"AtTime"]=function(e){return z[t](this.getValues(),e)}}),{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=9*(i-a)+3*(s-e),c=6*(e+a)-12*i,h=3*(i-e),d=9*(r-o)+3*(l-n),f=6*(n+o)-12*r,p=3*(r-n);return function(t){var e=(u*t+c)*t+h,n=(d*t+f)*t+p;return Math.sqrt(e*e+n*n)}}function e(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function n(t,e,n,i){if(null==e||e<0||e>1)return null;var r=t[0],a=t[1],o=t[2],s=t[3],l=t[4],u=t[5],c=t[6],h=t[7],d=g.isZero;d(o-r)&&d(s-a)&&(o=r,s=a),d(l-c)&&d(u-h)&&(l=c,u=h);var f,p,m=3*(o-r),v=3*(l-o)-m,b=c-r-m-v,x=3*(s-a),_=3*(u-s)-x,w=h-a-x-_;if(0===n)f=0===e?r:1===e?c:((b*e+v)*e+m)*e+r,p=0===e?a:1===e?h:((w*e+_)*e+x)*e+a;else{if(e<1e-8?(f=m,p=x):e>1-1e-8?(f=3*(c-l),p=3*(h-u)):(f=(3*b*e+2*v)*e+m,p=(3*w*e+2*_)*e+x),i){0===f&&0===p&&(e<1e-8||e>1-1e-8)&&(f=l-o,p=u-s);var S=Math.sqrt(f*f+p*p);S&&(f/=S,p/=S)}if(3===n){l=6*b*e+2*v,u=6*w*e+2*_;var E=Math.pow(f*f+p*p,1.5);f=0!==E?(f*u-p*l)/E:0,p=0}}return 2===n?new y(p,-f):new y(f,p)}return{statics:{classify:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=i*(n-u)+r*(l-e)+e*u-n*l,h=3*(a*(r-n)+o*(e-i)+i*n-r*e),d=h-c,f=d-c+(e*(u-o)+n*(a-l)+l*o-u*a),p=Math.sqrt(f*f+d*d+h*h),m=0!==p?1/p:0,v=g.isZero;function y(t,e,n){var i=e!==s,r=i&&e>0&&e<1,a=i&&n>0&&n<1;return!i||(r||a)&&("loop"!==t||r&&a)||(t="arch",r=a=!1),{type:t,roots:r||a?r&&a?e<n?[e,n]:[n,e]:[r?e:n]:null}}if(d*=m,h*=m,v(f*=m))return v(d)?y(v(h)?"line":"quadratic"):y("serpentine",h/(3*d));var b=3*d*d-4*f*h;if(v(b))return y("cusp",d/(2*f));var x=b>0?Math.sqrt(b/3):Math.sqrt(-b),_=2*f;return y(b>0?"serpentine":"loop",(d+x)/_,(d-x)/_)},getLength:function(n,i,r,a){if(i===s&&(i=0),r===s&&(r=1),z.isStraight(n)){var o=n;r<1&&(o=z.subdivide(o,r)[0],i/=r),i>0&&(o=z.subdivide(o,i)[1]);var l=o[6]-o[0],u=o[7]-o[1];return Math.sqrt(l*l+u*u)}return g.integrate(a||t(n),i,r,e(i,r))},getTimeAt:function(n,i,r){if(r===s&&(r=i<0?1:0),0===i)return r;var a=Math.abs,o=i>0,l=o?r:0,u=o?1:r,c=t(n),h=z.getLength(n,l,u,c),d=a(i)-h;if(a(d)<1e-12)return o?u:l;if(d>1e-12)return null;var f=i/h,p=0;return g.findRoot((function(t){return p+=g.integrate(c,r,t,e(r,t)),r=t,p-i}),c,r+f,l,u,32,1e-12)},getPoint:function(t,e){return n(t,e,0,!1)},getTangent:function(t,e){return n(t,e,1,!0)},getWeightedTangent:function(t,e){return n(t,e,1,!1)},getNormal:function(t,e){return n(t,e,2,!0)},getWeightedNormal:function(t,e){return n(t,e,2,!1)},getCurvature:function(t,e){return n(t,e,3,!1).x},getPeaks:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=3*i-e-3*a+t[6],l=3*e-6*i+3*a,u=-3*e+3*i,c=3*r-n-3*o+t[7],h=3*n-6*r+3*o,d=-3*n+3*r,f=[];return g.solveCubic(9*(s*s+c*c),9*(s*l+h*c),2*(l*l+h*h)+3*(u*s+d*c),u*l+h*d,f,1e-8,1-1e-8),f.sort()}}}},new function(){function t(t,e,n,i,r,a,o){var s=!o&&n.getPrevious()===r,l=!o&&n!==r&&n.getNext()===r;if(null!==i&&i>=(s?1e-8:0)&&i<=(l?1-1e-8:1)&&null!==a&&a>=(l?1e-8:0)&&a<=(s?1-1e-8:1)){var u=new B(n,i,null,o),c=new B(r,a,null,o);u._intersection=c,c._intersection=u,e&&!e(u)||B.insert(t,u,!0)}}function e(i,r,a,o,s,l,u,c,h,d,f,p,m){if(++h>=4096||++c>=40)return h;var g,v,y=r[0],b=r[1],x=r[6],_=r[7],w=M.getSignedDistance,S=w(y,b,x,_,r[2],r[3]),E=w(y,b,x,_,r[4],r[5]),C=S*E>0?3/4:4/9,T=C*Math.min(0,S,E),k=C*Math.max(0,S,E),P=w(y,b,x,_,i[0],i[1]),A=w(y,b,x,_,i[2],i[3]),O=w(y,b,x,_,i[4],i[5]),L=w(y,b,x,_,i[6],i[7]),R=function(t,e,n,i){var r,a=[0,t],o=[1/3,e],s=[2/3,n],l=[1,i],u=e-(2*t+i)/3,c=n-(t+2*i)/3;if(u*c<0)r=[[a,o,l],[a,s,l]];else{var h=u/c;r=[h>=2?[a,o,l]:h<=.5?[a,s,l]:[a,o,s,l],[a,l]]}return(u||c)<0?r.reverse():r}(P,A,O,L),I=R[0],N=R[1];if(0===S&&0===E&&0===P&&0===A&&0===O&&0===L||null==(g=n(I,N,T,k))||null==(v=n(I.reverse(),N.reverse(),T,k)))return h;var D=d+(f-d)*g,B=d+(f-d)*v;if(Math.max(m-p,B-D)<1e-9){var F=(D+B)/2,V=(p+m)/2;t(s,l,u?o:a,u?V:F,u?a:o,u?F:V)}else{i=z.getPart(i,g,v);var j=m-p;if(v-g>.8)if(B-D>j){F=(D+B)/2;h=e(r,(U=z.subdivide(i,.5))[0],o,a,s,l,!u,c,h,p,m,D,F),h=e(r,U[1],o,a,s,l,!u,c,h,p,m,F,B)}else{var U;V=(p+m)/2;h=e((U=z.subdivide(r,.5))[0],i,o,a,s,l,!u,c,h,p,V,D,B),h=e(U[1],i,o,a,s,l,!u,c,h,V,m,D,B)}else h=0===j||j>=1e-9?e(r,i,o,a,s,l,!u,c,h,p,m,D,B):e(i,r,a,o,s,l,u,c,h,D,B,p,m)}return h}function n(t,e,n,r){return t[0][1]<n?i(t,!0,n):e[0][1]>r?i(e,!1,r):t[0][0]}function i(t,e,n){for(var i=t[0][0],r=t[0][1],a=1,o=t.length;a<o;a++){var s=t[a][0],l=t[a][1];if(e?l>=n:l<=n)return l===n?s:i+(n-r)*(s-i)/(l-r);i=s,r=l}return null}function r(t,e,n,i,r){var a=g.isZero;if(a(i)&&a(r)){var o=z.getTimeOf(t,new y(e,n));return null===o?[]:[o]}for(var s=Math.atan2(-r,i),l=Math.sin(s),u=Math.cos(s),c=[],h=[],d=0;d<8;d+=2){var f=t[d]-e,p=t[d+1]-n;c.push(f*u-p*l,f*l+p*u)}return z.solveCubic(c,1,0,h,0,1),h}function a(e,n,i,a,o,s,l){for(var u=n[0],c=n[1],h=r(e,u,c,n[6]-u,n[7]-c),d=0,f=h.length;d<f;d++){var p=h[d],m=z.getPoint(e,p),g=z.getTimeOf(n,m);null!==g&&t(o,s,l?a:i,l?g:p,l?i:a,l?p:g)}}function o(e,n,i,r,a,o){var s=M.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);s&&t(a,o,i,z.getTimeOf(e,s),r,z.getTimeOf(n,s))}function s(n,i,r,s,l,c){var h=Math.min,d=Math.max;if(d(n[0],n[2],n[4],n[6])+1e-12>h(i[0],i[2],i[4],i[6])&&h(n[0],n[2],n[4],n[6])-1e-12<d(i[0],i[2],i[4],i[6])&&d(n[1],n[3],n[5],n[7])+1e-12>h(i[1],i[3],i[5],i[7])&&h(n[1],n[3],n[5],n[7])-1e-12<d(i[1],i[3],i[5],i[7])){var f=u(n,i);if(f)for(var p=0;p<2;p++){var m=f[p];t(l,c,r,m[0],s,m[1],!0)}else{var g=z.isStraight(n),v=z.isStraight(i),b=g&&v,x=g&&!v,_=l.length;if((b?o:g||v?a:e)(x?i:n,x?n:i,x?s:r,x?r:s,l,c,x,0,0,0,1,0,1),!b||l.length===_)for(p=0;p<4;p++){var w=p>>1,S=1&p,E=6*w,M=6*S,C=new y(n[E],n[E+1]),T=new y(i[M],i[M+1]);C.isClose(T,1e-12)&&t(l,c,r,w,s,S)}}}return l}function l(e,n,i,r){var a=z.classify(e);if("loop"===a.type){var o=a.roots;t(i,r,n,o[0],n,o[1])}return i}function u(t,e){function n(t){var e=t[6]-t[0],n=t[7]-t[1];return e*e+n*n}var i=Math.abs,r=M.getDistance,a=z.isStraight(t),o=z.isStraight(e),s=a&&o,l=n(t)<n(e),u=l?e:t,c=l?t:e,h=u[0],d=u[1],f=u[6]-h,p=u[7]-d;if(r(h,d,f,p,c[0],c[1],!0)<1e-7&&r(h,d,f,p,c[6],c[7],!0)<1e-7)!s&&r(h,d,f,p,u[2],u[3],!0)<1e-7&&r(h,d,f,p,u[4],u[5],!0)<1e-7&&r(h,d,f,p,c[2],c[3],!0)<1e-7&&r(h,d,f,p,c[4],c[5],!0)<1e-7&&(a=o=s=!0);else if(s)return null;if(a^o)return null;for(var m=[t,e],g=[],v=0;v<4&&g.length<2;v++){var b=1&v,x=1^b,_=v>>1,w=z.getTimeOf(m[b],new y(m[x][_?6:0],m[x][_?7:1]));if(null!=w){var S=b?[_,w]:[w,_];(!g.length||i(S[0]-g[0][0])>1e-8&&i(S[1]-g[0][1])>1e-8)&&g.push(S)}if(v>2&&!g.length)break}if(2!==g.length)g=null;else if(!s){var E=z.getPart(t,g[0][0],g[1][0]),C=z.getPart(e,g[0][1],g[1][1]);(i(C[2]-E[2])>1e-7||i(C[3]-E[3])>1e-7||i(C[4]-E[4])>1e-7||i(C[5]-E[5])>1e-7)&&(g=null)}return g}return{getIntersections:function(t){var e=this.getValues(),n=t&&t!==this&&t.getValues();return n?s(e,n,this,t,[]):l(e,this,[])},statics:{getOverlaps:u,getIntersections:function(t,e,n,i,r,a){var o=!e;o&&(e=t);for(var u=t.length,c=e.length,h=new Array(u),d=o?h:new Array(c),f=[],m=0;m<u;m++)h[m]=t[m].getValues(i);if(!o)for(m=0;m<c;m++)d[m]=e[m].getValues(r);for(var g=p.findCurveBoundsCollisions(h,d,1e-7),v=0;v<u;v++){var y=t[v],b=h[v];o&&l(b,y,f,n);var x=g[v];if(x)for(var _=0;_<x.length;_++){if(a&&f.length)return f;var w=x[_];if(!o||w>v){var S=e[w];s(b,d[w],y,S,f,n)}}}return f},getCurveLineIntersections:r,getTimesWithTangent:function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=e.normalize(),h=c.x,d=c.y,f=3*l-9*o+9*r-3*n,p=3*u-9*s+9*a-3*i,m=6*o-12*r+6*n,v=6*s-12*a+6*i,y=3*r-3*n,b=3*a-3*i,x=2*f*d-2*p*h,_=[];if(Math.abs(x)<g.CURVETIME_EPSILON){if(0!=(x=f*v-p*m)){var w=-(f*b-p*y)/x;w>=0&&w<=1&&_.push(w)}}else{var S=(m*m-4*f*y)*d*d+(-2*m*v+4*p*y+4*f*b)*h*d+(v*v-4*p*b)*h*h,E=m*d-v*h;if(S>=0&&0!=x){var M=Math.sqrt(S),C=-(E+M)/x,T=(-E+M)/x;C>=0&&C<=1&&_.push(C),T>=0&&T<=1&&_.push(T)}}return _}}}}),B=c.extend({_class:"CurveLocation",initialize:function(t,e,n,i,r){if(e>=.99999999){var a=t.getNext();a&&(e=0,t=a)}this._setCurve(t),this._time=e,this._point=n||t.getPointAtTime(e),this._overlap=i,this._distance=r,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),n=this.getTime();0===n?t=e._segment1:1===n?t=e._segment2:null!=n&&(t=e.getPartLength(0,n)<e.getPartLength(n,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function n(t){var n=t&&t.getCurve();if(n&&null!=(e._time=n.getTimeOf(e._point)))return e._setCurve(n),n}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),n=this.getIndex();if(e&&null!=n)for(var i=e.getCurves(),r=0;r<n;r++)t+=i[r].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),n=this.getTime();this._curveOffset=t=null!=n&&e&&e.getPartLength(0,n)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,n=t&&t.splitAtTime(this.getTime());return n&&this._setSegment(e.getLastSegment()),n},equals:function(t,e){var n=this===t;if(!n&&t instanceof B){var i=this.getCurve(),r=t.getCurve(),a=i._path;if(a===r._path){var o=Math.abs,s=o(this.getOffset()-t.getOffset()),l=!e&&this._intersection,u=!e&&t._intersection;n=(s<1e-7||a&&o(a.getLength()-s)<1e-7)&&(!l&&!u||l&&u&&l.equals(u,!0))}}return n},toString:function(){var t=[],e=this.getPoint(),n=m.instance;e&&t.push("point: "+e);var i=this.getIndex();null!=i&&t.push("index: "+i);var r=this.getTime();return null!=r&&t.push("time: "+n.number(r)),null!=this._distance&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),n=t.getCurve();return!(e.isStraight()&&n.isStraight()&&e.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),n=t.getTime(),i=e>=1e-8&&e<=1-1e-8,r=n>=1e-8&&n<=1-1e-8;if(i&&r)return!this.isTouching();var a=this.getCurve(),o=a&&e<1e-8?a.getPrevious():a,s=t.getCurve(),l=s&&n<1e-8?s.getPrevious():s;if(e>1-1e-8&&(a=a.getNext()),n>1-1e-8&&(s=s.getNext()),!(o&&a&&l&&s))return!1;var u=[];function c(t,e){var n=t.getValues(),i=z.classify(n).roots||z.getPeaks(n),r=i.length,a=z.getLength(n,e&&r?i[r-1]:0,!e&&r?i[0]:1);u.push(r?a:a/32)}function h(t,e,n){return e<n?t>e&&t<n:t>e||t<n}i||(c(o,!0),c(a,!1)),r||(c(l,!0),c(s,!1));var d=this.getPoint(),f=Math.min.apply(Math,u),p=i?a.getTangentAtTime(e):a.getPointAt(f).subtract(d),m=i?p.negate():o.getPointAt(-f).subtract(d),g=r?s.getTangentAtTime(n):s.getPointAt(f).subtract(d),v=r?g.negate():l.getPointAt(-f).subtract(d),y=m.getAngle(),b=p.getAngle(),x=v.getAngle(),_=g.getAngle();return!!(i?h(y,x,_)^h(b,x,_)&&h(y,_,x)^h(b,_,x):h(x,y,b)^h(_,y,b)&&h(x,b,y)^h(_,b,y))},hasOverlap:function(){return!!this._overlap}},c.each(z._evaluateMethods,(function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),n=this.getTime();return null!=n&&t&&t[e](n,!0)}}),{preserve:!0}),new function(){function t(t,e,n){var i=t.length,r=0,a=i-1;function o(n,r){for(var a=n+r;a>=-1&&a<=i;a+=r){var o=t[(a%i+i)%i];if(!e.getPoint().isClose(o.getPoint(),1e-7))break;if(e.equals(o))return o}return null}for(;r<=a;){var s,l=r+a>>>1,u=t[l];if(n&&(s=e.equals(u)?u:o(l,-1)||o(l,1)))return e._overlap&&(s._overlap=s._intersection._overlap=!0),s;var c=e.getPath(),h=u.getPath();(c!==h?c._id-h._id:e.getIndex()+e.getTime()-(u.getIndex()+u.getTime()))<0?a=l-1:r=l+1}return t.splice(r,0,e),e}return{statics:{insert:t,expand:function(e){for(var n=e.slice(),i=e.length-1;i>=0;i--)t(n,e[i]._intersection,!1);return n}}}}),F=T.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,n,i;if(c.isPlainObject(t)?(n=t.segments,e=t.pathData):Array.isArray(t)?n=t:"string"==typeof t&&(e=t),n){var r=n[0];i=r&&Array.isArray(r[0])}else e&&(i=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(i?j:V)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,n,i,r=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),a=!1,o=new y,s=new y;function l(t,n){var i=+e[t];return a&&(i+=o[n]),i}function u(t){return new y(l(t,"x"),l(t+1,"y"))}this.clear();for(var c=0,h=r&&r.length;c<h;c++){var d=r[c],f=d[0],p=f.toLowerCase(),m=(e=d.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(a=f===p,"z"!==n||/[mz]/.test(p)||this.moveTo(o),p){case"m":case"l":for(var g="m"===p,v=0;v<m;v+=2)this[g?"moveTo":"lineTo"](o=u(v)),g&&(s=o,g=!1);i=o;break;case"h":case"v":var b="h"===p?"x":"y";o=o.clone();for(v=0;v<m;v++)o[b]=l(v,b),this.lineTo(o);i=o;break;case"c":for(v=0;v<m;v+=6)this.cubicCurveTo(u(v),i=u(v+2),o=u(v+4));break;case"s":for(v=0;v<m;v+=4)this.cubicCurveTo(/[cs]/.test(n)?o.multiply(2).subtract(i):o,i=u(v),o=u(v+2)),n=p;break;case"q":for(v=0;v<m;v+=4)this.quadraticCurveTo(i=u(v),o=u(v+2));break;case"t":for(v=0;v<m;v+=2)this.quadraticCurveTo(i=/[qt]/.test(n)?o.multiply(2).subtract(i):o,o=u(v)),n=p;break;case"a":for(v=0;v<m;v+=7)this.arcTo(o=u(v+5),new x(+e[v],+e[v+1]),+e[v+2],+e[v+4],+e[v+3]);break;case"z":this.closePath(1e-12),o=s}n=p}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,n,i){var r=this===t||!t,a=this._matrix._orNullIfIdentity(),o=r?a:(n||t._matrix)._orNullIfIdentity();return r||this.getBounds(a).intersects(t.getBounds(o),1e-12)?z.getIntersections(this.getCurves(),!r&&t.getCurves(),e,a,o,i):[]},getCrossings:function(t){return this.getIntersections(t,(function(t){return t.isCrossing()}))},getNearestLocation:function(){for(var t=y.read(arguments),e=this.getCurves(),n=1/0,i=null,r=0,a=e.length;r<a;r++){var o=e[r].getNearestLocation(t);o._distance<n&&(n=o._distance,i=o)}return i},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,n){var i=!this._children,r=i?"_segments":"_children",a=t[r],o=e[r],s=this[r];if(!a||!o||a.length!==o.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var l=s.length,u=o.length;if(l<u)for(var c=i?N:V,h=l;h<u;h++)this.add(new c);else l>u&&this[i?"removeSegments":"removeChildren"](u,l);for(h=0;h<u;h++)s[h].interpolate(a[h],o[h],n);i&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var n=this._children||[this],i=t._children?t._children.slice():[t],r=n.length,a=i.length,o=[],s=0;e=!0;for(var l=p.findItemBoundsCollisions(n,i,g.GEOMETRIC_EPSILON),u=r-1;u>=0&&e;u--){var c=n[u];e=!1;var h=l[u];if(h)for(var d=h.length-1;d>=0&&!e;d--)c.compare(i[h[d]])&&(o[h[d]]||(o[h[d]]=!0,s++),e=!0)}e=e&&s===a}return e}}),V=F.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var e=arguments,n=Array.isArray(t)?"object"==typeof t[0]?t:e:!t||t.size!==s||t.x===s&&t.point===s?null:e;n&&n.length>0?this.setSegments(n):(this._curves=s,this._segmentSelection=0,n||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!n&&t)},_equals:function(t){return this._closed===t._closed&&c.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),8&e){if(this._length=this._area=s,32&e)this._version++;else if(this._curves)for(var n=0,i=this._curves.length;n<i;n++)this._curves[n]._changed()}else 64&e&&(this._bounds=s)},getStyle:function(){var t=this._parent;return(t instanceof j?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),n=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=s,n){var i=t[n-1];"boolean"==typeof i&&(this.setClosed(i),n--),this._add(N.readList(t,0,{},n))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var i=0;i<n;i++)t[i]=new z(this,e[i],e[i+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new z(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var n,i,r,a,o,s,l,u,c=this._segments,h=c.length,d=new m(e),f=new Array(6),p=!0,g=[];function v(e,c){if(e._transformCoordinates(t,f),n=f[0],i=f[1],p)g.push("M"+d.pair(n,i)),p=!1;else if(o=f[2],s=f[3],o===n&&s===i&&l===r&&u===a){if(!c){var h=n-r,m=i-a;g.push(0===h?"v"+d.number(m):0===m?"h"+d.number(h):"l"+d.pair(h,m))}}else g.push("c"+d.pair(l-r,u-a)+" "+d.pair(o-r,s-a)+" "+d.pair(n-r,i-a));r=n,a=i,l=f[4],u=f[5]}if(!h)return"";for(var y=0;y<h;y++)v(c[y]);return this._closed&&h>0&&(v(c[0],!0),g.push("z")),g.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,n=new Array(6),i=0,r=e.length;i<r;i++)e[i]._transformCoordinates(t,n,!0);return!0},_add:function(t,e){for(var n=this._segments,i=this._curves,r=t.length,a=null==e,o=(e=a?n.length:e,0);o<r;o++){var s=t[o];s._path&&(s=t[o]=s.clone()),s._path=this,s._index=e+o,s._selection&&this._updateSelection(s,0,s._selection)}if(a)c.push(n,t);else{n.splice.apply(n,[e,0].concat(t));o=e+r;for(var l=n.length;o<l;o++)n[o]._index=o}if(i){var u=this._countCurves(),h=e>0&&e+r-1===u?e-1:e,d=h,f=Math.min(h+r,u);t._curves&&(i.splice.apply(i,[h,0].concat(t._curves)),d+=t._curves.length);for(o=d;o<f;o++)i.splice(o,0,new z(this,null,null));this._adjustCurves(h,f)}return this._changed(41),t},_adjustCurves:function(t,e){for(var n,i=this._segments,r=this._curves,a=t;a<e;a++)(n=r[a])._path=this,n._segment1=i[a],n._segment2=i[a+1]||i[0],n._changed();(n=r[this._closed&&!t?i.length-1:t-1])&&(n._segment2=i[t]||i[0],n._changed()),(n=r[e])&&(n._segment1=i[e],n._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(N.readList(e)):this._add([N.read(e)])[0]},insert:function(t,e){var n=arguments;return n.length>2&&"number"!=typeof e?this._add(N.readList(n,1),t):this._add([N.read(n,1)],t)[0]},addSegment:function(){return this._add([N.read(arguments)])[0]},insertSegment:function(t){return this._add([N.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(N.readList(t))},insertSegments:function(t,e){return this._add(N.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,n){t=t||0,e=c.pick(e,this._segments.length);var i=this._segments,r=this._curves,a=i.length,o=i.splice(t,e-t),s=o.length;if(!s)return o;for(var l=0;l<s;l++){var u=o[l];u._selection&&this._updateSelection(u,u._selection,0),u._index=u._path=null}l=t;for(var h=i.length;l<h;l++)i[l]._index=l;if(r){var d=t>0&&e===a+(this._closed?1:0)?t-1:t;for(l=(r=r.splice(d,s)).length-1;l>=0;l--)r[l]._path=null;n&&(o._curves=r.slice(1)),this._adjustCurves(d,d)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,n=0,i=t.length;n<i;n++)e+=t[n].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,n=this._closed;t=0;for(var i=0,r=e.length;i<r;i++){var a=i+1===r;t+=z.getArea(z.getValues(e[i],e[a?0:i+1],null,a&&!n))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,n=e.length,i=t?7:0;this._segmentSelection=i*n;for(var r=0;r<n;r++)e[r]._selection=i},_updateSelection:function(t,e,n){t._selection=n,(this._segmentSelection+=n-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,n=this.getLocationAt(t);return n&&(e=n.getCurve().divideAt(n.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),n=e&&e.index,i=e&&e.time;i>1-1e-8&&(n++,i=0);var r=this.getCurves();if(n>=0&&n<r.length){i>=1e-8&&r[n++].divideAtTime(i);var a,o=this.removeSegments(n,this._segments.length,!0);return this._closed?(this.setClosed(!1),a=this):((a=new V(T.NO_INSERT)).insertAbove(this),a.copyAttributes(this)),a._add(o,0),this.addSegment(o[0]),a}return null},split:function(t,e){var n,i=e===s?t:(n=this.getCurves()[t])&&n.getLocationAtTime(e);return null!=i?this.splitAt(i):null},join:function(t,e){var n=e||0;if(t&&t!==this){var i=t._segments,r=this.getLastSegment(),a=t.getLastSegment();if(!a)return this;r&&r._point.isClose(a._point,n)&&t.reverse();var o=t.getFirstSegment();if(r&&r._point.isClose(o._point,n))r.setHandleOut(o._handleOut),this._add(i.slice(1));else{var s=this.getFirstSegment();s&&s._point.isClose(o._point,n)&&t.reverse(),a=t.getLastSegment(),s&&s._point.isClose(a._point,n)?(s.setHandleIn(a._handleIn),this._add(i.slice(0,i.length-1),0)):this._add(i.slice())}t._closed&&this._add([i[0]]),t.remove()}var l=this.getFirstSegment(),u=this.getLastSegment();return l!==u&&l._point.isClose(u._point,n)&&(l.setHandleIn(u._handleIn),u.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),n=t&&t.simplify,i=n?1e-7:0,r=e.length-1;r>=0;r--){var a=e[r];!a.hasHandles()&&(!a.hasLength(i)||n&&a.isCollinear(a.getNext()))&&a.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var n=this._segments[t],i=n._handleIn;n._handleIn=n._handleOut,n._handleOut=i,n._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new U(this,t||.25,256,!0).parts,n=e.length,i=[],r=0;r<n;r++)i.push(new N(e[r].curve.slice(0,2)));!this._closed&&n>0&&i.push(new N(e[n-1].curve.slice(6))),this.setSegments(i)},simplify:function(t){var e=new H(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,n=t||{},i=n.type||"asymmetric",r=this._segments,a=r.length,o=this._closed;function l(t,n){var i=t&&t.index;if(null!=i){var r=t.path;if(r&&r!==e)throw new Error(t._class+" "+i+" of "+r+" is not part of "+e);n&&t instanceof z&&i++}else i="number"==typeof t?t:n;return Math.min(i<0&&o?i%a:i<0?i+a:i,a-1)}var u=o&&n.from===s&&n.to===s,c=l(n.from,0),h=l(n.to,a-1);if(c>h)if(o)c-=a;else{var d=c;c=h,h=d}if(/^(?:asymmetric|continuous)$/.test(i)){var f="asymmetric"===i,p=Math.min,m=h-c+1,g=m-1,v=u?p(m,4):1,y=v,b=v,x=[];if(o||(y=p(1,c),b=p(1,a-h-1)),(g+=y+b)<=1)return;for(var _=0,w=c-y;_<=g;_++,w++)x[_]=r[(w<0?w+a:w)%a]._point;var S=x[0]._x+2*x[1]._x,E=x[0]._y+2*x[1]._y,M=2,C=g-1,T=[S],k=[E],P=[M],A=[],O=[];for(_=1;_<g;_++){var L=_<C,R=L?4:f?2:7,I=L?4:f?3:8,N=L?2:f?0:1,D=(L||f?1:2)/M;M=P[_]=R-D,S=T[_]=I*x[_]._x+N*x[_+1]._x-D*S,E=k[_]=I*x[_]._y+N*x[_+1]._y-D*E}A[C]=T[C]/P[C],O[C]=k[C]/P[C];for(_=g-2;_>=0;_--)A[_]=(T[_]-A[_+1])/P[_],O[_]=(k[_]-O[_+1])/P[_];A[g]=(3*x[g]._x-A[C])/2,O[g]=(3*x[g]._y-O[C])/2;_=y;var B=g-b;for(w=c;_<=B;_++,w++){var F=r[w<0?w+a:w],V=F._point,j=A[_]-V._x,U=O[_]-V._y;(u||_<B)&&F.setHandleOut(j,U),(u||_>y)&&F.setHandleIn(-j,-U)}}else for(_=c;_<=h;_++)r[_<0?_+a:_].smooth(n,!u&&_===c,!u&&_===h)},toShape:function(t){if(!this._closed)return null;var e,n,i,r,a,o,l,u=this._segments;function c(t,e){var n=u[t],i=n.getNext(),r=u[e],a=r.getNext();return n._handleOut.isZero()&&i._handleIn.isZero()&&r._handleOut.isZero()&&a._handleIn.isZero()&&i._point.subtract(n._point).isCollinear(a._point.subtract(r._point))}function h(t){var e=u[t],n=e.getNext(),i=e._handleOut,r=n._handleIn,a=.5522847498307936;if(i.isOrthogonal(r)){var o=e._point,s=n._point,l=new M(o,i,!0).intersect(new M(s,r,!0),!0);return l&&g.isZero(i.getLength()/l.subtract(o).getLength()-a)&&g.isZero(r.getLength()/l.subtract(s).getLength()-a)}return!1}function d(t,e){return u[t]._point.getDistance(u[e]._point)}if(!this.hasHandles()&&4===u.length&&c(0,2)&&c(1,3)&&(a=u[1],o=a.getPrevious(),l=a.getNext(),o._handleOut.isZero()&&a._handleIn.isZero()&&a._handleOut.isZero()&&l._handleIn.isZero()&&a._point.subtract(o._point).isOrthogonal(l._point.subtract(a._point)))?(e=A.Rectangle,n=new x(d(0,3),d(0,1)),r=u[1]._point.add(u[2]._point).divide(2)):8===u.length&&h(0)&&h(2)&&h(4)&&h(6)&&c(1,5)&&c(3,7)?(e=A.Rectangle,i=(n=new x(d(1,6),d(0,3))).subtract(new x(d(0,7),d(1,2))).divide(2),r=u[3]._point.add(u[4]._point).divide(2)):4===u.length&&h(0)&&h(1)&&h(2)&&h(3)&&(g.isZero(d(0,2)-d(1,3))?(e=A.Circle,i=d(0,2)/2):(e=A.Ellipse,i=new x(d(2,0)/2,d(3,1)/2)),r=u[1]._point),e){var f=this.getPosition(!0),p=new e({center:f,size:n,radius:i,insert:!1});return p.copyAttributes(this,!0),p._matrix.prepend(this._matrix),p.rotate(r.subtract(f).getAngle()+90),(t===s||t)&&p.insertAbove(this),p}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof j)return t.base.call(this,e);var n=this.getCurves(),i=e.getCurves(),r=n.length,a=i.length;if(!r||!a)return r==a;for(var o,s,l=n[0].getValues(),u=[],c=0,h=0,d=0;d<a;d++){var f=i[d].getValues();if(u.push(f),g=z.getOverlaps(l,f)){o=!d&&g[0][0]>0?a-1:d,s=g[0][1];break}}var p,m=Math.abs;for(f=u[o];l&&f;){var g;if(g=z.getOverlaps(l,f))if(m(g[0][0]-h)<1e-8){1===(h=g[1][0])&&(l=++c<r?n[c].getValues():null,h=0);var v=g[0][1];if(m(v-s)<1e-8){if(p||(p=[o,v]),1===(s=g[1][1])&&(++o>=a&&(o=0),f=u[o]||i[o].getValues(),s=0),!l)return p[0]===o&&p[1]===s;continue}}break}return!1},_hitTestSelf:function(t,e,n,i){var r,a,o,s,l,u,c=this,h=this.getStyle(),d=this._segments,f=d.length,p=this._closed,m=e._tolerancePadding,g=m,v=e.stroke&&h.hasStroke(),y=e.fill&&h.hasFill(),b=e.curves,x=v?h.getStrokeWidth()/2:y&&e.tolerance>0||b?0:null;function _(e,n){return t.subtract(e).divide(n).length<=1}function w(t,n,i){if(!e.selected||n.isSelected()){var r=t._point;if(n!==r&&(n=n.add(r)),_(n,g))return new I(i,c,{segment:t,point:n})}}function S(t,n){return(n||e.segments)&&w(t,t._point,"segment")||!n&&e.handles&&(w(t,t._handleIn,"handle-in")||w(t,t._handleOut,"handle-out"))}function E(t){s.add(t)}function M(e){var n,l=p||e._index>0&&e._index<f-1;return"round"===(l?r:a)?_(e._point,g):(s=new V({internal:!0,closed:!0}),l?e.isSmooth()||V._addBevelJoin(e,r,x,o,null,i,E,!0):"square"===a&&V._addSquareCap(e,a,x,null,i,E,!0),s.isEmpty()?void 0:s.contains(t)||(n=s.getNearestLocation(t))&&_(n.getPoint(),m))}if(null!==x&&(x>0?(r=h.getStrokeJoin(),a=h.getStrokeCap(),o=h.getMiterLimit(),g=g.add(V._getStrokePadding(x,i))):r=a="round"),!e.ends||e.segments||p){if(e.segments||e.handles)for(var C=0;C<f;C++)if(u=S(d[C]))return u}else if(u=S(d[0],!0)||S(d[f-1],!0))return u;if(null!==x){if(l=this.getNearestLocation(t)){var T=l.getTime();0===T||1===T&&f>1?M(l.getSegment())||(l=null):_(l.getPoint(),g)||(l=null)}if(!l&&"miter"===r&&f>1)for(C=0;C<f;C++){var k=d[C];if(t.getDistance(k._point)<=o*x&&M(k)){l=k.getLocation();break}}}return!l&&y&&this._contains(t)||l&&!v&&!b?new I("fill",this):l?new I(v?"stroke":"curve",this,{location:l,point:l.getPoint()}):null}},c.each(z._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this.getLocationAt(e);return n&&n[t]()}}),{beans:!1,getLocationOf:function(){for(var t=y.read(arguments),e=this.getCurves(),n=0,i=e.length;n<i;n++){var r=e[n].getLocationOf(t);if(r)return r}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),n=0,i=0,r=e.length;i<r;i++){var a=n,o=e[i];if((n+=o.getLength())>t)return o.getLocationAt(t-a)}if(e.length>0&&t<=this.getLength())return new B(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=y.read(arguments);if(t.isZero())return[];for(var e=[],n=0,i=this.getCurves(),r=0,a=i.length;r<a;r++){for(var o=i[r],s=o.getTimesWithTangent(t),l=0,u=s.length;l<u;l++){var c=n+o.getOffsetAtTime(s[l]);e.indexOf(c)<0&&e.push(c)}n+=o.length}return e}}),new function(){function t(t,e,n){var i,r,a,o,s,l,u,c,h=e._segments,d=h.length,f=new Array(6),p=!0;function m(e){if(n)e._transformCoordinates(n,f),i=f[0],r=f[1];else{var h=e._point;i=h._x,r=h._y}if(p)t.moveTo(i,r),p=!1;else{if(n)s=f[2],l=f[3];else{var d=e._handleIn;s=i+d._x,l=r+d._y}s===i&&l===r&&u===a&&c===o?t.lineTo(i,r):t.bezierCurveTo(u,c,s,l,i,r)}if(a=i,o=r,n)u=f[4],c=f[5];else{d=e._handleOut;u=a+d._x,c=o+d._y}}for(var g=0;g<d;g++)m(h[g]);e._closed&&d>0&&m(h[0])}return{_draw:function(e,n,i,r){var a=n.dontStart,o=n.dontFinish||n.clip,s=this.getStyle(),l=s.hasFill(),u=s.hasStroke(),c=s.getDashArray(),h=!dt.support.nativeDash&&u&&c&&c.length;function d(t){return c[(t%h+h)%h]}if(a||e.beginPath(),(l||u&&!h||o)&&(t(e,this,r),this._closed&&e.closePath()),!o&&(l||u)&&(this._setStyles(e,n,i),l&&(e.fill(s.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),u)){if(h){a||e.beginPath();for(var f,p=new U(this,.25,32,!1,r),m=p.length,g=-s.getDashOffset(),v=0;g>0;)g-=d(v--)+d(v--);for(;g<m;)f=g+d(v++),(g>0||f>0)&&p.drawPart(e,Math.max(g,0),Math.max(f,0)),g=f+d(v++)}e.stroke()}},_drawSelected:function(e,n){e.beginPath(),t(e,this,n),e.stroke(),function(t,e,n,i){if(!(i<=0))for(var r,a,o=i/2,s=i-2,l=o-1,u=new Array(6),c=0,h=e.length;c<h;c++){var d=e[c],f=d._selection;if(d._transformCoordinates(n,u),r=u[0],a=u[1],2&f&&m(2),4&f&&m(4),t.fillRect(r-o,a-o,i,i),s>0&&!(1&f)){var p=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(r-l,a-l,s,s),t.fillStyle=p}}function m(e){var n=u[e],i=u[e+1];r==n&&a==i||(t.beginPath(),t.moveTo(r,a),t.lineTo(n,i),t.stroke(),t.beginPath(),t.arc(n,i,o,0,2*Math.PI,!0),t.fill())}}(e,this._segments,n,dt.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new N(y.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new N(y.read(arguments))])},cubicCurveTo:function(){var e=arguments,n=y.read(e),i=y.read(e),r=y.read(e),a=t(this);a.setHandleOut(n.subtract(a._point)),this._add([new N(r,i.subtract(r))])},quadraticCurveTo:function(){var e=arguments,n=y.read(e),i=y.read(e),r=t(this)._point;this.cubicCurveTo(n.add(r.subtract(n).multiply(1/3)),n.add(i.subtract(n).multiply(1/3)),i)},curveTo:function(){var e=arguments,n=y.read(e),i=y.read(e),r=c.pick(c.read(e),.5),a=1-r,o=t(this)._point,s=n.subtract(o.multiply(a*a)).subtract(i.multiply(r*r)).divide(2*r*a);if(s.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(s,i)},arcTo:function(){var e,n,i,r,a=arguments,o=Math.abs,s=Math.sqrt,l=t(this),u=l._point,h=y.read(a),d=c.peek(a);if("boolean"==typeof(b=c.pick(d,!0)))var f=(w=u.add(h).divide(2)).add(w.subtract(u).rotate(b?-90:90));else if(c.remain(a)<=2)f=h,h=y.read(a);else if(!u.equals(h)){var p=x.read(a),m=g.isZero;if(m(p.width)||m(p.height))return this.lineTo(h);var v=c.read(a),b=!!c.read(a),_=!!c.read(a),w=u.add(h).divide(2),S=(Q=u.subtract(w).rotate(-v)).x,C=Q.y,T=o(p.width),k=o(p.height),P=T*T,A=k*k,O=S*S,L=C*C,R=s(O/P+L/A);if(R>1&&(P=(T*=R)*T,A=(k*=R)*k),o(R=(P*A-P*L-A*O)/(P*L+A*O))<1e-12&&(R=0),R<0)throw new Error("Cannot create an arc with the given arguments");e=new y(T*C/k,-k*S/T).multiply((_===b?-1:1)*s(R)).rotate(v).add(w),n=(i=(r=(new E).translate(e).rotate(v).scale(T,k))._inverseTransform(u)).getDirectedAngle(r._inverseTransform(h)),!b&&n>0?n-=360:b&&n<0&&(n+=360)}if(f){var I=new M(u.add(f).divide(2),f.subtract(u).rotate(90),!0),D=new M(f.add(h).divide(2),h.subtract(f).rotate(90),!0),z=new M(u,h),B=z.getSide(f);if(!(e=I.intersect(D,!0))){if(!B)return this.lineTo(h);throw new Error("Cannot create an arc with the given arguments")}n=(i=u.subtract(e)).getDirectedAngle(h.subtract(e));var F=z.getSide(e,!0);0===F?n=B*o(n):B===F&&(n+=n<0?360:-360)}if(n){for(var V=1e-7,j=o(n),U=j>=360?4:Math.ceil((j-V)/90),H=n/U,G=H*Math.PI/360,W=4/3*Math.sin(G)/(1+Math.cos(G)),q=[],$=0;$<=U;$++){var Q=h,Y=null;if($<U&&(Y=i.rotate(90).multiply(W),r?(Q=r._transformPoint(i),Y=r._transformPoint(i.add(Y)).subtract(Q)):Q=e.add(i)),$){var X=i.rotate(-90).multiply(W);r&&(X=r._transformPoint(i.add(X)).subtract(Q)),q.push(new N(Q,X,Y))}else l.setHandleOut(Y);i=i.rotate(H)}this._add(q)}},lineBy:function(){var e=y.read(arguments),n=t(this)._point;this.lineTo(n.add(e))},curveBy:function(){var e=arguments,n=y.read(e),i=y.read(e),r=c.read(e),a=t(this)._point;this.curveTo(a.add(n),a.add(i),r)},cubicCurveBy:function(){var e=arguments,n=y.read(e),i=y.read(e),r=y.read(e),a=t(this)._point;this.cubicCurveTo(a.add(n),a.add(i),a.add(r))},quadraticCurveBy:function(){var e=arguments,n=y.read(e),i=y.read(e),r=t(this)._point;this.quadraticCurveTo(r.add(n),r.add(i))},arcBy:function(){var e=arguments,n=t(this)._point,i=n.add(y.read(e)),r=c.pick(c.peek(e),!0);"boolean"==typeof r?this.arcTo(i,r):this.arcTo(i,n.add(y.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){var n=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return V[n](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,n,i,r,a){var o=t[0];if(!o)return new w;var s=new Array(6),l=o._transformCoordinates(i,new Array(6)),u=l.slice(0,2),c=u.slice(),h=new Array(2);function d(t){t._transformCoordinates(i,s);for(var e=0;e<2;e++)z._addBounds(l[e],l[e+4],s[e+2],s[e],e,a?a[e]:0,u,c,h);var n=l;l=s,s=n}for(var f=1,p=t.length;f<p;f++)d(t[f]);return e&&d(o),new w(u[0],u[1],c[0]-u[0],c[1]-u[1])},getStrokeBounds:function(t,e,n,i,r){var a=n.getStyle(),o=a.hasStroke(),s=a.getStrokeWidth(),l=o&&n._getStrokeMatrix(i,r),u=o&&V._getStrokePadding(s,l),c=V.getBounds(t,e,n,i,r,u);if(!o)return c;var h=s/2,d=a.getStrokeJoin(),f=a.getStrokeCap(),p=a.getMiterLimit(),m=new w(new x(u));function g(t){c=c.include(t)}function v(t){c=c.unite(m.setCenter(t._point.transform(i)))}function y(t,e){"round"===e||t.isSmooth()?v(t):V._addBevelJoin(t,e,h,p,i,l,g)}function b(t,e){"round"===e?v(t):V._addSquareCap(t,e,h,i,l,g)}var _=t.length-(e?0:1);if(_>0){for(var S=1;S<_;S++)y(t[S],d);e?y(t[0],d):(b(t[0],f),b(t[t.length-1],f))}return c},_getStrokePadding:function(t,e){if(!e)return[t,t];var n=new y(t,0).transform(e),i=new y(0,t).transform(e),r=n.getAngleInRadians(),a=n.getLength(),o=i.getLength(),s=Math.sin(r),l=Math.cos(r),u=Math.tan(r),c=Math.atan2(o*u,a),h=Math.atan2(o,u*a);return[Math.abs(a*Math.cos(c)*l+o*Math.sin(c)*s),Math.abs(o*Math.sin(h)*l+a*Math.cos(h)*s)]},_addBevelJoin:function(t,e,n,i,r,a,o,s){var l=t.getCurve(),u=l.getPrevious(),c=l.getPoint1().transform(r),h=u.getNormalAtTime(1).multiply(n).transform(a),d=l.getNormalAtTime(0).multiply(n).transform(a),f=h.getDirectedAngle(d);if((f<0||f>=180)&&(h=h.negate(),d=d.negate()),s&&o(c),o(c.add(h)),"miter"===e){var p=new M(c.add(h),new y(-h.y,h.x),!0).intersect(new M(c.add(d),new y(-d.y,d.x),!0),!0);p&&c.getDistance(p)<=i*n&&o(p)}o(c.add(d))},_addSquareCap:function(t,e,n,i,r,a,o){var s=t._point.transform(i),l=t.getLocation(),u=l.getNormal().multiply(0===l.getTime()?n:-n).transform(r);"square"===e&&(o&&(a(s.subtract(u)),a(s.add(u))),s=s.add(u.rotate(-90))),a(s.add(u)),a(s.subtract(u))},getHandleBounds:function(t,e,n,i,r){var a,o,s=n.getStyle();if(r.stroke&&s.hasStroke()){var l=n._getStrokeMatrix(i,r),u=s.getStrokeWidth()/2,c=u;"miter"===s.getStrokeJoin()&&(c=u*s.getMiterLimit()),"square"===s.getStrokeCap()&&(c=Math.max(c,u*Math.SQRT2)),a=V._getStrokePadding(u,l),o=V._getStrokePadding(c,l)}for(var h=new Array(6),d=1/0,f=-d,p=d,m=f,g=0,v=t.length;g<v;g++){t[g]._transformCoordinates(i,h);for(var y=0;y<6;y+=2){var b=y?a:o,x=b?b[0]:0,_=b?b[1]:0,S=h[y],E=h[y+1],M=S-x,C=S+x,T=E-_,k=E+_;M<d&&(d=M),C>f&&(f=C),T<p&&(p=T),k>m&&(m=k)}}return new w(d,p,f-d,m-p)}}});V.inject({statics:new function(){var t=.5522847498307936,e=[new N([-1,0],[0,t],[0,-t]),new N([0,-1],[-t,0],[t,0]),new N([1,0],[0,-t],[0,t]),new N([0,1],[t,0],[-t,0])];function n(t,e,n){var i=c.getNamed(n),r=new V(i&&0==i.insert&&T.NO_INSERT);return r._add(t),r._closed=e,r.set(i,{insert:!0})}function i(t,i,r){for(var a=new Array(4),o=0;o<4;o++){var s=e[o];a[o]=new N(s._point.multiply(i).add(t),s._handleIn.multiply(i),s._handleOut.multiply(i))}return n(a,!0,r)}return{Line:function(){var t=arguments;return n([new N(y.readNamed(t,"from")),new N(y.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,e=y.readNamed(t,"center"),n=c.readNamed(t,"radius");return i(e,new x(n),t)},Rectangle:function(){var e,i=arguments,r=w.readNamed(i,"rectangle"),a=x.readNamed(i,"radius",0,{readNull:!0}),o=r.getBottomLeft(!0),s=r.getTopLeft(!0),l=r.getTopRight(!0),u=r.getBottomRight(!0);if(!a||a.isZero())e=[new N(o),new N(s),new N(l),new N(u)];else{var c=(a=x.min(a,r.getSize(!0).divide(2))).width,h=a.height,d=c*t,f=h*t;e=[new N(o.add(c,0),null,[-d,0]),new N(o.subtract(0,h),[0,f]),new N(s.add(0,h),null,[0,-f]),new N(s.add(c,0),[-d,0],null),new N(l.subtract(c,0),null,[d,0]),new N(l.add(0,h),[0,-f],null),new N(u.subtract(0,h),null,[0,f]),new N(u.subtract(c,0),[d,0])]}return n(e,!0,i)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=A._readEllipse(t);return i(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=y.readNamed(t,"from"),n=y.readNamed(t,"through"),i=y.readNamed(t,"to"),r=c.getNamed(t),a=new V(r&&0==r.insert&&T.NO_INSERT);return a.moveTo(e),a.arcTo(n,i),a.set(r)},RegularPolygon:function(){for(var t=arguments,e=y.readNamed(t,"center"),i=c.readNamed(t,"sides"),r=c.readNamed(t,"radius"),a=360/i,o=i%3==0,s=new y(0,o?-r:r),l=o?-1:.5,u=new Array(i),h=0;h<i;h++)u[h]=new N(e.add(s.rotate((h+l)*a)));return n(u,!0,t)},Star:function(){for(var t=arguments,e=y.readNamed(t,"center"),i=2*c.readNamed(t,"points"),r=c.readNamed(t,"radius1"),a=c.readNamed(t,"radius2"),o=360/i,s=new y(0,-1),l=new Array(i),u=0;u<i;u++)l[u]=new N(e.add(s.rotate(o*u).multiply(u%2?a:r)));return n(l,!0,t)}}}});var j=F.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,n){var i=n,r=i[0];r&&"number"==typeof r[0]&&(i=[i]);for(var a=n.length-1;a>=0;a--){var o=i[a];i!==n||o instanceof V||(i=c.slice(i)),Array.isArray(o)?i[a]=new V({segments:o,insert:!1}):o instanceof j&&(i.splice.apply(i,[a,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,i)},reduce:function t(e){for(var n=this._children,i=n.length-1;i>=0;i--){var r;(r=n[i].reduce(e)).isEmpty()&&r.remove()}return n.length?t.base.call(this):((r=new V(T.NO_INSERT)).copyAttributes(this),r.insertAbove(this),this.remove(),r)},isClosed:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,n=0,i=e.length;n<i;n++)e[n].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],n=0,i=t.length;n<i;n++)c.push(e,t[n].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,n=0,i=t.length;n<i;n++)e+=t[n].getArea();return e},getLength:function(){for(var t=this._children,e=0,n=0,i=t.length;n<i;n++)e+=t[n].getLength();return e},getPathData:function(t,e){for(var n=this._children,i=[],r=0,a=n.length;r<a;r++){var o=n[r],s=o._matrix;i.push(o.getPathData(t&&!s.isIdentity()?t.appended(s):t,e))}return i.join("")},_hitTestChildren:function t(e,n,i){return t.base.call(this,e,n.class===V||"path"===n.type?n:c.set({},n,{fill:!1}),i)},_draw:function(t,e,n,i){var r=this._children;if(r.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var a=0,o=r.length;a<o;a++)r[a].draw(t,e,i);if(!e.clip){this._setStyles(t,e,n);var s=this._style;s.hasFill()&&(t.fill(s.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),s.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,n){for(var i=this._children,r=0,a=i.length;r<a;r++){var o=i[r],s=o._matrix;n[o._id]||o._drawSelected(t,s.isIdentity()?e:e.appended(s))}}},new function(){function t(t,e){var n=t._children;if(e&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return c.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],(function(e){this[e]=function(){var n=t(this,!0);n[e].apply(n,arguments)}}),{moveTo:function(){var e=t(this),n=e&&e.isEmpty()?e:new V(T.NO_INSERT);n!==e&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var e=t(this,!0),n=e&&e.getLastSegment(),i=y.read(arguments);this.moveTo(n?i.add(n._point):i)},closePath:function(e){t(this,!0).closePath(e)}})},c.each(["reverse","flatten","simplify","smooth"],(function(t){this[t]=function(e){for(var n,i=this._children,r=0,a=i.length;r<a;r++)n=i[r][t](e)||n;return n}}),{}));F.inject(new function(){var t=Math.min,e=Math.max,n=Math.abs,i={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function r(t){return t._children||[t]}function a(t,e){var n=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var i=r(n),a=0,o=i.length;a<o;a++){(t=i[a])._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0))}n=n.resolveCrossings().reorient("nonzero"===n.getFillRule(),!0)}return n}function o(t,e,n,i,r){var a=new j(T.NO_INSERT);return a.addChildren(t,!0),a=a.reduce({simplify:e}),r&&0==r.insert||a.insertAbove(i&&n.isSibling(i)&&n.getIndex()<i.getIndex()?i:n),a.copyAttributes(n,!0),a}function l(t){return t.hasOverlap()||t.isCrossing()}function u(t,e,n,s){if(s&&(0==s.trace||s.stroke)&&/^(subtract|intersect)$/.test(n))return h(t,e,n);var u=a(t,!0),d=e&&t!==e&&a(e,!0),f=i[n];f[n]=!0,d&&(f.subtract||f.exclude)^d.isClockwise()^u.isClockwise()&&d.reverse();var g,y=v(B.expand(u.getIntersections(d,l))),_=r(u),w=d&&r(d),S=[],E=[];function M(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];c.push(S,i._segments),c.push(E,i.getCurves()),i._overlapsOnly=!0}}function C(t){for(var e=[],n=0,i=t&&t.length;n<i;n++)e.push(E[t[n]]);return e}if(y.length){M(_),w&&M(w);for(var T=new Array(E.length),k=0,P=E.length;k<P;k++)T[k]=E[k].getValues();var A=p.findCurveBoundsCollisions(T,T,0,!0),O={};for(k=0;k<E.length;k++){var L=E[k],R=L._path._id;(O[R]=O[R]||{})[L.getIndex()]={hor:C(A[k].hor),ver:C(A[k].ver)}}for(k=0,P=y.length;k<P;k++)b(y[k]._segment,u,d,O,f);for(k=0,P=S.length;k<P;k++){var I=S[k],N=I._intersection;I._winding||b(I,u,d,O,f),N&&N._overlap||(I._path._overlapsOnly=!1)}g=x(S,f)}else g=m(w?_.concat(w):_.slice(),(function(t){return!!f[t]}));return o(g,!0,t,e,s)}function h(t,e,n){var i=a(t),r=a(e),s=i.getIntersections(r,l),u="subtract"===n,c="divide"===n,h={},d=[];function f(t){if(!h[t._id]&&(c||r.contains(t.getPointAt(t.getLength()/2))^u))return d.unshift(t),h[t._id]=!0}for(var p=s.length-1;p>=0;p--){var m=s[p].split();m&&(f(m)&&m.getFirstSegment().setHandleIn(0,0),i.getLastSegment().setHandleOut(0,0))}return f(i),o(d,!1,t,e)}function d(t,e){for(var n=t;n;){if(n===e)return;n=n._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function f(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function m(t,e,i){var r=t&&t.length;if(r){var a=c.each(t,(function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}}),{}),o=t.slice().sort((function(t,e){return n(e.getArea())-n(t.getArea())})),s=o[0],l=p.findItemBoundsCollisions(o,null,g.GEOMETRIC_EPSILON);null==i&&(i=s.isClockwise());for(var u=0;u<r;u++){var h=o[u],d=a[h._id],f=0,m=l[u];if(m)for(var v=null,y=m.length-1;y>=0;y--)if(m[y]<u){v=v||h.getInteriorPoint();var b=o[m[y]];if(b.contains(v)){var x=a[b._id];f=x.winding,d.winding+=f,d.container=x.exclude?x.container:b;break}}if(e(d.winding)===e(f))d.exclude=!0,t[d.index]=null;else{var _=d.container;h.setClockwise(_?!_.isClockwise():i)}}}return t}function v(t,e,n){var i,r,a,o=e&&[],s=!1,l=n||[],u=n&&{};function c(t){return t._path._id+"."+t._segment1._index}for(var h=(n&&n.length)-1;h>=0;h--){(p=n[h])._path&&(u[c(p)]=!0)}for(h=t.length-1;h>=0;h--){var p,m,g=t[h],v=g._time,y=v,b=e&&!e(g);if((p=g._curve)&&(p!==r?(s=!p.hasHandles()||u&&u[c(p)],i=[],a=null,r=p):a>=1e-8&&(v/=a)),b)i&&i.push(g);else{if(e&&o.unshift(g),a=y,v<1e-8)m=p._segment1;else if(v>1-1e-8)m=p._segment2;else{var x=p.divideAtTime(v,!0);s&&l.push(p,x),m=x._segment1;for(var _=i.length-1;_>=0;_--){var w=i[_];w._time=(w._time-v)/(1-v)}}g._setSegment(m);var S=m._intersection,E=g._intersection;if(S){d(S,E);for(var M=S;M;)d(M._intersection,S),M=M._next}else m._intersection=E}}return n||f(l),o||t}function y(i,r,a,o,s){var l,u,c=Array.isArray(r)?r:r[a?"hor":"ver"],h=a?1:0,d=1^h,f=[i.x,i.y],p=f[h],m=f[d],g=p-1e-9,v=p+1e-9,b=0,x=0,_=0,w=0,S=!1,E=!1,M=1,C=[];function T(n){var u=n[d+0],c=n[d+6];if(!(m<t(u,c)||m>e(u,c))){var f=n[h+0],b=n[h+2],x=n[h+4],E=n[h+6];if(u!==c){var T=m===u?0:m===c||g>e(f,b,x,E)||v<t(f,b,x,E)?1:z.solveCubic(n,d,m,C,0,1)>0?C[0]:1,k=0===T?f:1===T?E:z.getPoint(n,T)[a?"y":"x"],P=u>c?1:-1,A=l[d]>l[d+6]?1:-1,O=l[h+6];return m!==u?(k<g?_+=P:k>v?w+=P:S=!0,k>p-1e-6&&k<p+1e-6&&(M/=2)):(P!==A?f<g?_+=P:f>v&&(w+=P):f!=O&&(O<v&&k>v?(w+=P,S=!0):O>g&&k<g&&(_+=P,S=!0)),M/=4),l=n,!s&&k>g&&k<v&&0===z.getTangent(n,T)[a?"x":"y"]&&y(i,r,!a,o,!0)}(f<v&&E>g||E<v&&f>g)&&(S=!0)}}function k(n){var i=n[d+0],r=n[d+2],o=n[d+4],s=n[d+6];if(m<=e(i,r,o,s)&&m>=t(i,r,o,s))for(var l,u=n[h+0],c=n[h+2],f=n[h+4],p=n[h+6],y=g>e(u,c,f,p)||v<t(u,c,f,p)?[n]:z.getMonoCurves(n,a),b=0,x=y.length;b<x;b++)if(l=T(y[b]))return l}for(var P=0,A=c.length;P<A;P++){var O,L=c[P],R=L._path,I=L.getValues();if(!(P&&c[P-1]._path===R||(l=null,R._closed||(u=z.getValues(R.getLastCurve().getSegment2(),L.getSegment1(),null,!o))[d]!==u[d+6]&&(l=u),l))){l=I;for(var N=R.getLastCurve();N&&N!==L;){var D=N.getValues();if(D[d]!==D[d+6]){l=D;break}N=N.getPrevious()}}if(O=k(I))return O;if(P+1===A||c[P+1]._path!==R){if(u&&(O=k(u)))return O;!S||_||w||(_=w=R.isClockwise(o)^a?1:-1),b+=_,x+=w,_=w=0,S&&(E=!0,S=!1),u=null}}return b=n(b),x=n(x),{winding:e(b,x),windingL:b,windingR:x,quality:M,onPath:E}}function b(t,e,i,r,a){var o=[],s=t,l=0;do{if(b=t.getCurve()){var u=b.getLength();o.push({segment:t,curve:b,length:u}),l+=u}t=t.getNext()}while(t&&!t._intersection&&t!==s);for(var c=[.5,.25,.75],h={winding:0,quality:-1},d=0;d<c.length&&h.quality<.5;d++){u=l*c[d];for(var f=0,p=o.length;f<p;f++){var m=o[f],v=m.length;if(u<=v){var b,x=(b=m.curve)._path,_=x._parent,w=_ instanceof j?_:x,S=g.clamp(b.getTimeAt(u),.001,.999),E=b.getPointAtTime(S),M=n(b.getTangentAtTime(S).y)<Math.SQRT1_2,C=null;if(a.subtract&&i){var T=(w===e?i:e)._getWinding(E,M,!0);if(w===e&&T.winding||w===i&&!T.winding){if(T.quality<1)continue;C={winding:0,quality:1}}}(C=C||y(E,r[x._id][b.getIndex()],M,!0)).quality>h.quality&&(h=C);break}u-=v}}for(f=o.length-1;f>=0;f--)o[f].segment._winding=h}function x(t,e){var n,i=[];function r(t){var n;return!(!t||t._visited||e&&(!e[(n=t._winding||{}).winding]||e.unite&&2===n.winding&&n.windingL&&n.windingR))}function a(t){if(t)for(var e=0,i=n.length;e<i;e++)if(t===n[e])return!0;return!1}function o(t){for(var e=t._segments,n=0,i=e.length;n<i;n++)e[n]._visited=!0}function s(t,e){var i=t._intersection,o=i,s=[];function l(i,o){for(;i&&i!==o;){var l=i._segment,u=l&&l._path;if(u){var c=l.getNext()||u.getFirstSegment(),h=c._intersection;l!==t&&(a(l)||a(c)||c&&r(l)&&(r(c)||h&&r(h._segment)))&&s.push(l),e&&n.push(l)}i=i._next}}if(e&&(n=[t]),i){for(l(i);i&&i._previous;)i=i._previous;l(i,o)}return s}t.sort((function(t,e){var n=t._intersection,i=e._intersection,r=!(!n||!n._overlap),a=!(!i||!i._overlap),o=t._path,s=e._path;return r^a?r?1:-1:!n^!i?n?1:-1:o!==s?o._id-s._id:t._index-e._index}));for(var l=0,u=t.length;l<u;l++){var c,h,d,f=t[l],p=r(f),m=null,g=!1,v=!0,y=[];if(p&&f._path._overlapsOnly){var b=f._path,x=f._intersection._segment._path;b.compare(x)&&(b.getArea()&&i.push(b.clone(!1)),o(b),o(x),p=!1)}for(;p;){var _=!m,w=s(f,_),S=w.shift(),E=!(g=!_&&(a(f)||a(S)))&&S;if(_&&(m=new V(T.NO_INSERT),c=null),g){(f.isFirst()||f.isLast())&&(v=f._path._closed),f._visited=!0;break}if(E&&c&&(y.push(c),c=null),c||(E&&w.push(f),c={start:m._segments.length,crossings:w,visited:h=[],handleIn:d}),E&&(f=S),!r(f)){m.removeSegments(c.start);for(var M=0,C=h.length;M<C;M++)h[M]._visited=!1;h.length=0;do{(f=c&&c.crossings.shift())&&f._path||(f=null,(c=y.pop())&&(h=c.visited,d=c.handleIn))}while(c&&!r(f));if(!f)break}var k=f.getNext();m.add(new N(f._point,d,k&&f._handleOut)),f._visited=!0,h.push(f),f=k||f._path.getFirstSegment(),d=k&&k._handleIn}g&&(v&&(m.getFirstSegment().setHandleIn(d),m.setClosed(v)),0!==m.getArea()&&i.push(m))}return i}return{_getWinding:function(t,e,n){return y(t,this.getCurves(),e,n)},unite:function(t,e){return u(this,t,"unite",e)},intersect:function(t,e){return u(this,t,"intersect",e)},subtract:function(t,e){return u(this,t,"subtract",e)},exclude:function(t,e){return u(this,t,"exclude",e)},divide:function(t,e){return e&&(0==e.trace||e.stroke)?h(this,t,"divide"):o([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function n(t,e){var n=t&&t._intersection;return n&&n._overlap&&n._path===e}var i=!1,r=!1,a=this.getIntersections(null,(function(t){return t.hasOverlap()&&(i=!0)||t.isCrossing()&&(r=!0)})),o=i&&r&&[];if(a=B.expand(a),i)for(var s=v(a,(function(t){return t.hasOverlap()}),o),l=s.length-1;l>=0;l--){var u=s[l],h=u._path,d=u._segment,p=d.getPrevious(),m=d.getNext();n(p,h)&&n(m,h)&&(d.remove(),p._handleOut._set(0,0),m._handleIn._set(0,0),p===d||p.getCurve().hasLength()||(m._handleIn.set(p._handleIn),p.remove()))}r&&(v(a,i&&function(t){var e=t.getCurve(),n=t.getSegment(),i=t._intersection,r=i._curve,a=i._segment;if(e&&r&&e._path&&r._path)return!0;n&&(n._intersection=null),a&&(a._intersection=null)},o),o&&f(o),e=x(c.each(e,(function(t){c.push(this,t._segments)}),[])));var g,y=e.length;return y>1&&t?(e!==t&&this.setChildren(e),g=this):1!==y||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),g=this),g||((g=new j(T.NO_INSERT)).addChildren(e),(g=g.reduce()).copyAttributes(this),this.replaceWith(g)),g},reorient:function(t,e){var n=this._children;return n&&n.length?this.setChildren(m(this.removeChildren(),(function(e){return!!(t?e:1&e)}),e)):e!==s&&this.setClockwise(e),this},getInteriorPoint:function(){var n=this.getBounds().getCenter(!0);if(!this.contains(n)){for(var i=this.getCurves(),r=n.y,a=[],o=[],s=0,l=i.length;s<l;s++){var u=i[s].getValues(),c=u[1],h=u[3],d=u[5],f=u[7];if(r>=t(c,h,d,f)&&r<=e(c,h,d,f))for(var p=z.getMonoCurves(u),m=0,g=p.length;m<g;m++){var v=p[m],y=v[1],b=v[7];if(y!==b&&(r>=y&&r<=b||r>=b&&r<=y)){var x=r===y?v[0]:r===b?v[6]:1===z.solveCubic(v,1,r,o,0,1)?z.getPoint(v,o[0]).x:(v[0]+v[6])/2;a.push(x)}}}a.length>1&&(a.sort((function(t,e){return t-e})),n.x=(a[0]+a[1])/2)}return n}}});var U=c.extend({_class:"PathFlattener",initialize:function(t,e,n,i,r){var a,o=[],s=[],l=0,u=1/(n||32),c=t._segments,h=c[0];function d(t,n){var a=z.getValues(t,n,r);o.push(a),function t(n,r,a,o){if(!(o-a>u)||i&&z.isStraight(n)||z.isFlatEnough(n,e||.25)){var c=n[6]-n[0],h=n[7]-n[1],d=Math.sqrt(c*c+h*h);d>0&&(l+=d,s.push({offset:l,curve:n,index:r,time:o}))}else{var f=z.subdivide(n,.5),p=(a+o)/2;t(f[0],r,a,p),t(f[1],r,p,o)}}(a,t._index,0,1)}for(var f=1,p=c.length;f<p;f++)d(h,a=c[f]),h=a;t._closed&&d(a||h,c[0]),this.curves=o,this.parts=s,this.length=l,this.index=0},_get:function(t){for(var e,n=this.parts,i=n.length,r=this.index;e=r,r&&!(n[--r].offset<t););for(;e<i;e++){var a=n[e];if(a.offset>=t){this.index=e;var o=n[e-1],s=o&&o.index===a.index?o.time:0,l=o?o.offset:0;return{index:a.index,time:s+(a.time-s)*(t-l)/(a.offset-l)}}}return{index:n[i-1].index,time:1}},drawPart:function(t,e,n){for(var i=this._get(e),r=this._get(n),a=i.index,o=r.index;a<=o;a++){var s=z.getPart(this.curves[a],a===i.index?i.time:0,a===r.index?r.time:1);a===i.index&&t.moveTo(s[0],s[1]),t.bezierCurveTo.apply(t,s.slice(2))}}},c.each(z._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this._get(e);return z[t](this.curves[n.index],n.time)}}),{})),H=c.extend({initialize:function(t){for(var e,n=this.points=[],i=t._segments,r=t._closed,a=0,o=i.length;a<o;a++){var s=i[a].point;e&&e.equals(s)||n.push(e=s.clone())}r&&(n.unshift(n[n.length-1]),n.push(n[1])),this.closed=r},fit:function(t){var e=this.points,n=e.length,i=null;return n>0&&(i=[new N(e[0])],n>1&&(this.fitCubic(i,t,0,n-1,e[1].subtract(e[0]),e[n-2].subtract(e[n-1])),this.closed&&(i.shift(),i.pop()))),i},fitCubic:function(t,e,n,i,r,a){var o=this.points;if(i-n!=1){for(var s,l=this.chordLengthParameterize(n,i),u=Math.max(e,e*e),c=!0,h=0;h<=4;h++){var d=this.generateBezier(n,i,l,r,a),f=this.findMaxError(n,i,d,l);if(f.error<e&&c)return void this.addCurve(t,d);if(s=f.index,f.error>=u)break;c=this.reparameterize(n,i,l,d),u=f.error}var p=o[s-1].subtract(o[s+1]);this.fitCubic(t,e,n,s,r,p),this.fitCubic(t,e,s,i,p.negate(),a)}else{var m=o[n],g=o[i],v=m.getDistance(g)/3;this.addCurve(t,[m,m.add(r.normalize(v)),g.add(a.normalize(v)),g])}},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new N(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,n,i,r){for(var a=Math.abs,o=this.points,s=o[t],l=o[e],u=[[0,0],[0,0]],c=[0,0],h=0,d=e-t+1;h<d;h++){var f=n[h],p=1-f,m=3*f*p,g=p*p*p,v=m*p,y=m*f,b=f*f*f,x=i.normalize(v),_=r.normalize(y),w=o[t+h].subtract(s.multiply(g+v)).subtract(l.multiply(y+b));u[0][0]+=x.dot(x),u[0][1]+=x.dot(_),u[1][0]=u[0][1],u[1][1]+=_.dot(_),c[0]+=x.dot(w),c[1]+=_.dot(w)}var S,E,M=u[0][0]*u[1][1]-u[1][0]*u[0][1];if(a(M)>1e-12){var C=u[0][0]*c[1]-u[1][0]*c[0];S=(c[0]*u[1][1]-c[1]*u[0][1])/M,E=C/M}else{var T=u[0][0]+u[0][1],k=u[1][0]+u[1][1];S=E=a(T)>1e-12?c[0]/T:a(k)>1e-12?c[1]/k:0}var P,A,O=l.getDistance(s),L=1e-12*O;if(S<L||E<L)S=E=O/3;else{var R=l.subtract(s);P=i.normalize(S),A=r.normalize(E),P.dot(R)-A.dot(R)>O*O&&(S=E=O/3,P=A=null)}return[s,s.add(P||i.normalize(S)),l.add(A||r.normalize(E)),l]},reparameterize:function(t,e,n,i){for(var r=t;r<=e;r++)n[r-t]=this.findRoot(i,this.points[r],n[r-t]);r=1;for(var a=n.length;r<a;r++)if(n[r]<=n[r-1])return!1;return!0},findRoot:function(t,e,n){for(var i=[],r=[],a=0;a<=2;a++)i[a]=t[a+1].subtract(t[a]).multiply(3);for(a=0;a<=1;a++)r[a]=i[a+1].subtract(i[a]).multiply(2);var o=this.evaluate(3,t,n),s=this.evaluate(2,i,n),l=this.evaluate(1,r,n),u=o.subtract(e),c=s.dot(s)+u.dot(l);return g.isMachineZero(c)?n:n-u.dot(s)/c},evaluate:function(t,e,n){for(var i=e.slice(),r=1;r<=t;r++)for(var a=0;a<=t-r;a++)i[a]=i[a].multiply(1-n).add(i[a+1].multiply(n));return i[0]},chordLengthParameterize:function(t,e){for(var n=[0],i=t+1;i<=e;i++)n[i-t]=n[i-t-1]+this.points[i].getDistance(this.points[i-1]);i=1;for(var r=e-t;i<=r;i++)n[i]/=n[r];return n},findMaxError:function(t,e,n,i){for(var r=Math.floor((e-t+1)/2),a=0,o=t+1;o<e;o++){var s=this.evaluate(3,n,i[o-t]).subtract(this.points[o]),l=s.x*s.x+s.y*s.y;l>=a&&(a=l,r=o)}return{error:a,index:r}}}),G=T.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var e=t&&c.isPlainObject(t)&&t.x===s&&t.y===s;this._initialize(e&&t,!e&&y.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),W=G.extend({_class:"PointText",initialize:function(){G.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new b(t.x,t.y,this,"setPoint")},setPoint:function(){var t=y.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,n){if(this._content){this._setStyles(t,e,n);var i=this._lines,r=this._style,a=r.hasFill(),o=r.hasStroke(),s=r.getLeading(),l=t.shadowColor;t.font=r.getFontStyle(),t.textAlign=r.getJustification();for(var u=0,c=i.length;u<c;u++){t.shadowColor=l;var h=i[u];a&&(t.fillText(h,0,0),t.shadowColor="rgba(0,0,0,0)"),o&&t.strokeText(h,0,0),t.translate(0,s)}}},_getBounds:function(t,e){var n=this._style,i=this._lines,r=i.length,a=n.getJustification(),o=n.getLeading(),s=this.getView().getTextWidth(n.getFontStyle(),i),l=0;"left"!==a&&(l-=s/("center"===a?2:1));var u=new w(l,r?-.75*o:0,s,r*o);return t?t._transformBounds(u,u):u}}),q=c.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},n={},i={transparent:[0,0,0,0]};function r(e){var n,r=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),a="rgb";if(r){var o=r[4]?4:3;n=new Array(o);for(var s=0;s<o;s++){var u=r[s+1];n[s]=parseInt(1==u.length?u+u:u,16)/255}}else if(r=e.match(/^(rgb|hsl)a?\((.*)\)$/)){a=r[1],n=r[2].trim().split(/[,\s]+/g);for(var c="hsl"===a,h=(s=0,Math.min(n.length,4));s<h;s++){var d=n[s];u=parseFloat(d);if(c)if(0===s){var f=d.match(/([a-z]*)$/)[1];u*={turn:360,rad:180/Math.PI,grad:.9}[f]||1}else s<3&&(u/=100);else s<3&&(u/=/%$/.test(d)?100:255);n[s]=u}}else{var p=i[e];if(!p)if(l){t||((t=lt.getContext(1,1)).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var m=t.getImageData(0,0,1,1).data;p=i[e]=[m[0]/255,m[1]/255,m[2]/255]}else p=[0,0,0];n=p.slice()}return[a,n]}var a=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(t,e,n){var i=Math.max(t,e,n),r=i-Math.min(t,e,n);return[0===r?0:60*(i==t?(e-n)/r+(e<n?6:0):i==e?(n-t)/r+2:(t-e)/r+4),0===i?0:r/i,i]},"hsb-rgb":function(t,e,n){var i,r=(t=(t/60%6+6)%6)-(i=Math.floor(t)),o=[n,n*(1-e),n*(1-e*r),n*(1-e*(1-r))];return[o[(i=a[i])[0]],o[i[1]],o[i[2]]]},"rgb-hsl":function(t,e,n){var i=Math.max(t,e,n),r=Math.min(t,e,n),a=i-r,o=0===a,s=(i+r)/2;return[o?0:60*(i==t?(e-n)/a+(e<n?6:0):i==e?(n-t)/a+2:(t-e)/a+4),o?0:s<.5?a/(i+r):a/(2-i-r),s]},"hsl-rgb":function(t,e,n){if(0===e)return[n,n,n];for(var i=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],r=n<.5?n*(1+e):n+e-n*e,a=2*n-r,o=[],s=0;s<3;s++){var l=i[s];l<0&&(l+=1),l>1&&(l-=1),o[s]=6*l<1?a+6*(r-a)*l:2*l<1?r:3*l<2?a+(r-a)*(2/3-l)*6:a}return o},"rgb-gray":function(t,e,n){return[.2989*t+.587*e+.114*n]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return c.each(e,(function(t,i){n[i]=[],c.each(t,(function(t,r){var a=c.capitalize(t),o=/^(hue|saturation)$/.test(t),s=n[i][r]="gradient"===i?"gradient"===t?function(t){var e=this._components[0];return e!==(t=$.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return y.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+a]=function(){return this._type===i||o&&/^hs[bl]$/.test(this._type)?this._components[r]:this._convert(i)[r]},this["set"+a]=function(t){this._type===i||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(i),this._properties=e[i],this._type=i),this._components[r]=s.call(this,t),this._changed()}}),this)}),{_class:"Color",_readIndex:!0,initialize:function t(i){var a,o,s,l,u=arguments,h=this.__read,d=0;Array.isArray(i)&&(i=(u=i)[0]);var f=null!=i&&typeof i;if("string"===f&&i in e&&(a=i,i=u[1],Array.isArray(i)?(o=i,s=u[2]):(h&&(d=1),u=c.slice(u,1),f=typeof i)),!o){if(l="number"===f?u:"object"===f&&null!=i.length?i:null){a||(a=l.length>=3?"rgb":"gray");var p=e[a].length;s=l[p],h&&(d+=l===arguments?p+(null!=s?1:0):1),l.length>p&&(l=c.slice(l,0,p))}else if("string"===f){var m=r(i);a=m[0],4===(o=m[1]).length&&(s=o[3],o.length--)}else if("object"===f)if(i.constructor===t){if(a=i._type,o=i._components.slice(),s=i._alpha,"gradient"===a)for(var g=1,v=o.length;g<v;g++){var y=o[g];y&&(o[g]=y.clone())}}else if(i.constructor===$)a="gradient",l=u;else{var b=e[a="hue"in i?"lightness"in i?"hsl":"hsb":"gradient"in i||"stops"in i||"radial"in i?"gradient":"gray"in i?"gray":"rgb"],x=n[a];this._components=o=[];for(g=0,v=b.length;g<v;g++){null==(_=i[b[g]])&&!g&&"gradient"===a&&"stops"in i&&(_={stops:i.stops,radial:i.radial}),null!=(_=x[g].call(this,_))&&(o[g]=_)}s=i.alpha}h&&a&&(d=1)}if(this._type=a||"rgb",!o){this._components=o=[];for(g=0,v=(x=n[this._type]).length;g<v;g++){var _;null!=(_=x[g].call(this,l&&l[g]))&&(o[g]=_)}}return this._components=o,this._properties=e[this._type],this._alpha=s,h&&(this.__read=d),this},set:"#initialize",_serialize:function(t,e){var n=this.getComponents();return c.serialize(/^(gray|rgb)$/.test(this._type)?n:[this._type].concat(n),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=o[this._type+"-"+t])?e.apply(this,this._components):o["rgb-"+t].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new q(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=c.isPlainValue(t,!0)?q.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&c.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],n="gradient"===this._type,i=m.instance,r=0,a=t.length;r<a;r++){var o=this._components[r];null!=o&&e.push(t[r]+": "+(n?o:i.number(o)))}return null!=this._alpha&&e.push("alpha: "+i.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),n=t||null==this._alpha?1:this._alpha;function i(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[i(e[0]),i(e[1]),i(e[2])],n<1&&e.push(n<0?0:n),t?"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var n,i=this._components,r=i[0],a=r._stops,o=i[1],s=i[2],l=i[3],u=e&&e.inverted();if(u&&(o=u._transformPoint(o),s=u._transformPoint(s),l&&(l=u._transformPoint(l))),r._radial){var c=s.getDistance(o);if(l){var h=l.subtract(o);h.getLength()>c&&(l=o.add(h.normalize(c-.1)))}var d=l||o;n=t.createRadialGradient(d.x,d.y,0,o.x,o.y,c)}else n=t.createLinearGradient(o.x,o.y,s.x,s.y);for(var f=0,p=a.length;f<p;f++){var m=a[f],g=m._offset;n.addColorStop(null==g?f/(p-1):g,m._color.toCanvasStyle())}return this._canvasStyle=n},transform:function(t){if("gradient"===this._type){for(var e=this._components,n=1,i=e.length;n<i;n++){var r=e[n];t._transformPoint(r,r,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new q(t(),t(),t())},_setOwner:function(t,e,n){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=n||null)),t}}})},new function(){return c.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},(function(t,e){this[e]=function(e){e=q.read(arguments);for(var n=this._type,i=this._components,r=e._convert(n),a=0,o=i.length;a<o;a++)r[a]=t(i[a],r[a]);return new q(n,r,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}}),{})}),$=c.extend({_class:"Gradient",initialize:function(t,e){this._id=v.get(),t&&c.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,(function(){return c.serialize([this._stops,this._radial],t,!0,e)}))},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;-1!=e&&(this._owners.splice(e,1),this._owners.length||(this._owners=s))},clone:function(){for(var t=[],e=0,n=this._stops.length;e<n;e++)t[e]=this._stops[e].clone();return new $(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var n=0,i=e.length;n<i;n++)e[n]._owner=s;for(n=0,i=(e=this._stops=Q.readList(t,0,{clone:!0})).length;n<i;n++)e[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,n=t._stops,i=e.length;if(i===n.length){for(var r=0;r<i;r++)if(!e[r].equals(n[r]))return!1;return!0}}return!1}}),Q=c.extend({_class:"GradientStop",initialize:function(t,e){var n=t,i=e;"object"==typeof t&&e===s&&(Array.isArray(t)&&"number"!=typeof t[0]?(n=t[0],i=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(n=t.color,i=t.offset||t.rampPoint||0)),this.setColor(n),this.setOffset(i)},clone:function(){return new Q(this._color.clone(),this._offset)},_serialize:function(t,e){var n=this._color,i=this._offset;return c.serialize(null==i?[n]:[n,i],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){q._setOwner(this._color,null),this._color=q._setOwner(q.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),Y=c.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new y,selectedColor:null},e=c.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=c.set({},e,{fillColor:new q}),i={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},r={beans:!0},a={_class:"Style",beans:!0,initialize:function(i,r,a){this._values={},this._owner=r,this._project=r&&r._project||a||dt.project,this._defaults=!r||r instanceof k?e:r instanceof G?n:t,i&&this.set(i)}};return c.each(e,(function(t,e){var n=/Color$/.test(e),o="shadowOffset"===e,l=c.capitalize(e),u=i[e],h="set"+l,d="get"+l;a[h]=function(t){var i=this._owner,r=i&&i._children,a=r&&r.length>0&&!(i instanceof j);if(a)for(var o=0,s=r.length;o<s;o++)r[o]._style[h](t);if(("selectedColor"===e||!a)&&e in this._defaults){var l=this._values[e];l!==t&&(n&&(l&&(q._setOwner(l,null),l._canvasStyle=null),t&&t.constructor===q&&(t=q._setOwner(t,i,a&&h))),this._values[e]=t,i&&i._changed(u||129))}},a[d]=function(t){var i=this._owner,r=i&&i._children,a=r&&r.length>0&&!(i instanceof j);if(a&&!t)for(var l=0,u=r.length;l<u;l++){var f=r[l]._style[d]();if(l){if(!c.equals(p,f))return s}else p=f}else if(e in this._defaults){var p;if((p=this._values[e])===s)(p=this._defaults[e])&&p.clone&&(p=p.clone());else{var m=n?q:o?y:null;!m||p&&p.constructor===m||(this._values[e]=p=m.read([p],0,{readNull:!0,clone:!0}))}}return p&&n&&(p=q._setOwner(p,i,a&&h)),p},r[d]=function(t){return this._style[d](t)},r[h]=function(t){this._style[h](t)}})),c.each({Font:"FontFamily",WindingRule:"FillRule"},(function(t,e){var n="get"+e,i="set"+e;a[n]=r[n]="#get"+t,a[i]=r[i]="#set"+t})),T.inject(r),a},{set:function(t){var e=t instanceof Y,n=e?t._values:t;if(n)for(var i in n)if(i in this._defaults){var r=n[i];this[i]=r&&e&&r.clone?r.clone():r}},equals:function(t){function e(t,e,n){var i=t._values,r=e._values,a=e._defaults;for(var o in i){var l=i[o],u=r[o];if(!(n&&o in r||c.equals(l,u===s?a[o]:u)))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=e?e:1.2*n}}),X=new function(){function t(t,e,n,i){for(var r=["","webkit","moz","Moz","ms","o"],a=e[0].toUpperCase()+e.substring(1),o=0;o<6;o++){var s=r[o],l=s?s+a:e;if(l in t){if(!n)return t[l];t[l]=i;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,n=e&&e.defaultView;return n&&n.getComputedStyle(t,"")},getBounds:function(t,e){var n,i=t.ownerDocument,r=i.body,a=i.documentElement;try{n=t.getBoundingClientRect()}catch(t){n={left:0,top:0,width:0,height:0}}var o=n.left-(a.clientLeft||r.clientLeft||0),s=n.top-(a.clientTop||r.clientTop||0);if(!e){var l=i.defaultView;o+=l.pageXOffset||a.scrollLeft||r.scrollLeft,s+=l.pageYOffset||a.scrollTop||r.scrollTop}return new w(o,s,n.width,n.height)},getViewportBounds:function(t){var e=t.ownerDocument,n=e.defaultView,i=e.documentElement;return new w(0,0,n.innerWidth||i.clientWidth,n.innerHeight||i.clientHeight)},getOffset:function(t,e){return X.getBounds(t,e).getPoint()},getSize:function(t){return X.getBounds(t,!0).getSize()},isInvisible:function(t){return X.getSize(t).equals(new x(0,0))},isInView:function(t){return!X.isInvisible(t)&&X.getViewportBounds(t).intersects(X.getBounds(t,!0))},isInserted:function(t){return u.body.contains(t)},getPrefixed:function(e,n){return e&&t(e,n)},setPrefixed:function(e,n,i){if("object"==typeof n)for(var r in n)t(e,r,!0,n[r]);else t(e,n,!0,i)}}},Z={add:function(t,e){if(t)for(var n in e)for(var i=e[n],r=n.split(/[\s,]+/g),a=0,o=r.length;a<o;a++){var s=r[a],l=t===u&&("touchstart"===s||"touchmove"===s)&&{passive:!1};t.addEventListener(s,i,l)}},remove:function(t,e){if(t)for(var n in e)for(var i=e[n],r=n.split(/[\s,]+/g),a=0,o=r.length;a<o;a++)t.removeEventListener(r[a],i,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new y(e.pageX||e.clientX+u.documentElement.scrollLeft,e.pageY||e.clientY+u.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return Z.getPoint(t).subtract(X.getOffset(e||Z.getTarget(t)))}};Z.requestAnimationFrame=new function(){var t,e=X.getPrefixed(l,"requestAnimationFrame"),n=!1,i=[];function r(){var t=i;i=[];for(var a=0,o=t.length;a<o;a++)t[a]();(n=e&&i.length)&&e(r)}return function(a){i.push(a),e?n||(e(r),n=!0):t||(t=setInterval(r,1e3/60))}};var J=c.extend(h,{_class:"View",initialize:function t(e,n){function i(t){return n[t]||parseInt(n.getAttribute(t),10)}function r(){var t=X.getSize(n);return t.isNaN()||t.isZero()?new x(i("width"),i("height")):t}var a;if(l&&n){this._id=n.getAttribute("id"),null==this._id&&n.setAttribute("id",this._id="paper-view-"+t._id++),Z.add(n,this._viewEvents);if(X.setPrefixed(n.style,{userDrag:"none",userSelect:"none",touchCallout:"none",contentZooming:"none",tapHighlightColor:"rgba(0,0,0,0)"}),d.hasAttribute(n,"resize")){var o=this;Z.add(l,this._windowEvents={resize:function(){o.setViewSize(r())}})}if(a=r(),d.hasAttribute(n,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var s=this._stats.domElement,c=s.style,h=X.getOffset(n);c.position="absolute",c.left=h.x+"px",c.top=h.y+"px",u.body.appendChild(s)}}else a=new x(n),n=null;this._project=e,this._scope=e._scope,this._element=n,this._pixelRatio||(this._pixelRatio=l&&l.devicePixelRatio||1),this._setElementSize(a.width,a.height),this._viewSize=a,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new E)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!dt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;J._focused===this&&(J._focused=null),J._views.splice(J._views.indexOf(this),1),delete J._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),Z.remove(this._element,this._viewEvents),Z.remove(l,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:c.each(T._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),(function(t){this[t]={}}),{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;Z.requestAnimationFrame((function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;X.getPrefixed(u,"hidden")&&"true"!==d.getAttribute(e,"keepalive")||!X.isInView(e)||t._handleFrame()}t._autoUpdate&&t.update()})),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){dt=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new c({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var n=this._frameItems;e?(n[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var n=this._frameItems[e];n.item.emit("frame",new c(t,{time:n.time+=t.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=s},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new _(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=x.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var n=this._element;n&&(n.width!==t&&(n.width=t),n.height!==e&&(n.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new w(new y,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return X.isInView(this._element)},isInserted:function(){return X.isInserted(this._element)},getPixelSize:function(t){var e,n=this._element;if(n){var i=n.parentNode,r=u.createElement("div");r.style.fontSize=t,i.appendChild(r),e=parseFloat(X.getStyles(r).fontSize),i.removeChild(r)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},c.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,i=(e?c:y).read(n),r=y.read(n,0,{readNull:!0});return this.transform((new E)[t](i,r||this.getCenter(!0)))}}),{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=y.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform((new E).scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new b(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=y.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(y.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(y.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(y.read(arguments))},getEventPoint:function(t){return this.viewToProject(Z.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return u&&"string"==typeof e&&(e=u.getElementById(e)),new(l?K:J)(t,e)}}},new function(){if(l){var t,e,n,i,r,a=!1,o=!1,s=l.navigator;s.pointerEnabled||s.msPointerEnabled?(n="pointerdown MSPointerDown",i="pointermove MSPointerMove",r="pointerup pointercancel MSPointerUp MSPointerCancel"):(n="touchstart",i="touchmove",r="touchend touchcancel","ontouchstart"in l&&s.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(n+=" mousedown",i+=" mousemove",r+=" mouseup"));var c={},h={mouseout:function(t){var e=J._focused,n=Z.getRelatedTarget(t);if(e&&(!n||"HTML"===n.nodeName)){var i=Z.getOffset(t,e._element),r=i.x,a=Math.abs,o=a(r),s=o-(1<<25);i.x=a(s)<o?s*(r<0?-1:1):r,T(e,t,e.viewToProject(i))}},scroll:C};c[n]=function(t){var e=J._focused=M(t);a||(a=!0,e._handleMouseEvent("mousedown",t))},h[i]=function(n){var i=J._focused;if(!o){var r=M(n);r?i!==r&&(i&&T(i,n),t||(t=i),i=J._focused=e=r):e&&e===i&&(t&&!t.isInserted()&&(t=null),i=J._focused=t,t=null,C())}i&&T(i,n)},h[n]=function(){o=!0},h[r]=function(t){var e=J._focused;e&&a&&e._handleMouseEvent("mouseup",t),o=a=!1},Z.add(u,h),Z.add(l,{load:C});var d,f,p,m,g,v,y,b,x=!1,_=!1,w={doubleclick:"click",mousedrag:"mousemove"},S=!1,E={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:c,_handleMouseEvent:function(t,e,n){var i=this._itemEvents,r=i.native[t],o="mousemove"===t,s=this._scope.tool,l=this;function u(t){return i.virtual[t]||l.responds(t)||s&&s.responds(t)}o&&a&&u("mousedrag")&&(t="mousedrag"),n||(n=this.getEventPoint(e));var c=this.getBounds().contains(n),h=r&&c&&l._project.hitTest(n,{tolerance:0,fill:!0,stroke:!0}),w=h&&h.item||null,E=!1,M={};if(M[t.substr(5)]=!0,r&&w!==m&&(m&&k(m,null,"mouseleave",e,n),w&&k(w,null,"mouseenter",e,n),m=w),S^c&&(k(this,null,c?"mouseenter":"mouseleave",e,n),c?this:null,E=!0),!c&&!M.drag||n.equals(f)||(P(this,w,o?t:"mousemove",e,n,f),E=!0),S=c,M.down&&c||M.up&&d){if(P(this,w,t,e,n,d),M.down){if(b=w===v&&Date.now()-y<300,p=v=w,!_&&w){for(var C=w;C&&!C.responds("mousedrag");)C=C._parent;C&&(g=w)}d=n}else M.up&&(_||w!==p||(y=Date.now(),P(this,w,b?"doubleclick":"click",e,n,d),b=!1),p=g=null);S=!1,E=!0}f=n,E&&s&&(x=s._handleMouseEvent(t,e,n,M)||x),!1!==e.cancelable&&(x&&!M.move||M.down&&u("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,n,i){var r,a=this._scope,o=a.tool;function s(o){o.responds(t)&&(dt=a,o.emit(t,r=r||new et(t,e,n,i)))}this.isVisible()&&(s(this),o&&o.responds(t)&&s(o))},_countItemEvent:function(t,e){var n=this._itemEvents,i=n.native,r=n.virtual;for(var a in E)i[a]=(i[a]||0)+(E[a][t]||0)*e;r[t]=(r[t]||0)+e},statics:{updateFocus:C,_resetState:function(){a=o=x=S=!1,t=e=d=f=p=m=g=v=y=b=null}}}}function M(t){var e=Z.getTarget(t);return e.getAttribute&&J._viewsById[e.getAttribute("id")]}function C(){var t=J._focused;if(!t||!t.isVisible())for(var n=0,i=J._views.length;n<i;n++)if((t=J._views[n]).isVisible()){J._focused=e=t;break}}function T(t,e,n){t._handleMouseEvent("mousemove",e,n)}function k(t,e,n,i,r,a,o){var s,l=!1;function u(t,n){if(t.responds(n)){if(s||(s=new it(n,i,r,e||t,a?r.subtract(a):null)),t.emit(n,s)&&(x=!0,s.prevented&&(_=!0),s.stopped))return l=!0}else{var o=w[n];if(o)return u(t,o)}}for(;t&&t!==o&&!u(t,n);)t=t._parent;return l}function P(t,e,n,i,r,a){return t._project.removeOn(n),_=x=!1,g&&k(g,null,n,i,r,a)||e&&e!==g&&!e.isDescendant(g)&&k(e,null,"mousedrag"===n?"mousemove":n,i,r,a,g)||k(t,g||e||t,n,i,r,a)}}),K=J.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof l.HTMLCanvasElement)){var n=x.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+c.slice(arguments,1));e=lt.getCanvas(n)}var i=this._context=e.getContext("2d");if(i.save(),this._pixelRatio=1,!/^off|false$/.test(d.getAttribute(e,"hidpi"))){var r=l.devicePixelRatio||1,a=X.getPrefixed(i,"backingStorePixelRatio")||1;this._pixelRatio=r/a}J.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,n){var i=this._pixelRatio;if(t.base.call(this,e*i,n*i),1!==i){var r=this._element,a=this._context;if(!d.hasAttribute(r,"resize")){var o=r.style;o.width=e+"px",o.height=n+"px"}a.restore(),a.save(),a.scale(i,i)}},getContext:function(){return this._context},getPixelSize:function t(e){var n,i=dt.agent;if(i&&i.firefox)n=t.base.call(this,e);else{var r=this._context,a=r.font;r.font=e+" serif",n=parseFloat(r.font),r.font=a}return n},getTextWidth:function(t,e){var n=this._context,i=n.font,r=0;n.font=t;for(var a=0,o=e.length;a<o;a++)r=Math.max(r,n.measureText(e[a]).width);return n.font=i,r},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,n=this._viewSize;return e.clearRect(0,0,n.width+1,n.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),tt=c.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return nt.modifiers}}),et=tt.extend({_class:"KeyEvent",initialize:function(t,e,n,i){this.type=t,this.event=e,this.key=n,this.character=i},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),nt=new function(){var t,e,n={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},i={tab:"\t",space:" ",enter:"\r"},r={},a={},o=new c({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=dt&&dt.agent;return t&&t.mac?this.meta:this.control}}});function h(t){var e=t.key||t.keyIdentifier;return e=/^U\+/.test(e)?String.fromCharCode(parseInt(e.substr(2),16)):/^Arrow[A-Z]/.test(e)?e.substr(5):"Unidentified"===e||e===s?String.fromCharCode(t.keyCode):e,n[e]||(e.length>1?c.hyphenate(e):e.toLowerCase())}function d(e,n,i,s){var l,u=J._focused;if(r[n]=e,e?a[n]=i:delete a[n],n.length>1&&(l=c.camelize(n))in o){o[l]=e;var h=dt&&dt.agent;if("meta"===l&&h&&h.mac)if(e)t={};else{for(var f in t)f in a&&d(!1,f,t[f],s);t=null}}else e&&t&&(t[n]=i);u&&u._handleKeyEvent(e?"keydown":"keyup",s,n,i)}return Z.add(u,{keydown:function(t){var n=h(t),r=dt&&dt.agent;n.length>1||r&&r.chrome&&(t.altKey||r.mac&&t.metaKey||!r.mac&&t.ctrlKey)?d(!0,n,i[n]||(n.length>1?"":n),t):e=n},keypress:function(t){if(e){var n=h(t),i=t.charCode,r=i>=32?String.fromCharCode(i):n.length>1?"":n;n!==e&&(n=r.toLowerCase()),d(!0,n,r,t),e=null}},keyup:function(t){var e=h(t);e in a&&d(!1,e,a[e],t)}}),Z.add(l,{blur:function(t){for(var e in a)d(!1,e,a[e],t)}}),{modifiers:o,isDown:function(t){return!!r[t]}}},it=tt.extend({_class:"MouseEvent",initialize:function(t,e,n,i,r){this.type=t,this.event=e,this.point=n,this.target=i,this.delta=r},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),rt=tt.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,n){this.tool=t,this.type=e,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,n=e._parent;/^(Group|CompoundPath)$/.test(n._class);)e=n,n=n._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),at=f.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){f.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,n,i){dt=this._scope,i.drag&&!this.responds(t)&&(t="mousemove");var r=i.move||i.drag,a=this.responds(t),o=this.minDistance,s=this.maxDistance,l=!1,u=this;function c(t,e){var a=n,o=r?u._point:u._downPoint||a;if(r){if(u._moveCount>=0&&a.equals(o))return!1;if(o&&(null!=t||null!=e)){var s=a.subtract(o),l=s.getLength();if(l<(t||0))return!1;e&&(a=o.add(s.normalize(Math.min(l,e))))}u._moveCount++}return u._point=a,u._lastPoint=o||a,i.down&&(u._moveCount=-1,u._downPoint=a,u._downCount++),!0}function h(){a&&(l=u.emit(t,new rt(u,t,e))||l)}if(i.down)c(),h();else if(i.up)c(null,s),h();else if(a)for(;c(o,s);)h();return l}}),ot=c.extend(h,{_class:"Tween",statics:{easings:{linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:2*(2-t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}}},initialize:function t(e,n,i,r,a,o){this.object=e;var s=typeof a,l="function"===s;this.type=l?s:"string"===s?a:"linear",this.easing=l?a:t.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null;var u=n||i;this._keys=u?Object.keys(u):[],this._parsedKeys=this._parseKeys(this._keys),this._from=u&&this._getState(n),this._to=u&&this._getState(i),!1!==o&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),n=this._keys,i=function(n){return"function"==typeof n?n(e,t):n},r=0,a=n&&n.length;r<a;r++){var o=n[r],s=i(this._from[o]),l=i(this._to[o]),u=s&&l&&s.__add&&l.__add?l.__subtract(s).__multiply(e).__add(s):(l-s)*e+s;this._setProperty(this._parsedKeys[o],u)}this.responds("update")&&this.emit("update",new c({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,n=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(n)},_getState:function(t){for(var e=this._keys,n={},i=0,r=e.length;i<r;i++){var a,o=e[i],s=this._parsedKeys[o],l=this._getProperty(s);if(t){var u=this._resolveValue(l,t[o]);this._setProperty(s,u),a=(a=this._getProperty(s))&&a.clone?a.clone():a,this._setProperty(s,l)}else a=l&&l.clone?l.clone():l;n[o]=a}return n},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var n=e[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(t,n[0],e[1]):e}if("string"==typeof e){var i=e.match(/^[+\-*/]=(.*)/);if(i){var r=JSON.parse(i[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],r)}}}return e},_calculate:function(t,e,n){return dt.PaperScript.calculateBinary(t,e,n)},_parseKeys:function(t){for(var e={},n=0,i=t.length;n<i;n++){var r=t[n],a=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[r]=a.split("/")}return e},_getProperty:function(t,e){for(var n=this.object,i=0,r=t.length-(e||0);i<r&&n;i++)n=n[t[i]];return n},_setProperty:function(t,e){var n=this._getProperty(t,1);n&&(n[t[t.length-1]]=e)}}),st=function(t){var e=new o.XMLHttpRequest;return e.open((t.method||"get").toUpperCase(),t.url,c.pick(t.async,!0)),t.mimeType&&e.overrideMimeType(t.mimeType),e.onload=function(){var n=e.status;0===n||200===n?t.onLoad&&t.onLoad.call(e,e.responseText):e.onerror()},e.onerror=function(){var n=e.status,i='Could not load "'+t.url+'" (Status: '+n+")";if(!t.onError)throw new Error(i);t.onError(i,n)},e.send(null)},lt=c.exports.CanvasProvider={canvases:[],getCanvas:function(t,e){if(!l)return null;var n,i=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?n=this.canvases.pop():(n=u.createElement("canvas"),i=!1);var r=n.getContext("2d");if(!r)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===t&&n.height===e?i&&r.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),r.save(),n},getContext:function(t,e){var n=this.getCanvas(t,e);return n?n.getContext("2d"):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},ut=new function(){var t,e,n,i,r,a,o,s,l,u,h,d=Math.min,f=Math.max,p=Math.abs;function m(t,e,n){return.2989*t+.587*e+.114*n}function g(t,e,n,i){var r=i-m(t,e,n),a=(i=m(l=t+r,u=e+r,h=n+r),d(l,u,h)),o=f(l,u,h);if(a<0){var s=i-a;l=i+(l-i)*i/s,u=i+(u-i)*i/s,h=i+(h-i)*i/s}if(o>255){var c=255-i,p=o-i;l=i+(l-i)*c/p,u=i+(u-i)*c/p,h=i+(h-i)*c/p}}function v(t,e,n){return f(t,e,n)-d(t,e,n)}function y(t,e,n,i){var r,a=[t,e,n],o=f(t,e,n),s=d(t,e,n);r=0===d(s=s===t?0:s===e?1:2,o=o===t?0:o===e?1:2)?1===f(s,o)?2:1:0,a[o]>a[s]?(a[r]=(a[r]-a[s])*i/(a[o]-a[s]),a[o]=i):a[r]=a[o]=0,a[s]=0,l=a[0],u=a[1],h=a[2]}var b={multiply:function(){l=r*t/255,u=a*e/255,h=o*n/255},screen:function(){l=r+t-r*t/255,u=a+e-a*e/255,h=o+n-o*n/255},overlay:function(){l=r<128?2*r*t/255:255-2*(255-r)*(255-t)/255,u=a<128?2*a*e/255:255-2*(255-a)*(255-e)/255,h=o<128?2*o*n/255:255-2*(255-o)*(255-n)/255},"soft-light":function(){var i=t*r/255;l=i+r*(255-(255-r)*(255-t)/255-i)/255,u=(i=e*a/255)+a*(255-(255-a)*(255-e)/255-i)/255,h=(i=n*o/255)+o*(255-(255-o)*(255-n)/255-i)/255},"hard-light":function(){l=t<128?2*t*r/255:255-2*(255-t)*(255-r)/255,u=e<128?2*e*a/255:255-2*(255-e)*(255-a)/255,h=n<128?2*n*o/255:255-2*(255-n)*(255-o)/255},"color-dodge":function(){l=0===r?0:255===t?255:d(255,255*r/(255-t)),u=0===a?0:255===e?255:d(255,255*a/(255-e)),h=0===o?0:255===n?255:d(255,255*o/(255-n))},"color-burn":function(){l=255===r?255:0===t?0:f(0,255-255*(255-r)/t),u=255===a?255:0===e?0:f(0,255-255*(255-a)/e),h=255===o?255:0===n?0:f(0,255-255*(255-o)/n)},darken:function(){l=r<t?r:t,u=a<e?a:e,h=o<n?o:n},lighten:function(){l=r>t?r:t,u=a>e?a:e,h=o>n?o:n},difference:function(){(l=r-t)<0&&(l=-l),(u=a-e)<0&&(u=-u),(h=o-n)<0&&(h=-h)},exclusion:function(){l=r+t*(255-r-r)/255,u=a+e*(255-a-a)/255,h=o+n*(255-o-o)/255},hue:function(){y(t,e,n,v(r,a,o)),g(l,u,h,m(r,a,o))},saturation:function(){y(r,a,o,v(t,e,n)),g(l,u,h,m(r,a,o))},luminosity:function(){g(r,a,o,m(t,e,n))},color:function(){g(t,e,n,m(r,a,o))},add:function(){l=d(r+t,255),u=d(a+e,255),h=d(o+n,255)},subtract:function(){l=f(r-t,0),u=f(a-e,0),h=f(o-n,0)},average:function(){l=(r+t)/2,u=(a+e)/2,h=(o+n)/2},negation:function(){l=255-p(255-t-r),u=255-p(255-e-a),h=255-p(255-n-o)}},x=this.nativeModes=c.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],(function(t){this[t]=!0}),{}),_=lt.getContext(1,1);_&&(c.each(b,(function(t,e){var n="darken"===e,i=!1;_.save();try{_.fillStyle=n?"#300":"#a00",_.fillRect(0,0,1,1),_.globalCompositeOperation=e,_.globalCompositeOperation===e&&(_.fillStyle=n?"#a00":"#300",_.fillRect(0,0,1,1),i=_.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(t){}_.restore(),x[e]=i})),lt.release(_)),this.process=function(c,d,f,p,m){var g=d.canvas,v="normal"===c;if(v||x[c])f.save(),f.setTransform(1,0,0,1,0,0),f.globalAlpha=p,v||(f.globalCompositeOperation=c),f.drawImage(g,m.x,m.y),f.restore();else{var y=b[c];if(!y)return;for(var _=f.getImageData(m.x,m.y,g.width,g.height),w=_.data,S=d.getImageData(0,0,g.width,g.height).data,E=0,M=w.length;E<M;E+=4){t=S[E],r=w[E],e=S[E+1],a=w[E+1],n=S[E+2],o=w[E+2],i=S[E+3],s=w[E+3],y();var C=i*p/255,T=1-C;w[E]=C*l+T*r,w[E+1]=C*u+T*a,w[E+2]=C*h+T*o,w[E+3]=i*p+T*s}f.putImageData(_,m.x,m.y)}}},ct=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",i={href:n,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function r(t,e,n){for(var r in e){var a=e[r],o=i[r];"number"==typeof a&&n&&(a=n.number(a)),o?t.setAttributeNS(o,r,a):t.setAttribute(r,a)}return t}return{svg:t,xmlns:e,xlink:n,create:function(e,n,i){return r(u.createElementNS(t,e),n,i)},get:function(t,e){var n=i[e],r=n?t.getAttributeNS(n,e):t.getAttribute(e);return"null"===r?null:r},set:r}},ht=c.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof F||t instanceof A||t instanceof G)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},(function(t,e){var n=c.capitalize(e),i=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:i,fromSVG:i&&c.each(i,(function(t,e){this[t]=e}),{}),exportFilter:t[3],get:"get"+n,set:"set"+n}}),{});new function(){var t;function e(e,n,i){var r,a=new c,o=e.getTranslation();n&&(e.isInvertible()?(r=(e=e._shiftless())._inverseTransform(o),o=null):r=new y,a[i?"cx":"x"]=r.x,a[i?"cy":"y"]=r.y);if(!e.isIdentity()){var s=e.decompose();if(s){var l=[],u=s.rotation,h=s.scaling,d=s.skewing;o&&!o.isZero()&&l.push("translate("+t.point(o)+")"),u&&l.push("rotate("+t.number(u)+")"),g.isZero(h.x-1)&&g.isZero(h.y-1)||l.push("scale("+t.point(h)+")"),d.x&&l.push("skewX("+t.number(d.x)+")"),d.y&&l.push("skewY("+t.number(d.y)+")"),a.transform=l.join(" ")}else a.transform="matrix("+e.getValues().join(",")+")"}return a}function n(n,i){for(var r=e(n._matrix),a=n._children,o=ct.create("g",r,t),s=0,l=a.length;s<l;s++){var c=a[s],h=d(c,i);if(h)if(c.isClipMask()){var f=ct.create("clipPath");f.appendChild(h),u(c,f,"clip"),ct.set(o,{"clip-path":"url(#"+f.id+")"})}else o.appendChild(h)}return o}function i(n){var i=n._type,r=n._radius,a=e(n._matrix,!0,"rectangle"!==i);if("rectangle"===i){i="rect";var o=n._size,s=o.width,l=o.height;a.x-=s/2,a.y-=l/2,a.width=s,a.height=l,r.isZero()&&(r=null)}return r&&("circle"===i?a.r=r:(a.rx=r.width,a.ry=r.height)),ct.create(i,a,t)}var r,a={Group:n,Layer:n,Raster:function(n,i){var r=e(n._matrix,!0),a=n.getSize(),o=n.getImage();return r.x-=a.width/2,r.y-=a.height/2,r.width=a.width,r.height=a.height,r.href=0==i.embedImages&&o&&o.src||n.toDataURL(),ct.create("image",r,t)},Path:function(n,r){var a=r.matchShapes;if(a){var o=n.toShape(!1);if(o)return i(o)}var s,l=n._segments,u=l.length,c=e(n._matrix);if(a&&u>=2&&!n.hasHandles())if(u>2){s=n._closed?"polygon":"polyline";for(var h=[],d=0;d<u;d++)h.push(t.point(l[d]._point));c.points=h.join(" ")}else{s="line";var f=l[0]._point,p=l[1]._point;c.set({x1:f.x,y1:f.y,x2:p.x,y2:p.y})}else s="path",c.d=n.getPathData(null,r.precision);return ct.create(s,c,t)},Shape:i,CompoundPath:function(n,i){var r=e(n._matrix),a=n.getPathData(null,i.precision);return a&&(r.d=a),ct.create("path",r,t)},SymbolItem:function(n,i){var r=e(n._matrix,!0),a=n._definition,o=l(a,"symbol"),s=a._item,c=s.getStrokeBounds();return o||((o=ct.create("symbol",{viewBox:t.rectangle(c)})).appendChild(d(s,i)),u(a,o,"symbol")),r.href="#"+o.id,r.x+=c.x,r.y+=c.y,r.width=c.width,r.height=c.height,r.overflow="visible",ct.create("use",r,t)},PointText:function(n){var i=ct.create("text",e(n._matrix,!0),t);return i.textContent=n._content,i}};function s(e,n,i){var r={},a=!i&&e.getParent(),o=[];return null!=e._name&&(r.id=e._name),c.each(ht,(function(n){var i=n.get,s=n.type,h=e[i]();if(n.exportFilter?n.exportFilter(e,h):!a||!c.equals(a[i](),h)){if("color"===s&&null!=h){var d=h.getAlpha();d<1&&(r[n.attribute+"-opacity"]=d)}"style"===s?o.push(n.attribute+": "+h):r[n.attribute]=null==h?"none":"color"===s?h.gradient?function(e){var n=l(e,"color");if(!n){var i,r=e.getGradient(),a=r._radial,o=e.getOrigin(),s=e.getDestination();if(a){i={cx:o.x,cy:o.y,r:o.getDistance(s)};var c=e.getHighlight();c&&(i.fx=c.x,i.fy=c.y)}else i={x1:o.x,y1:o.y,x2:s.x,y2:s.y};i.gradientUnits="userSpaceOnUse",n=ct.create((a?"radial":"linear")+"Gradient",i,t);for(var h=r._stops,d=0,f=h.length;d<f;d++){var p=h[d],m=p._color,g=m.getAlpha(),v=p._offset;i={offset:null==v?d/(f-1):v},m&&(i["stop-color"]=m.toCSS(!0)),g<1&&(i["stop-opacity"]=g),n.appendChild(ct.create("stop",i,t))}u(e,n,"color")}return"url(#"+n.id+")"}(h):h.toCSS(!0):"array"===s?h.join(","):"lookup"===s?n.toSVG[h]:h}})),o.length&&(r.style=o.join(";")),1===r.opacity&&delete r.opacity,e._visible||(r.visibility="hidden"),ct.set(n,r,t)}function l(t,e){return r||(r={ids:{},svgs:{}}),t&&r.svgs[e+"-"+(t._id||t.__id||(t.__id=v.get("svg")))]}function u(t,e,n){r||l();var i=r.ids[n]=(r.ids[n]||0)+1;e.id=n+"-"+i,r.svgs[n+"-"+(t._id||t.__id)]=e}function h(t,e){var n=t,i=null;if(r){for(var a in n="svg"===t.nodeName.toLowerCase()&&t,r.svgs)i||(n||(n=ct.create("svg")).appendChild(t),i=n.insertBefore(ct.create("defs"),n.firstChild)),i.appendChild(r.svgs[a]);r=null}return e.asString?(new o.XMLSerializer).serializeToString(n):n}function d(t,e,n){var i=a[t._class],r=i&&i(t,e);if(r){var o=e.onExport;o&&(r=o(t,r,e)||r);var l=JSON.stringify(t._data);l&&"{}"!==l&&"null"!==l&&r.setAttribute("data-paper-data",l)}return r&&s(t,r,n)}function f(e){return e||(e={}),t=new m(e.precision),e}T.inject({exportSVG:function(t){return h(d(this,t=f(t),!0),t)}}),C.inject({exportSVG:function(n){n=f(n);var i=this._children,r=this.getView(),a=c.pick(n.bounds,"view"),o=n.matrix||"view"===a&&r._matrix,s=o&&E.read([o]),l="view"===a?new w([0,0],r.getViewSize()):"content"===a?T._getBounds(i,s,{stroke:!0}).rect:w.read([a],0,{readNull:!0}),u={version:"1.1",xmlns:ct.svg,"xmlns:xlink":ct.xlink};l&&(u.width=l.width,u.height=l.height,(l.x||0===l.x||l.y||0===l.y)&&(u.viewBox=t.rectangle(l)));var p=ct.create("svg",u,t),m=p;s&&!s.isIdentity()&&(m=p.appendChild(ct.create("g",e(s),t)));for(var g=0,v=i.length;g<v;g++)m.appendChild(d(i[g],n,!0));return h(p,n)}})},new function(){var t,e={};function n(e,n,i,r,a,o){var s=ct.get(e,n)||o,l=null==s?r?null:i?"":0:i?s:parseFloat(s);return/%\s*$/.test(s)?l/100*(a?1:t[/x|^width/.test(n)?"width":"height"]):l}function i(t,e,i,r,a,o,s){return e=n(t,e||"x",!1,r,a,o),i=n(t,i||"y",!1,r,a,s),!r||null!=e&&null!=i?new y(e,i):null}function r(t,e,i,r,a){return e=n(t,e||"width",!1,r,a),i=n(t,i||"height",!1,r,a),!r||null!=e&&null!=i?new x(e,i):null}function a(t,e,n){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?S(t)||t:"lookup"===e?n[t]:t}function h(t,e,n,i){var r=t.childNodes,a="clippath"===e,o="defs"===e,s=new k,l=s._project,u=l._currentStyle,c=[];if(a||o||(s=_(s,t,i),l._currentStyle=s._style.clone()),i)for(var h=t.querySelectorAll("defs"),d=0,f=h.length;d<f;d++)M(h[d],n,!1);for(d=0,f=r.length;d<f;d++){var p,m=r[d];1!==m.nodeType||/^defs$/i.test(m.nodeName)||!(p=M(m,n,!1))||p instanceof R||c.push(p)}return s.addChildren(c),a&&(s=_(s.reduce(),t,i)),l._currentStyle=u,(a||o)&&(s.remove(),s=null),s}function d(t,e){for(var n=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),i=[],r=0,a=n.length;r<a;r+=2)i.push(new y(parseFloat(n[r]),parseFloat(n[r+1])));var o=new V(i);return"polygon"===e&&o.closePath(),o}function f(t,r){var a,o=(n(t,"href",!0)||"").substring(1),s="radialgradient"===r;if(o)(a=e[o].getGradient())._radial^s&&((a=a.clone())._radial=s);else{for(var l=t.childNodes,u=[],c=0,h=l.length;c<h;c++){var d=l[c];1===d.nodeType&&u.push(_(new Q,d))}a=new $(u,s)}var f,p,m,g="userSpaceOnUse"!==n(t,"gradientUnits",!0);return s?(p=(f=i(t,"cx","cy",!1,g,"50%","50%")).add(n(t,"r",!1,!1,g,"50%"),0),m=i(t,"fx","fy",!0,g)):(f=i(t,"x1","y1",!1,g,"0%","0%"),p=i(t,"x2","y2",!1,g,"100%","0%")),_(new q(a,f,p,m),t)._scaleToBounds=g,null}var p={"#document":function(t,e,n,i){for(var r=t.childNodes,a=0,o=r.length;a<o;a++){var s=r[a];if(1===s.nodeType)return M(s,n,i)}},g:h,svg:h,clippath:h,polygon:d,polyline:d,path:function(t){return F.create(t.getAttribute("d"))},lineargradient:f,radialgradient:f,image:function(t){var e=new O(n(t,"href",!0));return e.on("load",(function(){var e=r(t);this.setSize(e);var n=i(t).add(e.divide(2));this._matrix.append((new E).translate(n))})),e},symbol:function(t,e,n,i){return new R(h(t,e,n,i),!0)},defs:h,use:function(t){var r=(n(t,"href",!0)||"").substring(1),a=e[r],o=i(t);return a?a instanceof R?a.place(o):a.clone().translate(o):null},circle:function(t){return new A.Circle(i(t,"cx","cy"),n(t,"r"))},ellipse:function(t){return new A.Ellipse({center:i(t,"cx","cy"),radius:r(t,"rx","ry")})},rect:function(t){return new A.Rectangle(new w(i(t),r(t)),r(t,"rx","ry"))},line:function(t){return new V.Line(i(t,"x1","y1"),i(t,"x2","y2"))},text:function(t){var e=new W(i(t).add(i(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:h};function m(t,e,n,i){if(t.transform){for(var r=(i.getAttribute(n)||"").split(/\)\s*/g),a=new E,o=0,s=r.length;o<s;o++){var l=r[o];if(!l)break;for(var u=l.split(/\(\s*/),c=u[0],h=u[1].split(/[\s,]+/g),d=0,f=h.length;d<f;d++)h[d]=parseFloat(h[d]);switch(c){case"matrix":a.append(new E(h[0],h[1],h[2],h[3],h[4],h[5]));break;case"rotate":a.rotate(h[0],h[1]||0,h[2]||0);break;case"translate":a.translate(h[0],h[1]||0);break;case"scale":a.scale(h);break;case"skewX":a.skew(h[0],0);break;case"skewY":a.skew(0,h[0])}}t.transform(a)}}function g(t,e,n){var i="fill-opacity"===n?"getFillColor":"getStrokeColor",r=t[i]&&t[i]();r&&r.setAlpha(parseFloat(e))}var v=c.set(c.each(ht,(function(t){this[t.attribute]=function(e,n){if(e[t.set]&&(e[t.set](a(n,t.type,t.fromSVG)),"color"===t.type)){var i=e[t.get]();if(i&&i._scaleToBounds){var r=e.getBounds();i.transform((new E).translate(r.getPoint()).scale(r.getSize()))}}}}),{}),{id:function(t,n){e[n]=t,t.setName&&t.setName(n)},"clip-path":function(t,e){var n=S(e);if(n){if((n=n.clone()).setClipMask(!0),!(t instanceof k))return new k(n,t);t.insertChild(0,n)}},gradientTransform:m,transform:m,"fill-opacity":g,"stroke-opacity":g,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var n=e.match(/(.*)%$/);t.setOffset(n?n[1]/100:parseFloat(e))}},viewBox:function(t,e,n,i,o){var s,l=new w(a(e,"array")),u=r(i,null,null,!0);if(t instanceof k){var c=u?u.divide(l.getSize()):1,h=(new E).scale(c).translate(l.getPoint().negate());s=t}else t instanceof R&&(u&&l.setSize(u),s=t._item);if(s){if("visible"!==b(i,"overflow",o)){var d=new A.Rectangle(l);d.setClipMask(!0),s.addChild(d)}h&&s.transform(h)}}});function b(t,e,n){var i=t.attributes[e],r=i&&i.value;if(!r&&t.style){var a=c.camelize(e);(r=t.style[a])||n.node[a]===n.parent[a]||(r=n.node[a])}return r?"none"===r?null:r:s}function _(t,e,n){var i=e.parentNode,r={node:X.getStyles(e)||{},parent:!n&&!/^defs$/i.test(i.tagName)&&X.getStyles(i)||{}};return c.each(v,(function(n,i){var a=b(e,i,r);t=a!==s&&n(t,a,i,e,r)||t})),t}function S(t){var n=t&&t.match(/\((?:["'#]*)([^"')]+)/),i=n&&n[1],r=i&&e[l?i.replace(l.location.href.split("#")[0]+"#",""):i];return r&&r._scaleToBounds&&((r=r.clone())._scaleToBounds=!0),r}function M(n,i,a){var o,s,l,h=n.nodeName.toLowerCase(),d="#document"!==h,f=u.body;a&&d&&(t=dt.getView().getSize(),t=r(n,null,null,!0)||t,o=ct.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),s=n.parentNode,l=n.nextSibling,o.appendChild(n),f.appendChild(o));var m=dt.settings,g=m.applyMatrix,v=m.insertItems;m.applyMatrix=!1,m.insertItems=!1;var y=p[h],b=y&&y(n,h,i,a)||null;if(m.insertItems=v,m.applyMatrix=g,b){!d||b instanceof k||(b=_(b,n,a));var x=i.onImport,w=d&&n.getAttribute("data-paper-data");x&&(b=x(n,b,i)||b),i.expandShapes&&b instanceof A&&(b.remove(),b=b.toPath()),w&&(b._data=JSON.parse(w))}return o&&(f.removeChild(o),s&&(l?s.insertBefore(n,l):s.appendChild(n))),a&&(e={},b&&c.pick(i.applyMatrix,g)&&b.matrix.apply(!0,!0)),b}function P(t,e,n){if(!t)return null;e="function"==typeof e?{onLoad:e}:e||{};var i=dt,r=null;function a(a){try{var u="object"==typeof a?a:(new o.DOMParser).parseFromString(a.trim(),"image/svg+xml");if(!u.nodeName)throw u=null,new Error("Unsupported SVG source: "+t);dt=i,r=M(u,e,!0),e&&!1===e.insert||n._insertItem(s,r);var c=e.onLoad;c&&c(r,a)}catch(t){l(t)}}function l(t,n){var i=e.onError;if(!i)throw new Error(t);i(t,n)}if("string"!=typeof t||/^[\s\S]*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var c=new FileReader;return c.onload=function(){a(c.result)},c.onerror=function(){l(c.error)},c.readAsText(t)}a(t)}else{var h=u.getElementById(t);h?a(h):st({url:t,async:!0,onLoad:a,onError:l})}return r}T.inject({importSVG:function(t,e){return P(t,e,this)}}),C.inject({importSVG:function(t,e){return this.activate(),P(t,e,this)}})},c.exports.PaperScript=function(){var t,e,h,f=this,p=f.acorn;if(!p)try{p=n(358)}catch(t){}p||(p=t=e={},h=function(t){"use strict";var e,n,i,r;t.version="0.5.0",t.parse=function(t,r){return n=String(t),i=n.length,o(r),qt(),function(t){v=y=s,e.locations&&(b=new Wt),x=w=null,_=[],Jt();var n=t||ce(),i=!0;for(t||(n.body=[]);d!==A;){var r=we();n.body.push(r),i&&fe(r)&&se(!0),i=!1}return de(n,"Program")}(e.program)};var a=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function o(t){for(var n in e=t||{},a)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=a[n]);r=e.sourceFile||null}var s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,w,S=t.getLineInfo=function(t,e){for(var n=1,i=0;;){Ut.lastIndex=i;var r=Ut.exec(t);if(!(r&&r.index<e))break;++n,i=r.index+r[0].length}return{line:n,column:e-i}};function E(t,e){var i=S(n,t);e+=" ("+i.line+":"+i.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=i,r.raisedAt=s,r}t.tokenize=function(t,r){n=String(t),i=n.length,o(r),qt();var a={};function v(t){return y=u,Jt(t),a.start=l,a.end=u,a.startLoc=c,a.endLoc=h,a.type=d,a.value=f,a}return v.jumpTo=function(t,i){var r;if(s=t,e.locations)for(m=1,g=Ut.lastIndex=0;(r=Ut.exec(n))&&r.index<t;)++m,g=r.index+r[0].length;p=i,Xt()},v};var M=[],C={type:"num"},T={type:"regexp"},k={type:"string"},P={type:"name"},A={type:"eof"},O={keyword:"break"},L={keyword:"case",beforeExpr:!0},R={keyword:"catch"},I={keyword:"continue"},N={keyword:"debugger"},D={keyword:"default"},z={keyword:"do",isLoop:!0},B={keyword:"else",beforeExpr:!0},F={keyword:"finally"},V={keyword:"for",isLoop:!0},j={keyword:"function"},U={keyword:"if"},H={keyword:"return",beforeExpr:!0},G={keyword:"switch"},W={keyword:"throw",beforeExpr:!0},q={keyword:"try"},$={keyword:"var"},Q={keyword:"while",isLoop:!0},Y={keyword:"with"},X={keyword:"new",beforeExpr:!0},Z={keyword:"this"},J={keyword:"null",atomValue:null},K={keyword:"true",atomValue:!0},tt={keyword:"false",atomValue:!1},et={keyword:"in",binop:7,beforeExpr:!0},nt={break:O,case:L,catch:R,continue:I,debugger:N,default:D,do:z,else:B,finally:F,for:V,function:j,if:U,return:H,switch:G,throw:W,try:q,var:$,while:Q,with:Y,null:J,true:K,false:tt,new:X,in:et,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Z,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},it={type:"[",beforeExpr:!0},rt={type:"]"},at={type:"{",beforeExpr:!0},ot={type:"}"},st={type:"(",beforeExpr:!0},lt={type:")"},ut={type:",",beforeExpr:!0},ct={type:";",beforeExpr:!0},ht={type:":",beforeExpr:!0},dt={type:"."},ft={type:"?",beforeExpr:!0},pt={binop:10,beforeExpr:!0},mt={isAssign:!0,beforeExpr:!0},gt={isAssign:!0,beforeExpr:!0},vt={postfix:!0,prefix:!0,isUpdate:!0},yt={prefix:!0,beforeExpr:!0},bt={binop:1,beforeExpr:!0},xt={binop:2,beforeExpr:!0},_t={binop:3,beforeExpr:!0},wt={binop:4,beforeExpr:!0},St={binop:5,beforeExpr:!0},Et={binop:6,beforeExpr:!0},Mt={binop:7,beforeExpr:!0},Ct={binop:8,beforeExpr:!0},Tt={binop:9,prefix:!0,beforeExpr:!0},kt={binop:10,beforeExpr:!0};for(var Pt in t.tokTypes={bracketL:it,bracketR:rt,braceL:at,braceR:ot,parenL:st,parenR:lt,comma:ut,semi:ct,colon:ht,dot:dt,question:ft,slash:pt,eq:mt,name:P,eof:A,num:C,regexp:T,string:k},nt)t.tokTypes["_"+Pt]=nt[Pt];function At(t){t=t.split(" ");var e="",n=[];t:for(var i=0;i<t.length;++i){for(var r=0;r<n.length;++r)if(n[r][0].length==t[i].length){n[r].push(t[i]);continue t}n.push([t[i]])}function a(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var n=0;n<t.length;++n)e+="case "+JSON.stringify(t[n])+":";e+="return true}return false;"}if(n.length>3){for(n.sort((function(t,e){return e.length-t.length})),e+="switch(str.length){",i=0;i<n.length;++i){var o=n[i];e+="case "+o[0].length+":",a(o)}e+="}"}else a(t);return new Function("str",e)}var Ot,Lt=At("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Rt=At("class enum extends super const export import"),It=At("implements interface let package private protected public static yield"),Nt=At("eval arguments"),Dt=At("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),zt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Bt="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Ft=new RegExp("["+Bt+"]"),Vt=new RegExp("["+Bt+"------------------------------------------------------------------------------------------------------------------------------------------]"),jt=/[\n\r\u2028\u2029]/,Ut=/\r\n|[\n\r\u2028\u2029]/g,Ht=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&Ft.test(String.fromCharCode(t)))},Gt=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&Vt.test(String.fromCharCode(t))))};function Wt(){this.line=m,this.column=s-g}function qt(){m=1,s=g=0,p=!0,Xt()}function $t(t,n){u=s,e.locations&&(h=new Wt),d=t,Xt(),f=n,p=t.beforeExpr}function Qt(){var t,i=e.onComment&&e.locations&&new Wt,r=s,a=n.indexOf("*/",s+=2);if(-1===a&&E(s-2,"Unterminated comment"),s=a+2,e.locations)for(Ut.lastIndex=r;(t=Ut.exec(n))&&t.index<s;)++m,g=t.index+t[0].length;e.onComment&&e.onComment(!0,n.slice(r+2,a),r,s,i,e.locations&&new Wt)}function Yt(){for(var t=s,r=e.onComment&&e.locations&&new Wt,a=n.charCodeAt(s+=2);s<i&&10!==a&&13!==a&&8232!==a&&8233!==a;)++s,a=n.charCodeAt(s);e.onComment&&e.onComment(!1,n.slice(t+2,s),t,s,r,e.locations&&new Wt)}function Xt(){for(;s<i;){var t=n.charCodeAt(s);if(32===t)++s;else if(13===t)++s,10===(r=n.charCodeAt(s))&&++s,e.locations&&(++m,g=s);else if(10===t||8232===t||8233===t)++s,e.locations&&(++m,g=s);else if(t>8&&t<14)++s;else if(47===t){var r;if(42===(r=n.charCodeAt(s+1)))Qt();else{if(47!==r)break;Yt()}}else if(160===t)++s;else{if(!(t>=5760&&zt.test(String.fromCharCode(t))))break;++s}}}function Zt(t){switch(t){case 46:return function(){var t=n.charCodeAt(s+1);return t>=48&&t<=57?ne(!0):(++s,$t(dt))}();case 40:return++s,$t(st);case 41:return++s,$t(lt);case 59:return++s,$t(ct);case 44:return++s,$t(ut);case 91:return++s,$t(it);case 93:return++s,$t(rt);case 123:return++s,$t(at);case 125:return++s,$t(ot);case 58:return++s,$t(ht);case 63:return++s,$t(ft);case 48:var r=n.charCodeAt(s+1);if(120===r||88===r)return function(){s+=2;var t=ee(16);return null==t&&E(l+2,"Expected hexadecimal number"),Ht(n.charCodeAt(s))&&E(s,"Identifier directly after number"),$t(C,t)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ne(!1);case 34:case 39:return function(t){s++;for(var r="";;){s>=i&&E(l,"Unterminated string constant");var a=n.charCodeAt(s);if(a===t)return++s,$t(k,r);if(92===a){a=n.charCodeAt(++s);var o=/^[0-7]+/.exec(n.slice(s,s+3));for(o&&(o=o[0]);o&&parseInt(o,8)>255;)o=o.slice(0,-1);if("0"===o&&(o=null),++s,o)w&&E(s-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(o,8)),s+=o.length-1;else switch(a){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(ie(2));break;case 117:r+=String.fromCharCode(ie(4));break;case 85:r+=String.fromCharCode(ie(8));break;case 116:r+="\t";break;case 98:r+="\b";break;case 118:r+="\v";break;case 102:r+="\f";break;case 48:r+="\0";break;case 13:10===n.charCodeAt(s)&&++s;case 10:e.locations&&(g=s,++m);break;default:r+=String.fromCharCode(a)}}else 13!==a&&10!==a&&8232!==a&&8233!==a||E(l,"Unterminated string constant"),r+=String.fromCharCode(a),++s}}(t);case 47:return function(){var t=n.charCodeAt(s+1);return p?(++s,te()):61===t?Kt(gt,2):Kt(pt,1)}();case 37:case 42:return 61===n.charCodeAt(s+1)?Kt(gt,2):Kt(kt,1);case 124:case 38:return function(t){var e=n.charCodeAt(s+1);return e===t?Kt(124===t?bt:xt,2):61===e?Kt(gt,2):Kt(124===t?_t:St,1)}(t);case 94:return 61===n.charCodeAt(s+1)?Kt(gt,2):Kt(wt,1);case 43:case 45:return function(t){var e=n.charCodeAt(s+1);return e===t?45==e&&62==n.charCodeAt(s+2)&&jt.test(n.slice(y,s))?(s+=3,Yt(),Xt(),Jt()):Kt(vt,2):61===e?Kt(gt,2):Kt(Tt,1)}(t);case 60:case 62:return function(t){var e=n.charCodeAt(s+1),i=1;return e===t?(i=62===t&&62===n.charCodeAt(s+2)?3:2,61===n.charCodeAt(s+i)?Kt(gt,i+1):Kt(Ct,i)):33==e&&60==t&&45==n.charCodeAt(s+2)&&45==n.charCodeAt(s+3)?(s+=4,Yt(),Xt(),Jt()):(61===e&&(i=61===n.charCodeAt(s+2)?3:2),Kt(Mt,i))}(t);case 61:case 33:return function(t){return 61===n.charCodeAt(s+1)?Kt(Et,61===n.charCodeAt(s+2)?3:2):Kt(61===t?mt:yt,1)}(t);case 126:return Kt(yt,1)}return!1}function Jt(t){if(t?s=l+1:l=s,e.locations&&(c=new Wt),t)return te();if(s>=i)return $t(A);var r=n.charCodeAt(s);if(Ht(r)||92===r)return ae();var a=Zt(r);if(!1===a){var o=String.fromCharCode(r);if("\\"===o||Ft.test(o))return ae();E(s,"Unexpected character '"+o+"'")}return a}function Kt(t,e){var i=n.slice(s,s+e);s+=e,$t(t,i)}function te(){for(var t,e,r=s;;){s>=i&&E(r,"Unterminated regular expression");var a=n.charAt(s);if(jt.test(a)&&E(r,"Unterminated regular expression"),t)t=!1;else{if("["===a)e=!0;else if("]"===a&&e)e=!1;else if("/"===a&&!e)break;t="\\"===a}++s}var o=n.slice(r,s);++s;var l=re();l&&!/^[gmsiy]*$/.test(l)&&E(r,"Invalid regexp flag");try{var u=new RegExp(o,l)}catch(t){t instanceof SyntaxError&&E(r,t.message),E(t)}return $t(T,u)}function ee(t,e){for(var i=s,r=0,a=0,o=null==e?1/0:e;a<o;++a){var l,u=n.charCodeAt(s);if((l=u>=97?u-97+10:u>=65?u-65+10:u>=48&&u<=57?u-48:1/0)>=t)break;++s,r=r*t+l}return s===i||null!=e&&s-i!==e?null:r}function ne(t){var e=s,i=!1,r=48===n.charCodeAt(s);t||null!==ee(10)||E(e,"Invalid number"),46===n.charCodeAt(s)&&(++s,ee(10),i=!0);var a=n.charCodeAt(s);69!==a&&101!==a||(43!==(a=n.charCodeAt(++s))&&45!==a||++s,null===ee(10)&&E(e,"Invalid number"),i=!0),Ht(n.charCodeAt(s))&&E(s,"Identifier directly after number");var o,l=n.slice(e,s);return i?o=parseFloat(l):r&&1!==l.length?/[89]/.test(l)||w?E(e,"Invalid number"):o=parseInt(l,8):o=parseInt(l,10),$t(C,o)}function ie(t){var e=ee(16,t);return null===e&&E(l,"Bad character escape sequence"),e}function re(){Ot=!1;for(var t,e=!0,i=s;;){var r=n.charCodeAt(s);if(Gt(r))Ot&&(t+=n.charAt(s)),++s;else{if(92!==r)break;Ot||(t=n.slice(i,s)),Ot=!0,117!=n.charCodeAt(++s)&&E(s,"Expecting Unicode escape sequence \\uXXXX"),++s;var a=ie(4),o=String.fromCharCode(a);o||E(s-1,"Invalid Unicode escape"),(e?Ht(a):Gt(a))||E(s-4,"Invalid Unicode escape"),t+=o}e=!1}return Ot?t:n.slice(i,s)}function ae(){var t=re(),e=P;return!Ot&&Dt(t)&&(e=nt[t]),$t(e,t)}function oe(){v=l,y=u,b=h,Jt()}function se(t){if(w=t,s=l,e.locations)for(;s<g;)g=n.lastIndexOf("\n",g-2)+1,--m;Xt(),Jt()}function le(){this.type=null,this.start=l,this.end=null}function ue(){this.start=c,this.end=null,null!==r&&(this.source=r)}function ce(){var t=new le;return e.locations&&(t.loc=new ue),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[l,0]),t}function he(t){var n=new le;return n.start=t.start,e.locations&&(n.loc=new ue,n.loc.start=t.loc.start),e.ranges&&(n.range=[t.range[0],0]),n}function de(t,n){return t.type=n,t.end=y,e.locations&&(t.loc.end=b),e.ranges&&(t.range[1]=y),t}function fe(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function pe(t){if(d===t)return oe(),!0}function me(){return!e.strictSemicolons&&(d===A||d===ot||jt.test(n.slice(y,l)))}function ge(){pe(ct)||me()||ye()}function ve(t){d===t?oe():ye()}function ye(){E(l,"Unexpected token")}function be(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&E(t.start,"Assigning to rvalue"),w&&"Identifier"===t.type&&Nt(t.name)&&E(t.start,"Assigning to "+t.name+" in strict mode")}var xe={kind:"loop"},_e={kind:"switch"};function we(){(d===pt||d===gt&&"/="==f)&&Jt(!0);var t=d,i=ce();switch(t){case O:case I:oe();var r=t===O;pe(ct)||me()?i.label=null:d!==P?ye():(i.label=De(),ge());for(var a=0;a<_.length;++a){var o=_[a];if(null==i.label||o.name===i.label.name){if(null!=o.kind&&(r||"loop"===o.kind))break;if(i.label&&r)break}}return a===_.length&&E(i.start,"Unsyntactic "+t.keyword),de(i,r?"BreakStatement":"ContinueStatement");case N:return oe(),ge(),de(i,"DebuggerStatement");case z:return oe(),_.push(xe),i.body=we(),_.pop(),ve(Q),i.test=Se(),ge(),de(i,"DoWhileStatement");case V:if(oe(),_.push(xe),ve(st),d===ct)return Me(i,null);if(d===$){var s=ce();return oe(),Te(s,!0),de(s,"VariableDeclaration"),1===s.declarations.length&&pe(et)?Ce(i,s):Me(i,s)}return s=ke(!1,!0),pe(et)?(be(s),Ce(i,s)):Me(i,s);case j:return oe(),Ie(i,!0);case U:return oe(),i.test=Se(),i.consequent=we(),i.alternate=pe(B)?we():null,de(i,"IfStatement");case H:return x||e.allowReturnOutsideFunction||E(l,"'return' outside of function"),oe(),pe(ct)||me()?i.argument=null:(i.argument=ke(),ge()),de(i,"ReturnStatement");case G:oe(),i.discriminant=Se(),i.cases=[],ve(at),_.push(_e);for(var u,c;d!=ot;)if(d===L||d===D){var h=d===L;u&&de(u,"SwitchCase"),i.cases.push(u=ce()),u.consequent=[],oe(),h?u.test=ke():(c&&E(v,"Multiple default clauses"),c=!0,u.test=null),ve(ht)}else u||ye(),u.consequent.push(we());return u&&de(u,"SwitchCase"),oe(),_.pop(),de(i,"SwitchStatement");case W:return oe(),jt.test(n.slice(y,l))&&E(y,"Illegal newline after throw"),i.argument=ke(),ge(),de(i,"ThrowStatement");case q:if(oe(),i.block=Ee(),i.handler=null,d===R){var p=ce();oe(),ve(st),p.param=De(),w&&Nt(p.param.name)&&E(p.param.start,"Binding "+p.param.name+" in strict mode"),ve(lt),p.guard=null,p.body=Ee(),i.handler=de(p,"CatchClause")}return i.guardedHandlers=M,i.finalizer=pe(F)?Ee():null,i.handler||i.finalizer||E(i.start,"Missing catch or finally clause"),de(i,"TryStatement");case $:return oe(),Te(i),ge(),de(i,"VariableDeclaration");case Q:return oe(),i.test=Se(),_.push(xe),i.body=we(),_.pop(),de(i,"WhileStatement");case Y:return w&&E(l,"'with' in strict mode"),oe(),i.object=Se(),i.body=we(),de(i,"WithStatement");case at:return Ee();case ct:return oe(),de(i,"EmptyStatement");default:var m=f,g=ke();if(t===P&&"Identifier"===g.type&&pe(ht)){for(a=0;a<_.length;++a)_[a].name===m&&E(g.start,"Label '"+m+"' is already declared");var b=d.isLoop?"loop":d===G?"switch":null;return _.push({name:m,kind:b}),i.body=we(),_.pop(),i.label=g,de(i,"LabeledStatement")}return i.expression=g,ge(),de(i,"ExpressionStatement")}}function Se(){ve(st);var t=ke();return ve(lt),t}function Ee(t){var e,n=ce(),i=!0,r=!1;for(n.body=[],ve(at);!pe(ot);){var a=we();n.body.push(a),i&&t&&fe(a)&&(e=r,se(r=!0)),i=!1}return r&&!e&&se(!1),de(n,"BlockStatement")}function Me(t,e){return t.init=e,ve(ct),t.test=d===ct?null:ke(),ve(ct),t.update=d===lt?null:ke(),ve(lt),t.body=we(),_.pop(),de(t,"ForStatement")}function Ce(t,e){return t.left=e,t.right=ke(),ve(lt),t.body=we(),_.pop(),de(t,"ForInStatement")}function Te(t,e){for(t.declarations=[],t.kind="var";;){var n=ce();if(n.id=De(),w&&Nt(n.id.name)&&E(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=pe(mt)?ke(!0,e):null,t.declarations.push(de(n,"VariableDeclarator")),!pe(ut))break}return t}function ke(t,e){var n=Pe(e);if(!t&&d===ut){var i=he(n);for(i.expressions=[n];pe(ut);)i.expressions.push(Pe(e));return de(i,"SequenceExpression")}return n}function Pe(t){var e=function(t){var e=function(t){return function t(e,n,i){var r=d.binop;if(null!=r&&(!i||d!==et)&&r>n){var a=he(e);a.left=e,a.operator=f;var o=d;oe(),a.right=t(Ae(),r,i);var s=de(a,o===bt||o===xt?"LogicalExpression":"BinaryExpression");return t(s,n,i)}return e}(Ae(),-1,t)}(t);if(pe(ft)){var n=he(e);return n.test=e,n.consequent=ke(!0),ve(ht),n.alternate=ke(!0,t),de(n,"ConditionalExpression")}return e}(t);if(d.isAssign){var n=he(e);return n.operator=f,n.left=e,oe(),n.right=Pe(t),be(e),de(n,"AssignmentExpression")}return e}function Ae(){if(d.prefix){var t=ce(),e=d.isUpdate;return t.operator=f,t.prefix=!0,p=!0,oe(),t.argument=Ae(),e?be(t.argument):w&&"delete"===t.operator&&"Identifier"===t.argument.type&&E(t.start,"Deleting local variable in strict mode"),de(t,e?"UpdateExpression":"UnaryExpression")}for(var n=Oe(Le());d.postfix&&!me();)(t=he(n)).operator=f,t.prefix=!1,t.argument=n,be(n),oe(),n=de(t,"UpdateExpression");return n}function Oe(t,e){var n;return pe(dt)?((n=he(t)).object=t,n.property=De(!0),n.computed=!1,Oe(de(n,"MemberExpression"),e)):pe(it)?((n=he(t)).object=t,n.property=ke(),n.computed=!0,ve(rt),Oe(de(n,"MemberExpression"),e)):!e&&pe(st)?((n=he(t)).callee=t,n.arguments=Ne(lt,!1),Oe(de(n,"CallExpression"),e)):t}function Le(){switch(d){case Z:var t=ce();return oe(),de(t,"ThisExpression");case P:return De();case C:case k:case T:return(t=ce()).value=f,t.raw=n.slice(l,u),oe(),de(t,"Literal");case J:case K:case tt:return(t=ce()).value=d.atomValue,t.raw=d.keyword,oe(),de(t,"Literal");case st:var i=c,r=l;oe();var a=ke();return a.start=r,a.end=u,e.locations&&(a.loc.start=i,a.loc.end=h),e.ranges&&(a.range=[r,u]),ve(lt),a;case it:return t=ce(),oe(),t.elements=Ne(rt,!0,!0),de(t,"ArrayExpression");case at:return function(){var t=ce(),n=!0,i=!1;for(t.properties=[],oe();!pe(ot);){if(n)n=!1;else if(ve(ut),e.allowTrailingCommas&&pe(ot))break;var r,a={key:Re()},o=!1;if(pe(ht)?(a.value=ke(!0),r=a.kind="init"):e.ecmaVersion>=5&&"Identifier"===a.key.type&&("get"===a.key.name||"set"===a.key.name)?(o=i=!0,r=a.kind=a.key.name,a.key=Re(),d!==st&&ye(),a.value=Ie(ce(),!1)):ye(),"Identifier"===a.key.type&&(w||i))for(var s=0;s<t.properties.length;++s){var l=t.properties[s];if(l.key.name===a.key.name){var u=r==l.kind||o&&"init"===l.kind||"init"===r&&("get"===l.kind||"set"===l.kind);u&&!w&&"init"===r&&"init"===l.kind&&(u=!1),u&&E(a.key.start,"Redefinition of property")}}t.properties.push(a)}return de(t,"ObjectExpression")}();case j:return t=ce(),oe(),Ie(t,!1);case X:return function(){var t=ce();return oe(),t.callee=Oe(Le(),!0),pe(st)?t.arguments=Ne(lt,!1):t.arguments=M,de(t,"NewExpression")}();default:ye()}}function Re(){return d===C||d===k?Le():De(!0)}function Ie(t,e){d===P?t.id=De():e?ye():t.id=null,t.params=[];var n=!0;for(ve(st);!pe(lt);)n?n=!1:ve(ut),t.params.push(De());var i=x,r=_;if(x=!0,_=[],t.body=Ee(!0),x=i,_=r,w||t.body.body.length&&fe(t.body.body[0]))for(var a=t.id?-1:0;a<t.params.length;++a){var o=a<0?t.id:t.params[a];if((It(o.name)||Nt(o.name))&&E(o.start,"Defining '"+o.name+"' in strict mode"),a>=0)for(var s=0;s<a;++s)o.name===t.params[s].name&&E(o.start,"Argument name clash in strict mode")}return de(t,e?"FunctionDeclaration":"FunctionExpression")}function Ne(t,n,i){for(var r=[],a=!0;!pe(t);){if(a)a=!1;else if(ve(ut),n&&e.allowTrailingCommas&&pe(t))break;i&&d===ut?r.push(null):r.push(ke(!0))}return r}function De(t){var i=ce();return t&&"everywhere"==e.forbidReserved&&(t=!1),d===P?(!t&&(e.forbidReserved&&(3===e.ecmaVersion?Lt:Rt)(f)||w&&It(f))&&-1==n.slice(l,u).indexOf("\\")&&E(l,"The keyword '"+f+"' is reserved"),i.name=f):t&&d.keyword?i.name=d.keyword:ye(),p=!1,oe(),de(i,"Identifier")}},"object"==typeof t&&"object"==typeof e?h(t):(i=[t],(a="function"==typeof(r=h)?r.apply(t,i):r)===s||(e.exports=a)),p.version||(p=null));function m(t,e){return(f.acorn||p).parse(t,e)}var g={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},v={"-":"__negate","+":"__self"},b=c.each(["add","subtract","multiply","divide","modulo","equals","negate"],(function(t){this["__"+t]="#"+t}),{__self:function(){return this}});function _(t,e,n){var i=g[e];if(t&&t[i]){var r=t[i](n);return"!="===e?!r:r}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"==":return t==n;case"!=":return t!=n}}function w(t,e){var n=v[t];if(e&&e[n])return e[n]();switch(t){case"+":return+e;case"-":return-e}}function S(t,e){if(!t)return"";var n=[];function i(t){for(var e=0,i=n.length;e<i;e++){var r=n[e];if(r[0]>=t)break;t+=r[1]}return t}function r(e){return t.substring(i(e.range[0]),i(e.range[1]))}function a(e,r){for(var a=i(e.range[0]),o=i(e.range[1]),s=0,l=n.length-1;l>=0;l--)if(a>n[l][0]){s=l+1;break}n.splice(s,0,[a,r.length-o+a]),t=t.substring(0,a)+r+t.substring(o)}function s(e,n){switch(e.type){case"UnaryExpression":if(e.operator in v&&"Literal"!==e.argument.type){var o=r(e.argument);a(e,'$__("'+e.operator+'", '+o+")")}break;case"BinaryExpression":if(e.operator in g&&"Literal"!==e.left.type){var s=r(e.left),l=r(e.right),u=function(e,n){return t.substring(i(e.range[1]),i(n.range[0]))}(e.left,e.right),c=e.operator;a(e,"__$__("+s+","+u.replace(new RegExp("\\"+c),'"'+c+'"')+", "+l+")")}break;case"UpdateExpression":case"AssignmentExpression":var h=n&&n.type;if(!("ForStatement"===h||"BinaryExpression"===h&&/^[=!<>]/.test(n.operator)||"MemberExpression"===h&&n.computed))if("UpdateExpression"===e.type){var d=(o=r(e.argument))+" = "+(f="__$__("+o+', "'+e.operator[0]+'", 1)');e.prefix?d="("+d+")":"AssignmentExpression"!==h&&"VariableDeclarator"!==h&&"BinaryExpression"!==h||(r(n.left||n.id)===o&&(d=f),d=o+"; "+d),a(e,d)}else if(/^.=$/.test(e.operator)&&"Literal"!==e.left.type){s=r(e.left),l=r(e.right);var f=s+" = __$__("+s+', "'+e.operator[0]+'", '+l+")";a(e,/^\(.*\)$/.test(r(e))?"("+f+")":f)}}}var c,h=(e=e||{}).url||"",d=e.sourceMaps,f=e.paperFeatures||{},p=e.source||t,y=e.offset||0,b=dt.agent,x=b.versionNumber,_=!1,w=/\r\n|\n|\r/gm;if(d&&(b.chrome&&x>=30||b.webkit&&x>=537.76||b.firefox&&x>=23||b.node)){if(b.node)y-=2;else if(l&&h&&!l.location.href.indexOf(h)){var S=u.getElementsByTagName("html")[0].innerHTML;y=S.substr(0,S.indexOf(t)+1).match(w).length+1}var E=["AA"+function(t){var e="";for(t=(Math.abs(t)<<1)+(t<0?1:0);t||!e;){var n=31&t;(t>>=5)&&(n|=32),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n]}return e}((_=y>0&&!(b.chrome&&x>=36||b.safari&&x>=600||b.firefox&&x>=40||b.node))?0:y)+"A"];E.length=(t.match(w)||[]).length+1+(_?y:0),c={version:3,file:h,names:[],mappings:E.join(";AACA"),sourceRoot:"",sources:[h],sourcesContent:[p]}}return!1===f.operatorOverloading&&!1===f.moduleExports||function t(e,n,i){if(e){for(var o in e)if("range"!==o&&"loc"!==o){var l=e[o];if(Array.isArray(l))for(var u=0,c=l.length;u<c;u++)t(l[u],e,i);else l&&"object"==typeof l&&t(l,e,i)}!1!==i.operatorOverloading&&s(e,n),!1!==i.moduleExports&&function(t){switch(t.type){case"ExportDefaultDeclaration":a({range:[t.start,t.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var e=t.declaration,n=t.specifiers;if(e){var i=e.declarations;i&&(i.forEach((function(t){a(t,"module.exports."+r(t))})),a({range:[t.start,e.start+e.kind.length]},""))}else if(n){var o=n.map((function(t){var e=r(t);return"module.exports."+e+" = "+e+"; "})).join("");o&&a(t,o)}}}(e)}}(m(t,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,f),c&&(_&&(t=new Array(y+1).join("\n")+t),/^(inline|both)$/.test(d)&&(t+="\n//# sourceMappingURL=data:application/json;base64,"+o.btoa(unescape(encodeURIComponent(JSON.stringify(c))))),t+="\n//# sourceURL="+(h||"paperscript")),{url:h,source:p,code:t,map:c}}function E(t,e,n){dt=e;var i,r=e.getView(),a=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)&&!/\bnew\s+Tool\b/.test(t)?new at:null,o=a?a._events:[],s=["onFrame","onResize"].concat(o),l=[],h=[],d="object"==typeof t?t:S(t,n);function f(e,n){for(var i in e)!n&&/^_/.test(i)||!new RegExp("([\\b\\s\\W]|^)"+i.replace(/\$/g,"\\$")+"\\b").test(t)||(l.push(i),h.push(e[i]))}t=d.code,f({__$__:_,$__:w,paper:e,tool:a},!0),f(e),t="var module = { exports: {} }; "+t,(v=c.each(s,(function(e){new RegExp("\\s+"+e+"\\b").test(t)&&(l.push(e),this.push("module.exports."+e+" = "+e+";"))}),[]).join("\n"))&&(t+="\n"+v),t+="\nreturn module.exports;";var p=dt.agent;if(u&&(p.chrome||p.firefox&&p.versionNumber<40)){var m=u.createElement("script"),g=u.head||u.getElementsByTagName("head")[0];p.firefox&&(t="\n"+t),m.appendChild(u.createTextNode("document.__paperscript__ = function("+l+") {"+t+"\n}")),g.appendChild(m),i=u.__paperscript__,delete u.__paperscript__,g.removeChild(m)}else i=Function(l,t);var v,b=(v=i&&i.apply(e,h))||{};return c.each(o,(function(t){var e=b[t];e&&(a[t]=e)})),r&&(b.onResize&&r.setOnResize(b.onResize),r.emit("resize",{size:r.size,delta:new y}),b.onFrame&&r.setOnFrame(b.onFrame),r.requestUpdate()),v}function M(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==d.getAttribute(t,"ignore")){var e=d.getAttribute(t,"canvas"),n=u.getElementById(e),i=t.src||t.getAttribute("data-src"),r=d.hasAttribute(t,"async");if(!n)throw new Error('Unable to find canvas with id "'+e+'"');var a=d.get(n.getAttribute("data-paper-scope"))||(new d).setup(n);return n.setAttribute("data-paper-scope",a._id),i?st({url:i,async:r,mimeType:"text/plain",onLoad:function(t){E(t,a,i)}}):E(t.innerHTML,a,t.baseURI),t.setAttribute("data-paper-ignore","true"),a}}function C(){c.each(u&&u.getElementsByTagName("script"),M)}return y.inject(b),x.inject(b),q.inject(b),l&&("complete"===u.readyState?setTimeout(C):Z.add(l,{load:C})),{compile:S,execute:E,load:function(t){return t?M(t):C()},parse:m,calculateBinary:_,calculateUnary:w}}.call(this);var dt=new(d.inject(c.exports,{Base:c,Numerical:g,Key:nt,DomEvent:Z,DomElement:X,document:u,window:l,Symbol:R,PlacedSymbol:L}));return dt.agent.node&&n(359)(dt),(a="function"==typeof(r=dt)?r.call(e,n,e,t):r)===s||(t.exports=a),dt}).call(this,"object"==typeof self?self:null)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReactCSS=e.loop=e.handleActive=e.handleHover=e.hover=void 0;var i=u(n(192)),r=u(n(263)),a=u(n(283)),o=u(n(284)),s=u(n(285)),l=u(n(286));function u(t){return t&&t.__esModule?t:{default:t}}e.hover=o.default,e.handleHover=o.default,e.handleActive=s.default,e.loop=l.default;var c=e.ReactCSS=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var s=(0,i.default)(n),l=(0,r.default)(t,s);return(0,a.default)(l)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(287);Object.defineProperty(e,"Alpha",{enumerable:!0,get:function(){return h(i).default}});var r=n(65);Object.defineProperty(e,"Checkboard",{enumerable:!0,get:function(){return h(r).default}});var a=n(290);Object.defineProperty(e,"EditableInput",{enumerable:!0,get:function(){return h(a).default}});var o=n(291);Object.defineProperty(e,"Hue",{enumerable:!0,get:function(){return h(o).default}});var s=n(293);Object.defineProperty(e,"Raised",{enumerable:!0,get:function(){return h(s).default}});var l=n(309);Object.defineProperty(e,"Saturation",{enumerable:!0,get:function(){return h(l).default}});var u=n(133);Object.defineProperty(e,"ColorWrap",{enumerable:!0,get:function(){return h(u).default}});var c=n(317);function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Swatch",{enumerable:!0,get:function(){return h(c).default}})},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){t.exports=n(294)()},function(t,e,n){var i=n(296),r=n(300)((function(t,e,n){i(t,e,n)}));t.exports=r},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(n,i){function r(){void 0!==a&&t.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==e&&(a=function(n){t.removeListener(e,r),i(n)},t.once("error",a)),t.once(e,r)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n,i){var r,a,o,s;if(u(n),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),o=a[e]),void 0===o)o=a[e]=n,++t._eventsCount;else if("function"==typeof o?o=a[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=c(t))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,s=l,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function p(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):g(r,r.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)a(l,this,e);else{var u=l.length,c=g(l,u);for(n=0;n<u;++n)a(c[n],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,f(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,f(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,i,r,a,o;if(u(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e,n){var i=n(101),r="object"==typeof self&&self&&self.Object===Object&&self,a=i||r||Function("return this")();t.exports=a},function(t,e,n){(function(t,i){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var a="Expected a function",o="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],l="[object Arguments]",u="[object Array]",c="[object Boolean]",h="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",m="[object Map]",g="[object Number]",v="[object Object]",y="[object RegExp]",b="[object Set]",x="[object String]",_="[object Symbol]",w="[object WeakMap]",S="[object ArrayBuffer]",E="[object DataView]",M="[object Float32Array]",C="[object Float64Array]",T="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",A="[object Uint8Array]",O="[object Uint16Array]",L="[object Uint32Array]",R=/\b__p \+= '';/g,I=/\b(__p \+=) '' \+/g,N=/(__e\(.*?\)|\b__t\)) \+\n'';/g,D=/&(?:amp|lt|gt|quot|#39);/g,z=/[&<>"']/g,B=RegExp(D.source),F=RegExp(z.source),V=/<%-([\s\S]+?)%>/g,j=/<%([\s\S]+?)%>/g,U=/<%=([\s\S]+?)%>/g,H=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,$=RegExp(q.source),Q=/^\s+|\s+$/g,Y=/^\s+/,X=/\s+$/,Z=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,J=/\{\n\/\* \[wrapped with (.+)\] \*/,K=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,it=/\w*$/,rt=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,ot=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,lt=/^(?:0|[1-9]\d*)$/,ut=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ct=/($^)/,ht=/['\n\r\u2028\u2029\\]/g,dt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ft="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",mt="["+ft+"]",gt="["+dt+"]",vt="\\d+",yt="[\\u2700-\\u27bf]",bt="[a-z\\xdf-\\xf6\\xf8-\\xff]",xt="[^\\ud800-\\udfff"+ft+vt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_t="\\ud83c[\\udffb-\\udfff]",wt="[^\\ud800-\\udfff]",St="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",Mt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ct="(?:"+bt+"|"+xt+")",Tt="(?:"+Mt+"|"+xt+")",kt="(?:"+gt+"|"+_t+")"+"?",Pt="[\\ufe0e\\ufe0f]?"+kt+("(?:\\u200d(?:"+[wt,St,Et].join("|")+")[\\ufe0e\\ufe0f]?"+kt+")*"),At="(?:"+[yt,St,Et].join("|")+")"+Pt,Ot="(?:"+[wt+gt+"?",gt,St,Et,pt].join("|")+")",Lt=RegExp("[']","g"),Rt=RegExp(gt,"g"),It=RegExp(_t+"(?="+_t+")|"+Ot+Pt,"g"),Nt=RegExp([Mt+"?"+bt+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[mt,Mt,"$"].join("|")+")",Tt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[mt,Mt+Ct,"$"].join("|")+")",Mt+"?"+Ct+"+(?:['](?:d|ll|m|re|s|t|ve))?",Mt+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vt,At].join("|"),"g"),Dt=RegExp("[\\u200d\\ud800-\\udfff"+dt+"\\ufe0e\\ufe0f]"),zt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Bt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ft=-1,Vt={};Vt[M]=Vt[C]=Vt[T]=Vt[k]=Vt[P]=Vt[A]=Vt["[object Uint8ClampedArray]"]=Vt[O]=Vt[L]=!0,Vt[l]=Vt[u]=Vt[S]=Vt[c]=Vt[E]=Vt[h]=Vt[d]=Vt[f]=Vt[m]=Vt[g]=Vt[v]=Vt[y]=Vt[b]=Vt[x]=Vt[w]=!1;var jt={};jt[l]=jt[u]=jt[S]=jt[E]=jt[c]=jt[h]=jt[M]=jt[C]=jt[T]=jt[k]=jt[P]=jt[m]=jt[g]=jt[v]=jt[y]=jt[b]=jt[x]=jt[_]=jt[A]=jt["[object Uint8ClampedArray]"]=jt[O]=jt[L]=!0,jt[d]=jt[f]=jt[w]=!1;var Ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ht=parseFloat,Gt=parseInt,Wt="object"==typeof t&&t&&t.Object===Object&&t,qt="object"==typeof self&&self&&self.Object===Object&&self,$t=Wt||qt||Function("return this")(),Qt=e&&!e.nodeType&&e,Yt=Qt&&"object"==typeof i&&i&&!i.nodeType&&i,Xt=Yt&&Yt.exports===Qt,Zt=Xt&&Wt.process,Jt=function(){try{var t=Yt&&Yt.require&&Yt.require("util").types;return t||Zt&&Zt.binding&&Zt.binding("util")}catch(t){}}(),Kt=Jt&&Jt.isArrayBuffer,te=Jt&&Jt.isDate,ee=Jt&&Jt.isMap,ne=Jt&&Jt.isRegExp,ie=Jt&&Jt.isSet,re=Jt&&Jt.isTypedArray;function ae(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function oe(t,e,n,i){for(var r=-1,a=null==t?0:t.length;++r<a;){var o=t[r];e(i,o,n(o),t)}return i}function se(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function le(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function ce(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a}function he(t,e){return!!(null==t?0:t.length)&&_e(t,e,0)>-1}function de(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function fe(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function pe(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function me(t,e,n,i){var r=-1,a=null==t?0:t.length;for(i&&a&&(n=t[++r]);++r<a;)n=e(n,t[r],r,t);return n}function ge(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function ve(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var ye=Me("length");function be(t,e,n){var i;return n(t,(function(t,n,r){if(e(t,n,r))return i=n,!1})),i}function xe(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1}function _e(t,e,n){return e==e?function(t,e,n){var i=n-1,r=t.length;for(;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):xe(t,Se,n)}function we(t,e,n,i){for(var r=n-1,a=t.length;++r<a;)if(i(t[r],e))return r;return-1}function Se(t){return t!=t}function Ee(t,e){var n=null==t?0:t.length;return n?ke(t,e)/n:NaN}function Me(t){return function(e){return null==e?void 0:e[t]}}function Ce(t){return function(e){return null==t?void 0:t[e]}}function Te(t,e,n,i,r){return r(t,(function(t,r,a){n=i?(i=!1,t):e(n,t,r,a)})),n}function ke(t,e){for(var n,i=-1,r=t.length;++i<r;){var a=e(t[i]);void 0!==a&&(n=void 0===n?a:n+a)}return n}function Pe(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function Ae(t){return function(e){return t(e)}}function Oe(t,e){return fe(e,(function(e){return t[e]}))}function Le(t,e){return t.has(e)}function Re(t,e){for(var n=-1,i=t.length;++n<i&&_e(e,t[n],0)>-1;);return n}function Ie(t,e){for(var n=t.length;n--&&_e(e,t[n],0)>-1;);return n}function Ne(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}var De=Ce({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),ze=Ce({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Be(t){return"\\"+Ut[t]}function Fe(t){return Dt.test(t)}function Ve(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function je(t,e){return function(n){return t(e(n))}}function Ue(t,e){for(var n=-1,i=t.length,r=0,a=[];++n<i;){var s=t[n];s!==e&&s!==o||(t[n]=o,a[r++]=n)}return a}function He(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Ge(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function We(t){return Fe(t)?function(t){var e=It.lastIndex=0;for(;It.test(t);)++e;return e}(t):ye(t)}function qe(t){return Fe(t)?function(t){return t.match(It)||[]}(t):function(t){return t.split("")}(t)}var $e=Ce({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Qe=function t(e){var n,i=(e=null==e?$t:Qe.defaults($t.Object(),e,Qe.pick($t,Bt))).Array,r=e.Date,dt=e.Error,ft=e.Function,pt=e.Math,mt=e.Object,gt=e.RegExp,vt=e.String,yt=e.TypeError,bt=i.prototype,xt=ft.prototype,_t=mt.prototype,wt=e["__core-js_shared__"],St=xt.toString,Et=_t.hasOwnProperty,Mt=0,Ct=(n=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Tt=_t.toString,kt=St.call(mt),Pt=$t._,At=gt("^"+St.call(Et).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=Xt?e.Buffer:void 0,It=e.Symbol,Dt=e.Uint8Array,Ut=Ot?Ot.allocUnsafe:void 0,Wt=je(mt.getPrototypeOf,mt),qt=mt.create,Qt=_t.propertyIsEnumerable,Yt=bt.splice,Zt=It?It.isConcatSpreadable:void 0,Jt=It?It.iterator:void 0,ye=It?It.toStringTag:void 0,Ce=function(){try{var t=Kr(mt,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ye=e.clearTimeout!==$t.clearTimeout&&e.clearTimeout,Xe=r&&r.now!==$t.Date.now&&r.now,Ze=e.setTimeout!==$t.setTimeout&&e.setTimeout,Je=pt.ceil,Ke=pt.floor,tn=mt.getOwnPropertySymbols,en=Ot?Ot.isBuffer:void 0,nn=e.isFinite,rn=bt.join,an=je(mt.keys,mt),on=pt.max,sn=pt.min,ln=r.now,un=e.parseInt,cn=pt.random,hn=bt.reverse,dn=Kr(e,"DataView"),fn=Kr(e,"Map"),pn=Kr(e,"Promise"),mn=Kr(e,"Set"),gn=Kr(e,"WeakMap"),vn=Kr(mt,"create"),yn=gn&&new gn,bn={},xn=Ca(dn),_n=Ca(fn),wn=Ca(pn),Sn=Ca(mn),En=Ca(gn),Mn=It?It.prototype:void 0,Cn=Mn?Mn.valueOf:void 0,Tn=Mn?Mn.toString:void 0;function kn(t){if(Go(t)&&!Ro(t)&&!(t instanceof Ln)){if(t instanceof On)return t;if(Et.call(t,"__wrapped__"))return Ta(t)}return new On(t)}var Pn=function(){function t(){}return function(e){if(!Ho(e))return{};if(qt)return qt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function An(){}function On(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Ln(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Rn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function In(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Dn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Nn;++e<n;)this.add(t[e])}function zn(t){var e=this.__data__=new In(t);this.size=e.size}function Bn(t,e){var n=Ro(t),i=!n&&Lo(t),r=!n&&!i&&zo(t),a=!n&&!i&&!r&&Jo(t),o=n||i||r||a,s=o?Pe(t.length,vt):[],l=s.length;for(var u in t)!e&&!Et.call(t,u)||o&&("length"==u||r&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||oa(u,l))||s.push(u);return s}function Fn(t){var e=t.length;return e?t[Di(0,e-1)]:void 0}function Vn(t,e){return Sa(vr(t),Yn(e,0,t.length))}function jn(t){return Sa(vr(t))}function Un(t,e,n){(void 0!==n&&!Po(t[e],n)||void 0===n&&!(e in t))&&$n(t,e,n)}function Hn(t,e,n){var i=t[e];Et.call(t,e)&&Po(i,n)&&(void 0!==n||e in t)||$n(t,e,n)}function Gn(t,e){for(var n=t.length;n--;)if(Po(t[n][0],e))return n;return-1}function Wn(t,e,n,i){return ti(t,(function(t,r,a){e(i,t,n(t),a)})),i}function qn(t,e){return t&&yr(e,xs(e),t)}function $n(t,e,n){"__proto__"==e&&Ce?Ce(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Qn(t,e){for(var n=-1,r=e.length,a=i(r),o=null==t;++n<r;)a[n]=o?void 0:ms(t,e[n]);return a}function Yn(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Xn(t,e,n,i,r,a){var o,s=1&e,u=2&e,d=4&e;if(n&&(o=r?n(t,i,r,a):n(t)),void 0!==o)return o;if(!Ho(t))return t;var w=Ro(t);if(w){if(o=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Et.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!s)return vr(t,o)}else{var R=na(t),I=R==f||R==p;if(zo(t))return hr(t,s);if(R==v||R==l||I&&!r){if(o=u||I?{}:ra(t),!s)return u?function(t,e){return yr(t,ea(t),e)}(t,function(t,e){return t&&yr(e,_s(e),t)}(o,t)):function(t,e){return yr(t,ta(t),e)}(t,qn(o,t))}else{if(!jt[R])return r?t:{};o=function(t,e,n){var i=t.constructor;switch(e){case S:return dr(t);case c:case h:return new i(+t);case E:return function(t,e){var n=e?dr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case M:case C:case T:case k:case P:case A:case"[object Uint8ClampedArray]":case O:case L:return fr(t,n);case m:return new i;case g:case x:return new i(t);case y:return function(t){var e=new t.constructor(t.source,it.exec(t));return e.lastIndex=t.lastIndex,e}(t);case b:return new i;case _:return r=t,Cn?mt(Cn.call(r)):{}}var r}(t,R,s)}}a||(a=new zn);var N=a.get(t);if(N)return N;a.set(t,o),Yo(t)?t.forEach((function(i){o.add(Xn(i,e,n,i,t,a))})):Wo(t)&&t.forEach((function(i,r){o.set(r,Xn(i,e,n,r,t,a))}));var D=w?void 0:(d?u?qr:Wr:u?_s:xs)(t);return se(D||t,(function(i,r){D&&(i=t[r=i]),Hn(o,r,Xn(i,e,n,r,t,a))})),o}function Zn(t,e,n){var i=n.length;if(null==t)return!i;for(t=mt(t);i--;){var r=n[i],a=e[r],o=t[r];if(void 0===o&&!(r in t)||!a(o))return!1}return!0}function Jn(t,e,n){if("function"!=typeof t)throw new yt(a);return ba((function(){t.apply(void 0,n)}),e)}function Kn(t,e,n,i){var r=-1,a=he,o=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=fe(e,Ae(n))),i?(a=de,o=!1):e.length>=200&&(a=Le,o=!1,e=new Dn(e));t:for(;++r<s;){var c=t[r],h=null==n?c:n(c);if(c=i||0!==c?c:0,o&&h==h){for(var d=u;d--;)if(e[d]===h)continue t;l.push(c)}else a(e,h,i)||l.push(c)}return l}kn.templateSettings={escape:V,evaluate:j,interpolate:U,variable:"",imports:{_:kn}},kn.prototype=An.prototype,kn.prototype.constructor=kn,On.prototype=Pn(An.prototype),On.prototype.constructor=On,Ln.prototype=Pn(An.prototype),Ln.prototype.constructor=Ln,Rn.prototype.clear=function(){this.__data__=vn?vn(null):{},this.size=0},Rn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Rn.prototype.get=function(t){var e=this.__data__;if(vn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Et.call(e,t)?e[t]:void 0},Rn.prototype.has=function(t){var e=this.__data__;return vn?void 0!==e[t]:Et.call(e,t)},Rn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=vn&&void 0===e?"__lodash_hash_undefined__":e,this},In.prototype.clear=function(){this.__data__=[],this.size=0},In.prototype.delete=function(t){var e=this.__data__,n=Gn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Yt.call(e,n,1),--this.size,!0)},In.prototype.get=function(t){var e=this.__data__,n=Gn(e,t);return n<0?void 0:e[n][1]},In.prototype.has=function(t){return Gn(this.__data__,t)>-1},In.prototype.set=function(t,e){var n=this.__data__,i=Gn(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Nn.prototype.clear=function(){this.size=0,this.__data__={hash:new Rn,map:new(fn||In),string:new Rn}},Nn.prototype.delete=function(t){var e=Zr(this,t).delete(t);return this.size-=e?1:0,e},Nn.prototype.get=function(t){return Zr(this,t).get(t)},Nn.prototype.has=function(t){return Zr(this,t).has(t)},Nn.prototype.set=function(t,e){var n=Zr(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},Dn.prototype.add=Dn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Dn.prototype.has=function(t){return this.__data__.has(t)},zn.prototype.clear=function(){this.__data__=new In,this.size=0},zn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},zn.prototype.get=function(t){return this.__data__.get(t)},zn.prototype.has=function(t){return this.__data__.has(t)},zn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof In){var i=n.__data__;if(!fn||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Nn(i)}return n.set(t,e),this.size=n.size,this};var ti=_r(li),ei=_r(ui,!0);function ni(t,e){var n=!0;return ti(t,(function(t,i,r){return n=!!e(t,i,r)})),n}function ii(t,e,n){for(var i=-1,r=t.length;++i<r;){var a=t[i],o=e(a);if(null!=o&&(void 0===s?o==o&&!Zo(o):n(o,s)))var s=o,l=a}return l}function ri(t,e){var n=[];return ti(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function ai(t,e,n,i,r){var a=-1,o=t.length;for(n||(n=aa),r||(r=[]);++a<o;){var s=t[a];e>0&&n(s)?e>1?ai(s,e-1,n,i,r):pe(r,s):i||(r[r.length]=s)}return r}var oi=wr(),si=wr(!0);function li(t,e){return t&&oi(t,e,xs)}function ui(t,e){return t&&si(t,e,xs)}function ci(t,e){return ce(e,(function(e){return Vo(t[e])}))}function hi(t,e){for(var n=0,i=(e=sr(e,t)).length;null!=t&&n<i;)t=t[Ma(e[n++])];return n&&n==i?t:void 0}function di(t,e,n){var i=e(t);return Ro(t)?i:pe(i,n(t))}function fi(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ye&&ye in mt(t)?function(t){var e=Et.call(t,ye),n=t[ye];try{t[ye]=void 0;var i=!0}catch(t){}var r=Tt.call(t);i&&(e?t[ye]=n:delete t[ye]);return r}(t):function(t){return Tt.call(t)}(t)}function pi(t,e){return t>e}function mi(t,e){return null!=t&&Et.call(t,e)}function gi(t,e){return null!=t&&e in mt(t)}function vi(t,e,n){for(var r=n?de:he,a=t[0].length,o=t.length,s=o,l=i(o),u=1/0,c=[];s--;){var h=t[s];s&&e&&(h=fe(h,Ae(e))),u=sn(h.length,u),l[s]=!n&&(e||a>=120&&h.length>=120)?new Dn(s&&h):void 0}h=t[0];var d=-1,f=l[0];t:for(;++d<a&&c.length<u;){var p=h[d],m=e?e(p):p;if(p=n||0!==p?p:0,!(f?Le(f,m):r(c,m,n))){for(s=o;--s;){var g=l[s];if(!(g?Le(g,m):r(t[s],m,n)))continue t}f&&f.push(m),c.push(p)}}return c}function yi(t,e,n){var i=null==(t=ma(t,e=sr(e,t)))?t:t[Ma(Ba(e))];return null==i?void 0:ae(i,t,n)}function bi(t){return Go(t)&&fi(t)==l}function xi(t,e,n,i,r){return t===e||(null==t||null==e||!Go(t)&&!Go(e)?t!=t&&e!=e:function(t,e,n,i,r,a){var o=Ro(t),s=Ro(e),f=o?u:na(t),p=s?u:na(e),w=(f=f==l?v:f)==v,M=(p=p==l?v:p)==v,C=f==p;if(C&&zo(t)){if(!zo(e))return!1;o=!0,w=!1}if(C&&!w)return a||(a=new zn),o||Jo(t)?Hr(t,e,n,i,r,a):function(t,e,n,i,r,a,o){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case S:return!(t.byteLength!=e.byteLength||!a(new Dt(t),new Dt(e)));case c:case h:case g:return Po(+t,+e);case d:return t.name==e.name&&t.message==e.message;case y:case x:return t==e+"";case m:var s=Ve;case b:var l=1&i;if(s||(s=He),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;i|=2,o.set(t,e);var f=Hr(s(t),s(e),i,r,a,o);return o.delete(t),f;case _:if(Cn)return Cn.call(t)==Cn.call(e)}return!1}(t,e,f,n,i,r,a);if(!(1&n)){var T=w&&Et.call(t,"__wrapped__"),k=M&&Et.call(e,"__wrapped__");if(T||k){var P=T?t.value():t,A=k?e.value():e;return a||(a=new zn),r(P,A,n,i,a)}}if(!C)return!1;return a||(a=new zn),function(t,e,n,i,r,a){var o=1&n,s=Wr(t),l=s.length,u=Wr(e).length;if(l!=u&&!o)return!1;var c=l;for(;c--;){var h=s[c];if(!(o?h in e:Et.call(e,h)))return!1}var d=a.get(t),f=a.get(e);if(d&&f)return d==e&&f==t;var p=!0;a.set(t,e),a.set(e,t);var m=o;for(;++c<l;){h=s[c];var g=t[h],v=e[h];if(i)var y=o?i(v,g,h,e,t,a):i(g,v,h,t,e,a);if(!(void 0===y?g===v||r(g,v,n,i,a):y)){p=!1;break}m||(m="constructor"==h)}if(p&&!m){var b=t.constructor,x=e.constructor;b==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(p=!1)}return a.delete(t),a.delete(e),p}(t,e,n,i,r,a)}(t,e,n,i,xi,r))}function _i(t,e,n,i){var r=n.length,a=r,o=!i;if(null==t)return!a;for(t=mt(t);r--;){var s=n[r];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<a;){var l=(s=n[r])[0],u=t[l],c=s[1];if(o&&s[2]){if(void 0===u&&!(l in t))return!1}else{var h=new zn;if(i)var d=i(u,c,l,t,e,h);if(!(void 0===d?xi(c,u,3,i,h):d))return!1}}return!0}function wi(t){return!(!Ho(t)||(e=t,Ct&&Ct in e))&&(Vo(t)?At:ot).test(Ca(t));var e}function Si(t){return"function"==typeof t?t:null==t?qs:"object"==typeof t?Ro(t)?Pi(t[0],t[1]):ki(t):el(t)}function Ei(t){if(!ha(t))return an(t);var e=[];for(var n in mt(t))Et.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Mi(t){if(!Ho(t))return function(t){var e=[];if(null!=t)for(var n in mt(t))e.push(n);return e}(t);var e=ha(t),n=[];for(var i in t)("constructor"!=i||!e&&Et.call(t,i))&&n.push(i);return n}function Ci(t,e){return t<e}function Ti(t,e){var n=-1,r=No(t)?i(t.length):[];return ti(t,(function(t,i,a){r[++n]=e(t,i,a)})),r}function ki(t){var e=Jr(t);return 1==e.length&&e[0][2]?fa(e[0][0],e[0][1]):function(n){return n===t||_i(n,t,e)}}function Pi(t,e){return la(t)&&da(e)?fa(Ma(t),e):function(n){var i=ms(n,t);return void 0===i&&i===e?gs(n,t):xi(e,i,3)}}function Ai(t,e,n,i,r){t!==e&&oi(e,(function(a,o){if(r||(r=new zn),Ho(a))!function(t,e,n,i,r,a,o){var s=va(t,n),l=va(e,n),u=o.get(l);if(u)return void Un(t,n,u);var c=a?a(s,l,n+"",t,e,o):void 0,h=void 0===c;if(h){var d=Ro(l),f=!d&&zo(l),p=!d&&!f&&Jo(l);c=l,d||f||p?Ro(s)?c=s:Do(s)?c=vr(s):f?(h=!1,c=hr(l,!0)):p?(h=!1,c=fr(l,!0)):c=[]:$o(l)||Lo(l)?(c=s,Lo(s)?c=os(s):Ho(s)&&!Vo(s)||(c=ra(l))):h=!1}h&&(o.set(l,c),r(c,l,i,a,o),o.delete(l));Un(t,n,c)}(t,e,o,n,Ai,i,r);else{var s=i?i(va(t,o),a,o+"",t,e,r):void 0;void 0===s&&(s=a),Un(t,o,s)}}),_s)}function Oi(t,e){var n=t.length;if(n)return oa(e+=e<0?n:0,n)?t[e]:void 0}function Li(t,e,n){e=e.length?fe(e,(function(t){return Ro(t)?function(e){return hi(e,1===t.length?t[0]:t)}:t})):[qs];var i=-1;return e=fe(e,Ae(Xr())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Ti(t,(function(t,n,r){return{criteria:fe(e,(function(e){return e(t)})),index:++i,value:t}})),(function(t,e){return function(t,e,n){var i=-1,r=t.criteria,a=e.criteria,o=r.length,s=n.length;for(;++i<o;){var l=pr(r[i],a[i]);if(l){if(i>=s)return l;var u=n[i];return l*("desc"==u?-1:1)}}return t.index-e.index}(t,e,n)}))}function Ri(t,e,n){for(var i=-1,r=e.length,a={};++i<r;){var o=e[i],s=hi(t,o);n(s,o)&&ji(a,sr(o,t),s)}return a}function Ii(t,e,n,i){var r=i?we:_e,a=-1,o=e.length,s=t;for(t===e&&(e=vr(e)),n&&(s=fe(t,Ae(n)));++a<o;)for(var l=0,u=e[a],c=n?n(u):u;(l=r(s,c,l,i))>-1;)s!==t&&Yt.call(s,l,1),Yt.call(t,l,1);return t}function Ni(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==a){var a=r;oa(r)?Yt.call(t,r,1):Ki(t,r)}}return t}function Di(t,e){return t+Ke(cn()*(e-t+1))}function zi(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=Ke(e/2))&&(t+=t)}while(e);return n}function Bi(t,e){return xa(pa(t,e,qs),t+"")}function Fi(t){return Fn(Ps(t))}function Vi(t,e){var n=Ps(t);return Sa(n,Yn(e,0,n.length))}function ji(t,e,n,i){if(!Ho(t))return t;for(var r=-1,a=(e=sr(e,t)).length,o=a-1,s=t;null!=s&&++r<a;){var l=Ma(e[r]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(r!=o){var c=s[l];void 0===(u=i?i(c,l,s):void 0)&&(u=Ho(c)?c:oa(e[r+1])?[]:{})}Hn(s,l,u),s=s[l]}return t}var Ui=yn?function(t,e){return yn.set(t,e),t}:qs,Hi=Ce?function(t,e){return Ce(t,"toString",{configurable:!0,enumerable:!1,value:Hs(e),writable:!0})}:qs;function Gi(t){return Sa(Ps(t))}function Wi(t,e,n){var r=-1,a=t.length;e<0&&(e=-e>a?0:a+e),(n=n>a?a:n)<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var o=i(a);++r<a;)o[r]=t[r+e];return o}function qi(t,e){var n;return ti(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}function $i(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var a=i+r>>>1,o=t[a];null!==o&&!Zo(o)&&(n?o<=e:o<e)?i=a+1:r=a}return r}return Qi(t,e,qs,n)}function Qi(t,e,n,i){var r=0,a=null==t?0:t.length;if(0===a)return 0;for(var o=(e=n(e))!=e,s=null===e,l=Zo(e),u=void 0===e;r<a;){var c=Ke((r+a)/2),h=n(t[c]),d=void 0!==h,f=null===h,p=h==h,m=Zo(h);if(o)var g=i||p;else g=u?p&&(i||d):s?p&&d&&(i||!f):l?p&&d&&!f&&(i||!m):!f&&!m&&(i?h<=e:h<e);g?r=c+1:a=c}return sn(a,4294967294)}function Yi(t,e){for(var n=-1,i=t.length,r=0,a=[];++n<i;){var o=t[n],s=e?e(o):o;if(!n||!Po(s,l)){var l=s;a[r++]=0===o?0:o}}return a}function Xi(t){return"number"==typeof t?t:Zo(t)?NaN:+t}function Zi(t){if("string"==typeof t)return t;if(Ro(t))return fe(t,Zi)+"";if(Zo(t))return Tn?Tn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ji(t,e,n){var i=-1,r=he,a=t.length,o=!0,s=[],l=s;if(n)o=!1,r=de;else if(a>=200){var u=e?null:zr(t);if(u)return He(u);o=!1,r=Le,l=new Dn}else l=e?[]:s;t:for(;++i<a;){var c=t[i],h=e?e(c):c;if(c=n||0!==c?c:0,o&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),s.push(c)}else r(l,h,n)||(l!==s&&l.push(h),s.push(c))}return s}function Ki(t,e){return null==(t=ma(t,e=sr(e,t)))||delete t[Ma(Ba(e))]}function tr(t,e,n,i){return ji(t,e,n(hi(t,e)),i)}function er(t,e,n,i){for(var r=t.length,a=i?r:-1;(i?a--:++a<r)&&e(t[a],a,t););return n?Wi(t,i?0:a,i?a+1:r):Wi(t,i?a+1:0,i?r:a)}function nr(t,e){var n=t;return n instanceof Ln&&(n=n.value()),me(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ir(t,e,n){var r=t.length;if(r<2)return r?Ji(t[0]):[];for(var a=-1,o=i(r);++a<r;)for(var s=t[a],l=-1;++l<r;)l!=a&&(o[a]=Kn(o[a]||s,t[l],e,n));return Ji(ai(o,1),e,n)}function rr(t,e,n){for(var i=-1,r=t.length,a=e.length,o={};++i<r;){var s=i<a?e[i]:void 0;n(o,t[i],s)}return o}function ar(t){return Do(t)?t:[]}function or(t){return"function"==typeof t?t:qs}function sr(t,e){return Ro(t)?t:la(t,e)?[t]:Ea(ss(t))}var lr=Bi;function ur(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:Wi(t,e,n)}var cr=Ye||function(t){return $t.clearTimeout(t)};function hr(t,e){if(e)return t.slice();var n=t.length,i=Ut?Ut(n):new t.constructor(n);return t.copy(i),i}function dr(t){var e=new t.constructor(t.byteLength);return new Dt(e).set(new Dt(t)),e}function fr(t,e){var n=e?dr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function pr(t,e){if(t!==e){var n=void 0!==t,i=null===t,r=t==t,a=Zo(t),o=void 0!==e,s=null===e,l=e==e,u=Zo(e);if(!s&&!u&&!a&&t>e||a&&o&&l&&!s&&!u||i&&o&&l||!n&&l||!r)return 1;if(!i&&!a&&!u&&t<e||u&&n&&r&&!i&&!a||s&&n&&r||!o&&r||!l)return-1}return 0}function mr(t,e,n,r){for(var a=-1,o=t.length,s=n.length,l=-1,u=e.length,c=on(o-s,0),h=i(u+c),d=!r;++l<u;)h[l]=e[l];for(;++a<s;)(d||a<o)&&(h[n[a]]=t[a]);for(;c--;)h[l++]=t[a++];return h}function gr(t,e,n,r){for(var a=-1,o=t.length,s=-1,l=n.length,u=-1,c=e.length,h=on(o-l,0),d=i(h+c),f=!r;++a<h;)d[a]=t[a];for(var p=a;++u<c;)d[p+u]=e[u];for(;++s<l;)(f||a<o)&&(d[p+n[s]]=t[a++]);return d}function vr(t,e){var n=-1,r=t.length;for(e||(e=i(r));++n<r;)e[n]=t[n];return e}function yr(t,e,n,i){var r=!n;n||(n={});for(var a=-1,o=e.length;++a<o;){var s=e[a],l=i?i(n[s],t[s],s,n,t):void 0;void 0===l&&(l=t[s]),r?$n(n,s,l):Hn(n,s,l)}return n}function br(t,e){return function(n,i){var r=Ro(n)?oe:Wn,a=e?e():{};return r(n,t,Xr(i,2),a)}}function xr(t){return Bi((function(e,n){var i=-1,r=n.length,a=r>1?n[r-1]:void 0,o=r>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(r--,a):void 0,o&&sa(n[0],n[1],o)&&(a=r<3?void 0:a,r=1),e=mt(e);++i<r;){var s=n[i];s&&t(e,s,i,a)}return e}))}function _r(t,e){return function(n,i){if(null==n)return n;if(!No(n))return t(n,i);for(var r=n.length,a=e?r:-1,o=mt(n);(e?a--:++a<r)&&!1!==i(o[a],a,o););return n}}function wr(t){return function(e,n,i){for(var r=-1,a=mt(e),o=i(e),s=o.length;s--;){var l=o[t?s:++r];if(!1===n(a[l],l,a))break}return e}}function Sr(t){return function(e){var n=Fe(e=ss(e))?qe(e):void 0,i=n?n[0]:e.charAt(0),r=n?ur(n,1).join(""):e.slice(1);return i[t]()+r}}function Er(t){return function(e){return me(Vs(Ls(e).replace(Lt,"")),t,"")}}function Mr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Pn(t.prototype),i=t.apply(n,e);return Ho(i)?i:n}}function Cr(t){return function(e,n,i){var r=mt(e);if(!No(e)){var a=Xr(n,3);e=xs(e),n=function(t){return a(r[t],t,r)}}var o=t(e,n,i);return o>-1?r[a?e[o]:o]:void 0}}function Tr(t){return Gr((function(e){var n=e.length,i=n,r=On.prototype.thru;for(t&&e.reverse();i--;){var o=e[i];if("function"!=typeof o)throw new yt(a);if(r&&!s&&"wrapper"==Qr(o))var s=new On([],!0)}for(i=s?i:n;++i<n;){var l=Qr(o=e[i]),u="wrapper"==l?$r(o):void 0;s=u&&ua(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[Qr(u[0])].apply(s,u[3]):1==o.length&&ua(o)?s[l]():s.thru(o)}return function(){var t=arguments,i=t[0];if(s&&1==t.length&&Ro(i))return s.plant(i).value();for(var r=0,a=n?e[r].apply(this,t):i;++r<n;)a=e[r].call(this,a);return a}}))}function kr(t,e,n,r,a,o,s,l,u,c){var h=128&e,d=1&e,f=2&e,p=24&e,m=512&e,g=f?void 0:Mr(t);return function v(){for(var y=arguments.length,b=i(y),x=y;x--;)b[x]=arguments[x];if(p)var _=Yr(v),w=Ne(b,_);if(r&&(b=mr(b,r,a,p)),o&&(b=gr(b,o,s,p)),y-=w,p&&y<c){var S=Ue(b,_);return Nr(t,e,kr,v.placeholder,n,b,S,l,u,c-y)}var E=d?n:this,M=f?E[t]:t;return y=b.length,l?b=ga(b,l):m&&y>1&&b.reverse(),h&&u<y&&(b.length=u),this&&this!==$t&&this instanceof v&&(M=g||Mr(M)),M.apply(E,b)}}function Pr(t,e){return function(n,i){return function(t,e,n,i){return li(t,(function(t,r,a){e(i,n(t),r,a)})),i}(n,t,e(i),{})}}function Ar(t,e){return function(n,i){var r;if(void 0===n&&void 0===i)return e;if(void 0!==n&&(r=n),void 0!==i){if(void 0===r)return i;"string"==typeof n||"string"==typeof i?(n=Zi(n),i=Zi(i)):(n=Xi(n),i=Xi(i)),r=t(n,i)}return r}}function Or(t){return Gr((function(e){return e=fe(e,Ae(Xr())),Bi((function(n){var i=this;return t(e,(function(t){return ae(t,i,n)}))}))}))}function Lr(t,e){var n=(e=void 0===e?" ":Zi(e)).length;if(n<2)return n?zi(e,t):e;var i=zi(e,Je(t/We(e)));return Fe(e)?ur(qe(i),0,t).join(""):i.slice(0,t)}function Rr(t){return function(e,n,r){return r&&"number"!=typeof r&&sa(e,n,r)&&(n=r=void 0),e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n,r){for(var a=-1,o=on(Je((e-t)/(n||1)),0),s=i(o);o--;)s[r?o:++a]=t,t+=n;return s}(e,n,r=void 0===r?e<n?1:-1:ns(r),t)}}function Ir(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=as(e),n=as(n)),t(e,n)}}function Nr(t,e,n,i,r,a,o,s,l,u){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var h=[t,e,r,c?a:void 0,c?o:void 0,c?void 0:a,c?void 0:o,s,l,u],d=n.apply(void 0,h);return ua(t)&&ya(d,h),d.placeholder=i,_a(d,t,e)}function Dr(t){var e=pt[t];return function(t,n){if(t=as(t),(n=null==n?0:sn(is(n),292))&&nn(t)){var i=(ss(t)+"e").split("e");return+((i=(ss(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var zr=mn&&1/He(new mn([,-0]))[1]==1/0?function(t){return new mn(t)}:Zs;function Br(t){return function(e){var n=na(e);return n==m?Ve(e):n==b?Ge(e):function(t,e){return fe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Fr(t,e,n,r,s,l,u,c){var h=2&e;if(!h&&"function"!=typeof t)throw new yt(a);var d=r?r.length:0;if(d||(e&=-97,r=s=void 0),u=void 0===u?u:on(is(u),0),c=void 0===c?c:is(c),d-=s?s.length:0,64&e){var f=r,p=s;r=s=void 0}var m=h?void 0:$r(t),g=[t,e,n,r,s,f,p,l,u,c];if(m&&function(t,e){var n=t[1],i=e[1],r=n|i,a=r<131,s=128==i&&8==n||128==i&&256==n&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!a&&!s)return t;1&i&&(t[2]=e[2],r|=1&n?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?mr(u,l,e[4]):l,t[4]=u?Ue(t[3],o):e[4]}(l=e[5])&&(u=t[5],t[5]=u?gr(u,l,e[6]):l,t[6]=u?Ue(t[5],o):e[6]);(l=e[7])&&(t[7]=l);128&i&&(t[8]=null==t[8]?e[8]:sn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=r}(g,m),t=g[0],e=g[1],n=g[2],r=g[3],s=g[4],!(c=g[9]=void 0===g[9]?h?0:t.length:on(g[9]-d,0))&&24&e&&(e&=-25),e&&1!=e)v=8==e||16==e?function(t,e,n){var r=Mr(t);return function a(){for(var o=arguments.length,s=i(o),l=o,u=Yr(a);l--;)s[l]=arguments[l];var c=o<3&&s[0]!==u&&s[o-1]!==u?[]:Ue(s,u);if((o-=c.length)<n)return Nr(t,e,kr,a.placeholder,void 0,s,c,void 0,void 0,n-o);var h=this&&this!==$t&&this instanceof a?r:t;return ae(h,this,s)}}(t,e,c):32!=e&&33!=e||s.length?kr.apply(void 0,g):function(t,e,n,r){var a=1&e,o=Mr(t);return function e(){for(var s=-1,l=arguments.length,u=-1,c=r.length,h=i(c+l),d=this&&this!==$t&&this instanceof e?o:t;++u<c;)h[u]=r[u];for(;l--;)h[u++]=arguments[++s];return ae(d,a?n:this,h)}}(t,e,n,r);else var v=function(t,e,n){var i=1&e,r=Mr(t);return function e(){var a=this&&this!==$t&&this instanceof e?r:t;return a.apply(i?n:this,arguments)}}(t,e,n);return _a((m?Ui:ya)(v,g),t,e)}function Vr(t,e,n,i){return void 0===t||Po(t,_t[n])&&!Et.call(i,n)?e:t}function jr(t,e,n,i,r,a){return Ho(t)&&Ho(e)&&(a.set(e,t),Ai(t,e,void 0,jr,a),a.delete(e)),t}function Ur(t){return $o(t)?void 0:t}function Hr(t,e,n,i,r,a){var o=1&n,s=t.length,l=e.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(t),c=a.get(e);if(u&&c)return u==e&&c==t;var h=-1,d=!0,f=2&n?new Dn:void 0;for(a.set(t,e),a.set(e,t);++h<s;){var p=t[h],m=e[h];if(i)var g=o?i(m,p,h,e,t,a):i(p,m,h,t,e,a);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!ve(e,(function(t,e){if(!Le(f,e)&&(p===t||r(p,t,n,i,a)))return f.push(e)}))){d=!1;break}}else if(p!==m&&!r(p,m,n,i,a)){d=!1;break}}return a.delete(t),a.delete(e),d}function Gr(t){return xa(pa(t,void 0,Ra),t+"")}function Wr(t){return di(t,xs,ta)}function qr(t){return di(t,_s,ea)}var $r=yn?function(t){return yn.get(t)}:Zs;function Qr(t){for(var e=t.name+"",n=bn[e],i=Et.call(bn,e)?n.length:0;i--;){var r=n[i],a=r.func;if(null==a||a==t)return r.name}return e}function Yr(t){return(Et.call(kn,"placeholder")?kn:t).placeholder}function Xr(){var t=kn.iteratee||$s;return t=t===$s?Si:t,arguments.length?t(arguments[0],arguments[1]):t}function Zr(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function Jr(t){for(var e=xs(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,da(r)]}return e}function Kr(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return wi(n)?n:void 0}var ta=tn?function(t){return null==t?[]:(t=mt(t),ce(tn(t),(function(e){return Qt.call(t,e)})))}:rl,ea=tn?function(t){for(var e=[];t;)pe(e,ta(t)),t=Wt(t);return e}:rl,na=fi;function ia(t,e,n){for(var i=-1,r=(e=sr(e,t)).length,a=!1;++i<r;){var o=Ma(e[i]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++i!=r?a:!!(r=null==t?0:t.length)&&Uo(r)&&oa(o,r)&&(Ro(t)||Lo(t))}function ra(t){return"function"!=typeof t.constructor||ha(t)?{}:Pn(Wt(t))}function aa(t){return Ro(t)||Lo(t)||!!(Zt&&t&&t[Zt])}function oa(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&lt.test(t))&&t>-1&&t%1==0&&t<e}function sa(t,e,n){if(!Ho(n))return!1;var i=typeof e;return!!("number"==i?No(n)&&oa(e,n.length):"string"==i&&e in n)&&Po(n[e],t)}function la(t,e){if(Ro(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Zo(t))||(G.test(t)||!H.test(t)||null!=e&&t in mt(e))}function ua(t){var e=Qr(t),n=kn[e];if("function"!=typeof n||!(e in Ln.prototype))return!1;if(t===n)return!0;var i=$r(n);return!!i&&t===i[0]}(dn&&na(new dn(new ArrayBuffer(1)))!=E||fn&&na(new fn)!=m||pn&&"[object Promise]"!=na(pn.resolve())||mn&&na(new mn)!=b||gn&&na(new gn)!=w)&&(na=function(t){var e=fi(t),n=e==v?t.constructor:void 0,i=n?Ca(n):"";if(i)switch(i){case xn:return E;case _n:return m;case wn:return"[object Promise]";case Sn:return b;case En:return w}return e});var ca=wt?Vo:al;function ha(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_t)}function da(t){return t==t&&!Ho(t)}function fa(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in mt(n)))}}function pa(t,e,n){return e=on(void 0===e?t.length-1:e,0),function(){for(var r=arguments,a=-1,o=on(r.length-e,0),s=i(o);++a<o;)s[a]=r[e+a];a=-1;for(var l=i(e+1);++a<e;)l[a]=r[a];return l[e]=n(s),ae(t,this,l)}}function ma(t,e){return e.length<2?t:hi(t,Wi(e,0,-1))}function ga(t,e){for(var n=t.length,i=sn(e.length,n),r=vr(t);i--;){var a=e[i];t[i]=oa(a,n)?r[a]:void 0}return t}function va(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ya=wa(Ui),ba=Ze||function(t,e){return $t.setTimeout(t,e)},xa=wa(Hi);function _a(t,e,n){var i=e+"";return xa(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(Z,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return se(s,(function(n){var i="_."+n[0];e&n[1]&&!he(t,i)&&t.push(i)})),t.sort()}(function(t){var e=t.match(J);return e?e[1].split(K):[]}(i),n)))}function wa(t){var e=0,n=0;return function(){var i=ln(),r=16-(i-n);if(n=i,r>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Sa(t,e){var n=-1,i=t.length,r=i-1;for(e=void 0===e?i:e;++n<e;){var a=Di(n,r),o=t[a];t[a]=t[n],t[n]=o}return t.length=e,t}var Ea=function(t){var e=So(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(W,(function(t,n,i,r){e.push(i?r.replace(et,"$1"):n||t)})),e}));function Ma(t){if("string"==typeof t||Zo(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ca(t){if(null!=t){try{return St.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ta(t){if(t instanceof Ln)return t.clone();var e=new On(t.__wrapped__,t.__chain__);return e.__actions__=vr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var ka=Bi((function(t,e){return Do(t)?Kn(t,ai(e,1,Do,!0)):[]})),Pa=Bi((function(t,e){var n=Ba(e);return Do(n)&&(n=void 0),Do(t)?Kn(t,ai(e,1,Do,!0),Xr(n,2)):[]})),Aa=Bi((function(t,e){var n=Ba(e);return Do(n)&&(n=void 0),Do(t)?Kn(t,ai(e,1,Do,!0),void 0,n):[]}));function Oa(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:is(n);return r<0&&(r=on(i+r,0)),xe(t,Xr(e,3),r)}function La(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return void 0!==n&&(r=is(n),r=n<0?on(i+r,0):sn(r,i-1)),xe(t,Xr(e,3),r,!0)}function Ra(t){return(null==t?0:t.length)?ai(t,1):[]}function Ia(t){return t&&t.length?t[0]:void 0}var Na=Bi((function(t){var e=fe(t,ar);return e.length&&e[0]===t[0]?vi(e):[]})),Da=Bi((function(t){var e=Ba(t),n=fe(t,ar);return e===Ba(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?vi(n,Xr(e,2)):[]})),za=Bi((function(t){var e=Ba(t),n=fe(t,ar);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?vi(n,void 0,e):[]}));function Ba(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Fa=Bi(Va);function Va(t,e){return t&&t.length&&e&&e.length?Ii(t,e):t}var ja=Gr((function(t,e){var n=null==t?0:t.length,i=Qn(t,e);return Ni(t,fe(e,(function(t){return oa(t,n)?+t:t})).sort(pr)),i}));function Ua(t){return null==t?t:hn.call(t)}var Ha=Bi((function(t){return Ji(ai(t,1,Do,!0))})),Ga=Bi((function(t){var e=Ba(t);return Do(e)&&(e=void 0),Ji(ai(t,1,Do,!0),Xr(e,2))})),Wa=Bi((function(t){var e=Ba(t);return e="function"==typeof e?e:void 0,Ji(ai(t,1,Do,!0),void 0,e)}));function qa(t){if(!t||!t.length)return[];var e=0;return t=ce(t,(function(t){if(Do(t))return e=on(t.length,e),!0})),Pe(e,(function(e){return fe(t,Me(e))}))}function $a(t,e){if(!t||!t.length)return[];var n=qa(t);return null==e?n:fe(n,(function(t){return ae(e,void 0,t)}))}var Qa=Bi((function(t,e){return Do(t)?Kn(t,e):[]})),Ya=Bi((function(t){return ir(ce(t,Do))})),Xa=Bi((function(t){var e=Ba(t);return Do(e)&&(e=void 0),ir(ce(t,Do),Xr(e,2))})),Za=Bi((function(t){var e=Ba(t);return e="function"==typeof e?e:void 0,ir(ce(t,Do),void 0,e)})),Ja=Bi(qa);var Ka=Bi((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,$a(t,n)}));function to(t){var e=kn(t);return e.__chain__=!0,e}function eo(t,e){return e(t)}var no=Gr((function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,r=function(e){return Qn(e,t)};return!(e>1||this.__actions__.length)&&i instanceof Ln&&oa(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:eo,args:[r],thisArg:void 0}),new On(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(r)}));var io=br((function(t,e,n){Et.call(t,n)?++t[n]:$n(t,n,1)}));var ro=Cr(Oa),ao=Cr(La);function oo(t,e){return(Ro(t)?se:ti)(t,Xr(e,3))}function so(t,e){return(Ro(t)?le:ei)(t,Xr(e,3))}var lo=br((function(t,e,n){Et.call(t,n)?t[n].push(e):$n(t,n,[e])}));var uo=Bi((function(t,e,n){var r=-1,a="function"==typeof e,o=No(t)?i(t.length):[];return ti(t,(function(t){o[++r]=a?ae(e,t,n):yi(t,e,n)})),o})),co=br((function(t,e,n){$n(t,n,e)}));function ho(t,e){return(Ro(t)?fe:Ti)(t,Xr(e,3))}var fo=br((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var po=Bi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&sa(t,e[0],e[1])?e=[]:n>2&&sa(e[0],e[1],e[2])&&(e=[e[0]]),Li(t,ai(e,1),[])})),mo=Xe||function(){return $t.Date.now()};function go(t,e,n){return e=n?void 0:e,Fr(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function vo(t,e){var n;if("function"!=typeof e)throw new yt(a);return t=is(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var yo=Bi((function(t,e,n){var i=1;if(n.length){var r=Ue(n,Yr(yo));i|=32}return Fr(t,i,e,n,r)})),bo=Bi((function(t,e,n){var i=3;if(n.length){var r=Ue(n,Yr(bo));i|=32}return Fr(e,i,t,n,r)}));function xo(t,e,n){var i,r,o,s,l,u,c=0,h=!1,d=!1,f=!0;if("function"!=typeof t)throw new yt(a);function p(e){var n=i,a=r;return i=r=void 0,c=e,s=t.apply(a,n)}function m(t){return c=t,l=ba(v,e),h?p(t):s}function g(t){var n=t-u;return void 0===u||n>=e||n<0||d&&t-c>=o}function v(){var t=mo();if(g(t))return y(t);l=ba(v,function(t){var n=e-(t-u);return d?sn(n,o-(t-c)):n}(t))}function y(t){return l=void 0,f&&i?p(t):(i=r=void 0,s)}function b(){var t=mo(),n=g(t);if(i=arguments,r=this,u=t,n){if(void 0===l)return m(u);if(d)return cr(l),l=ba(v,e),p(u)}return void 0===l&&(l=ba(v,e)),s}return e=as(e)||0,Ho(n)&&(h=!!n.leading,o=(d="maxWait"in n)?on(as(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),b.cancel=function(){void 0!==l&&cr(l),c=0,i=u=r=l=void 0},b.flush=function(){return void 0===l?s:y(mo())},b}var _o=Bi((function(t,e){return Jn(t,1,e)})),wo=Bi((function(t,e,n){return Jn(t,as(e)||0,n)}));function So(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new yt(a);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var o=t.apply(this,i);return n.cache=a.set(r,o)||a,o};return n.cache=new(So.Cache||Nn),n}function Eo(t){if("function"!=typeof t)throw new yt(a);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}So.Cache=Nn;var Mo=lr((function(t,e){var n=(e=1==e.length&&Ro(e[0])?fe(e[0],Ae(Xr())):fe(ai(e,1),Ae(Xr()))).length;return Bi((function(i){for(var r=-1,a=sn(i.length,n);++r<a;)i[r]=e[r].call(this,i[r]);return ae(t,this,i)}))})),Co=Bi((function(t,e){return Fr(t,32,void 0,e,Ue(e,Yr(Co)))})),To=Bi((function(t,e){return Fr(t,64,void 0,e,Ue(e,Yr(To)))})),ko=Gr((function(t,e){return Fr(t,256,void 0,void 0,void 0,e)}));function Po(t,e){return t===e||t!=t&&e!=e}var Ao=Ir(pi),Oo=Ir((function(t,e){return t>=e})),Lo=bi(function(){return arguments}())?bi:function(t){return Go(t)&&Et.call(t,"callee")&&!Qt.call(t,"callee")},Ro=i.isArray,Io=Kt?Ae(Kt):function(t){return Go(t)&&fi(t)==S};function No(t){return null!=t&&Uo(t.length)&&!Vo(t)}function Do(t){return Go(t)&&No(t)}var zo=en||al,Bo=te?Ae(te):function(t){return Go(t)&&fi(t)==h};function Fo(t){if(!Go(t))return!1;var e=fi(t);return e==d||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!$o(t)}function Vo(t){if(!Ho(t))return!1;var e=fi(t);return e==f||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function jo(t){return"number"==typeof t&&t==is(t)}function Uo(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Ho(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Go(t){return null!=t&&"object"==typeof t}var Wo=ee?Ae(ee):function(t){return Go(t)&&na(t)==m};function qo(t){return"number"==typeof t||Go(t)&&fi(t)==g}function $o(t){if(!Go(t)||fi(t)!=v)return!1;var e=Wt(t);if(null===e)return!0;var n=Et.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&St.call(n)==kt}var Qo=ne?Ae(ne):function(t){return Go(t)&&fi(t)==y};var Yo=ie?Ae(ie):function(t){return Go(t)&&na(t)==b};function Xo(t){return"string"==typeof t||!Ro(t)&&Go(t)&&fi(t)==x}function Zo(t){return"symbol"==typeof t||Go(t)&&fi(t)==_}var Jo=re?Ae(re):function(t){return Go(t)&&Uo(t.length)&&!!Vt[fi(t)]};var Ko=Ir(Ci),ts=Ir((function(t,e){return t<=e}));function es(t){if(!t)return[];if(No(t))return Xo(t)?qe(t):vr(t);if(Jt&&t[Jt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Jt]());var e=na(t);return(e==m?Ve:e==b?He:Ps)(t)}function ns(t){return t?(t=as(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function is(t){var e=ns(t),n=e%1;return e==e?n?e-n:e:0}function rs(t){return t?Yn(is(t),0,4294967295):0}function as(t){if("number"==typeof t)return t;if(Zo(t))return NaN;if(Ho(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ho(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Q,"");var n=at.test(t);return n||st.test(t)?Gt(t.slice(2),n?2:8):rt.test(t)?NaN:+t}function os(t){return yr(t,_s(t))}function ss(t){return null==t?"":Zi(t)}var ls=xr((function(t,e){if(ha(e)||No(e))yr(e,xs(e),t);else for(var n in e)Et.call(e,n)&&Hn(t,n,e[n])})),us=xr((function(t,e){yr(e,_s(e),t)})),cs=xr((function(t,e,n,i){yr(e,_s(e),t,i)})),hs=xr((function(t,e,n,i){yr(e,xs(e),t,i)})),ds=Gr(Qn);var fs=Bi((function(t,e){t=mt(t);var n=-1,i=e.length,r=i>2?e[2]:void 0;for(r&&sa(e[0],e[1],r)&&(i=1);++n<i;)for(var a=e[n],o=_s(a),s=-1,l=o.length;++s<l;){var u=o[s],c=t[u];(void 0===c||Po(c,_t[u])&&!Et.call(t,u))&&(t[u]=a[u])}return t})),ps=Bi((function(t){return t.push(void 0,jr),ae(Ss,void 0,t)}));function ms(t,e,n){var i=null==t?void 0:hi(t,e);return void 0===i?n:i}function gs(t,e){return null!=t&&ia(t,e,gi)}var vs=Pr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Tt.call(e)),t[e]=n}),Hs(qs)),ys=Pr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Tt.call(e)),Et.call(t,e)?t[e].push(n):t[e]=[n]}),Xr),bs=Bi(yi);function xs(t){return No(t)?Bn(t):Ei(t)}function _s(t){return No(t)?Bn(t,!0):Mi(t)}var ws=xr((function(t,e,n){Ai(t,e,n)})),Ss=xr((function(t,e,n,i){Ai(t,e,n,i)})),Es=Gr((function(t,e){var n={};if(null==t)return n;var i=!1;e=fe(e,(function(e){return e=sr(e,t),i||(i=e.length>1),e})),yr(t,qr(t),n),i&&(n=Xn(n,7,Ur));for(var r=e.length;r--;)Ki(n,e[r]);return n}));var Ms=Gr((function(t,e){return null==t?{}:function(t,e){return Ri(t,e,(function(e,n){return gs(t,n)}))}(t,e)}));function Cs(t,e){if(null==t)return{};var n=fe(qr(t),(function(t){return[t]}));return e=Xr(e),Ri(t,n,(function(t,n){return e(t,n[0])}))}var Ts=Br(xs),ks=Br(_s);function Ps(t){return null==t?[]:Oe(t,xs(t))}var As=Er((function(t,e,n){return e=e.toLowerCase(),t+(n?Os(e):e)}));function Os(t){return Fs(ss(t).toLowerCase())}function Ls(t){return(t=ss(t))&&t.replace(ut,De).replace(Rt,"")}var Rs=Er((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Is=Er((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ns=Sr("toLowerCase");var Ds=Er((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var zs=Er((function(t,e,n){return t+(n?" ":"")+Fs(e)}));var Bs=Er((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Fs=Sr("toUpperCase");function Vs(t,e,n){return t=ss(t),void 0===(e=n?void 0:e)?function(t){return zt.test(t)}(t)?function(t){return t.match(Nt)||[]}(t):function(t){return t.match(tt)||[]}(t):t.match(e)||[]}var js=Bi((function(t,e){try{return ae(t,void 0,e)}catch(t){return Fo(t)?t:new dt(t)}})),Us=Gr((function(t,e){return se(e,(function(e){e=Ma(e),$n(t,e,yo(t[e],t))})),t}));function Hs(t){return function(){return t}}var Gs=Tr(),Ws=Tr(!0);function qs(t){return t}function $s(t){return Si("function"==typeof t?t:Xn(t,1))}var Qs=Bi((function(t,e){return function(n){return yi(n,t,e)}})),Ys=Bi((function(t,e){return function(n){return yi(t,n,e)}}));function Xs(t,e,n){var i=xs(e),r=ci(e,i);null!=n||Ho(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=ci(e,xs(e)));var a=!(Ho(n)&&"chain"in n&&!n.chain),o=Vo(t);return se(r,(function(n){var i=e[n];t[n]=i,o&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__),r=n.__actions__=vr(this.__actions__);return r.push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,pe([this.value()],arguments))})})),t}function Zs(){}var Js=Or(fe),Ks=Or(ue),tl=Or(ve);function el(t){return la(t)?Me(Ma(t)):function(t){return function(e){return hi(e,t)}}(t)}var nl=Rr(),il=Rr(!0);function rl(){return[]}function al(){return!1}var ol=Ar((function(t,e){return t+e}),0),sl=Dr("ceil"),ll=Ar((function(t,e){return t/e}),1),ul=Dr("floor");var cl,hl=Ar((function(t,e){return t*e}),1),dl=Dr("round"),fl=Ar((function(t,e){return t-e}),0);return kn.after=function(t,e){if("function"!=typeof e)throw new yt(a);return t=is(t),function(){if(--t<1)return e.apply(this,arguments)}},kn.ary=go,kn.assign=ls,kn.assignIn=us,kn.assignInWith=cs,kn.assignWith=hs,kn.at=ds,kn.before=vo,kn.bind=yo,kn.bindAll=Us,kn.bindKey=bo,kn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ro(t)?t:[t]},kn.chain=to,kn.chunk=function(t,e,n){e=(n?sa(t,e,n):void 0===e)?1:on(is(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var a=0,o=0,s=i(Je(r/e));a<r;)s[o++]=Wi(t,a,a+=e);return s},kn.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var a=t[e];a&&(r[i++]=a)}return r},kn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=i(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return pe(Ro(n)?vr(n):[n],ai(e,1))},kn.cond=function(t){var e=null==t?0:t.length,n=Xr();return t=e?fe(t,(function(t){if("function"!=typeof t[1])throw new yt(a);return[n(t[0]),t[1]]})):[],Bi((function(n){for(var i=-1;++i<e;){var r=t[i];if(ae(r[0],this,n))return ae(r[1],this,n)}}))},kn.conforms=function(t){return function(t){var e=xs(t);return function(n){return Zn(n,t,e)}}(Xn(t,1))},kn.constant=Hs,kn.countBy=io,kn.create=function(t,e){var n=Pn(t);return null==e?n:qn(n,e)},kn.curry=function t(e,n,i){var r=Fr(e,8,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return r.placeholder=t.placeholder,r},kn.curryRight=function t(e,n,i){var r=Fr(e,16,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return r.placeholder=t.placeholder,r},kn.debounce=xo,kn.defaults=fs,kn.defaultsDeep=ps,kn.defer=_o,kn.delay=wo,kn.difference=ka,kn.differenceBy=Pa,kn.differenceWith=Aa,kn.drop=function(t,e,n){var i=null==t?0:t.length;return i?Wi(t,(e=n||void 0===e?1:is(e))<0?0:e,i):[]},kn.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?Wi(t,0,(e=i-(e=n||void 0===e?1:is(e)))<0?0:e):[]},kn.dropRightWhile=function(t,e){return t&&t.length?er(t,Xr(e,3),!0,!0):[]},kn.dropWhile=function(t,e){return t&&t.length?er(t,Xr(e,3),!0):[]},kn.fill=function(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&sa(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=is(n))<0&&(n=-n>r?0:r+n),(i=void 0===i||i>r?r:is(i))<0&&(i+=r),i=n>i?0:rs(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},kn.filter=function(t,e){return(Ro(t)?ce:ri)(t,Xr(e,3))},kn.flatMap=function(t,e){return ai(ho(t,e),1)},kn.flatMapDeep=function(t,e){return ai(ho(t,e),1/0)},kn.flatMapDepth=function(t,e,n){return n=void 0===n?1:is(n),ai(ho(t,e),n)},kn.flatten=Ra,kn.flattenDeep=function(t){return(null==t?0:t.length)?ai(t,1/0):[]},kn.flattenDepth=function(t,e){return(null==t?0:t.length)?ai(t,e=void 0===e?1:is(e)):[]},kn.flip=function(t){return Fr(t,512)},kn.flow=Gs,kn.flowRight=Ws,kn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},kn.functions=function(t){return null==t?[]:ci(t,xs(t))},kn.functionsIn=function(t){return null==t?[]:ci(t,_s(t))},kn.groupBy=lo,kn.initial=function(t){return(null==t?0:t.length)?Wi(t,0,-1):[]},kn.intersection=Na,kn.intersectionBy=Da,kn.intersectionWith=za,kn.invert=vs,kn.invertBy=ys,kn.invokeMap=uo,kn.iteratee=$s,kn.keyBy=co,kn.keys=xs,kn.keysIn=_s,kn.map=ho,kn.mapKeys=function(t,e){var n={};return e=Xr(e,3),li(t,(function(t,i,r){$n(n,e(t,i,r),t)})),n},kn.mapValues=function(t,e){var n={};return e=Xr(e,3),li(t,(function(t,i,r){$n(n,i,e(t,i,r))})),n},kn.matches=function(t){return ki(Xn(t,1))},kn.matchesProperty=function(t,e){return Pi(t,Xn(e,1))},kn.memoize=So,kn.merge=ws,kn.mergeWith=Ss,kn.method=Qs,kn.methodOf=Ys,kn.mixin=Xs,kn.negate=Eo,kn.nthArg=function(t){return t=is(t),Bi((function(e){return Oi(e,t)}))},kn.omit=Es,kn.omitBy=function(t,e){return Cs(t,Eo(Xr(e)))},kn.once=function(t){return vo(2,t)},kn.orderBy=function(t,e,n,i){return null==t?[]:(Ro(e)||(e=null==e?[]:[e]),Ro(n=i?void 0:n)||(n=null==n?[]:[n]),Li(t,e,n))},kn.over=Js,kn.overArgs=Mo,kn.overEvery=Ks,kn.overSome=tl,kn.partial=Co,kn.partialRight=To,kn.partition=fo,kn.pick=Ms,kn.pickBy=Cs,kn.property=el,kn.propertyOf=function(t){return function(e){return null==t?void 0:hi(t,e)}},kn.pull=Fa,kn.pullAll=Va,kn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Ii(t,e,Xr(n,2)):t},kn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Ii(t,e,void 0,n):t},kn.pullAt=ja,kn.range=nl,kn.rangeRight=il,kn.rearg=ko,kn.reject=function(t,e){return(Ro(t)?ce:ri)(t,Eo(Xr(e,3)))},kn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],a=t.length;for(e=Xr(e,3);++i<a;){var o=t[i];e(o,i,t)&&(n.push(o),r.push(i))}return Ni(t,r),n},kn.rest=function(t,e){if("function"!=typeof t)throw new yt(a);return Bi(t,e=void 0===e?e:is(e))},kn.reverse=Ua,kn.sampleSize=function(t,e,n){return e=(n?sa(t,e,n):void 0===e)?1:is(e),(Ro(t)?Vn:Vi)(t,e)},kn.set=function(t,e,n){return null==t?t:ji(t,e,n)},kn.setWith=function(t,e,n,i){return i="function"==typeof i?i:void 0,null==t?t:ji(t,e,n,i)},kn.shuffle=function(t){return(Ro(t)?jn:Gi)(t)},kn.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&sa(t,e,n)?(e=0,n=i):(e=null==e?0:is(e),n=void 0===n?i:is(n)),Wi(t,e,n)):[]},kn.sortBy=po,kn.sortedUniq=function(t){return t&&t.length?Yi(t):[]},kn.sortedUniqBy=function(t,e){return t&&t.length?Yi(t,Xr(e,2)):[]},kn.split=function(t,e,n){return n&&"number"!=typeof n&&sa(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=ss(t))&&("string"==typeof e||null!=e&&!Qo(e))&&!(e=Zi(e))&&Fe(t)?ur(qe(t),0,n):t.split(e,n):[]},kn.spread=function(t,e){if("function"!=typeof t)throw new yt(a);return e=null==e?0:on(is(e),0),Bi((function(n){var i=n[e],r=ur(n,0,e);return i&&pe(r,i),ae(t,this,r)}))},kn.tail=function(t){var e=null==t?0:t.length;return e?Wi(t,1,e):[]},kn.take=function(t,e,n){return t&&t.length?Wi(t,0,(e=n||void 0===e?1:is(e))<0?0:e):[]},kn.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?Wi(t,(e=i-(e=n||void 0===e?1:is(e)))<0?0:e,i):[]},kn.takeRightWhile=function(t,e){return t&&t.length?er(t,Xr(e,3),!1,!0):[]},kn.takeWhile=function(t,e){return t&&t.length?er(t,Xr(e,3)):[]},kn.tap=function(t,e){return e(t),t},kn.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new yt(a);return Ho(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),xo(t,e,{leading:i,maxWait:e,trailing:r})},kn.thru=eo,kn.toArray=es,kn.toPairs=Ts,kn.toPairsIn=ks,kn.toPath=function(t){return Ro(t)?fe(t,Ma):Zo(t)?[t]:vr(Ea(ss(t)))},kn.toPlainObject=os,kn.transform=function(t,e,n){var i=Ro(t),r=i||zo(t)||Jo(t);if(e=Xr(e,4),null==n){var a=t&&t.constructor;n=r?i?new a:[]:Ho(t)&&Vo(a)?Pn(Wt(t)):{}}return(r?se:li)(t,(function(t,i,r){return e(n,t,i,r)})),n},kn.unary=function(t){return go(t,1)},kn.union=Ha,kn.unionBy=Ga,kn.unionWith=Wa,kn.uniq=function(t){return t&&t.length?Ji(t):[]},kn.uniqBy=function(t,e){return t&&t.length?Ji(t,Xr(e,2)):[]},kn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Ji(t,void 0,e):[]},kn.unset=function(t,e){return null==t||Ki(t,e)},kn.unzip=qa,kn.unzipWith=$a,kn.update=function(t,e,n){return null==t?t:tr(t,e,or(n))},kn.updateWith=function(t,e,n,i){return i="function"==typeof i?i:void 0,null==t?t:tr(t,e,or(n),i)},kn.values=Ps,kn.valuesIn=function(t){return null==t?[]:Oe(t,_s(t))},kn.without=Qa,kn.words=Vs,kn.wrap=function(t,e){return Co(or(e),t)},kn.xor=Ya,kn.xorBy=Xa,kn.xorWith=Za,kn.zip=Ja,kn.zipObject=function(t,e){return rr(t||[],e||[],Hn)},kn.zipObjectDeep=function(t,e){return rr(t||[],e||[],ji)},kn.zipWith=Ka,kn.entries=Ts,kn.entriesIn=ks,kn.extend=us,kn.extendWith=cs,Xs(kn,kn),kn.add=ol,kn.attempt=js,kn.camelCase=As,kn.capitalize=Os,kn.ceil=sl,kn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=as(n))==n?n:0),void 0!==e&&(e=(e=as(e))==e?e:0),Yn(as(t),e,n)},kn.clone=function(t){return Xn(t,4)},kn.cloneDeep=function(t){return Xn(t,5)},kn.cloneDeepWith=function(t,e){return Xn(t,5,e="function"==typeof e?e:void 0)},kn.cloneWith=function(t,e){return Xn(t,4,e="function"==typeof e?e:void 0)},kn.conformsTo=function(t,e){return null==e||Zn(t,e,xs(e))},kn.deburr=Ls,kn.defaultTo=function(t,e){return null==t||t!=t?e:t},kn.divide=ll,kn.endsWith=function(t,e,n){t=ss(t),e=Zi(e);var i=t.length,r=n=void 0===n?i:Yn(is(n),0,i);return(n-=e.length)>=0&&t.slice(n,r)==e},kn.eq=Po,kn.escape=function(t){return(t=ss(t))&&F.test(t)?t.replace(z,ze):t},kn.escapeRegExp=function(t){return(t=ss(t))&&$.test(t)?t.replace(q,"\\$&"):t},kn.every=function(t,e,n){var i=Ro(t)?ue:ni;return n&&sa(t,e,n)&&(e=void 0),i(t,Xr(e,3))},kn.find=ro,kn.findIndex=Oa,kn.findKey=function(t,e){return be(t,Xr(e,3),li)},kn.findLast=ao,kn.findLastIndex=La,kn.findLastKey=function(t,e){return be(t,Xr(e,3),ui)},kn.floor=ul,kn.forEach=oo,kn.forEachRight=so,kn.forIn=function(t,e){return null==t?t:oi(t,Xr(e,3),_s)},kn.forInRight=function(t,e){return null==t?t:si(t,Xr(e,3),_s)},kn.forOwn=function(t,e){return t&&li(t,Xr(e,3))},kn.forOwnRight=function(t,e){return t&&ui(t,Xr(e,3))},kn.get=ms,kn.gt=Ao,kn.gte=Oo,kn.has=function(t,e){return null!=t&&ia(t,e,mi)},kn.hasIn=gs,kn.head=Ia,kn.identity=qs,kn.includes=function(t,e,n,i){t=No(t)?t:Ps(t),n=n&&!i?is(n):0;var r=t.length;return n<0&&(n=on(r+n,0)),Xo(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&_e(t,e,n)>-1},kn.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:is(n);return r<0&&(r=on(i+r,0)),_e(t,e,r)},kn.inRange=function(t,e,n){return e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n){return t>=sn(e,n)&&t<on(e,n)}(t=as(t),e,n)},kn.invoke=bs,kn.isArguments=Lo,kn.isArray=Ro,kn.isArrayBuffer=Io,kn.isArrayLike=No,kn.isArrayLikeObject=Do,kn.isBoolean=function(t){return!0===t||!1===t||Go(t)&&fi(t)==c},kn.isBuffer=zo,kn.isDate=Bo,kn.isElement=function(t){return Go(t)&&1===t.nodeType&&!$o(t)},kn.isEmpty=function(t){if(null==t)return!0;if(No(t)&&(Ro(t)||"string"==typeof t||"function"==typeof t.splice||zo(t)||Jo(t)||Lo(t)))return!t.length;var e=na(t);if(e==m||e==b)return!t.size;if(ha(t))return!Ei(t).length;for(var n in t)if(Et.call(t,n))return!1;return!0},kn.isEqual=function(t,e){return xi(t,e)},kn.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===i?xi(t,e,void 0,n):!!i},kn.isError=Fo,kn.isFinite=function(t){return"number"==typeof t&&nn(t)},kn.isFunction=Vo,kn.isInteger=jo,kn.isLength=Uo,kn.isMap=Wo,kn.isMatch=function(t,e){return t===e||_i(t,e,Jr(e))},kn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,_i(t,e,Jr(e),n)},kn.isNaN=function(t){return qo(t)&&t!=+t},kn.isNative=function(t){if(ca(t))throw new dt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return wi(t)},kn.isNil=function(t){return null==t},kn.isNull=function(t){return null===t},kn.isNumber=qo,kn.isObject=Ho,kn.isObjectLike=Go,kn.isPlainObject=$o,kn.isRegExp=Qo,kn.isSafeInteger=function(t){return jo(t)&&t>=-9007199254740991&&t<=9007199254740991},kn.isSet=Yo,kn.isString=Xo,kn.isSymbol=Zo,kn.isTypedArray=Jo,kn.isUndefined=function(t){return void 0===t},kn.isWeakMap=function(t){return Go(t)&&na(t)==w},kn.isWeakSet=function(t){return Go(t)&&"[object WeakSet]"==fi(t)},kn.join=function(t,e){return null==t?"":rn.call(t,e)},kn.kebabCase=Rs,kn.last=Ba,kn.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return void 0!==n&&(r=(r=is(n))<0?on(i+r,0):sn(r,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,r):xe(t,Se,r,!0)},kn.lowerCase=Is,kn.lowerFirst=Ns,kn.lt=Ko,kn.lte=ts,kn.max=function(t){return t&&t.length?ii(t,qs,pi):void 0},kn.maxBy=function(t,e){return t&&t.length?ii(t,Xr(e,2),pi):void 0},kn.mean=function(t){return Ee(t,qs)},kn.meanBy=function(t,e){return Ee(t,Xr(e,2))},kn.min=function(t){return t&&t.length?ii(t,qs,Ci):void 0},kn.minBy=function(t,e){return t&&t.length?ii(t,Xr(e,2),Ci):void 0},kn.stubArray=rl,kn.stubFalse=al,kn.stubObject=function(){return{}},kn.stubString=function(){return""},kn.stubTrue=function(){return!0},kn.multiply=hl,kn.nth=function(t,e){return t&&t.length?Oi(t,is(e)):void 0},kn.noConflict=function(){return $t._===this&&($t._=Pt),this},kn.noop=Zs,kn.now=mo,kn.pad=function(t,e,n){t=ss(t);var i=(e=is(e))?We(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return Lr(Ke(r),n)+t+Lr(Je(r),n)},kn.padEnd=function(t,e,n){t=ss(t);var i=(e=is(e))?We(t):0;return e&&i<e?t+Lr(e-i,n):t},kn.padStart=function(t,e,n){t=ss(t);var i=(e=is(e))?We(t):0;return e&&i<e?Lr(e-i,n)+t:t},kn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),un(ss(t).replace(Y,""),e||0)},kn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&sa(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ns(t),void 0===e?(e=t,t=0):e=ns(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=cn();return sn(t+r*(e-t+Ht("1e-"+((r+"").length-1))),e)}return Di(t,e)},kn.reduce=function(t,e,n){var i=Ro(t)?me:Te,r=arguments.length<3;return i(t,Xr(e,4),n,r,ti)},kn.reduceRight=function(t,e,n){var i=Ro(t)?ge:Te,r=arguments.length<3;return i(t,Xr(e,4),n,r,ei)},kn.repeat=function(t,e,n){return e=(n?sa(t,e,n):void 0===e)?1:is(e),zi(ss(t),e)},kn.replace=function(){var t=arguments,e=ss(t[0]);return t.length<3?e:e.replace(t[1],t[2])},kn.result=function(t,e,n){var i=-1,r=(e=sr(e,t)).length;for(r||(r=1,t=void 0);++i<r;){var a=null==t?void 0:t[Ma(e[i])];void 0===a&&(i=r,a=n),t=Vo(a)?a.call(t):a}return t},kn.round=dl,kn.runInContext=t,kn.sample=function(t){return(Ro(t)?Fn:Fi)(t)},kn.size=function(t){if(null==t)return 0;if(No(t))return Xo(t)?We(t):t.length;var e=na(t);return e==m||e==b?t.size:Ei(t).length},kn.snakeCase=Ds,kn.some=function(t,e,n){var i=Ro(t)?ve:qi;return n&&sa(t,e,n)&&(e=void 0),i(t,Xr(e,3))},kn.sortedIndex=function(t,e){return $i(t,e)},kn.sortedIndexBy=function(t,e,n){return Qi(t,e,Xr(n,2))},kn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=$i(t,e);if(i<n&&Po(t[i],e))return i}return-1},kn.sortedLastIndex=function(t,e){return $i(t,e,!0)},kn.sortedLastIndexBy=function(t,e,n){return Qi(t,e,Xr(n,2),!0)},kn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=$i(t,e,!0)-1;if(Po(t[n],e))return n}return-1},kn.startCase=zs,kn.startsWith=function(t,e,n){return t=ss(t),n=null==n?0:Yn(is(n),0,t.length),e=Zi(e),t.slice(n,n+e.length)==e},kn.subtract=fl,kn.sum=function(t){return t&&t.length?ke(t,qs):0},kn.sumBy=function(t,e){return t&&t.length?ke(t,Xr(e,2)):0},kn.template=function(t,e,n){var i=kn.templateSettings;n&&sa(t,e,n)&&(e=void 0),t=ss(t),e=cs({},e,i,Vr);var r,a,o=cs({},e.imports,i.imports,Vr),s=xs(o),l=Oe(o,s),u=0,c=e.interpolate||ct,h="__p += '",d=gt((e.escape||ct).source+"|"+c.source+"|"+(c===U?nt:ct).source+"|"+(e.evaluate||ct).source+"|$","g"),f="//# sourceURL="+(Et.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ft+"]")+"\n";t.replace(d,(function(e,n,i,o,s,l){return i||(i=o),h+=t.slice(u,l).replace(ht,Be),n&&(r=!0,h+="' +\n__e("+n+") +\n'"),s&&(a=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),h+="';\n";var p=Et.call(e,"variable")&&e.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(a?h.replace(R,""):h).replace(I,"$1").replace(N,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=js((function(){return ft(s,f+"return "+h).apply(void 0,l)}));if(m.source=h,Fo(m))throw m;return m},kn.times=function(t,e){if((t=is(t))<1||t>9007199254740991)return[];var n=4294967295,i=sn(t,4294967295);t-=4294967295;for(var r=Pe(i,e=Xr(e));++n<t;)e(n);return r},kn.toFinite=ns,kn.toInteger=is,kn.toLength=rs,kn.toLower=function(t){return ss(t).toLowerCase()},kn.toNumber=as,kn.toSafeInteger=function(t){return t?Yn(is(t),-9007199254740991,9007199254740991):0===t?t:0},kn.toString=ss,kn.toUpper=function(t){return ss(t).toUpperCase()},kn.trim=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Q,"");if(!t||!(e=Zi(e)))return t;var i=qe(t),r=qe(e);return ur(i,Re(i,r),Ie(i,r)+1).join("")},kn.trimEnd=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(X,"");if(!t||!(e=Zi(e)))return t;var i=qe(t);return ur(i,0,Ie(i,qe(e))+1).join("")},kn.trimStart=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Y,"");if(!t||!(e=Zi(e)))return t;var i=qe(t);return ur(i,Re(i,qe(e))).join("")},kn.truncate=function(t,e){var n=30,i="...";if(Ho(e)){var r="separator"in e?e.separator:r;n="length"in e?is(e.length):n,i="omission"in e?Zi(e.omission):i}var a=(t=ss(t)).length;if(Fe(t)){var o=qe(t);a=o.length}if(n>=a)return t;var s=n-We(i);if(s<1)return i;var l=o?ur(o,0,s).join(""):t.slice(0,s);if(void 0===r)return l+i;if(o&&(s+=l.length-s),Qo(r)){if(t.slice(s).search(r)){var u,c=l;for(r.global||(r=gt(r.source,ss(it.exec(r))+"g")),r.lastIndex=0;u=r.exec(c);)var h=u.index;l=l.slice(0,void 0===h?s:h)}}else if(t.indexOf(Zi(r),s)!=s){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+i},kn.unescape=function(t){return(t=ss(t))&&B.test(t)?t.replace(D,$e):t},kn.uniqueId=function(t){var e=++Mt;return ss(t)+e},kn.upperCase=Bs,kn.upperFirst=Fs,kn.each=oo,kn.eachRight=so,kn.first=Ia,Xs(kn,(cl={},li(kn,(function(t,e){Et.call(kn.prototype,e)||(cl[e]=t)})),cl),{chain:!1}),kn.VERSION="4.17.20",se(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){kn[t].placeholder=kn})),se(["drop","take"],(function(t,e){Ln.prototype[t]=function(n){n=void 0===n?1:on(is(n),0);var i=this.__filtered__&&!e?new Ln(this):this.clone();return i.__filtered__?i.__takeCount__=sn(n,i.__takeCount__):i.__views__.push({size:sn(n,4294967295),type:t+(i.__dir__<0?"Right":"")}),i},Ln.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),se(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=1==n||3==n;Ln.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Xr(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}})),se(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Ln.prototype[t]=function(){return this[n](1).value()[0]}})),se(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Ln.prototype[t]=function(){return this.__filtered__?new Ln(this):this[n](1)}})),Ln.prototype.compact=function(){return this.filter(qs)},Ln.prototype.find=function(t){return this.filter(t).head()},Ln.prototype.findLast=function(t){return this.reverse().find(t)},Ln.prototype.invokeMap=Bi((function(t,e){return"function"==typeof t?new Ln(this):this.map((function(n){return yi(n,t,e)}))})),Ln.prototype.reject=function(t){return this.filter(Eo(Xr(t)))},Ln.prototype.slice=function(t,e){t=is(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Ln(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=is(e))<0?n.dropRight(-e):n.take(e-t)),n)},Ln.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ln.prototype.toArray=function(){return this.take(4294967295)},li(Ln.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=kn[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);r&&(kn.prototype[e]=function(){var e=this.__wrapped__,o=i?[1]:arguments,s=e instanceof Ln,l=o[0],u=s||Ro(e),c=function(t){var e=r.apply(kn,pe([t],o));return i&&h?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var h=this.__chain__,d=!!this.__actions__.length,f=a&&!h,p=s&&!d;if(!a&&u){e=p?e:new Ln(this);var m=t.apply(e,o);return m.__actions__.push({func:eo,args:[c],thisArg:void 0}),new On(m,h)}return f&&p?t.apply(this,o):(m=this.thru(c),f?i?m.value()[0]:m.value():m)})})),se(["pop","push","shift","sort","splice","unshift"],(function(t){var e=bt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);kn.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(Ro(r)?r:[],t)}return this[n]((function(n){return e.apply(Ro(n)?n:[],t)}))}})),li(Ln.prototype,(function(t,e){var n=kn[e];if(n){var i=n.name+"";Et.call(bn,i)||(bn[i]=[]),bn[i].push({name:e,func:n})}})),bn[kr(void 0,2).name]=[{name:"wrapper",func:void 0}],Ln.prototype.clone=function(){var t=new Ln(this.__wrapped__);return t.__actions__=vr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=vr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=vr(this.__views__),t},Ln.prototype.reverse=function(){if(this.__filtered__){var t=new Ln(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Ln.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ro(t),i=e<0,r=n?t.length:0,a=function(t,e,n){var i=-1,r=n.length;for(;++i<r;){var a=n[i],o=a.size;switch(a.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=sn(e,t+o);break;case"takeRight":t=on(t,e-o)}}return{start:t,end:e}}(0,r,this.__views__),o=a.start,s=a.end,l=s-o,u=i?s:o-1,c=this.__iteratees__,h=c.length,d=0,f=sn(l,this.__takeCount__);if(!n||!i&&r==l&&f==l)return nr(t,this.__actions__);var p=[];t:for(;l--&&d<f;){for(var m=-1,g=t[u+=e];++m<h;){var v=c[m],y=v.iteratee,b=v.type,x=y(g);if(2==b)g=x;else if(!x){if(1==b)continue t;break t}}p[d++]=g}return p},kn.prototype.at=no,kn.prototype.chain=function(){return to(this)},kn.prototype.commit=function(){return new On(this.value(),this.__chain__)},kn.prototype.next=function(){void 0===this.__values__&&(this.__values__=es(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},kn.prototype.plant=function(t){for(var e,n=this;n instanceof An;){var i=Ta(n);i.__index__=0,i.__values__=void 0,e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},kn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Ln){var e=t;return this.__actions__.length&&(e=new Ln(this)),(e=e.reverse()).__actions__.push({func:eo,args:[Ua],thisArg:void 0}),new On(e,this.__chain__)}return this.thru(Ua)},kn.prototype.toJSON=kn.prototype.valueOf=kn.prototype.value=function(){return nr(this.__wrapped__,this.__actions__)},kn.prototype.first=kn.prototype.head,Jt&&(kn.prototype[Jt]=function(){return this}),kn}();$t._=Qe,void 0===(r=function(){return Qe}.call(e,n,e,i))||(i.exports=r)}).call(this)}).call(this,n(100),n(32)(t))},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.red=e.getContrastingColor=e.isValidHex=e.toState=e.simpleCheckForValidColor=void 0;var i=a(n(314)),r=a(n(316));function a(t){return t&&t.__esModule?t:{default:t}}e.simpleCheckForValidColor=function(t){var e=0,n=0;return(0,i.default)(["r","g","b","a","h","s","l","v"],(function(i){if(t[i]&&(e+=1,isNaN(t[i])||(n+=1),"s"===i||"l"===i)){/^\d+%$/.test(t[i])&&(n+=1)}})),e===n&&t};var o=e.toState=function(t,e){var n=t.hex?(0,r.default)(t.hex):(0,r.default)(t),i=n.toHsl(),a=n.toHsv(),o=n.toRgb(),s=n.toHex();return 0===i.s&&(i.h=e||0,a.h=e||0),{hsl:i,hex:"000000"===s&&0===o.a?"transparent":"#"+s,rgb:o,hsv:a,oldHue:t.h||e||i.h,source:t.source}};e.isValidHex=function(t){var e="#"===String(t).charAt(0)?1:0;return t.length!==4+e&&t.length<7+e&&(0,r.default)(t).isValid()},e.getContrastingColor=function(t){if(!t)return"#fff";var e=o(t);return"transparent"===e.hex?"rgba(0,0,0,0.4)":(299*e.rgb.r+587*e.rgb.g+114*e.rgb.b)/1e3>=128?"#000":"#fff"},e.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}};e.default=e},function(t,e,n){var i=n(108),r=n(203),a=n(261),o=n(5);t.exports=function(t,e){return(o(t)?i:a)(t,r(e,3))}},,function(t,e,n){var i=n(24),r=n(194),a=n(195),o=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?r(t):a(t)}},function(t,e,n){var i=n(216),r=n(219);t.exports=function(t,e){var n=r(t,e);return i(n)?n:void 0}},function(t,e,n){var i=n(1);i.OrbitControls=function(t,e){var n,r,a,o,s;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new i.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:i.MOUSE.ROTATE,MIDDLE:i.MOUSE.DOLLY,RIGHT:i.MOUSE.PAN},this.touches={ONE:i.TOUCH.ROTATE,TWO:i.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),f=d.NONE},this.update=(n=new i.Vector3,r=(new i.Quaternion).setFromUnitVectors(t.up,new i.Vector3(0,1,0)),a=r.clone().inverse(),o=new i.Vector3,s=new i.Quaternion,function(){var t=l.object.position;return n.copy(t).sub(l.target),n.applyQuaternion(r),m.setFromVector3(n),l.autoRotate&&f===d.NONE&&A(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(m.theta+=g.theta*l.dampingFactor,m.phi+=g.phi*l.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi),m.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=v,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),!0===l.enableDamping?l.target.addScaledVector(y,l.dampingFactor):l.target.add(y),n.setFromSpherical(m),n.applyQuaternion(a),t.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(g.theta*=1-l.dampingFactor,g.phi*=1-l.dampingFactor,y.multiplyScalar(1-l.dampingFactor)):(g.set(0,0,0),y.set(0,0,0)),v=1,!!(b||o.distanceToSquared(l.object.position)>p||8*(1-s.dot(l.object.quaternion))>p)&&(l.dispatchEvent(u),o.copy(l.object.position),s.copy(l.object.quaternion),b=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",tt,!1),l.domElement.removeEventListener("mousedown",q,!1),l.domElement.removeEventListener("wheel",Y,!1),l.domElement.removeEventListener("touchstart",Z,!1),l.domElement.removeEventListener("touchend",K,!1),l.domElement.removeEventListener("touchmove",J,!1),document.removeEventListener("mousemove",$,!1),document.removeEventListener("mouseup",Q,!1),l.domElement.removeEventListener("keydown",X,!1)};var l=this,u={type:"change"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=d.NONE,p=1e-6,m=new i.Spherical,g=new i.Spherical,v=1,y=new i.Vector3,b=!1,x=new i.Vector2,_=new i.Vector2,w=new i.Vector2,S=new i.Vector2,E=new i.Vector2,M=new i.Vector2,C=new i.Vector2,T=new i.Vector2,k=new i.Vector2;function P(){return Math.pow(.95,l.zoomSpeed)}function A(t){g.theta-=t}function O(t){g.phi-=t}var L,R=(L=new i.Vector3,function(t,e){L.setFromMatrixColumn(e,0),L.multiplyScalar(-t),y.add(L)}),I=function(){var t=new i.Vector3;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),y.add(t)}}(),N=function(){var t=new i.Vector3;return function(e,n){var i=l.domElement;if(l.object.isPerspectiveCamera){var r=l.object.position;t.copy(r).sub(l.target);var a=t.length();a*=Math.tan(l.object.fov/2*Math.PI/180),R(2*e*a/i.clientHeight,l.object.matrix),I(2*n*a/i.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(R(e*(l.object.right-l.object.left)/l.object.zoom/i.clientWidth,l.object.matrix),I(n*(l.object.top-l.object.bottom)/l.object.zoom/i.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function D(t){l.object.isPerspectiveCamera?v/=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*t)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function z(t){l.object.isPerspectiveCamera?v*=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/t)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function B(t){x.set(t.clientX,t.clientY)}function F(t){S.set(t.clientX,t.clientY)}function V(t){if(1==t.touches.length)x.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);x.set(e,n)}}function j(t){if(1==t.touches.length)S.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);S.set(e,n)}}function U(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);C.set(0,i)}function H(t){if(1==t.touches.length)_.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);_.set(e,n)}w.subVectors(_,x).multiplyScalar(l.rotateSpeed);var i=l.domElement;A(2*Math.PI*w.x/i.clientHeight),O(2*Math.PI*w.y/i.clientHeight),x.copy(_)}function G(t){if(1==t.touches.length)E.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);E.set(e,n)}M.subVectors(E,S).multiplyScalar(l.panSpeed),N(M.x,M.y),S.copy(E)}function W(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);T.set(0,i),k.set(0,Math.pow(T.y/C.y,l.zoomSpeed)),D(k.y),C.copy(T)}function q(t){if(!1!==l.enabled){switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),t.button){case 0:switch(l.mouseButtons.LEFT){case i.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;F(t),f=d.PAN}else{if(!1===l.enableRotate)return;B(t),f=d.ROTATE}break;case i.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;B(t),f=d.ROTATE}else{if(!1===l.enablePan)return;F(t),f=d.PAN}break;default:f=d.NONE}break;case 1:switch(l.mouseButtons.MIDDLE){case i.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(t){C.set(t.clientX,t.clientY)}(t),f=d.DOLLY;break;default:f=d.NONE}break;case 2:switch(l.mouseButtons.RIGHT){case i.MOUSE.ROTATE:if(!1===l.enableRotate)return;B(t),f=d.ROTATE;break;case i.MOUSE.PAN:if(!1===l.enablePan)return;F(t),f=d.PAN;break;default:f=d.NONE}}f!==d.NONE&&(document.addEventListener("mousemove",$,!1),document.addEventListener("mouseup",Q,!1),l.dispatchEvent(c))}}function $(t){if(!1!==l.enabled)switch(t.preventDefault(),f){case d.ROTATE:if(!1===l.enableRotate)return;!function(t){_.set(t.clientX,t.clientY),w.subVectors(_,x).multiplyScalar(l.rotateSpeed);var e=l.domElement;A(2*Math.PI*w.x/e.clientHeight),O(2*Math.PI*w.y/e.clientHeight),x.copy(_),l.update()}(t);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(t){T.set(t.clientX,t.clientY),k.subVectors(T,C),k.y>0?D(P()):k.y<0&&z(P()),C.copy(T),l.update()}(t);break;case d.PAN:if(!1===l.enablePan)return;!function(t){E.set(t.clientX,t.clientY),M.subVectors(E,S).multiplyScalar(l.panSpeed),N(M.x,M.y),S.copy(E),l.update()}(t)}}function Q(t){!1!==l.enabled&&(document.removeEventListener("mousemove",$,!1),document.removeEventListener("mouseup",Q,!1),l.dispatchEvent(h),f=d.NONE)}function Y(t){!1===l.enabled||!1===l.enableZoom||f!==d.NONE&&f!==d.ROTATE||(t.preventDefault(),t.stopPropagation(),l.dispatchEvent(c),function(t){t.deltaY<0?z(P()):t.deltaY>0&&D(P()),l.update()}(t),l.dispatchEvent(h))}function X(t){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(t){var e=!1;switch(t.keyCode){case l.keys.UP:N(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:N(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:N(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:N(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}(t)}function Z(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case i.TOUCH.ROTATE:if(!1===l.enableRotate)return;V(t),f=d.TOUCH_ROTATE;break;case i.TOUCH.PAN:if(!1===l.enablePan)return;j(t),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(l.touches.TWO){case i.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&U(t),l.enablePan&&j(t)}(t),f=d.TOUCH_DOLLY_PAN;break;case i.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&U(t),l.enableRotate&&V(t)}(t),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&l.dispatchEvent(c)}}function J(t){if(!1!==l.enabled)switch(t.preventDefault(),t.stopPropagation(),f){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;H(t),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;G(t),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&W(t),l.enablePan&&G(t)}(t),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&W(t),l.enableRotate&&H(t)}(t),l.update();break;default:f=d.NONE}}function K(t){!1!==l.enabled&&(l.dispatchEvent(h),f=d.NONE)}function tt(t){!1!==l.enabled&&t.preventDefault()}l.domElement.addEventListener("contextmenu",tt,!1),l.domElement.addEventListener("mousedown",q,!1),l.domElement.addEventListener("wheel",Y,!1),l.domElement.addEventListener("touchstart",Z,!1),l.domElement.addEventListener("touchend",K,!1),l.domElement.addEventListener("touchmove",J,!1),l.domElement.addEventListener("keydown",X,!1),-1===l.domElement.tabIndex&&(l.domElement.tabIndex=0),this.update()},i.OrbitControls.prototype=Object.create(i.EventDispatcher.prototype),i.OrbitControls.prototype.constructor=i.OrbitControls,i.MapControls=function(t,e){i.OrbitControls.call(this,t,e),this.mouseButtons.LEFT=i.MOUSE.PAN,this.mouseButtons.RIGHT=i.MOUSE.ROTATE,this.touches.ONE=i.TOUCH.PAN,this.touches.TWO=i.TOUCH.DOLLY_ROTATE},i.MapControls.prototype=Object.create(i.EventDispatcher.prototype),i.MapControls.prototype.constructor=i.MapControls,t.exports=e.default=i.OrbitControls},function(t,e,n){t.exports=function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var n=new t.Vector3,i=new t.Vector3,r=new t.Vector3;return function(a){function o(n){void 0===n&&(n={});var i=n.material;void 0===i&&(i={});var r=n.maxFontSize;void 0===r&&(r=1/0);var o=n.minFontSize;void 0===o&&(o=0);var s=n.redrawInterval;void 0===s&&(s=1);var l=n.textSize;void 0===l&&(l=1);var u=n.texture;void 0===u&&(u={}),a.call(this,new t.SpriteMaterial(Object.assign({},i,{map:new e(u)}))),this.lastRedraw=0,this.maxFontSize=r,this.minFontSize=o,this.redrawInterval=s,this.textSize=l}a&&(o.__proto__=a),o.prototype=Object.create(a&&a.prototype),o.prototype.constructor=o;var s={isTextSprite:{configurable:!0}};return s.isTextSprite.get=function(){return!0},o.prototype.onBeforeRender=function(t,e,n){this.redraw(t,n)},o.prototype.updateScale=function(){this.scale.set(this.material.map.image.width/this.material.map.image.height,1,1).multiplyScalar(this.textSize*this.material.map.height)},o.prototype.updateMatrix=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.updateScale(),a.prototype.updateMatrix.apply(this,t)},o.prototype.redraw=function(t,e){var n=this;this.lastRedraw+this.redrawInterval<Date.now()&&(this.redrawInterval?setTimeout((function(){n.redrawNow(t,e)}),1):this.redrawNow(t,e))},o.prototype.redrawNow=function(e,a){this.updateScale(),this.material.map.fontSize=t.Math.clamp(t.Math.ceilPowerOfTwo(function(e,a,o){if(a.domElement.width&&a.domElement.height&&e.material.map.height){e.getWorldPosition(i),o.getWorldPosition(n);var s=i.distanceTo(n),l=2*Math.tan(t.Math.degToRad(o.fov)/2)*s;if(l){e.getWorldScale(r);var u=r.y*a.domElement.height/l;if(u)return Math.round(u/e.material.map.height)}}return 0}(this,e,a)),this.minFontSize,this.maxFontSize),this.lastRedraw=Date.now()},o.prototype.dispose=function(){this.material.map.dispose(),this.material.dispose()},Object.defineProperties(o.prototype,s),o}(t.Sprite)}(n(1),n(356))},,function(t,e,n){var i=n(57),r=n(53);t.exports=function(t){return null!=t&&r(t.length)&&!i(t)}},function(t,e,n){"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}}(),t.exports=n(186)},,function(t,e,n){var i=n(10).Symbol;t.exports=i},function(t,e,n){var i=n(104),r=n(201),a=n(21);t.exports=function(t){return a(t)?i(t):r(t)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var i=n(123),r=n(63);t.exports=function(t,e,n,a){var o=!n;n||(n={});for(var s=-1,l=e.length;++s<l;){var u=e[s],c=a?a(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),o?r(n,u,c):i(n,u,c)}return n}},function(t,e,n){var i=n(104),r=n(268),a=n(21);t.exports=function(t){return a(t)?i(t,!0):r(t)}},,,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){(function(t){var i=n(10),r=n(199),a=e&&!e.nodeType&&e,o=a&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===a?i.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;t.exports=l}).call(this,n(32)(t))},function(t,e){t.exports=function(t){return t}},function(t,e,n){var i=n(36),r=n(211),a=n(212),o=n(213),s=n(214),l=n(215);function u(t){var e=this.__data__=new i(t);this.size=e.size}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,t.exports=u},function(t,e,n){var i=n(206),r=n(207),a=n(208),o=n(209),s=n(210);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var i=n(26);t.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},function(t,e,n){var i=n(17)(Object,"create");t.exports=i},function(t,e,n){var i=n(228);t.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var i=n(243),r=n(59),a=n(244),o=n(245),s=n(246),l=n(16),u=n(109),c=u(i),h=u(r),d=u(a),f=u(o),p=u(s),m=l;(i&&"[object DataView]"!=m(new i(new ArrayBuffer(1)))||r&&"[object Map]"!=m(new r)||a&&"[object Promise]"!=m(a.resolve())||o&&"[object Set]"!=m(new o)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=l(t),n="[object Object]"==e?t.constructor:void 0,i=n?u(n):"";if(i)switch(i){case c:return"[object DataView]";case h:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=m},function(t,e,n){var i=n(16),r=n(12);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}},function(t,e,n){var i=n(41);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},,,,,,,function(t,e,n){var i=n(102),r=n(106);t.exports=function(t,e){return t&&i(t,r(e))}},function(t,e,n){var i=n(198),r=n(12),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(t){return r(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var i=n(200),r=n(54),a=n(55),o=a&&a.isTypedArray,s=o?r(o):i;t.exports=s},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var i=n(101),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===r&&i.process,s=function(){try{var t=a&&a.require&&a.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=s}).call(this,n(32)(t))},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var i=n(16),r=n(8);t.exports=function(t){if(!r(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var i=n(105)(Object.getPrototypeOf,Object);t.exports=i},function(t,e,n){var i=n(17)(n(10),"Map");t.exports=i},function(t,e,n){var i=n(220),r=n(227),a=n(229),o=n(230),s=n(231);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var i=n(242),r=n(116),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),i(o(t),(function(e){return a.call(t,e)})))}:r;t.exports=s},function(t,e,n){var i=n(5),r=n(41),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!r(t))||(o.test(t)||!a.test(t)||null!=e&&t in Object(e))}},function(t,e,n){var i=n(124);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var i=n(112);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Checkboard=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(0),a=l(r),o=l(n(3)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(289));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Checkboard=function(t){var e=t.white,n=t.grey,l=t.size,u=t.renderers,c=t.borderRadius,h=t.boxShadow,d=t.children,f=(0,o.default)({default:{grid:{borderRadius:c,boxShadow:h,absolute:"0px 0px 0px 0px",background:"url("+s.get(e,n,l,u.canvas)+") center left"}}});return(0,r.isValidElement)(d)?a.default.cloneElement(d,i({},d.props,{style:i({},d.props.style,f.grid)})):a.default.createElement("div",{style:f.grid})};u.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},e.default=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,l=o(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))r.call(n,c)&&(l[c]=n[c]);if(i){s=i(n);for(var h=0;h<s.length;h++)a.call(n,s[h])&&(l[s[h]]=n[s[h]])}}return l}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(100))},function(t,e,n){var i=n(103),r=n(25);t.exports=function(t,e){return t&&i(t,e,r)}},function(t,e,n){var i=n(196)();t.exports=i},function(t,e,n){var i=n(197),r=n(50),a=n(5),o=n(33),s=n(51),l=n(52),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=a(t),c=!n&&r(t),h=!n&&!c&&o(t),d=!n&&!c&&!h&&l(t),f=n||c||h||d,p=f?i(t.length,String):[],m=p.length;for(var g in t)!e&&!u.call(t,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||p.push(g);return p}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var i=n(34);t.exports=function(t){return"function"==typeof t?t:i}},function(t,e,n){var i=n(16),r=n(58),a=n(12),o=Function.prototype,s=Object.prototype,l=o.toString,u=s.hasOwnProperty,c=l.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=i(t))return!1;var e=r(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==c}},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var i=n(232),r=n(12);t.exports=function t(e,n,a,o,s){return e===n||(null==e||null==n||!r(e)&&!r(n)?e!=e&&n!=n:i(e,n,a,o,t,s))}},function(t,e,n){var i=n(233),r=n(236),a=n(237);t.exports=function(t,e,n,o,s,l){var u=1&n,c=t.length,h=e.length;if(c!=h&&!(u&&h>c))return!1;var d=l.get(t),f=l.get(e);if(d&&f)return d==e&&f==t;var p=-1,m=!0,g=2&n?new i:void 0;for(l.set(t,e),l.set(e,t);++p<c;){var v=t[p],y=e[p];if(o)var b=u?o(y,v,p,e,t,l):o(v,y,p,t,e,l);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!r(e,(function(t,e){if(!a(g,e)&&(v===t||s(v,t,n,o,l)))return g.push(e)}))){m=!1;break}}else if(v!==y&&!s(v,y,n,o,l)){m=!1;break}}return l.delete(t),l.delete(e),m}},function(t,e,n){var i=n(10).Uint8Array;t.exports=i},function(t,e,n){var i=n(114),r=n(61),a=n(25);t.exports=function(t){return i(t,a,r)}},function(t,e,n){var i=n(115),r=n(5);t.exports=function(t,e,n){var a=e(t);return r(t)?a:i(a,n(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var i=n(8);t.exports=function(t){return t==t&&!i(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},function(t,e,n){var i=n(120),r=n(42);t.exports=function(t,e){for(var n=0,a=(e=i(e,t)).length;null!=t&&n<a;)t=t[r(e[n++])];return n&&n==a?t:void 0}},function(t,e,n){var i=n(5),r=n(62),a=n(250),o=n(253);t.exports=function(t,e){return i(t)?t:r(t,e)?[t]:a(o(t))}},function(t,e,n){var i=n(102),r=n(262)(i);t.exports=r},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}},function(t,e,n){var i=n(63),r=n(26),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var o=t[e];a.call(t,e)&&r(o,n)&&(void 0!==n||e in t)||i(t,e,n)}},function(t,e,n){var i=n(17),r=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},function(t,e,n){(function(t){var i=n(10),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===r?i.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=s?s(n):new t.constructor(n);return t.copy(i),i}}).call(this,n(32)(t))},function(t,e){t.exports=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}},function(t,e,n){var i=n(115),r=n(58),a=n(61),o=n(116),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)i(e,a(t)),t=r(t);return e}:o;t.exports=s},function(t,e,n){var i=n(64);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var i=n(278),r=n(58),a=n(56);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:i(r(t))}},function(t,e,n){var i=n(63),r=n(26);t.exports=function(t,e,n){(void 0!==n&&!r(t[e],n)||void 0===n&&!(e in t))&&i(t,e,n)}},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var i=n(8),r=n(311),a=n(312),o=Math.max,s=Math.min;t.exports=function(t,e,n){var l,u,c,h,d,f,p=0,m=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=l,i=u;return l=u=void 0,p=e,h=t.apply(i,n)}function b(t){return p=t,d=setTimeout(_,e),m?y(t):h}function x(t){var n=t-f;return void 0===f||n>=e||n<0||g&&t-p>=c}function _(){var t=r();if(x(t))return w(t);d=setTimeout(_,function(t){var n=e-(t-f);return g?s(n,c-(t-p)):n}(t))}function w(t){return d=void 0,v&&l?y(t):(l=u=void 0,h)}function S(){var t=r(),n=x(t);if(l=arguments,u=this,f=t,n){if(void 0===d)return b(f);if(g)return clearTimeout(d),d=setTimeout(_,e),y(f)}return void 0===d&&(d=setTimeout(_,e)),h}return e=a(e)||0,i(n)&&(m=!!n.leading,c=(g="maxWait"in n)?o(a(n.maxWait)||0,e):c,v="trailing"in n?!!n.trailing:v),S.cancel=function(){void 0!==d&&clearTimeout(d),p=0,l=f=u=d=void 0},S.flush=function(){return void 0===d?h:w(r())},S}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorWrap=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(0),o=u(a),s=u(n(132)),l=u(n(13));function u(t){return t&&t.__esModule?t:{default:t}}var c=e.ColorWrap=function(t){var e=function(e){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.handleChange=function(t,n){if(l.default.simpleCheckForValidColor(t)){var i=l.default.toState(t,t.h||e.state.oldHue);e.setState(i),e.props.onChangeComplete&&e.debounce(e.props.onChangeComplete,i,n),e.props.onChange&&e.props.onChange(i,n)}},e.handleSwatchHover=function(t,n){if(l.default.simpleCheckForValidColor(t)){var i=l.default.toState(t,t.h||e.state.oldHue);e.props.onSwatchHover&&e.props.onSwatchHover(i,n)}},e.state=i({},l.default.toState(t.color,0)),e.debounce=(0,s.default)((function(t,e,n){t(e,n)}),100),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),r(n,[{key:"render",value:function(){var e={};return this.props.onSwatchHover&&(e.onSwatchHover=this.handleSwatchHover),o.default.createElement(t,i({},this.props,this.state,{onChange:this.handleChange},e))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return i({},l.default.toState(t.color,e.oldHue))}}]),n}(a.PureComponent||a.Component);return e.propTypes=i({},t.propTypes),e.defaultProps=i({},t.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),e};e.default=c},function(t,e,n){"use strict";n.r(e),n.d(e,"red",(function(){return i})),n.d(e,"pink",(function(){return r})),n.d(e,"purple",(function(){return a})),n.d(e,"deepPurple",(function(){return o})),n.d(e,"indigo",(function(){return s})),n.d(e,"blue",(function(){return l})),n.d(e,"lightBlue",(function(){return u})),n.d(e,"cyan",(function(){return c})),n.d(e,"teal",(function(){return h})),n.d(e,"green",(function(){return d})),n.d(e,"lightGreen",(function(){return f})),n.d(e,"lime",(function(){return p})),n.d(e,"yellow",(function(){return m})),n.d(e,"amber",(function(){return g})),n.d(e,"orange",(function(){return v})),n.d(e,"deepOrange",(function(){return y})),n.d(e,"brown",(function(){return b})),n.d(e,"grey",(function(){return x})),n.d(e,"blueGrey",(function(){return _})),n.d(e,"darkText",(function(){return w})),n.d(e,"lightText",(function(){return S})),n.d(e,"darkIcons",(function(){return E})),n.d(e,"lightIcons",(function(){return M})),n.d(e,"white",(function(){return C})),n.d(e,"black",(function(){return T}));var i={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},r={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},a={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},o={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},s={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},l={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},u={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},c={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},h={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},d={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},f={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},p={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},m={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},g={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},v={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},y={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},b={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},x={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},_={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},w={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},S={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},E={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},M={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},C="#ffffff",T="#000000";e.default={red:i,pink:r,purple:a,deepPurple:o,indigo:s,blue:l,lightBlue:u,cyan:c,teal:h,green:d,lightGreen:f,lime:p,yellow:m,amber:g,orange:v,deepOrange:y,brown:b,grey:x,blueGrey:_,darkText:w,lightText:S,darkIcons:E,lightIcons:M,white:C,black:T}},function(t,e,n){t.exports.Dispatcher=n(189)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CustomPicker=e.TwitterPicker=e.SwatchesPicker=e.SliderPicker=e.SketchPicker=e.PhotoshopPicker=e.MaterialPicker=e.HuePicker=e.GithubPicker=e.CompactPicker=e.ChromePicker=e.default=e.CirclePicker=e.BlockPicker=e.AlphaPicker=void 0;var i=n(191);Object.defineProperty(e,"AlphaPicker",{enumerable:!0,get:function(){return y(i).default}});var r=n(320);Object.defineProperty(e,"BlockPicker",{enumerable:!0,get:function(){return y(r).default}});var a=n(322);Object.defineProperty(e,"CirclePicker",{enumerable:!0,get:function(){return y(a).default}});var o=n(324);Object.defineProperty(e,"ChromePicker",{enumerable:!0,get:function(){return y(o).default}});var s=n(330);Object.defineProperty(e,"CompactPicker",{enumerable:!0,get:function(){return y(s).default}});var l=n(333);Object.defineProperty(e,"GithubPicker",{enumerable:!0,get:function(){return y(l).default}});var u=n(335);Object.defineProperty(e,"HuePicker",{enumerable:!0,get:function(){return y(u).default}});var c=n(337);Object.defineProperty(e,"MaterialPicker",{enumerable:!0,get:function(){return y(c).default}});var h=n(338);Object.defineProperty(e,"PhotoshopPicker",{enumerable:!0,get:function(){return y(h).default}});var d=n(344);Object.defineProperty(e,"SketchPicker",{enumerable:!0,get:function(){return y(d).default}});var f=n(347);Object.defineProperty(e,"SliderPicker",{enumerable:!0,get:function(){return y(f).default}});var p=n(351);Object.defineProperty(e,"SwatchesPicker",{enumerable:!0,get:function(){return y(p).default}});var m=n(355);Object.defineProperty(e,"TwitterPicker",{enumerable:!0,get:function(){return y(m).default}});var g=n(133);Object.defineProperty(e,"CustomPicker",{enumerable:!0,get:function(){return y(g).default}});var v=y(o);function y(t){return t&&t.__esModule?t:{default:t}}e.default=v.default},function(t,e,n){t.exports=function(t,e){"use strict";var n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e);let i=class extends t.Sprite{constructor({fontSize:e=1,...i}={},r=new t.SpriteMaterial({depthWrite:!1})){super(r);let a=new n.default({fontSize:e,...i});this.material.map=a}onBeforeRender(t,e,n){let{material:i}=this,{map:r}=i;if(r.checkFontFace()){let{scale:e}=this,{height:i,width:a}=r;a&&i?(e.setX(a).setY(i),r.setOptimalPixelRatio(this,t,n),r.redraw()):e.setScalar(1)}else r.loadFontFace()}dispose(){let{material:t}=this,{map:e}=t;e.dispose(),t.dispose()}};return["alignment","backgroundColor","color","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineGap","padding","strokeColor","strokeWidth","text"].forEach(t=>{Object.defineProperty(i.prototype,t,{get(){return this.material.map[t]},set(e){this.material.map[t]=e}})}),i.prototype.isTextSprite=!0,i}(n(1),n(361))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";
/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=n(99),r="function"==typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,l=r?Symbol.for("react.strict_mode"):60108,u=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,h=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function x(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}function _(){}function w(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},_.prototype=x.prototype;var S=w.prototype=new _;S.constructor=w,i(S,x.prototype),S.isPureReactComponent=!0;var E={current:null},M=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,n){var i,r={},o=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)M.call(e,i)&&!C.hasOwnProperty(i)&&(r[i]=e[i]);var l=arguments.length-2;if(1===l)r.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];r.children=u}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===r[i]&&(r[i]=l[i]);return{$$typeof:a,type:t,key:o,ref:s,props:r,_owner:E.current}}function k(t){return"object"==typeof t&&null!==t&&t.$$typeof===a}var P=/\/+/g,A=[];function O(t,e,n,i){if(A.length){var r=A.pop();return r.result=t,r.keyPrefix=e,r.func=n,r.context=i,r.count=0,r}return{result:t,keyPrefix:e,func:n,context:i,count:0}}function L(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>A.length&&A.push(t)}function R(t,e,n){return null==t?0:function t(e,n,i,r){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case a:case o:l=!0}}if(l)return i(r,e,""===n?"."+I(e,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=n+I(s=e[u],u);l+=t(s,c,i,r)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=g&&e[g]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=t(s=s.value,c=n+I(s,u++),i,r);else if("object"===s)throw i=""+e,Error(v(31,"[object Object]"===i?"object with keys {"+Object.keys(e).join(", ")+"}":i,""));return l}(t,"",e,n)}function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function N(t,e){t.func.call(t.context,e,t.count++)}function D(t,e,n){var i=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?z(t,i,n,(function(t){return t})):null!=t&&(k(t)&&(t=function(t,e){return{$$typeof:a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(P,"$&/")+"/")+n)),i.push(t))}function z(t,e,n,i,r){var a="";null!=n&&(a=(""+n).replace(P,"$&/")+"/"),R(t,D,e=O(e,a,i,r)),L(e)}var B={current:null};function F(){var t=B.current;if(null===t)throw Error(v(321));return t}var V={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:i};e.Children={map:function(t,e,n){if(null==t)return t;var i=[];return z(t,i,null,e,n),i},forEach:function(t,e,n){if(null==t)return t;R(t,N,e=O(null,null,e,n)),L(e)},count:function(t){return R(t,(function(){return null}),null)},toArray:function(t){var e=[];return z(t,e,null,(function(t){return t})),e},only:function(t){if(!k(t))throw Error(v(143));return t}},e.Component=x,e.Fragment=s,e.Profiler=u,e.PureComponent=w,e.StrictMode=l,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,e.cloneElement=function(t,e,n){if(null==t)throw Error(v(267,t));var r=i({},t.props),o=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=E.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)M.call(e,c)&&!C.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:a,type:t.type,key:o,ref:s,props:r,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:d,render:t}},e.isValidElement=k,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:p,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return F().useCallback(t,e)},e.useContext=function(t,e){return F().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return F().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return F().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return F().useLayoutEffect(t,e)},e.useMemo=function(t,e){return F().useMemo(t,e)},e.useReducer=function(t,e,n){return F().useReducer(t,e,n)},e.useRef=function(t){return F().useRef(t)},e.useState=function(t){return F().useState(t)},e.version="16.13.1"},function(t,e,n){"use strict";
/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=n(0),r=n(99),a=n(187);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!i)throw Error(o(227));function s(t,e,n,i,r,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){this.onError(t)}}var l=!1,u=null,c=!1,h=null,d={onError:function(t){l=!0,u=t}};function f(t,e,n,i,r,a,o,c,h){l=!1,u=null,s.apply(d,arguments)}var p=null,m=null,g=null;function v(t,e,n){var i=t.type||"unknown-event";t.currentTarget=g(n),function(t,e,n,i,r,a,s,d,p){if(f.apply(this,arguments),l){if(!l)throw Error(o(198));var m=u;l=!1,u=null,c||(c=!0,h=m)}}(i,e,void 0,t),t.currentTarget=null}var y=null,b={};function x(){if(y)for(var t in b){var e=b[t],n=y.indexOf(t);if(!(-1<n))throw Error(o(96,t));if(!w[n]){if(!e.extractEvents)throw Error(o(97,t));for(var i in w[n]=e,n=e.eventTypes){var r=void 0,a=n[i],s=e,l=i;if(S.hasOwnProperty(l))throw Error(o(99,l));S[l]=a;var u=a.phasedRegistrationNames;if(u){for(r in u)u.hasOwnProperty(r)&&_(u[r],s,l);r=!0}else a.registrationName?(_(a.registrationName,s,l),r=!0):r=!1;if(!r)throw Error(o(98,i,t))}}}}function _(t,e,n){if(E[t])throw Error(o(100,t));E[t]=e,M[t]=e.eventTypes[n].dependencies}var w=[],S={},E={},M={};function C(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var i=t[e];if(!b.hasOwnProperty(e)||b[e]!==i){if(b[e])throw Error(o(102,e));b[e]=i,n=!0}}n&&x()}var T=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),k=null,P=null,A=null;function O(t){if(t=m(t)){if("function"!=typeof k)throw Error(o(280));var e=t.stateNode;e&&(e=p(e),k(t.stateNode,t.type,e))}}function L(t){P?A?A.push(t):A=[t]:P=t}function R(){if(P){var t=P,e=A;if(A=P=null,O(t),e)for(t=0;t<e.length;t++)O(e[t])}}function I(t,e){return t(e)}function N(t,e,n,i,r){return t(e,n,i,r)}function D(){}var z=I,B=!1,F=!1;function V(){null===P&&null===A||(D(),R())}function j(t,e,n){if(F)return t(e,n);F=!0;try{return z(t,e,n)}finally{F=!1,V()}}var U=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,G={},W={};function q(t,e,n,i,r,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a}var $={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){$[t]=new q(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];$[e]=new q(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){$[t]=new q(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){$[t]=new q(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){$[t]=new q(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){$[t]=new q(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){$[t]=new q(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){$[t]=new q(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){$[t]=new q(t,5,!1,t.toLowerCase(),null,!1)}));var Q=/[\-:]([a-z])/g;function Y(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(Q,Y);$[e]=new q(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(Q,Y);$[e]=new q(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(Q,Y);$[e]=new q(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){$[t]=new q(t,1,!1,t.toLowerCase(),null,!1)})),$.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){$[t]=new q(t,1,!1,t.toLowerCase(),null,!0)}));var X=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Z(t,e,n,i){var r=$.hasOwnProperty(e)?$[e]:null;(null!==r?0===r.type:!i&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,i){if(null==e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!H.call(W,t)||!H.call(G,t)&&(U.test(t)?W[t]=!0:(G[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}X.hasOwnProperty("ReactCurrentDispatcher")||(X.ReactCurrentDispatcher={current:null}),X.hasOwnProperty("ReactCurrentBatchConfig")||(X.ReactCurrentBatchConfig={suspense:null});var J=/^(.*)[\\\/]/,K="function"==typeof Symbol&&Symbol.for,tt=K?Symbol.for("react.element"):60103,et=K?Symbol.for("react.portal"):60106,nt=K?Symbol.for("react.fragment"):60107,it=K?Symbol.for("react.strict_mode"):60108,rt=K?Symbol.for("react.profiler"):60114,at=K?Symbol.for("react.provider"):60109,ot=K?Symbol.for("react.context"):60110,st=K?Symbol.for("react.concurrent_mode"):60111,lt=K?Symbol.for("react.forward_ref"):60112,ut=K?Symbol.for("react.suspense"):60113,ct=K?Symbol.for("react.suspense_list"):60120,ht=K?Symbol.for("react.memo"):60115,dt=K?Symbol.for("react.lazy"):60116,ft=K?Symbol.for("react.block"):60121,pt="function"==typeof Symbol&&Symbol.iterator;function mt(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=pt&&t[pt]||t["@@iterator"])?t:null}function gt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case rt:return"Profiler";case it:return"StrictMode";case ut:return"Suspense";case ct:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case ot:return"Context.Consumer";case at:return"Context.Provider";case lt:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case ht:return gt(t.type);case ft:return gt(t.render);case dt:if(t=1===t._status?t._result:null)return gt(t)}return null}function vt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var i=t._debugOwner,r=t._debugSource,a=gt(t.type);n=null,i&&(n=gt(i.type)),i=a,a="",r?a=" (at "+r.fileName.replace(J,"")+":"+r.lineNumber+")":n&&(a=" (created by "+n+")"),n="\n    in "+(i||"Unknown")+a}e+=n,t=t.return}while(t);return e}function yt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function bt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function xt(t){t._valueTracker||(t._valueTracker=function(t){var e=bt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function _t(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=bt(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function wt(t,e){var n=e.checked;return r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function St(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=yt(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Et(t,e){null!=(e=e.checked)&&Z(t,"checked",e,!1)}function Mt(t,e){Et(t,e);var n=yt(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?Tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Tt(t,e.type,yt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Ct(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Tt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function kt(t,e){return t=r({children:void 0},e),(e=function(t){var e="";return i.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Pt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+yt(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function At(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ot(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:yt(n)}}function Lt(t,e){var n=yt(e.value),i=yt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function Rt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var It="http://www.w3.org/1999/xhtml",Nt="http://www.w3.org/2000/svg";function Dt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Dt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Bt,Ft=function(t){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction((function(){return t(e,n)}))}:t}((function(t,e){if(t.namespaceURI!==Nt||"innerHTML"in t)t.innerHTML=e;else{for((Bt=Bt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function Vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function jt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ut={animationend:jt("Animation","AnimationEnd"),animationiteration:jt("Animation","AnimationIteration"),animationstart:jt("Animation","AnimationStart"),transitionend:jt("Transition","TransitionEnd")},Ht={},Gt={};function Wt(t){if(Ht[t])return Ht[t];if(!Ut[t])return t;var e,n=Ut[t];for(e in n)if(n.hasOwnProperty(e)&&e in Gt)return Ht[t]=n[e];return t}T&&(Gt=document.createElement("div").style,"AnimationEvent"in window||(delete Ut.animationend.animation,delete Ut.animationiteration.animation,delete Ut.animationstart.animation),"TransitionEvent"in window||delete Ut.transitionend.transition);var qt=Wt("animationend"),$t=Wt("animationiteration"),Qt=Wt("animationstart"),Yt=Wt("transitionend"),Xt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zt=new("function"==typeof WeakMap?WeakMap:Map);function Jt(t){var e=Zt.get(t);return void 0===e&&(e=new Map,Zt.set(t,e)),e}function Kt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function te(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ee(t){if(Kt(t)!==t)throw Error(o(188))}function ne(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=Kt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return ee(r),t;if(a===i)return ee(r),e;a=a.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=a;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=a;break}if(l===i){s=!0,i=r,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,i=r;break}if(l===i){s=!0,i=a,n=r;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function ie(t,e){if(null==e)throw Error(o(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function re(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var ae=null;function oe(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var i=0;i<e.length&&!t.isPropagationStopped();i++)v(t,e[i],n[i]);else e&&v(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function se(t){if(null!==t&&(ae=ie(ae,t)),t=ae,ae=null,t){if(re(t,oe),ae)throw Error(o(95));if(c)throw t=h,c=!1,h=null,t}}function le(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ue(t){if(!T)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"==typeof e[t]),e}var ce=[];function he(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>ce.length&&ce.push(t)}function de(t,e,n,i){if(ce.length){var r=ce.pop();return r.topLevelType=t,r.eventSystemFlags=i,r.nativeEvent=e,r.targetInst=n,r}return{topLevelType:t,eventSystemFlags:i,nativeEvent:e,targetInst:n,ancestors:[]}}function fe(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var i=n;if(3===i.tag)i=i.stateNode.containerInfo;else{for(;i.return;)i=i.return;i=3!==i.tag?null:i.stateNode.containerInfo}if(!i)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Tn(i)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var r=le(t.nativeEvent);i=t.topLevelType;var a=t.nativeEvent,o=t.eventSystemFlags;0===n&&(o|=64);for(var s=null,l=0;l<w.length;l++){var u=w[l];u&&(u=u.extractEvents(i,e,a,r,o))&&(s=ie(s,u))}se(s)}}function pe(t,e,n){if(!n.has(t)){switch(t){case"scroll":Qe(e,"scroll",!0);break;case"focus":case"blur":Qe(e,"focus",!0),Qe(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ue(t)&&Qe(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Xt.indexOf(t)&&$e(t,e)}n.set(t,null)}}var me,ge,ve,ye=!1,be=[],xe=null,_e=null,we=null,Se=new Map,Ee=new Map,Me=[],Ce="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Te="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function ke(t,e,n,i,r){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:r,container:i}}function Pe(t,e){switch(t){case"focus":case"blur":xe=null;break;case"dragenter":case"dragleave":_e=null;break;case"mouseover":case"mouseout":we=null;break;case"pointerover":case"pointerout":Se.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ee.delete(e.pointerId)}}function Ae(t,e,n,i,r,a){return null===t||t.nativeEvent!==a?(t=ke(e,n,i,r,a),null!==e&&(null!==(e=kn(e))&&ge(e)),t):(t.eventSystemFlags|=i,t)}function Oe(t){var e=Tn(t.target);if(null!==e){var n=Kt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=te(n)))return t.blockedOn=e,void a.unstable_runWithPriority(t.priority,(function(){ve(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Le(t){if(null!==t.blockedOn)return!1;var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=kn(e);return null!==n&&ge(n),t.blockedOn=e,!1}return!0}function Re(t,e,n){Le(t)&&n.delete(e)}function Ie(){for(ye=!1;0<be.length;){var t=be[0];if(null!==t.blockedOn){null!==(t=kn(t.blockedOn))&&me(t);break}var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:be.shift()}null!==xe&&Le(xe)&&(xe=null),null!==_e&&Le(_e)&&(_e=null),null!==we&&Le(we)&&(we=null),Se.forEach(Re),Ee.forEach(Re)}function Ne(t,e){t.blockedOn===e&&(t.blockedOn=null,ye||(ye=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ie)))}function De(t){function e(e){return Ne(e,t)}if(0<be.length){Ne(be[0],t);for(var n=1;n<be.length;n++){var i=be[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==xe&&Ne(xe,t),null!==_e&&Ne(_e,t),null!==we&&Ne(we,t),Se.forEach(e),Ee.forEach(e),n=0;n<Me.length;n++)(i=Me[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Oe(n),null===n.blockedOn&&Me.shift()}var ze={},Be=new Map,Fe=new Map,Ve=["abort","abort",qt,"animationEnd",$t,"animationIteration",Qt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Yt,"transitionEnd","waiting","waiting"];function je(t,e){for(var n=0;n<t.length;n+=2){var i=t[n],r=t[n+1],a="on"+(r[0].toUpperCase()+r.slice(1));a={phasedRegistrationNames:{bubbled:a,captured:a+"Capture"},dependencies:[i],eventPriority:e},Fe.set(i,e),Be.set(i,a),ze[r]=a}}je("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),je("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),je(Ve,2);for(var Ue="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),He=0;He<Ue.length;He++)Fe.set(Ue[He],0);var Ge=a.unstable_UserBlockingPriority,We=a.unstable_runWithPriority,qe=!0;function $e(t,e){Qe(e,t,!1)}function Qe(t,e,n){var i=Fe.get(e);switch(void 0===i?2:i){case 0:i=Ye.bind(null,e,1,t);break;case 1:i=Xe.bind(null,e,1,t);break;default:i=Ze.bind(null,e,1,t)}n?t.addEventListener(e,i,!0):t.addEventListener(e,i,!1)}function Ye(t,e,n,i){B||D();var r=Ze,a=B;B=!0;try{N(r,t,e,n,i)}finally{(B=a)||V()}}function Xe(t,e,n,i){We(Ge,Ze.bind(null,t,e,n,i))}function Ze(t,e,n,i){if(qe)if(0<be.length&&-1<Ce.indexOf(t))t=ke(null,t,e,n,i),be.push(t);else{var r=Je(t,e,n,i);if(null===r)Pe(t,i);else if(-1<Ce.indexOf(t))t=ke(r,t,e,n,i),be.push(t);else if(!function(t,e,n,i,r){switch(e){case"focus":return xe=Ae(xe,t,e,n,i,r),!0;case"dragenter":return _e=Ae(_e,t,e,n,i,r),!0;case"mouseover":return we=Ae(we,t,e,n,i,r),!0;case"pointerover":var a=r.pointerId;return Se.set(a,Ae(Se.get(a)||null,t,e,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,Ee.set(a,Ae(Ee.get(a)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i)){Pe(t,i),t=de(t,i,null,e);try{j(fe,t)}finally{he(t)}}}}function Je(t,e,n,i){if(null!==(n=Tn(n=le(i)))){var r=Kt(n);if(null===r)n=null;else{var a=r.tag;if(13===a){if(null!==(n=te(r)))return n;n=null}else if(3===a){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}t=de(t,i,n,e);try{j(fe,t)}finally{he(t)}return null}var Ke={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function en(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||Ke.hasOwnProperty(t)&&Ke[t]?(""+e).trim():e+"px"}function nn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=en(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(Ke).forEach((function(t){tn.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ke[e]=Ke[t]}))}));var rn=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function an(t,e){if(e){if(rn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(o(62,""))}}function on(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=It;function ln(t,e){var n=Jt(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=M[e];for(var i=0;i<e.length;i++)pe(e[i],t,n)}function un(){}function cn(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dn(t,e){var n,i=hn(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=hn(i)}}function fn(){for(var t=window,e=cn();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=cn((t=e.contentWindow).document)}return e}function pn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var mn=null,gn=null;function vn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function yn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var bn="function"==typeof setTimeout?setTimeout:void 0,xn="function"==typeof clearTimeout?clearTimeout:void 0;function _n(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function wn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Sn=Math.random().toString(36).slice(2),En="__reactInternalInstance$"+Sn,Mn="__reactEventHandlers$"+Sn,Cn="__reactContainere$"+Sn;function Tn(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Cn]||n[En]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=wn(t);null!==t;){if(n=t[En])return n;t=wn(t)}return e}n=(t=n).parentNode}return null}function kn(t){return!(t=t[En]||t[Cn])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Pn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function An(t){return t[Mn]||null}function On(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Ln(t,e){var n=t.stateNode;if(!n)return null;var i=p(n);if(!i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(o(231,e,typeof n));return n}function Rn(t,e,n){(e=Ln(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=ie(n._dispatchListeners,e),n._dispatchInstances=ie(n._dispatchInstances,t))}function In(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=On(e);for(e=n.length;0<e--;)Rn(n[e],"captured",t);for(e=0;e<n.length;e++)Rn(n[e],"bubbled",t)}}function Nn(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Ln(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=ie(n._dispatchListeners,e),n._dispatchInstances=ie(n._dispatchInstances,t))}function Dn(t){t&&t.dispatchConfig.registrationName&&Nn(t._targetInst,null,t)}function zn(t){re(t,In)}var Bn=null,Fn=null,Vn=null;function jn(){if(Vn)return Vn;var t,e,n=Fn,i=n.length,r="value"in Bn?Bn.value:Bn.textContent,a=r.length;for(t=0;t<i&&n[t]===r[t];t++);var o=i-t;for(e=1;e<=o&&n[i-e]===r[a-e];e++);return Vn=r.slice(t,1<e?1-e:void 0)}function Un(){return!0}function Hn(){return!1}function Gn(t,e,n,i){for(var r in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(r)&&((e=t[r])?this[r]=e(n):"target"===r?this.target=i:this[r]=n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Un:Hn,this.isPropagationStopped=Hn,this}function Wn(t,e,n,i){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,t,e,n,i),r}return new this(t,e,n,i)}function qn(t){if(!(t instanceof this))throw Error(o(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function $n(t){t.eventPool=[],t.getPooled=Wn,t.release=qn}r(Gn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Un)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Un)},persist:function(){this.isPersistent=Un},isPersistent:Hn,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Hn,this._dispatchInstances=this._dispatchListeners=null}}),Gn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Gn.extend=function(t){function e(){}function n(){return i.apply(this,arguments)}var i=this;e.prototype=i.prototype;var a=new e;return r(a,n.prototype),n.prototype=a,n.prototype.constructor=n,n.Interface=r({},i.Interface,t),n.extend=i.extend,$n(n),n},$n(Gn);var Qn=Gn.extend({data:null}),Yn=Gn.extend({data:null}),Xn=[9,13,27,32],Zn=T&&"CompositionEvent"in window,Jn=null;T&&"documentMode"in document&&(Jn=document.documentMode);var Kn=T&&"TextEvent"in window&&!Jn,ti=T&&(!Zn||Jn&&8<Jn&&11>=Jn),ei=String.fromCharCode(32),ni={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},ii=!1;function ri(t,e){switch(t){case"keyup":return-1!==Xn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function ai(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var oi=!1;var si={eventTypes:ni,extractEvents:function(t,e,n,i){var r;if(Zn)t:{switch(t){case"compositionstart":var a=ni.compositionStart;break t;case"compositionend":a=ni.compositionEnd;break t;case"compositionupdate":a=ni.compositionUpdate;break t}a=void 0}else oi?ri(t,n)&&(a=ni.compositionEnd):"keydown"===t&&229===n.keyCode&&(a=ni.compositionStart);return a?(ti&&"ko"!==n.locale&&(oi||a!==ni.compositionStart?a===ni.compositionEnd&&oi&&(r=jn()):(Fn="value"in(Bn=i)?Bn.value:Bn.textContent,oi=!0)),a=Qn.getPooled(a,e,n,i),r?a.data=r:null!==(r=ai(n))&&(a.data=r),zn(a),r=a):r=null,(t=Kn?function(t,e){switch(t){case"compositionend":return ai(e);case"keypress":return 32!==e.which?null:(ii=!0,ei);case"textInput":return(t=e.data)===ei&&ii?null:t;default:return null}}(t,n):function(t,e){if(oi)return"compositionend"===t||!Zn&&ri(t,e)?(t=jn(),Vn=Fn=Bn=null,oi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ti&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=Yn.getPooled(ni.beforeInput,e,n,i)).data=t,zn(e)):e=null,null===r?e:null===e?r:[r,e]}},li={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ui(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!li[t.type]:"textarea"===e}var ci={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function hi(t,e,n){return(t=Gn.getPooled(ci.change,t,e,n)).type="change",L(n),zn(t),t}var di=null,fi=null;function pi(t){se(t)}function mi(t){if(_t(Pn(t)))return t}function gi(t,e){if("change"===t)return e}var vi=!1;function yi(){di&&(di.detachEvent("onpropertychange",bi),fi=di=null)}function bi(t){if("value"===t.propertyName&&mi(fi))if(t=hi(fi,t,le(t)),B)se(t);else{B=!0;try{I(pi,t)}finally{B=!1,V()}}}function xi(t,e,n){"focus"===t?(yi(),fi=n,(di=e).attachEvent("onpropertychange",bi)):"blur"===t&&yi()}function _i(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return mi(fi)}function wi(t,e){if("click"===t)return mi(e)}function Si(t,e){if("input"===t||"change"===t)return mi(e)}T&&(vi=ue("input")&&(!document.documentMode||9<document.documentMode));var Ei={eventTypes:ci,_isInputEventSupported:vi,extractEvents:function(t,e,n,i){var r=e?Pn(e):window,a=r.nodeName&&r.nodeName.toLowerCase();if("select"===a||"input"===a&&"file"===r.type)var o=gi;else if(ui(r))if(vi)o=Si;else{o=_i;var s=xi}else(a=r.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===r.type||"radio"===r.type)&&(o=wi);if(o&&(o=o(t,e)))return hi(o,n,i);s&&s(t,r,e),"blur"===t&&(t=r._wrapperState)&&t.controlled&&"number"===r.type&&Tt(r,"number",r.value)}},Mi=Gn.extend({view:null,detail:null}),Ci={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ti(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Ci[t])&&!!e[t]}function ki(){return Ti}var Pi=0,Ai=0,Oi=!1,Li=!1,Ri=Mi.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:ki,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Pi;return Pi=t.screenX,Oi?"mousemove"===t.type?t.screenX-e:0:(Oi=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ai;return Ai=t.screenY,Li?"mousemove"===t.type?t.screenY-e:0:(Li=!0,0)}}),Ii=Ri.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Ni={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Di={eventTypes:Ni,extractEvents:function(t,e,n,i,r){var a="mouseover"===t||"pointerover"===t,o="mouseout"===t||"pointerout"===t;if(a&&0==(32&r)&&(n.relatedTarget||n.fromElement)||!o&&!a)return null;(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,o)?(o=e,null!==(e=(e=n.relatedTarget||n.toElement)?Tn(e):null)&&(e!==Kt(e)||5!==e.tag&&6!==e.tag)&&(e=null)):o=null;if(o===e)return null;if("mouseout"===t||"mouseover"===t)var s=Ri,l=Ni.mouseLeave,u=Ni.mouseEnter,c="mouse";else"pointerout"!==t&&"pointerover"!==t||(s=Ii,l=Ni.pointerLeave,u=Ni.pointerEnter,c="pointer");if(t=null==o?a:Pn(o),a=null==e?a:Pn(e),(l=s.getPooled(l,o,n,i)).type=c+"leave",l.target=t,l.relatedTarget=a,(n=s.getPooled(u,e,n,i)).type=c+"enter",n.target=a,n.relatedTarget=t,c=e,(i=o)&&c)t:{for(u=c,o=0,t=s=i;t;t=On(t))o++;for(t=0,e=u;e;e=On(e))t++;for(;0<o-t;)s=On(s),o--;for(;0<t-o;)u=On(u),t--;for(;o--;){if(s===u||s===u.alternate)break t;s=On(s),u=On(u)}s=null}else s=null;for(u=s,s=[];i&&i!==u&&(null===(o=i.alternate)||o!==u);)s.push(i),i=On(i);for(i=[];c&&c!==u&&(null===(o=c.alternate)||o!==u);)i.push(c),c=On(c);for(c=0;c<s.length;c++)Nn(s[c],"bubbled",l);for(c=i.length;0<c--;)Nn(i[c],"captured",n);return 0==(64&r)?[l]:[l,n]}};var zi="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},Bi=Object.prototype.hasOwnProperty;function Fi(t,e){if(zi(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!Bi.call(e,n[i])||!zi(t[n[i]],e[n[i]]))return!1;return!0}var Vi=T&&"documentMode"in document&&11>=document.documentMode,ji={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Ui=null,Hi=null,Gi=null,Wi=!1;function qi(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Wi||null==Ui||Ui!==cn(n)?null:("selectionStart"in(n=Ui)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Gi&&Fi(Gi,n)?null:(Gi=n,(t=Gn.getPooled(ji.select,Hi,t,e)).type="select",t.target=Ui,zn(t),t))}var $i={eventTypes:ji,extractEvents:function(t,e,n,i,r,a){if(!(a=!(r=a||(i.window===i?i.document:9===i.nodeType?i:i.ownerDocument)))){t:{r=Jt(r),a=M.onSelect;for(var o=0;o<a.length;o++)if(!r.has(a[o])){r=!1;break t}r=!0}a=!r}if(a)return null;switch(r=e?Pn(e):window,t){case"focus":(ui(r)||"true"===r.contentEditable)&&(Ui=r,Hi=e,Gi=null);break;case"blur":Gi=Hi=Ui=null;break;case"mousedown":Wi=!0;break;case"contextmenu":case"mouseup":case"dragend":return Wi=!1,qi(n,i);case"selectionchange":if(Vi)break;case"keydown":case"keyup":return qi(n,i)}return null}},Qi=Gn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Yi=Gn.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Xi=Mi.extend({relatedTarget:null});function Zi(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var Ji={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ki={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tr=Mi.extend({key:function(t){if(t.key){var e=Ji[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Zi(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Ki[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:ki,charCode:function(t){return"keypress"===t.type?Zi(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Zi(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),er=Ri.extend({dataTransfer:null}),nr=Mi.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:ki}),ir=Gn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),rr=Ri.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),ar={eventTypes:ze,extractEvents:function(t,e,n,i){var r=Be.get(t);if(!r)return null;switch(t){case"keypress":if(0===Zi(n))return null;case"keydown":case"keyup":t=tr;break;case"blur":case"focus":t=Xi;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Ri;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=er;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=nr;break;case qt:case $t:case Qt:t=Qi;break;case Yt:t=ir;break;case"scroll":t=Mi;break;case"wheel":t=rr;break;case"copy":case"cut":case"paste":t=Yi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Ii;break;default:t=Gn}return zn(e=t.getPooled(r,e,n,i)),e}};if(y)throw Error(o(101));y=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),x(),p=An,m=kn,g=Pn,C({SimpleEventPlugin:ar,EnterLeaveEventPlugin:Di,ChangeEventPlugin:Ei,SelectEventPlugin:$i,BeforeInputEventPlugin:si});var or=[],sr=-1;function lr(t){0>sr||(t.current=or[sr],or[sr]=null,sr--)}function ur(t,e){sr++,or[sr]=t.current,t.current=e}var cr={},hr={current:cr},dr={current:!1},fr=cr;function pr(t,e){var n=t.type.contextTypes;if(!n)return cr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in n)a[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function mr(t){return null!=(t=t.childContextTypes)}function gr(){lr(dr),lr(hr)}function vr(t,e,n){if(hr.current!==cr)throw Error(o(168));ur(hr,e),ur(dr,n)}function yr(t,e,n){var i=t.stateNode;if(t=e.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var a in i=i.getChildContext())if(!(a in t))throw Error(o(108,gt(e)||"Unknown",a));return r({},n,{},i)}function br(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||cr,fr=hr.current,ur(hr,t),ur(dr,dr.current),!0}function xr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=yr(t,e,fr),i.__reactInternalMemoizedMergedChildContext=t,lr(dr),lr(hr),ur(hr,t)):lr(dr),ur(dr,n)}var _r=a.unstable_runWithPriority,wr=a.unstable_scheduleCallback,Sr=a.unstable_cancelCallback,Er=a.unstable_requestPaint,Mr=a.unstable_now,Cr=a.unstable_getCurrentPriorityLevel,Tr=a.unstable_ImmediatePriority,kr=a.unstable_UserBlockingPriority,Pr=a.unstable_NormalPriority,Ar=a.unstable_LowPriority,Or=a.unstable_IdlePriority,Lr={},Rr=a.unstable_shouldYield,Ir=void 0!==Er?Er:function(){},Nr=null,Dr=null,zr=!1,Br=Mr(),Fr=1e4>Br?Mr:function(){return Mr()-Br};function Vr(){switch(Cr()){case Tr:return 99;case kr:return 98;case Pr:return 97;case Ar:return 96;case Or:return 95;default:throw Error(o(332))}}function jr(t){switch(t){case 99:return Tr;case 98:return kr;case 97:return Pr;case 96:return Ar;case 95:return Or;default:throw Error(o(332))}}function Ur(t,e){return t=jr(t),_r(t,e)}function Hr(t,e,n){return t=jr(t),wr(t,e,n)}function Gr(t){return null===Nr?(Nr=[t],Dr=wr(Tr,qr)):Nr.push(t),Lr}function Wr(){if(null!==Dr){var t=Dr;Dr=null,Sr(t)}qr()}function qr(){if(!zr&&null!==Nr){zr=!0;var t=0;try{var e=Nr;Ur(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Nr=null}catch(e){throw null!==Nr&&(Nr=Nr.slice(t+1)),wr(Tr,Wr),e}finally{zr=!1}}}function $r(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function Qr(t,e){if(t&&t.defaultProps)for(var n in e=r({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var Yr={current:null},Xr=null,Zr=null,Jr=null;function Kr(){Jr=Zr=Xr=null}function ta(t){var e=Yr.current;lr(Yr),t.type._context._currentValue=e}function ea(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function na(t,e){Xr=t,Jr=Zr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Ao=!0),t.firstContext=null)}function ia(t,e){if(Jr!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(Jr=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Zr){if(null===Xr)throw Error(o(308));Zr=e,Xr.dependencies={expirationTime:0,firstContext:e,responders:null}}else Zr=Zr.next=e;return t._currentValue}var ra=!1;function aa(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oa(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function sa(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function la(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function ua(t,e){var n=t.alternate;null!==n&&oa(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function ca(t,e,n,i){var a=t.updateQueue;ra=!1;var o=a.baseQueue,s=a.shared.pending;if(null!==s){if(null!==o){var l=o.next;o.next=s.next,s.next=l}o=s,a.shared.pending=null,null!==(l=t.alternate)&&(null!==(l=l.updateQueue)&&(l.baseQueue=s))}if(null!==o){l=o.next;var u=a.baseState,c=0,h=null,d=null,f=null;if(null!==l)for(var p=l;;){if((s=p.expirationTime)<i){var m={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===f?(d=f=m,h=u):f=f.next=m,s>c&&(c=s)}else{null!==f&&(f=f.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null}),al(s,p.suspenseConfig);t:{var g=t,v=p;switch(s=e,m=n,v.tag){case 1:if("function"==typeof(g=v.payload)){u=g.call(m,u,s);break t}u=g;break t;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null==(s="function"==typeof(g=v.payload)?g.call(m,u,s):g))break t;u=r({},u,s);break t;case 2:ra=!0}}null!==p.callback&&(t.effectTag|=32,null===(s=a.effects)?a.effects=[p]:s.push(p))}if(null===(p=p.next)||p===l){if(null===(s=a.shared.pending))break;p=o.next=s.next,s.next=l,a.baseQueue=o=s,a.shared.pending=null}}null===f?h=u:f.next=d,a.baseState=h,a.baseQueue=f,ol(c),t.expirationTime=c,t.memoizedState=u}}function ha(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=r,r=n,"function"!=typeof i)throw Error(o(191,i));i.call(r)}}}var da=X.ReactCurrentBatchConfig,fa=(new i.Component).refs;function pa(t,e,n,i){n=null==(n=n(i,e=t.memoizedState))?e:r({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var ma={isMounted:function(t){return!!(t=t._reactInternalFiber)&&Kt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var i=qs(),r=da.suspense;(r=sa(i=$s(i,t,r),r)).payload=e,null!=n&&(r.callback=n),la(t,r),Qs(t,i)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var i=qs(),r=da.suspense;(r=sa(i=$s(i,t,r),r)).tag=1,r.payload=e,null!=n&&(r.callback=n),la(t,r),Qs(t,i)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=qs(),i=da.suspense;(i=sa(n=$s(n,t,i),i)).tag=2,null!=e&&(i.callback=e),la(t,i),Qs(t,n)}};function ga(t,e,n,i,r,a,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,a,o):!e.prototype||!e.prototype.isPureReactComponent||(!Fi(n,i)||!Fi(r,a))}function va(t,e,n){var i=!1,r=cr,a=e.contextType;return"object"==typeof a&&null!==a?a=ia(a):(r=mr(e)?fr:hr.current,a=(i=null!=(i=e.contextTypes))?pr(t,r):cr),e=new e(n,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ma,t.stateNode=e,e._reactInternalFiber=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),e}function ya(t,e,n,i){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ma.enqueueReplaceState(e,e.state,null)}function ba(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=fa,aa(t);var a=e.contextType;"object"==typeof a&&null!==a?r.context=ia(a):(a=mr(e)?fr:hr.current,r.context=pr(t,a)),ca(t,n,r,i),r.state=t.memoizedState,"function"==typeof(a=e.getDerivedStateFromProps)&&(pa(t,e,a,n),r.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(e=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&ma.enqueueReplaceState(r,r.state,null),ca(t,n,r,i),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.effectTag|=4)}var xa=Array.isArray;function _a(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===r?e.ref:((e=function(t){var e=i.refs;e===fa&&(e=i.refs={}),null===t?delete e[r]:e[r]=t})._stringRef=r,e)}if("string"!=typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function wa(t,e){if("textarea"!==t.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Sa(t){function e(e,n){if(t){var i=e.lastEffect;null!==i?(i.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Cl(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.effectTag=2,n):i:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Pl(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){return null!==e&&e.elementType===n.type?((i=r(e,n.props)).ref=_a(t,e,n),i.return=t,i):((i=Tl(n.type,n.key,n.props,null,t.mode,i)).ref=_a(t,e,n),i.return=t,i)}function c(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Al(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,a){return null===e||7!==e.tag?((e=kl(n,t.mode,i,a)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Pl(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Tl(e.type,e.key,e.props,null,t.mode,n)).ref=_a(t,null,e),n.return=t,n;case et:return(e=Al(e,t.mode,n)).return=t,e}if(xa(e)||mt(e))return(e=kl(e,t.mode,n,null)).return=t,e;wa(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===r?n.type===nt?h(t,e,n.props.children,i,r):u(t,e,n,i):null;case et:return n.key===r?c(t,e,n,i):null}if(xa(n)||mt(n))return null!==r?null:h(t,e,n,i,null);wa(t,n)}return null}function p(t,e,n,i,r){if("string"==typeof i||"number"==typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case tt:return t=t.get(null===i.key?n:i.key)||null,i.type===nt?h(e,t,i.props.children,r,i.key):u(e,t,i,r);case et:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r)}if(xa(i)||mt(i))return h(e,t=t.get(n)||null,i,r,null);wa(e,i)}return null}function m(r,o,s,l){for(var u=null,c=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(r,h,s[m],l);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(r,h),o=a(v,o,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===s.length)return n(r,h),u;if(null===h){for(;m<s.length;m++)null!==(h=d(r,s[m],l))&&(o=a(h,o,m),null===c?u=h:c.sibling=h,c=h);return u}for(h=i(r,h);m<s.length;m++)null!==(g=p(h,r,m,s[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(r,t)})),u}function g(r,s,l,u){var c=mt(l);if("function"!=typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var h=c=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(r,m,y.value,u);if(null===b){null===m&&(m=v);break}t&&m&&null===b.alternate&&e(r,m),s=a(b,s,g),null===h?c=b:h.sibling=b,h=b,m=v}if(y.done)return n(r,m),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(r,y.value,u))&&(s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return c}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=p(m,r,g,y.value,u))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(r,t)})),c}return function(t,i,a,l){var u="object"==typeof a&&null!==a&&a.type===nt&&null===a.key;u&&(a=a.props.children);var c="object"==typeof a&&null!==a;if(c)switch(a.$$typeof){case tt:t:{for(c=a.key,u=i;null!==u;){if(u.key===c){switch(u.tag){case 7:if(a.type===nt){n(t,u.sibling),(i=r(u,a.props.children)).return=t,t=i;break t}break;default:if(u.elementType===a.type){n(t,u.sibling),(i=r(u,a.props)).ref=_a(t,u,a),i.return=t,t=i;break t}}n(t,u);break}e(t,u),u=u.sibling}a.type===nt?((i=kl(a.props.children,t.mode,l,a.key)).return=t,t=i):((l=Tl(a.type,a.key,a.props,null,t.mode,l)).ref=_a(t,i,a),l.return=t,t=l)}return s(t);case et:t:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(t,i.sibling),(i=r(i,a.children||[])).return=t,t=i;break t}n(t,i);break}e(t,i),i=i.sibling}(i=Al(a,t.mode,l)).return=t,t=i}return s(t)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==i&&6===i.tag?(n(t,i.sibling),(i=r(i,a)).return=t,t=i):(n(t,i),(i=Pl(a,t.mode,l)).return=t,t=i),s(t);if(xa(a))return m(t,i,a,l);if(mt(a))return g(t,i,a,l);if(c&&wa(t,a),void 0===a&&!u)switch(t.tag){case 1:case 0:throw t=t.type,Error(o(152,t.displayName||t.name||"Component"))}return n(t,i)}}var Ea=Sa(!0),Ma=Sa(!1),Ca={},Ta={current:Ca},ka={current:Ca},Pa={current:Ca};function Aa(t){if(t===Ca)throw Error(o(174));return t}function Oa(t,e){switch(ur(Pa,e),ur(ka,t),ur(Ta,Ca),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zt(null,"");break;default:e=zt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}lr(Ta),ur(Ta,e)}function La(){lr(Ta),lr(ka),lr(Pa)}function Ra(t){Aa(Pa.current);var e=Aa(Ta.current),n=zt(e,t.type);e!==n&&(ur(ka,t),ur(Ta,n))}function Ia(t){ka.current===t&&(lr(Ta),lr(ka))}var Na={current:0};function Da(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function za(t,e){return{responder:t,props:e}}var Ba=X.ReactCurrentDispatcher,Fa=X.ReactCurrentBatchConfig,Va=0,ja=null,Ua=null,Ha=null,Ga=!1;function Wa(){throw Error(o(321))}function qa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zi(t[n],e[n]))return!1;return!0}function $a(t,e,n,i,r,a){if(Va=a,ja=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Ba.current=null===t||null===t.memoizedState?vo:yo,t=n(i,r),e.expirationTime===Va){a=0;do{if(e.expirationTime=0,!(25>a))throw Error(o(301));a+=1,Ha=Ua=null,e.updateQueue=null,Ba.current=bo,t=n(i,r)}while(e.expirationTime===Va)}if(Ba.current=go,e=null!==Ua&&null!==Ua.next,Va=0,Ha=Ua=ja=null,Ga=!1,e)throw Error(o(300));return t}function Qa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ha?ja.memoizedState=Ha=t:Ha=Ha.next=t,Ha}function Ya(){if(null===Ua){var t=ja.alternate;t=null!==t?t.memoizedState:null}else t=Ua.next;var e=null===Ha?ja.memoizedState:Ha.next;if(null!==e)Ha=e,Ua=t;else{if(null===t)throw Error(o(310));t={memoizedState:(Ua=t).memoizedState,baseState:Ua.baseState,baseQueue:Ua.baseQueue,queue:Ua.queue,next:null},null===Ha?ja.memoizedState=Ha=t:Ha=Ha.next=t}return Ha}function Xa(t,e){return"function"==typeof e?e(t):e}function Za(t){var e=Ya(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=Ua,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}i.baseQueue=r=a,n.pending=null}if(null!==r){r=r.next,i=i.baseState;var l=s=a=null,u=r;do{var c=u.expirationTime;if(c<Va){var h={expirationTime:u.expirationTime,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=h,a=i):l=l.next=h,c>ja.expirationTime&&(ja.expirationTime=c,ol(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),al(c,u.suspenseConfig),i=u.eagerReducer===t?u.eagerState:t(i,u.action);u=u.next}while(null!==u&&u!==r);null===l?a=i:l.next=s,zi(i,e.memoizedState)||(Ao=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}return[e.memoizedState,n.dispatch]}function Ja(t){var e=Ya(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=t(a,s.action),s=s.next}while(s!==r);zi(a,e.memoizedState)||(Ao=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Ka(t){var e=Qa();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:t}).dispatch=mo.bind(null,ja,t),[e.memoizedState,t]}function to(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=ja.updateQueue)?(e={lastEffect:null},ja.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function eo(){return Ya().memoizedState}function no(t,e,n,i){var r=Qa();ja.effectTag|=t,r.memoizedState=to(1|e,n,void 0,void 0===i?null:i)}function io(t,e,n,i){var r=Ya();i=void 0===i?null:i;var a=void 0;if(null!==Ua){var o=Ua.memoizedState;if(a=o.destroy,null!==i&&qa(i,o.deps))return void to(e,n,a,i)}ja.effectTag|=t,r.memoizedState=to(1|e,n,a,i)}function ro(t,e){return no(516,4,t,e)}function ao(t,e){return io(516,4,t,e)}function oo(t,e){return io(4,2,t,e)}function so(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function lo(t,e,n){return n=null!=n?n.concat([t]):null,io(4,2,so.bind(null,e,t),n)}function uo(){}function co(t,e){return Qa().memoizedState=[t,void 0===e?null:e],t}function ho(t,e){var n=Ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&qa(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function fo(t,e){var n=Ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&qa(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function po(t,e,n){var i=Vr();Ur(98>i?98:i,(function(){t(!0)})),Ur(97<i?97:i,(function(){var i=Fa.suspense;Fa.suspense=void 0===e?null:e;try{t(!1),n()}finally{Fa.suspense=i}}))}function mo(t,e,n){var i=qs(),r=da.suspense;r={expirationTime:i=$s(i,t,r),suspenseConfig:r,action:n,eagerReducer:null,eagerState:null,next:null};var a=e.pending;if(null===a?r.next=r:(r.next=a.next,a.next=r),e.pending=r,a=t.alternate,t===ja||null!==a&&a===ja)Ga=!0,r.expirationTime=Va,ja.expirationTime=Va;else{if(0===t.expirationTime&&(null===a||0===a.expirationTime)&&null!==(a=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=a(o,n);if(r.eagerReducer=a,r.eagerState=s,zi(s,o))return}catch(t){}Qs(t,i)}}var go={readContext:ia,useCallback:Wa,useContext:Wa,useEffect:Wa,useImperativeHandle:Wa,useLayoutEffect:Wa,useMemo:Wa,useReducer:Wa,useRef:Wa,useState:Wa,useDebugValue:Wa,useResponder:Wa,useDeferredValue:Wa,useTransition:Wa},vo={readContext:ia,useCallback:co,useContext:ia,useEffect:ro,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,no(4,2,so.bind(null,e,t),n)},useLayoutEffect:function(t,e){return no(4,2,t,e)},useMemo:function(t,e){var n=Qa();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Qa();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t=(t=i.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=mo.bind(null,ja,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},Qa().memoizedState=t},useState:Ka,useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Ka(t),i=n[0],r=n[1];return ro((function(){var n=Fa.suspense;Fa.suspense=void 0===e?null:e;try{r(t)}finally{Fa.suspense=n}}),[t,e]),i},useTransition:function(t){var e=Ka(!1),n=e[0];return e=e[1],[co(po.bind(null,e,t),[e,t]),n]}},yo={readContext:ia,useCallback:ho,useContext:ia,useEffect:ao,useImperativeHandle:lo,useLayoutEffect:oo,useMemo:fo,useReducer:Za,useRef:eo,useState:function(){return Za(Xa)},useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Za(Xa),i=n[0],r=n[1];return ao((function(){var n=Fa.suspense;Fa.suspense=void 0===e?null:e;try{r(t)}finally{Fa.suspense=n}}),[t,e]),i},useTransition:function(t){var e=Za(Xa),n=e[0];return e=e[1],[ho(po.bind(null,e,t),[e,t]),n]}},bo={readContext:ia,useCallback:ho,useContext:ia,useEffect:ao,useImperativeHandle:lo,useLayoutEffect:oo,useMemo:fo,useReducer:Ja,useRef:eo,useState:function(){return Ja(Xa)},useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Ja(Xa),i=n[0],r=n[1];return ao((function(){var n=Fa.suspense;Fa.suspense=void 0===e?null:e;try{r(t)}finally{Fa.suspense=n}}),[t,e]),i},useTransition:function(t){var e=Ja(Xa),n=e[0];return e=e[1],[ho(po.bind(null,e,t),[e,t]),n]}},xo=null,_o=null,wo=!1;function So(t,e){var n=El(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Eo(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Mo(t){if(wo){var e=_o;if(e){var n=e;if(!Eo(t,e)){if(!(e=_n(n.nextSibling))||!Eo(t,e))return t.effectTag=-1025&t.effectTag|2,wo=!1,void(xo=t);So(xo,n)}xo=t,_o=_n(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,wo=!1,xo=t}}function Co(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;xo=t}function To(t){if(t!==xo)return!1;if(!wo)return Co(t),wo=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!yn(e,t.memoizedProps))for(e=_o;e;)So(t,e),e=_n(e.nextSibling);if(Co(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){_o=_n(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}_o=null}}else _o=xo?_n(t.stateNode.nextSibling):null;return!0}function ko(){_o=xo=null,wo=!1}var Po=X.ReactCurrentOwner,Ao=!1;function Oo(t,e,n,i){e.child=null===t?Ma(e,null,n,i):Ea(e,t.child,n,i)}function Lo(t,e,n,i,r){n=n.render;var a=e.ref;return na(e,r),i=$a(t,e,n,i,a,r),null===t||Ao?(e.effectTag|=1,Oo(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Qo(t,e,r))}function Ro(t,e,n,i,r,a){if(null===t){var o=n.type;return"function"!=typeof o||Ml(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Tl(n.type,null,i,null,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Io(t,e,o,i,r,a))}return o=t.child,r<a&&(r=o.memoizedProps,(n=null!==(n=n.compare)?n:Fi)(r,i)&&t.ref===e.ref)?Qo(t,e,a):(e.effectTag|=1,(t=Cl(o,i)).ref=e.ref,t.return=e,e.child=t)}function Io(t,e,n,i,r,a){return null!==t&&Fi(t.memoizedProps,i)&&t.ref===e.ref&&(Ao=!1,r<a)?(e.expirationTime=t.expirationTime,Qo(t,e,a)):Do(t,e,n,i,a)}function No(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Do(t,e,n,i,r){var a=mr(n)?fr:hr.current;return a=pr(e,a),na(e,r),n=$a(t,e,n,i,a,r),null===t||Ao?(e.effectTag|=1,Oo(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Qo(t,e,r))}function zo(t,e,n,i,r){if(mr(n)){var a=!0;br(e)}else a=!1;if(na(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),va(e,n,i),ba(e,n,i,r),i=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=n.contextType;"object"==typeof u&&null!==u?u=ia(u):u=pr(e,u=mr(n)?fr:hr.current);var c=n.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==i||l!==u)&&ya(e,o,i,u),ra=!1;var d=e.memoizedState;o.state=d,ca(e,i,o,r),l=e.memoizedState,s!==i||d!==l||dr.current||ra?("function"==typeof c&&(pa(e,n,c,i),l=e.memoizedState),(s=ra||ga(e,n,s,i,d,l,u))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.effectTag|=4)):("function"==typeof o.componentDidMount&&(e.effectTag|=4),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=s):("function"==typeof o.componentDidMount&&(e.effectTag|=4),i=!1)}else o=e.stateNode,oa(t,e),s=e.memoizedProps,o.props=e.type===e.elementType?s:Qr(e.type,s),l=o.context,"object"==typeof(u=n.contextType)&&null!==u?u=ia(u):u=pr(e,u=mr(n)?fr:hr.current),(h="function"==typeof(c=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==i||l!==u)&&ya(e,o,i,u),ra=!1,l=e.memoizedState,o.state=l,ca(e,i,o,r),d=e.memoizedState,s!==i||l!==d||dr.current||ra?("function"==typeof c&&(pa(e,n,c,i),d=e.memoizedState),(c=ra||ga(e,n,s,i,l,d,u))?(h||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,d,u),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,d,u)),"function"==typeof o.componentDidUpdate&&(e.effectTag|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=i,e.memoizedState=d),o.props=i,o.state=d,o.context=u,i=c):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),i=!1);return Bo(t,e,n,i,a,r)}function Bo(t,e,n,i,r,a){No(t,e);var o=0!=(64&e.effectTag);if(!i&&!o)return r&&xr(e,n,!1),Qo(t,e,a);i=e.stateNode,Po.current=e;var s=o&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return e.effectTag|=1,null!==t&&o?(e.child=Ea(e,t.child,null,a),e.child=Ea(e,null,s,a)):Oo(t,e,s,a),e.memoizedState=i.state,r&&xr(e,n,!0),e.child}function Fo(t){var e=t.stateNode;e.pendingContext?vr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&vr(0,e.context,!1),Oa(t,e.containerInfo)}var Vo,jo,Uo,Ho={dehydrated:null,retryTime:0};function Go(t,e,n){var i,r=e.mode,a=e.pendingProps,o=Na.current,s=!1;if((i=0!=(64&e.effectTag))||(i=0!=(2&o)&&(null===t||null!==t.memoizedState)),i?(s=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),ur(Na,1&o),null===t){if(void 0!==a.fallback&&Mo(e),s){if(s=a.fallback,(a=kl(null,r,0,null)).return=e,0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(n=kl(s,r,n,null)).return=e,a.sibling=n,e.memoizedState=Ho,e.child=a,n}return r=a.children,e.memoizedState=null,e.child=Ma(e,null,r,n)}if(null!==t.memoizedState){if(r=(t=t.child).sibling,s){if(a=a.fallback,(n=Cl(t,t.pendingProps)).return=e,0==(2&e.mode)&&(s=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(r=Cl(r,a)).return=e,n.sibling=r,n.childExpirationTime=0,e.memoizedState=Ho,e.child=n,r}return n=Ea(e,t.child,a.children,n),e.memoizedState=null,e.child=n}if(t=t.child,s){if(s=a.fallback,(a=kl(null,r,0,null)).return=e,a.child=t,null!==t&&(t.return=a),0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(n=kl(s,r,n,null)).return=e,a.sibling=n,n.effectTag|=2,a.childExpirationTime=0,e.memoizedState=Ho,e.child=a,n}return e.memoizedState=null,e.child=Ea(e,t,a.children,n)}function Wo(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),ea(t.return,e)}function qo(t,e,n,i,r,a){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailExpiration:0,tailMode:r,lastEffect:a}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailExpiration=0,o.tailMode=r,o.lastEffect=a)}function $o(t,e,n){var i=e.pendingProps,r=i.revealOrder,a=i.tail;if(Oo(t,e,i.children,n),0!=(2&(i=Na.current)))i=1&i|2,e.effectTag|=64;else{if(null!==t&&0!=(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Wo(t,n);else if(19===t.tag)Wo(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ur(Na,i),0==(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===Da(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),qo(e,!1,r,n,a,e.lastEffect);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Da(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}qo(e,!0,n,null,a,e.lastEffect);break;case"together":qo(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Qo(t,e,n){null!==t&&(e.dependencies=t.dependencies);var i=e.expirationTime;if(0!==i&&ol(i),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Cl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Cl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Yo(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Xo(t,e,n){var i=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return mr(e.type)&&gr(),null;case 3:return La(),lr(dr),lr(hr),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!To(e)||(e.effectTag|=4),null;case 5:Ia(e),n=Aa(Pa.current);var a=e.type;if(null!==t&&null!=e.stateNode)jo(t,e,a,i,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!i){if(null===e.stateNode)throw Error(o(166));return null}if(t=Aa(Ta.current),To(e)){i=e.stateNode,a=e.type;var s=e.memoizedProps;switch(i[En]=e,i[Mn]=s,a){case"iframe":case"object":case"embed":$e("load",i);break;case"video":case"audio":for(t=0;t<Xt.length;t++)$e(Xt[t],i);break;case"source":$e("error",i);break;case"img":case"image":case"link":$e("error",i),$e("load",i);break;case"form":$e("reset",i),$e("submit",i);break;case"details":$e("toggle",i);break;case"input":St(i,s),$e("invalid",i),ln(n,"onChange");break;case"select":i._wrapperState={wasMultiple:!!s.multiple},$e("invalid",i),ln(n,"onChange");break;case"textarea":Ot(i,s),$e("invalid",i),ln(n,"onChange")}for(var l in an(a,s),t=null,s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"==typeof u?i.textContent!==u&&(t=["children",u]):"number"==typeof u&&i.textContent!==""+u&&(t=["children",""+u]):E.hasOwnProperty(l)&&null!=u&&ln(n,l)}switch(a){case"input":xt(i),Ct(i,s,!0);break;case"textarea":xt(i),Rt(i);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(i.onclick=un)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,t===sn&&(t=Dt(a)),t===sn?"script"===a?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof i.is?t=l.createElement(a,{is:i.is}):(t=l.createElement(a),"select"===a&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,a),t[En]=e,t[Mn]=i,Vo(t,e),e.stateNode=t,l=on(a,i),a){case"iframe":case"object":case"embed":$e("load",t),u=i;break;case"video":case"audio":for(u=0;u<Xt.length;u++)$e(Xt[u],t);u=i;break;case"source":$e("error",t),u=i;break;case"img":case"image":case"link":$e("error",t),$e("load",t),u=i;break;case"form":$e("reset",t),$e("submit",t),u=i;break;case"details":$e("toggle",t),u=i;break;case"input":St(t,i),u=wt(t,i),$e("invalid",t),ln(n,"onChange");break;case"option":u=kt(t,i);break;case"select":t._wrapperState={wasMultiple:!!i.multiple},u=r({},i,{value:void 0}),$e("invalid",t),ln(n,"onChange");break;case"textarea":Ot(t,i),u=At(t,i),$e("invalid",t),ln(n,"onChange");break;default:u=i}an(a,u);var c=u;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?nn(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&Ft(t,h):"children"===s?"string"==typeof h?("textarea"!==a||""!==h)&&Vt(t,h):"number"==typeof h&&Vt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?null!=h&&ln(n,s):null!=h&&Z(t,s,h,l))}switch(a){case"input":xt(t),Ct(t,i,!1);break;case"textarea":xt(t),Rt(t);break;case"option":null!=i.value&&t.setAttribute("value",""+yt(i.value));break;case"select":t.multiple=!!i.multiple,null!=(n=i.value)?Pt(t,!!i.multiple,n,!1):null!=i.defaultValue&&Pt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof u.onClick&&(t.onclick=un)}vn(a,i)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)Uo(0,e,t.memoizedProps,i);else{if("string"!=typeof i&&null===e.stateNode)throw Error(o(166));n=Aa(Pa.current),Aa(Ta.current),To(e)?(n=e.stateNode,i=e.memoizedProps,n[En]=e,n.nodeValue!==i&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[En]=e,e.stateNode=n)}return null;case 13:return lr(Na),i=e.memoizedState,0!=(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==i,i=!1,null===t?void 0!==e.memoizedProps.fallback&&To(e):(i=null!==(a=t.memoizedState),n||null===a||null!==(a=t.child.sibling)&&(null!==(s=e.firstEffect)?(e.firstEffect=a,a.nextEffect=s):(e.firstEffect=e.lastEffect=a,a.nextEffect=null),a.effectTag=8)),n&&!i&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Na.current)?Ts===xs&&(Ts=_s):(Ts!==xs&&Ts!==_s||(Ts=ws),0!==Ls&&null!==Es&&(Rl(Es,Cs),Il(Es,Ls)))),(n||i)&&(e.effectTag|=4),null);case 4:return La(),null;case 10:return ta(e),null;case 17:return mr(e.type)&&gr(),null;case 19:if(lr(Na),null===(i=e.memoizedState))return null;if(a=0!=(64&e.effectTag),null===(s=i.rendering)){if(a)Yo(i,!1);else if(Ts!==xs||null!==t&&0!=(64&t.effectTag))for(s=e.child;null!==s;){if(null!==(t=Da(s))){for(e.effectTag|=64,Yo(i,!1),null!==(a=t.updateQueue)&&(e.updateQueue=a,e.effectTag|=4),null===i.lastEffect&&(e.firstEffect=null),e.lastEffect=i.lastEffect,i=e.child;null!==i;)s=n,(a=i).effectTag&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(t=a.alternate)?(a.childExpirationTime=0,a.expirationTime=s,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null):(a.childExpirationTime=t.childExpirationTime,a.expirationTime=t.expirationTime,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),i=i.sibling;return ur(Na,1&Na.current|2),e.child}s=s.sibling}}else{if(!a)if(null!==(t=Da(s))){if(e.effectTag|=64,a=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),Yo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate)return null!==(e=e.lastEffect=i.lastEffect)&&(e.nextEffect=null),null}else 2*Fr()-i.renderingStartTime>i.tailExpiration&&1<n&&(e.effectTag|=64,a=!0,Yo(i,!1),e.expirationTime=e.childExpirationTime=n-1);i.isBackwards?(s.sibling=e.child,e.child=s):(null!==(n=i.last)?n.sibling=s:e.child=s,i.last=s)}return null!==i.tail?(0===i.tailExpiration&&(i.tailExpiration=Fr()+500),n=i.tail,i.rendering=n,i.tail=n.sibling,i.lastEffect=e.lastEffect,i.renderingStartTime=Fr(),n.sibling=null,e=Na.current,ur(Na,a?1&e|2:1&e),n):null}throw Error(o(156,e.tag))}function Zo(t){switch(t.tag){case 1:mr(t.type)&&gr();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(La(),lr(dr),lr(hr),0!=(64&(e=t.effectTag)))throw Error(o(285));return t.effectTag=-4097&e|64,t;case 5:return Ia(t),null;case 13:return lr(Na),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return lr(Na),null;case 4:return La(),null;case 10:return ta(t),null;default:return null}}function Jo(t,e){return{value:t,source:e,stack:vt(e)}}Vo=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},jo=function(t,e,n,i,a){var o=t.memoizedProps;if(o!==i){var s,l,u=e.stateNode;switch(Aa(Ta.current),t=null,n){case"input":o=wt(u,o),i=wt(u,i),t=[];break;case"option":o=kt(u,o),i=kt(u,i),t=[];break;case"select":o=r({},o,{value:void 0}),i=r({},i,{value:void 0}),t=[];break;case"textarea":o=At(u,o),i=At(u,i),t=[];break;default:"function"!=typeof o.onClick&&"function"==typeof i.onClick&&(u.onclick=un)}for(s in an(n,i),n=null,o)if(!i.hasOwnProperty(s)&&o.hasOwnProperty(s)&&null!=o[s])if("style"===s)for(l in u=o[s])u.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?t||(t=[]):(t=t||[]).push(s,null));for(s in i){var c=i[s];if(u=null!=o?o[s]:void 0,i.hasOwnProperty(s)&&c!==u&&(null!=c||null!=u))if("style"===s)if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(t||(t=[]),t.push(s,n)),n=c;else"dangerouslySetInnerHTML"===s?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(t=t||[]).push(s,c)):"children"===s?u===c||"string"!=typeof c&&"number"!=typeof c||(t=t||[]).push(s,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(E.hasOwnProperty(s)?(null!=c&&ln(a,s),t||u===c||(t=[])):(t=t||[]).push(s,c))}n&&(t=t||[]).push("style",n),a=t,(e.updateQueue=a)&&(e.effectTag|=4)}},Uo=function(t,e,n,i){n!==i&&(e.effectTag|=4)};var Ko="function"==typeof WeakSet?WeakSet:Set;function ts(t,e){var n=e.source,i=e.stack;null===i&&null!==n&&(i=vt(n)),null!==n&&gt(n.type),e=e.value,null!==t&&1===t.tag&&gt(t.type);try{console.error(e)}catch(t){setTimeout((function(){throw t}))}}function es(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){yl(t,e)}else e.current=null}function ns(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,i=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Qr(e.type,n),i),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(o(163))}function is(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.destroy;n.destroy=void 0,void 0!==i&&i()}n=n.next}while(n!==e)}}function rs(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function as(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void rs(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var i=n.elementType===n.type?e.memoizedProps:Qr(n.type,e.memoizedProps);t.componentDidUpdate(i,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&ha(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}ha(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&vn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&De(n)))));case 19:case 17:case 20:case 21:return}throw Error(o(163))}function os(t,e,n){switch("function"==typeof wl&&wl(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var i=t.next;Ur(97<n?97:n,(function(){var t=i;do{var n=t.destroy;if(void 0!==n){var r=e;try{n()}catch(t){yl(r,t)}}t=t.next}while(t!==i)}))}break;case 1:es(e),"function"==typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){yl(t,e)}}(e,n);break;case 5:es(e);break;case 4:cs(t,e,n)}}function ss(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&ss(e)}function ls(t){return 5===t.tag||3===t.tag||4===t.tag}function us(t){t:{for(var e=t.return;null!==e;){if(ls(e)){var n=e;break t}e=e.return}throw Error(o(160))}switch(e=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:e=e.containerInfo,i=!0;break;default:throw Error(o(161))}16&n.effectTag&&(Vt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ls(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}i?function t(e,n,i){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,n?8===i.nodeType?i.parentNode.insertBefore(e,n):i.insertBefore(e,n):(8===i.nodeType?(n=i.parentNode).insertBefore(e,i):(n=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==n.onclick||(n.onclick=un));else if(4!==r&&null!==(e=e.child))for(t(e,n,i),e=e.sibling;null!==e;)t(e,n,i),e=e.sibling}(t,n,e):function t(e,n,i){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,n?i.insertBefore(e,n):i.appendChild(e);else if(4!==r&&null!==(e=e.child))for(t(e,n,i),e=e.sibling;null!==e;)t(e,n,i),e=e.sibling}(t,n,e)}function cs(t,e,n){for(var i,r,a=e,s=!1;;){if(!s){s=a.return;t:for(;;){if(null===s)throw Error(o(160));switch(i=s.stateNode,s.tag){case 5:r=!1;break t;case 3:case 4:i=i.containerInfo,r=!0;break t}s=s.return}s=!0}if(5===a.tag||6===a.tag){t:for(var l=t,u=a,c=n,h=u;;)if(os(l,h,c),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===u)break t;for(;null===h.sibling;){if(null===h.return||h.return===u)break t;h=h.return}h.sibling.return=h.return,h=h.sibling}r?(l=i,u=a.stateNode,8===l.nodeType?l.parentNode.removeChild(u):l.removeChild(u)):i.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){i=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(os(t,a,n),null!==a.child){a.child.return=a,a=a.child;continue}if(a===e)break;for(;null===a.sibling;){if(null===a.return||a.return===e)return;4===(a=a.return).tag&&(s=!1)}a.sibling.return=a.return,a=a.sibling}}function hs(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void is(3,e);case 1:return;case 5:var n=e.stateNode;if(null!=n){var i=e.memoizedProps,r=null!==t?t.memoizedProps:i;t=e.type;var a=e.updateQueue;if(e.updateQueue=null,null!==a){for(n[Mn]=i,"input"===t&&"radio"===i.type&&null!=i.name&&Et(n,i),on(t,r),e=on(t,i),r=0;r<a.length;r+=2){var s=a[r],l=a[r+1];"style"===s?nn(n,l):"dangerouslySetInnerHTML"===s?Ft(n,l):"children"===s?Vt(n,l):Z(n,s,l,e)}switch(t){case"input":Mt(n,i);break;case"textarea":Lt(n,i);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,null!=(t=i.value)?Pt(n,!!i.multiple,t,!1):e!==!!i.multiple&&(null!=i.defaultValue?Pt(n,!!i.multiple,i.defaultValue,!0):Pt(n,!!i.multiple,i.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(o(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,De(e.containerInfo)));case 12:return;case 13:if(n=e,null===e.memoizedState?i=!1:(i=!0,n=e.child,Is=Fr()),null!==n)t:for(t=n;;){if(5===t.tag)a=t.stateNode,i?"function"==typeof(a=a.style).setProperty?a.setProperty("display","none","important"):a.display="none":(a=t.stateNode,r=null!=(r=t.memoizedProps.style)&&r.hasOwnProperty("display")?r.display:null,a.style.display=en("display",r));else if(6===t.tag)t.stateNode.nodeValue=i?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(a=t.child.sibling).return=t,t=a;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void ds(e);case 19:return void ds(e);case 17:return}throw Error(o(163))}function ds(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ko),e.forEach((function(e){var i=xl.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}var fs="function"==typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=sa(n,null)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Ds||(Ds=!0,zs=i),ts(t,e)},n}function ms(t,e,n){(n=sa(n,null)).tag=3;var i=t.type.getDerivedStateFromError;if("function"==typeof i){var r=e.value;n.payload=function(){return ts(t,e),i(r)}}var a=t.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){"function"!=typeof i&&(null===Bs?Bs=new Set([this]):Bs.add(this),ts(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var gs,vs=Math.ceil,ys=X.ReactCurrentDispatcher,bs=X.ReactCurrentOwner,xs=0,_s=3,ws=4,Ss=0,Es=null,Ms=null,Cs=0,Ts=xs,ks=null,Ps=1073741823,As=1073741823,Os=null,Ls=0,Rs=!1,Is=0,Ns=null,Ds=!1,zs=null,Bs=null,Fs=!1,Vs=null,js=90,Us=null,Hs=0,Gs=null,Ws=0;function qs(){return 0!=(48&Ss)?1073741821-(Fr()/10|0):0!==Ws?Ws:Ws=1073741821-(Fr()/10|0)}function $s(t,e,n){if(0==(2&(e=e.mode)))return 1073741823;var i=Vr();if(0==(4&e))return 99===i?1073741823:1073741822;if(0!=(16&Ss))return Cs;if(null!==n)t=$r(t,0|n.timeoutMs||5e3,250);else switch(i){case 99:t=1073741823;break;case 98:t=$r(t,150,100);break;case 97:case 96:t=$r(t,5e3,250);break;case 95:t=2;break;default:throw Error(o(326))}return null!==Es&&t===Cs&&--t,t}function Qs(t,e){if(50<Hs)throw Hs=0,Gs=null,Error(o(185));if(null!==(t=Ys(t,e))){var n=Vr();1073741823===e?0!=(8&Ss)&&0==(48&Ss)?Ks(t):(Zs(t),0===Ss&&Wr()):Zs(t),0==(4&Ss)||98!==n&&99!==n||(null===Us?Us=new Map([[t,e]]):(void 0===(n=Us.get(t))||n>e)&&Us.set(t,e))}}function Ys(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var i=t.return,r=null;if(null===i&&3===t.tag)r=t.stateNode;else for(;null!==i;){if(n=i.alternate,i.childExpirationTime<e&&(i.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===i.return&&3===i.tag){r=i.stateNode;break}i=i.return}return null!==r&&(Es===r&&(ol(e),Ts===ws&&Rl(r,Cs)),Il(r,e)),r}function Xs(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Ll(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function Zs(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Gr(Ks.bind(null,t));else{var e=Xs(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var i=qs();if(1073741823===e?i=99:1===e||2===e?i=95:i=0>=(i=10*(1073741821-e)-10*(1073741821-i))?99:250>=i?98:5250>=i?97:95,null!==n){var r=t.callbackPriority;if(t.callbackExpirationTime===e&&r>=i)return;n!==Lr&&Sr(n)}t.callbackExpirationTime=e,t.callbackPriority=i,e=1073741823===e?Gr(Ks.bind(null,t)):Hr(i,Js.bind(null,t),{timeout:10*(1073741821-e)-Fr()}),t.callbackNode=e}}}function Js(t,e){if(Ws=0,e)return Nl(t,e=qs()),Zs(t),null;var n=Xs(t);if(0!==n){if(e=t.callbackNode,0!=(48&Ss))throw Error(o(327));if(ml(),t===Es&&n===Cs||nl(t,n),null!==Ms){var i=Ss;Ss|=16;for(var r=rl();;)try{ll();break}catch(e){il(t,e)}if(Kr(),Ss=i,ys.current=r,1===Ts)throw e=ks,nl(t,n),Rl(t,n),Zs(t),e;if(null===Ms)switch(r=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,i=Ts,Es=null,i){case xs:case 1:throw Error(o(345));case 2:Nl(t,2<n?2:n);break;case _s:if(Rl(t,n),n===(i=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=hl(r)),1073741823===Ps&&10<(r=Is+500-Fr())){if(Rs){var a=t.lastPingedTime;if(0===a||a>=n){t.lastPingedTime=n,nl(t,n);break}}if(0!==(a=Xs(t))&&a!==n)break;if(0!==i&&i!==n){t.lastPingedTime=i;break}t.timeoutHandle=bn(dl.bind(null,t),r);break}dl(t);break;case ws:if(Rl(t,n),n===(i=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=hl(r)),Rs&&(0===(r=t.lastPingedTime)||r>=n)){t.lastPingedTime=n,nl(t,n);break}if(0!==(r=Xs(t))&&r!==n)break;if(0!==i&&i!==n){t.lastPingedTime=i;break}if(1073741823!==As?i=10*(1073741821-As)-Fr():1073741823===Ps?i=0:(i=10*(1073741821-Ps)-5e3,0>(i=(r=Fr())-i)&&(i=0),(n=10*(1073741821-n)-r)<(i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*vs(i/1960))-i)&&(i=n)),10<i){t.timeoutHandle=bn(dl.bind(null,t),i);break}dl(t);break;case 5:if(1073741823!==Ps&&null!==Os){a=Ps;var s=Os;if(0>=(i=0|s.busyMinDurationMs)?i=0:(r=0|s.busyDelayMs,i=(a=Fr()-(10*(1073741821-a)-(0|s.timeoutMs||5e3)))<=r?0:r+i-a),10<i){Rl(t,n),t.timeoutHandle=bn(dl.bind(null,t),i);break}}dl(t);break;default:throw Error(o(329))}if(Zs(t),t.callbackNode===e)return Js.bind(null,t)}}return null}function Ks(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,0!=(48&Ss))throw Error(o(327));if(ml(),t===Es&&e===Cs||nl(t,e),null!==Ms){var n=Ss;Ss|=16;for(var i=rl();;)try{sl();break}catch(e){il(t,e)}if(Kr(),Ss=n,ys.current=i,1===Ts)throw n=ks,nl(t,e),Rl(t,e),Zs(t),n;if(null!==Ms)throw Error(o(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Es=null,dl(t),Zs(t)}return null}function tl(t,e){var n=Ss;Ss|=1;try{return t(e)}finally{0===(Ss=n)&&Wr()}}function el(t,e){var n=Ss;Ss&=-2,Ss|=8;try{return t(e)}finally{0===(Ss=n)&&Wr()}}function nl(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,xn(n)),null!==Ms)for(n=Ms.return;null!==n;){var i=n;switch(i.tag){case 1:null!=(i=i.type.childContextTypes)&&gr();break;case 3:La(),lr(dr),lr(hr);break;case 5:Ia(i);break;case 4:La();break;case 13:case 19:lr(Na);break;case 10:ta(i)}n=n.return}Es=t,Ms=Cl(t.current,null),Cs=e,Ts=xs,ks=null,As=Ps=1073741823,Os=null,Ls=0,Rs=!1}function il(t,e){for(;;){try{if(Kr(),Ba.current=go,Ga)for(var n=ja.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}if(Va=0,Ha=Ua=ja=null,Ga=!1,null===Ms||null===Ms.return)return Ts=1,ks=e,Ms=null;t:{var r=t,a=Ms.return,o=Ms,s=e;if(e=Cs,o.effectTag|=2048,o.firstEffect=o.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var l=s;if(0==(2&o.mode)){var u=o.alternate;u?(o.updateQueue=u.updateQueue,o.memoizedState=u.memoizedState,o.expirationTime=u.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var c=0!=(1&Na.current),h=a;do{var d;if(d=13===h.tag){var f=h.memoizedState;if(null!==f)d=null!==f.dehydrated;else{var p=h.memoizedProps;d=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!c)}}if(d){var m=h.updateQueue;if(null===m){var g=new Set;g.add(l),h.updateQueue=g}else m.add(l);if(0==(2&h.mode)){if(h.effectTag|=64,o.effectTag&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var v=sa(1073741823,null);v.tag=2,la(o,v)}o.expirationTime=1073741823;break t}s=void 0,o=e;var y=r.pingCache;if(null===y?(y=r.pingCache=new fs,s=new Set,y.set(l,s)):void 0===(s=y.get(l))&&(s=new Set,y.set(l,s)),!s.has(o)){s.add(o);var b=bl.bind(null,r,l,o);l.then(b,b)}h.effectTag|=4096,h.expirationTime=e;break t}h=h.return}while(null!==h);s=Error((gt(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+vt(o))}5!==Ts&&(Ts=2),s=Jo(s,o),h=a;do{switch(h.tag){case 3:l=s,h.effectTag|=4096,h.expirationTime=e,ua(h,ps(h,l,e));break t;case 1:l=s;var x=h.type,_=h.stateNode;if(0==(64&h.effectTag)&&("function"==typeof x.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===Bs||!Bs.has(_)))){h.effectTag|=4096,h.expirationTime=e,ua(h,ms(h,l,e));break t}}h=h.return}while(null!==h)}Ms=cl(Ms)}catch(t){e=t;continue}break}}function rl(){var t=ys.current;return ys.current=go,null===t?go:t}function al(t,e){t<Ps&&2<t&&(Ps=t),null!==e&&t<As&&2<t&&(As=t,Os=e)}function ol(t){t>Ls&&(Ls=t)}function sl(){for(;null!==Ms;)Ms=ul(Ms)}function ll(){for(;null!==Ms&&!Rr();)Ms=ul(Ms)}function ul(t){var e=gs(t.alternate,t,Cs);return t.memoizedProps=t.pendingProps,null===e&&(e=cl(t)),bs.current=null,e}function cl(t){Ms=t;do{var e=Ms.alternate;if(t=Ms.return,0==(2048&Ms.effectTag)){if(e=Xo(e,Ms,Cs),1===Cs||1!==Ms.childExpirationTime){for(var n=0,i=Ms.child;null!==i;){var r=i.expirationTime,a=i.childExpirationTime;r>n&&(n=r),a>n&&(n=a),i=i.sibling}Ms.childExpirationTime=n}if(null!==e)return e;null!==t&&0==(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Ms.firstEffect),null!==Ms.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Ms.firstEffect),t.lastEffect=Ms.lastEffect),1<Ms.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Ms:t.firstEffect=Ms,t.lastEffect=Ms))}else{if(null!==(e=Zo(Ms)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Ms.sibling))return e;Ms=t}while(null!==Ms);return Ts===xs&&(Ts=5),null}function hl(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function dl(t){var e=Vr();return Ur(99,fl.bind(null,t,e)),null}function fl(t,e){do{ml()}while(null!==Vs);if(0!=(48&Ss))throw Error(o(327));var n=t.finishedWork,i=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var r=hl(n);if(t.firstPendingTime=r,i<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:i<=t.firstSuspendedTime&&(t.firstSuspendedTime=i-1),i<=t.lastPingedTime&&(t.lastPingedTime=0),i<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Es&&(Ms=Es=null,Cs=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){var a=Ss;Ss|=32,bs.current=null,mn=qe;var s=fn();if(pn(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else t:{var u=(l=(l=s.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,h=u.focusNode;u=u.focusOffset;try{l.nodeType,h.nodeType}catch(t){l=null;break t}var d=0,f=-1,p=-1,m=0,g=0,v=s,y=null;e:for(;;){for(var b;v!==l||0!==c&&3!==v.nodeType||(f=d+c),v!==h||0!==u&&3!==v.nodeType||(p=d+u),3===v.nodeType&&(d+=v.nodeValue.length),null!==(b=v.firstChild);)y=v,v=b;for(;;){if(v===s)break e;if(y===l&&++m===c&&(f=d),y===h&&++g===u&&(p=d),null!==(b=v.nextSibling))break;y=(v=y).parentNode}v=b}l=-1===f||-1===p?null:{start:f,end:p}}else l=null}l=l||{start:0,end:0}}else l=null;gn={activeElementDetached:null,focusedElem:s,selectionRange:l},qe=!1,Ns=r;do{try{pl()}catch(t){if(null===Ns)throw Error(o(330));yl(Ns,t),Ns=Ns.nextEffect}}while(null!==Ns);Ns=r;do{try{for(s=t,l=e;null!==Ns;){var x=Ns.effectTag;if(16&x&&Vt(Ns.stateNode,""),128&x){var _=Ns.alternate;if(null!==_){var w=_.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&x){case 2:us(Ns),Ns.effectTag&=-3;break;case 6:us(Ns),Ns.effectTag&=-3,hs(Ns.alternate,Ns);break;case 1024:Ns.effectTag&=-1025;break;case 1028:Ns.effectTag&=-1025,hs(Ns.alternate,Ns);break;case 4:hs(Ns.alternate,Ns);break;case 8:cs(s,c=Ns,l),ss(c)}Ns=Ns.nextEffect}}catch(t){if(null===Ns)throw Error(o(330));yl(Ns,t),Ns=Ns.nextEffect}}while(null!==Ns);if(w=gn,_=fn(),x=w.focusedElem,l=w.selectionRange,_!==x&&x&&x.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(x.ownerDocument.documentElement,x)){null!==l&&pn(x)&&(_=l.start,void 0===(w=l.end)&&(w=_),"selectionStart"in x?(x.selectionStart=_,x.selectionEnd=Math.min(w,x.value.length)):(w=(_=x.ownerDocument||document)&&_.defaultView||window).getSelection&&(w=w.getSelection(),c=x.textContent.length,s=Math.min(l.start,c),l=void 0===l.end?s:Math.min(l.end,c),!w.extend&&s>l&&(c=l,l=s,s=c),c=dn(x,s),h=dn(x,l),c&&h&&(1!==w.rangeCount||w.anchorNode!==c.node||w.anchorOffset!==c.offset||w.focusNode!==h.node||w.focusOffset!==h.offset)&&((_=_.createRange()).setStart(c.node,c.offset),w.removeAllRanges(),s>l?(w.addRange(_),w.extend(h.node,h.offset)):(_.setEnd(h.node,h.offset),w.addRange(_))))),_=[];for(w=x;w=w.parentNode;)1===w.nodeType&&_.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof x.focus&&x.focus(),x=0;x<_.length;x++)(w=_[x]).element.scrollLeft=w.left,w.element.scrollTop=w.top}qe=!!mn,gn=mn=null,t.current=n,Ns=r;do{try{for(x=t;null!==Ns;){var S=Ns.effectTag;if(36&S&&as(x,Ns.alternate,Ns),128&S){_=void 0;var E=Ns.ref;if(null!==E){var M=Ns.stateNode;switch(Ns.tag){case 5:_=M;break;default:_=M}"function"==typeof E?E(_):E.current=_}}Ns=Ns.nextEffect}}catch(t){if(null===Ns)throw Error(o(330));yl(Ns,t),Ns=Ns.nextEffect}}while(null!==Ns);Ns=null,Ir(),Ss=a}else t.current=n;if(Fs)Fs=!1,Vs=t,js=e;else for(Ns=r;null!==Ns;)e=Ns.nextEffect,Ns.nextEffect=null,Ns=e;if(0===(e=t.firstPendingTime)&&(Bs=null),1073741823===e?t===Gs?Hs++:(Hs=0,Gs=t):Hs=0,"function"==typeof _l&&_l(n.stateNode,i),Zs(t),Ds)throw Ds=!1,t=zs,zs=null,t;return 0!=(8&Ss)||Wr(),null}function pl(){for(;null!==Ns;){var t=Ns.effectTag;0!=(256&t)&&ns(Ns.alternate,Ns),0==(512&t)||Fs||(Fs=!0,Hr(97,(function(){return ml(),null}))),Ns=Ns.nextEffect}}function ml(){if(90!==js){var t=97<js?97:js;return js=90,Ur(t,gl)}}function gl(){if(null===Vs)return!1;var t=Vs;if(Vs=null,0!=(48&Ss))throw Error(o(331));var e=Ss;for(Ss|=32,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:is(5,n),rs(5,n)}}catch(e){if(null===t)throw Error(o(330));yl(t,e)}n=t.nextEffect,t.nextEffect=null,t=n}return Ss=e,Wr(),!0}function vl(t,e,n){la(t,e=ps(t,e=Jo(n,e),1073741823)),null!==(t=Ys(t,1073741823))&&Zs(t)}function yl(t,e){if(3===t.tag)vl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){vl(n,t,e);break}if(1===n.tag){var i=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Bs||!Bs.has(i))){la(n,t=ms(n,t=Jo(e,t),1073741823)),null!==(n=Ys(n,1073741823))&&Zs(n);break}}n=n.return}}function bl(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),Es===t&&Cs===n?Ts===ws||Ts===_s&&1073741823===Ps&&Fr()-Is<500?nl(t,Cs):Rs=!0:Ll(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,Zs(t)))}function xl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=$s(e=qs(),t,null)),null!==(t=Ys(t,e))&&Zs(t)}gs=function(t,e,n){var i=e.expirationTime;if(null!==t){var r=e.pendingProps;if(t.memoizedProps!==r||dr.current)Ao=!0;else{if(i<n){switch(Ao=!1,e.tag){case 3:Fo(e),ko();break;case 5:if(Ra(e),4&e.mode&&1!==n&&r.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:mr(e.type)&&br(e);break;case 4:Oa(e,e.stateNode.containerInfo);break;case 10:i=e.memoizedProps.value,r=e.type._context,ur(Yr,r._currentValue),r._currentValue=i;break;case 13:if(null!==e.memoizedState)return 0!==(i=e.child.childExpirationTime)&&i>=n?Go(t,e,n):(ur(Na,1&Na.current),null!==(e=Qo(t,e,n))?e.sibling:null);ur(Na,1&Na.current);break;case 19:if(i=e.childExpirationTime>=n,0!=(64&t.effectTag)){if(i)return $o(t,e,n);e.effectTag|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null),ur(Na,Na.current),!i)return null}return Qo(t,e,n)}Ao=!1}}else Ao=!1;switch(e.expirationTime=0,e.tag){case 2:if(i=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,r=pr(e,hr.current),na(e,n),r=$a(null,e,i,t,r,n),e.effectTag|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mr(i)){var a=!0;br(e)}else a=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,aa(e);var s=i.getDerivedStateFromProps;"function"==typeof s&&pa(e,i,s,t),r.updater=ma,e.stateNode=r,r._reactInternalFiber=e,ba(e,i,t,n),e=Bo(null,e,i,!0,a,n)}else e.tag=0,Oo(null,e,r,n),e=e.child;return e;case 16:t:{if(r=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(r),1!==r._status)throw r._result;switch(r=r._result,e.type=r,a=e.tag=function(t){if("function"==typeof t)return Ml(t)?1:0;if(null!=t){if((t=t.$$typeof)===lt)return 11;if(t===ht)return 14}return 2}(r),t=Qr(r,t),a){case 0:e=Do(null,e,r,t,n);break t;case 1:e=zo(null,e,r,t,n);break t;case 11:e=Lo(null,e,r,t,n);break t;case 14:e=Ro(null,e,r,Qr(r.type,t),i,n);break t}throw Error(o(306,r,""))}return e;case 0:return i=e.type,r=e.pendingProps,Do(t,e,i,r=e.elementType===i?r:Qr(i,r),n);case 1:return i=e.type,r=e.pendingProps,zo(t,e,i,r=e.elementType===i?r:Qr(i,r),n);case 3:if(Fo(e),i=e.updateQueue,null===t||null===i)throw Error(o(282));if(i=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,oa(t,e),ca(e,i,null,n),(i=e.memoizedState.element)===r)ko(),e=Qo(t,e,n);else{if((r=e.stateNode.hydrate)&&(_o=_n(e.stateNode.containerInfo.firstChild),xo=e,r=wo=!0),r)for(n=Ma(e,null,i,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Oo(t,e,i,n),ko();e=e.child}return e;case 5:return Ra(e),null===t&&Mo(e),i=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,s=r.children,yn(i,r)?s=null:null!==a&&yn(i,a)&&(e.effectTag|=16),No(t,e),4&e.mode&&1!==n&&r.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Oo(t,e,s,n),e=e.child),e;case 6:return null===t&&Mo(e),null;case 13:return Go(t,e,n);case 4:return Oa(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Ea(e,null,i,n):Oo(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,Lo(t,e,i,r=e.elementType===i?r:Qr(i,r),n);case 7:return Oo(t,e,e.pendingProps,n),e.child;case 8:case 12:return Oo(t,e,e.pendingProps.children,n),e.child;case 10:t:{i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value;var l=e.type._context;if(ur(Yr,l._currentValue),l._currentValue=a,null!==s)if(l=s.value,0===(a=zi(l,a)?0:0|("function"==typeof i._calculateChangedBits?i._calculateChangedBits(l,a):1073741823))){if(s.children===r.children&&!dr.current){e=Qo(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===i&&0!=(c.observedBits&a)){1===l.tag&&((c=sa(n,null)).tag=2,la(l,c)),l.expirationTime<n&&(l.expirationTime=n),null!==(c=l.alternate)&&c.expirationTime<n&&(c.expirationTime=n),ea(l.return,n),u.expirationTime<n&&(u.expirationTime=n);break}c=c.next}}else s=10===l.tag&&l.type===e.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===e){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Oo(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=(a=e.pendingProps).children,na(e,n),i=i(r=ia(r,a.unstable_observedBits)),e.effectTag|=1,Oo(t,e,i,n),e.child;case 14:return a=Qr(r=e.type,e.pendingProps),Ro(t,e,r,a=Qr(r.type,a),i,n);case 15:return Io(t,e,e.type,e.pendingProps,i,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,mr(i)?(t=!0,br(e)):t=!1,na(e,n),va(e,i,r),ba(e,i,r,n),Bo(null,e,i,!0,t,n);case 19:return $o(t,e,n)}throw Error(o(156,e.tag))};var _l=null,wl=null;function Sl(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function El(t,e,n,i){return new Sl(t,e,n,i)}function Ml(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Cl(t,e){var n=t.alternate;return null===n?((n=El(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tl(t,e,n,i,r,a){var s=2;if(i=t,"function"==typeof t)Ml(t)&&(s=1);else if("string"==typeof t)s=5;else t:switch(t){case nt:return kl(n.children,r,a,e);case st:s=8,r|=7;break;case it:s=8,r|=1;break;case rt:return(t=El(12,n,e,8|r)).elementType=rt,t.type=rt,t.expirationTime=a,t;case ut:return(t=El(13,n,e,r)).type=ut,t.elementType=ut,t.expirationTime=a,t;case ct:return(t=El(19,n,e,r)).elementType=ct,t.expirationTime=a,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case at:s=10;break t;case ot:s=9;break t;case lt:s=11;break t;case ht:s=14;break t;case dt:s=16,i=null;break t;case ft:s=22;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=El(s,n,e,r)).elementType=t,e.type=i,e.expirationTime=a,e}function kl(t,e,n,i){return(t=El(7,t,i,e)).expirationTime=n,t}function Pl(t,e,n){return(t=El(6,t,null,e)).expirationTime=n,t}function Al(t,e,n){return(e=El(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ol(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Ll(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Rl(t,e){var n=t.firstSuspendedTime,i=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(i>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Il(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Nl(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function Dl(t,e,n,i){var r=e.current,a=qs(),s=da.suspense;a=$s(a,r,s);t:if(n){e:{if(Kt(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(o(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(mr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(o(171))}if(1===n.tag){var u=n.type;if(mr(u)){n=yr(n,u,l);break t}}n=l}else n=cr;return null===e.context?e.context=n:e.pendingContext=n,(e=sa(a,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),la(r,e),Qs(r,a),a}function zl(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Bl(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function Fl(t,e){Bl(t,e),(t=t.alternate)&&Bl(t,e)}function Vl(t,e,n){var i=new Ol(t,e,n=null!=n&&!0===n.hydrate),r=El(3,null,null,2===e?7:1===e?3:0);i.current=r,r.stateNode=i,aa(r),t[Cn]=i.current,n&&0!==e&&function(t,e){var n=Jt(e);Ce.forEach((function(t){pe(t,e,n)})),Te.forEach((function(t){pe(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=i}function jl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Ul(t,e,n,i,r){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"==typeof r){var s=r;r=function(){var t=zl(o);s.call(t)}}Dl(e,o,t,r)}else{if(a=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new Vl(t,0,e?{hydrate:!0}:void 0)}(n,i),o=a._internalRoot,"function"==typeof r){var l=r;r=function(){var t=zl(o);l.call(t)}}el((function(){Dl(e,o,t,r)}))}return zl(o)}function Hl(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function Gl(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!jl(e))throw Error(o(200));return Hl(t,e,null,n)}Vl.prototype.render=function(t){Dl(t,this._internalRoot,null,null)},Vl.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Dl(null,t,null,(function(){e[Cn]=null}))},me=function(t){if(13===t.tag){var e=$r(qs(),150,100);Qs(t,e),Fl(t,e)}},ge=function(t){13===t.tag&&(Qs(t,3),Fl(t,3))},ve=function(t){if(13===t.tag){var e=qs();Qs(t,e=$s(e,t,null)),Fl(t,e)}},k=function(t,e,n){switch(e){case"input":if(Mt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=An(i);if(!r)throw Error(o(90));_t(i),Mt(i,r)}}}break;case"textarea":Lt(t,n);break;case"select":null!=(e=n.value)&&Pt(t,!!n.multiple,e,!1)}},I=tl,N=function(t,e,n,i,r){var a=Ss;Ss|=4;try{return Ur(98,t.bind(null,e,n,i,r))}finally{0===(Ss=a)&&Wr()}},D=function(){0==(49&Ss)&&(function(){if(null!==Us){var t=Us;Us=null,t.forEach((function(t,e){Nl(e,t),Zs(e)})),Wr()}}(),ml())},z=function(t,e){var n=Ss;Ss|=2;try{return t(e)}finally{0===(Ss=n)&&Wr()}};var Wl,ql,$l={Events:[kn,Pn,An,C,S,zn,function(t){re(t,Dn)},L,R,Ze,se,ml,{current:!1}]};ql=(Wl={findFiberByHostInstance:Tn,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"}).findFiberByHostInstance,function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);_l=function(t){try{e.onCommitFiberRoot(n,t,void 0,64==(64&t.current.effectTag))}catch(t){}},wl=function(t){try{e.onCommitFiberUnmount(n,t)}catch(t){}}}catch(t){}}(r({},Wl,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=ne(t))?null:t.stateNode},findFiberByHostInstance:function(t){return ql?ql(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null})),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$l,e.createPortal=Gl,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"==typeof t.render)throw Error(o(188));throw Error(o(268,Object.keys(t)))}return t=null===(t=ne(e))?null:t.stateNode},e.flushSync=function(t,e){if(0!=(48&Ss))throw Error(o(187));var n=Ss;Ss|=1;try{return Ur(99,t.bind(null,e))}finally{Ss=n,Wr()}},e.hydrate=function(t,e,n){if(!jl(e))throw Error(o(200));return Ul(null,t,e,!0,n)},e.render=function(t,e,n){if(!jl(e))throw Error(o(200));return Ul(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!jl(t))throw Error(o(40));return!!t._reactRootContainer&&(el((function(){Ul(null,null,t,!1,(function(){t._reactRootContainer=null,t[Cn]=null}))})),!0)},e.unstable_batchedUpdates=tl,e.unstable_createPortal=function(t,e){return Gl(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!jl(n))throw Error(o(200));if(null==t||void 0===t._reactInternalFiber)throw Error(o(38));return Ul(t,e,n,!1,i)},e.version="16.13.1"},function(t,e,n){"use strict";t.exports=n(188)},function(t,e,n){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i,r,a,o,s;if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,u=null,c=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(t){throw setTimeout(c,0),t}},h=Date.now();e.unstable_now=function(){return Date.now()-h},i=function(t){null!==l?setTimeout(i,0,t):(l=t,setTimeout(c,0))},r=function(t,e){u=setTimeout(t,e)},a=function(){clearTimeout(u)},o=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var d=window.performance,f=window.Date,p=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var g=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof d&&"function"==typeof d.now)e.unstable_now=function(){return d.now()};else{var v=f.now();e.unstable_now=function(){return f.now()-v}}var y=!1,b=null,x=-1,_=5,w=0;o=function(){return e.unstable_now()>=w},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):_=0<t?Math.floor(1e3/t):5};var S=new MessageChannel,E=S.port2;S.port1.onmessage=function(){if(null!==b){var t=e.unstable_now();w=t+_;try{b(!0,t)?E.postMessage(null):(y=!1,b=null)}catch(t){throw E.postMessage(null),t}}else y=!1},i=function(t){b=t,y||(y=!0,E.postMessage(null))},r=function(t,n){x=p((function(){t(e.unstable_now())}),n)},a=function(){m(x),x=-1}}function M(t,e){var n=t.length;t.push(e);t:for(;;){var i=n-1>>>1,r=t[i];if(!(void 0!==r&&0<k(r,e)))break t;t[i]=e,t[n]=r,n=i}}function C(t){return void 0===(t=t[0])?null:t}function T(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length;i<r;){var a=2*(i+1)-1,o=t[a],s=a+1,l=t[s];if(void 0!==o&&0>k(o,n))void 0!==l&&0>k(l,o)?(t[i]=l,t[s]=n,i=s):(t[i]=o,t[a]=n,i=a);else{if(!(void 0!==l&&0>k(l,n)))break t;t[i]=l,t[s]=n,i=s}}}return e}return null}function k(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var P=[],A=[],O=1,L=null,R=3,I=!1,N=!1,D=!1;function z(t){for(var e=C(A);null!==e;){if(null===e.callback)T(A);else{if(!(e.startTime<=t))break;T(A),e.sortIndex=e.expirationTime,M(P,e)}e=C(A)}}function B(t){if(D=!1,z(t),!N)if(null!==C(P))N=!0,i(F);else{var e=C(A);null!==e&&r(B,e.startTime-t)}}function F(t,n){N=!1,D&&(D=!1,a()),I=!0;var i=R;try{for(z(n),L=C(P);null!==L&&(!(L.expirationTime>n)||t&&!o());){var s=L.callback;if(null!==s){L.callback=null,R=L.priorityLevel;var l=s(L.expirationTime<=n);n=e.unstable_now(),"function"==typeof l?L.callback=l:L===C(P)&&T(P),z(n)}else T(P);L=C(P)}if(null!==L)var u=!0;else{var c=C(A);null!==c&&r(B,c.startTime-n),u=!1}return u}finally{L=null,R=i,I=!1}}function V(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var j=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){N||I||(N=!0,i(F))},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return C(P)},e.unstable_next=function(t){switch(R){case 1:case 2:case 3:var e=3;break;default:e=R}var n=R;R=e;try{return t()}finally{R=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=j,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=R;R=t;try{return e()}finally{R=n}},e.unstable_scheduleCallback=function(t,n,o){var s=e.unstable_now();if("object"==typeof o&&null!==o){var l=o.delay;l="number"==typeof l&&0<l?s+l:s,o="number"==typeof o.timeout?o.timeout:V(t)}else o=V(t),l=s;return t={id:O++,callback:n,priorityLevel:t,startTime:l,expirationTime:o=l+o,sortIndex:-1},l>s?(t.sortIndex=l,M(A,t),null===C(P)&&t===C(A)&&(D?a():D=!0,r(B,l-s))):(t.sortIndex=o,M(P,t),N||I||(N=!0,i(F))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();z(t);var n=C(P);return n!==L&&null!==L&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<L.expirationTime||o()},e.unstable_wrapCallback=function(t){var e=R;return function(){var n=R;R=e;try{return t.apply(this,arguments)}finally{R=n}}}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(190),r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return t.prototype.register=function(t){var e="ID_"+this._lastID++;return this._callbacks[e]=t,e},t.prototype.unregister=function(t){this._callbacks[t]||i(!1),delete this._callbacks[t]},t.prototype.waitFor=function(t){this._isDispatching||i(!1);for(var e=0;e<t.length;e++){var n=t[e];this._isPending[n]?this._isHandled[n]||i(!1):(this._callbacks[n]||i(!1),this._invokeCallback(n))}},t.prototype.dispatch=function(t){this._isDispatching&&i(!1),this._startDispatching(t);try{for(var e in this._callbacks)this._isPending[e]||this._invokeCallback(e)}finally{this._stopDispatching()}},t.prototype.isDispatching=function(){return this._isDispatching},t.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},t.prototype._startDispatching=function(t){for(var e in this._callbacks)this._isPending[e]=!1,this._isHandled[e]=!1;this._pendingPayload=t,this._isDispatching=!0},t.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},t}();t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e,n,i,r,a,o,s){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,r,a,o,s],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlphaPicker=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=l(n(0)),a=l(n(3)),o=n(4),s=l(n(319));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.AlphaPicker=function(t){var e=t.rgb,n=t.hsl,s=t.width,l=t.height,u=t.onChange,c=t.direction,h=t.style,d=t.renderers,f=t.pointer,p=t.className,m=void 0===p?"":p,g=(0,a.default)({default:{picker:{position:"relative",width:s,height:l},alpha:{radius:"2px",style:h}}});return r.default.createElement("div",{style:g.picker,className:"alpha-picker "+m},r.default.createElement(o.Alpha,i({},g.alpha,{rgb:e,hsl:n,pointer:f,renderers:d,onChange:u,direction:c})))};u.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:s.default},e.default=(0,o.ColorWrap)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flattenNames=void 0;var i=s(n(193)),r=s(n(49)),a=s(n(107)),o=s(n(14));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.flattenNames=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return(0,o.default)(e,(function(e){Array.isArray(e)?t(e).map((function(t){return n.push(t)})):(0,a.default)(e)?(0,r.default)(e,(function(t,e){!0===t&&n.push(e),n.push(e+"-"+t)})):(0,i.default)(e)&&n.push(e)})),n};e.default=l},function(t,e,n){var i=n(16),r=n(5),a=n(12);t.exports=function(t){return"string"==typeof t||!r(t)&&a(t)&&"[object String]"==i(t)}},function(t,e,n){var i=n(24),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,s=i?i.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var i=!0}catch(t){}var r=o.call(t);return i&&(e?t[s]=n:delete t[s]),r}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return function(e,n,i){for(var r=-1,a=Object(e),o=i(e),s=o.length;s--;){var l=o[t?s:++r];if(!1===n(a[l],l,a))break}return e}}},function(t,e){t.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},function(t,e,n){var i=n(16),r=n(12);t.exports=function(t){return r(t)&&"[object Arguments]"==i(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var i=n(16),r=n(53),a=n(12),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&r(t.length)&&!!o[i(t)]}},function(t,e,n){var i=n(56),r=n(202),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return r(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var i=n(105)(Object.keys,Object);t.exports=i},function(t,e,n){var i=n(204),r=n(248),a=n(34),o=n(5),s=n(258);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?o(t)?r(t[0],t[1]):i(t):s(t)}},function(t,e,n){var i=n(205),r=n(247),a=n(118);t.exports=function(t){var e=r(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||i(n,t,e)}}},function(t,e,n){var i=n(35),r=n(110);t.exports=function(t,e,n,a){var o=n.length,s=o,l=!a;if(null==t)return!s;for(t=Object(t);o--;){var u=n[o];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var c=(u=n[o])[0],h=t[c],d=u[1];if(l&&u[2]){if(void 0===h&&!(c in t))return!1}else{var f=new i;if(a)var p=a(h,d,c,t,e,f);if(!(void 0===p?r(d,h,3,a,f):p))return!1}}return!0}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var i=n(37),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0)&&(n==e.length-1?e.pop():r.call(e,n,1),--this.size,!0)}},function(t,e,n){var i=n(37);t.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var i=n(37);t.exports=function(t){return i(this.__data__,t)>-1}},function(t,e,n){var i=n(37);t.exports=function(t,e){var n=this.__data__,r=i(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},function(t,e,n){var i=n(36);t.exports=function(){this.__data__=new i,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var i=n(36),r=n(59),a=n(60);t.exports=function(t,e){var n=this.__data__;if(n instanceof i){var o=n.__data__;if(!r||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var i=n(57),r=n(217),a=n(8),o=n(109),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,d=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||r(t))&&(i(t)?d:s).test(o(t))}},function(t,e,n){var i,r=n(218),a=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!a&&a in t}},function(t,e,n){var i=n(10)["__core-js_shared__"];t.exports=i},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var i=n(221),r=n(36),a=n(59);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||r),string:new i}}},function(t,e,n){var i=n(222),r=n(223),a=n(224),o=n(225),s=n(226);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var i=n(38);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var i=n(38),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(e,t)?e[t]:void 0}},function(t,e,n){var i=n(38),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:r.call(e,t)}},function(t,e,n){var i=n(38);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var i=n(39);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var i=n(39);t.exports=function(t){return i(this,t).get(t)}},function(t,e,n){var i=n(39);t.exports=function(t){return i(this,t).has(t)}},function(t,e,n){var i=n(39);t.exports=function(t,e){var n=i(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},function(t,e,n){var i=n(35),r=n(111),a=n(238),o=n(241),s=n(40),l=n(5),u=n(33),c=n(52),h="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,f,p,m){var g=l(t),v=l(e),y=g?"[object Array]":s(t),b=v?"[object Array]":s(e),x=(y="[object Arguments]"==y?h:y)==h,_=(b="[object Arguments]"==b?h:b)==h,w=y==b;if(w&&u(t)){if(!u(e))return!1;g=!0,x=!1}if(w&&!x)return m||(m=new i),g||c(t)?r(t,e,n,f,p,m):a(t,e,y,n,f,p,m);if(!(1&n)){var S=x&&d.call(t,"__wrapped__"),E=_&&d.call(e,"__wrapped__");if(S||E){var M=S?t.value():t,C=E?e.value():e;return m||(m=new i),p(M,C,n,f,m)}}return!!w&&(m||(m=new i),o(t,e,n,f,p,m))}},function(t,e,n){var i=n(60),r=n(234),a=n(235);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new i;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=r,o.prototype.has=a,t.exports=o},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){var i=n(24),r=n(112),a=n(26),o=n(111),s=n(239),l=n(240),u=i?i.prototype:void 0,c=u?u.valueOf:void 0;t.exports=function(t,e,n,i,u,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new r(t),new r(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=s;case"[object Set]":var p=1&i;if(f||(f=l),t.size!=e.size&&!p)return!1;var m=d.get(t);if(m)return m==e;i|=2,d.set(t,e);var g=o(f(t),f(e),i,u,h,d);return d.delete(t),g;case"[object Symbol]":if(c)return c.call(t)==c.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},function(t,e,n){var i=n(113),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,o,s){var l=1&n,u=i(t),c=u.length;if(c!=i(e).length&&!l)return!1;for(var h=c;h--;){var d=u[h];if(!(l?d in e:r.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var g=l;++h<c;){var v=t[d=u[h]],y=e[d];if(a)var b=l?a(y,v,d,e,t,s):a(v,y,d,t,e,s);if(!(void 0===b?v===y||o(v,y,n,a,s):b)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var x=t.constructor,_=e.constructor;x==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof _&&_ instanceof _||(m=!1)}return s.delete(t),s.delete(e),m}},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a}},function(t,e,n){var i=n(17)(n(10),"DataView");t.exports=i},function(t,e,n){var i=n(17)(n(10),"Promise");t.exports=i},function(t,e,n){var i=n(17)(n(10),"Set");t.exports=i},function(t,e,n){var i=n(17)(n(10),"WeakMap");t.exports=i},function(t,e,n){var i=n(117),r=n(25);t.exports=function(t){for(var e=r(t),n=e.length;n--;){var a=e[n],o=t[a];e[n]=[a,o,i(o)]}return e}},function(t,e,n){var i=n(110),r=n(249),a=n(255),o=n(62),s=n(117),l=n(118),u=n(42);t.exports=function(t,e){return o(t)&&s(e)?l(u(t),e):function(n){var o=r(n,t);return void 0===o&&o===e?a(n,t):i(e,o,3)}}},function(t,e,n){var i=n(119);t.exports=function(t,e,n){var r=null==t?void 0:i(t,e);return void 0===r?n:r}},function(t,e,n){var i=n(251),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,(function(t,n,i,r){e.push(i?r.replace(a,"$1"):n||t)})),e}));t.exports=o},function(t,e,n){var i=n(252);t.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var i=n(60);function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var o=t.apply(this,i);return n.cache=a.set(r,o)||a,o};return n.cache=new(r.Cache||i),n}r.Cache=i,t.exports=r},function(t,e,n){var i=n(254);t.exports=function(t){return null==t?"":i(t)}},function(t,e,n){var i=n(24),r=n(108),a=n(5),o=n(41),s=i?i.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return r(e,t)+"";if(o(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e,n){var i=n(256),r=n(257);t.exports=function(t,e){return null!=t&&r(t,e,i)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var i=n(120),r=n(50),a=n(5),o=n(51),s=n(53),l=n(42);t.exports=function(t,e,n){for(var u=-1,c=(e=i(e,t)).length,h=!1;++u<c;){var d=l(e[u]);if(!(h=null!=t&&n(t,d)))break;t=t[d]}return h||++u!=c?h:!!(c=null==t?0:t.length)&&s(c)&&o(d,c)&&(a(t)||r(t))}},function(t,e,n){var i=n(259),r=n(260),a=n(62),o=n(42);t.exports=function(t){return a(t)?i(o(t)):r(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var i=n(119);t.exports=function(t){return function(e){return i(e,t)}}},function(t,e,n){var i=n(121),r=n(21);t.exports=function(t,e){var n=-1,a=r(t)?Array(t.length):[];return i(t,(function(t,i,r){a[++n]=e(t,i,r)})),a}},function(t,e,n){var i=n(21);t.exports=function(t,e){return function(n,r){if(null==n)return n;if(!i(n))return t(n,r);for(var a=n.length,o=e?a:-1,s=Object(n);(e?o--:++o<a)&&!1!==r(s[o],o,s););return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeClasses=void 0;var i=o(n(49)),r=o(n(264)),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function o(t){return t&&t.__esModule?t:{default:t}}var s=e.mergeClasses=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.default&&(0,r.default)(t.default)||{};return e.map((function(e){var r=t[e];return r&&(0,i.default)(r,(function(t,e){n[e]||(n[e]={}),n[e]=a({},n[e],r[e])})),e})),n};e.default=s},function(t,e,n){var i=n(265);t.exports=function(t){return i(t,5)}},function(t,e,n){var i=n(35),r=n(122),a=n(123),o=n(266),s=n(267),l=n(125),u=n(126),c=n(270),h=n(271),d=n(113),f=n(272),p=n(40),m=n(273),g=n(274),v=n(129),y=n(5),b=n(33),x=n(279),_=n(8),w=n(281),S=n(25),E=n(28),M={};M["[object Arguments]"]=M["[object Array]"]=M["[object ArrayBuffer]"]=M["[object DataView]"]=M["[object Boolean]"]=M["[object Date]"]=M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Map]"]=M["[object Number]"]=M["[object Object]"]=M["[object RegExp]"]=M["[object Set]"]=M["[object String]"]=M["[object Symbol]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M["[object Error]"]=M["[object Function]"]=M["[object WeakMap]"]=!1,t.exports=function t(e,n,C,T,k,P){var A,O=1&n,L=2&n,R=4&n;if(C&&(A=k?C(e,T,k,P):C(e)),void 0!==A)return A;if(!_(e))return e;var I=y(e);if(I){if(A=m(e),!O)return u(e,A)}else{var N=p(e),D="[object Function]"==N||"[object GeneratorFunction]"==N;if(b(e))return l(e,O);if("[object Object]"==N||"[object Arguments]"==N||D&&!k){if(A=L||D?{}:v(e),!O)return L?h(e,s(A,e)):c(e,o(A,e))}else{if(!M[N])return k?e:{};A=g(e,N,O)}}P||(P=new i);var z=P.get(e);if(z)return z;P.set(e,A),w(e)?e.forEach((function(i){A.add(t(i,n,C,i,e,P))})):x(e)&&e.forEach((function(i,r){A.set(r,t(i,n,C,r,e,P))}));var B=I?void 0:(R?L?f:d:L?E:S)(e);return r(B||e,(function(i,r){B&&(i=e[r=i]),a(A,r,t(i,n,C,r,e,P))})),A}},function(t,e,n){var i=n(27),r=n(25);t.exports=function(t,e){return t&&i(e,r(e),t)}},function(t,e,n){var i=n(27),r=n(28);t.exports=function(t,e){return t&&i(e,r(e),t)}},function(t,e,n){var i=n(8),r=n(56),a=n(269),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return a(t);var e=r(t),n=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var i=n(27),r=n(61);t.exports=function(t,e){return i(t,r(t),e)}},function(t,e,n){var i=n(27),r=n(127);t.exports=function(t,e){return i(t,r(t),e)}},function(t,e,n){var i=n(114),r=n(127),a=n(28);t.exports=function(t){return i(t,a,r)}},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(i.index=t.index,i.input=t.input),i}},function(t,e,n){var i=n(64),r=n(275),a=n(276),o=n(277),s=n(128);t.exports=function(t,e,n){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return i(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return r(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return a(t);case"[object Set]":return new l;case"[object Symbol]":return o(t)}}},function(t,e,n){var i=n(64);t.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var i=n(24),r=i?i.prototype:void 0,a=r?r.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},function(t,e,n){var i=n(8),r=Object.create,a=function(){function t(){}return function(e){if(!i(e))return{};if(r)return r(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=a},function(t,e,n){var i=n(280),r=n(54),a=n(55),o=a&&a.isMap,s=o?r(o):i;t.exports=s},function(t,e,n){var i=n(40),r=n(12);t.exports=function(t){return r(t)&&"[object Map]"==i(t)}},function(t,e,n){var i=n(282),r=n(54),a=n(55),o=a&&a.isSet,s=o?r(o):i;t.exports=s},function(t,e,n){var i=n(40),r=n(12);t.exports=function(t){return r(t)&&"[object Set]"==i(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.autoprefix=void 0;var i,r=n(49),a=(i=r)&&i.__esModule?i:{default:i},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};var s={borderRadius:function(t){return{msBorderRadius:t,MozBorderRadius:t,OBorderRadius:t,WebkitBorderRadius:t,borderRadius:t}},boxShadow:function(t){return{msBoxShadow:t,MozBoxShadow:t,OBoxShadow:t,WebkitBoxShadow:t,boxShadow:t}},userSelect:function(t){return{WebkitTouchCallout:t,KhtmlUserSelect:t,MozUserSelect:t,msUserSelect:t,WebkitUserSelect:t,userSelect:t}},flex:function(t){return{WebkitBoxFlex:t,MozBoxFlex:t,WebkitFlex:t,msFlex:t,flex:t}},flexBasis:function(t){return{WebkitFlexBasis:t,flexBasis:t}},justifyContent:function(t){return{WebkitJustifyContent:t,justifyContent:t}},transition:function(t){return{msTransition:t,MozTransition:t,OTransition:t,WebkitTransition:t,transition:t}},transform:function(t){return{msTransform:t,MozTransform:t,OTransform:t,WebkitTransform:t,transform:t}},absolute:function(t){var e=t&&t.split(" ");return{position:"absolute",top:e&&e[0],right:e&&e[1],bottom:e&&e[2],left:e&&e[3]}},extend:function(t,e){var n=e[t];return n||{extend:t}}},l=e.autoprefix=function(t){var e={};return(0,a.default)(t,(function(t,n){var i={};(0,a.default)(t,(function(t,e){var n=s[e];n?i=o({},i,n(t)):i[e]=t})),e[n]=i})),e};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hover=void 0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=n(0),o=(i=a)&&i.__esModule?i:{default:i};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=e.hover=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function i(){var n,a,u;s(this,i);for(var c=arguments.length,h=Array(c),d=0;d<c;d++)h[d]=arguments[d];return a=u=l(this,(n=i.__proto__||Object.getPrototypeOf(i)).call.apply(n,[this].concat(h))),u.state={hover:!1},u.handleMouseOver=function(){return u.setState({hover:!0})},u.handleMouseOut=function(){return u.setState({hover:!1})},u.render=function(){return o.default.createElement(e,{onMouseOver:u.handleMouseOver,onMouseOut:u.handleMouseOut},o.default.createElement(t,r({},u.props,u.state)))},l(u,a)}return u(i,n),i}(o.default.Component)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.active=void 0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=n(0),o=(i=a)&&i.__esModule?i:{default:i};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=e.active=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function i(){var n,a,u;s(this,i);for(var c=arguments.length,h=Array(c),d=0;d<c;d++)h[d]=arguments[d];return a=u=l(this,(n=i.__proto__||Object.getPrototypeOf(i)).call.apply(n,[this].concat(h))),u.state={active:!1},u.handleMouseDown=function(){return u.setState({active:!0})},u.handleMouseUp=function(){return u.setState({active:!1})},u.render=function(){return o.default.createElement(e,{onMouseDown:u.handleMouseDown,onMouseUp:u.handleMouseUp},o.default.createElement(t,r({},u.props,u.state)))},l(u,a)}return u(i,n),i}(o.default.Component)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){var n={},i=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n[t]=e};return 0===t&&i("first-child"),t===e-1&&i("last-child"),(0===t||t%2==0)&&i("even"),1===Math.abs(t%2)&&i("odd"),i("nth-child",t),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Alpha=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(0),o=c(a),s=c(n(3)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(288)),u=c(n(65));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var f=e.Alpha=function(t){function e(){var t,n,i;h(this,e);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=i=d(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),i.handleChange=function(t){var e=l.calculateChange(t,i.props.hsl,i.props.direction,i.props.a,i.container);e&&"function"==typeof i.props.onChange&&i.props.onChange(e,t)},i.handleMouseDown=function(t){i.handleChange(t),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},d(i,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var t=this,e=this.props.rgb,n=(0,s.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+e.r+","+e.g+","+e.b+", 0) 0%,\n           rgba("+e.r+","+e.g+","+e.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:100*e.a+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+e.r+","+e.g+","+e.b+", 0) 0%,\n           rgba("+e.r+","+e.g+","+e.b+", 1) 100%)"},pointer:{left:0,top:100*e.a+"%"}},overwrite:i({},this.props.style)},{vertical:"vertical"===this.props.direction,overwrite:!0});return o.default.createElement("div",{style:n.alpha},o.default.createElement("div",{style:n.checkboard},o.default.createElement(u.default,{renderers:this.props.renderers})),o.default.createElement("div",{style:n.gradient}),o.default.createElement("div",{style:n.container,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},o.default.createElement("div",{style:n.pointer},this.props.pointer?o.default.createElement(this.props.pointer,this.props):o.default.createElement("div",{style:n.slider}))))}}]),e}(a.PureComponent||a.Component);e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n,i,r){var a=r.clientWidth,o=r.clientHeight,s="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,l="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,u=s-(r.getBoundingClientRect().left+window.pageXOffset),c=l-(r.getBoundingClientRect().top+window.pageYOffset);if("vertical"===n){var h=void 0;if(h=c<0?0:c>o?1:Math.round(100*c/o)/100,e.a!==h)return{h:e.h,s:e.s,l:e.l,a:h,source:"rgb"}}else{var d=void 0;if(i!==(d=u<0?0:u>a?1:Math.round(100*u/a)/100))return{h:e.h,s:e.s,l:e.l,a:d,source:"rgb"}}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={},r=e.render=function(t,e,n,i){if("undefined"==typeof document&&!i)return null;var r=i?new i:document.createElement("canvas");r.width=2*n,r.height=2*n;var a=r.getContext("2d");return a?(a.fillStyle=t,a.fillRect(0,0,r.width,r.height),a.fillStyle=e,a.fillRect(0,0,n,n),a.translate(n,n),a.fillRect(0,0,n,n),r.toDataURL()):null};e.get=function(t,e,n,a){var o=t+"-"+e+"-"+n+(a?"-server":"");if(i[o])return i[o];var s=r(t,e,n,a);return i[o]=s,s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditableInput=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=s(r),o=s(n(3));function s(t){return t&&t.__esModule?t:{default:t}}var l=[38,40],u=e.EditableInput=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(t){n.setUpdatedValue(t.target.value,t)},n.handleKeyDown=function(t){var e,i=function(t){return Number(String(t).replace(/%/g,""))}(t.target.value);if(!isNaN(i)&&(e=t.keyCode,l.indexOf(e)>-1)){var r=n.getArrowOffset(),a=38===t.keyCode?i+r:i-r;n.setUpdatedValue(a,t)}},n.handleDrag=function(t){if(n.props.dragLabel){var e=Math.round(n.props.value+t.movementX);e>=0&&e<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(e),t)}},n.handleMouseDown=function(t){n.props.dragLabel&&(t.preventDefault(),n.handleDrag(t),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(t.value).toUpperCase(),blurValue:String(t.value).toUpperCase()},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"componentDidUpdate",value:function(t,e){this.props.value===this.state.value||t.value===this.props.value&&e.value===this.state.value||(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(t){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},this.props.label,t)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||1}},{key:"setUpdatedValue",value:function(t,e){var n=this.props.label?this.getValueObjectWithLabel(t):t;this.props.onChange&&this.props.onChange(n,e),this.setState({value:t})}},{key:"render",value:function(){var t=this,e=(0,o.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return a.default.createElement("div",{style:e.wrap},a.default.createElement("input",{style:e.input,ref:function(e){return t.input=e},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?a.default.createElement("span",{style:e.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e}(r.PureComponent||r.Component);e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Hue=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=l(r),o=l(n(3)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(292));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var h=e.Hue=function(t){function e(){var t,n,i;u(this,e);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=i=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),i.handleChange=function(t){var e=s.calculateChange(t,i.props.direction,i.props.hsl,i.container);e&&"function"==typeof i.props.onChange&&i.props.onChange(e,t)},i.handleMouseDown=function(t){i.handleChange(t),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},c(i,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var t=this,e=this.props.direction,n=void 0===e?"horizontal":e,i=(0,o.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:100*this.props.hsl.h/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-100*this.props.hsl.h/360+100+"%"}}},{vertical:"vertical"===n});return a.default.createElement("div",{style:i.hue},a.default.createElement("div",{className:"hue-"+n,style:i.container,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},a.default.createElement("style",null,"\n            .hue-horizontal {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n\n            .hue-vertical {\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          "),a.default.createElement("div",{style:i.pointer},this.props.pointer?a.default.createElement(this.props.pointer,this.props):a.default.createElement("div",{style:i.slider}))))}}]),e}(r.PureComponent||r.Component);e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n,i){var r=i.clientWidth,a=i.clientHeight,o="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,s="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,l=o-(i.getBoundingClientRect().left+window.pageXOffset),u=s-(i.getBoundingClientRect().top+window.pageYOffset);if("vertical"===e){var c=void 0;if(u<0)c=359;else if(u>a)c=0;else{c=360*(-100*u/a+100)/100}if(n.h!==c)return{h:c,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var h=void 0;if(l<0)h=0;else if(l>r)h=359;else{h=360*(100*l/r)/100}if(n.h!==h)return{h:h,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Raised=void 0;var i=s(n(0)),r=s(n(6)),a=s(n(3)),o=s(n(7));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.Raised=function(t){var e=t.zDepth,n=t.radius,r=t.background,s=t.children,l=t.styles,u=void 0===l?{}:l,c=(0,a.default)((0,o.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+e+"px "+4*e+"px rgba(0,0,0,.24)",borderRadius:n,background:r}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},u),{"zDepth-1":1===e});return i.default.createElement("div",{style:c.wrap},i.default.createElement("div",{style:c.bg}),i.default.createElement("div",{style:c.content},s))};l.propTypes={background:r.default.string,zDepth:r.default.oneOf([0,1,2,3,4,5]),radius:r.default.number,styles:r.default.object},l.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}},e.default=l},function(t,e,n){"use strict";var i=n(295);function r(){}function a(){}a.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,a,o){if(o!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:a,resetWarningCache:r};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){var i=n(35),r=n(130),a=n(103),o=n(297),s=n(8),l=n(28),u=n(131);t.exports=function t(e,n,c,h,d){e!==n&&a(n,(function(a,l){if(d||(d=new i),s(a))o(e,n,l,c,t,h,d);else{var f=h?h(u(e,l),a,l+"",e,n,d):void 0;void 0===f&&(f=a),r(e,l,f)}}),l)}},function(t,e,n){var i=n(130),r=n(125),a=n(128),o=n(126),s=n(129),l=n(50),u=n(5),c=n(298),h=n(33),d=n(57),f=n(8),p=n(107),m=n(52),g=n(131),v=n(299);t.exports=function(t,e,n,y,b,x,_){var w=g(t,n),S=g(e,n),E=_.get(S);if(E)i(t,n,E);else{var M=x?x(w,S,n+"",t,e,_):void 0,C=void 0===M;if(C){var T=u(S),k=!T&&h(S),P=!T&&!k&&m(S);M=S,T||k||P?u(w)?M=w:c(w)?M=o(w):k?(C=!1,M=r(S,!0)):P?(C=!1,M=a(S,!0)):M=[]:p(S)||l(S)?(M=w,l(w)?M=v(w):f(w)&&!d(w)||(M=s(S))):C=!1}C&&(_.set(S,M),b(M,S,y,x,_),_.delete(S)),i(t,n,M)}}},function(t,e,n){var i=n(21),r=n(12);t.exports=function(t){return r(t)&&i(t)}},function(t,e,n){var i=n(27),r=n(28);t.exports=function(t){return i(t,r(t))}},function(t,e,n){var i=n(301),r=n(308);t.exports=function(t){return i((function(e,n){var i=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&r(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++i<a;){var l=n[i];l&&t(e,l,i,o)}return e}))}},function(t,e,n){var i=n(34),r=n(302),a=n(304);t.exports=function(t,e){return a(r(t,e,i),t+"")}},function(t,e,n){var i=n(303),r=Math.max;t.exports=function(t,e,n){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=r(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=a[o];return u[e]=n(l),i(t,this,u)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var i=n(305),r=n(307)(i);t.exports=r},function(t,e,n){var i=n(306),r=n(124),a=n(34),o=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;t.exports=o},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,i=0;return function(){var r=n(),a=16-(r-i);if(i=r,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var i=n(26),r=n(21),a=n(51),o=n(8);t.exports=function(t,e,n){if(!o(n))return!1;var s=typeof e;return!!("number"==s?r(n)&&a(e,n.length):"string"==s&&e in n)&&i(n[e],t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Saturation=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),a=u(r),o=u(n(3)),s=u(n(310)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(313));function u(t){return t&&t.__esModule?t:{default:t}}var c=e.Saturation=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.handleChange=function(t){"function"==typeof n.props.onChange&&n.throttle(n.props.onChange,l.calculateChange(t,n.props.hsl,n.container),t)},n.handleMouseDown=function(t){n.handleChange(t),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=(0,s.default)((function(t,e,n){t(e,n)}),50),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var t=this,e=this.props.style||{},n=e.color,i=e.white,r=e.black,s=e.pointer,l=e.circle,u=(0,o.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-100*this.props.hsv.v+100+"%",left:100*this.props.hsv.s+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:"0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\n            0 0 1px 2px rgba(0,0,0,.4)",borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:n,white:i,black:r,pointer:s,circle:l}},{custom:!!this.props.style});return a.default.createElement("div",{style:u.color,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},a.default.createElement("style",null,"\n          .saturation-white {\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n          }\n          .saturation-black {\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\n          }\n        "),a.default.createElement("div",{style:u.white,className:"saturation-white"},a.default.createElement("div",{style:u.black,className:"saturation-black"}),a.default.createElement("div",{style:u.pointer},this.props.pointer?a.default.createElement(this.props.pointer,this.props):a.default.createElement("div",{style:u.circle}))))}}]),e}(r.PureComponent||r.Component);e.default=c},function(t,e,n){var i=n(132),r=n(8);t.exports=function(t,e,n){var a=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return r(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),i(t,e,{leading:a,maxWait:e,trailing:o})}},function(t,e,n){var i=n(10);t.exports=function(){return i.Date.now()}},function(t,e,n){var i=n(8),r=n(41),a=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(r(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=s.test(t);return n||l.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n){var i=n.getBoundingClientRect(),r=i.width,a=i.height,o="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,s="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,l=o-(n.getBoundingClientRect().left+window.pageXOffset),u=s-(n.getBoundingClientRect().top+window.pageYOffset);l<0?l=0:l>r&&(l=r),u<0?u=0:u>a&&(u=a);var c=l/r,h=1-u/a;return{h:e.h,s:c,v:h,a:e.a,source:"hsv"}}},function(t,e,n){t.exports=n(315)},function(t,e,n){var i=n(122),r=n(121),a=n(106),o=n(5);t.exports=function(t,e){return(o(t)?i:r)(t,a(e))}},function(t,e,n){var i;!function(r){var a=/^\s+/,o=/\s+$/,s=0,l=r.round,u=r.min,c=r.max,h=r.random;function d(t,e){if(e=e||{},(t=t||"")instanceof d)return t;if(!(this instanceof d))return new d(t,e);var n=function(t){var e={r:0,g:0,b:0},n=1,i=null,s=null,l=null,h=!1,d=!1;"string"==typeof t&&(t=function(t){t=t.replace(a,"").replace(o,"").toLowerCase();var e,n=!1;if(A[t])t=A[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=H.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=H.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=H.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=H.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=H.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=H.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=H.hex8.exec(t))return{r:N(e[1]),g:N(e[2]),b:N(e[3]),a:F(e[4]),format:n?"name":"hex8"};if(e=H.hex6.exec(t))return{r:N(e[1]),g:N(e[2]),b:N(e[3]),format:n?"name":"hex"};if(e=H.hex4.exec(t))return{r:N(e[1]+""+e[1]),g:N(e[2]+""+e[2]),b:N(e[3]+""+e[3]),a:F(e[4]+""+e[4]),format:n?"name":"hex8"};if(e=H.hex3.exec(t))return{r:N(e[1]+""+e[1]),g:N(e[2]+""+e[2]),b:N(e[3]+""+e[3]),format:n?"name":"hex"};return!1}(t));"object"==typeof t&&(G(t.r)&&G(t.g)&&G(t.b)?(f=t.r,p=t.g,m=t.b,e={r:255*R(f,255),g:255*R(p,255),b:255*R(m,255)},h=!0,d="%"===String(t.r).substr(-1)?"prgb":"rgb"):G(t.h)&&G(t.s)&&G(t.v)?(i=z(t.s),s=z(t.v),e=function(t,e,n){t=6*R(t,360),e=R(e,100),n=R(n,100);var i=r.floor(t),a=t-i,o=n*(1-e),s=n*(1-a*e),l=n*(1-(1-a)*e),u=i%6;return{r:255*[n,s,o,o,l,n][u],g:255*[l,n,n,s,o,o][u],b:255*[o,o,l,n,n,s][u]}}(t.h,i,s),h=!0,d="hsv"):G(t.h)&&G(t.s)&&G(t.l)&&(i=z(t.s),l=z(t.l),e=function(t,e,n){var i,r,a;function o(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=R(t,360),e=R(e,100),n=R(n,100),0===e)i=r=a=n;else{var s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;i=o(l,s,t+1/3),r=o(l,s,t),a=o(l,s,t-1/3)}return{r:255*i,g:255*r,b:255*a}}(t.h,i,l),h=!0,d="hsl"),t.hasOwnProperty("a")&&(n=t.a));var f,p,m;return n=L(n),{ok:h,format:t.format||d,r:u(255,c(e.r,0)),g:u(255,c(e.g,0)),b:u(255,c(e.b,0)),a:n}}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=l(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=l(this._r)),this._g<1&&(this._g=l(this._g)),this._b<1&&(this._b=l(this._b)),this._ok=n.ok,this._tc_id=s++}function f(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i,r,a=c(t,e,n),o=u(t,e,n),s=(a+o)/2;if(a==o)i=r=0;else{var l=a-o;switch(r=s>.5?l/(2-a-o):l/(a+o),a){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:r,l:s}}function p(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var i,r,a=c(t,e,n),o=u(t,e,n),s=a,l=a-o;if(r=0===a?0:l/a,a==o)i=0;else{switch(a){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:r,v:s}}function m(t,e,n,i){var r=[D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function g(t,e,n,i){return[D(B(i)),D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16))].join("")}function v(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s-=e/100,n.s=I(n.s),d(n)}function y(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s+=e/100,n.s=I(n.s),d(n)}function b(t){return d(t).desaturate(100)}function x(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l+=e/100,n.l=I(n.l),d(n)}function _(t,e){e=0===e?0:e||10;var n=d(t).toRgb();return n.r=c(0,u(255,n.r-l(-e/100*255))),n.g=c(0,u(255,n.g-l(-e/100*255))),n.b=c(0,u(255,n.b-l(-e/100*255))),d(n)}function w(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l-=e/100,n.l=I(n.l),d(n)}function S(t,e){var n=d(t).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,d(n)}function E(t){var e=d(t).toHsl();return e.h=(e.h+180)%360,d(e)}function M(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+120)%360,s:e.s,l:e.l}),d({h:(n+240)%360,s:e.s,l:e.l})]}function C(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+90)%360,s:e.s,l:e.l}),d({h:(n+180)%360,s:e.s,l:e.l}),d({h:(n+270)%360,s:e.s,l:e.l})]}function T(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+72)%360,s:e.s,l:e.l}),d({h:(n+216)%360,s:e.s,l:e.l})]}function k(t,e,n){e=e||6,n=n||30;var i=d(t).toHsl(),r=360/n,a=[d(t)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,a.push(d(i));return a}function P(t,e){e=e||6;for(var n=d(t).toHsv(),i=n.h,r=n.s,a=n.v,o=[],s=1/e;e--;)o.push(d({h:i,s:r,v:a})),a=(a+s)%1;return o}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,i=this.toRgb();return t=i.r/255,e=i.g/255,n=i.b/255,.2126*(t<=.03928?t/12.92:r.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:r.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:r.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=L(t),this._roundA=l(100*this._a)/100,this},toHsv:function(){var t=p(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=p(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),i=l(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+i+"%)":"hsva("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=f(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=f(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),i=l(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+i+"%)":"hsla("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return m(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,n,i,r){var a=[D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16)),D(B(i))];if(r&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1))return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0);return a.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:l(this._r),g:l(this._g),b:l(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+l(this._r)+", "+l(this._g)+", "+l(this._b)+")":"rgba("+l(this._r)+", "+l(this._g)+", "+l(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:l(100*R(this._r,255))+"%",g:l(100*R(this._g,255))+"%",b:l(100*R(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+l(100*R(this._r,255))+"%, "+l(100*R(this._g,255))+"%, "+l(100*R(this._b,255))+"%)":"rgba("+l(100*R(this._r,255))+"%, "+l(100*R(this._g,255))+"%, "+l(100*R(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(O[m(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+g(this._r,this._g,this._b,this._a),n=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var r=d(t);n="#"+g(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,i=this._a<1&&this._a>=0;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(x,arguments)},brighten:function(){return this._applyModification(_,arguments)},darken:function(){return this._applyModification(w,arguments)},desaturate:function(){return this._applyModification(v,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification(S,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(k,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(P,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(M,arguments)},tetrad:function(){return this._applyCombination(C,arguments)}},d.fromRatio=function(t,e){if("object"==typeof t){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]="a"===i?t[i]:z(t[i]));t=n}return d(t,e)},d.equals=function(t,e){return!(!t||!e)&&d(t).toRgbString()==d(e).toRgbString()},d.random=function(){return d.fromRatio({r:h(),g:h(),b:h()})},d.mix=function(t,e,n){n=0===n?0:n||50;var i=d(t).toRgb(),r=d(e).toRgb(),a=n/100;return d({r:(r.r-i.r)*a+i.r,g:(r.g-i.g)*a+i.g,b:(r.b-i.b)*a+i.b,a:(r.a-i.a)*a+i.a})},d.readability=function(t,e){var n=d(t),i=d(e);return(r.max(n.getLuminance(),i.getLuminance())+.05)/(r.min(n.getLuminance(),i.getLuminance())+.05)},d.isReadable=function(t,e,n){var i,r,a=d.readability(t,e);switch(r=!1,(i=function(t){var e,n;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==n&&"large"!==n&&(n="small");return{level:e,size:n}}(n)).level+i.size){case"AAsmall":case"AAAlarge":r=a>=4.5;break;case"AAlarge":r=a>=3;break;case"AAAsmall":r=a>=7}return r},d.mostReadable=function(t,e,n){var i,r,a,o,s=null,l=0;r=(n=n||{}).includeFallbackColors,a=n.level,o=n.size;for(var u=0;u<e.length;u++)(i=d.readability(t,e[u]))>l&&(l=i,s=d(e[u]));return d.isReadable(t,s,{level:a,size:o})||!r?s:(n.includeFallbackColors=!1,d.mostReadable(t,["#fff","#000"],n))};var A=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},O=d.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(A);function L(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function R(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=u(e,c(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),r.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function I(t){return u(1,c(0,t))}function N(t){return parseInt(t,16)}function D(t){return 1==t.length?"0"+t:""+t}function z(t){return t<=1&&(t=100*t+"%"),t}function B(t){return r.round(255*parseFloat(t)).toString(16)}function F(t){return N(t)/255}var V,j,U,H=(j="[\\s|\\(]+("+(V="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",U="[\\s|\\(]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",{CSS_UNIT:new RegExp(V),rgb:new RegExp("rgb"+j),rgba:new RegExp("rgba"+U),hsl:new RegExp("hsl"+j),hsla:new RegExp("hsla"+U),hsv:new RegExp("hsv"+j),hsva:new RegExp("hsva"+U),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function G(t){return!!H.CSS_UNIT.exec(t)}t.exports?t.exports=d:void 0===(i=function(){return d}.call(e,n,e,t))||(t.exports=i)}(Math)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Swatch=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=l(n(0)),a=l(n(3)),o=n(318),s=l(n(65));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Swatch=function(t){var e=t.color,n=t.style,o=t.onClick,l=void 0===o?function(){}:o,u=t.onHover,c=t.title,h=void 0===c?e:c,d=t.children,f=t.focus,p=t.focusStyle,m=void 0===p?{}:p,g="transparent"===e,v=(0,a.default)({default:{swatch:i({background:e,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,f?m:{})}}),y={};return u&&(y.onMouseOver=function(t){return u(e,t)}),r.default.createElement("div",i({style:v.swatch,onClick:function(t){return l(e,t)},title:h,tabIndex:0,onKeyDown:function(t){return 13===t.keyCode&&l(e,t)}},y),d,g&&r.default.createElement(s.default,{borderRadius:v.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};e.default=(0,o.handleFocus)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleFocus=void 0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(0),s=(i=o)&&i.__esModule?i:{default:i};function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.handleFocus=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function i(){var t,e,n;l(this,i);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=n=u(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(a))),n.state={focus:!1},n.handleFocus=function(){return n.setState({focus:!0})},n.handleBlur=function(){return n.setState({focus:!1})},u(n,e)}return c(i,n),a(i,[{key:"render",value:function(){return s.default.createElement(e,{onFocus:this.handleFocus,onBlur:this.handleBlur},s.default.createElement(t,r({},this.props,this.state)))}}]),i}(s.default.Component)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlphaPointer=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.AlphaPointer=function(t){var e=t.direction,n=(0,r.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===e});return i.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Block=void 0;var i=c(n(0)),r=c(n(6)),a=c(n(3)),o=c(n(7)),s=c(n(13)),l=n(4),u=c(n(321));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Block=function(t){var e=t.onChange,n=t.onSwatchHover,r=t.hex,c=t.colors,h=t.width,d=t.triangle,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v="transparent"===r,y=function(t,n){s.default.isValidHex(t)&&e({hex:t,source:"hex"},n)},b=(0,a.default)((0,o.default)({default:{card:{width:h,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:r,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:s.default.getContrastingColor(r),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+r+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},p),{"hide-triangle":"hide"===d});return i.default.createElement("div",{style:b.card,className:"block-picker "+g},i.default.createElement("div",{style:b.triangle}),i.default.createElement("div",{style:b.head},v&&i.default.createElement(l.Checkboard,{borderRadius:"6px 6px 0 0"}),i.default.createElement("div",{style:b.label},r)),i.default.createElement("div",{style:b.body},i.default.createElement(u.default,{colors:c,onClick:y,onSwatchHover:n}),i.default.createElement(l.EditableInput,{style:{input:b.input},value:r,onChange:y})))};h.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),colors:r.default.arrayOf(r.default.string),triangle:r.default.oneOf(["top","hide"]),styles:r.default.object},h.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlockSwatches=void 0;var i=s(n(0)),r=s(n(3)),a=s(n(14)),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.BlockSwatches=function(t){var e=t.colors,n=t.onClick,s=t.onSwatchHover,l=(0,r.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return i.default.createElement("div",{style:l.swatches},(0,a.default)(e,(function(t){return i.default.createElement(o.Swatch,{key:t,color:t,style:l.swatch,onClick:n,onHover:s,focusStyle:{boxShadow:"0 0 4px "+t}})})),i.default.createElement("div",{style:l.clear}))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=void 0;var i=h(n(0)),r=h(n(6)),a=h(n(3)),o=h(n(14)),s=h(n(7)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(134)),u=n(4),c=h(n(323));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Circle=function(t){var e=t.width,n=t.onChange,r=t.onSwatchHover,l=t.colors,u=t.hex,h=t.circleSize,d=t.styles,f=void 0===d?{}:d,p=t.circleSpacing,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{card:{width:e,display:"flex",flexWrap:"wrap",marginRight:-p,marginBottom:-p}}},f)),y=function(t,e){return n({hex:t,source:"hex"},e)};return i.default.createElement("div",{style:v.card,className:"circle-picker "+g},(0,o.default)(l,(function(t){return i.default.createElement(c.default,{key:t,color:t,onClick:y,onSwatchHover:r,active:u===t.toLowerCase(),circleSize:h,circleSpacing:p})})))};d.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),circleSize:r.default.number,circleSpacing:r.default.number,styles:r.default.object},d.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[l.red[500],l.pink[500],l.purple[500],l.deepPurple[500],l.indigo[500],l.blue[500],l.lightBlue[500],l.cyan[500],l.teal[500],l.green[500],l.lightGreen[500],l.lime[500],l.yellow[500],l.amber[500],l.orange[500],l.deepOrange[500],l.brown[500],l.blueGrey[500]],styles:{}},e.default=(0,u.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CircleSwatch=void 0;var i=s(n(0)),r=n(3),a=s(r),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.CircleSwatch=function(t){var e=t.color,n=t.onClick,r=t.onSwatchHover,s=t.hover,l=t.active,u=t.circleSize,c=t.circleSpacing,h=(0,a.default)({default:{swatch:{width:u,height:u,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(u/2+1)+"px "+e,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+e}}},{hover:s,active:l});return i.default.createElement("div",{style:h.swatch},i.default.createElement(o.Swatch,{style:h.Swatch,color:e,onClick:n,onHover:r,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+e}}))};l.defaultProps={circleSize:28,circleSpacing:14},e.default=(0,r.handleHover)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome=void 0;var i=h(n(0)),r=h(n(6)),a=h(n(3)),o=h(n(7)),s=n(4),l=h(n(325)),u=h(n(328)),c=h(n(329));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Chrome=function(t){var e=t.width,n=t.onChange,r=t.disableAlpha,h=t.rgb,d=t.hsl,f=t.hsv,p=t.hex,m=t.renderers,g=t.styles,v=void 0===g?{}:g,y=t.className,b=void 0===y?"":y,x=t.defaultView,_=(0,a.default)((0,o.default)({default:{picker:{width:e,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+h.r+", "+h.g+", "+h.b+", "+h.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},v),{disableAlpha:r});return i.default.createElement("div",{style:_.picker,className:"chrome-picker "+b},i.default.createElement("div",{style:_.saturation},i.default.createElement(s.Saturation,{style:_.Saturation,hsl:d,hsv:f,pointer:c.default,onChange:n})),i.default.createElement("div",{style:_.body},i.default.createElement("div",{style:_.controls,className:"flexbox-fix"},i.default.createElement("div",{style:_.color},i.default.createElement("div",{style:_.swatch},i.default.createElement("div",{style:_.active}),i.default.createElement(s.Checkboard,{renderers:m}))),i.default.createElement("div",{style:_.toggles},i.default.createElement("div",{style:_.hue},i.default.createElement(s.Hue,{style:_.Hue,hsl:d,pointer:u.default,onChange:n})),i.default.createElement("div",{style:_.alpha},i.default.createElement(s.Alpha,{style:_.Alpha,rgb:h,hsl:d,pointer:u.default,renderers:m,onChange:n})))),i.default.createElement(l.default,{rgb:h,hsl:d,hex:p,view:x,onChange:n,disableAlpha:r})))};d.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),disableAlpha:r.default.bool,styles:r.default.object,defaultView:r.default.oneOf(["hex","rgb","hsl"])},d.defaultProps={width:225,disableAlpha:!1,styles:{}},e.default=(0,s.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromeFields=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=c(n(0)),a=c(n(3)),o=c(n(13)),s=c(n(326)),l=n(4),u=c(n(327));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.ChromeFields=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){"hex"===n.state.view?n.setState({view:"rgb"}):"rgb"===n.state.view?n.setState({view:"hsl"}):"hsl"===n.state.view&&(1===n.props.hsl.a?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(t,e){t.hex?o.default.isValidHex(t.hex)&&n.props.onChange({hex:t.hex,source:"hex"},e):t.r||t.g||t.b?n.props.onChange({r:t.r||n.props.rgb.r,g:t.g||n.props.rgb.g,b:t.b||n.props.rgb.b,source:"rgb"},e):t.a?(t.a<0?t.a=0:t.a>1&&(t.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(100*t.a)/100,source:"rgb"},e)):(t.h||t.s||t.l)&&("string"==typeof t.s&&t.s.includes("%")&&(t.s=t.s.replace("%","")),"string"==typeof t.l&&t.l.includes("%")&&(t.l=t.l.replace("%","")),1==t.s?t.s=.01:1==t.l&&(t.l=.01),n.props.onChange({h:t.h||n.props.hsl.h,s:Number((0,s.default)(t.s)?n.props.hsl.s:t.s),l:Number((0,s.default)(t.l)?n.props.hsl.l:t.l),source:"hsl"},e))},n.showHighlight=function(t){t.currentTarget.style.background="#eee"},n.hideHighlight=function(t){t.currentTarget.style.background="transparent"},1!==t.hsl.a&&"hex"===t.view?n.state={view:"rgb"}:n.state={view:t.view},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"render",value:function(){var t=this,e=(0,a.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),n=void 0;return"hex"===this.state.view?n=r.default.createElement("div",{style:e.fields,className:"flexbox-fix"},r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):"rgb"===this.state.view?n=r.default.createElement("div",{style:e.fields,className:"flexbox-fix"},r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),r.default.createElement("div",{style:e.alpha},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):"hsl"===this.state.view&&(n=r.default.createElement("div",{style:e.fields,className:"flexbox-fix"},r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"s",value:Math.round(100*this.props.hsl.s)+"%",onChange:this.handleChange})),r.default.createElement("div",{style:e.field},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"l",value:Math.round(100*this.props.hsl.l)+"%",onChange:this.handleChange})),r.default.createElement("div",{style:e.alpha},r.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),r.default.createElement("div",{style:e.wrap,className:"flexbox-fix"},n,r.default.createElement("div",{style:e.toggle},r.default.createElement("div",{style:e.icon,onClick:this.toggleViews,ref:function(e){return t.icon=e}},r.default.createElement(u.default,{style:e.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return 1!==t.hsl.a&&"hex"===e.view?{view:"rgb"}:null}}]),e}(r.default.Component);h.defaultProps={view:"hex"},e.default=h},function(t,e){t.exports=function(t){return void 0===t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=n(0),o=(i=a)&&i.__esModule?i:{default:i};e.default=function(t){var e=t.fill,n=void 0===e?"currentColor":e,i=t.width,a=void 0===i?24:i,s=t.height,l=void 0===s?24:s,u=t.style,c=void 0===u?{}:u,h=function(t,e){var n={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}(t,["fill","width","height","style"]);return o.default.createElement("svg",r({viewBox:"0 0 24 24",style:r({fill:n,width:a,height:l},c)},h),o.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromePointer=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.ChromePointer=function(){var t=(0,r.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return i.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromePointerCircle=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.ChromePointerCircle=function(){var t=(0,r.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return i.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Compact=void 0;var i=d(n(0)),r=d(n(6)),a=d(n(3)),o=d(n(14)),s=d(n(7)),l=d(n(13)),u=n(4),c=d(n(331)),h=d(n(332));function d(t){return t&&t.__esModule?t:{default:t}}var f=e.Compact=function(t){var e=t.onChange,n=t.onSwatchHover,r=t.colors,d=t.hex,f=t.rgb,p=t.styles,m=void 0===p?{}:p,g=t.className,v=void 0===g?"":g,y=(0,a.default)((0,s.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},m)),b=function(t,n){t.hex?l.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},n):e(t,n)};return i.default.createElement(u.Raised,{style:y.Compact,styles:m},i.default.createElement("div",{style:y.compact,className:"compact-picker "+v},i.default.createElement("div",null,(0,o.default)(r,(function(t){return i.default.createElement(c.default,{key:t,color:t,active:t.toLowerCase()===d,onClick:b,onSwatchHover:n})})),i.default.createElement("div",{style:y.clear})),i.default.createElement(h.default,{hex:d,rgb:f,onChange:b})))};f.propTypes={colors:r.default.arrayOf(r.default.string),styles:r.default.object},f.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}},e.default=(0,u.ColorWrap)(f)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompactColor=void 0;var i=s(n(0)),r=s(n(3)),a=s(n(13)),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.CompactColor=function(t){var e=t.color,n=t.onClick,s=void 0===n?function(){}:n,l=t.onSwatchHover,u=t.active,c=(0,r.default)({default:{color:{background:e,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:a.default.getContrastingColor(e),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:u,"color-#FFFFFF":"#FFFFFF"===e,transparent:"transparent"===e});return i.default.createElement(o.Swatch,{style:c.color,color:e,onClick:s,onHover:l,focusStyle:{boxShadow:"0 0 4px "+e}},i.default.createElement("div",{style:c.dot}))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompactFields=void 0;var i=o(n(0)),r=o(n(3)),a=n(4);function o(t){return t&&t.__esModule?t:{default:t}}var s=e.CompactFields=function(t){var e=t.hex,n=t.rgb,o=t.onChange,s=(0,r.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:e},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),l=function(t,e){t.r||t.g||t.b?o({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,source:"rgb"},e):o({hex:t.hex,source:"hex"},e)};return i.default.createElement("div",{style:s.fields,className:"flexbox-fix"},i.default.createElement("div",{style:s.active}),i.default.createElement(a.EditableInput,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"hex",value:e,onChange:l}),i.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:l}),i.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:l}),i.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:l}))};e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Github=void 0;var i=c(n(0)),r=c(n(6)),a=c(n(3)),o=c(n(14)),s=c(n(7)),l=n(4),u=c(n(334));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Github=function(t){var e=t.width,n=t.colors,r=t.onChange,l=t.onSwatchHover,c=t.triangle,h=t.styles,d=void 0===h?{}:h,f=t.className,p=void 0===f?"":f,m=(0,a.default)((0,s.default)({default:{card:{width:e,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},d),{"hide-triangle":"hide"===c,"top-left-triangle":"top-left"===c,"top-right-triangle":"top-right"===c,"bottom-left-triangle":"bottom-left"===c,"bottom-right-triangle":"bottom-right"===c}),g=function(t,e){return r({hex:t,source:"hex"},e)};return i.default.createElement("div",{style:m.card,className:"github-picker "+p},i.default.createElement("div",{style:m.triangleShadow}),i.default.createElement("div",{style:m.triangle}),(0,o.default)(n,(function(t){return i.default.createElement(u.default,{color:t,key:t,onClick:g,onSwatchHover:l})})))};h.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),colors:r.default.arrayOf(r.default.string),triangle:r.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:r.default.object},h.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GithubSwatch=void 0;var i=s(n(0)),r=n(3),a=s(r),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.GithubSwatch=function(t){var e=t.hover,n=t.color,r=t.onClick,s=t.onSwatchHover,l={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},u=(0,a.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:l}},{hover:e});return i.default.createElement("div",{style:u.swatch},i.default.createElement(o.Swatch,{color:n,onClick:r,onHover:s,focusStyle:l}))};e.default=(0,r.handleHover)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HuePicker=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=c(n(0)),a=c(n(6)),o=c(n(3)),s=c(n(7)),l=n(4),u=c(n(336));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.HuePicker=function(t){var e=t.width,n=t.height,a=t.onChange,u=t.hsl,c=t.direction,h=t.pointer,d=t.styles,f=void 0===d?{}:d,p=t.className,m=void 0===p?"":p,g=(0,o.default)((0,s.default)({default:{picker:{position:"relative",width:e,height:n},hue:{radius:"2px"}}},f));return r.default.createElement("div",{style:g.picker,className:"hue-picker "+m},r.default.createElement(l.Hue,i({},g.hue,{hsl:u,pointer:h,onChange:function(t){return a({a:1,h:t.h,l:.5,s:1})},direction:c})))};h.propTypes={styles:a.default.object},h.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:u.default,styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderPointer=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderPointer=function(t){var e=t.direction,n=(0,r.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===e});return i.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;var i=l(n(0)),r=l(n(3)),a=l(n(7)),o=l(n(13)),s=n(4);function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Material=function(t){var e=t.onChange,n=t.hex,l=t.rgb,u=t.styles,c=void 0===u?{}:u,h=t.className,d=void 0===h?"":h,f=(0,r.default)((0,a.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},c)),p=function(t,n){t.hex?o.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},n):(t.r||t.g||t.b)&&e({r:t.r||l.r,g:t.g||l.g,b:t.b||l.b,source:"rgb"},n)};return i.default.createElement(s.Raised,{styles:c},i.default.createElement("div",{style:f.material,className:"material-picker "+d},i.default.createElement(s.EditableInput,{style:{wrap:f.HEXwrap,input:f.HEXinput,label:f.HEXlabel},label:"hex",value:n,onChange:p}),i.default.createElement("div",{style:f.split,className:"flexbox-fix"},i.default.createElement("div",{style:f.third},i.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"r",value:l.r,onChange:p})),i.default.createElement("div",{style:f.third},i.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"g",value:l.g,onChange:p})),i.default.createElement("div",{style:f.third},i.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"b",value:l.b,onChange:p})))))};e.default=(0,s.ColorWrap)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Photoshop=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=p(n(0)),a=p(n(6)),o=p(n(3)),s=p(n(7)),l=n(4),u=p(n(339)),c=p(n(340)),h=p(n(341)),d=p(n(342)),f=p(n(343));function p(t){return t&&t.__esModule?t:{default:t}}var m=e.Photoshop=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:t.hex},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"render",value:function(){var t=this.props,e=t.styles,n=void 0===e?{}:e,i=t.className,a=void 0===i?"":i,p=(0,o.default)((0,s.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},n));return r.default.createElement("div",{style:p.picker,className:"photoshop-picker "+a},r.default.createElement("div",{style:p.head},this.props.header),r.default.createElement("div",{style:p.body,className:"flexbox-fix"},r.default.createElement("div",{style:p.saturation},r.default.createElement(l.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:c.default,onChange:this.props.onChange})),r.default.createElement("div",{style:p.hue},r.default.createElement(l.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:h.default,onChange:this.props.onChange})),r.default.createElement("div",{style:p.controls},r.default.createElement("div",{style:p.top,className:"flexbox-fix"},r.default.createElement("div",{style:p.previews},r.default.createElement(f.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),r.default.createElement("div",{style:p.actions},r.default.createElement(d.default,{label:"OK",onClick:this.props.onAccept,active:!0}),r.default.createElement(d.default,{label:"Cancel",onClick:this.props.onCancel}),r.default.createElement(u.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e}(r.default.Component);m.propTypes={header:a.default.string,styles:a.default.object},m.defaultProps={header:"Color Picker",styles:{}},e.default=(0,l.ColorWrap)(m)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPicker=void 0;var i=s(n(0)),r=s(n(3)),a=s(n(13)),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.PhotoshopPicker=function(t){var e=t.onChange,n=t.rgb,s=t.hsv,l=t.hex,u=(0,r.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),c=function(t,i){t["#"]?a.default.isValidHex(t["#"])&&e({hex:t["#"],source:"hex"},i):t.r||t.g||t.b?e({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,source:"rgb"},i):(t.h||t.s||t.v)&&e({h:t.h||s.h,s:t.s||s.s,v:t.v||s.v,source:"hsv"},i)};return i.default.createElement("div",{style:u.fields},i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"h",value:Math.round(s.h),onChange:c}),i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"s",value:Math.round(100*s.s),onChange:c}),i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"v",value:Math.round(100*s.v),onChange:c}),i.default.createElement("div",{style:u.divider}),i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"r",value:n.r,onChange:c}),i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"g",value:n.g,onChange:c}),i.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"b",value:n.b,onChange:c}),i.default.createElement("div",{style:u.divider}),i.default.createElement(o.EditableInput,{style:{wrap:u.HEXwrap,input:u.HEXinput,label:u.HEXlabel},label:"#",value:l.replace("#",""),onChange:c}),i.default.createElement("div",{style:u.fieldSymbols},i.default.createElement("div",{style:u.symbol},""),i.default.createElement("div",{style:u.symbol},"%"),i.default.createElement("div",{style:u.symbol},"%")))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPointerCircle=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPointerCircle=function(t){var e=t.hsl,n=(0,r.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":e.l>.5});return i.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPointerCircle=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPointerCircle=function(){var t=(0,r.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return i.default.createElement("div",{style:t.pointer},i.default.createElement("div",{style:t.left},i.default.createElement("div",{style:t.leftInside})),i.default.createElement("div",{style:t.right},i.default.createElement("div",{style:t.rightInside})))};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopButton=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopButton=function(t){var e=t.onClick,n=t.label,a=t.children,o=t.active,s=(0,r.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:o});return i.default.createElement("div",{style:s.button,onClick:e},n||a)};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPreviews=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPreviews=function(t){var e=t.rgb,n=t.currentColor,a=(0,r.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+e.r+","+e.g+", "+e.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return i.default.createElement("div",null,i.default.createElement("div",{style:a.label},"new"),i.default.createElement("div",{style:a.swatches},i.default.createElement("div",{style:a.new}),i.default.createElement("div",{style:a.current})),i.default.createElement("div",{style:a.label},"current"))};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sketch=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=h(n(0)),a=h(n(6)),o=h(n(3)),s=h(n(7)),l=n(4),u=h(n(345)),c=h(n(346));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Sketch=function(t){var e=t.width,n=t.rgb,a=t.hex,h=t.hsv,d=t.hsl,f=t.onChange,p=t.onSwatchHover,m=t.disableAlpha,g=t.presetColors,v=t.renderers,y=t.styles,b=void 0===y?{}:y,x=t.className,_=void 0===x?"":x,w=(0,o.default)((0,s.default)({default:i({picker:{width:e,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},b),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},b),{disableAlpha:m});return r.default.createElement("div",{style:w.picker,className:"sketch-picker "+_},r.default.createElement("div",{style:w.saturation},r.default.createElement(l.Saturation,{style:w.Saturation,hsl:d,hsv:h,onChange:f})),r.default.createElement("div",{style:w.controls,className:"flexbox-fix"},r.default.createElement("div",{style:w.sliders},r.default.createElement("div",{style:w.hue},r.default.createElement(l.Hue,{style:w.Hue,hsl:d,onChange:f})),r.default.createElement("div",{style:w.alpha},r.default.createElement(l.Alpha,{style:w.Alpha,rgb:n,hsl:d,renderers:v,onChange:f}))),r.default.createElement("div",{style:w.color},r.default.createElement(l.Checkboard,null),r.default.createElement("div",{style:w.activeColor}))),r.default.createElement(u.default,{rgb:n,hsl:d,hex:a,onChange:f,disableAlpha:m}),r.default.createElement(c.default,{colors:g,onClick:f,onSwatchHover:p}))};d.propTypes={disableAlpha:a.default.bool,width:a.default.oneOfType([a.default.string,a.default.number]),styles:a.default.object},d.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},e.default=(0,l.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SketchFields=void 0;var i=s(n(0)),r=s(n(3)),a=s(n(13)),o=n(4);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.SketchFields=function(t){var e=t.onChange,n=t.rgb,s=t.hsl,l=t.hex,u=t.disableAlpha,c=(0,r.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:u}),h=function(t,i){t.hex?a.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},i):t.r||t.g||t.b?e({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,a:n.a,source:"rgb"},i):t.a&&(t.a<0?t.a=0:t.a>100&&(t.a=100),t.a/=100,e({h:s.h,s:s.s,l:s.l,a:t.a,source:"rgb"},i))};return i.default.createElement("div",{style:c.fields,className:"flexbox-fix"},i.default.createElement("div",{style:c.double},i.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"hex",value:l.replace("#",""),onChange:h})),i.default.createElement("div",{style:c.single},i.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"r",value:n.r,onChange:h,dragLabel:"true",dragMax:"255"})),i.default.createElement("div",{style:c.single},i.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"g",value:n.g,onChange:h,dragLabel:"true",dragMax:"255"})),i.default.createElement("div",{style:c.single},i.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"b",value:n.b,onChange:h,dragLabel:"true",dragMax:"255"})),i.default.createElement("div",{style:c.alpha},i.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"a",value:Math.round(100*n.a),onChange:h,dragLabel:"true",dragMax:"100"})))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SketchPresetColors=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=l(n(0)),a=l(n(6)),o=l(n(3)),s=n(4);function l(t){return t&&t.__esModule?t:{default:t}}var u=e.SketchPresetColors=function(t){var e=t.colors,n=t.onClick,a=void 0===n?function(){}:n,l=t.onSwatchHover,u=(0,o.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!e||!e.length}),c=function(t,e){a({hex:t,source:"hex"},e)};return r.default.createElement("div",{style:u.colors,className:"flexbox-fix"},e.map((function(t){var e="string"==typeof t?{color:t}:t,n=""+e.color+(e.title||"");return r.default.createElement("div",{key:n,style:u.swatchWrap},r.default.createElement(s.Swatch,i({},e,{style:u.swatch,onClick:c,onHover:l,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+e.color}})))})))};u.propTypes={colors:a.default.arrayOf(a.default.oneOfType([a.default.string,a.default.shape({color:a.default.string,title:a.default.string})])).isRequired},e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Slider=void 0;var i=c(n(0)),r=c(n(6)),a=c(n(3)),o=c(n(7)),s=n(4),l=c(n(348)),u=c(n(350));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Slider=function(t){var e=t.hsl,n=t.onChange,r=t.pointer,u=t.styles,c=void 0===u?{}:u,h=t.className,d=void 0===h?"":h,f=(0,a.default)((0,o.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},c));return i.default.createElement("div",{style:f.wrap||{},className:"slider-picker "+d},i.default.createElement("div",{style:f.hue},i.default.createElement(s.Hue,{style:f.Hue,hsl:e,pointer:r,onChange:n})),i.default.createElement("div",{style:f.swatches},i.default.createElement(l.default,{hsl:e,onClick:n})))};h.propTypes={styles:r.default.object},h.defaultProps={pointer:u.default,styles:{}},e.default=(0,s.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderSwatches=void 0;var i=o(n(0)),r=o(n(3)),a=o(n(349));function o(t){return t&&t.__esModule?t:{default:t}}var s=e.SliderSwatches=function(t){var e=t.onClick,n=t.hsl,o=(0,r.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}});return i.default.createElement("div",{style:o.swatches},i.default.createElement("div",{style:o.swatch},i.default.createElement(a.default,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<.1&&Math.abs(n.s-.5)<.1,onClick:e,first:!0})),i.default.createElement("div",{style:o.swatch},i.default.createElement(a.default,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),i.default.createElement("div",{style:o.swatch},i.default.createElement(a.default,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),i.default.createElement("div",{style:o.swatch},i.default.createElement(a.default,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),i.default.createElement("div",{style:o.swatch},i.default.createElement(a.default,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<.1&&Math.abs(n.s-.5)<.1,onClick:e,last:!0})),i.default.createElement("div",{style:o.clear}))};e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderSwatch=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderSwatch=function(t){var e=t.hsl,n=t.offset,a=t.onClick,o=void 0===a?function(){}:a,s=t.active,l=t.first,u=t.last,c=(0,r.default)({default:{swatch:{height:"12px",background:"hsl("+e.h+", 50%, "+100*n+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:l,last:u});return i.default.createElement("div",{style:c.swatch,onClick:function(t){return o({h:e.h,s:.5,l:n,source:"hsl"},t)}})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderPointer=void 0;var i=a(n(0)),r=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderPointer=function(){var t=(0,r.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return i.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Swatches=void 0;var i=h(n(0)),r=h(n(6)),a=h(n(3)),o=h(n(14)),s=h(n(7)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(134)),u=n(4),c=h(n(352));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Swatches=function(t){var e=t.width,n=t.height,r=t.onChange,l=t.onSwatchHover,h=t.colors,d=t.hex,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{picker:{width:e,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},p)),y=function(t,e){return r({hex:t,source:"hex"},e)};return i.default.createElement("div",{style:v.picker,className:"swatches-picker "+g},i.default.createElement(u.Raised,null,i.default.createElement("div",{style:v.overflow},i.default.createElement("div",{style:v.body},(0,o.default)(h,(function(t){return i.default.createElement(c.default,{key:t.toString(),group:t,active:d,onClick:y,onSwatchHover:l})})),i.default.createElement("div",{style:v.clear})))))};d.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),height:r.default.oneOfType([r.default.string,r.default.number]),colors:r.default.arrayOf(r.default.arrayOf(r.default.string)),styles:r.default.object},d.defaultProps={width:320,height:240,colors:[[l.red[900],l.red[700],l.red[500],l.red[300],l.red[100]],[l.pink[900],l.pink[700],l.pink[500],l.pink[300],l.pink[100]],[l.purple[900],l.purple[700],l.purple[500],l.purple[300],l.purple[100]],[l.deepPurple[900],l.deepPurple[700],l.deepPurple[500],l.deepPurple[300],l.deepPurple[100]],[l.indigo[900],l.indigo[700],l.indigo[500],l.indigo[300],l.indigo[100]],[l.blue[900],l.blue[700],l.blue[500],l.blue[300],l.blue[100]],[l.lightBlue[900],l.lightBlue[700],l.lightBlue[500],l.lightBlue[300],l.lightBlue[100]],[l.cyan[900],l.cyan[700],l.cyan[500],l.cyan[300],l.cyan[100]],[l.teal[900],l.teal[700],l.teal[500],l.teal[300],l.teal[100]],["#194D33",l.green[700],l.green[500],l.green[300],l.green[100]],[l.lightGreen[900],l.lightGreen[700],l.lightGreen[500],l.lightGreen[300],l.lightGreen[100]],[l.lime[900],l.lime[700],l.lime[500],l.lime[300],l.lime[100]],[l.yellow[900],l.yellow[700],l.yellow[500],l.yellow[300],l.yellow[100]],[l.amber[900],l.amber[700],l.amber[500],l.amber[300],l.amber[100]],[l.orange[900],l.orange[700],l.orange[500],l.orange[300],l.orange[100]],[l.deepOrange[900],l.deepOrange[700],l.deepOrange[500],l.deepOrange[300],l.deepOrange[100]],[l.brown[900],l.brown[700],l.brown[500],l.brown[300],l.brown[100]],[l.blueGrey[900],l.blueGrey[700],l.blueGrey[500],l.blueGrey[300],l.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}},e.default=(0,u.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwatchesGroup=void 0;var i=s(n(0)),r=s(n(3)),a=s(n(14)),o=s(n(353));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.SwatchesGroup=function(t){var e=t.onClick,n=t.onSwatchHover,s=t.group,l=t.active,u=(0,r.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return i.default.createElement("div",{style:u.group},(0,a.default)(s,(function(t,r){return i.default.createElement(o.default,{key:t,color:t,active:t.toLowerCase()===l,first:0===r,last:r===s.length-1,onClick:e,onSwatchHover:n})})))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwatchesColor=void 0;var i=l(n(0)),r=l(n(3)),a=l(n(13)),o=n(4),s=l(n(354));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.SwatchesColor=function(t){var e=t.color,n=t.onClick,l=void 0===n?function(){}:n,u=t.onSwatchHover,c=t.first,h=t.last,d=t.active,f=(0,r.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:e,marginBottom:"1px"},check:{color:a.default.getContrastingColor(e),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:c,last:h,active:d,"color-#FFFFFF":"#FFFFFF"===e,transparent:"transparent"===e});return i.default.createElement(o.Swatch,{color:e,style:f.color,onClick:l,onHover:u,focusStyle:{boxShadow:"0 0 4px "+e}},i.default.createElement("div",{style:f.check},i.default.createElement(s.default,null)))};e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},a=n(0),o=(i=a)&&i.__esModule?i:{default:i};e.default=function(t){var e=t.fill,n=void 0===e?"currentColor":e,i=t.width,a=void 0===i?24:i,s=t.height,l=void 0===s?24:s,u=t.style,c=void 0===u?{}:u,h=function(t,e){var n={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}(t,["fill","width","height","style"]);return o.default.createElement("svg",r({viewBox:"0 0 24 24",style:r({fill:n,width:a,height:l},c)},h),o.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Twitter=void 0;var i=c(n(0)),r=c(n(6)),a=c(n(3)),o=c(n(14)),s=c(n(7)),l=c(n(13)),u=n(4);function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Twitter=function(t){var e=t.onChange,n=t.onSwatchHover,r=t.hex,c=t.colors,h=t.width,d=t.triangle,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{card:{width:h,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},p),{"hide-triangle":"hide"===d,"top-left-triangle":"top-left"===d,"top-right-triangle":"top-right"===d}),y=function(t,n){l.default.isValidHex(t)&&e({hex:t,source:"hex"},n)};return i.default.createElement("div",{style:v.card,className:"twitter-picker "+g},i.default.createElement("div",{style:v.triangleShadow}),i.default.createElement("div",{style:v.triangle}),i.default.createElement("div",{style:v.body},(0,o.default)(c,(function(t,e){return i.default.createElement(u.Swatch,{key:e,color:t,hex:t,style:v.swatch,onClick:y,onHover:n,focusStyle:{boxShadow:"0 0 4px "+t}})})),i.default.createElement("div",{style:v.hash},"#"),i.default.createElement(u.EditableInput,{label:null,style:{input:v.input},value:r.replace("#",""),onChange:y}),i.default.createElement("div",{style:v.clear})))};h.propTypes={width:r.default.oneOfType([r.default.string,r.default.number]),triangle:r.default.oneOf(["hide","top-left","top-right"]),colors:r.default.arrayOf(r.default.string),styles:r.default.object},h.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}},e.default=(0,u.ColorWrap)(h)},function(t,e,n){t.exports=function(t){"use strict";function e(t,e,n,i,r){return[t,e,n,i+"px",r].join(" ")}function n(t){return void 0===t}return function(i){function r(n){void 0===n&&(n={});var r=n.align;void 0===r&&(r="center");var a=n.anisotropy,o=n.createCanvas;void 0===o&&(o=function(){return document.createElement("canvas")});var s=n.fillStyle;void 0===s&&(s="#fff");var l=n.fontFamily;void 0===l&&(l="sans-serif");var u=n.fontSize;void 0===u&&(u=16);var c=n.fontStyle;void 0===c&&(c="normal");var h=n.fontVariant;void 0===h&&(h="normal");var d=n.fontWeight;void 0===d&&(d="normal");var f=n.format,p=n.lineGap;void 0===p&&(p=.15);var m=n.loadFontFace;void 0===m&&(m=function(t,n,i,r){var a=e(n,i,r,1,t);return document.fonts.load(a)});var g=n.magFilter;void 0===g&&(g=t.LinearFilter);var v=n.mapping,y=n.minFilter;void 0===y&&(y=t.LinearFilter);var b=n.padding;void 0===b&&(b=.25);var x=n.strokeStyle;void 0===x&&(x="#000");var _=n.strokeWidth;void 0===_&&(_=0);var w=n.text;void 0===w&&(w="");var S,E,M=n.type,C=n.wrapS,T=n.wrapT;i.call(this,o(),v,C,T,g,y,f,M,a),this._align=r,this._fillStyle=s,this._fontFamily=l,this._fontSize=u,this._fontStyle=c,this._fontVariant=h,this._fontWeight=d,this._lineGap=p,this._padding=b,this._strokeStyle=x,this._strokeWidth=_,this._text=w,this.createCanvas=o,this.loadFontFace=m,this.redraw=(S=this.redrawNow,function(){for(var t=this,e=[],n=arguments.length;n--;)e[n]=arguments[n];return E||(E=new Promise((function(t){setTimeout(t,0)})).then((function(){return S.apply(t,e)})).finally((function(){E=void 0}))),E}),this.redrawNow()}i&&(r.__proto__=i),r.prototype=Object.create(i&&i.prototype),r.prototype.constructor=r;var a={text:{configurable:!0},lines:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontWeight:{configurable:!0},fontVariant:{configurable:!0},fontStyle:{configurable:!0},font:{configurable:!0},fillStyle:{configurable:!0},strokeWidth:{configurable:!0},strokeWidthInPixels:{configurable:!0},strokeStyle:{configurable:!0},align:{configurable:!0},lineGap:{configurable:!0},lineGapInPixels:{configurable:!0},padding:{configurable:!0},paddingInPixels:{configurable:!0},textWidthInPixels:{configurable:!0},textHeight:{configurable:!0},textHeightInPixels:{configurable:!0},widthInPixels:{configurable:!0},height:{configurable:!0},heightInPixels:{configurable:!0}};return a.text.get=function(){return this._text},a.text.set=function(t){this._text!==t&&(this._text=t,this._lines=void 0,this._textWidthInPixels=void 0,this.redraw())},a.lines.get=function(){return n(this._lines)&&(this._lines=this.computeLines()),this._lines},r.prototype.computeLines=function(){var t=this.text;return t?t.split("\n"):[]},a.fontFamily.get=function(){return this._fontFamily},a.fontFamily.set=function(t){this._fontFamily!==t&&(this._fontFamily=t,this._textWidthInPixels=void 0,this.redraw())},a.fontSize.get=function(){return this._fontSize},a.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this._textWidthInPixels=void 0,this.redraw())},a.fontWeight.get=function(){return this._fontWeight},a.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this._textWidthInPixels=void 0,this.redraw())},a.fontVariant.get=function(){return this._fontVariant},a.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this._textWidthInPixels=void 0,this.redraw())},a.fontStyle.get=function(){return this._fontStyle},a.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this._textWidthInPixels=void 0,this.redraw())},a.font.get=function(){return e(this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily)},a.fillStyle.get=function(){return this._fillStyle},a.fillStyle.set=function(t){this._fillStyle!==t&&(this._fillStyle=t,this.redraw())},a.strokeWidth.get=function(){return this._strokeWidth},a.strokeWidth.set=function(t){this._strokeWidth!==t&&(this._strokeWidth=t,this.redraw())},a.strokeWidthInPixels.get=function(){return this._strokeWidth*this.fontSize},a.strokeStyle.get=function(){return this._strokeStyle},a.strokeStyle.set=function(t){this._strokeStyle!==t&&(this._strokeStyle=t,this.redraw())},a.align.get=function(){return this._align},a.align.set=function(t){this._align!==t&&(this._align=t,this.redraw())},a.lineGap.get=function(){return this._lineGap},a.lineGap.set=function(t){this._lineGap!==t&&(this._lineGap=t,this.redraw())},a.lineGapInPixels.get=function(){return this.fontSize*this.lineGap},a.padding.get=function(){return this._padding},a.padding.set=function(t){this._padding!==t&&(this._padding=t,this.redraw())},a.paddingInPixels.get=function(){return this.padding*this.fontSize},a.textWidthInPixels.get=function(){return n(this._textWidthInPixels)&&(this._textWidthInPixels=this.computeTextWidthInPixels()),this._textWidthInPixels},r.prototype.computeTextWidthInPixels=function(){var t=this.createCanvas,e=this.font,n=this.lines;if(n.length){var i=t().getContext("2d");return i.font=e,n.map((function(t){return i.measureText(t).width})).reduce((function(t,e){return Math.max(t,e)}))}return 0},a.textHeight.get=function(){var t=this.lineGap,e=this.lines;return e.length?e.length+t*(e.length-1):0},a.textHeightInPixels.get=function(){return this.textHeight*this.fontSize},a.widthInPixels.get=function(){return this.textWidthInPixels+this.strokeWidthInPixels+2*this.paddingInPixels},a.height.get=function(){return this.textHeight+this.strokeWidth+2*this.padding},a.heightInPixels.get=function(){return this.height*this.fontSize},r.prototype.redrawNow=function(){var t=this;return Promise.resolve().then((function(){return t.loadFontFace(t.fontFamily,t.fontStyle,t.fontVariant,t.fontWeight)})).then((function(){var e=t.image,n=e.getContext("2d");if(n.clearRect(0,0,e.width,e.height),t.widthInPixels&&t.heightInPixels){var i;switch(e.width=t.widthInPixels,e.height=t.heightInPixels,n.font=t.font,n.textBaseline="middle",t.align){case"left":n.textAlign="left",i=t.paddingInPixels+t.strokeWidthInPixels/2;break;case"right":n.textAlign="right",i=t.paddingInPixels+t.strokeWidthInPixels/2+t.textWidthInPixels;break;case"center":n.textAlign="center",i=t.paddingInPixels+t.strokeWidthInPixels/2+t.textWidthInPixels/2}var r=t.paddingInPixels+t.strokeWidthInPixels/2+t.fontSize/2;n.fillStyle=t.fillStyle,n.miterLimit=1,n.lineWidth=t.strokeWidthInPixels,n.strokeStyle=t.strokeStyle,t.lines.forEach((function(e){t.strokeWidthInPixels&&n.strokeText(e,i,r),n.fillText(e,i,r),r+=t.fontSize+t.lineGapInPixels}))}else e.width=e.height=1;t.needsUpdate=!0}))},Object.defineProperties(r.prototype,a),r}(t.Texture)}(n(1))},function(t,e){},function(t,e,n){"use strict";n.r(e),n.d(e,"Node",(function(){return it})),n.d(e,"Parser",(function(){return V})),n.d(e,"Position",(function(){return I})),n.d(e,"SourceLocation",(function(){return N})),n.d(e,"TokContext",(function(){return ot})),n.d(e,"Token",(function(){return Pt})),n.d(e,"TokenType",(function(){return g})),n.d(e,"defaultOptions",(function(){return z})),n.d(e,"getLineInfo",(function(){return D})),n.d(e,"isIdentifierChar",(function(){return m})),n.d(e,"isIdentifierStart",(function(){return p})),n.d(e,"isNewLine",(function(){return M})),n.d(e,"keywordTypes",(function(){return x})),n.d(e,"lineBreak",(function(){return S})),n.d(e,"lineBreakG",(function(){return E})),n.d(e,"nonASCIIwhitespace",(function(){return C})),n.d(e,"parse",(function(){return It})),n.d(e,"parseExpressionAt",(function(){return Nt})),n.d(e,"tokContexts",(function(){return st})),n.d(e,"tokTypes",(function(){return w})),n.d(e,"tokenizer",(function(){return Dt})),n.d(e,"version",(function(){return Rt}));var i={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},r="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",a={5:r,"5module":r+" export import",6:r+" const class extends export import super"},o=/^in(stanceof)?$/,s="---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",l="--------------------------------------------------------------------------------------------------------------------------------------------------",u=new RegExp("["+s+"]"),c=new RegExp("["+s+l+"]");s=l=null;var h=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,155,22,13,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,0,33,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,0,161,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,754,9486,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],d=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,232,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,792487,239];function f(t,e){for(var n=65536,i=0;i<e.length;i+=2){if((n+=e[i])>t)return!1;if((n+=e[i+1])>=t)return!0}}function p(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&u.test(String.fromCharCode(t)):!1!==e&&f(t,h)))}function m(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):!1!==e&&(f(t,h)||f(t,d)))))}var g=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function v(t,e){return new g(t,{beforeExpr:!0,binop:e})}var y={beforeExpr:!0},b={startsExpr:!0},x={};function _(t,e){return void 0===e&&(e={}),e.keyword=t,x[t]=new g(t,e)}var w={num:new g("num",b),regexp:new g("regexp",b),string:new g("string",b),name:new g("name",b),eof:new g("eof"),bracketL:new g("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new g("]"),braceL:new g("{",{beforeExpr:!0,startsExpr:!0}),braceR:new g("}"),parenL:new g("(",{beforeExpr:!0,startsExpr:!0}),parenR:new g(")"),comma:new g(",",y),semi:new g(";",y),colon:new g(":",y),dot:new g("."),question:new g("?",y),arrow:new g("=>",y),template:new g("template"),invalidTemplate:new g("invalidTemplate"),ellipsis:new g("...",y),backQuote:new g("`",b),dollarBraceL:new g("${",{beforeExpr:!0,startsExpr:!0}),eq:new g("=",{beforeExpr:!0,isAssign:!0}),assign:new g("_=",{beforeExpr:!0,isAssign:!0}),incDec:new g("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new g("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:v("||",1),logicalAND:v("&&",2),bitwiseOR:v("|",3),bitwiseXOR:v("^",4),bitwiseAND:v("&",5),equality:v("==/!=/===/!==",6),relational:v("</>/<=/>=",7),bitShift:v("<</>>/>>>",8),plusMin:new g("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:v("%",10),star:v("*",10),slash:v("/",10),starstar:new g("**",{beforeExpr:!0}),_break:_("break"),_case:_("case",y),_catch:_("catch"),_continue:_("continue"),_debugger:_("debugger"),_default:_("default",y),_do:_("do",{isLoop:!0,beforeExpr:!0}),_else:_("else",y),_finally:_("finally"),_for:_("for",{isLoop:!0}),_function:_("function",b),_if:_("if"),_return:_("return",y),_switch:_("switch"),_throw:_("throw",y),_try:_("try"),_var:_("var"),_const:_("const"),_while:_("while",{isLoop:!0}),_with:_("with"),_new:_("new",{beforeExpr:!0,startsExpr:!0}),_this:_("this",b),_super:_("super",b),_class:_("class",b),_extends:_("extends",y),_export:_("export"),_import:_("import",b),_null:_("null",b),_true:_("true",b),_false:_("false",b),_in:_("in",{beforeExpr:!0,binop:7}),_instanceof:_("instanceof",{beforeExpr:!0,binop:7}),_typeof:_("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:_("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:_("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},S=/\r\n?|\n|\u2028|\u2029/,E=new RegExp(S.source,"g");function M(t,e){return 10===t||13===t||!e&&(8232===t||8233===t)}var C=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,T=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,k=Object.prototype,P=k.hasOwnProperty,A=k.toString;function O(t,e){return P.call(t,e)}var L=Array.isArray||function(t){return"[object Array]"===A.call(t)};function R(t){return new RegExp("^(?:"+t.replace(/ /g,"|")+")$")}var I=function(t,e){this.line=t,this.column=e};I.prototype.offset=function(t){return new I(this.line,this.column+t)};var N=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function D(t,e){for(var n=1,i=0;;){E.lastIndex=i;var r=E.exec(t);if(!(r&&r.index<e))return new I(n,e-i);++n,i=r.index+r[0].length}}var z={ecmaVersion:9,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function B(t){var e={};for(var n in z)e[n]=t&&O(t,n)?t[n]:z[n];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),L(e.onToken)){var i=e.onToken;e.onToken=function(t){return i.push(t)}}return L(e.onComment)&&(e.onComment=function(t,e){return function(n,i,r,a,o,s){var l={type:n?"Block":"Line",value:i,start:r,end:a};t.locations&&(l.loc=new N(this,o,s)),t.ranges&&(l.range=[r,a]),e.push(l)}}(e,e.onComment)),e}function F(t,e){return 2|(t?4:0)|(e?8:0)}var V=function(t,e,n){this.options=t=B(t),this.sourceFile=t.sourceFile,this.keywords=R(a[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var r="";if(!0!==t.allowReserved){for(var o=t.ecmaVersion;!(r=i[o]);o--);"module"===t.sourceType&&(r+=" await")}this.reservedWords=R(r);var s=(r?r+" ":"")+i.strict;this.reservedWordsStrict=R(s),this.reservedWordsStrictBind=R(s+" "+i.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(S).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=w.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},j={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};V.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},j.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},j.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},j.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},j.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},j.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},j.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},V.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},V.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,i=0;i<t.length;i++)n=t[i](n);return n},V.parse=function(t,e){return new this(e,t).parse()},V.parseExpressionAt=function(t,e,n){var i=new this(n,t,e);return i.nextToken(),i.parseExpression()},V.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(V.prototype,j);var U=V.prototype,H=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function G(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}U.strictDirective=function(t){for(;;){T.lastIndex=t,t+=T.exec(this.input)[0].length;var e=H.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2]))return!0;t+=e[0].length,T.lastIndex=t,t+=T.exec(this.input)[0].length,";"===this.input[t]&&t++}},U.eat=function(t){return this.type===t&&(this.next(),!0)},U.isContextual=function(t){return this.type===w.name&&this.value===t&&!this.containsEsc},U.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},U.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},U.canInsertSemicolon=function(){return this.type===w.eof||this.type===w.braceR||S.test(this.input.slice(this.lastTokEnd,this.start))},U.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},U.semicolon=function(){this.eat(w.semi)||this.insertSemicolon()||this.unexpected()},U.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},U.expect=function(t){this.eat(t)||this.unexpected()},U.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},U.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},U.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,i=t.doubleProto;if(!e)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")},U.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},U.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var W=V.prototype;W.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==w.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var a=r[i];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var q={kind:"loop"},$={kind:"switch"};W.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;T.lastIndex=this.pos;var e=T.exec(this.input),n=this.pos+e[0].length,i=this.input.charCodeAt(n);if(91===i)return!0;if(t)return!1;if(123===i)return!0;if(p(i,!0)){for(var r=n+1;m(this.input.charCodeAt(r),!0);)++r;var a=this.input.slice(n,r);if(!o.test(a))return!0}return!1},W.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;T.lastIndex=this.pos;var t=T.exec(this.input),e=this.pos+t[0].length;return!(S.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!==this.input.length&&m(this.input.charAt(e+8)))},W.parseStatement=function(t,e,n){var i,r=this.type,a=this.startNode();switch(this.isLet(t)&&(r=w._var,i="let"),r){case w._break:case w._continue:return this.parseBreakContinueStatement(a,r.keyword);case w._debugger:return this.parseDebuggerStatement(a);case w._do:return this.parseDoStatement(a);case w._for:return this.parseForStatement(a);case w._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!t);case w._class:return t&&this.unexpected(),this.parseClass(a,!0);case w._if:return this.parseIfStatement(a);case w._return:return this.parseReturnStatement(a);case w._switch:return this.parseSwitchStatement(a);case w._throw:return this.parseThrowStatement(a);case w._try:return this.parseTryStatement(a);case w._const:case w._var:return i=i||this.value,t&&"var"!==i&&this.unexpected(),this.parseVarStatement(a,i);case w._while:return this.parseWhileStatement(a);case w._with:return this.parseWithStatement(a);case w.braceL:return this.parseBlock(!0,a);case w.semi:return this.parseEmptyStatement(a);case w._export:case w._import:if(this.options.ecmaVersion>10&&r===w._import){T.lastIndex=this.pos;var o=T.exec(this.input),s=this.pos+o[0].length;if(40===this.input.charCodeAt(s))return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===w._import?this.parseImport(a):this.parseExport(a,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!t);var l=this.value,u=this.parseExpression();return r===w.name&&"Identifier"===u.type&&this.eat(w.colon)?this.parseLabeledStatement(a,l,u,t):this.parseExpressionStatement(a,u)}},W.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(w.semi)||this.insertSemicolon()?t.label=null:this.type!==w.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if(null==t.label||r.name===t.label.name){if(null!=r.kind&&(n||"loop"===r.kind))break;if(t.label&&n)break}}return i===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},W.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},W.parseDoStatement=function(t){return this.next(),this.labels.push(q),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(w._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(w.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},W.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(q),this.enterScope(0),this.expect(w.parenL),this.type===w.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===w._var||this.type===w._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===i.declarations.length?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,i)):(e>-1&&this.unexpected(e),this.parseFor(t,i))}var a=new G,o=this.parseExpression(!0,a);return this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):t.await=e>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(t,o)):(this.checkExpressionErrors(a,!0),e>-1&&this.unexpected(e),this.parseFor(t,o))},W.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,Y|(n?0:X),!1,e)},W.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(w._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},W.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(w.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},W.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(w.braceL),this.labels.push($),this.enterScope(0);for(var n=!1;this.type!==w.braceR;)if(this.type===w._case||this.type===w._default){var i=this.type===w._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(w.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},W.parseThrowStatement=function(t){return this.next(),S.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var Q=[];W.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===w._catch){var e=this.startNode();if(this.next(),this.eat(w.parenL)){e.param=this.parseBindingAtom();var n="Identifier"===e.param.type;this.enterScope(n?32:0),this.checkLVal(e.param,n?4:2),this.expect(w.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0);e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(w._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},W.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},W.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(q),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},W.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},W.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},W.parseLabeledStatement=function(t,e,n,i){for(var r=0,a=this.labels;r<a.length;r+=1){a[r].name===e&&this.raise(n.start,"Label '"+e+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===w._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var l=this.labels[s];if(l.statementStart!==t.start)break;l.statementStart=this.start,l.kind=o}return this.labels.push({name:e,kind:o,statementStart:this.start}),t.body=this.parseStatement(i?-1===i.indexOf("label")?i+"label":i:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},W.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},W.parseBlock=function(t,e){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(w.braceL),t&&this.enterScope(0);!this.eat(w.braceR);){var n=this.parseStatement(null);e.body.push(n)}return t&&this.exitScope(),this.finishNode(e,"BlockStatement")},W.parseFor=function(t,e){return t.init=e,this.expect(w.semi),t.test=this.type===w.semi?null:this.parseExpression(),this.expect(w.semi),t.update=this.type===w.parenR?null:this.parseExpression(),this.expect(w.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},W.parseForIn=function(t,e){var n=this.type===w._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)?this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===e.type&&this.raise(e.start,"Invalid left-hand side in for-loop"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(w.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},W.parseVar=function(t,e,n){for(t.declarations=[],t.kind=n;;){var i=this.startNode();if(this.parseVarId(i,n),this.eat(w.eq)?i.init=this.parseMaybeAssign(e):"const"!==n||this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===i.id.type||e&&(this.type===w._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(w.comma))break}return t},W.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLVal(t.id,"var"===e?1:2,!1)};var Y=1,X=2;W.parseFunction=function(t,e,n,i){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===w.star&&e&X&&this.unexpected(),t.generator=this.eat(w.star)),this.options.ecmaVersion>=8&&(t.async=!!i),e&Y&&(t.id=4&e&&this.type!==w.name?null:this.parseIdent(),!t.id||e&X||this.checkLVal(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var r=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(F(t.async,t.generator)),e&Y||(t.id=this.type===w.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,e&Y?"FunctionDeclaration":"FunctionExpression")},W.parseFunctionParams=function(t){this.expect(w.parenL),t.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},W.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var i=this.startNode(),r=!1;for(i.body=[],this.expect(w.braceL);!this.eat(w.braceR);){var a=this.parseClassElement(null!==t.superClass);a&&(i.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind&&(r&&this.raise(a.start,"Duplicate constructor in the same class"),r=!0))}return t.body=this.finishNode(i,"ClassBody"),this.strict=n,this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},W.parseClassElement=function(t){var e=this;if(this.eat(w.semi))return null;var n=this.startNode(),i=function(t,i){void 0===i&&(i=!1);var r=e.start,a=e.startLoc;return!!e.eatContextual(t)&&(!(e.type===w.parenL||i&&e.canInsertSemicolon())||(n.key&&e.unexpected(),n.computed=!1,n.key=e.startNodeAt(r,a),n.key.name=t,e.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=i("static");var r=this.eat(w.star),a=!1;r||(this.options.ecmaVersion>=8&&i("async",!0)?(a=!0,r=this.options.ecmaVersion>=9&&this.eat(w.star)):i("get")?n.kind="get":i("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var o=n.key,s=!1;return n.computed||n.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?n.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),r&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),n.kind="constructor",s=t),this.parseClassMethod(n,r,a,s),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},W.parseClassMethod=function(t,e,n,i){return t.value=this.parseMethod(e,n,i),this.finishNode(t,"MethodDefinition")},W.parseClassId=function(t,e){this.type===w.name?(t.id=this.parseIdent(),e&&this.checkLVal(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},W.parseClassSuper=function(t){t.superClass=this.eat(w._extends)?this.parseExprSubscripts():null},W.parseExport=function(t,e){if(this.next(),this.eat(w.star))return this.expectContextual("from"),this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(w._default)){var n;if(this.checkExport(e,"default",this.lastTokStart),this.type===w._function||(n=this.isAsyncFunction())){var i=this.startNode();this.next(),n&&this.next(),t.declaration=this.parseFunction(i,4|Y,!1,n)}else if(this.type===w._class){var r=this.startNode();t.declaration=this.parseClass(r,"nullableID")}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(null),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var a=0,o=t.specifiers;a<o.length;a+=1){var s=o[a];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},W.checkExport=function(t,e,n){t&&(O(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},W.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e.name,e.start);else if("ObjectPattern"===n)for(var i=0,r=e.properties;i<r.length;i+=1){var a=r[i];this.checkPatternExport(t,a)}else if("ArrayPattern"===n)for(var o=0,s=e.elements;o<s.length;o+=1){var l=s[o];l&&this.checkPatternExport(t,l)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(t,e.expression)},W.checkVariableExport=function(t,e){if(t)for(var n=0,i=e;n<i.length;n+=1){var r=i[n];this.checkPatternExport(t,r.id)}},W.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},W.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(w.braceL);!this.eat(w.braceR);){if(n)n=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var i=this.startNode();i.local=this.parseIdent(!0),i.exported=this.eatContextual("as")?this.parseIdent(!0):i.local,this.checkExport(t,i.exported.name,i.exported.start),e.push(this.finishNode(i,"ExportSpecifier"))}return e},W.parseImport=function(t){return this.next(),this.type===w.string?(t.specifiers=Q,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===w.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},W.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===w.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),t.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(w.comma))return t}if(this.type===w.star){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLVal(i.local,2),t.push(this.finishNode(i,"ImportNamespaceSpecifier")),t}for(this.expect(w.braceL);!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var r=this.startNode();r.imported=this.parseIdent(!0),this.eatContextual("as")?r.local=this.parseIdent():(this.checkUnreserved(r.imported),r.local=r.imported),this.checkLVal(r.local,2),t.push(this.finishNode(r,"ImportSpecifier"))}return t},W.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},W.isDirectiveCandidate=function(t){return"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var Z=V.prototype;Z.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=t.properties;i<r.length;i+=1){var a=r[i];this.toAssignable(a,e),"RestElement"!==a.type||"ArrayPattern"!==a.argument.type&&"ObjectPattern"!==a.argument.type||this.raise(a.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},Z.toAssignableList=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];r&&this.toAssignable(r,e)}if(n){var a=t[n-1];6===this.options.ecmaVersion&&e&&a&&"RestElement"===a.type&&"Identifier"!==a.argument.type&&this.unexpected(a.argument.start)}return t},Z.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},Z.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==w.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},Z.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case w.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(w.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case w.braceL:return this.parseObj(!0)}return this.parseIdent()},Z.parseBindingList=function(t,e,n){for(var i=[],r=!0;!this.eat(t);)if(r?r=!1:this.expect(w.comma),e&&this.type===w.comma)i.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===w.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),i.push(a),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),i.push(o)}return i},Z.parseBindingListItem=function(t){return t},Z.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(w.eq))return n;var i=this.startNodeAt(t,e);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},Z.checkLVal=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"Identifier":2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(O(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),0!==e&&5!==e&&this.declareName(t.name,e,t.start);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ObjectPattern":for(var i=0,r=t.properties;i<r.length;i+=1){var a=r[i];this.checkLVal(a,e,n)}break;case"Property":this.checkLVal(t.value,e,n);break;case"ArrayPattern":for(var o=0,s=t.elements;o<s.length;o+=1){var l=s[o];l&&this.checkLVal(l,e,n)}break;case"AssignmentPattern":this.checkLVal(t.left,e,n);break;case"RestElement":this.checkLVal(t.argument,e,n);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,n);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var J=V.prototype;J.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var i,r=t.key;switch(r.type){case"Identifier":i=r.name;break;case"Literal":i=String(r.value);break;default:return}var a=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===i&&"init"===a&&(e.proto&&(n&&n.doubleProto<0?n.doubleProto=r.start:this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),e.proto=!0);else{var o=e[i="$"+i];if(o)("init"===a?this.strict&&o.init||o.get||o.set:o.init||o[a])&&this.raiseRecoverable(r.start,"Redefinition of property");else o=e[i]={init:!1,get:!1,set:!1};o[a]=!0}}},J.parseExpression=function(t,e){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(t,e);if(this.type===w.comma){var a=this.startNodeAt(n,i);for(a.expressions=[r];this.eat(w.comma);)a.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(a,"SequenceExpression")}return r},J.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var i=!1,r=-1,a=-1,o=-1;e?(r=e.parenthesizedAssign,a=e.trailingComma,o=e.shorthandAssign,e.parenthesizedAssign=e.trailingComma=e.shorthandAssign=-1):(e=new G,i=!0);var s=this.start,l=this.startLoc;this.type!==w.parenL&&this.type!==w.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(t,e);if(n&&(u=n.call(this,u,s,l)),this.type.isAssign){var c=this.startNodeAt(s,l);return c.operator=this.value,c.left=this.type===w.eq?this.toAssignable(u,!1,e):u,i||G.call(e),e.shorthandAssign=-1,this.checkLVal(u),this.next(),c.right=this.parseMaybeAssign(t),this.finishNode(c,"AssignmentExpression")}return i&&this.checkExpressionErrors(e,!0),r>-1&&(e.parenthesizedAssign=r),a>-1&&(e.trailingComma=a),o>-1&&(e.shorthandAssign=o),u},J.parseMaybeConditional=function(t,e){var n=this.start,i=this.startLoc,r=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return r;if(this.eat(w.question)){var a=this.startNodeAt(n,i);return a.test=r,a.consequent=this.parseMaybeAssign(),this.expect(w.colon),a.alternate=this.parseMaybeAssign(t),this.finishNode(a,"ConditionalExpression")}return r},J.parseExprOps=function(t,e){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)||r.start===n&&"ArrowFunctionExpression"===r.type?r:this.parseExprOp(r,n,i,-1,t)},J.parseExprOp=function(t,e,n,i,r){var a=this.type.binop;if(null!=a&&(!r||this.type!==w._in)&&a>i){var o=this.type===w.logicalOR||this.type===w.logicalAND,s=this.value;this.next();var l=this.start,u=this.startLoc,c=this.parseExprOp(this.parseMaybeUnary(null,!1),l,u,a,r),h=this.buildBinary(e,n,t,c,s,o);return this.parseExprOp(h,e,n,i,r)}return t},J.buildBinary=function(t,e,n,i,r,a){var o=this.startNodeAt(t,e);return o.left=n,o.operator=r,o.right=i,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")},J.parseMaybeUnary=function(t,e){var n,i=this.start,r=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),e=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===w.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),o?this.checkLVal(a.argument):this.strict&&"delete"===a.operator&&"Identifier"===a.argument.type?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):e=!0,n=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(i,r);s.operator=this.value,s.prefix=!1,s.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(s,"UpdateExpression")}}return!e&&this.eat(w.starstar)?this.buildBinary(i,r,n,this.parseMaybeUnary(null,!1),"**",!1):n},J.parseExprSubscripts=function(t){var e=this.start,n=this.startLoc,i=this.parseExprAtom(t),r="ArrowFunctionExpression"===i.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||r)return i;var a=this.parseSubscripts(i,e,n);return t&&"MemberExpression"===a.type&&(t.parenthesizedAssign>=a.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=a.start&&(t.parenthesizedBind=-1)),a},J.parseSubscripts=function(t,e,n,i){for(var r=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&"async"===this.input.slice(t.start,t.end);;){var a=this.parseSubscript(t,e,n,i,r);if(a===t||"ArrowFunctionExpression"===a.type)return a;t=a}},J.parseSubscript=function(t,e,n,i,r){var a=this.eat(w.bracketL);if(a||this.eat(w.dot)){var o=this.startNodeAt(e,n);o.object=t,o.property=a?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),o.computed=!!a,a&&this.expect(w.bracketR),t=this.finishNode(o,"MemberExpression")}else if(!i&&this.eat(w.parenL)){var s=new G,l=this.yieldPos,u=this.awaitPos,c=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var h=this.parseExprList(w.parenR,this.options.ecmaVersion>=8&&"Import"!==t.type,!1,s);if(r&&!this.canInsertSemicolon()&&this.eat(w.arrow))return this.checkPatternErrors(s,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=l,this.awaitPos=u,this.awaitIdentPos=c,this.parseArrowExpression(this.startNodeAt(e,n),h,!0);this.checkExpressionErrors(s,!0),this.yieldPos=l||this.yieldPos,this.awaitPos=u||this.awaitPos,this.awaitIdentPos=c||this.awaitIdentPos;var d=this.startNodeAt(e,n);if(d.callee=t,d.arguments=h,"Import"===d.callee.type){1!==d.arguments.length&&this.raise(d.start,"import() requires exactly one argument");var f=d.arguments[0];f&&"SpreadElement"===f.type&&this.raise(f.start,"... is not allowed in import()")}t=this.finishNode(d,"CallExpression")}else if(this.type===w.backQuote){var p=this.startNodeAt(e,n);p.tag=t,p.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(p,"TaggedTemplateExpression")}return t},J.parseExprAtom=function(t){this.type===w.slash&&this.readRegexp();var e,n=this.potentialArrowAt===this.start;switch(this.type){case w._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),e=this.startNode(),this.next(),this.type!==w.parenL||this.allowDirectSuper||this.raise(e.start,"super() call outside constructor of a subclass"),this.type!==w.dot&&this.type!==w.bracketL&&this.type!==w.parenL&&this.unexpected(),this.finishNode(e,"Super");case w._this:return e=this.startNode(),this.next(),this.finishNode(e,"ThisExpression");case w.name:var i=this.start,r=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(w._function))return this.parseFunction(this.startNodeAt(i,r),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(w.arrow))return this.parseArrowExpression(this.startNodeAt(i,r),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===w.name&&!a)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(w.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(i,r),[o],!0)}return o;case w.regexp:var s=this.value;return(e=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},e;case w.num:case w.string:return this.parseLiteral(this.value);case w._null:case w._true:case w._false:return(e=this.startNode()).value=this.type===w._null?null:this.type===w._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case w.parenL:var l=this.start,u=this.parseParenAndDistinguishExpression(n);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(t.parenthesizedAssign=l),t.parenthesizedBind<0&&(t.parenthesizedBind=l)),u;case w.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(w.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case w.braceL:return this.parseObj(!1,t);case w._function:return e=this.startNode(),this.next(),this.parseFunction(e,0);case w._class:return this.parseClass(this.startNode(),!1);case w._new:return this.parseNew();case w.backQuote:return this.parseTemplate();case w._import:return this.options.ecmaVersion>10?this.parseDynamicImport():this.unexpected();default:this.unexpected()}},J.parseDynamicImport=function(){var t=this.startNode();return this.next(),this.type!==w.parenL&&this.unexpected(),this.finishNode(t,"Import")},J.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1)),this.next(),this.finishNode(e,"Literal")},J.parseParenExpression=function(){this.expect(w.parenL);var t=this.parseExpression();return this.expect(w.parenR),t},J.parseParenAndDistinguishExpression=function(t){var e,n=this.start,i=this.startLoc,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,s=this.startLoc,l=[],u=!0,c=!1,h=new G,d=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==w.parenR;){if(u?u=!1:this.expect(w.comma),r&&this.afterTrailingComma(w.parenR,!0)){c=!0;break}if(this.type===w.ellipsis){a=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}l.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var p=this.start,m=this.startLoc;if(this.expect(w.parenR),t&&!this.canInsertSemicolon()&&this.eat(w.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=f,this.parseParenArrowList(n,i,l);l.length&&!c||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=f||this.awaitPos,l.length>1?((e=this.startNodeAt(o,s)).expressions=l,this.finishNodeAt(e,"SequenceExpression",p,m)):e=l[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var g=this.startNodeAt(n,i);return g.expression=e,this.finishNode(g,"ParenthesizedExpression")}return e},J.parseParenItem=function(t){return t},J.parseParenArrowList=function(t,e,n){return this.parseArrowExpression(this.startNodeAt(t,e),n)};var K=[];J.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(w.dot)){t.meta=e;var n=this.containsEsc;return t.property=this.parseIdent(!0),("target"!==t.property.name||n)&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inNonArrowFunction()||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty")}var i=this.start,r=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),i,r,!0),this.options.ecmaVersion>10&&"Import"===t.callee.type&&this.raise(t.callee.start,"Cannot use new with import(...)"),this.eat(w.parenL)?t.arguments=this.parseExprList(w.parenR,this.options.ecmaVersion>=8&&"Import"!==t.callee.type,!1):t.arguments=K,this.finishNode(t,"NewExpression")},J.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===w.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===w.backQuote,this.finishNode(n,"TemplateElement")},J.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:e});for(n.quasis=[i];!i.tail;)this.type===w.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(w.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(w.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},J.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===w.name||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===w.star)&&!S.test(this.input.slice(this.lastTokEnd,this.start))},J.parseObj=function(t,e){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(w.braceR);){if(i)i=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var a=this.parseProperty(t,e);t||this.checkPropClash(a,r,e),n.properties.push(a)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},J.parseProperty=function(t,e){var n,i,r,a,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(w.ellipsis))return t?(o.argument=this.parseIdent(!1),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===w.parenL&&e&&(e.parenthesizedAssign<0&&(e.parenthesizedAssign=this.start),e.parenthesizedBind<0&&(e.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,e),this.type===w.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(t||e)&&(r=this.start,a=this.startLoc),t||(n=this.eat(w.star)));var s=this.containsEsc;return this.parsePropertyName(o),!t&&!s&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(w.star),this.parsePropertyName(o,e)):i=!1,this.parsePropertyValue(o,t,n,i,r,a,e,s),this.finishNode(o,"Property")},J.parsePropertyValue=function(t,e,n,i,r,a,o,s){if((n||i)&&this.type===w.colon&&this.unexpected(),this.eat(w.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===w.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,i);else if(e||s||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===w.comma||this.type===w.braceR)this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||i)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=r),t.kind="init",e?t.value=this.parseMaybeDefault(r,a,t.key):this.type===w.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),t.value=this.parseMaybeDefault(r,a,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected();else{(n||i)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var l="get"===t.kind?0:1;if(t.value.params.length!==l){var u=t.value.start;"get"===t.kind?this.raiseRecoverable(u,"getter should have no params"):this.raiseRecoverable(u,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}},J.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(w.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(w.bracketR),t.key;t.computed=!1}return t.key=this.type===w.num||this.type===w.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},J.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},J.parseMethod=function(t,e,n){var i=this.startNode(),r=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=t),this.options.ecmaVersion>=8&&(i.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|F(e,i.generator)|(n?128:0)),this.expect(w.parenL),i.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")},J.parseArrowExpression=function(t,e,n){var i=this.yieldPos,r=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(16|F(n,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1),this.yieldPos=i,this.awaitPos=r,this.awaitIdentPos=a,this.finishNode(t,"ArrowFunctionExpression")},J.parseFunctionBody=function(t,e,n){var i=e&&this.type!==w.braceL,r=this.strict,a=!1;if(i)t.body=this.parseMaybeAssign(),t.expression=!0,this.checkParams(t,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);r&&!o||(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(t,!r&&!a&&!e&&!n&&this.isSimpleParamList(t.params)),t.body=this.parseBlock(!1),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=s}this.exitScope(),this.strict&&t.id&&this.checkLVal(t.id,5),this.strict=r},J.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1){if("Identifier"!==n[e].type)return!1}return!0},J.checkParams=function(t,e){for(var n={},i=0,r=t.params;i<r.length;i+=1){var a=r[i];this.checkLVal(a,1,e?null:n)}},J.parseExprList=function(t,e,n,i){for(var r=[],a=!0;!this.eat(t);){if(a)a=!1;else if(this.expect(w.comma),e&&this.afterTrailingComma(t))break;var o=void 0;n&&this.type===w.comma?o=null:this.type===w.ellipsis?(o=this.parseSpread(i),i&&this.type===w.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r},J.checkUnreserved=function(t){var e=t.start,n=t.end,i=t.name;(this.inGenerator&&"yield"===i&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===i&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(i)&&this.raise(e,"Unexpected keyword '"+i+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(i)&&(this.inAsync||"await"!==i||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+i+"' is reserved"))},J.parseIdent=function(t,e){var n=this.startNode();return this.type===w.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(),this.finishNode(n,"Identifier"),t||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},J.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===w.semi||this.canInsertSemicolon()||this.type!==w.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(w.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},J.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var tt=V.prototype;tt.raise=function(t,e){var n=D(this.input,t);e+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=n,i.raisedAt=this.pos,i},tt.raiseRecoverable=tt.raise,tt.curPosition=function(){if(this.options.locations)return new I(this.curLine,this.pos-this.lineStart)};var et=V.prototype,nt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};et.enterScope=function(t){this.scopeStack.push(new nt(t))},et.exitScope=function(){this.scopeStack.pop()},et.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},et.declareName=function(t,e,n){var i=!1;if(2===e){var r=this.currentScope();i=r.lexical.indexOf(t)>-1||r.functions.indexOf(t)>-1||r.var.indexOf(t)>-1,r.lexical.push(t),this.inModule&&1&r.flags&&delete this.undefinedExports[t]}else if(4===e){this.currentScope().lexical.push(t)}else if(3===e){var a=this.currentScope();i=this.treatFunctionsAsVar?a.lexical.indexOf(t)>-1:a.lexical.indexOf(t)>-1||a.var.indexOf(t)>-1,a.functions.push(t)}else for(var o=this.scopeStack.length-1;o>=0;--o){var s=this.scopeStack[o];if(s.lexical.indexOf(t)>-1&&!(32&s.flags&&s.lexical[0]===t)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(t)>-1){i=!0;break}if(s.var.push(t),this.inModule&&1&s.flags&&delete this.undefinedExports[t],3&s.flags)break}i&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},et.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},et.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},et.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags)return e}},et.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags&&!(16&e.flags))return e}};var it=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new N(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},rt=V.prototype;function at(t,e,n,i){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=i),this.options.ranges&&(t.range[1]=n),t}rt.startNode=function(){return new it(this,this.start,this.startLoc)},rt.startNodeAt=function(t,e){return new it(this,t,e)},rt.finishNode=function(t,e){return at.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},rt.finishNodeAt=function(t,e,n,i){return at.call(this,t,e,n,i)};var ot=function(t,e,n,i,r){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=i,this.generator=!!r},st={b_stat:new ot("{",!1),b_expr:new ot("{",!0),b_tmpl:new ot("${",!1),p_stat:new ot("(",!1),p_expr:new ot("(",!0),q_tmpl:new ot("`",!0,!0,(function(t){return t.tryReadTemplateToken()})),f_stat:new ot("function",!1),f_expr:new ot("function",!0),f_expr_gen:new ot("function",!0,!1,null,!0),f_gen:new ot("function",!1,!1,null,!0)},lt=V.prototype;lt.initialContext=function(){return[st.b_stat]},lt.braceIsBlock=function(t){var e=this.curContext();return e===st.f_expr||e===st.f_stat||(t!==w.colon||e!==st.b_stat&&e!==st.b_expr?t===w._return||t===w.name&&this.exprAllowed?S.test(this.input.slice(this.lastTokEnd,this.start)):t===w._else||t===w.semi||t===w.eof||t===w.parenR||t===w.arrow||(t===w.braceL?e===st.b_stat:t!==w._var&&t!==w._const&&t!==w.name&&!this.exprAllowed):!e.isExpr)},lt.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},lt.updateContext=function(t){var e,n=this.type;n.keyword&&t===w.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},w.parenR.updateContext=w.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===st.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},w.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?st.b_stat:st.b_expr),this.exprAllowed=!0},w.dollarBraceL.updateContext=function(){this.context.push(st.b_tmpl),this.exprAllowed=!0},w.parenL.updateContext=function(t){var e=t===w._if||t===w._for||t===w._with||t===w._while;this.context.push(e?st.p_stat:st.p_expr),this.exprAllowed=!0},w.incDec.updateContext=function(){},w._function.updateContext=w._class.updateContext=function(t){!t.beforeExpr||t===w.semi||t===w._else||t===w._return&&S.test(this.input.slice(this.lastTokEnd,this.start))||(t===w.colon||t===w.braceL)&&this.curContext()===st.b_stat?this.context.push(st.f_stat):this.context.push(st.f_expr),this.exprAllowed=!1},w.backQuote.updateContext=function(){this.curContext()===st.q_tmpl?this.context.pop():this.context.push(st.q_tmpl),this.exprAllowed=!1},w.star.updateContext=function(t){if(t===w._function){var e=this.context.length-1;this.context[e]===st.f_expr?this.context[e]=st.f_expr_gen:this.context[e]=st.f_gen}this.exprAllowed=!0},w.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==w.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var ut="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ct=ut+" Extended_Pictographic",ht={9:ut,10:ct,11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},dt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ft="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",pt=ft+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",mt={9:ft,10:pt,11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},gt={};function vt(t){var e=gt[t]={binary:R(ht[t]+" "+dt),nonBinary:{General_Category:R(dt),Script:R(mt[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}vt(9),vt(10),vt(11);var yt=V.prototype,bt=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":""),this.unicodeProperties=gt[t.options.ecmaVersion>=11?11:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function xt(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function _t(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function wt(t){return t>=65&&t<=90||t>=97&&t<=122}function St(t){return wt(t)||95===t}function Et(t){return St(t)||Mt(t)}function Mt(t){return t>=48&&t<=57}function Ct(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function Tt(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function kt(t){return t>=48&&t<=55}bt.prototype.reset=function(t,e,n){var i=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchN=i&&this.parser.options.ecmaVersion>=9},bt.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},bt.prototype.at=function(t){var e=this.source,n=e.length;if(t>=n)return-1;var i=e.charCodeAt(t);if(!this.switchU||i<=55295||i>=57344||t+1>=n)return i;var r=e.charCodeAt(t+1);return r>=56320&&r<=57343?(i<<10)+r-56613888:i},bt.prototype.nextIndex=function(t){var e=this.source,n=e.length;if(t>=n)return n;var i,r=e.charCodeAt(t);return!this.switchU||r<=55295||r>=57344||t+1>=n||(i=e.charCodeAt(t+1))<56320||i>57343?t+1:t+2},bt.prototype.current=function(){return this.at(this.pos)},bt.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},bt.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},bt.prototype.eat=function(t){return this.current()===t&&(this.advance(),!0)},yt.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,i=0;i<n.length;i++){var r=n.charAt(i);-1===e.indexOf(r)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(r,i+1)>-1&&this.raise(t.start,"Duplicate regular expression flag")}},yt.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},yt.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var i=n[e];-1===t.groupNames.indexOf(i)&&t.raise("Invalid named capture referenced")}},yt.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},yt.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},yt.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},yt.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},yt.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},yt.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},yt.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue),t.eat(125)))return-1!==r&&r<i&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},yt.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},yt.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},yt.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},yt.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},yt.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},yt.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},yt.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!_t(e)&&(t.lastIntValue=e,t.advance(),!0)},yt.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!_t(n);)t.advance();return t.pos!==e},yt.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e)&&(t.advance(),!0)},yt.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},yt.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},yt.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=xt(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=xt(t.lastIntValue);return!0}return!1},yt.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return p(t,!0)||36===t||95===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},yt.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return m(t,!0)||36===t||95===t||8204===t||8205===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},yt.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},yt.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},yt.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},yt.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},yt.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},yt.regexp_eatZero=function(t){return 48===t.current()&&!Mt(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},yt.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},yt.regexp_eatControlLetter=function(t){var e=t.current();return!!wt(e)&&(t.lastIntValue=e%32,t.advance(),!0)},yt.regexp_eatRegExpUnicodeEscapeSequence=function(t){var e,n=t.pos;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var i=t.lastIntValue;if(t.switchU&&i>=55296&&i<=56319){var r=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var a=t.lastIntValue;if(a>=56320&&a<=57343)return t.lastIntValue=1024*(i-55296)+(a-56320)+65536,!0}t.pos=r,t.lastIntValue=i}return!0}if(t.switchU&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&((e=t.lastIntValue)>=0&&e<=1114111))return!0;t.switchU&&t.raise("Invalid unicode escape"),t.pos=n}return!1},yt.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e)&&(t.lastIntValue=e,t.advance(),!0)},yt.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1},yt.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(function(t){return 100===t||68===t||115===t||83===t||119===t||87===t}(e))return t.lastIntValue=-1,t.advance(),!0;if(t.switchU&&this.options.ecmaVersion>=9&&(80===e||112===e)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(t)&&t.eat(125))return!0;t.raise("Invalid property name")}return!1},yt.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,i),!0}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,r),!0}return!1},yt.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){O(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},yt.regexp_validateUnicodePropertyNameOrValue=function(t,e){t.unicodeProperties.binary.test(e)||t.raise("Invalid property name")},yt.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";St(e=t.current());)t.lastStringValue+=xt(e),t.advance();return""!==t.lastStringValue},yt.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";Et(e=t.current());)t.lastStringValue+=xt(e),t.advance();return""!==t.lastStringValue},yt.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},yt.regexp_eatCharacterClass=function(t){if(t.eat(91)){if(t.eat(94),this.regexp_classRanges(t),t.eat(93))return!0;t.raise("Unterminated character class")}return!1},yt.regexp_classRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},yt.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||kt(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var i=t.current();return 93!==i&&(t.lastIntValue=i,t.advance(),!0)},yt.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},yt.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!Mt(e)&&95!==e)&&(t.lastIntValue=e%32,t.advance(),!0)},yt.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},yt.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Mt(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},yt.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Ct(n=t.current());)t.lastIntValue=16*t.lastIntValue+Tt(n),t.advance();return t.pos!==e},yt.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},yt.regexp_eatOctalDigit=function(t){var e=t.current();return kt(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},yt.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var i=0;i<e;++i){var r=t.current();if(!Ct(r))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+Tt(r),t.advance()}return!0};var Pt=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new N(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},At=V.prototype;function Ot(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}At.next=function(){this.options.onToken&&this.options.onToken(new Pt(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},At.getToken=function(){return this.next(),new Pt(this)},"undefined"!=typeof Symbol&&(At[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===w.eof,value:e}}}}),At.curContext=function(){return this.context[this.context.length-1]},At.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(w.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},At.readToken=function(t){return p(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},At.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||t>=57344?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},At.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),n=this.pos,i=this.input.indexOf("*/",this.pos+=2);if(-1===i&&this.raise(this.pos-2,"Unterminated comment"),this.pos=i+2,this.options.locations)for(E.lastIndex=n;(t=E.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,i),n,this.pos,e,this.curPosition())},At.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!M(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},At.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&C.test(String.fromCharCode(t))))break t;++this.pos}}},At.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},At.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(w.ellipsis)):(++this.pos,this.finishToken(w.dot))},At.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(w.assign,2):this.finishOp(w.slash,1)},At.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,i=42===t?w.star:w.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,i=w.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(w.assign,n+1):this.finishOp(i,n)},At.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?w.logicalOR:w.logicalAND,2):61===e?this.finishOp(w.assign,2):this.finishOp(124===t?w.bitwiseOR:w.bitwiseAND,1)},At.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(w.assign,2):this.finishOp(w.bitwiseXOR,1)},At.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!S.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(w.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(w.assign,2):this.finishOp(w.plusMin,1)},At.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(w.assign,n+1):this.finishOp(w.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(w.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},At.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(w.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(w.arrow)):this.finishOp(61===t?w.eq:w.prefix,1)},At.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(w.parenL);case 41:return++this.pos,this.finishToken(w.parenR);case 59:return++this.pos,this.finishToken(w.semi);case 44:return++this.pos,this.finishToken(w.comma);case 91:return++this.pos,this.finishToken(w.bracketL);case 93:return++this.pos,this.finishToken(w.bracketR);case 123:return++this.pos,this.finishToken(w.braceL);case 125:return++this.pos,this.finishToken(w.braceR);case 58:return++this.pos,this.finishToken(w.colon);case 63:return++this.pos,this.finishToken(w.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(w.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(w.prefix,1)}this.raise(this.pos,"Unexpected character '"+Ot(t)+"'")},At.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},At.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(S.test(i)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===i)e=!0;else if("]"===i&&e)e=!1;else if("/"===i&&!e)break;t="\\"===i}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var s=this.regexpState||(this.regexpState=new bt(this));s.reset(n,r,o),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var l=null;try{l=new RegExp(r,o)}catch(t){}return this.finishToken(w.regexp,{pattern:r,flags:o,value:l})},At.readInt=function(t,e){for(var n=this.pos,i=0,r=0,a=null==e?1/0:e;r<a;++r){var o=this.input.charCodeAt(this.pos),s=void 0;if((s=o>=97?o-97+10:o>=65?o-65+10:o>=48&&o<=57?o-48:1/0)>=t)break;++this.pos,i=i*t+s}return this.pos===n||null!=e&&this.pos-n!==e?null:i},At.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n="undefined"!=typeof BigInt?BigInt(this.input.slice(e,this.pos)):null,++this.pos):p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,n)},At.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number"),n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1);var i=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===i){var r=this.input.slice(e,this.pos),a="undefined"!=typeof BigInt?BigInt(r):null;return++this.pos,p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,a)}46!==i||n||(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||n||(43!==(i=this.input.charCodeAt(++this.pos))&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o=this.input.slice(e,this.pos),s=n?parseInt(o,8):parseFloat(o);return this.finishToken(w.num,s)},At.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},At.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):(M(i,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(w.string,e)};var Lt={};At.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==Lt)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},At.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Lt;this.raise(t,e)},At.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==w.template&&this.type!==w.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(w.template,t)):36===n?(this.pos+=2,this.finishToken(w.dollarBraceL)):(++this.pos,this.finishToken(w.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(M(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},At.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(w.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},At.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Ot(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(n,8);return i>255&&(n=n.slice(0,-1),i=parseInt(n,8)),this.pos+=n.length-1,e=this.input.charCodeAt(this.pos),"0"===n&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-n.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return M(e)?"":String.fromCharCode(e)}},At.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},At.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(m(r,i))this.pos+=r<=65535?1:2;else{if(92!==r)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var a=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?p:m)(o,i)||this.invalidStringToken(a,"Invalid Unicode escape"),t+=Ot(o),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},At.readWord=function(){var t=this.readWord1(),e=w.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=x[t]),this.finishToken(e,t)};var Rt="6.4.2";function It(t,e){return V.parse(t,e)}function Nt(t,e,n){return V.parseExpressionAt(t,e,n)}function Dt(t,e){return V.tokenizer(t,e)}V.acorn={Parser:V,version:Rt,defaultOptions:z,Position:I,SourceLocation:N,getLineInfo:D,Node:it,TokenType:g,tokTypes:w,keywordTypes:x,TokContext:ot,tokContexts:st,isIdentifierChar:m,isIdentifierStart:p,Token:Pt,isNewLine:M,lineBreak:S,lineBreakG:E,nonASCIIwhitespace:C}},function(t,e){},function(t,e){!function(){"use strict";var e=function(t){if(!t)throw new Error("a null element specified.");var e=new n;return i(e,t),e};try{t.exports={element:e}}catch(t){Function("return this;")().svgz_element=e}var n=function(){this._element=null};n.prototype.toTop=function(){try{return r(this._element).insertBefore(this._element,null),this}catch(t){throw t}},n.prototype.toBottom=function(){try{var t=r(this._element),e=s(t);return t.insertBefore(this._element,e[0]),this}catch(t){throw t}},n.prototype.moveUp=function(t){try{if(null==t)t=1;else if("number"!=typeof t){if((t=o(this._element,t))<=0)return}else if(t<=0)throw new Error("Invalid number for n that must be positive.");return this.moveRelative(t)}catch(t){throw t}},n.prototype.moveDown=function(t){try{if(null==t)t=-1;else if("number"!=typeof t){if((t=o(this._element,t))>=0)return}else{if(t<=0)throw new Error("Invalid number for n that must be positive.");t=-t}return this.moveRelative(t)}catch(t){throw t}},n.prototype.moveRelative=function(t){try{if(null==t)throw new Error("Invalid number for n of null.");if("number"!=typeof t)throw new Error("Invalid number for n.");var e=r(this._element),n=a(this._element,t);return e.insertBefore(this._element,n),this}catch(t){throw t}},n.prototype.moveTo=function(t){try{var e=r(this._element),n=s(e),i=n.indexOf(this._element);if(null==t)throw new Error("A position must be specified.");if("number"==typeof t){if(t<0||n.length<t)throw new Error("Invalid position specified.")}else{if(r(t)!==e)throw new Error("The target node not found.");t=n.indexOf(t)}var a=t-i;return this.moveRelative(a)}catch(t){throw t}};var i=function(t,e){t._element=e},r=function(t){if(!("parentNode"in t))throw new Error("There is not parentNode");var e=t.parentNode;if(!e)throw new Error("parentNode is undefined");return e},a=function(t,e){var n=r(t),i=s(n),a=i.length,o=i.indexOf(t),l=o+e;l>o&&(l+=1),l<0?l=0:l>=a&&(l=a);var u=l<a?i[l]:null;if(u&&r(u)!==n)throw new Error("parentNode is different for target.");return u},o=function(t,e){var n=r(t),i=s(n),a=i.indexOf(t),o=i.indexOf(e);if(o<0)throw new Error("parentNode is different for target.");return o-a},s=function(t){var e=[];return Array.from(t.childNodes).map((function(t){1==t.nodeType&&e.push(t)})),e}}()},function(t,e,n){t.exports=function(t){"use strict";let e=class extends t.Texture{constructor(){super(document.createElement("canvas"));let e=null,n=()=>e||(e=this.createDrawable()),i=()=>n().width,r=()=>n().height,a=!0,o=1,s=()=>t.MathUtils.ceilPowerOfTwo(i()*o),l=()=>t.MathUtils.ceilPowerOfTwo(r()*o),u=t=>{if(o!==t){let e=s(),n=l();o=t;let i=s(),r=l();i===e&&r===n||(a=!0)}},c=(()=>{let e=new t.Vector3,n=new t.Vector2,a=new t.Vector3,o=new t.Vector3,s=new t.Vector2;return(l,u,c)=>{if(s.set(i(),r()),s.x&&s.y){l.getWorldPosition(a),c.getWorldPosition(e);let i=a.distanceTo(e);if(c.isPerspectiveCamera&&(i*=2*Math.tan(t.MathUtils.degToRad(c.fov)/2)),(c.isPerspectiveCamera||c.isOrthographicCamera)&&(i/=c.zoom),i){var h,d;l.getWorldScale(o);let t=null!==(h=null===(d=u.capabilities)||void 0===d?void 0:d.maxTextureSize)&&void 0!==h?h:1/0;return u.getDrawingBufferSize(n),Math.min(Math.max(o.x/i*(n.x/s.x),o.y/i*(n.y/s.y)),t/s.x,t/s.y)}}return 0}})();Object.defineProperties(this,{width:{get:i},height:{get:r},pixelRatio:{get:()=>o,set:u},needsRedraw:{set(t){t&&(a=!0,e=null)}}}),Object.assign(this,{redraw(){if(a){let t=this.image,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),t.width=s(),t.height=l(),t.width&&t.height?(e.save(),e.scale(t.width/i(),t.height/r()),((...t)=>{n().draw(...t)})(e),e.restore()):t.width=t.height=1,a=!1,this.needsUpdate=!0}},setOptimalPixelRatio(...t){u(c(...t))}})}};e.prototype.isDynamicTexture=!0;let n=class extends e{constructor({alignment:t="center",backgroundColor:e="rgba(0,0,0,0)",color:n="#fff",fontFamily:i="sans-serif",fontSize:r=16,fontStyle:a="normal",fontVariant:o="normal",fontWeight:s="normal",lineGap:l=1/4,padding:u=.5,strokeColor:c="#fff",strokeWidth:h=0,text:d=""}={}){super(),Object.entries({alignment:t,backgroundColor:e,color:n,fontFamily:i,fontSize:r,fontStyle:a,fontVariant:o,fontWeight:s,lineGap:l,padding:u,strokeColor:c,strokeWidth:h,text:d}).forEach(([t,e])=>{Object.defineProperty(this,t,{get:()=>e,set(t){e!==t&&(e=t,this.needsRedraw=!0)}})})}get lines(){let{text:t}=this;return t?t.split("\n"):[]}get font(){return function(t,e,n,i,r){let a=document.createElement("span");return a.style.font="1px serif",a.style.fontFamily=t,a.style.fontSize="".concat(e,"px"),a.style.fontStyle=n,a.style.fontVariant=i,a.style.fontWeight=r,a.style.font}(this.fontFamily,this.fontSize,this.fontStyle,this.fontVariant,this.fontWeight)}checkFontFace(){try{let{font:t}=this;return document.fonts.check(t)}catch{}return!0}async loadFontFace(){try{let{font:t}=this;await document.fonts.load(t)}catch{}}createDrawable(){let{alignment:t,backgroundColor:e,color:n,font:i,fontSize:r,lineGap:a,lines:o,padding:s,strokeColor:l,strokeWidth:u}=this;s*=r,a*=r,u*=r;let c=o.length,h=r+a,d=c?(()=>{let t=document.createElement("canvas").getContext("2d");return t.font=i,Math.max(...o.map(e=>t.measureText(e).width))})():0,f=s+u/2,p=d+2*f;return{width:p,height:(c?r+h*(c-1):0)+2*f,draw(a){let s;a.fillStyle=e,a.fillRect(0,0,a.canvas.width,a.canvas.height);let c=f+r/2;Object.assign(a,{fillStyle:n,font:i,lineWidth:u,miterLimit:1,strokeStyle:l,textAlign:(()=>{switch(t){case"left":return s=f,"left";case"right":return s=p-f,"right"}return s=p/2,"center"})(),textBaseline:"middle"}),o.forEach(t=>{a.fillText(t,s,c),u&&a.strokeText(t,s,c),c+=h})}}}};return n.prototype.isTextTexture=!0,n}(n(1))},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(22),o=n.n(a),s=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},l=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return s(e(t),n)}),{left:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)<0?i=a+1:r=a}return i},right:function(e,n,i,r){for(null==i&&(i=0),null==r&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)>0?r=a:i=a+1}return i}}};var u=l(s),c=u.right,h=(u.left,c);var d=function(t){return null===t?NaN:+t},f=function(t,e){var n=function(t,e){var n,i,r=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<r;)isNaN(n=d(t[o]))||(l+=(i=n-s)*(n-(s+=i/++a)));else for(;++o<r;)isNaN(n=d(e(t[o],o,t)))||(l+=(i=n-s)*(n-(s+=i/++a)));if(a>1)return l/(a-1)}(t,e);return n?Math.sqrt(n):n},p=function(t,e){var n,i,r,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(i=r=n;++o<a;)null!=(n=t[o])&&(i>n&&(i=n),r<n&&(r=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=r=n;++o<a;)null!=(n=e(t[o],o,t))&&(i>n&&(i=n),r<n&&(r=n));return[i,r]},m=Array.prototype,g=m.slice,v=(m.map,function(t){return function(){return t}}),y=function(t){return t},b=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a},x=Math.sqrt(50),_=Math.sqrt(10),w=Math.sqrt(2),S=function(t,e,n){var i,r,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=E(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(r=Math.ceil(t-e+1));++s<r;)a[s]=(t-s)/o;return i&&a.reverse(),a};function E(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=x?10:a>=_?5:a>=w?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=x?10:a>=_?5:a>=w?2:1)}function M(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=x?r*=10:a>=_?r*=5:a>=w&&(r*=2),e<t?-r:r}var C=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},T=function(){var t=y,e=p,n=C;function i(i){var r,a,o=i.length,s=new Array(o);for(r=0;r<o;++r)s[r]=t(i[r],r,i);var l=e(s),u=l[0],c=l[1],d=n(s,u,c);Array.isArray(d)||(d=M(u,c,d),d=b(Math.ceil(u/d)*d,c,d));for(var f=d.length;d[0]<=u;)d.shift(),--f;for(;d[f-1]>c;)d.pop(),--f;var p,m=new Array(f+1);for(r=0;r<=f;++r)(p=m[r]=[]).x0=r>0?d[r-1]:u,p.x1=r<f?d[r]:c;for(r=0;r<o;++r)u<=(a=s[r])&&a<=c&&m[h(d,a,0,f)].push(i[r]);return m}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:v(e),i):t},i.domain=function(t){return arguments.length?(e="function"==typeof t?t:v([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?v(g.call(t)):v(t),i):n},i},k=function(t,e){var n,i,r=t.length,a=-1;if(null==e){for(;++a<r;)if(null!=(n=t[a])&&n>=n)for(i=n;++a<r;)null!=(n=t[a])&&n>i&&(i=n)}else for(;++a<r;)if(null!=(n=e(t[a],a,t))&&n>=n)for(i=n;++a<r;)null!=(n=e(t[a],a,t))&&n>i&&(i=n);return i},P=function(t,e){var n,i=t.length,r=i,a=-1,o=0;if(null==e)for(;++a<i;)isNaN(n=d(t[a]))?--r:o+=n;else for(;++a<i;)isNaN(n=d(e(t[a],a,t)))?--r:o+=n;if(r)return o/r},A=function(t,e){var n,i,r=t.length,a=-1;if(null==e){for(;++a<r;)if(null!=(n=t[a])&&n>=n)for(i=n;++a<r;)null!=(n=t[a])&&i>n&&(i=n)}else for(;++a<r;)if(null!=(n=e(t[a],a,t))&&n>=n)for(i=n;++a<r;)null!=(n=e(t[a],a,t))&&i>n&&(i=n);return i};var O=Array.prototype.slice,L=function(t){return t};function R(t){return"translate("+(t+.5)+",0)"}function I(t){return"translate(0,"+(t+.5)+")"}function N(t){return function(e){return+t(e)}}function D(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function B(){return!this.__axis}function F(t,e){var n=[],i=null,r=null,a=6,o=6,s=3,l=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?R:I;function h(h){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,f=null==r?e.tickFormat?e.tickFormat.apply(e,n):L:r,p=Math.max(a,0)+s,m=e.range(),g=+m[0]+.5,v=+m[m.length-1]+.5,y=(e.bandwidth?D:N)(e.copy()),b=h.selection?h.selection():h,x=b.selectAll(".domain").data([null]),_=b.selectAll(".tick").data(d,e).order(),w=_.exit(),S=_.enter().append("g").attr("class","tick"),E=_.select("line"),M=_.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(S),E=E.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",l*a)),M=M.merge(S.append("text").attr("fill","currentColor").attr(u,l*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==b&&(x=x.transition(h),_=_.transition(h),E=E.transition(h),M=M.transition(h),w=w.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=y(t))?c(t):this.getAttribute("transform")})),S.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:y(t))}))),w.remove(),x.attr("d",4===t||2==t?o?"M"+l*o+","+g+"H0.5V"+v+"H"+l*o:"M0.5,"+g+"V"+v:o?"M"+g+","+l*o+"V0.5H"+v+"V"+l*o:"M"+g+",0.5H"+v),_.attr("opacity",1).attr("transform",(function(t){return c(y(t))})),E.attr(u+"2",l*a),M.attr(u,l*p).text(f),b.filter(B).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=y}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=O.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:O.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(i=null==t?null:O.call(t),h):i&&i.slice()},h.tickFormat=function(t){return arguments.length?(r=t,h):r},h.tickSize=function(t){return arguments.length?(a=o=+t,h):a},h.tickSizeInner=function(t){return arguments.length?(a=+t,h):a},h.tickSizeOuter=function(t){return arguments.length?(o=+t,h):o},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function V(t){return F(3,t)}function j(t){return F(4,t)}var U={value:function(){}};function H(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new G(i)}function G(t){this._=t}function W(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function q(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Q(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=U,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}G.prototype=H.prototype={constructor:G,on:function(t,e){var n,i=this._,r=W(t+"",i),a=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=r[a]).type)i[n]=Q(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Q(i[n],t.name,null);return this}for(;++a<o;)if((n=(t=r[a]).type)&&(n=q(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new G(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};var Y=H;function X(){}var Z=function(t){return null==t?X:function(){return this.querySelector(t)}};function J(){return[]}var K=function(t){return null==t?J:function(){return this.querySelectorAll(t)}},tt=function(t){return function(){return this.matches(t)}},et=function(t){return new Array(t.length)};function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function it(t,e,n,i,r,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],i[s]=o):n[s]=new nt(t,a[s]);for(;s<l;++s)(o=e[s])&&(r[s]=o)}function rt(t,e,n,i,r,a,o){var s,l,u,c={},h=e.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(f[s]=u="$"+o.call(l,l.__data__,s,e),u in c?r[s]=l:c[u]=l);for(s=0;s<d;++s)(l=c[u="$"+o.call(t,a[s],s,a)])?(i[s]=l,l.__data__=a[s],c[u]=null):n[s]=new nt(t,a[s]);for(s=0;s<h;++s)(l=e[s])&&c[f[s]]===l&&(r[s]=l)}function at(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ot="http://www.w3.org/1999/xhtml",st={svg:"http://www.w3.org/2000/svg",xhtml:ot,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},lt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),st.hasOwnProperty(e)?{space:st[e],local:t}:t};function ut(t){return function(){this.removeAttribute(t)}}function ct(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ht(t,e){return function(){this.setAttribute(t,e)}}function dt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ft(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function pt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var mt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function gt(t){return function(){this.style.removeProperty(t)}}function vt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function yt(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function bt(t,e){return t.style.getPropertyValue(e)||mt(t).getComputedStyle(t,null).getPropertyValue(e)}function xt(t){return function(){delete this[t]}}function _t(t,e){return function(){this[t]=e}}function wt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function St(t){return t.trim().split(/^|\s+/)}function Et(t){return t.classList||new Mt(t)}function Mt(t){this._node=t,this._names=St(t.getAttribute("class")||"")}function Ct(t,e){for(var n=Et(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Tt(t,e){for(var n=Et(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function kt(t){return function(){Ct(this,t)}}function Pt(t){return function(){Tt(this,t)}}function At(t,e){return function(){(e.apply(this,arguments)?Ct:Tt)(this,t)}}Mt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ot(){this.textContent=""}function Lt(t){return function(){this.textContent=t}}function Rt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function It(){this.innerHTML=""}function Nt(t){return function(){this.innerHTML=t}}function Dt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function zt(){this.nextSibling&&this.parentNode.appendChild(this)}function Bt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ft(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ot&&e.documentElement.namespaceURI===ot?e.createElement(t):e.createElementNS(n,t)}}function Vt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var jt=function(t){var e=lt(t);return(e.local?Vt:Ft)(e)};function Ut(){return null}function Ht(){var t=this.parentNode;t&&t.removeChild(this)}function Gt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Wt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var qt={},$t=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(qt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Qt(t,e,n){return t=Yt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Yt(t,e,n){return function(i){var r=$t;$t=i;try{t.call(this,this.__data__,e,n)}finally{$t=r}}}function Xt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Zt(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,a=e.length;i<a;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function Jt(t,e,n){var i=qt.hasOwnProperty(t.type)?Qt:Yt;return function(r,a,o){var s,l=this.__on,u=i(e,a,o);if(l)for(var c=0,h=l.length;c<h;++c)if((s=l[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function Kt(t,e,n,i){var r=$t;t.sourceEvent=$t,$t=t;try{return e.apply(n,i)}finally{$t=r}}function te(t,e,n){var i=mt(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ee(t,e){return function(){return te(this,t,e)}}function ne(t,e){return function(){return te(this,t,e.apply(this,arguments))}}var ie=[null];function re(t,e){this._groups=t,this._parents=e}function ae(){return new re([[document.documentElement]],ie)}re.prototype=ae.prototype={constructor:re,select:function(t){"function"!=typeof t&&(t=Z(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o,s=e[r],l=s.length,u=i[r]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new re(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(i.push(t.call(o,o.__data__,u,s)),r.push(o));return new re(i,r)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new re(i,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n,i=e?rt:it,r=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),l=new Array(o),u=new Array(o),c=0;c<o;++c){var h=r[c],d=a[c],f=d.length,p=t.call(h,h&&h.__data__,c,r),m=p.length,g=l[c]=new Array(m),v=s[c]=new Array(m);i(h,d,g,v,u[c]=new Array(f),p,e);for(var y,b,x=0,_=0;x<m;++x)if(y=g[x]){for(x>=_&&(_=x+1);!(b=v[_])&&++_<m;);y._next=b||null}}return(s=new re(s,r))._enter=l,s._exit=u,s},enter:function(){return new re(this._enter||this._groups.map(et),this._parents)},exit:function(){return new re(this._exit||this._groups.map(et),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,a=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?a.remove():n(a),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(d[f]=l);for(;s<i;++s)o[s]=e[s];return new re(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],a=r.length-1,o=r[a];--a>=0;)(i=r[a])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=at);for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var o,s=n[a],l=s.length,u=r[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(e)}return new re(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var o=i[r];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,a=e[n],o=0,s=a.length;o<s;++o)(r=a[o])&&t.call(r,r.__data__,o,a);return this},attr:function(t,e){var n=lt(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?ct:ut:"function"==typeof e?n.local?pt:ft:n.local?dt:ht)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?gt:"function"==typeof e?yt:vt)(t,e,null==n?"":n)):bt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?xt:"function"==typeof e?wt:_t)(t,e)):this.node()[t]},classed:function(t,e){var n=St(t+"");if(arguments.length<2){for(var i=Et(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?At:e?kt:Pt)(n,e))},text:function(t){return arguments.length?this.each(null==t?Ot:("function"==typeof t?Rt:Lt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?It:("function"==typeof t?Dt:Nt)(t)):this.node().innerHTML},raise:function(){return this.each(zt)},lower:function(){return this.each(Bt)},append:function(t){var e="function"==typeof t?t:jt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:jt(t),i=null==e?Ut:"function"==typeof e?e:Z(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(Ht)},clone:function(t){return this.select(t?Wt:Gt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,a=Xt(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?Jt:Zt,null==n&&(n=!1),i=0;i<o;++i)this.each(s(a[i],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(i=0,l=s[u];i<o;++i)if((r=a[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ne:ee)(t,e))}};var oe=ae,se=function(t){return"string"==typeof t?new re([[document.querySelector(t)]],[document.documentElement]):new re([[t]],ie)};function le(){$t.stopImmediatePropagation()}var ue=function(){$t.preventDefault(),$t.stopImmediatePropagation()},ce=function(t){var e=t.document.documentElement,n=se(t).on("dragstart.drag",ue,!0);"onselectstart"in e?n.on("selectstart.drag",ue,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function he(t,e){var n=t.document.documentElement,i=se(t).on("dragstart.drag",null);e&&(i.on("click.drag",ue,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var de=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function fe(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function pe(){}var me="\\s*([+-]?\\d+)\\s*",ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ve="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ye=/^#([0-9a-f]{3,8})$/,be=new RegExp("^rgb\\("+[me,me,me]+"\\)$"),xe=new RegExp("^rgb\\("+[ve,ve,ve]+"\\)$"),_e=new RegExp("^rgba\\("+[me,me,me,ge]+"\\)$"),we=new RegExp("^rgba\\("+[ve,ve,ve,ge]+"\\)$"),Se=new RegExp("^hsl\\("+[ge,ve,ve]+"\\)$"),Ee=new RegExp("^hsla\\("+[ge,ve,ve,ge]+"\\)$"),Me={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ce(){return this.rgb().formatHex()}function Te(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ye.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Pe(e):3===n?new Re(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ae(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ae(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=be.exec(t))?new Re(e[1],e[2],e[3],1):(e=xe.exec(t))?new Re(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=_e.exec(t))?Ae(e[1],e[2],e[3],e[4]):(e=we.exec(t))?Ae(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Se.exec(t))?ze(e[1],e[2]/100,e[3]/100,1):(e=Ee.exec(t))?ze(e[1],e[2]/100,e[3]/100,e[4]):Me.hasOwnProperty(t)?Pe(Me[t]):"transparent"===t?new Re(NaN,NaN,NaN,0):null}function Pe(t){return new Re(t>>16&255,t>>8&255,255&t,1)}function Ae(t,e,n,i){return i<=0&&(t=e=n=NaN),new Re(t,e,n,i)}function Oe(t){return t instanceof pe||(t=ke(t)),t?new Re((t=t.rgb()).r,t.g,t.b,t.opacity):new Re}function Le(t,e,n,i){return 1===arguments.length?Oe(t):new Re(t,e,n,null==i?1:i)}function Re(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Ie(){return"#"+De(this.r)+De(this.g)+De(this.b)}function Ne(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function De(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ze(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ve(t,e,n,i)}function Be(t){if(t instanceof Ve)return new Ve(t.h,t.s,t.l,t.opacity);if(t instanceof pe||(t=ke(t)),!t)return new Ve;if(t instanceof Ve)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new Ve(o,s,l,t.opacity)}function Fe(t,e,n,i){return 1===arguments.length?Be(t):new Ve(t,e,n,null==i?1:i)}function Ve(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function je(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ue(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}de(pe,ke,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHsl:function(){return Be(this).formatHsl()},formatRgb:Te,toString:Te}),de(Re,Le,fe(pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ie,formatHex:Ie,formatRgb:Ne,toString:Ne})),de(Ve,Fe,fe(pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ve(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ve(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Re(je(t>=240?t-240:t+120,r,i),je(t,r,i),je(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var He=function(t){return function(){return t}};function Ge(t,e){return function(n){return t+n*e}}function We(t){return 1==(t=+t)?qe:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):He(isNaN(e)?n:e)}}function qe(t,e){var n=e-t;return n?Ge(t,n):He(isNaN(t)?e:t)}var $e=function t(e){var n=We(e);function i(t,e){var i=n((t=Le(t)).r,(e=Le(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=qe(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function Qe(t){return function(e){var n,i,r=e.length,a=new Array(r),o=new Array(r),s=new Array(r);for(n=0;n<r;++n)i=Le(e[n]),a[n]=i.r||0,o[n]=i.g||0,s[n]=i.b||0;return a=t(a),o=t(o),s=t(s),i.opacity=1,function(t){return i.r=a(t),i.g=o(t),i.b=s(t),i+""}}}var Ye=Qe((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,s=i<e-1?t[i+2]:2*a-r;return Ue((n-i/e)*e,o,r,a,s)}})),Xe=(Qe((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],s=t[(i+2)%e];return Ue((n-i/e)*e,r,a,o,s)}})),function(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}});function Ze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Je(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=ln(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}var Ke=function(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}},tn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},en=function(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=ln(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}},nn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rn=new RegExp(nn.source,"g");var an,on,sn=function(t,e){var n,i,r,a=nn.lastIndex=rn.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=nn.exec(t))&&(i=rn.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:tn(n,i)})),a=rn.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})},ln=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?He(e):("number"===i?tn:"string"===i?(n=ke(e))?(e=n,$e):sn:e instanceof ke?$e:e instanceof Date?Ke:Ze(e)?Xe:Array.isArray(e)?Je:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?en:tn)(t,e)},un=function(){for(var t,e=$t;t=e.sourceEvent;)e=t;return e},cn=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]},hn=function(t,e,n){arguments.length<3&&(n=e,e=un().changedTouches);for(var i,r=0,a=e?e.length:0;r<a;++r)if((i=e[r]).identifier===n)return cn(t,i);return null},dn=function(t){var e=un();return e.changedTouches&&(e=e.changedTouches[0]),cn(t,e)},fn=0,pn=0,mn=0,gn=0,vn=0,yn=0,bn="object"==typeof performance&&performance.now?performance:Date,xn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function _n(){return vn||(xn(wn),vn=bn.now()+yn)}function wn(){vn=0}function Sn(){this._call=this._time=this._next=null}function En(t,e,n){var i=new Sn;return i.restart(t,e,n),i}function Mn(){vn=(gn=bn.now())+yn,fn=pn=0;try{!function(){_n(),++fn;for(var t,e=an;e;)(t=vn-e._time)>=0&&e._call.call(null,t),e=e._next;--fn}()}finally{fn=0,function(){var t,e,n=an,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:an=e);on=t,Tn(i)}(),vn=0}}function Cn(){var t=bn.now(),e=t-gn;e>1e3&&(yn-=e,gn=t)}function Tn(t){fn||(pn&&(pn=clearTimeout(pn)),t-vn>24?(t<1/0&&(pn=setTimeout(Mn,t-bn.now()-yn)),mn&&(mn=clearInterval(mn))):(mn||(gn=bn.now(),mn=setInterval(Cn,1e3)),fn=1,xn(Mn)))}Sn.prototype=En.prototype={constructor:Sn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?_n():+n)+(null==e?0:+e),this._next||on===this||(on?on._next=this:an=this,on=this),this._call=t,this._time=n,Tn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tn())}};var kn=function(t,e,n){var i=new Sn;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i},Pn=Y("start","end","cancel","interrupt"),An=[],On=function(t,e,n,i,r,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function a(l){var u,c,h,d;if(1!==n.state)return s();for(u in r)if((d=r[u]).name===n.name){if(3===d.state)return kn(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[u])}if(kn((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=d);i.length=c+1}}function o(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=En((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Pn,tween:An,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function Ln(t,e){var n=In(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Rn(t,e){var n=In(t,e);if(n.state>3)throw new Error("too late; already running");return n}function In(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Nn,Dn,zn,Bn,Fn=function(t,e){var n,i,r,a=t.__transition,o=!0;if(a){for(r in e=null==e?null:e+"",a)(n=a[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[r]):o=!1;o&&delete t.__transition}},Vn=180/Math.PI,jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Un=function(t,e,n,i,r,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*Vn,skewX:Math.atan(l)*Vn,scaleX:o,scaleY:s}};function Hn(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],l=[];return a=t(a),o=t(o),function(t,i,r,a,o,s){if(t!==r||i!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:tn(t,r)},{i:l-2,x:tn(i,a)})}else(r||a)&&o.push("translate("+r+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(r(n)+"rotate(",null,i)-2,x:tn(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(a.rotate,o.rotate,s,l),function(t,e,n,a){t!==e?a.push({i:n.push(r(n)+"skewX(",null,i)-2,x:tn(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(a.skewX,o.skewX,s,l),function(t,e,n,i,a,o){if(t!==n||e!==i){var s=a.push(r(a)+"scale(",null,",",null,")");o.push({i:s-4,x:tn(t,n)},{i:s-2,x:tn(e,i)})}else 1===n&&1===i||a.push(r(a)+"scale("+n+","+i+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var Gn=Hn((function(t){return"none"===t?jn:(Nn||(Nn=document.createElement("DIV"),Dn=document.documentElement,zn=document.defaultView),Nn.style.transform=t,t=zn.getComputedStyle(Dn.appendChild(Nn),null).getPropertyValue("transform"),Dn.removeChild(Nn),t=t.slice(7,-1).split(","),Un(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Wn=Hn((function(t){return null==t?jn:(Bn||(Bn=document.createElementNS("http://www.w3.org/2000/svg","g")),Bn.setAttribute("transform",t),(t=Bn.transform.baseVal.consolidate())?(t=t.matrix,Un(t.a,t.b,t.c,t.d,t.e,t.f)):jn)}),", ",")",")");function qn(t,e){var n,i;return function(){var r=Rn(this,t),a=r.tween;if(a!==n)for(var o=0,s=(i=n=a).length;o<s;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function $n(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var a=Rn(this,t),o=a.tween;if(o!==i){r=(i=o).slice();for(var s={name:e,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===e){r[l]=s;break}l===u&&r.push(s)}a.tween=r}}function Qn(t,e,n){var i=t._id;return t.each((function(){var t=Rn(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return In(t,i).value[e]}}var Yn=function(t,e){var n;return("number"==typeof e?tn:e instanceof ke?$e:(n=ke(e))?(e=n,$e):sn)(t,e)};function Xn(t){return function(){this.removeAttribute(t)}}function Zn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Jn(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===i?r:r=e(i=o,n)}}function Kn(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===i?r:r=e(i=o,n)}}function ti(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttribute(t)}}function ei(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function ni(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ii(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ri(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&ii(t,r)),n}return r._value=e,r}function ai(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&ni(t,r)),n}return r._value=e,r}function oi(t,e){return function(){Ln(this,t).delay=+e.apply(this,arguments)}}function si(t,e){return e=+e,function(){Ln(this,t).delay=e}}function li(t,e){return function(){Rn(this,t).duration=+e.apply(this,arguments)}}function ui(t,e){return e=+e,function(){Rn(this,t).duration=e}}function ci(t,e){if("function"!=typeof e)throw new Error;return function(){Rn(this,t).ease=e}}function hi(t,e,n){var i,r,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Ln:Rn;return function(){var o=a(this,t),s=o.on;s!==i&&(r=(i=s).copy()).on(e,n),o.on=r}}var di=oe.prototype.constructor;function fi(t){return function(){this.style.removeProperty(t)}}function pi(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function mi(t,e,n){var i,r;function a(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&pi(t,a,n)),i}return a._value=e,a}function gi(t){return function(e){this.textContent=t.call(this,e)}}function vi(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&gi(i)),e}return i._value=t,i}var yi=0;function bi(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function xi(){return++yi}var _i=oe.prototype;bi.prototype=function(t){return oe().transition(t)}.prototype={constructor:bi,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Z(t));for(var i=this._groups,r=i.length,a=new Array(r),o=0;o<r;++o)for(var s,l,u=i[o],c=u.length,h=a[o]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,On(h[d],e,n,d,h,In(s,n)));return new bi(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=K(t));for(var i=this._groups,r=i.length,a=[],o=[],s=0;s<r;++s)for(var l,u=i[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var d,f=t.call(l,l.__data__,h,u),p=In(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&On(d,e,n,m,f,p);a.push(f),o.push(l)}return new bi(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new bi(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(d[f]=l);for(;s<i;++s)o[s]=e[s];return new bi(o,this._parents,this._name,this._id)},selection:function(){return new di(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=xi(),i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=In(o,e);On(o,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new bi(i,this._parents,t,n)},call:_i.call,nodes:_i.nodes,node:_i.node,size:_i.size,empty:_i.empty,each:_i.each,on:function(t,e){var n=this._id;return arguments.length<2?In(this.node(),n).on.on(t):this.each(hi(n,t,e))},attr:function(t,e){var n=lt(t),i="transform"===n?Wn:Yn;return this.attrTween(t,"function"==typeof e?(n.local?ei:ti)(n,i,Qn(this,"attr."+t,e)):null==e?(n.local?Zn:Xn)(n):(n.local?Kn:Jn)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=lt(t);return this.tween(n,(i.local?ri:ai)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Gn:Yn;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var a=bt(this,t),o=(this.style.removeProperty(t),bt(this,t));return a===o?null:a===n&&o===i?r:r=e(n=a,i=o)}}(t,i)).on("end.style."+t,fi(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,a;return function(){var o=bt(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=bt(this,t)),o===l?null:o===i&&l===r?a:(r=l,a=e(i=o,s))}}(t,i,Qn(this,"style."+t,e))).each(function(t,e){var n,i,r,a,o="style."+e,s="end."+o;return function(){var l=Rn(this,t),u=l.on,c=null==l.value[o]?a||(a=fi(e)):void 0;u===n&&r===c||(i=(n=u).copy()).on(s,r=c),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,a=n+"";return function(){var o=bt(this,t);return o===a?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,mi(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Qn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,vi(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=In(this.node(),n).tween,a=0,o=r.length;a<o;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((null==e?qn:$n)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?oi:si)(e,t)):In(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?li:ui)(e,t)):In(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(ci(e,t)):In(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--r&&a()}};n.each((function(){var n=Rn(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))}};var wi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Si(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return wi.time=_n(),wi;return n}oe.prototype.interrupt=function(t){return this.each((function(){Fn(this,t)}))},oe.prototype.transition=function(t){var e,n;t instanceof bi?(e=t._id,t=t._name):(e=xi(),(n=wi).time=_n(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,u=0;u<l;++u)(o=s[u])&&On(o,t,e,u,s,n||Si(o,e));return new bi(i,this._parents,t,e)};var Ei=function(t){return function(){return t}},Mi=function(t,e,n){this.target=t,this.type=e,this.selection=n};function Ci(){$t.stopImmediatePropagation()}var Ti=function(){$t.preventDefault(),$t.stopImmediatePropagation()},ki={name:"drag"},Pi={name:"space"},Ai={name:"handle"},Oi={name:"center"};function Li(t){return[+t[0],+t[1]]}function Ri(t){return[Li(t[0]),Li(t[1])]}function Ii(t){return function(e){return hn(e,$t.touches,t)}}var Ni={name:"x",handles:["w","e"].map(Ui),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Di={name:"y",handles:["n","s"].map(Ui),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},zi=(["n","w","e","s","nw","ne","sw","se"].map(Ui),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),Bi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Fi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Vi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},ji={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ui(t){return{type:t}}function Hi(){return!$t.ctrlKey&&!$t.button}function Gi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Wi(){return navigator.maxTouchPoints||"ontouchstart"in this}function qi(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function $i(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Qi(){return Yi(Ni)}function Yi(t){var e,n=Gi,i=Hi,r=Wi,a=!0,o=Y("start","brush","end"),s=6;function l(e){var n=e.property("__brush",m).selectAll(".overlay").data([Ui("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",zi.overlay).merge(n).each((function(){var t=qi(this).extent;se(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([Ui("selection")]).enter().append("rect").attr("class","selection").attr("cursor",zi.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return zi[t.type]})),e.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(r).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=se(this),e=qi(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,e,n){var i=t.__brush.emitter;return!i||n&&i.clean?new h(t,e,n):i}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(){if((!e||$t.touches)&&i.apply(this,arguments)){var n,r,o,s,l,h,d,f,p,m,g,v=this,y=$t.target.__data__.type,b="selection"===(a&&$t.metaKey?y="overlay":y)?ki:a&&$t.altKey?Oi:Ai,x=t===Di?null:Vi[y],_=t===Ni?null:ji[y],w=qi(v),S=w.extent,E=w.selection,M=S[0][0],C=S[0][1],T=S[1][0],k=S[1][1],P=0,A=0,O=x&&_&&a&&$t.shiftKey,L=$t.touches?Ii($t.changedTouches[0].identifier):dn,R=L(v),I=R,N=c(v,arguments,!0).beforestart();"overlay"===y?(E&&(p=!0),w.selection=E=[[n=t===Di?M:R[0],o=t===Ni?C:R[1]],[l=t===Di?T:n,d=t===Ni?k:o]]):(n=E[0][0],o=E[0][1],l=E[1][0],d=E[1][1]),r=n,s=o,h=l,f=d;var D=se(v).attr("pointer-events","none"),z=D.selectAll(".overlay").attr("cursor",zi[y]);if($t.touches)N.moved=F,N.ended=j;else{var B=se($t.view).on("mousemove.brush",F,!0).on("mouseup.brush",j,!0);a&&B.on("keydown.brush",U,!0).on("keyup.brush",H,!0),ce($t.view)}Ci(),Fn(v),u.call(v),N.start()}function F(){var t=L(v);!O||m||g||(Math.abs(t[0]-I[0])>Math.abs(t[1]-I[1])?g=!0:m=!0),I=t,p=!0,Ti(),V()}function V(){var t;switch(P=I[0]-R[0],A=I[1]-R[1],b){case Pi:case ki:x&&(P=Math.max(M-n,Math.min(T-l,P)),r=n+P,h=l+P),_&&(A=Math.max(C-o,Math.min(k-d,A)),s=o+A,f=d+A);break;case Ai:x<0?(P=Math.max(M-n,Math.min(T-n,P)),r=n+P,h=l):x>0&&(P=Math.max(M-l,Math.min(T-l,P)),r=n,h=l+P),_<0?(A=Math.max(C-o,Math.min(k-o,A)),s=o+A,f=d):_>0&&(A=Math.max(C-d,Math.min(k-d,A)),s=o,f=d+A);break;case Oi:x&&(r=Math.max(M,Math.min(T,n-P*x)),h=Math.max(M,Math.min(T,l+P*x))),_&&(s=Math.max(C,Math.min(k,o-A*_)),f=Math.max(C,Math.min(k,d+A*_)))}h<r&&(x*=-1,t=n,n=l,l=t,t=r,r=h,h=t,y in Bi&&z.attr("cursor",zi[y=Bi[y]])),f<s&&(_*=-1,t=o,o=d,d=t,t=s,s=f,f=t,y in Fi&&z.attr("cursor",zi[y=Fi[y]])),w.selection&&(E=w.selection),m&&(r=E[0][0],h=E[1][0]),g&&(s=E[0][1],f=E[1][1]),E[0][0]===r&&E[0][1]===s&&E[1][0]===h&&E[1][1]===f||(w.selection=[[r,s],[h,f]],u.call(v),N.brush())}function j(){if(Ci(),$t.touches){if($t.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else he($t.view,p),B.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),z.attr("cursor",zi.overlay),w.selection&&(E=w.selection),$i(E)&&(w.selection=null,u.call(v)),N.end()}function U(){switch($t.keyCode){case 16:O=x&&_;break;case 18:b===Ai&&(x&&(l=h-P*x,n=r+P*x),_&&(d=f-A*_,o=s+A*_),b=Oi,V());break;case 32:b!==Ai&&b!==Oi||(x<0?l=h-P:x>0&&(n=r-P),_<0?d=f-A:_>0&&(o=s-A),b=Pi,z.attr("cursor",zi.selection),V());break;default:return}Ti()}function H(){switch($t.keyCode){case 16:O&&(m=g=O=!1,V());break;case 18:b===Oi&&(x<0?l=h:x>0&&(n=r),_<0?d=f:_>0&&(o=s),b=Ai,V());break;case 32:b===Pi&&($t.altKey?(x&&(l=h-P*x,n=r+P*x),_&&(d=f-A*_,o=s+A*_),b=Oi):(x<0?l=h:x>0&&(n=r),_<0?d=f:_>0&&(o=s),b=Ai),z.attr("cursor",zi[y]),V());break;default:return}Ti()}}function f(){c(this,arguments).moved()}function p(){c(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=Ri(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){c(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){c(this,arguments).end()})).tween("brush",(function(){var e=this,i=e.__brush,r=c(e,arguments),a=i.selection,o=t.input("function"==typeof n?n.apply(this,arguments):n,i.extent),s=ln(a,o);function l(t){i.selection=1===t&&null===o?null:s(t),u.call(e),r.brush()}return null!==a&&null!==o?l:l(1)})):e.each((function(){var e=this,i=arguments,r=e.__brush,a=t.input("function"==typeof n?n.apply(e,i):n,r.extent),o=c(e,i).beforestart();Fn(e),r.selection=null===a?null:a,u.call(e),o.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Kt(new Mi(l,e,t.output(this.state.selection)),o.apply,o,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:Ei(Ri(t)),l):n},l.filter=function(t){return arguments.length?(i="function"==typeof t?t:Ei(!!t),l):i},l.touchable=function(t){return arguments.length?(r="function"==typeof t?t:Ei(!!t),l):r},l.handleSize=function(t){return arguments.length?(s=+t,l):s},l.keyModifiers=function(t){return arguments.length?(a=!!t,l):a},l.on=function(){var t=o.on.apply(o,arguments);return t===o?l:t},l}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Xi=Math.PI,Zi=2*Xi,Ji=Zi-1e-6;function Ki(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function tr(){return new Ki}Ki.prototype=tr.prototype={constructor:Ki,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,o=this._y1,s=n-t,l=i-e,u=a-t,c=o-e,h=u*u+c*c;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*s-l*u)>1e-6&&r){var d=n-a,f=i-o,p=s*s+l*l,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(h),y=r*Math.tan((Xi-Math.acos((p+h-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*u)+","+(e+b*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>u*f)+","+(this._x1=t+x*s)+","+(this._y1=e+x*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=t+o,u=e+s,c=1^a,h=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+l+","+u),n&&(h<0&&(h=h%Zi+Zi),h>Ji?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Xi)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var er=tr;function nr(){}function ir(t,e){var n=new nr;if(t instanceof nr)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var i,r=-1,a=t.length;if(null==e)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e(i=t[r],r,t),i)}else if(t)for(var o in t)n.set(o,t[o]);return n}nr.prototype=ir.prototype={constructor:nr,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var rr=ir;function ar(){}var or=rr.prototype;function sr(t,e){var n=new ar;if(t instanceof ar)t.each((function(t){n.add(t)}));else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}ar.prototype=sr.prototype={constructor:ar,has:or.has,add:function(t){return this["$"+(t+="")]=t,this},remove:or.remove,clear:or.clear,values:or.keys,size:or.size,empty:or.empty,each:or.each};Array.prototype.slice;var lr=function(t){return function(){return t}};function ur(t,e,n,i,r,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function cr(){return!$t.ctrlKey&&!$t.button}function hr(){return this.parentNode}function dr(t){return null==t?{x:$t.x,y:$t.y}:t}function fr(){return navigator.maxTouchPoints||"ontouchstart"in this}ur.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var pr=function(){var t,e,n,i,r=cr,a=hr,o=dr,s=fr,l={},u=Y("start","drag","end"),c=0,h=0;function d(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!i&&r.apply(this,arguments)){var o=b("mouse",a.apply(this,arguments),dn,this,arguments);o&&(se($t.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),ce($t.view),le(),n=!1,t=$t.clientX,e=$t.clientY,o("start"))}}function p(){if(ue(),!n){var i=$t.clientX-t,r=$t.clientY-e;n=i*i+r*r>h}l.mouse("drag")}function m(){se($t.view).on("mousemove.drag mouseup.drag",null),he($t.view,n),ue(),l.mouse("end")}function g(){if(r.apply(this,arguments)){var t,e,n=$t.changedTouches,i=a.apply(this,arguments),o=n.length;for(t=0;t<o;++t)(e=b(n[t].identifier,i,hn,this,arguments))&&(le(),e("start"))}}function v(){var t,e,n=$t.changedTouches,i=n.length;for(t=0;t<i;++t)(e=l[n[t].identifier])&&(ue(),e("drag"))}function y(){var t,e,n=$t.changedTouches,r=n.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),t=0;t<r;++t)(e=l[n[t].identifier])&&(le(),e("end"))}function b(t,e,n,i,r){var a,s,h,f=n(e,t),p=u.copy();if(Kt(new ur(d,"beforestart",a,t,c,f[0],f[1],0,0,p),(function(){return null!=($t.subject=a=o.apply(i,r))&&(s=a.x-f[0]||0,h=a.y-f[1]||0,!0)})))return function o(u){var m,g=f;switch(u){case"start":l[t]=o,m=c++;break;case"end":delete l[t],--c;case"drag":f=n(e,t),m=c}Kt(new ur(d,u,a,t,m,f[0]+s,f[1]+h,f[0]-g[0],f[1]-g[1],p),p.apply,p,[u,i,r])}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:lr(!!t),d):r},d.container=function(t){return arguments.length?(a="function"==typeof t?t:lr(t),d):a},d.subject=function(t){return arguments.length?(o="function"==typeof t?t:lr(t),d):o},d.touchable=function(t){return arguments.length?(s="function"==typeof t?t:lr(!!t),d):s},d.on=function(){var t=u.on.apply(u,arguments);return t===u?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d},mr={},gr={};function vr(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function yr(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var i in t)i in e||n.push(e[i]=i)})),n}function br(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function xr(t){var e,n=t.getUTCHours(),i=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+br(-e,6):e>9999?"+"+br(e,6):br(e,4))+"-"+br(t.getUTCMonth()+1,2)+"-"+br(t.getUTCDate(),2)+(a?"T"+br(n,2)+":"+br(i,2)+":"+br(r,2)+"."+br(a,3)+"Z":r?"T"+br(n,2)+":"+br(i,2)+":"+br(r,2)+"Z":i||n?"T"+br(n,2)+":"+br(i,2)+"Z":"")}var _r=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var i,r=[],a=t.length,o=0,s=0,l=a<=0,u=!1;function c(){if(l)return gr;if(u)return u=!1,mr;var e,i,r=o;if(34===t.charCodeAt(r)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?l=!0:10===(i=t.charCodeAt(o++))?u=!0:13===i&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(r+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(i=t.charCodeAt(e=o++)))u=!0;else if(13===i)u=!0,10===t.charCodeAt(o)&&++o;else if(i!==n)continue;return t.slice(r,e)}return l=!0,t.slice(r,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(i=c())!==gr;){for(var h=[];i!==mr&&i!==gr;)h.push(i),i=c();e&&null==(h=e(h,s++))||r.push(h)}return r}function r(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?xr(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,a=i(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=vr(t);return function(i,r){return e(n(i),r,t)}}(t,e):vr(t)}));return a.columns=r||[],a},parseRows:i,format:function(e,n){return null==n&&(n=yr(e)),[n.map(o).join(t)].concat(r(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=yr(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}(","),wr=_r.parse;_r.parseRows,_r.format,_r.formatBody,_r.formatRows,_r.formatRow,_r.formatValue;function Sr(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a,o,s,l,u,c,h,d,f=t._root,p={data:i},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o,r=f,!(f=f[h=c<<1|u]))return r[h]=p,t;if(s=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===s&&n===l)return p.next=f,r?r[h]=p:t._root=p,t;do{r=r?r[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o}while((h=c<<1|u)==(d=(l>=o)<<1|s>=a));return r[d]=f,r[h]=p,t}var Er=function(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r};function Mr(t){return t[0]}function Cr(t){return t[1]}function Tr(t,e,n){var i=new kr(null==e?Mr:e,null==n?Cr:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function kr(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function Pr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Ar=Tr.prototype=kr.prototype;Ar.copy=function(){var t,e,n=new kr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Pr(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=Pr(e));return n},Ar.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Sr(this.cover(e,n),e,n,t)},Ar.addAll=function(t){var e,n,i,r,a=t.length,o=new Array(a),s=new Array(a),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(r=+this._y.call(null,e))||(o[n]=i,s[n]=r,i<l&&(l=i),i>c&&(c=i),r<u&&(u=r),r>h&&(h=r));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<a;++n)Sr(this,o[n],s[n],t[n]);return this},Ar.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o,s,l=r-n,u=this._root;n>t||t>=r||i>e||e>=a;)switch(s=(e<i)<<1|t<n,(o=new Array(4))[s]=u,u=o,l*=2,s){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this},Ar.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ar.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ar.find=function(t,e,n){var i,r,a,o,s,l,u,c=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new Er(m,c,h,d,f)),null==n?n=1/0:(c=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(r=l.x0)>d||(a=l.y0)>f||(o=l.x1)<c||(s=l.y1)<h))if(m.length){var g=(r+o)/2,v=(a+s)/2;p.push(new Er(m[3],g,v,o,s),new Er(m[2],r,v,g,s),new Er(m[1],g,a,o,v),new Er(m[0],r,a,g,v)),(u=(e>=v)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var y=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,h=e-_,d=t+_,f=e+_,i=m.data}}return i},Ar.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,a,o,s,l,u,c,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+g)/2))?p=s:g=s,(c=o>=(l=(m+v)/2))?m=l:v=l,e=f,!(f=f[h=c<<1|u]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):e?(r?e[h]=r:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},Ar.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Ar.root=function(){return this._root},Ar.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ar.visit=function(t){var e,n,i,r,a,o,s=[],l=this._root;for(l&&s.push(new Er(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,i=e.x0,r=e.y0,a=e.x1,o=e.y1)&&l.length){var u=(i+a)/2,c=(r+o)/2;(n=l[3])&&s.push(new Er(n,u,c,a,o)),(n=l[2])&&s.push(new Er(n,i,c,u,o)),(n=l[1])&&s.push(new Er(n,u,r,a,c)),(n=l[0])&&s.push(new Er(n,i,r,u,c))}return this},Ar.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Er(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r=e.node;if(r.length){var a,o=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(o+l)/2,h=(s+u)/2;(a=r[0])&&n.push(new Er(a,o,s,c,h)),(a=r[1])&&n.push(new Er(a,c,s,l,h)),(a=r[2])&&n.push(new Er(a,o,h,c,u)),(a=r[3])&&n.push(new Er(a,c,h,l,u))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Ar.x=function(t){return arguments.length?(this._x=t,this):this._x},Ar.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);var Or=Math.PI/180,Lr=180/Math.PI;function Rr(t){if(t instanceof Nr)return new Nr(t.l,t.a,t.b,t.opacity);if(t instanceof jr)return Ur(t);t instanceof Re||(t=Oe(t));var e,n,i=Fr(t.r),r=Fr(t.g),a=Fr(t.b),o=Dr((.2225045*i+.7168786*r+.0606169*a)/1);return i===r&&r===a?e=n=o:(e=Dr((.4360747*i+.3850649*r+.1430804*a)/.96422),n=Dr((.0139322*i+.0971045*r+.7141733*a)/.82521)),new Nr(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Ir(t,e,n,i){return 1===arguments.length?Rr(t):new Nr(t,e,n,null==i?1:i)}function Nr(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function Dr(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function zr(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function Br(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fr(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Vr(t){if(t instanceof jr)return new jr(t.h,t.c,t.l,t.opacity);if(t instanceof Nr||(t=Rr(t)),0===t.a&&0===t.b)return new jr(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Lr;return new jr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function jr(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function Ur(t){if(isNaN(t.h))return new Nr(t.l,0,0,t.opacity);var e=t.h*Or;return new Nr(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Hr(t,e){var n=qe((t=Ir(t)).l,(e=Ir(e)).l),i=qe(t.a,e.a),r=qe(t.b,e.b),a=qe(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=r(e),t.opacity=a(e),t+""}}function Gr(t,e){for(var n=0,i=e.length-1,r=e[0],a=new Array(i<0?0:i);n<i;)a[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return a[e](t-e)}}de(Nr,Ir,fe(pe,{brighter:function(t){return new Nr(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Nr(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Re(Br(3.1338561*(e=.96422*zr(e))-1.6168667*(t=1*zr(t))-.4906146*(n=.82521*zr(n))),Br(-.9787684*e+1.9161415*t+.033454*n),Br(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),de(jr,(function(t,e,n,i){return 1===arguments.length?Vr(t):new jr(t,e,n,null==i?1:i)}),fe(pe,{brighter:function(t){return new jr(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new jr(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Ur(this).rgb()}}));var Wr=function(){return Math.random()},qr=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Wr),function t(e){function n(t,n){var i,r;return t=null==t?0:+t,n=null==n?1:+n,function(){var a;if(null!=i)a=i,i=null;else do{i=2*e()-1,a=2*e()-1,r=i*i+a*a}while(!r||r>1);return t+n*a*Math.sqrt(-2*Math.log(r)/r)}}return n.source=t,n}(Wr)),$r=(function t(e){function n(){var t=qr.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Wr),function t(e){function n(t){return function(){for(var n=0,i=0;i<t;++i)n+=e();return n}}return n.source=t,n}(Wr));(function t(e){function n(t){var n=$r.source(e)(t);return function(){return n()/t}}return n.source=t,n})(Wr),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Wr);function Qr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Yr(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var Xr=Array.prototype,Zr=Xr.map,Jr=Xr.slice;var Kr=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},ta=function(t){return+t},ea=[0,1];function na(t){return t}function ia(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ra(t){var e,n=t[0],i=t[t.length-1];return n>i&&(e=n,n=i,i=e),function(t){return Math.max(n,Math.min(i,t))}}function aa(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=ia(r,i),a=n(o,a)):(i=ia(i,r),a=n(a,o)),function(t){return a(i(t))}}function oa(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=ia(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=h(t,e,1,i)-1;return a[n](r[n](e))}}function sa(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function la(){var t,e,n,i,r,a,o=ea,s=ea,l=ln,u=na;function c(){return i=Math.min(o.length,s.length)>2?oa:aa,r=a=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(o.map(t),s,l)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=i(s,o.map(t),tn)))(n)))},h.domain=function(t){return arguments.length?(o=Zr.call(t,ta),u===na||(u=ra(o)),c()):o.slice()},h.range=function(t){return arguments.length?(s=Jr.call(t),c()):s.slice()},h.rangeRound=function(t){return s=Jr.call(t),l=Kr,c()},h.clamp=function(t){return arguments.length?(u=t?ra(o):na,h):u!==na},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,c()}}function ua(t,e){return la()(t,e)}var ca=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ha(t){if(!(e=ca.exec(t)))throw new Error("invalid format: "+t);var e;return new da({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function da(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}ha.prototype=da.prototype,da.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function fa(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}var pa,ma,ga,va,ya=function(t){return(t=fa(Math.abs(t)))?t[1]:NaN},ba=function(t,e){var n=fa(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},xa={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return ba(100*t,e)},r:ba,s:function(t,e){var n=fa(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(pa=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+fa(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},_a=function(t){return t},wa=Array.prototype.map,Sa=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];ma=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?_a:(e=wa.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?_a:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(wa.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=ha(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;"n"===y?(m=!0,y="g"):xa[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?l:"",_=xa[y],w=/[defgprs%]/.test(y);function S(t){var r,a,l,d=b,S=x;if("c"===y)S=_(t)+S,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==h&&(E=!1),d=(E?"("===h?h:u:"-"===h||"("===h?"":h)+d,S=("s"===y?Sa[8+pa/3]:"")+S+(E&&"("===h?")":""),w)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){S=(46===l?o+t.slice(r+1):t.slice(r))+S,t=t.slice(0,r);break}}m&&!f&&(t=i(t,1/0));var M=d.length+t.length+S.length,C=M<p?new Array(p-M+1).join(e):"";switch(m&&f&&(t=i(C+t,C.length?p-S.length:1/0),C=""),n){case"<":t=d+t+S+C;break;case"=":t=d+C+t+S;break;case"^":t=C.slice(0,M=C.length>>1)+d+t+S+C.slice(M);break;default:t=C+d+t+S}return s(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=ha(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ya(e)/3))),r=Math.pow(10,-i),a=Sa[8+i/3];return function(t){return n(r*t)+a}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),ga=ma.format,va=ma.formatPrefix;var Ea=function(t,e,n,i){var r,a=M(t,e,n);switch((i=ha(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ya(e)/3)))-ya(Math.abs(t)))}(a,o))||(i.precision=r),va(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ya(e)-ya(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-ya(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return ga(i)};function Ma(t){var e=t.domain;return t.ticks=function(t){var n=e();return S(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Ea(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(i=s,s=l,l=i,i=a,a=o,o=i),(i=E(s,l,n))>0?i=E(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=E(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,n)),i>0?(r[a]=Math.floor(s/i)*i,r[o]=Math.ceil(l/i)*i,e(r)):i<0&&(r[a]=Math.ceil(s*i)/i,r[o]=Math.floor(l*i)/i,e(r)),t},t}function Ca(){var t=ua(na,na);return t.copy=function(){return sa(t,Ca())},Qr.apply(t,arguments),Ma(t)}var Ta=new Date,ka=new Date;function Pa(t,e,n,i){function r(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return r.floor=function(e){return t(e=new Date(+e)),e},r.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},r.round=function(t){var e=r(t),n=r.ceil(t);return t-e<n-t?e:n},r.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},r.range=function(n,i,a){var o,s=[];if(n=r.ceil(n),a=null==a?1:Math.floor(a),!(n<i&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<i);return s},r.filter=function(n){return Pa((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(r.count=function(e,i){return Ta.setTime(+e),ka.setTime(+i),t(Ta),t(ka),Math.floor(n(Ta,ka))},r.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?r.filter(i?function(e){return i(e)%t==0}:function(e){return r.count(0,e)%t==0}):r:null}),r}var Aa=Pa((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Aa.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Pa((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Oa=Aa,La=(Aa.range,Pa((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));La.range;function Ra(t){return Pa((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Ia=Ra(0),Na=Ra(1),Da=Ra(2),za=Ra(3),Ba=Ra(4),Fa=Ra(5),Va=Ra(6),ja=(Ia.range,Na.range,Da.range,za.range,Ba.range,Fa.range,Va.range,Pa((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),Ua=ja,Ha=(ja.range,Pa((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),Ga=(Ha.range,Pa((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),Wa=(Ga.range,Pa((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),qa=(Wa.range,Pa((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));qa.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Pa((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):qa:null};qa.range;function $a(t){return Pa((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var Qa=$a(0),Ya=$a(1),Xa=$a(2),Za=$a(3),Ja=$a(4),Ka=$a(5),to=$a(6),eo=(Qa.range,Ya.range,Xa.range,Za.range,Ja.range,Ka.range,to.range,Pa((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),no=eo,io=(eo.range,Pa((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));io.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Pa((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var ro=io;io.range;function ao(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function oo(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function so(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var lo,uo={"-":"",_:" ",0:"0"},co=/^\s*\d+/,ho=/^%/,fo=/[\\^$*+?|[\]().{}]/g;function po(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function mo(t){return t.replace(fo,"\\$&")}function go(t){return new RegExp("^(?:"+t.map(mo).join("|")+")","i")}function vo(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function yo(t,e,n){var i=co.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function bo(t,e,n){var i=co.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function xo(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function _o(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function wo(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function So(t,e,n){var i=co.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Eo(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Mo(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Co(t,e,n){var i=co.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function To(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function ko(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Po(t,e,n){var i=co.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Ao(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Oo(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Lo(t,e,n){var i=co.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Ro(t,e,n){var i=co.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Io(t,e,n){var i=co.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function No(t,e,n){var i=ho.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function Do(t,e,n){var i=co.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function zo(t,e,n){var i=co.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function Bo(t,e){return po(t.getDate(),e,2)}function Fo(t,e){return po(t.getHours(),e,2)}function Vo(t,e){return po(t.getHours()%12||12,e,2)}function jo(t,e){return po(1+Ua.count(Oa(t),t),e,3)}function Uo(t,e){return po(t.getMilliseconds(),e,3)}function Ho(t,e){return Uo(t,e)+"000"}function Go(t,e){return po(t.getMonth()+1,e,2)}function Wo(t,e){return po(t.getMinutes(),e,2)}function qo(t,e){return po(t.getSeconds(),e,2)}function $o(t){var e=t.getDay();return 0===e?7:e}function Qo(t,e){return po(Ia.count(Oa(t)-1,t),e,2)}function Yo(t){var e=t.getDay();return e>=4||0===e?Ba(t):Ba.ceil(t)}function Xo(t,e){return t=Yo(t),po(Ba.count(Oa(t),t)+(4===Oa(t).getDay()),e,2)}function Zo(t){return t.getDay()}function Jo(t,e){return po(Na.count(Oa(t)-1,t),e,2)}function Ko(t,e){return po(t.getFullYear()%100,e,2)}function ts(t,e){return po((t=Yo(t)).getFullYear()%100,e,2)}function es(t,e){return po(t.getFullYear()%1e4,e,4)}function ns(t,e){var n=t.getDay();return po((t=n>=4||0===n?Ba(t):Ba.ceil(t)).getFullYear()%1e4,e,4)}function is(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+po(e/60|0,"0",2)+po(e%60,"0",2)}function rs(t,e){return po(t.getUTCDate(),e,2)}function as(t,e){return po(t.getUTCHours(),e,2)}function os(t,e){return po(t.getUTCHours()%12||12,e,2)}function ss(t,e){return po(1+no.count(ro(t),t),e,3)}function ls(t,e){return po(t.getUTCMilliseconds(),e,3)}function us(t,e){return ls(t,e)+"000"}function cs(t,e){return po(t.getUTCMonth()+1,e,2)}function hs(t,e){return po(t.getUTCMinutes(),e,2)}function ds(t,e){return po(t.getUTCSeconds(),e,2)}function fs(t){var e=t.getUTCDay();return 0===e?7:e}function ps(t,e){return po(Qa.count(ro(t)-1,t),e,2)}function ms(t){var e=t.getUTCDay();return e>=4||0===e?Ja(t):Ja.ceil(t)}function gs(t,e){return t=ms(t),po(Ja.count(ro(t),t)+(4===ro(t).getUTCDay()),e,2)}function vs(t){return t.getUTCDay()}function ys(t,e){return po(Ya.count(ro(t)-1,t),e,2)}function bs(t,e){return po(t.getUTCFullYear()%100,e,2)}function xs(t,e){return po((t=ms(t)).getUTCFullYear()%100,e,2)}function _s(t,e){return po(t.getUTCFullYear()%1e4,e,4)}function ws(t,e){var n=t.getUTCDay();return po((t=n>=4||0===n?Ja(t):Ja.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ss(){return"+0000"}function Es(){return"%"}function Ms(t){return+t}function Cs(t){return Math.floor(+t/1e3)}!function(t){lo=function(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,u=go(r),c=vo(r),h=go(a),d=vo(a),f=go(o),p=vo(o),m=go(s),g=vo(s),v=go(l),y=vo(l),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Bo,e:Bo,f:Ho,g:ts,G:ns,H:Fo,I:Vo,j:jo,L:Uo,m:Go,M:Wo,p:function(t){return r[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ms,s:Cs,S:qo,u:$o,U:Qo,V:Xo,w:Zo,W:Jo,x:null,X:null,y:Ko,Y:es,Z:is,"%":Es},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:rs,e:rs,f:us,g:xs,G:ws,H:as,I:os,j:ss,L:ls,m:cs,M:hs,p:function(t){return r[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ms,s:Cs,S:ds,u:fs,U:ps,V:gs,w:vs,W:ys,x:null,X:null,y:bs,Y:_s,Z:Ss,"%":Es},_={a:function(t,e,n){var i=f.exec(e.slice(n));return i?(t.w=p[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=d[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=y[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=g[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,n,i){return E(t,e,n,i)},d:ko,e:ko,f:Io,g:Eo,G:So,H:Ao,I:Ao,j:Po,L:Ro,m:To,M:Oo,p:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.p=c[i[0].toLowerCase()],n+i[0].length):-1},q:Co,Q:Do,s:zo,S:Lo,u:bo,U:xo,V:_o,w:yo,W:wo,x:function(t,e,i){return E(t,n,e,i)},X:function(t,e,n){return E(t,i,e,n)},y:Eo,Y:So,Z:Mo,"%":No};function w(t,e){return function(n){var i,r,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),null!=(r=uo[i=t.charAt(++s)])?i=t.charAt(++s):r="e"===i?" ":"0",(a=e[i])&&(i=a(n,r)),o.push(i),l=s+1);return o.push(t.slice(l,s)),o.join("")}}function S(t,e){return function(n){var i,r,a=so(1900,void 0,1);if(E(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(i=oo(so(a.y,0,1))).getUTCDay(),i=r>4||0===r?Ya.ceil(i):Ya(i),i=no.offset(i,7*(a.V-1)),a.y=i.getUTCFullYear(),a.m=i.getUTCMonth(),a.d=i.getUTCDate()+(a.w+6)%7):(r=(i=ao(so(a.y,0,1))).getDay(),i=r>4||0===r?Na.ceil(i):Na(i),i=Ua.offset(i,7*(a.V-1)),a.y=i.getFullYear(),a.m=i.getMonth(),a.d=i.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),r="Z"in a?oo(so(a.y,0,1)).getUTCDay():ao(so(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(r+5)%7:a.w+7*a.U-(r+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,oo(a)):ao(a)}}function E(t,e,n,i){for(var r,a,o=0,s=e.length,l=n.length;o<s;){if(i>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=_[r in uo?e.charAt(o++):r])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return b.x=w(n,b),b.X=w(i,b),b.c=w(e,b),x.x=w(n,x),x.X=w(i,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}(t),lo.format,lo.parse,lo.utcFormat,lo.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ts=Pa((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ks=(Ts.range,Pa((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),Ps=(ks.range,Pa((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));Ps.range;function As(){var t,e,n,i,r,a=0,o=1,s=na,l=!1;function u(e){return isNaN(e=+e)?r:s(0===n?.5:(e=(i(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return u.domain=function(r){return arguments.length?(t=i(a=+r[0]),e=i(o=+r[1]),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.unknown=function(t){return arguments.length?(r=t,u):r},function(r){return i=r,t=r(a),e=r(o),n=t===e?0:1/(e-t),u}}function Os(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ls(){var t=Ma(As()(na));return t.copy=function(){return Os(t,Ls())},Yr.apply(t,arguments)}var Rs,Is=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map((function(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n})),Ns=Ye((Rs=Is)[Rs.length-1]),Ds=function(t){return"string"==typeof t?new re([document.querySelectorAll(t)],[document.documentElement]):new re([null==t?[]:t],ie)},zs=function(t){return function(){return t}};function Bs(t){this._context=t}Bs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Fs=function(t){return new Bs(t)};function Vs(t){return t[0]}function js(t){return t[1]}var Us=function(){var t=Vs,e=js,n=zs(!0),i=null,r=Fs,a=null;function o(o){var s,l,u,c=o.length,h=!1;for(null==i&&(a=r(u=er())),s=0;s<=c;++s)!(s<c&&n(l=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(l,s,o),+e(l,s,o));if(u)return a=null,u+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:zs(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:zs(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:zs(!!t),o):n},o.curve=function(t){return arguments.length?(r=t,null!=i&&(a=r(i)),o):r},o.context=function(t){return arguments.length?(null==t?i=a=null:a=r(i=t),o):i},o},Hs=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,Math.PI),Gs=2*Hs;var Ws={draw:function(t,e){var n=Math.sqrt(e/Hs);t.moveTo(n,0),t.arc(0,0,n,0,Gs)}},qs=(Math.sqrt(1/3),Math.sin(Hs/10)/Math.sin(7*Hs/10)),$s=(Math.sin(Gs/10),Math.cos(Gs/10),Math.sqrt(3)),Qs={draw:function(t,e){var n=-Math.sqrt(e/(3*$s));t.moveTo(0,2*n),t.lineTo(-$s*n,-n),t.lineTo($s*n,-n),t.closePath()}};Math.sqrt(3),Math.sqrt(12);function Ys(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Xs(t){this._context=t}Xs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ys(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ys(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Zs=function(t){return new Xs(t)};function Js(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Ks(t,e){this._context=t,this._k=(1-e)/6}Ks.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Js(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Js(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return new Ks(t,e)}return n.tension=function(e){return t(+e)},n})(0);function tl(t,e){this._context=t,this._alpha=e}tl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var i=t._x1,r=t._y1,a=t._x2,o=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>1e-12){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,r,a,o,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var el=function t(e){function n(t){return e?new tl(t,e):new Ks(t,0)}return n.alpha=function(e){return t(+e)},n}(.5),nl=Array.prototype.slice,il=function(t,e){if((r=t.length)>1)for(var n,i,r,a=1,o=t[e[0]],s=o.length;a<r;++a)for(i=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]},rl=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function al(t,e){return t[e]}function ol(){this._=null}function sl(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ll(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ul(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function cl(t){for(;t.L;)t=t.L;return t}ol.prototype={constructor:ol,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=cl(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ll(this,n),n=(t=n).U),n.C=!1,i.C=!0,ul(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(ul(this,n),n=(t=n).U),n.C=!1,i.C=!0,ll(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,a=t.L,o=t.R;if(n=a?o?cl(o):a:o,r?r.L===t?r.L=n:r.R=n:this._=n,a&&o?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=o,o.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,ll(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ul(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,ll(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,ul(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ll(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,ul(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var hl=ol;function dl(t,e,n,i){var r=[null,null],a=Dl.push(r)-1;return r.left=t,r.right=e,n&&pl(r,t,e,n),i&&pl(r,e,t,i),Il[t.index].halfedges.push(a),Il[e.index].halfedges.push(a),r}function fl(t,e,n){var i=[e,n];return i.left=t,i}function pl(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function ml(t,e,n,i,r){var a,o=t[0],s=t[1],l=o[0],u=o[1],c=0,h=1,d=s[0]-l,f=s[1]-u;if(a=e-l,d||!(a>0)){if(a/=d,d<0){if(a<c)return;a<h&&(h=a)}else if(d>0){if(a>h)return;a>c&&(c=a)}if(a=i-l,d||!(a<0)){if(a/=d,d<0){if(a>h)return;a>c&&(c=a)}else if(d>0){if(a<c)return;a<h&&(h=a)}if(a=n-u,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<h&&(h=a)}else if(f>0){if(a>h)return;a>c&&(c=a)}if(a=r-u,f||!(a<0)){if(a/=f,f<0){if(a>h)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<h&&(h=a)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*d,u+c*f]),h<1&&(t[1]=[l+h*d,u+h*f]),!0)}}}}}function gl(t,e,n,i,r){var a=t[1];if(a)return!0;var o,s,l=t[0],u=t.left,c=t.right,h=u[0],d=u[1],f=c[0],p=c[1],m=(h+f)/2,g=(d+p)/2;if(p===d){if(m<e||m>=i)return;if(h>f){if(l){if(l[1]>=r)return}else l=[m,n];a=[m,r]}else{if(l){if(l[1]<n)return}else l=[m,r];a=[m,n]}}else if(s=g-(o=(h-f)/(p-d))*m,o<-1||o>1)if(h>f){if(l){if(l[1]>=r)return}else l=[(n-s)/o,n];a=[(r-s)/o,r]}else{if(l){if(l[1]<n)return}else l=[(r-s)/o,r];a=[(n-s)/o,n]}else if(d<p){if(l){if(l[0]>=i)return}else l=[e,o*e+s];a=[i,o*i+s]}else{if(l){if(l[0]<e)return}else l=[i,o*i+s];a=[e,o*e+s]}return t[0]=l,t[1]=a,!0}function vl(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function yl(t,e){return e[+(e.left!==t.site)]}function bl(t,e){return e[+(e.left===t.site)]}var xl,_l=[];function wl(){sl(this),this.x=this.y=this.arc=this.site=this.cy=null}function Sl(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var o=r[0],s=r[1],l=i[0]-o,u=i[1]-s,c=a[0]-o,h=a[1]-s,d=2*(l*h-u*c);if(!(d>=-Bl)){var f=l*l+u*u,p=c*c+h*h,m=(h*f-u*p)/d,g=(l*p-c*f)/d,v=_l.pop()||new wl;v.arc=t,v.site=r,v.x=m+o,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,b=Nl._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}Nl.insert(y,v),y||(xl=v)}}}}function El(t){var e=t.circle;e&&(e.P||(xl=e.N),Nl.remove(e),_l.push(e),sl(e),t.circle=null)}var Ml=[];function Cl(){sl(this),this.edge=this.site=this.circle=null}function Tl(t){var e=Ml.pop()||new Cl;return e.site=t,e}function kl(t){El(t),Rl.remove(t),Ml.push(t),sl(t)}function Pl(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],a=t.P,o=t.N,s=[t];kl(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<zl&&Math.abs(i-l.circle.cy)<zl;)a=l.P,s.unshift(l),kl(l),l=a;s.unshift(l),El(l);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<zl&&Math.abs(i-u.circle.cy)<zl;)o=u.N,s.push(u),kl(u),u=o;s.push(u),El(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],pl(u.edge,l.site,u.site,r);l=s[0],(u=s[h-1]).edge=dl(l.site,u.site,null,r),Sl(l),Sl(u)}function Al(t){for(var e,n,i,r,a=t[0],o=t[1],s=Rl._;s;)if((i=Ol(s,o)-a)>zl)s=s.L;else{if(!((r=a-Ll(s,o))>zl)){i>-zl?(e=s.P,n=s):r>-zl?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){Il[t.index]={site:t,halfedges:[]}}(t);var l=Tl(t);if(Rl.insert(e,l),e||n){if(e===n)return El(e),n=Tl(e.site),Rl.insert(l,n),l.edge=n.edge=dl(e.site,l.site),Sl(e),void Sl(n);if(n){El(e),El(n);var u=e.site,c=u[0],h=u[1],d=t[0]-c,f=t[1]-h,p=n.site,m=p[0]-c,g=p[1]-h,v=2*(d*g-f*m),y=d*d+f*f,b=m*m+g*g,x=[(g*y-f*b)/v+c,(d*b-m*y)/v+h];pl(n.edge,u,p,x),l.edge=dl(u,t,null,x),n.edge=dl(t,p,null,x),Sl(e),Sl(n)}else l.edge=dl(e.site,l.site)}}function Ol(t,e){var n=t.site,i=n[0],r=n[1],a=r-e;if(!a)return i;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],l=n[1],u=l-e;if(!u)return s;var c=s-i,h=1/a-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-a/2)))/h+i:(i+s)/2}function Ll(t,e){var n=t.N;if(n)return Ol(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Rl,Il,Nl,Dl,zl=1e-6,Bl=1e-12;function Fl(t,e){return e[1]-t[1]||e[0]-t[0]}function Vl(t,e){var n,i,r,a=t.sort(Fl).pop();for(Dl=[],Il=new Array(t.length),Rl=new hl,Nl=new hl;;)if(r=xl,a&&(!r||a[1]<r.y||a[1]===r.y&&a[0]<r.x))a[0]===n&&a[1]===i||(Al(a),n=a[0],i=a[1]),a=t.pop();else{if(!r)break;Pl(r.arc)}if(function(){for(var t,e,n,i,r=0,a=Il.length;r<a;++r)if((t=Il[r])&&(i=(e=t.halfedges).length)){var o=new Array(i),s=new Array(i);for(n=0;n<i;++n)o[n]=n,s[n]=vl(t,Dl[e[n]]);for(o.sort((function(t,e){return s[e]-s[t]})),n=0;n<i;++n)s[n]=e[o[n]];for(n=0;n<i;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,i){for(var r,a=Dl.length;a--;)gl(r=Dl[a],t,e,n,i)&&ml(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>zl||Math.abs(r[0][1]-r[1][1])>zl)||delete Dl[a]}(o,s,l,u),function(t,e,n,i){var r,a,o,s,l,u,c,h,d,f,p,m,g=Il.length,v=!0;for(r=0;r<g;++r)if(a=Il[r]){for(o=a.site,s=(l=a.halfedges).length;s--;)Dl[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)p=(f=bl(a,Dl[l[s]]))[0],m=f[1],h=(c=yl(a,Dl[l[++s%u]]))[0],d=c[1],(Math.abs(p-h)>zl||Math.abs(m-d)>zl)&&(l.splice(s,0,Dl.push(fl(o,f,Math.abs(p-t)<zl&&i-m>zl?[t,Math.abs(h-t)<zl?d:i]:Math.abs(m-i)<zl&&n-p>zl?[Math.abs(d-i)<zl?h:n,i]:Math.abs(p-n)<zl&&m-e>zl?[n,Math.abs(h-n)<zl?d:e]:Math.abs(m-e)<zl&&p-t>zl?[Math.abs(d-e)<zl?h:t,e]:null))-1),++u);u&&(v=!1)}if(v){var y,b,x,_=1/0;for(r=0,v=null;r<g;++r)(a=Il[r])&&(x=(y=(o=a.site)[0]-t)*y+(b=o[1]-e)*b)<_&&(_=x,v=a);if(v){var w=[t,e],S=[t,i],E=[n,i],M=[n,e];v.halfedges.push(Dl.push(fl(o=v.site,w,S))-1,Dl.push(fl(o,S,E))-1,Dl.push(fl(o,E,M))-1,Dl.push(fl(o,M,w))-1)}}for(r=0;r<g;++r)(a=Il[r])&&(a.halfedges.length||delete Il[r])}(o,s,l,u)}this.edges=Dl,this.cells=Il,Rl=Nl=Dl=Il=null}Vl.prototype={constructor:Vl,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return yl(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(a=(r=n.halfedges).length)for(var r,a,o,s,l,u,c=n.site,h=-1,d=e[r[a-1]],f=d.left===c?d.right:d.left;++h<a;)o=f,f=(d=e[r[h]]).left===c?d.right:d.left,o&&f&&i<o.index&&i<f.index&&(l=o,u=f,((s=c)[0]-u[0])*(l[1]-s[1])-(s[0]-l[0])*(u[1]-s[1])<0)&&t.push([c.data,o.data,f.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,r,a=this,o=a._found||0,s=a.cells.length;!(r=a.cells[o]);)if(++o>=s)return null;var l=t-r.site[0],u=e-r.site[1],c=l*l+u*u;do{r=a.cells[i=o],o=null,r.halfedges.forEach((function(n){var i=a.edges[n],s=i.left;if(s!==r.site&&s||(s=i.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,o=s.index)}}))}while(null!==o);return a._found=i,null==n||c<=n*n?r.site:null}};var jl=Math.SQRT2;function Ul(t){return((t=Math.exp(t))+1/t)/2}var Hl=function(t,e){var n,i,r=t[0],a=t[1],o=t[2],s=e[0],l=e[1],u=e[2],c=s-r,h=l-a,d=c*c+h*h;if(d<1e-12)i=Math.log(u/o)/jl,n=function(t){return[r+t*c,a+t*h,o*Math.exp(jl*t*i)]};else{var f=Math.sqrt(d),p=(u*u-o*o+4*d)/(2*o*2*f),m=(u*u-o*o-4*d)/(2*u*2*f),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(m*m+1)-m);i=(v-g)/jl,n=function(t){var e,n=t*i,s=Ul(g),l=o/(2*f)*(s*(e=jl*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[r+l*c,a+l*h,o*s/Ul(jl*n+g)]}}return n.duration=1e3*i,n},Gl=function(t){return function(){return t}};function Wl(t,e,n){this.target=t,this.type=e,this.transform=n}function ql(t,e,n){this.k=t,this.x=e,this.y=n}ql.prototype={constructor:ql,scale:function(t){return 1===t?this:new ql(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new ql(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var $l=new ql(1,0,0);function Ql(){$t.stopImmediatePropagation()}ql.prototype;var Yl=function(){$t.preventDefault(),$t.stopImmediatePropagation()};function Xl(){return!$t.ctrlKey&&!$t.button}function Zl(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Jl(){return this.__zoom||$l}function Kl(){return-$t.deltaY*(1===$t.deltaMode?.05:$t.deltaMode?1:.002)}function tu(){return navigator.maxTouchPoints||"ontouchstart"in this}function eu(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var nu=function(){var t,e,n=Xl,i=Zl,r=eu,a=Kl,o=tu,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,c=Hl,h=Y("start","zoom","end"),d=0;function f(t){t.property("__zoom",Jl).on("wheel.zoom",x).on("mousedown.zoom",_).on("dblclick.zoom",w).filter(o).on("touchstart.zoom",S).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new ql(e,t.x,t.y)}function m(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new ql(t.k,i,r)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on("start.zoom",(function(){y(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){y(this,arguments).end()})).tween("zoom",(function(){var t=this,r=arguments,a=y(t,r),o=i.apply(t,r),s=null==n?g(o):"function"==typeof n?n.apply(t,r):n,l=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=t.__zoom,h="function"==typeof e?e.apply(t,r):e,d=c(u.invert(s).concat(l/u.k),h.invert(s).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=l/e[2];t=new ql(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function y(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=i.apply(t,e),this.taps=0}function x(){if(n.apply(this,arguments)){var t=y(this,arguments),e=this.__zoom,i=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,a.apply(this,arguments)))),o=dn(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=e.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(e.k===i)return;t.mouse=[o,e.invert(o)],Fn(this),t.start()}Yl(),t.wheel=setTimeout(u,150),t.zoom("mouse",r(m(p(e,i),t.mouse[0],t.mouse[1]),t.extent,l))}function u(){t.wheel=null,t.end()}}function _(){if(!e&&n.apply(this,arguments)){var t=y(this,arguments,!0),i=se($t.view).on("mousemove.zoom",u,!0).on("mouseup.zoom",c,!0),a=dn(this),o=$t.clientX,s=$t.clientY;ce($t.view),Ql(),t.mouse=[a,this.__zoom.invert(a)],Fn(this),t.start()}function u(){if(Yl(),!t.moved){var e=$t.clientX-o,n=$t.clientY-s;t.moved=e*e+n*n>d}t.zoom("mouse",r(m(t.that.__zoom,t.mouse[0]=dn(t.that),t.mouse[1]),t.extent,l))}function c(){i.on("mousemove.zoom mouseup.zoom",null),he($t.view,t.moved),Yl(),t.end()}}function w(){if(n.apply(this,arguments)){var t=this.__zoom,e=dn(this),a=t.invert(e),o=t.k*($t.shiftKey?.5:2),s=r(m(p(t,o),e,a),i.apply(this,arguments),l);Yl(),u>0?se(this).transition().duration(u).call(v,s,e):se(this).call(f.transform,s)}}function S(){if(n.apply(this,arguments)){var e,i,r,a,o=$t.touches,s=o.length,l=y(this,arguments,$t.changedTouches.length===s);for(Ql(),i=0;i<s;++i)r=o[i],a=[a=hn(this,o,r.identifier),this.__zoom.invert(a),r.identifier],l.touch0?l.touch1||l.touch0[2]===a[2]||(l.touch1=a,l.taps=0):(l.touch0=a,e=!0,l.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(l.taps<2&&(t=setTimeout((function(){t=null}),500)),Fn(this),l.start())}}function E(){if(this.__zooming){var e,n,i,a,o=y(this,arguments),s=$t.changedTouches,u=s.length;for(Yl(),t&&(t=clearTimeout(t)),o.taps=0,e=0;e<u;++e)n=s[e],i=hn(this,s,n.identifier),o.touch0&&o.touch0[2]===n.identifier?o.touch0[0]=i:o.touch1&&o.touch1[2]===n.identifier&&(o.touch1[0]=i);if(n=o.that.__zoom,o.touch1){var c=o.touch0[0],h=o.touch0[1],d=o.touch1[0],f=o.touch1[1],g=(g=d[0]-c[0])*g+(g=d[1]-c[1])*g,v=(v=f[0]-h[0])*v+(v=f[1]-h[1])*v;n=p(n,Math.sqrt(g/v)),i=[(c[0]+d[0])/2,(c[1]+d[1])/2],a=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!o.touch0)return;i=o.touch0[0],a=o.touch0[1]}o.zoom("touch",r(m(n,i,a),o.extent,l))}}function M(){if(this.__zooming){var t,n,i=y(this,arguments),r=$t.changedTouches,a=r.length;for(Ql(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<a;++t)n=r[t],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;if(i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0)i.touch0[1]=this.__zoom.invert(i.touch0[0]);else if(i.end(),2===i.taps){var o=se(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return f.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",Jl),t!==i?v(t,e,n):i.interrupt().each((function(){y(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},f.scaleBy=function(t,e,n){f.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},f.scaleTo=function(t,e,n){f.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,o=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=a.invert(o),u="function"==typeof e?e.apply(this,arguments):e;return r(m(p(a,u),o,s),t,l)}),n)},f.translateBy=function(t,e,n){f.transform(t,(function(){return r(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),l)}))},f.translateTo=function(t,e,n,a){f.transform(t,(function(){var t=i.apply(this,arguments),o=this.__zoom,s=null==a?g(t):"function"==typeof a?a.apply(this,arguments):a;return r($l.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),a)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Kt(new Wl(f,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},f.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Gl(+t),f):a},f.filter=function(t){return arguments.length?(n="function"==typeof t?t:Gl(!!t),f):n},f.touchable=function(t){return arguments.length?(o="function"==typeof t?t:Gl(!!t),f):o},f.extent=function(t){return arguments.length?(i="function"==typeof t?t:Gl([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),f):i},f.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],f):[s[0],s[1]]},f.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],f):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},f.constrain=function(t){return arguments.length?(r=t,f):r},f.duration=function(t){return arguments.length?(u=+t,f):u},f.interpolate=function(t){return arguments.length?(c=t,f):c},f.on=function(){var t=h.on.apply(h,arguments);return t===h?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f},iu=new(n(135).Dispatcher);function ru(t){iu.dispatch({type:"SELECT_MENU",menu:t})}function au(){iu.dispatch({type:"RESIZE_EXTRACTION_RESULTS_AREA"})}function ou(t){iu.dispatch({type:"SHOW_EXTRACTION_SOURCE_PANEL",id:t})}var su=n(9);function lu(t){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cu(t,e){return(cu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=fu(t);if(e){var r=fu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return du(this,n)}}function du(t,e){return!e||"object"!==lu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fu(t){return(fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pu=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cu(t,e)}(a,t);var e,n,i,r=hu(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).menu="Visualization",t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"SELECT_MENU":this.selectMenu(t.menu);break;case"RESIZE_EXTRACTION_RESULTS_AREA":this.emit("resizeExtractionResultsArea");break;case"SHOW_EXTRACTION_SOURCE_PANEL":this.emit("showExtractionSourcePanel",t.id);break;case"SHOW_RESULTS_PANEL":this.emit("showResultsPanel",t.resultsPanel)}}},{key:"getMenu",value:function(){return this.menu}},{key:"selectMenu",value:function(t){this.menu=t,this.emit("selectMenu",t)}}])&&uu(e.prototype,n),i&&uu(e,i),a}(su.EventEmitter));iu.register(pu.handleActions.bind(pu));var mu=pu;function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_u(t);if(e){var r=_u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xu(this,n)}}function xu(t,e){return!e||"object"!==gu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(o,t);var e,n,i,a=bu(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).menu="Visualization",t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("ul[id*=mainMenuList] li").click((function(){Ds(".mainMenu").classed("active",!1);var t=$(this).attr("value");se(this).classed("active",!0),ru(t)})),mu.on("selectMenu",(function(e){t.menu=e}))}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",id:"appHeader"},r.a.createElement("a",{className:"navbar-brand"},"TimeTubesX"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarColor01","aria-controls":"navbarColor01","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarMainMenu"},r.a.createElement("ul",{className:"navbar-nav mr-auto",id:"mainMenuList"},r.a.createElement("li",{className:"nav-item mainMenu",value:"about"},r.a.createElement("label",{className:"nav-link menuLabel"},"About")),r.a.createElement("li",{className:"nav-item mainMenu active",value:"visualization"},r.a.createElement("label",{className:"nav-link menuLabel"},"Visualization")),r.a.createElement("li",{className:"nav-item mainMenu",value:"feature"},r.a.createElement("label",{className:"nav-link menuLabel"},"Feature Extraction")),r.a.createElement("li",{className:"nav-item mainMenu",value:"comment"},r.a.createElement("label",{className:"nav-link menuLabel"},"Comment")))))}}])&&vu(e.prototype,n),i&&vu(e,i),o}(r.a.Component);function Su(t,e){setTimeout((function(){iu.dispatch({type:"UPDATE_CAMERA",id:t,cameraProp:e})}),1)}function Eu(t){iu.dispatch({type:"RESET_CAMERA",id:t})}function Mu(t,e){iu.dispatch({type:"SEARCH_TIME",id:t,dst:e})}function Cu(t,e,n){iu.dispatch({type:"UPDATE_FOCUS",id:t,zpos:e,flag:n})}function Tu(t,e,n){iu.dispatch({type:"UPDATE_MINMAXV",id:t,min:e,max:n})}function ku(t,e,n){iu.dispatch({type:"UPDATE_MINMAXH",id:t,min:e,max:n})}function Pu(t,e){iu.dispatch({type:"UPDATE_TEXTURE",id:t,texture:e})}function Au(t,e,n,i){iu.dispatch({type:"SYNCHRONIZE_TUBES",id:t,zpos:e,pos:n,deg:i})}function Ou(t,e,n){iu.dispatch({type:"TAKE_SNAPSHOT",id:t,pos:e,far:n})}function Lu(t,e){iu.dispatch({type:"SHOW_TIMETUBES_OF_TIME_SLICE",id:t,period:e})}var Ru=n(1);function Iu(t,e,n){for(var i,r=t[e],a=[],o=0,s=0;s<t.length;s++)Math.abs(t[s].value-r.value)<1e-5&&(a.push(s),o++);if(1===o)i=(r.value*n.value+r.rank*n.rank)/(n.value*n.value+n.rank*n.rank);else{i=0;for(var l=0;l<a.length;l++)i+=(t[a[l]].value*n.value+t[a[l]].rank*n.rank)/(n.value*n.value+n.rank*n.rank);i/=o}return i}function Nu(t){return(Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zu(t,e){return(zu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Vu(t);if(e){var r=Vu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Fu(this,n)}}function Fu(t,e){return!e||"object"!==Nu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vu(t){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ju={HU:{x:"Q/I",y:"U/I",z:"JD",r_x:"E_Q/I",r_y:"E_U/I",H:"V-J",V:"Flx(V)",PA:"PA",PD:"PD"},AUPolar:{x:"< q >",y:"< u >",z:"JD",r_x:"rms(q)",r_y:"rms(u)",PA:"PA",PD:"PD"},AUPhoto:{z:"JD",V:"V"}},Uu=["x","y","z","r_x","r_y","H","V","PA","PD"],Hu=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zu(t,e)}(a,t);var e,n,i,r=Bu(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).data=[],t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData(t.data);break;case"UPDATE_DETAIL":this.emit("updateDetail",t.id,t.zpos);break;case"UPDATE_PRIVATE_COMMENT":this.updatePrivateComment()}}},{key:"uploadData",value:function(t){var e=this.data.length;this.data.push({id:e,name:t.name,data:t}),this.emit("upload",e),this.emit("showInitSP",e)}},{key:"getAllData",value:function(){return this.data}},{key:"getAllFileNames",value:function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].name);return t}},{key:"getAllIdsFileNames",value:function(){for(var t=[],e=0;e<this.data.length;e++)t.push({id:this.data[e].id,name:this.data[e].name});return t}},{key:"getData",value:function(t){return this.data[t]}},{key:"getDataArray",value:function(t,e){for(var n={},i=this.data[t].data.meta.min.z,r=Math.ceil(this.data[t].data.meta.min.z),a=Math.floor(this.data[t].data.meta.max.z),o=r;o<=a;o+=e){var s=this.getValues(t,o-i);for(var l in s)l in n||(n[l]=[]),n[l].push(s[l]);n.z[n.z.length-1]=o}return n.arrayLength=a-r+1,n}},{key:"getDataNum",value:function(){return this.data.length}},{key:"getTailID",value:function(){return this.data[this.data.length-1].id||0}},{key:"getFileName",value:function(t){return this.data[t].name||""}},{key:"getValues",value:function(t,e){if(t<0)return{};var n,i,r,a,o,s,l=e+this.data[t].data.meta.min.z;for(n=1;n<this.data[t].data.splines.position.points.length&&!(this.data[t].data.splines.position.points[n-1].z<=l&&l<this.data[t].data.splines.position.points[n].z);n++);if(i=l===this.data[t].data.meta.min.z||n<0?0:l===this.data[t].data.splines.position.points[this.data[t].data.splines.position.points.length-1].z||n>this.data[t].data.splines.position.points.length-1?1:(n-1+(l-this.data[t].data.splines.position.points[n-1].z)/(this.data[t].data.splines.position.points[n].z-this.data[t].data.splines.position.points[n-1].z))/(this.data[t].data.splines.position.points.length-1),this.data[t].data.splines.hue.points.length>0){for(a=1;a<this.data[t].data.splines.hue.points.length&&!(this.data[t].data.splines.hue.points[a-1].z<=l&&l<this.data[t].data.splines.hue.points[a].z);a++);r=a>=this.data[t].data.splines.hue.points.length-1?1:(a-1+(l-this.data[t].data.splines.hue.points[a-1].z)/(this.data[t].data.splines.hue.points[a].z-this.data[t].data.splines.hue.points[a-1].z))/(this.data[t].data.splines.hue.points.length-1)}for(o=1;o<this.data[t].data.splines.value.points.length&&!(this.data[t].data.splines.value.points[o-1].z<=l&&l<this.data[t].data.splines.value.points[o].z);o++);s=o>=this.data[t].data.splines.value.points.length-1?1:(o-1+(l-this.data[t].data.splines.value.points[o-1].z)/(this.data[t].data.splines.value.points[o].z-this.data[t].data.splines.value.points[o-1].z))/(this.data[t].data.splines.value.points.length-1);var u,c=this.data[t].data.splines.position.getPoint(i),h=this.data[t].data.splines.radius.getPoint(i);u=r?this.data[t].data.splines.hue.getPoint(r):new Ru.Vector3(0,0,c.z);var d=this.data[t].data.splines.value.getPoint(s),f=this.data[t].data.splines.PDPA.getPoint(i);return{z:c.z,x:c.x,r_x:h.x,y:c.y,r_y:h.y,V:d.y,H:u.x,PD:f.x,PA:f.y}}},{key:"getProjectedHue",value:function(t,e){var n;if(t<0)return{};var i,r=e+this.data[t].data.meta.min.z;if(this.data[t].data.hueValRanks.hue.points.length>0){for(i=1;i<this.data[t].data.hueValRanks.hue.points.length&&!(this.data[t].data.hueValRanks.hue.points[i-1].z<=r&&r<this.data[t].data.hueValRanks.hue.points[i].z);i++);n=i>=this.data[t].data.hueValRanks.hue.points.length-1?1:(i-1+(r-this.data[t].data.hueValRanks.hue.points[i-1].z)/(this.data[t].data.hueValRanks.hue.points[i].z-this.data[t].data.hueValRanks.hue.points[i-1].z))/(this.data[t].data.hueValRanks.hue.points.length-1)}return(n?this.data[t].data.hueValRanks.hue.getPoint(n):new Ru.Vector3(0,0,pos.z)).y}},{key:"getProjectedValue",value:function(t,e){var n;if(t<0)return{};var i,r=e+this.data[t].data.meta.min.z;if(this.data[t].data.hueValRanks.value.points.length>0){for(i=1;i<this.data[t].data.hueValRanks.value.points.length&&!(this.data[t].data.hueValRanks.value.points[i-1].z<=r&&r<this.data[t].data.hueValRanks.value.points[i].z);i++);n=i>=this.data[t].data.hueValRanks.value.points.length-1?1:(i-1+(r-this.data[t].data.hueValRanks.value.points[i-1].z)/(this.data[t].data.hueValRanks.value.points[i].z-this.data[t].data.hueValRanks.value.points[i-1].z))/(this.data[t].data.hueValRanks.value.points.length-1)}return(n?this.data[t].data.hueValRanks.value.getPoint(n):new Ru.Vector3(0,0,pos.z)).y}},{key:"getIdFromName",value:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].name===t)return e;return-1}},{key:"getAverage",value:function(t,e,n){for(var i,r,a={x:0,y:0},o=0;o<n;o++)i=e+o,r=this.getValues(t,i),a.x+=r.x,a.y+=r.y;return a.x/=n,a.y/=n,a}},{key:"getDataHeaders",value:function(){return ju}},{key:"getSpatialVar",value:function(){return Uu}},{key:"updatePrivateComment",value:function(){this.emit("updatePrivateComment")}}])&&Du(e.prototype,n),i&&Du(e,i),a}(su.EventEmitter));iu.register(Hu.handleActions.bind(Hu));var Gu=Hu;function Wu(t){return(Wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $u(t,e){return($u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Zu(t);if(e){var r=Zu(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Yu(this,n)}}function Yu(t,e){return!e||"object"!==Wu(e)&&"function"!=typeof e?Xu(t):e}function Xu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zu(t){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ju={Default:[[0,1],[.05,.75],[.37,.5],[.62,.5],[.95,.25],[1,0]],Linear:[[0,1],[.25,.75],[.5,.5],[.75,.25],[1,0]],Flat:[[0,1],[.25,1],[.5,1],[.75,1],[1,1]],Valley:[[0,1],[.25,.75],[.5,.5],[.75,.75],[1,1]]},Ku=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$u(t,e)}(a,t);var e,n,i,r=Qu(a);function a(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).backgroundColor=0,t.initColorIdx=5,t.presetColors=["#DC143C","#FF6347","#FFA500","#FFFF00","#00FF00","#7FFFD4","#00FFFF","#00BFFF","#1E90FF","#7B68EE","#9932CC","#FF00FF","#FF69B4","#FFFFFF","#FFF8DC","#CD853F"],t.cameraProp=[{xpos:0,ypos:0,zpos:50,fov:45,far:2e3,depth:0,aspect:1,zoom:1,type:"Perspective"}],t.textureDefault;var e=new Ru.TextureLoader;for(var n in e.load("img/1_256.png",function(t){this.textureDefault=t}.bind(Xu(t))),t.texture=[],t.checked=[],t.focused=[],t.minmaxV=[],t.minmaxH=[],t.plotColor=[],t.gridSize=18,t.tubeNum=16,t.segment=16,t.division=5,t.visualQuery=!1,t.dragSelection=!0,t.activeId=-1,t.lock=[],t.opacityCurves={},Ju){for(var i=[],o=0;o<Ju[n].length;o++)i.push(new Ru.Vector2(Ju[n][o][0],Ju[n][o][1]));t.opacityCurves[n]=new Ru.SplineCurve(i)}return t.averagePeriod=0,t.wheelInterval=1,t.colorEncodingOption={hue:"default",value:"default"},t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData();break;case"UPDATE_CAMERA":this.updateCamera(t.id,t.cameraProp);break;case"SWITCH_CAMERA":this.switchCamera(t.id);break;case"RESET_CAMERA":this.resetCamera(t.id);break;case"SEARCH_TIME":this.searchTime(t.id,t.dst);break;case"UPDATE_CHECKED":this.updateChecked(t.id);break;case"SWITCH_GRID":this.switchGridDisplay(t.id,t.state);break;case"SWITCH_LABEL":this.switchLabelDisplay(t.id,t.state);break;case"SWITCH_AXIS":this.switchAxisDisplay(t.id,t.state);break;case"SWITCH_PLOT":this.switchPlotDisplay(t.id,t.state);break;case"CHANGE_BACKGROUND":this.changeBackground(t.id,t.color);break;case"CLIP_TUBE":this.clipTube(t.id,t.state);break;case"SWITCH_SHADE":this.switchShade(t.id,t.state);break;case"UPDATE_FOCUS":this.updateFocus(t.id,t.zpos,t.flag);break;case"CHANGE_FAR":this.changeFar(t.id,t.value);break;case"UPDATE_MINMAXH":this.updateMinMaxH(t.id,t.min,t.max);break;case"UPDATE_MINMAXV":this.updateMinMaxV(t.id,t.min,t.max);break;case"CHANGE_PLOTCOLOR":this.changePlotColor(t.id,t.color);break;case"SET_TEXTURE":this.setTexture(t.id,t.texture);break;case"UPDATE_TEXTURE":this.updateTexture(t.id,t.texture);break;case"ACTIVATE_VIEWPORT":this.activateViewport(t.id);break;case"TIME_FITTING":this.timeFitting(t.dst);break;case"LOCK_CONTROL":this.lockControl(t.ids,t.state);break;case"SYNCHRONIZE_TUBES":this.synchronizeTubes(t.id,t.zpos,t.pos,t.deg);break;case"ZOOM_OUT_TIMETUBE":this.zoomOutTimeTubes(t.id);break;case"RESET_ZOOM_TIMETUBES":this.resetZoomTimeTubes(t.id);break;case"ZOOM_IN_TIMETUBES":this.zoomInTimeTubes(t.id);break;case"UPDATE_OPACITY":this.updateOpacity(t.id,t.opt);break;case"TAKE_SNAPSHOT":this.takeSnapshot(t.id,t.pos,t.far);break;case"RECOVER_TUBE":this.recoverTube(t.id,t.cameraProp,t.tubePos);break;case"SHOW_TIMETUBES_OF_TIME_SLICE":this.showTimeTubesofTimeSlice(t.id,t.period);break;case"UPDATE_AVERAGE_PERIOD":this.updateAveragePeriod(t.value);break;case"SHOW_ROTATION_CENTER":this.showRotationCenter(t.id,t.period,t.center);break;case"SWITCH_COMMENT":this.switchComment(t.id,t.state);break;case"UPDATE_WHEEL_INTERVAL":this.updateWheelInterval(t.interval);break;case"UPDATE_COLOR_ENCODING_OPTION_HUE":this.updateColorEncodingOptionHue(t.id,t.option);break;case"UPDATE_COLOR_ENCODING_OPTION_VALUE":this.updateColorEncodingOptionValue(t.id,t.option)}}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"getCameraProp",value:function(t){return this.cameraProp[t]}},{key:"getDefaultCameraProp",value:function(){return{xpos:0,ypos:0,zpos:50,fov:45,far:2e3,depth:0,aspect:1,zoom:1,type:"Perspective"}}},{key:"getChecked",value:function(t){return this.checked[t]}},{key:"getCheckedList",value:function(){return this.checked}},{key:"getFocused",value:function(t){return this.focused[t]}},{key:"getMinMaxH",value:function(t){return this.minmaxH[t]}},{key:"getMinMaxV",value:function(t){return this.minmaxV[t]}},{key:"getActiveId",value:function(){return this.activeId}},{key:"getPresetColors",value:function(){return this.presetColors}},{key:"getPresetColor",value:function(t){return this.presetColors[t]}},{key:"getPresetNum",value:function(){return this.presetColors.length}},{key:"getPlotColor",value:function(t){return this.plotColor[t]}},{key:"getInitColorIdx",value:function(){return this.initColorIdx}},{key:"getGridSize",value:function(){return this.gridSize}},{key:"getVisualQuery",value:function(){return this.visualQuery}},{key:"getTextureDefault",value:function(){return this.textureDefault}},{key:"getTexture",value:function(t){return this.texture[t]}},{key:"getTubeNum",value:function(){return this.tubeNum}},{key:"getDivision",value:function(){return this.division}},{key:"getSegment",value:function(){return this.segment}},{key:"getLock",value:function(t){return this.lock[t]}},{key:"getOpacityDistSet",value:function(){return Ju}},{key:"getOpacityCurves",value:function(){return this.opacityCurves}},{key:"getOpacityCurve",value:function(t){return this.opacityCurves[t]}},{key:"getAveragePeriod",value:function(){return this.averagePeriod}},{key:"getWheelInterval",value:function(){return this.wheelInterval}},{key:"getColorEncodingOption",value:function(){return this.colorEncodingOption}},{key:"setPlotColor",value:function(t,e){this.plotColor[t]=e}},{key:"setPlotColorbyIdx",value:function(t,e){this.plotColor[t]=this.presetColors[e]}},{key:"setLock",value:function(t,e){this.lock[t]=e}},{key:"uploadData",value:function(){this.cameraProp.length,this.cameraProp.push({xpos:0,ypos:0,zpos:50,fov:45,depth:0,far:2e3,aspect:1,zoom:1,type:"Perspective"}),this.checked.push(!0),this.focused.push(0),this.minmaxV.push([0,0]),this.minmaxV.push([0,0]),this.lock.push(0),this.emit("upload")}},{key:"updateCamera",value:function(t,e){for(var n in e)this.cameraProp[t][n]=e[n];this.emit("updateCamera",t)}},{key:"resetCamera",value:function(t){this.cameraProp[t].xpos=0,this.cameraProp[t].ypos=0,this.cameraProp[t].zpos=50,this.emit("reset",t)}},{key:"switchCamera",value:function(t){"Perspective"===this.cameraProp[t].type?this.cameraProp[t].type="Orthographic":this.cameraProp[t].type="Perspective",this.emit("switch")}},{key:"searchTime",value:function(t,e){this.emit("searchTime",t,e)}},{key:"updateChecked",value:function(t){this.checked[t]=!this.checked[t],this.emit("updateChecked",t)}},{key:"switchGridDisplay",value:function(t,e){this.emit("switchGrid",t,e)}},{key:"switchLabelDisplay",value:function(t,e){this.emit("switchLabel",t,e)}},{key:"switchAxisDisplay",value:function(t,e){this.emit("switchAxis",t,e)}},{key:"switchPlotDisplay",value:function(t,e){this.emit("switchPlot",t,e)}},{key:"changeBackground",value:function(t,e){this.backgroundColor=e,this.emit("changeBackground")}},{key:"clipTube",value:function(t,e){this.emit("clipTube",t,e)}},{key:"switchShade",value:function(t,e){this.emit("switchShade",t,e)}},{key:"updateFocus",value:function(t,e,n){this.focused[t]=e,this.emit("updateFocus",t,e,n)}},{key:"changeFar",value:function(t,e){this.cameraProp[t].far=e,this.emit("changeFar",t,e)}},{key:"updateMinMaxH",value:function(t,e,n){this.minmaxH[t]=[e,n],this.emit("updateMinMaxH",t)}},{key:"updateMinMaxV",value:function(t,e,n){this.minmaxV[t]=[e,n],this.emit("updateMinMaxV",t)}},{key:"changePlotColor",value:function(t,e){this.plotColor[t]=e,this.emit("changePlotColor",t)}},{key:"setTexture",value:function(t,e){this.texture[t]=e}},{key:"updateTexture",value:function(t,e){this.texture[t]=e,this.emit("updateTexture",t,e)}},{key:"activateViewport",value:function(t){this.activeId=t}},{key:"timeFitting",value:function(t){this.emit("timeFitting",t)}},{key:"lockControl",value:function(t,e){if(e)for(var n=0;n<t.length;n++)this.lock[t[n]]=this.getFocused(t[n]);else for(var i=0;i<this.lock.length;i++)this.lock[i]=0;this.emit("lockControl",t,e)}},{key:"synchronizeTubes",value:function(t,e,n,i){this.emit("synchronizeTubes",t,e,n,i)}},{key:"zoomOutTimeTubes",value:function(t){this.cameraProp[t].zoom>=.2&&(this.cameraProp[t].zoom-=.1,this.emit("updateZoomTimeTubes",t))}},{key:"resetZoomTimeTubes",value:function(t){this.cameraProp[t].zoom=1,this.emit("updateZoomTimeTubes",t)}},{key:"zoomInTimeTubes",value:function(t){this.cameraProp[t].zoom+=.1,this.emit("updateZoomTimeTubes",t)}},{key:"updateOpacity",value:function(t,e){this.emit("updateOpacity",t,e)}},{key:"takeSnapshot",value:function(t,e,n){this.emit("takeSnapshot",t,e,n)}},{key:"recoverTube",value:function(t,e,n){for(var i in e)this.cameraProp[t][i]=e[i];this.focused[t]=n,this.emit("recoverTube",t,e,n)}},{key:"showTimeTubesofTimeSlice",value:function(t,e){this.focused[t]=e[0]-Gu.getData(t).data.meta.min.z,this.emit("showTimeTubesOfTimeSlice",t,e)}},{key:"updateAveragePeriod",value:function(t){this.averagePeriod=t,this.emit("updateAveragePeriod")}},{key:"showRotationCenter",value:function(t,e,n){this.focused[t]=e[0]-Gu.getData(t).data.meta.min.z,this.emit("showRotationCenter",t,e,n)}},{key:"switchComment",value:function(t,e){this.emit("switchComment",t,e)}},{key:"updateWheelInterval",value:function(t){this.wheelInterval=t,this.emit("updateWheelInterval")}},{key:"updateColorEncodingOptionHue",value:function(t,e){var n=Gu.getData(t).data;switch(e){case"default":this.minmaxH[t]=[n.meta.min.H,n.meta.max.H];break;case"histogramEqualization":this.minmaxH[t]=[n.hueValRanks.minmaxHue.min,n.hueValRanks.minmaxHue.max]}this.colorEncodingOption.hue=e,this.emit("updateColorEncodingOptionHue",t,e)}},{key:"updateColorEncodingOptionValue",value:function(t,e){var n=Gu.getData(t).data;switch(e){case"default":this.minmaxV=[n.meta.min.V,n.meta.max.V];break;case"histogramEqualization":this.minmaxV=[n.hueValRanks.minmaxValue.min,n.hueValRanks.minmaxValue.max]}this.colorEncodingOption.value=e,this.emit("updateColorEncodingOptionValue",t,e)}}])&&qu(e.prototype,n),i&&qu(e,i),a}(su.EventEmitter));iu.register(Ku.handleActions.bind(Ku));var tc=Ku;function ec(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return nc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var ic=Gu.getDataHeaders(),rc=Gu.getSpatialVar();function ac(t,e){iu.dispatch({type:"UPDATE_DETAIL",id:t,zpos:e})}function oc(t,e){Gu.getDataNum();for(var n=e,i=[],r=[],a=[],o=function(e){i.push(t[e].name);var o=new FileReader;o.readAsText(t[e]),o.onload=function(){var s=o.result;console.log("csv file");var l=wr(s,(function(n){return Object.keys(n).forEach((function(t){isNaN(n[t])||(n[t]=Number(n[t]))}),n),n.source=t[e].name,n})).splice(n-1);if(r.push(l),e===t.length-1){for(var u=0;u<r.length;u++)a=a.concat(r[u]);a.sort((function(t,e){return t.JD<e.JD?-1:1}));var c=ec(sc(a),2),h=c[0],d=c[1],f=lc(rc,h),p=uc(h),m=cc(p.spline.hue.points,p.spline.value.points);iu.dispatch({type:"UPLOAD_DATA",data:{name:i.join("+"),data:a,spatial:h,meta:f,splines:p.spline,lookup:d,hueValRanks:m,merge:!1}})}}},s=0;s<t.length;s++)o(s)}function sc(t){for(var e=[],n={},i=0;i<t.length;i++){e[i]={};var r="Q/I"in t[i]||"< q >"in t[i],a="Flx(V)"in t[i]||"V"in t[i];if(r&&a)for(var o in ic.HU){if(ic.HU[o]in t[i])e[i][o]=t[i][ic.HU[o]];else if("PA"===ic.HU[o]){var s=.5*Math.atan2(t[i]["U/I"],t[i]["Q/I"])*180/Math.PI;s<0&&(s+=180),e[i][o]=s}else"PD"===ic.HU[o]&&(e[i][o]=100*Math.sqrt(Math.pow(t[i]["Q/I"],2)+Math.pow(t[i]["U/I"],2)));(!n[o]||n[o].indexOf(ic.HU[o])<0)&&(n[o]||(n[o]=[]),n[o].push(ic.HU[o]))}else if(r)for(var l in ic.AUPolar)if("z"==l)e[i][l]=t[i][ic.AUPolar[l]]-245e4,(!n[l]||n[l].indexOf(ic.AUPolar[l])<0)&&(n[l]||(n[l]=[]),n[l].push(ic.AUPolar[l]));else{if(ic.AUPolar[l]in t[i])e[i][l]=t[i][ic.AUPolar[l]]||0;else if("PA"===ic.AUPolar[l]){var u=.5*Math.atan2(t[i]["< u >"],t[i]["< q >"])*180/Math.PI;u<0&&(u+=180),e[i][l]=u}else"PD"===ic.AUPolar[l]&&(e[i][l]=100*Math.sqrt(Math.pow(t[i]["< q >"],2)+Math.pow(t[i]["< u >"],2)));(!n[l]||n[l].indexOf(ic.AUPolar[l])<0)&&(n[l]||(n[l]=[]),n[l].push(ic.AUPolar[l]))}else if(a)for(var c in ic.AUPhoto)"z"==c?(e[i][c]=t[i][ic.AUPhoto[c]]-245e4,(!n[c]||n[c].indexOf(ic.AUPhoto[c])<0)&&(n[c]||(n[c]=[]),n[c].push(ic.AUPhoto[c]))):"V"===c?(e[i][c]=Math.pow(10,-1*(t[i][ic.AUPhoto[c]]+11.758)/2.5),(!n[c]||n[c].indexOf(ic.AUPhoto[c])<0)&&(n[c]||(n[c]=[]),n[c].push(ic.AUPhoto[c]))):(e[i][c]=t[i][ic.AUPhoto[c]]||0,(!n[c]||n[c].indexOf(ic.AUPhoto[c])<0)&&(n[c]||(n[c]=[]),n[c].push(ic.AUPhoto[c])));e[i].source=t[i].source}return[e,n]}function lc(t,e){for(var n={min:{},max:{},mean:{},std:{}},i=function(i){var r=t[i],a=ec(p(e,(function(t){return t[r]})),2);n.min[r]=a[0],n.max[r]=a[1],n.mean[r]=P(e,(function(t){return t[r]})),n.std[r]=f(e,(function(t){return t[r]}))},r=0;r<t.length;r++)i(r);var a=Math.max(Math.abs(n.mean.x-3*n.std.x),Math.abs(n.mean.x+3*n.std.x)),o=Math.max(Math.abs(n.mean.y-3*n.std.y),Math.abs(n.mean.y+3*n.std.y)),s=Math.max(a,o),l=Math.round(s*Math.pow(10,2-Math.ceil(Math.log10(s))));return n.range=tc.getGridSize()/(5*Math.ceil(l/5)*Math.pow(10,-(2-Math.ceil(Math.log10(s))))),n}function uc(t){var e=[],n=t[0].z,i=[],r=[],a=[],o=[],s=[];t.forEach((function(t){"x"in t&&(i.push(new Ru.Vector3(t.x,t.y,t.z)),r.push(new Ru.Vector3(t.r_x,t.r_y,t.z)),s.push(new Ru.Vector3(t.PD,t.PA,t.z))),"H"in t&&a.push(new Ru.Vector3(t.H,0,t.z)),"V"in t&&o.push(new Ru.Vector3(0,t.V,t.z)),e.push(new Ru.Vector3(0,0,t.z-n))}));var l={};return l.position=new Ru.CatmullRomCurve3(i,!1,"catmullrom"),l.radius=new Ru.CatmullRomCurve3(r,!1,"catmullrom"),l.hue=new Ru.CatmullRomCurve3(a,!1,"catmullrom"),l.value=new Ru.CatmullRomCurve3(o,!1,"catmullrom"),l.line=new Ru.CatmullRomCurve3(e,!1,"catmullrom"),l.PDPA=new Ru.CatmullRomCurve3(s,!1,"catmullrom"),{position:i,radius:r,hue:a,value:o,spline:l}}function cc(t,e){if(t.length>0&&e.length>0){var n=t.map((function(t,e){return{index:e,value:t.x,timeStamp:t.z}})),i=e.map((function(t,e){return{index:e,value:t.y,timeStamp:t.z}}));n.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0})),i.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}));var r=-1*Math.floor(Math.log10(n[0].value)),a=-1*Math.floor(Math.log10(i[0].value));if(n.length===i.length)for(var o=0;o<n.length;o++)n[o].rank=o,n[o].value*=Math.pow(10,r),i[o].rank=o,i[o].value*=Math.pow(10,a);else{for(var s=0;s<n.length;s++)n[s].rank=s,n[s].value*=Math.pow(10,r);for(var l=0;l<i.length;l++)i[l].rank=l,i[l].value*=Math.pow(10,a)}var u={rank:n.length-1,value:n[n.length-1].value-n[0].value},c={rank:i.length-1,value:i[i.length-1].value-i[0].value},h={min:n[0].index,max:n[n.length-1].index},d={min:i[0].index,max:i[i.length-1].index},f=n.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),p=i.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),m=[],g=[];if(f.length===i.length)for(var v=0;v<f.length;v++)m.push({rank:f[v].rank,value:f[v].value,timeStamp:f[v].timeStamp}),g.push({rank:p[v].rank,value:p[v].value,timeStamp:p[v].timeStamp});else{for(var y=0;y<f.length;y++)m.push({rank:f[y].rank,value:f[y].value,timeStamp:f[y].timeStamp});for(var b=0;b<p.length;b++)g.push({rank:p[b].rank,value:p[b].value,timeStamp:p[b].timeStamp})}var x,_=[],w=[];if(m.length===g.length)for(var S=0;S<m.length;S++)x=Iu(m,S,u),_.push(new Ru.Vector3(m[S].value,x,m[S].timeStamp)),x=Iu(g,S,c),w.push(new Ru.Vector3(g[S].value,x,g[S].timeStamp));else{for(var E=0;E<m.length;E++)x=Iu(m,E,u),w.push(new Ru.Vector3(m[E].value,x,m[E].timeStamp));for(var M=0;M<g.length;M++)x=Iu(g,M,c),w.push(new Ru.Vector3(g[M].value,x,g[M].timeStamp))}var C={min:Iu(m,h.min,u),max:Iu(m,h.max,u)},T={min:Iu(g,d.min,c),max:Iu(g,d.max,c)};return{hue:new Ru.CatmullRomCurve3(_,!1,"catmullrom"),value:new Ru.CatmullRomCurve3(w,!1,"catmullrom"),minmaxHue:C,minmaxValue:T}}if(0===t.length){var k=e.map((function(t,e){return{index:e,value:t.y,timeStamp:t.z}}));k.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}));for(var P=-1*Math.floor(Math.log10(k[0].value)),A=0;A<k.length;A++)k[A].rank=A,k[A].value*=Math.pow(10,P);for(var O={rank:k.length-1,value:k[k.length-1].value-k[0].value},L={min:k[0].index,max:k[k.length-1].index},R=k.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),I=[],N=0;N<R.length;N++)I.push({rank:R[N].rank,value:R[N].value,timeStamp:R[N].timeStamp});for(var D,z=[],B=0;B<I.length;B++)D=Iu(I,B,O),z.push(new Ru.Vector3(I[B].value,D,I[B].timeStamp));var F={min:Iu(I,L.min,O),max:Iu(I,L.max,O)};return{hue:void 0,value:new Ru.CatmullRomCurve3(z,!1,"catmullrom"),minmaxHue:void 0,minmaxValue:F}}}function hc(){iu.dispatch({type:"UPDATE_PRIVATE_COMMENT"})}var dc=n(11);function fc(t){return(fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pc(t){var e=[];if(t>0)for(var n=-4;n<=4;n++){var i=Math.exp(-n*n/(2*t*t))/Math.sqrt(2*Math.PI*t*t);e.push({x:n,y:i})}else e.push({x:-1,y:1}),e.push({x:1,y:1});return e}function mc(t,e){return Math.exp(-t*t/(2*e*e))/Math.sqrt(2*Math.PI*e*e)}function gc(t,e){var n={};if("object"==fc(t)&&"object"==fc(e))for(var i in t)"number"==typeof t[i]&&(n[i]=t[i]+e[i]);else if("number"==typeof t)for(var r in e)"number"==typeof e[r]&&(n[r]=t+e[r]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]+e);return n}function vc(t,e){var n={};if("object"==fc(t)&&"object"==fc(e))for(var i in t)"number"==typeof t[i]&&(n[i]=t[i]-e[i]);else if("number"==typeof t)for(var r in e)"number"==typeof e[r]&&(n[r]=t-e[r]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]-e);return n}function yc(t,e){var n={};if("object"==fc(t)&&"object"==fc(e))for(var i in t)"number"==typeof t[i]&&(n[i]=t[i]*e[i]);else if("number"==typeof t)for(var r in e)"number"==typeof e[r]&&(n[r]=t*e[r]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]*e);return n}function bc(t,e){var n={};if("object"==fc(t)&&"object"==fc(e))for(var i in t)"number"==typeof t[i]&&(n[i]=t[i]/e[i]);else if("number"==typeof t)for(var r in e)"number"==typeof e[r]&&(n[r]=t/e[r]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]/e);return n}function xc(t,e){var n={};if("object"==fc(t)&&"object"==fc(e))for(var i in t)"number"==typeof t[i]&&(n[i]=Math.abs(t[i]-e[i]));else if("number"==typeof t)for(var r in e)"number"==typeof e[r]&&(n[r]=Math.abs(t-e[r]));else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=Math.abs(t[a]-e));return n}var _c=n(136);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ec(t,e){return(Ec=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Tc(t);if(e){var r=Tc(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cc(this,n)}}function Cc(t,e){return!e||"object"!==wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tc(t){return(Tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ec(t,e)}(o,t);var e,n,i,a=Mc(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).id=Gu.getTailID(),t.data=Gu.getData(t.id),t.lookup=t.data.data.lookup,t.state={fileName:Gu.getFileName(t.id),currentVal:Gu.getValues(-1,0),checked:!0},t.tubeNum=tc.getTubeNum(),t.opacityDistSet=tc.getOpacityDistSet(),t.opacityCurves=tc.getOpacityCurves(),t.colormapSize=150,t.colorEncodingOption={hue:"default",value:"default"},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.setFarSlider(),this.setColormapValueSlider(),this.setColormapHueSlider(),this.setCurrentColotPlot(),this.setOpacityCurve(),this.setOpacityEllipse(),this.setCurrentColotPlot(),this.setColormapOptions(),Gu.on("upload",(function(e){-1===t.id&&(t.id=e,t.lookup=Gu.getData(e).data.lookup,t.setState({fileName:Gu.getFileName(e),currentVal:Gu.getValues(-1,0),checked:!1}))})),Gu.on("updateDetail",(function(e,n){if(t.id===e){var i,r,a,o,s=Gu.getValues(e,n);switch(t.setState({currentVal:s}),t.colorEncodingOption.hue){case"default":i=t.data.data.meta.min.H,r=t.data.data.meta.max.H;break;case"histogramEqualization":i=t.data.data.hueValRanks.minmaxHue.min,r=t.data.data.hueValRanks.minmaxHue.max}switch(t.colorEncodingOption.value){case"default":a=t.data.data.meta.min.V,o=t.data.data.meta.max.V;break;case"histogramEqualization":a=t.data.data.hueValRanks.minmaxValue.min,o=t.data.data.hueValRanks.minmaxValue.max}var l,u,c=$("#colorValue_"+t.id).slider("option","values"),h=$("#colorHue_"+t.id).slider("option","values"),d=a+(o-a)*c[0]/100,f=a+(o-a)*c[1]/100,p=i+(r-i)*h[0]/100,m=i+(r-i)*h[1]/100;"default"===t.colorEncodingOption.hue?l=(s.H-p)/(m-p):"histogramEqualization"===t.colorEncodingOption.hue&&(l=(Gu.getProjectedHue(e,n)-p)/(m-p)),l<0?l=0:1<l&&(l=1),"default"===t.colorEncodingOption.value?u=(s.V-d)/(f-d):"histogramEqualization"===t.colorEncodingOption.value&&(u=(Gu.getProjectedValue(e,n)-d)/(f-d)),u<0?u=0:1<u&&(u=1),$("#currentColorPlot_"+t.id).css("left",l*t.colormapSize+"px").css("bottom",u*t.colormapSize+"px")}})),tc.on("updateChecked",(function(e){t.id===e&&t.setState({checked:!t.state.checked})})),tc.on("updateColorEncodingOptionHue",(function(e,n){t.id===e&&(t.colorEncodingOption.hue=n,$("#colorHue_"+e).slider("option","values",[0,100]))})),tc.on("updateColorEncodingOptionValue",(function(e,n){t.id===e&&(t.colorEncodingOption.value=n,$("#colorValue_"+e).slider("option","values",[0,100]))}))}},{key:"setFarSlider",value:function(){var t=this.id,e=$("#farSliderVal_"+t);$("#farSlider_"+t).slider({range:"min",value:0,min:1,max:100,slide:function(n,i){e.css("display","initial"),e.val(i.value);var r=$("#farSlider_"+t).slider("option","min"),a=$("#farSlider_"+t).slider("option","max")-r,o=$("#farSlider_"+t).width()*(i.value-r)/a-10;e.css("left",o+"px"),function(t,e){iu.dispatch({type:"CHANGE_FAR",id:t,value:e})}(t,i.value)},stop:function(){e.css("display","none")}}),$("#farSliderVal_"+t).val($("#farSlider_"+t).slider("value"))}},{key:"setColormapValueSlider",value:function(){var t=this.id,e=$("#colorValue_"+t),n=$("#colorValueMin_"+t),i=$("#colorValueMax_"+t);e.slider({range:!0,min:0,max:100,values:[0,100],orientation:"vertical",slide:function(r,a){n.css("display","initial"),i.css("display","initial");var o,s,l=tc.getColorEncodingOption().value,u=Gu.getData(t);switch(l){case"default":o=u.data.meta.min.V,s=u.data.meta.max.V;break;case"histogramEqualization":o=u.data.hueValRanks.minmaxValue.min,s=u.data.hueValRanks.minmaxValue.max}var c=a.values[0]/100*(s-o)+o,h=a.values[1]/100*(s-o)+o;c=Math.log10(Math.abs(c))<-2&&0!==c?c.toExponential(1):c.toFixed(2),h=Math.log10(Math.abs(h))<-2&&0!==h?h.toExponential(1):h.toFixed(2),n.val(c),i.val(h);var d=e.slider("option","min"),f=e.slider("option","max")-d,p=150*(a.values[0]-d)/f-10,m=140-150*(a.values[1]-d)/f;n.css("bottom",p+"px"),i.css("top",m+"px");var g=s-o;Tu(t,a.values[0]/100*g+o,a.values[1]/100*g+o)},stop:function(){n.css("display","none"),i.css("display","none")}}),n.val(e.slider("values",0)),i.val(e.slider("values",1))}},{key:"setColormapHueSlider",value:function(){var t=this.id,e=$("#colorHue_"+t),n=$("#colorHueMin_"+t),i=$("#colorHueMax_"+t);e.slider({range:!0,min:0,max:100,values:[0,100],slide:function(e,r){n.css("display","initial"),i.css("display","initial");var a,o,s=tc.getColorEncodingOption().hue,l=Gu.getData(t);switch(s){case"default":a=l.data.meta.min.H,o=l.data.meta.max.H;break;case"histogramEqualization":a=l.data.hueValRanks.minmaxHue.min,o=l.data.hueValRanks.minmaxHue.max}var u=r.values[0]/100*(o-a)+a,c=r.values[1]/100*(o-a)+a;u=Math.log10(Math.abs(u))<-2&&0!==u?u.toExponential(1):u.toFixed(2),c=Math.log10(Math.abs(c))<-2&&0!==c?c.toExponential(1):c.toFixed(2),n.val(u),i.val(c);var h=150*r.values[0]/100-8,d=142-150*r.values[1]/100;n.css("left",h+"px"),i.css("right",d+"px");var f=o-a;ku(t,r.values[0]/100*f+a,r.values[1]/100*f+a)},stop:function(){n.css("display","none"),i.css("display","none")}}),n.val(e.slider("values",0)),i.val(e.slider("values",1))}},{key:"setCurrentColotPlot",value:function(){var t,e,n,i,r=Gu.getValues(this.id,0);switch(this.colorEncodingOption.hue){case"default":t=this.data.data.meta.min.H,e=this.data.data.meta.max.H;break;case"histogramEqualization":t=this.data.data.hueValRanks.minmaxHue.min,e=this.data.data.hueValRanks.minmaxHue.max}switch(this.colorEncodingOption.value){case"default":n=this.data.data.meta.min.V,i=this.data.data.meta.max.V;break;case"histogramEqualization":n=this.data.data.hueValRanks.minmaxValue.min,i=this.data.data.hueValRanks.minmaxValue.max}var a=(r.H-t)/(e-t);e===t||a<0?a=0:1<a&&(a=1);var o=(r.V-n)/(i-n);o<0?o=0:1<o&&(o=1),$("#currentColorPlot_"+this.id).css("left",a*this.colormapSize+"px").css("bottom",o*this.colormapSize+"px")}},{key:"setOpacityCurve",value:function(){var t=10,e=15,n=15,i=150-n-10,r=150-t-e,a=se("#opacityCurve_"+this.id).append("svg").attr("width",150).attr("height",150).attr("id","opacityCurveArea_"+this.id);a.append("rect").attr("width",i).attr("height",r).style("fill","none").style("stroke","lightgray").attr("transform","translate("+n+","+t+")");for(var o=i/(this.tubeNum-1),s=1;s<this.tubeNum;s++)a.append("line").attr("x1",o*s).attr("y1",0).attr("x2",o*s).attr("y2",i).style("stroke","lightgray").attr("transform","translate("+n+","+t+")"),a.append("line").attr("x1",0).attr("y1",o*s).attr("x2",r).attr("y2",o*s).style("stroke","lightgray").attr("transform","translate("+n+","+t+")");this.xScaleOpacity=Ca().domain([0,1]).range([n,150-n]),this.yScaleOpacity=Ca().domain([0,1]).range([150-t,e]),a.append("g").attr("class","axisLabel opacityCurveXAxis").append("text").attr("x",75).attr("y",150-e/2+5).style("fill","black").style("text-anchor","middle").style("font-size","xx-small").text("Radial size of the tube"),a.append("g").append("text").attr("class","axisLabel opacityCurveYAxis").attr("transform","rotate(-90)").attr("x",-75).attr("y",n/2+2).style("fill","black").style("font-size","xx-small").style("text-anchor","middle").text("Opacity"),a.append("path").datum(this.opacityDistSet.Default).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","opacityCurvePath_"+this.id).attr("d",Us().x(function(t){return this.xScaleOpacity(t[0])}.bind(this)).y(function(t){return this.yScaleOpacity(t[1])}.bind(this)).curve(Zs))}},{key:"setOpacityEllipse",value:function(){var t=10,e=10,n=150-e-10,i=150-t-10,r=se("#opacityEllipse_"+this.id).append("svg").attr("width",150).attr("height",150).attr("id","opacityEllipseArea_"+this.id);r.append("rect").attr("width",n).attr("height",i).style("fill","none").style("stroke","lightgray").attr("transform","translate("+e+","+t+")");for(var a=Math.ceil(e+n/2),o=Math.ceil(t+i/2),s=this.opacityCurves.Default.getSpacedPoints(this.tubeNum),l=1;l<=this.tubeNum;l++){var u=1-(1-s[l-1].y)/(1-s[l].y);r.append("ellipse").attr("cx",a).attr("cy",o).attr("rx",50*l/this.tubeNum).attr("ry",30*l/this.tubeNum).attr("id","opacityEllipseEllipse_"+this.id+"-"+l).style("fill","orange").style("opacity",u)}}},{key:"setColormapOptions",value:function(){for(var t=Ls().domain([0,1]).interpolator(Gr(Hr,["#0000ff","#0084ff","#bb9db8","#ffb000","#ff0000"])),e=document.getElementById("colormapBCVOR_"+this.id),n=e.getContext("2d"),i=n.createLinearGradient(0,0,e.clientWidth,0),r=0;r<=10;r++)i.addColorStop(.1*r,t(.1*r));n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height),(i=n.createLinearGradient(0,0,0,e.clientHeight)).addColorStop(0,"rgba(255, 255, 255, 0.7)"),i.addColorStop(.5,"rgba(255, 255, 255, 0)"),i.addColorStop(.5,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, 0.7)"),n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height)}},{key:"setColormapBCVOR",value:function(){for(var t=Ls().domain([0,1]).interpolator(Gr(Hr,["#0000ff","#0084ff","#bb9db8","#ffb000","#ff0000"])),e=document.getElementById("colormapCanvas_"+this.id),n=e.getContext("2d"),i=n.createLinearGradient(0,0,e.clientWidth,0),r=0;r<=50;r++)i.addColorStop(.02*r,t(.02*r));n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height),(i=n.createLinearGradient(0,0,0,e.clientHeight)).addColorStop(0,"rgba(255, 255, 255, 0.7)"),i.addColorStop(.5,"rgba(255, 255, 255, 0)"),i.addColorStop(.5,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, 0.7)"),n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height)}},{key:"onChangeCheckbox",value:function(t){!function(t){iu.dispatch({type:"UPDATE_CHECKED",id:t})}(t)}},{key:"zoomOutTimeTubes",value:function(){var t;t=this.id,iu.dispatch({type:"ZOOM_OUT_TIMETUBE",id:t})}},{key:"resetZoomTimeTubes",value:function(){var t;t=this.id,iu.dispatch({type:"RESET_ZOOM_TIMETUBES",id:t})}},{key:"zoomInTimeTubes",value:function(){var t;t=this.id,iu.dispatch({type:"ZOOM_IN_TIMETUBES",id:t})}},{key:"showPopoverFar",value:function(){var t=$("#changeFar_"+this.id).css("visibility"),e=$("#farPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeFar_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeFar_"+this.id).css("left",e.left),$("#changeFar_"+this.id).css("visibility","visible"),$("#farSlider_"+this.id).slider("option","value",tc.getCameraProp(this.id).far)}}},{key:"showPopoverPlotColor",value:function(){var t=$("#changePlotColor_"+this.id).css("visibility"),e=$("#plotColorPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changePlotColor_"+this.id).css("visibility","hidden");break;case"hidden":$("#changePlotColor_"+this.id).css("left",e.left),$("#changePlotColor_"+this.id).css("visibility","visible")}}},{key:"showPopoverOpacity",value:function(){var t=$("#changeOpacity_"+this.id).css("visibility"),e=$("#opacityPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeOpacity_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeOpacity_"+this.id).css("left",e.left),$("#changeOpacity_"+this.id).css("visibility","visible")}}},{key:"showPopoverColormap",value:function(){var t=$("#changeColormap_"+this.id).css("visibility"),e=$("#colormapPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeColormap_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeColormap_"+this.id).css("left",e.left),$("#changeColormap_"+this.id).css("visibility","visible")}}},{key:"showPopoverSearch",value:function(){var t=$("#searchTime_"+this.id).css("visibility"),e=$("#searchPopoverBtn_"+this.id).position();switch(t){case"visible":$("#searchTime_"+this.id).css("visibility","hidden");break;case"hidden":$("#searchTime_"+this.id).css("left",e.left),$("#searchTime_"+this.id).css("visibility","visible")}}},{key:"searchTime",value:function(){var t=this.id,e=$("#searchTimeInput_"+t).val();isNaN(e)||""==e||Mu(t,Number(e))}},{key:"changePlotColor",value:function(t,e){!function(t,e){iu.dispatch({type:"CHANGE_PLOTCOLOR",id:t,color:e})}(this.id,t.hex)}},{key:"changeColorMap",value:function(){$("#mask_uploadColormap_"+this.id).val($("#uploadColormap_"+this.id).val());var t=document.getElementById("uploadColormap_"+this.id).files,e=new FileReader;e.readAsDataURL(t[0]),e.onload=function(){var t=e.result;document.getElementById("colormap_"+this.id).style.backgroundImage="url("+t+")",(new Ru.TextureLoader).load(t,function(t){Pu(this.id,t)}.bind(this))}.bind(this)}},{key:"changeColorMapMask",value:function(){$("#uploadColormap_"+this.id).click()}},{key:"clickColormapOption",value:function(t){var e;e="string"==typeof t.target.className?t.target.className.split(" ")[1]:t.currentTarget.className.animVal.split(" ")[1];var n=new Ru.TextureLoader;switch(e){case"colormapBR":$("#colormap_"+this.id).css("display","block"),$("#colormapCanvas_"+this.id).css("display","none"),document.getElementById("colormap_"+this.id).style.backgroundImage="url(../img/1_256.png)",new Ru.TextureLoader,n.load("img/1_256.png",function(t){Pu(this.id,t)}.bind(this));break;case"colormapRGB":$("#colormap_"+this.id).css("display","block"),$("#colormapCanvas_"+this.id).css("display","none"),document.getElementById("colormap_"+this.id).style.backgroundImage="url(../img/RGB.png)",n.load("img/RGB.png",function(t){Pu(this.id,t)}.bind(this));break;case"colormapBCVOR":$("#colormap_"+this.id).css("display","none"),$("#colormapCanvas_"+this.id).css("display","block"),this.setColormapBCVOR();var i=document.getElementById("colormapCanvas_"+this.id).toDataURL();n.load(i,function(t){Pu(this.id,t)}.bind(this))}}},{key:"changeOpacityDistribution",value:function(){var t,e,n=document.getElementById("opacityList_"+this.id),i=n.selectedIndex,r=n.options[i].value;this.drawOpacityCurve(r),this.drawOpacityEllipse(r),t=this.id,e=r,iu.dispatch({type:"UPDATE_OPACITY",id:t,opt:e})}},{key:"updateColorEncodingOptionHue",value:function(){var t,e,n=document.getElementById("colorEncodingOptionHue_"+this.id),i=n.selectedIndex,r=n.options[i].value;t=this.id,e=r,iu.dispatch({type:"UPDATE_COLOR_ENCODING_OPTION_HUE",id:t,option:e})}},{key:"updateColorEncodingOptionValue",value:function(){var t,e,n=document.getElementById("colorEncodingOptionValue_"+this.id),i=n.selectedIndex,r=n.options[i].value;t=this.id,e=r,iu.dispatch({type:"UPDATE_COLOR_ENCODING_OPTION_VALUE",id:t,option:e})}},{key:"drawOpacityCurve",value:function(t){se("#opacityCurvePath_"+this.id).remove(),se("#opacityCurveArea_"+this.id).append("path").datum(this.opacityDistSet[t]).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","opacityCurvePath_"+this.id).attr("d",Us().x(function(t){return this.xScaleOpacity(t[0])}.bind(this)).y(function(t){return this.yScaleOpacity(t[1])}.bind(this)).curve(Zs))}},{key:"drawOpacityEllipse",value:function(t){var e=1;if("Flat"===t)for(var n=1;n<=this.tubeNum;n++)se("#opacityEllipseEllipse_"+this.id+"-"+n).style("opacity",e);else for(var i=this.opacityCurves[t].getSpacedPoints(this.tubeNum),r=1;r<=this.tubeNum;r++)e=1-(1-i[r-1].y)/(1-i[r].y),se("#opacityEllipseEllipse_"+this.id+"-"+r).style("opacity",e)}},{key:"render",value:function(){var t=this.state.currentVal,e=[];for(var n in t){var i=void 0;i="z"===n||"H"===n?t[n].toFixed(3):"V"===n?t[n].toExponential(2):t[n].toFixed(4),e.push(r.a.createElement("tr",{key:n+"_"+this.id,className:"detailTableRow"},r.a.createElement("td",{className:"detailTableData detailTableVari"},this.lookup[n]),r.a.createElement("td",{className:"detailTableData"},i)))}return r.a.createElement("div",{id:"onViewportControllers_"+this.id},r.a.createElement("div",{id:"fileSelector_"+this.id,className:"controllersOnView",style:{position:"absolute",color:"white",top:"0px",left:"0px",zIndex:"10",fontSize:"0.8rem",marginLeft:"1.5rem"}},r.a.createElement("input",{type:"checkbox",id:"selectView_"+this.id,name:"selectView",key:this.id,value:this.id,checked:this.state.checked,onChange:this.onChangeCheckbox.bind(this,this.id)}),r.a.createElement("label",{id:"fileName_"+this.id,style:{paddingLeft:"0.5rem",paddingRight:"0.5rem"}},this.state.fileName)),r.a.createElement("div",{id:"zoomControllers_"+this.id,className:"controllersOnView",style:{position:"absolute",top:"0px",right:"0px",zIndex:"20",fontSize:"0.8rem"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"zoomOutBtn_"+this.id,onClick:this.zoomOutTimeTubes.bind(this)},"-"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"resetZoomBtn_"+this.id,onClick:this.resetZoomTimeTubes.bind(this)},""),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"zoomInBtn_"+this.id,onClick:this.zoomInTimeTubes.bind(this)},"+")),r.a.createElement("div",{id:"eachTubeControllers_"+this.id,className:"controllersOnView",style:{position:"absolute",bottom:"0px",left:"0px",zIndex:"30",fontSize:"0.8rem"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"colormapPopoverBtn_"+this.id,onClick:this.showPopoverColormap.bind(this)},"Colormap"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"farPopoverBtn_"+this.id,onClick:this.showPopoverFar.bind(this)},"Far"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"plotColorPopoverBtn_"+this.id,onClick:this.showPopoverPlotColor.bind(this)},"Plot Color"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"opacityPopoverBtn_"+this.id,onClick:this.showPopoverOpacity.bind(this)},"Opacity"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"searchPopoverBtn_"+this.id,onClick:this.showPopoverSearch.bind(this)},"Search")),r.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeColormap_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"31"}},r.a.createElement("div",{id:"colorFilter_"+this.id},r.a.createElement("div",{className:"colormapController",style:{alignItems:"center",display:"flex"}},r.a.createElement("div",{id:"colorValue_"+this.id,style:{float:"left",height:this.colormapSize+"px"}},r.a.createElement("output",{id:"colorValueMax_"+this.id,style:{marginLeft:"1.3rem"}}),r.a.createElement("output",{id:"colorValueMin_"+this.id,style:{marginLeft:"1.3rem"}})),r.a.createElement("div",{id:"colorMapArea_"+this.id,className:"colormapArea",style:{float:"left",marginLeft:"10px"}},r.a.createElement("input",{type:"file",className:"custom-file-input colormapFile",id:"uploadColormap_"+this.id,onChange:this.changeColorMap.bind(this)}),r.a.createElement("label",{className:"fileMask"},r.a.createElement("span",{id:"colormap_"+this.id},r.a.createElement("input",{type:"text",id:"mask_uploadColormap_"+this.id,className:"colormapFile",onClick:this.changeColorMapMask.bind(this)})),r.a.createElement("canvas",{className:"colormapCanvas",id:"colormapCanvas_"+this.id,width:"150",height:"150"})),r.a.createElement("span",{className:"currentColor",id:"currentColorPlot_"+this.id})),r.a.createElement("div",{style:{clear:"both"}})),r.a.createElement("div",{id:"colorHue_"+this.id,style:{width:this.colormapSize+"px",marginTop:"5px",marginLeft:"20px"}},r.a.createElement("output",{id:"colorHueMax_"+this.id,style:{bottom:"1.3rem"}}),r.a.createElement("output",{id:"colorHueMin_"+this.id,style:{bottom:"1.3rem"}})),r.a.createElement("div",{id:"colormapOptions_"+this.id,className:"colormapOptions"},r.a.createElement("img",{src:"img/1_256.png",className:"colormapOption colormapBR",id:"colormapBR_"+this.id,style:{verticalAlign:"unset"},onClick:this.clickColormapOption.bind(this)}),r.a.createElement("img",{src:"img/RGB.png",className:"colormapOption colormapRGB",id:"colormapRGB_"+this.id,style:{verticalAlign:"unset"},onClick:this.clickColormapOption.bind(this)}),r.a.createElement("canvas",{className:"colormapOption colormapBCVOR",id:"colormapBCVOR_"+this.id,width:"30",height:"30",onClick:this.clickColormapOption.bind(this)})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},"V-J"),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("select",{className:"custom-select",id:"colorEncodingOptionHue_"+this.id,style:{fontSize:"0.8rem",height:"1.5rem"},onChange:this.updateColorEncodingOptionHue.bind(this),disabled:!this.data.data.hueValRanks.minmaxHue},r.a.createElement("option",{value:"default"},"Default"),r.a.createElement("option",{value:"histogramEqualization"},"Histogram Equalization"))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},"Flx(V)"),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("select",{className:"custom-select",id:"colorEncodingOptionValue_"+this.id,style:{fontSize:"0.8rem",height:"1.5rem"},onChange:this.updateColorEncodingOptionValue.bind(this)},r.a.createElement("option",{value:"default"},"Default"),r.a.createElement("option",{value:"histogramEqualization"},"Histogram Equalization"))))))),r.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeFar_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"32"}},r.a.createElement("div",{id:"farSliderArea_"+this.id},r.a.createElement("label",{id:"idLabel_"+this.id,style:{float:"left",width:"2rem"}},"far"),r.a.createElement("div",{id:"farSlider_"+this.id,style:{float:"left",width:"8rem",marginBottom:".5rem",marginTop:".5rem"}},r.a.createElement("output",{id:"farSliderVal_"+this.id,style:{position:"absolute",display:"none",top:"-30px",backgroundColor:"#fff",opacity:"0.8",borderRadius:"3px",color:"#777",padding:"2px"}})))),r.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changePlotColor_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"33"}},r.a.createElement(_c.SketchPicker,{presetColors:tc.getPresetColors(),color:tc.getPlotColor(this.id),onChange:this.changePlotColor.bind(this)})),r.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeOpacity_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"34",display:"block"}},r.a.createElement("select",{className:"form-control",id:"opacityList_"+this.id,onChange:this.changeOpacityDistribution.bind(this),style:{fontSize:"0.8rem",width:"150px"}},r.a.createElement("option",{value:"Default"},"Default"),r.a.createElement("option",{value:"Flat"},"Flat"),r.a.createElement("option",{value:"Linear"},"Linear"),r.a.createElement("option",{value:"Valley"},"Valley shaped")),r.a.createElement("div",{className:"currentOpacity",style:{display:"flex"}},r.a.createElement("div",{id:"opacityCurve_"+this.id}),r.a.createElement("div",{id:"opacityEllipse_"+this.id}))),r.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"searchTime_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"10rem",zIndex:"35"}},r.a.createElement("input",{type:"text",className:"form-control custom-input",id:"searchTimeInput_"+this.id,placeholder:"Input JD"}),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"searchTimeBtn_"+this.id,onClick:this.searchTime.bind(this)},"Search")),r.a.createElement("div",{id:"detailValueArea",className:"controllersOnView",style:{position:"absolute",color:"white",right:"0px",bottom:"0px",whiteSpace:"pre-line",zIndex:"11",fontSize:"0.8rem"}},r.a.createElement("table",{className:"detailTable"},r.a.createElement("tbody",{className:"detailTableBody"},e))))}}])&&Sc(e.prototype,n),i&&Sc(e,i),o}(r.a.Component);function Pc(t){iu.dispatch({type:"UPDATE_SOURCE",id:t})}function Ac(t){iu.dispatch({type:"SWITCH_SELECTOR",selector:t})}function Oc(){iu.dispatch({type:"RESET_SELECTION"})}function Lc(t){iu.dispatch({type:"SELECT_TIMEINTERVAL",value:t})}function Rc(t){iu.dispatch({type:"UPDATE_SELECTED_PERIOD",period:t})}function Ic(t){iu.dispatch({type:"SWITCH_QUERY_MODE",mode:t})}function Nc(t){iu.dispatch({type:"SET_ACTIVE_VARIABLES",varList:t})}function Dc(t,e,n,i){iu.dispatch({type:"SET_EXTRACTION_RESULTS",parameters:t,results:e,query:n,activeVar:i})}function zc(t,e,n){iu.dispatch({type:"CONVERT_RESULT_INTO_QUERY",id:t,period:e,activeVar:n})}function Bc(t,e){iu.dispatch({type:"UPDATE_AE_OPTION",option:t,value:e})}function Fc(t){iu.dispatch({type:"SWITCH_QBE_SELECTOR_SP",selector:t})}function Vc(t){iu.dispatch({type:"UPDATE_K_VALUE",k:t})}function jc(t){iu.dispatch({type:"UPDATE_ORDER",order:t})}function Uc(t){iu.dispatch({type:"RECOVER_QUERY",query:t})}function Hc(t){iu.dispatch({type:"CONVERT_CLUSTER_CENTER_INTO_QUERY",clusterCenter:t})}function Gc(t){iu.dispatch({type:"CHANGE_DTW_MODE",DTWMode:t})}var Wc=JSON.parse(localStorage.getItem("privateComment")),qc=JSON.parse(localStorage.getItem("queryTable"));function $c(){for(var t={},e=0;e<Wc.length;e++)t[Wc[e].id]={timeStamp:Wc[e].timeStamp,fileName:Wc[e].fileName,userName:Wc[e].userName,labelColor:"0x80b139",start:Wc[e].start,period:void 0,comment:Wc[e].comment,queryId:""};return Wc=t,localStorage.setItem("privateComment",JSON.stringify(Wc)),Wc}function Qc(){return(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16)}function Yc(t){return JSON.parse(localStorage.getItem(t))}function Xc(t){var e,n=!1;if(t in Wc&&(e=Wc[t].queryId,delete Wc[t],n=!0),localStorage.setItem("privateComment",JSON.stringify(Wc)),e){var i=!0;for(var r in Wc)if(Wc[r].queryId===e){i=!1;break}i&&(delete qc[e],localStorage.setItem("queryTable",JSON.stringify(qc)))}return n}function Zc(t){return Wc[t]}function Jc(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),r=t.getHours(),a=t.getMinutes(),o=t.getSeconds();return e+(n=n<10?"0"+n.toString():n.toString())+(i=i<10?"0"+i.toString():i.toString())+(r=r<10?"0"+r.toString():r.toString())+(a=a<10?"0"+a.toString():a.toString())+(o=o<10?"0"+o.toString():o.toString())}function Kc(t){var e=$("#extractionMainMenu").css("display");"none"===t||"block"===e?($("#extractionMainMenu").css("display","none"),$("#extractionMenu").css("width","0%"),$("#extractionResults").length>0?$("#extractionResults").css("width","100%"):$("#clusteringResults").length>0&&($("#clusteringResults").css("width","100%"),$("#clusteringProcess").css("display","block"),$("#clusteringProcess").css("width","20%"),$("#clusteringResultsOverview").css("width","60%"),$("#clusteringDetail").css("width","20%")),$("#collapseExtractionMenu").text("Open")):"block"!==t&&"none"!==e||($("#extractionMainMenu").css("display","block"),$("#extractionMenu").css("width","30%"),$("#extractionResults").length>0?$("#extractionResults").css("width","70%"):$("#clusteringResults").length>0&&($("#clusteringResults").css("width","70%"),$("#clusteringProcess").css("display","none"),$("#clusteringResultsOverview").css("width","70%"),$("#clusteringDetail").css("width","30%")),$("#collapseExtractionMenu").text("Close"))}function th(){var t=$("#QBESourceMain").css("display");"block"===t?($("#QBESourceMain").css("display","none"),$("#QBESource").css("width","0%"),$("#QBESource").css("padding","0px"),$("#extractionResults").css("width","70%"),$("#collapseSourcePanel").text("Open")):"none"===t&&($("#QBESourceMain").css("display","block"),$("#QBESource").css("width","30%"),$("#QBESource").css("padding","15px"),$("#extractionResults").css("width","40%"),$("#collapseSourcePanel").text("Close"))}function eh(){var t=$("#resultDetailArea").css("display");"block"===t?($("#resultDetailArea").css("display","none"),$("#resultDetail").css("height","1.5rem"),$("#resultDetail").css("margin-bottom","0"),$("#collapseResultDetailPanel").text("Open")):"none"===t&&($("#resultDetailArea").css("display","block"),$("#resultDetail").css("height","auto"),$("#resultDetail").css("margin-bottom","1.5rem"),$("#collapseResultDetailPanel").text("Close"))}function nh(){for(var t=$("input[name=QBEActive]:checked"),e=[],n=0;n<t.length;n++)e.push(t[n].value);return e}function ih(t){var e=t.replace(/([A-Z])/g," $1");return e=e.charAt(0).toUpperCase()+e.slice(1)}function rh(t){var e="",n=t.split(" ");e=n[0];for(var i=1;i<n.length;i++)e+=n[i].charAt(0).toUpperCase()+n[i].slice(1);return e=e.charAt(0).toLowerCase()+e.slice(1)}function ah(t){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function sh(t,e){return(sh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ch(t);if(e){var r=ch(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return uh(this,n)}}function uh(t,e){return!e||"object"!==ah(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ch(t){return(ch=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hh=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sh(t,e)}(a,t);var e,n,i,r=lh(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).visualQuery=!1,t.mode="AE",t.AEOptions={flare:!1,rotation:!1,anomaly:!1},t.source=-1,t.target=[],t.selector=!0,t.dragSelection=!0,t.tubeAttributes=[],t.selectedPeriod=[-1,-1],t.extractionResults=[],t.query={},t.activeVar=["x","y","H","V"],t.parameters={},t.kValue=20,t.order="timeStamp",t.distanceThreshold="",t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPDATE_SOURCE":this.updateSource(t.id);break;case"UPDATE_TARGET":this.updateTarget(t.ids);break;case"SWITCH_SELECTOR":this.switchSelector(t.selector);break;case"SWITCH_DRAGSELECTION":this.switchDragSelection();break;case"RESET_SELECTION":this.resetSelection();break;case"SELECT_TIMEINTERVAL":this.selectTimeInterval(t.value);break;case"SWITCH_QUERY_MODE":this.switchQueryMode(t.mode);break;case"UPLOAD_TUBE_ATTRIBUTES":this.uploadTubeAttributes(t.id,t.position,t.color,t.indices);break;case"UPDATE_SELECTED_PERIOD":this.updateSelectedPeriod(t.period);break;case"SELECT_PERIOD_FROM_SP":this.selectPeriodfromSP(t.period);break;case"SET_ACTIVE_VARIABLES":this.setActiveVariables(t.varList);break;case"SET_EXTRACTION_RESULTS":this.setExtractionResults(t.parameters,t.results,t.query,t.activeVar);break;case"SHOW_LINE_CHARTS":this.showLineCharts(t.LC);break;case"UPDATE_SELECTED_RESULT":this.updateSelectedResult(t.result,t.width,t.height);break;case"CLEAR_RESULTS":this.emit("clearResults");break;case"SET_QUERY":this.setQuery(t.query);break;case"CONVERT_RESULT_INTO_QUERY":this.convertResultIntoQuery(t.id,t.period,t.activeVar);break;case"UPDATE_AE_OPTION":this.updateAEOption(t.option,t.value);break;case"UPDATE_SHOWN_RESULTS":this.updateShownResults(t.results);break;case"FOCUS_RESULT_FROM_TIMELINE":this.focusResultFromTimeline(t.result);break;case"SELECT_RESULT_FROM_TIMELINE":this.selectResultFromTimeline(t.result);break;case"SWITCH_QBE_SELECTOR_SP":this.switchQBESelectorSP(t.selector);break;case"UPDATE_K_VALUE":this.updateKValue(t.k);break;case"UPDATE_ORDER":this.updateOrder(t.order);break;case"UPDATE_DISTANCE_THRESHOLD":this.updateDistanceThreshold(t.threshold);break;case"RECOVER_QUERY":this.recoverQuery(t.query);break;case"IMPORT_RESULTS_FROM_FILE":this.importResultsFromFile(t.results);break;case"CONVERT_CLUSTER_CENTER_INTO_QUERY":this.convertClusterCenterIntoQuery(t.clusterCenter);break;case"CHANGE_DTW_MODE":this.emit("changeDTWMode",t.DTWMode)}}},{key:"getVisualQuery",value:function(){return this.visualQuery}},{key:"getSource",value:function(){return this.source}},{key:"getTarget",value:function(){return this.target}},{key:"getSelector",value:function(){return this.selector}},{key:"getDragSelection",value:function(){return this.dragSelection}},{key:"getSelectedPeriod",value:function(){return this.selectedPeriod}},{key:"getMode",value:function(){return this.mode}},{key:"getTubeAttributes",value:function(t){return this.tubeAttributes[t]}},{key:"getExtractionResults",value:function(){return this.extractionResults}},{key:"getActive",value:function(){return this.activeVar}},{key:"getQuery",value:function(){return this.query}},{key:"getAEOptions",value:function(){return this.AEOptions}},{key:"getAEOptionStatus",value:function(t){return this.AEOptions[t]}},{key:"getParameters",value:function(){return this.parameters}},{key:"getKValue",value:function(){return this.kValue}},{key:"getOrder",value:function(){return this.order}},{key:"getDistanceThreshold",value:function(){return this.distanceThreshold}},{key:"updateSource",value:function(t){this.source=t,this.emit("updateSource")}},{key:"updateTarget",value:function(t){this.target=t,this.emit("updateTarget")}},{key:"switchSelector",value:function(t){this.selector=t,this.emit("switchSelector")}},{key:"switchDragSelection",value:function(){this.dragSelection=!this.dragSelection,this.emit("switchDragSelection")}},{key:"resetSelection",value:function(){this.emit("resetSelection")}},{key:"resetAEOptions",value:function(){for(var t in this.AEOptions)this.AEOptions[t]=!1}},{key:"selectTimeInterval",value:function(t){var e=this.source,n=Number(t),i=tc.getFocused(Number(e))+Gu.getData(Number(e)).data.meta.min.z;this.selectedPeriod=[i,i+n],this.emit("selectTimeInterval",e,n)}},{key:"switchQueryMode",value:function(t){if(this.mode=t,"AE"!==t)for(var e in this.AEOptions)this.AEOptions[e]=!1;"QBE"!==t&&(this.source="default",this.activeVar=["x","y","H","V"],function(){for(var t=$("input[name=QBEActive]:checked"),e=0;e<t.length;e++)t[e].checked=!1}()),this.emit("switchQueryMode",t)}},{key:"uploadTubeAttributes",value:function(t,e,n,i){this.tubeAttributes[t]={position:e,color:n,indices:i},this.emit("uploadTubeAttributes")}},{key:"updateSelectedPeriod",value:function(t){this.selectedPeriod=t,this.emit("updateSelectedPeriod")}},{key:"selectPeriodfromSP",value:function(t){this.selectedPeriod=t,this.emit("updateSelectedPeriod")}},{key:"setActiveVariables",value:function(t){this.emit("setActiveVariables",t)}},{key:"setExtractionResults",value:function(t,e,n,i){this.parameters=void 0!==t?t:{},this.extractionResults=e,this.query=n,this.activeVar=void 0!==i?i:[],this.emit("setExtractionResults")}},{key:"setTexture",value:function(t){this.texture=t,this.emit("setTexture")}},{key:"showLineCharts",value:function(t){this.emit("showLineCharts",t)}},{key:"updateSelectedResult",value:function(t,e,n){this.emit("updateSelectedResult",t,e,n)}},{key:"setQuery",value:function(t){this.query=t,this.emit("setQuery")}},{key:"convertResultIntoQuery",value:function(t,e,n){"QBE"==this.mode&&(this.selectedPeriod=e,this.activeVar=n),this.emit("convertResultIntoQuery",t,e,n)}},{key:"updateAEOption",value:function(t,e){this.AEOptions[t]=e,this.emit("updateAEOption")}},{key:"updateShownResults",value:function(t){this.emit("updateShownResults",t)}},{key:"focusResultFromTimeline",value:function(t){this.emit("focusResultFromTimeline",t)}},{key:"selectResultFromTimeline",value:function(t){this.emit("selectResultFromTimeline",t)}},{key:"switchQBESelectorSP",value:function(t){this.emit("switchQBESelectorSP",t)}},{key:"updateKValue",value:function(t){this.kValue=t,this.emit("updateKValue")}},{key:"updateOrder",value:function(t){this.order=t,this.emit("updateOrder")}},{key:"updateDistanceThreshold",value:function(t){this.distanceThreshold=t,this.emit("updateDistanceThreshold")}},{key:"recoverQuery",value:function(t){if("automatic extraction"===t.mode){this.mode="AE",this.resetAEOptions();for(var e=0;e<t.option.length;e++)this.AEOptions[t.option[e]]=!0}else if("visual query"===t.mode)if("query-by-example"===t.option){this.mode="QBE",this.selectedPeriod=t.query.period,this.source=Gu.getIdFromName(t.query.source);var n=Gu.getData(this.source).data.lookup,i=[];if(t.query.inactiveVariables){for(var r=[],a=0;a<t.query.inactiveVariables.length;a++)for(var o in n)n[o].indexOf(t.query.inactiveVariables[a][0])>=0&&r.push(o);for(var s in n)r.indexOf(s)<0&&i.push(s)}else t.query.activeVariables&&(i=t.query.activeVariables);this.activeVar=i,this.parameters=t.parameters}else"query-by-sketch"===t.option&&(this.mode="QBS",this.parameters=t.parameters);for(var l=[],u=Gu.getAllData(),c=0;c<u.length;c++)l.push(u[c].id);this.target=l,this.emit("recoverQuery",t)}},{key:"importResultsFromFile",value:function(t){this.emit("importResultsFromFile",t)}},{key:"convertClusterCenterIntoQuery",value:function(t){this.emit("convertClusterCenterIntoQuery",t)}}])&&oh(e.prototype,n),i&&oh(e,i),a}(su.EventEmitter));iu.register(hh.handleActions.bind(hh));var dh=hh;function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ph(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mh(t,e){return(mh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=yh(t);if(e){var r=yh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return vh(this,n)}}function vh(t,e){return!e||"object"!==fh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yh(t){return(yh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bh=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mh(t,e)}(a,t);var e,n,i,r=gh(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).viewportSize=18,t.gridSize=18,t.datasets=[],t.subsequences=[],t.ranges=[],t.clusterCenters=[],t.labels=[],t.clusterColors=[],t.clusteringParameters={},t.subsequenceParameters={},t.clusteringScores={},t.filteringProcess={},t.originalResults={},t.selectedSS={},t.updatedSS={},t.selectedCluster=-1,t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"SHOW_CLUSTERING_RESULTS":this.showClusteringResults(t.datasets,t.subsequences,t.ranges,t.clusterCenters,t.labels,t.clusteringParameters,t.subsequenceParameters,t.clusteringScores,t.filteringProcess);break;case"SHOW_CLUSTER_DETAILS":this.showClusterDetails(t.cluster);break;case"SHOW_FILTERING_STEP":this.showFilteringStep(t.selectedProcess);break;case"UPDATE_CLUSTERING_RESULTS":this.updateClusteringResults(t.subsequences,t.clusterCenters,t.labels,t.clusteringScores,t.selectedSS,t.updatedSS);break;case"RESET_CLUSTERING_RESULTS":this.resetClusteringResults();break;case"UPDATE_SS_SELECTION":this.updateSSSelection(t.selectedSS,t.updatedSS)}}},{key:"getViewportSize",value:function(){return this.viewportSize}},{key:"getGridSize",value:function(){return this.gridSize}},{key:"getDatasets",value:function(){return this.datasets}},{key:"getSubsequences",value:function(){return this.subsequences}},{key:"getRanges",value:function(){return this.ranges}},{key:"getClusterCenters",value:function(){return this.clusterCenters}},{key:"getLabels",value:function(){return this.labels}},{key:"getClusterColors",value:function(){return this.clusterColors}},{key:"getClusteringParameters",value:function(){return this.clusteringParameters}},{key:"getSubsequenceParameters",value:function(){return this.subsequenceParameters}},{key:"getClusteringScores",value:function(){return this.clusteringScores}},{key:"getFilteringProcess",value:function(){return this.filteringProcess}},{key:"getSelectedSS",value:function(){return this.selectedSS}},{key:"getUpdatedSS",value:function(){return this.updatedSS}},{key:"getSelectedCluster",value:function(){return this.selectedCluster}},{key:"showClusteringResults",value:function(t,e,n,i,r,a,o,s,l){this.datasets=t,this.subsequences=e,this.ranges=n,this.clusterCenters=i,this.labels=r;var u=this.viewportSize*Math.PI/this.clusterCenters.length;this.gridSize=.8*u,this.clusterColors=[];for(var c=0;c<this.clusterCenters.length;c++){var h=360*c/this.clusterCenters.length;this.clusterColors.push([h,.5,.5])}this.clusteringParameters=a,this.subsequenceParameters=o,this.clusteringScores=s,this.filteringProcess=l,this.originalResults={subsequences:e,clusterCenters:i,labels:r,clusteringScores:s},this.selectedSS={};for(var d=0;d<t.length;d++)this.selectedSS[t[d]]=[],this.updatedSS[t[d]]=[];for(var f=0;f<t.length;f++)for(var p=0;p<e.length;p++)this.selectedSS[t[f]].push(e[p].idx);this.selectedCluster=-1,this.emit("showClusteringResults")}},{key:"showClusterDetails",value:function(t){this.selectedCluster=t,this.emit("showClusterDetails",t)}},{key:"showFilteringStep",value:function(t){this.emit("showFilteringStep",t)}},{key:"updateClusteringResults",value:function(t,e,n,i,r,a){this.subsequences=t,this.clusterCenters=e,this.labels=n,this.clusteringScores=i,this.selectedSS=r,this.updatedSS=a,this.emit("updateClusteringResults")}},{key:"resetClusteringResults",value:function(){this.subsequences=this.originalResults.subsequences,this.clusterCenters=this.originalResults.clusterCenters,this.labels=this.originalResults.labels,this.clusteringScores=this.originalResults.clusteringScores,this.updatedSS=[],this.emit("resetClusteringResults")}},{key:"updateSSSelection",value:function(t,e){this.selectedSS=t,this.updatedSS=e,this.emit("updateSSSelection")}}])&&ph(e.prototype,n),i&&ph(e,i),a}(su.EventEmitter));iu.register(bh.handleActions.bind(bh));var xh=bh,_h=n(1);_h.BufferGeometryUtils={computeTangents:function(t){var e=t.index,n=t.attributes;if(null!==e&&void 0!==n.position&&void 0!==n.normal&&void 0!==n.uv){var i=e.array,r=n.position.array,a=n.normal.array,o=n.uv.array,s=r.length/3;void 0===n.tangent&&t.setAttribute("tangent",new _h.BufferAttribute(new Float32Array(4*s),4));for(var l=n.tangent.array,u=[],c=[],h=0;h<s;h++)u[h]=new _h.Vector3,c[h]=new _h.Vector3;var d=new _h.Vector3,f=new _h.Vector3,p=new _h.Vector3,m=new _h.Vector2,g=new _h.Vector2,v=new _h.Vector2,y=new _h.Vector3,b=new _h.Vector3,x=t.groups;0===x.length&&(x=[{start:0,count:i.length}]);h=0;for(var _=x.length;h<_;++h)for(var w=L=(O=x[h]).start,S=L+O.count;w<S;w+=3)R(i[w+0],i[w+1],i[w+2]);var E,M,C,T=new _h.Vector3,k=new _h.Vector3,P=new _h.Vector3,A=new _h.Vector3;for(h=0,_=x.length;h<_;++h){var O,L;for(w=L=(O=x[h]).start,S=L+O.count;w<S;w+=3)I(i[w+0]),I(i[w+1]),I(i[w+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function R(t,e,n){d.fromArray(r,3*t),f.fromArray(r,3*e),p.fromArray(r,3*n),m.fromArray(o,2*t),g.fromArray(o,2*e),v.fromArray(o,2*n);var i=f.x-d.x,a=p.x-d.x,s=f.y-d.y,l=p.y-d.y,h=f.z-d.z,x=p.z-d.z,_=g.x-m.x,w=v.x-m.x,S=g.y-m.y,E=v.y-m.y,M=1/(_*E-w*S);y.set((E*i-S*a)*M,(E*s-S*l)*M,(E*h-S*x)*M),b.set((_*a-w*i)*M,(_*l-w*s)*M,(_*x-w*h)*M),u[t].add(y),u[e].add(y),u[n].add(y),c[t].add(b),c[e].add(b),c[n].add(b)}function I(t){P.fromArray(a,3*t),A.copy(P),M=u[t],T.copy(M),T.sub(P.multiplyScalar(P.dot(M))).normalize(),k.crossVectors(A,M),C=k.dot(c[t]),E=C<0?-1:1,l[4*t]=T.x,l[4*t+1]=T.y,l[4*t+2]=T.z,l[4*t+3]=E}},mergeBufferGeometries:function(t,e){for(var n=null!==t[0].index,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),a={},o={},s=new _h.BufferGeometry,l=0,u=0;u<t.length;++u){var c=t[u];if(n!==(null!==c.index))return null;for(var h in c.attributes){if(!i.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(c.attributes[h])}for(var h in c.morphAttributes){if(!r.has(h))return null;void 0===o[h]&&(o[h]=[]),o[h].push(c.morphAttributes[h])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(c.userData),e){var d;if(n)d=c.index.count;else{if(void 0===c.attributes.position)return null;d=c.attributes.position.count}s.addGroup(l,d,u),l+=d}}if(n){var f=0,p=[];for(u=0;u<t.length;++u){for(var m=t[u].index,g=0;g<m.count;++g)p.push(m.getX(g)+f);f+=t[u].attributes.position.count}s.setIndex(p)}for(var h in a){var v=this.mergeBufferAttributes(a[h]);if(!v)return null;s.setAttribute(h,v)}for(var h in o){var y=o[h][0].length;if(0===y)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[h]=[];for(u=0;u<y;++u){var b=[];for(g=0;g<o[h].length;++g)b.push(o[h][g][u]);var x=this.mergeBufferAttributes(b);if(!x)return null;s.morphAttributes[h].push(x)}}return s},mergeBufferAttributes:function(t){for(var e,n,i,r=0,a=0;a<t.length;++a){var o=t[a];if(o.isInterleavedBufferAttribute)return null;if(void 0===e&&(e=o.array.constructor),e!==o.array.constructor)return null;if(void 0===n&&(n=o.itemSize),n!==o.itemSize)return null;if(void 0===i&&(i=o.normalized),i!==o.normalized)return null;r+=o.array.length}var s=new e(r),l=0;for(a=0;a<t.length;++a)s.set(t[a].array,l),l+=t[a].array.length;return new _h.BufferAttribute(s,n,i)},interleaveAttributes:function(t){for(var e,n=0,i=0,r=0,a=t.length;r<a;++r){var o=t[r];if(void 0===e&&(e=o.array.constructor),e!==o.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;n+=o.array.length,i+=o.itemSize}var s=new _h.InterleavedBuffer(new e(n),i),l=0,u=[],c=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"],d=0;for(a=t.length;d<a;d++){var f=(o=t[d]).itemSize,p=o.count,m=new _h.InterleavedBufferAttribute(s,f,l,o.normalized);u.push(m),l+=f;for(var g=0;g<p;g++)for(var v=0;v<f;v++)m[h[v]](g,o[c[v]](g))}return u},estimateBytesUsed:function(t){var e=0;for(var n in t.attributes){var i=t.getAttribute(n);e+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}var r=t.getIndex();return e+=r?r.count*r.itemSize*r.array.BYTES_PER_ELEMENT:0},mergeVertices:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;e=Math.max(e,Number.EPSILON);for(var n={},i=t.getIndex(),r=t.getAttribute("position"),a=i?i.count:r.count,o=0,s=Object.keys(t.attributes),l={},u={},c=[],h=["getX","getY","getZ","getW"],d=0,f=s.length;d<f;d++){l[b=s[d]]=[],(S=t.morphAttributes[b])&&(u[b]=new Array(S.length).fill().map((function(){return[]})))}var p=Math.log10(1/e),m=Math.pow(10,p);for(d=0;d<a;d++){var g=i?i.getX(d):d,v="",y=0;for(f=s.length;y<f;y++)for(var b=s[y],x=(w=t.getAttribute(b)).itemSize,_=0;_<x;_++)v+="".concat(~~(w[h[_]](g)*m),",");if(v in n)c.push(n[v]);else{for(y=0,f=s.length;y<f;y++){b=s[y];var w=t.getAttribute(b),S=t.morphAttributes[b],E=(x=w.itemSize,l[b]),M=u[b];for(_=0;_<x;_++){var C=h[_];if(E.push(w[C](g)),S)for(var T=0,k=S.length;T<k;T++)M[T].push(S[T][C](g))}}n[v]=o,c.push(o),o++}}var P=t.clone();for(d=0,f=s.length;d<f;d++){b=s[d];var A=t.getAttribute(b),O=new A.array.constructor(l[b]);if(A.isInterleavedBufferAttribute?w=new _h.BufferAttribute(O,A.itemSize,A.itemSize):(w=t.getAttribute(b).clone()).setArray(O),P.setAttribute(b,w),b in u)for(y=0;y<u[b].length;y++){var L=t.morphAttributes[b][y].clone();L.setArray(new L.array.constructor(u[b][y])),P.morphAttributes[b][y]=L}}var R=Uint8Array;c.length>=Math.pow(2,8)&&(R=Uint16Array),c.length>=Math.pow(2,16)&&(R=Uint32Array);var I=new R(c);c=null;return null===i?c=new _h.BufferAttribute(I,1):(c=t.getIndex().clone()).setArray(I),P.setIndex(c),P}};var wh=_h.BufferGeometryUtils,Sh=n(18),Eh=n.n(Sh),Mh=n(19),Ch=n.n(Mh);function Th(t){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ph(t,e){return(Ph=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ah(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Lh(t);if(e){var r=Lh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Oh(this,n)}}function Oh(t,e){return!e||"object"!==Th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lh(t){return(Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ph(t,e)}(o,t);var e,n,i,a=Ah(o);function o(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.canvas,e.cameraProp=tc.getCameraProp(t.id),e.tubeNum=16,e.segment=16,e.division=5,e.currentHighlightedPlot=0,e.drag=!1,e.visualQuery=!1,e.dragSelection=!1,e.selector=!0,e.averagePeriod=0,e.animationPara={flag:!1,dep:0,dst:0,speed:40,now:0},e.raycaster=new Ru.Raycaster,e.vertex=document.getElementById("vertexShader_tube").textContent,e.fragment=document.getElementById("fragmentShader_tube").textContent,e.lock=!1,e.opacityCurve=tc.getOpacityCurve("Default"),e.rotationPeriod=null,e.wheelInterval=1,e.colorEncodingOption={hue:"default",value:"default"},e.data.merge){e.plotColor=[],e.idNameLookup={};for(var n=e.data.name.split(","),i=0;i<n.length;i++){var r=Gu.getIdFromName(n[i]);e.idNameLookup[n[i]]=i;var s=n[i].split("+");if(s.length>1)for(var l=0;l<s.length;l++)e.idNameLookup[s[l]]=i;e.plotColor.push(tc.getPlotColor(r))}tc.setPlotColorbyIdx(e.id,e.plotColor)}else tc.setPlotColorbyIdx(e.id,(tc.getInitColorIdx()+e.id)%tc.getPresetNum()),e.plotColor=tc.getPlotColor(e.id);return e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"render",value:function(){var t=this;return this.updateSize(this.props.width,this.props.height),r.a.createElement("div",{style:{position:"relative",float:"left"}},r.a.createElement("div",{className:"TimeTubes",style:{width:this.props.width+"px",height:this.props.height+"px"},ref:function(e){t.mount=e}}),r.a.createElement(kc,null))}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"componentDidMount",value:function(){var t=this,e=this.mount.clientWidth,n=this.mount.clientHeight;this.scene=new Ru.Scene,this.setCameras(e,n),this.renderer=new Ru.WebGLRenderer({preserveDrawingBuffer:!0}),this.renderer.setClearColor(new Ru.Color(Number(tc.getBackgroundColor()))),this.renderer.setSize(e,n),this.renderer.localClippingEnabled=!0,this.renderer.domElement.id="TimeTubes_viewport_"+this.id,this.renderer.domElement.className="TimeTubes_viewport",this.canvas=this.renderer.domElement,this.initQBEView(),this.mount.appendChild(this.renderer.domElement),this.renderScene(),this.start(),this.clippingPlane=new Ru.Plane(new Ru.Vector3(0,0,-1),0),this.clippingPlane2=new Ru.Plane(new Ru.Vector3(0,0,1),0);var i=new Ru.DirectionalLight(16777215,.7);i.position.set(-20,40,60),this.scene.add(i);var r=new Ru.AmbientLight(2697513);this.scene.add(r),this.addControls();var a=document.querySelector("#TimeTubes_viewport_"+this.id),o=this.onMouseWheel(),s=this.onMouseDown(),l=this.onMouseMove(),u=this.onMouseUp(),c=this.onMouseClick();a.addEventListener("wheel",o.bind(this),!1),a.addEventListener("mousedown",s.bind(this),!1),a.addEventListener("mousemove",l.bind(this),!1),a.addEventListener("mouseup",u.bind(this),!1),a.addEventListener("click",c.bind(this),!1),this.tubeGroup=new Ru.Group,this.scene.add(this.tubeGroup),(new Ru.TextureLoader).load("img/1_256.png",function(t){!function(t,e){iu.dispatch({type:"SET_TEXTURE",id:t,texture:e})}(this.id,t),this.drawTube(t)}.bind(this)),this.drawGrid(2*tc.getGridSize(),10),this.drawLabel(tc.getGridSize()/this.data.meta.range),this.drawAxis(),this.drawPlot(),this.drawDisk(),this.drawDiskForRotationCenter(),this.drawComment(),this.drawPeriodMarker(),Gu.on("updatePrivateComment",(function(){t.updateComment()})),tc.on("upload",(function(){t.cameraProp=tc.getCameraProp(t.id),t.updateCamera()})),tc.on("updateCamera",(function(e){e===t.id&&(t.cameraProp=tc.getCameraProp(t.id),t.updateCamera())})),tc.on("reset",(function(e){e===t.id&&(t.cameraProp=tc.getCameraProp(t.id),0===t.cameraProp.xpos&&0===t.cameraProp.ypos&&50===t.cameraProp.zpos&&t.resetCamera())})),tc.on("switch",(function(){t.cameraProp=tc.getCameraProp(t.id),t.switchCamera()})),tc.on("searchTime",(function(e,n){e===t.id&&t.searchTime(n)})),tc.on("switchGrid",(function(e,n){e===t.id&&(t.grid.visible=n)})),tc.on("switchLabel",(function(e,n){e===t.id&&(t.labelGroup.visible=n)})),tc.on("switchAxis",(function(e,n){e===t.id&&(t.axis.visible=n)})),tc.on("switchPlot",(function(e,n){e===t.id&&(t.plot.visible=n)})),tc.on("changeBackground",(function(){t.scene.background=new Ru.Color(Number(tc.getBackgroundColor()))})),tc.on("clipTube",(function(e,n){e===t.id&&(t.renderer.localClippingEnabled=n)})),tc.on("switchShade",(function(e,n){e===t.id&&(t.tube.material.uniforms.shade.value=n)})),tc.on("changeFar",(function(e,n){e===t.id&&(t.cameraProp=tc.getCameraProp(t.id),t.clippingPlane2.constant=n,t.renderer.clippingPlanes=[t.clippingPlane2],t.renderer.render(t.scene,t.camera))})),tc.on("updateMinMaxH",(function(e){e===t.id&&t.setMinMaxH(tc.getMinMaxH(t.id))})),tc.on("updateMinMaxV",(function(e){e===t.id&&t.setMinMaxV(tc.getMinMaxV(t.id))})),tc.on("changePlotColor",(function(e){if(e===t.id)t.plotColor=tc.getPlotColor(t.id),t.drawPlot();else if(t.data.merge){var n=Gu.getFileName(e);t.data.name.indexOf(n)>=0&&(t.plotColor[t.idNameLookup[n]]=tc.getPlotColor(e),t.drawPlot())}})),tc.on("timeFitting",(function(e){if(tc.getChecked(t.id)){var n=tc.getFocused(t.id)+t.data.spatial[0].z,i=e;n<t.data.spatial[0].z?i=t.data.spatial[0].z:t.data.spatial[t.data.spatial.length-1].z<n&&(i=t.data.spatial[t.data.spatial.length-1].z),t.lock&&tc.setLock(t.id,i-t.data.spatial[0].z),t.searchTime(i)}})),tc.on("lockControl",(function(e,n){!n||e.indexOf(t.id)<0?t.lock=!1:(t.lock=!0,t.resetCamera())})),tc.on("synchronizeTubes",(function(e,n,i,r){if(t.lock&e!==t.id)if(0!==n){var a=t.data.meta.min.z,o=t.data.meta.max.z,s=n+tc.getLock(t.id)-tc.getLock(e)+a;a<=s&&s<=o||(s<a?s=a:o<s&&(s=o)),t.searchTime(s)}else i.equals(new Ru.Vector3(0,0,0))||(t.controls.object.position.set(i.x,i.y,i.z),t.controls.object.rotation.set(r.x,r.y,r.z))})),tc.on("updateZoomTimeTubes",(function(e){e===t.id&&(t.cameraProp=tc.getCameraProp(t.id),t.updateCamera())})),tc.on("takeSnapshot",(function(e,n,i){e===t.id&&(t.deselectAll(),t.tubeGroup.position.z=n,void 0!==i&&(t.clippingPlane2.constant=i,t.renderer.clippingPlanes=[t.clippingPlane2]),t.renderer.render(t.scene,t.camera))})),tc.on("recoverTube",(function(e,n,i){e===t.id&&(t.cameraProp=tc.getCameraProp(t.id),t.tubeGroup.position.z=i,t.updateCamera(),t.renderer.clippingPlanes=[])})),tc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&(t.resetCamera(),t.tubeGroup.position.z=tc.getFocused(e),t.clippingPlane2.constant=n[1]-n[0],t.renderer.clippingPlanes=[t.clippingPlane2],t.showPeriod(n))})),tc.on("updateAveragePeriod",(function(){if(t.averagePeriod=tc.getAveragePeriod(),t.averagePeriod>0){var e=Gu.getAverage(t.id,t.tubeGroup.position.z,t.averagePeriod);t.disk.visible=!0,t.disk.position.x=e.x*t.data.meta.range,t.disk.position.y=e.y*t.data.meta.range}else t.disk.visible=!1})),tc.on("updateTexture",(function(e,n){e===t.id&&(t.tube.material.uniforms.texture.value=n)})),tc.on("showRotationCenter",(function(e,n,i){e===t.id?(t.resetCamera(),t.tubeGroup.position.z=tc.getFocused(e),t.diskRotation.visible=!0,t.diskRotation.position.x=i.x*t.data.meta.range,t.diskRotation.position.y=i.y*t.data.meta.range,t.rotationPeriod=n,t.clippingPlane2.constant=n[1]-n[0],t.renderer.clippingPlanes=[t.clippingPlane2],t.showPeriod(n)):t.rotationPeriod=null})),tc.on("switchComment",(function(e,n){e===t.id&&(n?t.comment.visible=!0:(t.comment.visible=!1,t.commentContents.visible=!1))})),tc.on("updateWheelInterval",(function(){t.wheelInterval=tc.getWheelInterval()})),tc.on("updateColorEncodingOptionHue",(function(e,n){e===t.id&&(t.colorEncodingOption.hue=n,t.updateColorEncodingOptionHue())})),tc.on("updateColorEncodingOptionValue",(function(e,n){e===t.id&&(t.colorEncodingOption.value=n,t.updateColorEncodingOptionValue())})),dh.on("switchQueryMode",(function(e){var n=dh.getSource();"QBE"===e&&"default"!==n?(t.visualQuery=Number(n)===t.id,t.setQBEView(),t.resetSelection()):t.deselectAll()})),dh.on("updateSource",(function(){var e=dh.getMode(),n=dh.getSource();"QBE"===e&&"default"!==n&&(t.visualQuery=Number(n)===t.id,t.setQBEView(),t.resetSelection())})),dh.on("switchDragSelection",(function(){t.dragSelection=dh.getDragSelection(),t.updateControls()})),dh.on("resetSelection",(function(){t.tube&&t.deselectAll()})),dh.on("switchSelector",(function(){t.selector=dh.getSelector()})),dh.on("selectTimeInterval",(function(e,n){"QBE"===dh.getMode()&&Number(e)===t.id&&t.paintSelectedPeriod()})),dh.on("updateSelectedPeriod",(function(){var e=dh.getSource();"QBE"===dh.getMode()&&Number(e)===t.id&&t.paintSelectedPeriod()})),dh.on("convertResultIntoQuery",(function(e,n,i){"QBE"===dh.getMode()&&e===t.id&&(t.visualQuery=Number(e)===t.id,t.setQBEView(),t.resetSelection(),t.paintSelectedPeriod())})),dh.on("recoverQuery",(function(e){"QBE"===dh.getMode()&&Number(dh.getSource())===t.id&&(t.visualQuery=!0,setTimeout(function(){this.setQBEView(),this.resetSelection(),this.paintSelectedPeriod()}.bind(t),0))})),xh.on("showClusteringResults",(function(){var e=xh.getSubsequences(),n=xh.getLabels(),i=xh.getClusterColors();t.showClusteringResults(e,n,i)}))}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera),this.renderer&&this.renderer.render(this.scene,this.camera)}},{key:"addControls",value:function(){this.controls=new Eh.a(this.camera,this.renderer.domElement),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"updateControls",value:function(){this.visualQuery&&this.dragSelection?this.QBEControls&&(this.QBEControls.enabled=!1):this.QBEControls&&(this.QBEControls.enabled=!0)}},{key:"onMouseWheel",value:function(){return function(t){t.preventDefault();var e,n,i,r,a=t.deltaY>0,o=!1,s=this.tubeGroup.position.z,l=this.tubeGroup.position.z;if((l+=a?this.wheelInterval:-1*this.wheelInterval)<0?l=0:l>this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z&&(l=this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z),a)for(e=0;e<this.data.spatial.length;e++){var u=this.data.spatial[e].z-this.data.spatial[0].z;if(Math.min(s,l)<u&&u<Math.max(s,l)){l=u,"x"in this.data.spatial[e]&&(o=!0);break}}else for(e=this.data.spatial.length-1;e>=0;e--){var c=this.data.spatial[e].z-this.data.spatial[0].z;if(Math.min(s,l)<c&&c<Math.max(s,l)){l=c,"x"in this.data.spatial[e]&&(o=!0);break}}if(l===this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z&&"x"in this.data.spatial[this.data.spatial.length-1]&&(o=!0),0===l&&"x"in this.data.spatial[0]&&(o=!0),n=this.data.merge?new Ru.Color(Number("0x"+this.plotColor[this.idNameLookup[this.data.spatial[this.currentHighlightedPlot].source]].slice(1))):new Ru.Color(Number("0x"+this.plotColor.slice(1))),this.changePlotColor(this.currentHighlightedPlot*this.segment,n),o)if(this.data.merge)for(var h=0,d=0;d<this.data.spatial.length;d++)"x"in this.data.spatial[d]&&(l===this.data.spatial[d].z-this.data.spatial[0].z&&(this.changePlotColor(h*this.segment,new Ru.Color("red")),this.currentHighlightedPlot=h),h++);else for(var f=0;f<this.data.splines.position.points.length;f++)l===this.data.spatial[f].z-this.data.spatial[0].z&&(this.changePlotColor(f*this.segment,new Ru.Color("red")),this.currentHighlightedPlot=f);if(this.periodStartMarker.visible&&(this.periodGroup.position.z=this.periodGroup.position.z+(l-this.tubeGroup.position.z)),this.tubeGroup.position.z=l,this.clusteringGroup&&(this.clusteringGroup.position.z=l),this.diskRotation.visible&&(l<this.rotationPeriod[0]-this.data.spatial[0].z||this.rotationPeriod[1]-this.data.spatial[0].z<l)&&(this.diskRotation.visible=!1,this.rotationPeriod=null),this.renderer.clippingPlanes.length>0&&(this.clippingPlane2.constant=this.cameraProp.far),Cu(this.id,l,o),this.lock&&Au(this.id,l,new Ru.Vector3(0,0,0),new Ru.Vector3(0,0,0)),i=this.id,r=l+this.data.spatial[0].z,iu.dispatch({type:"MOVE_CURRENT_LINE_ON_TIMESELECTOR",id:i,zpos:r}),ac(this.id,l),this.averagePeriod>0){var p=Gu.getAverage(this.id,this.tubeGroup.position.z,this.averagePeriod);this.disk.position.x=p.x*this.data.meta.range,this.disk.position.y=p.y*this.data.meta.range}}.bind(this)}},{key:"onMouseDown",value:function(){return function(t){this.drag=!1}}},{key:"onMouseMove",value:function(){return function(t){if(this.drag=!0,this.drag){if(this.lock){var e=new Ru.Vector3(this.controls.object.rotation._x,this.controls.object.rotation._y,this.controls.object.rotation._z),n=this.controls.object.position;Au(this.id,0,n,e)}if(this.visualQuery&&this.dragSelection){var i=this.getIntersectedIndex(t);if(void 0!==i&&this.tube){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;var r,a=Math.floor(Math.min(i.a,i.b,i.c)/this.segment);r=this.selector?1:0;for(var o=0;o<this.segment;o++)this.tube.geometry.attributes.selected.array[a*this.segment+o]=r,this.tube.geometry.attributes.selected.array[(a+1)*this.segment+o]=r;for(var s=this.tube.geometry.attributes.selected.array.length/this.tubeNum,l=this.tube.geometry.attributes.selected.array.indexOf(1)%s,u=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%s,c=l;c<=u;c++)this.tube.geometry.attributes.selected.array[s*(this.tubeNum-1)+c]=1;var h=this.data.meta.min.z;Rc([Math.floor(l/this.segment)*(1/this.division)+h,(Math.floor(u/this.segment)+1)*(1/this.division)+h]),this.renderer.render(this.scene,this.camera),this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera)}}}}}},{key:"onMouseUp",value:function(){return function(t){if(this.comment.visible&&!this.drag){var e,n=new Ru.Vector2;n.x=t.offsetX/this.renderer.domElement.clientWidth*2-1,n.y=-t.offsetY/this.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(n,this.camera);var i=this.raycaster.intersectObject(this.comment);if(i.length>0&&(e=i[0].face),void 0!==e)if(this.commentContents.visible)this.commentContents.visible=!1;else{this.commentContents.visible=!0;var r=Math.floor(e.a/6),a=Zc(this.commentList[r]),o=a.timeStamp+"\n"+a.userName+"\n";a.comment.length>30?o+=a.comment.substr(0,50):o+=a.comment,this.commentContents.material.map.text=o,this.commentContents.position.set(-tc.getGridSize()-10,0,0)}}else if(this.drag){var s=this.cameraProp;s.xpos=this.camera.position.x,s.ypos=this.camera.position.y,s.zpos=this.camera.position.z,this.cameraProp=s}}}},{key:"onMouseClick",value:function(){return function(t){if(this.drag||!this.visualQuery||this.dragSelection){if(!this.visualQuery){for(var e=document.getElementsByClassName("TimeTubes_viewport"),n=0;n<e.length;n++)e[n].style.border="none";var i=document.getElementById("TimeTubes_viewport_"+this.id);i.style.border="solid 3px red",i.style.boxSizing="border-box",f=this.id,iu.dispatch({type:"ACTIVATE_VIEWPORT",id:f})}}else{var r,a,o=this.getIntersectedIndex(t);if(void 0!==o&&this.tube){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;var s,l=Math.floor(Math.min(o.a,o.b,o.c)/this.segment);Math.floor(l/this.segment),this.division,this.data.meta.min.z,s=this.selector?1:0;for(var u=0;u<this.segment;u++)this.tube.geometry.attributes.selected.array[l*this.segment+u]=s,this.tube.geometry.attributes.selected.array[(l+1)*this.segment+u]=s;var c=this.tube.geometry.attributes.selected.array.length/this.tubeNum;r=this.tube.geometry.attributes.selected.array.indexOf(1)%c,a=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%c;for(var h=r;h<=a;h++)this.tube.geometry.attributes.selected.array[c*(this.tubeNum-1)+h]=1;if(this.renderer.render(this.scene,this.camera),this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera),r>=a)Rc([-1,-1]);else{var d=this.data.meta.min.z;Rc([Math.floor(r/this.segment)*(1/this.division)+d,(Math.floor(a/this.segment)+1)*(1/this.division)+d])}}}var f;this.drag=!1}}},{key:"getIntersectedIndex",value:function(t){var e,n=new Ru.Vector2;n.x=t.offsetX/this.QBERenderer.domElement.clientWidth*2-1,n.y=-t.offsetY/this.QBERenderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(n,this.QBECamera);var i=this.raycaster.intersectObject(this.tube);return i.length>0&&(e=i[0].face),e}},{key:"deselectAll",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var t=0;t<this.tube.geometry.attributes.selected.array.length;t++)this.tube.geometry.attributes.selected.array[t]=0;this.renderer.render(this.scene,this.camera),this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera)}},{key:"resetSelection",value:function(){this.visualQuery||this.deselectAll()}},{key:"selectTimeInterval",value:function(t){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var e=this.tube.geometry.attributes.selected.array.length/this.tubeNum,n=this.tubeGroup.position.z,i=(Math.round(n)*this.division+1)*this.segment+e*(this.tubeNum-1),r=0;r<Math.floor(t)*this.division*this.segment;r++)this.tube.geometry.attributes.selected.array[i+r]=1;for(var a=this.tube.geometry.attributes.selected.array.indexOf(1)%e,o=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%e,s=a;s<=o;s++)this.tube.geometry.attributes.selected.array[e*(this.tubeNum-1)+s]=1;var l=this.data.meta.min.z;Rc([Math.floor(a/this.segment)*(1/this.division)+l,(Math.floor(o/this.segment)+1)*(1/this.division)+l]),this.renderer.render(this.scene,this.camera),this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera)}},{key:"paintSelectedPeriod",value:function(){this.deselectAll();var t=dh.getSelectedPeriod(),e=this.data.meta.min.z,n=this.tube.geometry.attributes.selected.array.length/this.tubeNum,i=Math.ceil(t[0]-e)*this.division*this.segment,r=Math.ceil(t[1]-e)*this.division*this.segment;this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var a=i;a<r;a++)this.tube.geometry.attributes.selected.array[n*(this.tubeNum-1)+a]=1;this.renderer.render(this.scene,this.camera),this.QBERenderer&&this.QBERenderer.render(this.scene,this.QBECamera)}},{key:"changePlotColor",value:function(t,e){for(var n=0;n<this.segment;n++)this.plot.geometry.attributes.color.needsUpdate=!0,this.plot.geometry.attributes.color.setXYZ(t+n,e.r,e.g,e.b)}},{key:"setCameras",value:function(t,e){var n=Math.ceil(this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z+50),i=2*Math.tan(22.5*Math.PI/180),r=t/e;this.cameraSet={},this.cameraSet.perspective=new Ru.PerspectiveCamera(45,r,.1,n);var a=50*i,o=50*i*r;this.cameraSet.orthographic=new Ru.OrthographicCamera(-o/2,o/2,a/2,-a/2,.1,n),Su(this.id,{xpos:0,ypos:0,zpos:50,fov:45,far:n,depth:i,aspect:r,zoom:1,type:"Perspective"}),this.camera=this.cameraSet.perspective,this.camera.position.z=50,this.camera.lookAt(this.scene.position),$("#farSlider_"+this.id).slider({min:0,max:n,value:n})}},{key:"resetCamera",value:function(){this.cameraProp.xpos=0,this.cameraProp.ypos=0,this.cameraProp.zpos=50,Su(this.id,this.cameraProp),this.camera.position.set(this.cameraProp.xpos,this.cameraProp.ypos,this.cameraProp.zpos),this.camera.zoom=this.cameraProp.zoom,this.controls.reset()}},{key:"updateCamera",value:function(){this.camera.position.set(this.cameraProp.xpos,this.cameraProp.ypos,this.cameraProp.zpos),this.camera.fov=this.cameraProp.fov,this.camera.depth=this.cameraProp.depth,this.camera.aspect=this.cameraProp.aspect,this.camera.zoom=this.cameraProp.zoom,this.camera.updateProjectionMatrix()}},{key:"updateSize",value:function(t,e){this.renderer&&(this.renderer.setSize(t,e),Su(this.id,{aspect:t/e}))}},{key:"switchCamera",value:function(){var t=this.camera.position;"Perspective"===this.cameraProp.type?(this.camera=this.cameraSet.perspective,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)):"Orthographic"===this.cameraProp.type&&(this.camera=this.cameraSet.orthographic,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)),this.addControls()}},{key:"searchTime",value:function(t){var e=t-this.data.spatial[0].z;isNaN(e)?alert("Please input numbers."):(this.animationPara.flag=!0,this.animationPara.dep=this.tubeGroup.position.z,this.animationPara.dst=e,this.moveTube())}},{key:"moveTube",value:function(){if(this.animationPara.flag){if(this.animationPara.now<this.animationPara.speed){requestAnimationFrame(this.moveTube.bind(this)),this.renderer.render(this.scene,this.camera),this.animationPara.now+=1;var t=(1-Math.cos(Math.PI*this.animationPara.now/this.animationPara.speed))/2;if(this.tubeGroup.position.z=this.animationPara.dep+(this.animationPara.dst-this.animationPara.dep)*t,this.disk.visible){var e=Gu.getAverage(this.id,this.tubeGroup.position.z,this.averagePeriod);this.disk.position.x=e.x*this.data.meta.range,this.disk.position.y=e.y*this.data.meta.range}}this.animationPara.now===this.animationPara.speed&&(ac(this.id,this.animationPara.dst),Cu(this.id,this.animationPara.dst,!1),this.animationPara.flag=!1,this.animationPara.now=0,this.animationPara.dep=0,this.animationPara.dst=0)}else this.animationPara.flag=!1,this.animationPara.dst=0}},{key:"setMinMaxH",value:function(t){this.tube.material.uniforms.minmaxH.value=new Ru.Vector2(t[0],t[1])}},{key:"setMinMaxV",value:function(t){this.tube.material.uniforms.minmaxV.value=new Ru.Vector2(t[0],t[1])}},{key:"changePlotsColor",value:function(){if(this.data.merge){for(var t=[],e=[],n=0;n<this.plotColor.length;n++)e.push(new Ru.Color(this.plotColor[n]));Array(this.data.splines.position.points.length*this.segment*2),Math.PI,this.segment,this.data.meta.range;for(var i=0;i<this.data.spatial.length;i++)if("x"in this.data.spatial[i])for(var r=this.data.spatial[i].source,a=e[this.idNameLookup[r]],o=0;o<this.segment;o++)t.push(a.r),t.push(a.g),t.push(a.b);this.plot.geometry.setAttribute("color",new Ru.Float32BufferAttribute(t,3))}else this.plot.material.color=new Ru.Color(Number("0x"+this.plotColor.slice(1)))}},{key:"updateOpacity",value:function(t){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var e=this.opacityCurve.getSpacedPoints(this.tubeNum),n=[];if("Flat"===t)for(var i=1;i<=this.tubeNum;i++)n.push(1);else for(var r=1;r<=this.tubeNum;r++)n.push(1-(1-e[r-1].y)/(1-e[r].y));for(var a=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum),o=0;o<this.tubeNum;o++)for(var s=0;s<a*this.segment;s++)this.tube.geometry.attributes.colorData.array[a*this.segment*3*o+3*s+2]=n[o];this.renderer.render(this.scene,this.camera)}},{key:"showPeriod",value:function(t){var e=tc.getGridSize();this.periodGroup.visible=!0,this.periodTube.geometry.attributes.position.needsUpdate=!0;for(var n=this.periodTube.geometry.attributes.position.array.length/2+2,i=t[1]-t[0],r=0;r<this.periodTube.geometry.attributes.position.array.length/3/2;r++)this.periodTube.geometry.attributes.position.array[n+3*r]=-i;this.periodEndMarker.position.set(e+1,e+1,-i),this.periodGroup.position.z=-(t[0]-this.data.spatial[0].z)+this.tubeGroup.position.z,this.periodStartMarker.material.map.text=String(t[0].toFixed(0)),this.periodEndMarker.material.map.text=String(t[1].toFixed(0)),this.renderer.render(this.scene,this.camera)}},{key:"drawTube",value:function(t){this.texture=t;var e,n,i,r=this.data.spatial[0].z,a=this.data.spatial[this.data.spatial.length-1].z,o=this.data.meta.range,s=(a-r)/(this.division*Math.ceil(a-r)),l=Math.ceil((this.data.splines.position.getPoint(1).z-this.data.splines.position.getPoint(0).z)/s),u=this.data.splines.position.getSpacedPoints(l),c=this.data.splines.radius.getSpacedPoints(l);this.data.splines.hue.points.length>0&&(e=Math.ceil((this.data.splines.hue.getPoint(1).z-this.data.splines.hue.getPoint(0).z)/s),n=this.data.splines.hue.getSpacedPoints(e),i=Math.ceil((this.data.splines.hue.getPoint(0).z-this.data.splines.position.getPoint(0).z)/s));for(var h=Math.ceil((this.data.splines.value.getPoint(1).z-this.data.splines.value.getPoint(0).z)/s),d=this.data.splines.value.getSpacedPoints(h),f=Math.ceil((this.data.splines.value.getPoint(0).z-this.data.splines.position.getPoint(0).z)/s),p=2*Math.PI/(this.segment-1),m=[],g=[],v=0;v<this.tubeNum;v++)m[v]=[],g[v]=[];for(var y,b=[],x=0,_=0,w=this.opacityCurve.getSpacedPoints(this.tubeNum),S=[],E=1;E<=this.tubeNum;E++)S.push(1-(1-w[E-1].y)/(1-w[E].y));for(var M=0;M<=l;M++){x=0,_=0,e&&i<M&&M-i<e&&(x=n[M-i].x),f<M&&M-f<h&&(_=d[M-f].y);for(var C=0;C<this.segment;C++){for(var T=0;T<this.tubeNum;T++){var k=1/this.tubeNum*(T+1),P=p*C;m[T].push(-1*(u[M].x*o+k*c[M].x*o*Math.cos(P))),m[T].push(u[M].y*o+k*c[M].y*o*Math.sin(P)),m[T].push(u[M].z-r),g[T].push(x),g[T].push(_),g[T].push(S[T])}C!==this.segment-1&&(b.push(C+M*this.segment),b.push(C+this.segment+M*this.segment),b.push(C+1+M*this.segment),b.push(C+this.segment+M*this.segment),b.push(C+1+this.segment+M*this.segment),b.push(C+1+M*this.segment))}}b=b.slice(0,-1*this.segment*3*2),y=new Float32Array(m[0].length/3);for(var A=new Float32Array(m[0].length),O=[],L=0;L<this.tubeNum;L++){var R=new Ru.BufferGeometry;R.setAttribute("position",new Ru.BufferAttribute(new Float32Array(m[L]),3)),R.setAttribute("normal",new Ru.BufferAttribute(A,3)),R.setAttribute("colorData",new Ru.BufferAttribute(new Float32Array(g[L]),3)),R.setAttribute("selected",new Ru.BufferAttribute(new Float32Array(y),1)),R.setIndex(new Ru.BufferAttribute(new Uint32Array(b),1)),R.computeVertexNormals(),O.push(R)}var I=wh.mergeBufferGeometries(O),N=new Ru.ShaderMaterial({vertexShader:this.vertex,fragmentShader:this.fragment,uniforms:{lightPosition:{value:new Ru.Vector3(-20,40,60)},shade:{value:!0},texture:{value:this.texture},minmaxH:{value:new Ru.Vector2(this.data.meta.min.H,this.data.meta.max.H)},minmaxV:{value:new Ru.Vector2(this.data.meta.min.V,this.data.meta.max.V)},flagH:{value:!0},flagV:{value:!0}},side:Ru.DoubleSide,transparent:!0,clipping:!0,clippingPlanes:[this.clippingPlane]});this.tube=new Ru.Mesh(I,N),this.tubeGroup.add(this.tube),this.tube.rotateY(Math.PI),ku(this.id,this.data.meta.min.H,this.data.meta.max.H),Tu(this.id,this.data.meta.min.V,this.data.meta.max.V);var D=m[this.tubeNum-1],z=g[this.tubeNum-1],B=b;!function(t,e,n,i){iu.dispatch({type:"UPLOAD_TUBE_ATTRIBUTES",id:t,position:e,color:n,indices:i})}(this.id,D,z,B)}},{key:"drawGrid",value:function(t,e){this.grid=new Ru.GridHelper(t,e,"white","limegreen"),this.grid.rotateX(Math.PI/2),this.scene.add(this.grid)}},{key:"drawLabel",value:function(t){var e=tc.getGridSize();this.labelGroup=new Ru.Group,this.scene.add(this.labelGroup);for(var n=[[1,1],[-1,1],[-1,-1],[1,-1]],i=0;i<n.length;i++){var r=new Ch.a({material:{color:16777215},redrawInterval:250,textSize:.8,texture:{fontFamily:"Arial, Helvetica, sans-serif",text:"("+n[i][0]*t+", "+n[i][1]*t+")"}});this.labelGroup.add(r),r.position.set(n[i][0]*e,n[i][1]*e,0)}var a=new Ch.a({material:{color:25600},redrawInterval:250,textSize:1,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"Q/I"}}),o=new Ch.a({material:{color:25600},redrawInterval:250,textSize:1,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"U/I"}});this.labelGroup.add(a),this.labelGroup.add(o),a.position.set(e+1,0,0),o.position.set(0,e+1,0)}},{key:"drawAxis",value:function(){for(var t=new Ru.BufferGeometry,e=new Ru.LineBasicMaterial({color:"white",opacity:.5,clippingPlanes:[this.clippingPlane]}),n=[],i=[],r=0,a=0,o=0;o<this.data.spatial.length;o++)a=this.data.spatial[o].z-this.data.spatial[0].z,n.push(-10),n.push(0),n.push(a),n.push(10),n.push(0),n.push(a),n.push(0),n.push(10),n.push(a),n.push(0),n.push(-10),n.push(a),i.push(r+0),i.push(r+1),i.push(r+2),i.push(r+3),r+=4;t.setIndex(i),t.setAttribute("position",new Ru.Float32BufferAttribute(n,3)),this.axis=new Ru.LineSegments(t,e),this.tubeGroup.add(this.axis),this.axis.rotateY(Math.PI)}},{key:"drawPlot",value:function(){if(this.data.merge){for(var t=[],e=[],n=[],i=0;i<this.plotColor.length;i++)n.push(new Ru.Color(this.plotColor[i]));for(var r=Array(this.data.splines.position.points.length*this.segment*2),a=0,o=2*Math.PI/this.segment,s=this.data.meta.range,l=0;l<this.data.spatial.length;l++)if("x"in this.data.spatial[l]){var u=this.data.spatial[l].z-this.data.spatial[0].z,c=-this.data.spatial[l].x*s,h=this.data.spatial[l].y*s,d=this.data.spatial[l].r_x*s,f=this.data.spatial[l].r_y*s,p=2*this.segment*a,m=this.data.spatial[l].source,g=n[this.idNameLookup[m]];r[p]=a*this.segment,r[p+2*this.segment-1]=a*this.segment;for(var v=0;v<this.segment;v++)t.push(c+d*Math.cos(o*v)),t.push(h+f*Math.sin(o*v)),t.push(u),e.push(g.r),e.push(g.g),e.push(g.b),0!==v&&(r[p+2*(v-1)+1]=a*this.segment+v,r[p+2*(v-1)+2]=a*this.segment+v);a++}var y=new Ru.BufferGeometry;y.setIndex(r),y.setAttribute("position",new Ru.Float32BufferAttribute(t,3)),y.setAttribute("color",new Ru.Float32BufferAttribute(e,3));var b=new Ru.LineBasicMaterial({vertexColors:Ru.VertexColors,clippingPlanes:[this.clippingPlane]});this.plot=new Ru.LineSegments(y,b)}else{for(var x=[],_=[],w=new Ru.Color(this.plotColor),S=Array(this.data.splines.position.points.length*this.segment*2),E=2*Math.PI/this.segment,M=this.data.meta.range,C=0;C<this.data.splines.position.points.length;C++){var T=this.data.splines.position.points[C].z-this.data.splines.position.points[0].z,k=-this.data.splines.position.points[C].x*M,P=this.data.splines.position.points[C].y*M,A=this.data.splines.radius.points[C].x*M,O=this.data.splines.radius.points[C].y*M,L=2*this.segment*C;S[L]=C*this.segment,S[L+2*this.segment-1]=C*this.segment;for(var R=0;R<this.segment;R++)x.push(k+A*Math.cos(E*R)),x.push(P+O*Math.sin(E*R)),x.push(T),_.push(w.r),_.push(w.g),_.push(w.b),0!==R&&(S[L+2*(R-1)+1]=C*this.segment+R,S[L+2*(R-1)+2]=C*this.segment+R)}var I=new Ru.BufferGeometry;I.setIndex(S),I.setAttribute("position",new Ru.Float32BufferAttribute(x,3)),I.setAttribute("color",new Ru.Float32BufferAttribute(_,3));var N=new Ru.LineBasicMaterial({vertexColors:Ru.VertexColors,clippingPlanes:[this.clippingPlane]});this.plot=new Ru.LineSegments(I,N)}this.tubeGroup.add(this.plot),this.plot.rotateY(Math.PI)}},{key:"drawDisk",value:function(){var t=new Ru.CircleGeometry(.5,16),e=new Ru.MeshBasicMaterial({color:16711680,opacity:.8});this.disk=new Ru.Mesh(t,e),this.scene.add(this.disk),this.disk.visible=!1}},{key:"drawDiskForRotationCenter",value:function(){var t=new Ru.CircleGeometry(.5,16),e=new Ru.MeshBasicMaterial({color:16776960,opacity:.8});this.diskRotation=new Ru.Mesh(t,e),this.scene.add(this.diskRotation),this.diskRotation.visible=!1}},{key:"drawComment",value:function(){this.commentList=[];var t=Gu.getFileName(this.id),e=Yc("privateComment"),n=tc.getGridSize(),i=[],r=[];for(var a in e)if(e[a].fileName===t){this.commentList.push(a);var o=new Ru.Color(Number(e[a].labelColor));i.push(n+2+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+2+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+2+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b)}var s=new Ru.BufferGeometry;s.setAttribute("position",new Ru.Float32BufferAttribute(i,3)),s.setAttribute("color",new Ru.Float32BufferAttribute(r,3));var l=new Ru.MeshBasicMaterial({vertexColors:Ru.VertexColors,side:Ru.DoubleSide,clippingPlanes:[this.clippingPlane]});this.comment=new Ru.Mesh(s,l),this.tubeGroup.add(this.comment),this.comment.rotateY(Math.PI),this.commentContents=new Ch.a({material:{color:16777215},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"",align:"left"}}),this.scene.add(this.commentContents),this.commentContents.position.set(-n,n,0)}},{key:"drawPeriodMarker",value:function(){var t=tc.getGridSize();this.periodStartMarker=new Ch.a({material:{color:65280,clippingPlanes:[this.clippingPlane]},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"start",align:"left"}}),this.periodStartMarker.position.set(t+1,t+1,0),this.periodEndMarker=new Ch.a({material:{color:16711680,clippingPlanes:[this.clippingPlane]},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"end",align:"left"}}),this.periodEndMarker.position.set(t+1,t+1,0);var e=new Ru.LineCurve3(new Ru.Vector3(0,0,0),new Ru.Vector3(0,0,-1)),n=new Ru.TubeBufferGeometry(e,1,.5,16,!1),i=new Ru.MeshBasicMaterial({color:255,clippingPlanes:[this.clippingPlane]});this.periodTube=new Ru.Mesh(n,i),this.periodGroup=new Ru.Group,this.periodGroup.add(this.periodStartMarker),this.periodGroup.add(this.periodEndMarker),this.periodGroup.add(this.periodTube),this.periodGroup.visible=!1,this.scene.add(this.periodGroup)}},{key:"updateComment",value:function(){this.commentList=[];var t=Gu.getFileName(this.id),e=Yc("privateComment"),n=tc.getGridSize(),i=[],r=[];for(var a in e)if(e[a].fileName===t){this.commentList.push(a);var o=new Ru.Color(Number(e[a].labelColor));i.push(n+2+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+2+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+2+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b),i.push(n+1),i.push(n-2),i.push(e[a].start-this.data.meta.min.z),r.push(o.r,o.g,o.b)}this.comment.geometry.attributes.position.needsUpdate=!0,this.comment.geometry.attributes.position=new Ru.Float32BufferAttribute(i,3),this.comment.geometry.attributes.color.needsUpdate=!0,this.comment.geometry.attributes.color=new Ru.Float32BufferAttribute(r,3),this.commentContents.visible=!1,this.renderer.render(this.scene,this.camera)}},{key:"initQBEView",value:function(){this.QBECamera=new Ru.PerspectiveCamera(45,1,.1,2e3),this.QBECamera.position.z=50,this.QBERenderer=new Ru.WebGLRenderer,this.QBERenderer.setSize(500,500),this.QBERenderer.setClearColor("#000000"),this.QBERenderer.localClippingEnabled=!0,this.QBERenderer.domElement.id="QBE_viewport_"+this.id,this.QBERenderer.domElement.className="TimeTubes_viewport"}},{key:"setQBEView",value:function(){var t=document.getElementById("QBE_viewport_"+this.id);if(this.visualQuery){this.QBECamera.lookAt(this.scene.position),this.QBECamera.far=this.camera.far;var e=30;Number($("#QBESource").css("padding-left"))?e=2*Number($("#QBESource").css("padding-left").replace("px","")):Number($("#QBESource").css("padding"))&&(e=2*Number($("#QBESource").css("padding").replace("px","")));var n=$("#QBESource").outerWidth(!0)-(e>=0?e:0);if(this.QBERenderer.setSize(n,n),null!=t)t.style.display="block";else{var i=document.getElementById("QBESourceTT"),r=this.onMouseWheel(),a=this.onMouseDown(),o=this.onMouseMove(),s=this.onMouseUp(),l=this.onMouseClick();i.appendChild(this.QBERenderer.domElement),i.addEventListener("wheel",r.bind(this),!1),i.addEventListener("mousedown",a.bind(this),!1),i.addEventListener("mousemove",o.bind(this),!1),i.addEventListener("mouseup",s.bind(this),!1),i.addEventListener("click",l.bind(this),!1),this.QBEControls=new Eh.a(this.QBECamera,this.QBERenderer.domElement),this.QBEControls.position0.set(0,0,50),this.QBEControls.screenSpacePanning=!1,this.QBEControls.enableZoom=!1}}else null!=t&&(t.style.display="none")}},{key:"updateColorEncodingOptionHue",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var t,e=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum);switch(this.colorEncodingOption.hue){case"default":t=this.data.splines.hue.getSpacedPoints(e);for(var n=0;n<this.tubeNum;n++)for(var i=0;i<e*this.segment;i++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*n+3*i]=t[Math.floor(i/this.segment)].x;this.tube.material.uniforms.minmaxH.value=new Ru.Vector2(this.data.meta.min.H,this.data.meta.max.H);break;case"histogramEqualization":t=this.data.hueValRanks.hue.getSpacedPoints(e);for(var r=0;r<this.tubeNum;r++)for(var a=0;a<e*this.segment;a++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*r+3*a]=t[Math.floor(a/this.segment)].y;this.tube.material.uniforms.minmaxH.value=new Ru.Vector2(this.data.hueValRanks.minmaxHue.min,this.data.hueValRanks.minmaxHue.max)}this.renderer.render(this.scene,this.camera)}},{key:"updateColorEncodingOptionValue",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var t,e=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum);switch(this.colorEncodingOption.value){case"default":t=this.data.splines.value.getSpacedPoints(e);for(var n=0;n<this.tubeNum;n++)for(var i=0;i<e*this.segment;i++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*n+3*i+1]=t[Math.floor(i/this.segment)].y;this.tube.material.uniforms.minmaxV.value=new Ru.Vector2(this.data.meta.min.V,this.data.meta.max.V);break;case"histogramEqualization":t=this.data.hueValRanks.value.getSpacedPoints(e);for(var r=0;r<this.tubeNum;r++)for(var a=0;a<e*this.segment;a++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*r+3*a+1]=t[Math.floor(a/this.segment)].y;this.tube.material.uniforms.minmaxV.value=new Ru.Vector2(this.data.hueValRanks.minmaxValue.min,this.data.hueValRanks.minmaxValue.max)}this.renderer.render(this.scene,this.camera)}},{key:"showClusteringResults",value:function(t,e,n){if(this.clusteringGroup)for(var i=0;i<this.clusteringGroup.children.length;i++){var r=this.clusteringGroup.children[i].geometry,a=this.clusteringGroup.children[i].material;this.scene.remove(this.clusteringGroup.children[i]),r.dispose(),a.dispose()}this.clusteringGroup=new Ru.Group,this.scene.add(this.clusteringGroup);var o=2*tc.getGridSize();o=Math.sqrt(o*o/2);for(var s=[],l=0;l<n.length;l++)s.push(new Ru.MeshBasicMaterial({color:new Ru.Color("hsl("+n[l][0]+","+100*n[l][1]+"%,"+100*n[l][2]+"%)"),transparent:!0,opacity:.3,clippingPlanes:[this.clippingPlane]}));for(var u=0;u<t.length;u++)if(Number(t[u].id)===this.id){var c=t[u][t[u].length-1].z-t[u][0].z,h=new Ru.CylinderBufferGeometry(o,o,c,4),d="object"===Th(e[u])?e[u].cluster:e[u],f=new Ru.Mesh(h,s[d]);f.rotateZ(Math.PI/4),f.rotateX(Math.PI/2),f.position.z=t[u][0].z-this.data.meta.min.z+c/2,this.clusteringGroup.add(f)}this.clusteringGroup.rotateY(Math.PI)}}])&&kh(e.prototype,n),i&&kh(e,i),o}(r.a.Component);function Ih(t){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dh(t,e){return(Dh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Fh(t);if(e){var r=Fh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bh(this,n)}}function Bh(t,e){return!e||"object"!==Ih(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fh(t){return(Fh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dh(t,e)}(o,t);var e,n,i,a=zh(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={fileType:"csv",headerNum:1,variableNameLine:1,grid:!0,label:!0,axis:!0,plot:!0,comment:!0,clip:!0,shade:!0,lock:!1,multiOptions:!1},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.setAverageSlider(),Gu.on("upload",(function(){Gu.getAllData().length>1&&t.setState({multiOptions:!0}),$("#fileInputPanel").css("visibility","hidden")}))}},{key:"setAverageSlider",value:function(){var t=$("#averageSliderVal");$("#averageSlider").slider({range:"min",value:0,min:0,max:200,slide:function(e,n){t.css("display","initial"),t.val(n.value+" days");var i,r=$("#averageSlider").slider("option","min"),a=$("#averageSlider").slider("option","max")-r,o=$("#averageSlider").width()*(n.value-r)/a-10;t.css("left",o+"px"),i=n.value,iu.dispatch({type:"UPDATE_AVERAGE_PERIOD",value:i})},stop:function(){t.css("display","none")}})}},{key:"changeFileType",value:function(){var t=$("input[name=fileType]:checked").val();this.setState({fileType:t})}},{key:"resetCamera",value:function(){this.getSelectedIDs().forEach((function(t){Eu(t)}))}},{key:"switchCamera",value:function(){this.getSelectedIDs().forEach((function(t){var e;e=t,iu.dispatch({type:"SWITCH_CAMERA",id:e})}))}},{key:"uploadFile",value:function(){oc(document.getElementById("uploadFileForm").files,this.state.headerNum,this.state.variableNameLine)}},{key:"searchTime",value:function(){var t=document.getElementById("searchTimeForm").value;this.getSelectedIDs().forEach((function(e){Mu(e,Number(t))}))}},{key:"switchGridDisplay",value:function(){var t=!this.state.grid;this.setState({grid:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_GRID",id:t,state:e})}(e,t)}))}},{key:"switchLabelDisplay",value:function(){var t=!this.state.label;this.setState({label:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_LABEL",id:t,state:e})}(e,t)}))}},{key:"switchAxisDisplay",value:function(){var t=!this.state.axis;this.setState({axis:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_AXIS",id:t,state:e})}(e,t)}))}},{key:"switchPlotDisplay",value:function(){var t=!this.state.plot;this.setState({plot:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_PLOT",id:t,state:e})}(e,t)}))}},{key:"switchCommentDisplay",value:function(){var t=!this.state.comment;this.setState({comment:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_COMMENT",id:t,state:e})}(e,t)}))}},{key:"changeBackground",value:function(){var t=document.getElementById("backgroundList"),e=t.selectedIndex,n=t.options[e].value;this.getSelectedIDs().forEach((function(t){var e,i;e=t,i=n,iu.dispatch({type:"CHANGE_BACKGROUND",id:e,color:i})}))}},{key:"clipTube",value:function(){var t=!this.state.clip;this.setState({clip:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"CLIP_TUBE",id:t,state:e})}(e,t)}))}},{key:"switchShade",value:function(){var t=!this.state.shade;this.setState({shade:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){iu.dispatch({type:"SWITCH_SHADE",id:t,state:e})}(e,t)}))}},{key:"selectAllViews",value:function(){var t=$("#selectAllViews").text(),e=$("input[name=selectView]");"Select All"===t?(e.prop("checked",!0),$("#selectAllViews").text("Deselect All")):"Deselect All"===t&&(e.prop("checked",!1),$("#selectAllViews").text("Select All"))}},{key:"timeFitting",value:function(){if(this.state.multiOptions){var t=tc.getActiveId(),e=tc.getFocused(t),n=Gu.getData(t);i=e+n.data.spatial[0].z,iu.dispatch({type:"TIME_FITTING",dst:i})}var i}},{key:"mergeTubes",value:function(){if(this.state.multiOptions){var t=this.getSelectedIDs();e=t,n=Promise.resolve(),i=[],r=[],n.then((function(){for(var t=0;t<e.length;t++){var n=Gu.getData(e[t]);i=i.concat(n.data.data),r.push(n.name)}var a=r.join(",");i.sort((function(t,e){var n=t.JD,i=e.JD;return Math.log10(t.JD)>4&&(n-=245e4),Math.log10(e.JD)>4&&(i-=245e4),n<i?-1:1}));var o=ec(sc(i),2),s=o[0],l=o[1],u=lc(rc,s),c=uc(s),h=cc(c.spline.hue.points,c.spline.value.points);return{fileName:a,data:i,spatial:s,lookup:l,meta:u,hueValRanks:h,splines:c}})).then((function(t){iu.dispatch({type:"UPLOAD_DATA",data:{name:t.fileName,data:t.data,spatial:t.spatial,meta:t.meta,splines:t.splines.spline,lookup:t.lookup,hueValRanks:t.rankings,merge:!0}})}))}var e,n,i,r}},{key:"lockControl",value:function(){if(this.state.multiOptions){var t=!this.state.lock;this.setState({lock:t}),function(t,e){iu.dispatch({type:"LOCK_CONTROL",ids:t,state:e})}(this.getSelectedIDs(),t)}}},{key:"clickClose",value:function(){var t=document.getElementById("closeFilePanel").innerText;$("#fileMainArea").slideToggle(),t.match("Close")?document.getElementById("closeFilePanel").innerText="Open the file input panel":document.getElementById("closeFilePanel").innerText="Close the file input panel"}},{key:"clickSub",value:function(){this.setState({headerNum:this.state.headerNum-1})}},{key:"clickAdd",value:function(){this.setState({headerNum:this.state.headerNum+1})}},{key:"clickVariableNameLineSub",value:function(){this.setState({variableNameLine:this.state.variableNameLine-1})}},{key:"clickVariableNameLineAdd",value:function(){this.setState({variableNameLine:this.state.variableNameLine+1})}},{key:"getSelectedIDs",value:function(){var t=tc.getCheckedList(),e=[];return t.forEach((function(t,n){t&&e.push(n)})),e}},{key:"basicMenu",value:function(){return r.a.createElement("ul",{className:"navbar-nav",id:"basicMenu"},r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("label",{className:"nav-link menuLabel",href:"#",id:"controllersFileDropdown",role:"button",onClick:this.showFileInputPanel.bind(this)},"File"),r.a.createElement("div",{className:"input-group input-group-sm dropdownonTubeMenu",style:{visibility:"hidden",position:"absolute",top:"2rem",width:"auto",zIndex:"100"},id:"fileInputPanel"},this.fileInputPanel())),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"controllersSettingDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",style:{fontSize:"1rem"}},""),r.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},r.a.createElement("h6",null,"Wheel interval"),r.a.createElement("select",{id:"wheelIntervalList",className:"form-control custom-select",onChange:this.updateWheelInterval.bind(this),style:{fontSize:"0.8rem",height:"1.5rem",width:"5rem"}},r.a.createElement("option",{value:"1"},"1 day"),r.a.createElement("option",{value:"3"},"3 days"),r.a.createElement("option",{value:"5"},"5 days"),r.a.createElement("option",{value:"7"},"7 days")))))}},{key:"showFileInputPanel",value:function(){var t=$("#fileInputPanel").css("visibility"),e=$("#controllersFileDropdown").position();switch(t){case"visible":$("#fileInputPanel").css("visibility","hidden");break;case"hidden":$("#fileInputPanel").css("left",e.left),$("#fileInputPanel").css("visibility","visible")}}},{key:"fileInputPanel",value:function(){return r.a.createElement("div",{id:"inputFile",className:"controllersElem"},r.a.createElement("h6",null,"File type"),r.a.createElement("form",{id:"fileType",className:"form-check-inline",style:{minWidth:"200px"},onChange:this.changeFileType.bind(this)},r.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},r.a.createElement("input",{type:"radio",name:"fileType",value:"csv",className:"custom-control-input",checked:"csv"===this.state.fileType,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"csv")),r.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},r.a.createElement("input",{type:"radio",name:"fileType",value:"tsv",className:"custom-control-input",disabled:!0,checked:"tsv"===this.state.fileType,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"tsv")),r.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},r.a.createElement("input",{type:"radio",name:"fileType",value:"space",disabled:!0,className:"custom-control-input",checked:"space"===this.state.fileType,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"space"))),r.a.createElement("h6",null,"How many lines are included in the header?"),r.a.createElement("span",{className:"caution"},"Datasets must contain the variables names in the first line of the header."),r.a.createElement("div",{className:"form-row",id:"initialLineField",style:{display:"flex",justifyContent:"center"}},r.a.createElement("button",{type:"button",id:"sub",className:"sub btn btn-primary  btn-sm",style:{textAlign:"center"},onClick:this.clickSub.bind(this),disabled:this.state.headerNum<=1},"-"),r.a.createElement("label",{id:"initialLineVal",style:{textAlign:"center",width:"6rem"}},this.state.headerNum+(this.state.headerNum<=1?" line":" lines")),r.a.createElement("button",{type:"button",id:"add",className:"add btn btn-primary btn-sm",style:{textAlign:"center"},onClick:this.clickAdd.bind(this)},"+")),r.a.createElement("h6",null,"Select files"),r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{type:"file",className:"custom-file-input",id:"uploadFileForm",onChange:this.uploadFile.bind(this),multiple:!0}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"})),r.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"0.5rem"}},r.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:this.openTestData.bind(this)},"Synthetic Data")))}},{key:"openTestData",value:function(){$.ajax({url:"data/synthesisData8.csv",success:function(t){!function(t,e){var n=[],i=[],r=wr(e,(function(e){return Object.keys(e).forEach((function(t){isNaN(e[t])||(e[t]=Number(e[t]))}),e),e.source=t,e})).splice(0);n.push(r);for(var a=0;a<n.length;a++)i=i.concat(n[a]);i.sort((function(t,e){return t.JD<e.JD?-1:1}));var o=ec(sc(i),2),s=o[0],l=o[1],u=lc(rc,s),c=uc(s),h=cc(c.spline.hue.points,c.spline.value.points);iu.dispatch({type:"UPLOAD_DATA",data:{name:t,data:i,spatial:s,meta:u,splines:c.spline,lookup:l,hueValRanks:h,merge:!1}})}("testdata4.csv",t)}})}},{key:"updateWheelInterval",value:function(t){var e,n=document.getElementById("wheelIntervalList"),i=n.selectedIndex,r=n.options[i].value;e=Number(r),iu.dispatch({type:"UPDATE_WHEEL_INTERVAL",interval:e})}},{key:"displayMenu",value:function(){return r.a.createElement("ul",{className:"navbar-nav",id:"displayMenu"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"nav-link menuLabel",id:"resetCameraBtn",onClick:this.resetCamera.bind(this)},"Reset")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"nav-link menuLabel",id:"switchCameraBtn",onClick:this.switchCamera.bind(this)},"Switch camera")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxGrid",checked:this.state.grid,onChange:this.switchGridDisplay.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchGridDisplay.bind(this)},"Grid")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxLabel",checked:this.state.label,onChange:this.switchLabelDisplay.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchLabelDisplay.bind(this)},"Label")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxAxis",checked:this.state.axis,onChange:this.switchAxisDisplay.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchAxisDisplay.bind(this)},"Axis")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxPlot",checked:this.state.plot,onChange:this.switchPlotDisplay.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchPlotDisplay.bind(this)},"Plot")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxComment",checked:this.state.comment,onChange:this.switchCommentDisplay.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchCommentDisplay.bind(this)},"Comment")),r.a.createElement("div",{className:"form-check form-check-inline menuItem"},r.a.createElement("select",{className:"form-control custom-select",id:"backgroundList",onChange:this.changeBackground.bind(this),style:{fontSize:"0.8rem",height:"1.5rem",width:"5rem"}},r.a.createElement("option",{value:"0x000000"},"Black"),r.a.createElement("option",{value:"0x3f3f3f"},"Gray 75"),r.a.createElement("option",{value:"0x7f7f7f"},"Gray 50"),r.a.createElement("option",{value:"0xbfbfbf"},"Gray 25"),r.a.createElement("option",{value:"0xffffff"},"White"),r.a.createElement("option",{value:"0x191970"},"Navy"))))}},{key:"tubeMenu",value:function(){return r.a.createElement("ul",{className:"navbar-nav",id:"tubeMenu"},r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxClip",value:"option1",checked:this.state.clip,onChange:this.clipTube.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.clipTube.bind(this)},"Clip")),r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxShade",value:"option1",checked:this.state.shade,onChange:this.switchShade.bind(this)}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.switchShade.bind(this)},"Shade")),r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Average"),r.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},r.a.createElement("div",{id:"averageSlider",style:{float:"left",width:"8rem",marginBottom:".5rem",marginTop:".5rem"}},r.a.createElement("output",{id:"averageSliderVal",style:{position:"absolute",display:"none",top:"-30px",backgroundColor:"#fff",opacity:"0.8",borderRadius:"3px",color:"#777",padding:"2px"}})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"nav-link menuLabel",id:"selectAllViews",onClick:this.selectAllViews.bind(this)},"Select All")))}},{key:"multiTubesMenu",value:function(){return r.a.createElement("ul",{className:"navbar-nav",id:"multiTubesMenu"},r.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},r.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxLock",value:"option1",checked:this.state.lock,onChange:this.lockControl.bind(this),disabled:!this.state.multiOptions}),r.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.lockControl.bind(this)},"Lock")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("label",{className:"nav-link menuLabel",onClick:this.timeFitting.bind(this)},"Time Fitting")),r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Fusion"),r.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},r.a.createElement("label",{className:"dropdown-item menuLabel",id:"mergeBtn",onClick:this.mergeTubes.bind(this)},"All"))))}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",id:"tubeControllers"},r.a.createElement("div",{className:"collapse navbar-collapse",id:"TimeTubesMenu"},this.basicMenu(),this.displayMenu(),this.tubeMenu(),this.multiTubesMenu()))}}])&&Nh(e.prototype,n),i&&Nh(e,i),o}(r.a.Component);function jh(t){return(jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Hh(t,e){return(Hh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=qh(t);if(e){var r=qh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wh(this,n)}}function Wh(t,e){return!e||"object"!==jh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qh(t){return(qh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $h=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hh(t,e)}(a,t);var e,n,i,r=Gh(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).timeRange=[],t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData(t.data);break;case"RESET_SCATTERPLOTS":this.emit("resetScatterplots",t.id);break;case"MOVE_CURRENT_LINE_ON_TIMESELECTOR":this.emit("moveCurrentLineonTimeSelector",t.id,t.zpos);break;case"UPDATE_TIME_RANGE":this.updateTimeRange(t.id,t.range)}}},{key:"getTimeRange",value:function(t){return this.timeRange[t]}},{key:"uploadData",value:function(t){this.timeRange.push([t.meta.min.z,t.meta.max.z]),this.emit("upload")}},{key:"updateTimeRange",value:function(t,e){this.timeRange[t]=e,this.emit("updateTimeRange",t,e)}}])&&Uh(e.prototype,n),i&&Uh(e,i),a}(su.EventEmitter));iu.register($h.handleActions.bind($h));var Qh=$h;function Yh(t){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zh(t,e){return(Zh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=td(t);if(e){var r=td(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Kh(this,n)}}function Kh(t,e){return!e||"object"!==Yh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function td(t){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ed=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zh(t,e)}(o,t);var e,n,i,a=Jh(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:10,left:10},e.id=t.id,e.divID=t.divID,e.data=Gu.getData(e.id),e.selectedRange=[e.data.data.meta.min.z,e.data.data.meta.max.z],e.state={width:t.width,height:100},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initializeElements(),this.drawTimeSelector(),tc.on("updateFocus",(function(e,n,i){e===t.id&&t.moveCurrentLine(n+t.data.data.spatial[0].z)})),tc.on("showRotationCenter",(function(e,n,i){e===t.id&&t.moveCurrentLine(n[0])})),tc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&t.moveCurrentLine(n[0])})),tc.on("searchTime",(function(e,n){e===t.id&&t.moveCurrentLine(n)})),Qh.on("moveCurrentLineonTimeSelector",(function(e,n){e===t.id&&t.moveCurrentLine(n)})),Qh.on("updateTimeRange",(function(e,n){e===t.id&&(t.selectedRange=n)}))}},{key:"initializeElements",value:function(){this.xScale=Ca().domain([this.data.data.meta.min.z,this.data.data.meta.max.z]),this.brush=Qi(),this.yScale=Ca().domain([this.data.data.meta.min.V,this.data.data.meta.max.V]),this.svg=se("#"+this.divID).append("svg").attr("class","timeSelector").attr("id","timeSelectorSVG_"+this.id),this.clip=this.svg.append("defs").append("clipPath").attr("id","clipTimeSelector_"+this.id).append("rect"),this.timeCurve=function(){var t=Vs,e=null,n=zs(0),i=js,r=zs(!0),a=null,o=Fs,s=null;function l(l){var u,c,h,d,f,p=l.length,m=!1,g=new Array(p),v=new Array(p);for(null==a&&(s=o(f=er())),u=0;u<=p;++u){if(!(u<p&&r(d=l[u],u,l))===m)if(m=!m)c=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=c;--h)s.point(g[h],v[h]);s.lineEnd(),s.areaEnd()}m&&(g[u]=+t(d,u,l),v[u]=+n(d,u,l),s.point(e?+e(d,u,l):g[u],i?+i(d,u,l):v[u]))}if(f)return s=null,f+""||null}function u(){return Us().defined(r).curve(o).context(a)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:zs(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:zs(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:zs(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:zs(+t),i=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:zs(+t),l):n},l.y1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:zs(+t),l):i},l.lineX0=l.lineY0=function(){return u().x(t).y(n)},l.lineY1=function(){return u().x(t).y(i)},l.lineX1=function(){return u().x(e).y(n)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:zs(!!t),l):r},l.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),l):o},l.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),l):a},l}().curve(Fs),this.timeSelector=this.svg.append("g").attr("class","timeSelector").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.timeSelectorGraph=this.timeSelector.append("path").datum(this.data.data.splines.value.points).attr("class","area").attr("clip-path","url(#clipTimeSelector_"+this.id+")"),this.timeSelectorXAxis=this.timeSelector.append("g").attr("class","axis axis--x"),this.timeSelectorBrusher=this.timeSelector.append("g").attr("class","brush"),this.currentLine=this.svg.append("line").attr("stroke-width",3).attr("stroke","orange").attr("id","timeSelectorCurrent_"+this.id)}},{key:"drawTimeSelector",value:function(){this.id,this.divID;var t=this.props.width,e=this.state.height,n=t-this.margin.left-this.margin.right,i=e-this.margin.top-this.margin.bottom;this.selectedRange,this.svg.attr("width",this.props.width).attr("height",this.state.height),this.xScale.range([0,n]),this.xScale;var r=V(this.xScale);this.brush.extent([[0,0],[n,i]]).on("start brush",function(){var t=($t.selection||this.xScale.range).map(this.xScale.invert,this.xScale);Ds(".scatterplots"+this.id).size()>0&&t.toString()!==this.selectedRange.toString()&&function(t,e){iu.dispatch({type:"UPDATE_TIME_RANGE",id:t,range:e})}(this.id,t)}.bind(this)),this.yScale.range([i,0]),this.clip.attr("width",n).attr("height",i),this.timeCurve.x(function(t){return this.xScale(t.z)}.bind(this)).y0(i).y1(function(t){return this.yScale(t.y)}.bind(this)),this.timeSelectorGraph.attr("d",this.timeCurve),this.timeSelectorXAxis.attr("transform","translate(0,"+i+")").call(r),this.timeSelectorBrusher.call(this.brush).call(this.brush.move,[this.invertScale(this.selectedRange[0]),this.invertScale(this.selectedRange[1])]);var a=pr().on("start",(function(){se(this).classed("selectedLine",!0)})).on("drag",function(){var t=se("#timeSelectorCurrent_"+this.id),e=$t.x;e<=this.margin.left?e=this.margin.left:this.margin.left+n<=e&&(e=this.margin.left+n),t.attr("x1",e).attr("x2",e);var i=this.xScale.invert(e-this.margin.left);Mu(this.id,i)}.bind(this)).on("end",(function(){se(this).classed("selectedLine",!1)}));this.currentLine.attr("x1",this.margin.left).attr("y1",this.margin.top).attr("x2",this.margin.left).attr("y2",i+this.margin.top).call(a)}},{key:"invertScale",value:function(t){var e=this.xScale.range(),n=this.xScale.domain();return(t-n[0])*(e[1]-e[0])/(n[1]-n[0])+e[0]}},{key:"updateTimeSelector",value:function(){this.id,this.divID;var t=this.props.width,e=this.state.height,n=t-this.margin.left-this.margin.right,i=e-this.margin.top-this.margin.bottom;this.selectedRange,this.svg.attr("width",this.props.width).attr("height",this.state.height),this.xScale.range([0,n]),this.xScale;var r=V(this.xScale);this.brush.extent([[0,0],[n,i]]),this.yScale.range([i,0]),this.clip.attr("width",n).attr("height",i),this.timeCurve.x(function(t){return this.xScale(t.z)}.bind(this)).y0(i).y1(function(t){return this.yScale(t.y)}.bind(this)),this.timeSelectorGraph.attr("d",this.timeCurve),this.timeSelectorXAxis.attr("transform","translate(0,"+i+")").call(r),this.timeSelectorBrusher.call(this.brush.move,[this.invertScale(this.selectedRange[0]),this.invertScale(this.selectedRange[1])]),this.currentLine.attr("y2",i+this.margin.top)}},{key:"moveCurrentLine",value:function(t){var e=se("#timeSelectorCurrent_"+this.id),n=this.xScale(t)+this.margin.left;e.attr("x1",n).attr("x2",n)}},{key:"render",value:function(){return Ds("svg#timeSelectorSVG_"+this.id).size()>0&&this.updateTimeSelector(),r.a.createElement("div",{id:this.divID,className:"timeSelector outerContainer"})}}])&&Xh(e.prototype,n),i&&Xh(e,i),o}(r.a.Component);function nd(t){return(nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function id(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rd(t,e){return(rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ad(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=sd(t);if(e){var r=sd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return od(this,n)}}function od(t,e){return!e||"object"!==nd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sd(t){return(sd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ld=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rd(t,e)}(o,t);var e,n,i,a=ad(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{className:"TimeTubesHolder",id:"TimeTubesHolder_"+this.id},r.a.createElement(Rh,{id:this.id,data:this.data,width:this.props.width,height:this.props.height-100}),r.a.createElement("div",{id:this.divID,className:"timeSelector"},r.a.createElement(ed,{id:this.id,divID:"timeSelector_"+this.id,width:this.props.width})))}}])&&id(e.prototype,n),i&&id(e,i),o}(r.a.Component);function ud(t){var e=t;return Math.log10(Math.abs(t))<-2&&0!==t&&(e=t.toExponential(1)),e}function cd(t){return t=Number(t),Math.log10(Math.abs(t))<-2&&0!==t?t.toExponential(1):Math.log10(t)>3?t.toFixed(0):t.toFixed(2)}function hd(t){return(hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fd(t,e){return(fd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gd(t);if(e){var r=gd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return md(this,n)}}function md(t,e){return!e||"object"!==hd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gd(t){return(gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var vd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fd(t,e)}(o,t);var e,n,i,a=pd(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:30,left:60},e.id=t.id,e.divID=t.divID,e.SPID=t.id+"_"+t.divID.split("_")[1],e.data=Gu.getData(e.id);var n=Qh.getTimeRange(e.id);e.timeRange=void 0===n?[e.data.data.meta.min.z,e.data.data.meta.max.z]:n,e.slicedData=e.data.data.spatial.filter((function(e){return t.xItem in e&&t.yItem in e})),e.xMinMax=[0,0],e.yMinMax=[0,0];var i=Yc("privateComment");for(var r in e.commentsList=[],i)if(i[r].fileName===e.data.name){var s={};for(var l in s.id=r,i[r])s[l]=i[r][l];e.commentsList.push(s)}return e.state={xItem:t.xItem,yItem:t.yItem,xItemonPanel:t.xItem,yItemonPanel:t.yItem,width:t.width,height:Math.max(t.height,200)},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initalizeElements(),this.computeRange(this.state.xItem,this.state.yItem),this.drawScatterplots(),Gu.on("updatePrivateComment",(function(){var e=t.commentsList.length,n=Yc("privateComment");for(var i in t.commentsList=[],n)if(n[i].fileName===t.data.name){var r={};for(var a in r.id=i,n[i])r[a]=n[i][a];t.commentsList.push(r)}if(t.commentsList.length<e)t.commentMarks=t.commentMarks_g.selectAll("path").data(t.commentsList),t.commentMarks.exit().remove();else{var o=t.commentMarks_g.selectAll("path").data(t.commentsList),s=o.enter().append("path").attr("d",function(t){return this.symbolGenerator.type(Qs),this.symbolGenerator()}.bind(t));t.commentMarks=s.merge(o)}t.updateScatterplots()})),tc.on("updateFocus",(function(e,n,i){e===t.id&&(i?t.highlightCurrentPlot(n):t.updateCurrentPos(n))})),tc.on("changePlotColor",(function(e){e===t.id?t.changePlotColor(tc.getPlotColor(e)):t.data.data.merge&&t.data.data.name.indexOf(Gu.getData(e).data.name)>=0&&t.changePlotColorMerge(Gu.getData(e).data.name,tc.getPlotColor(e))})),tc.on("showRotationCenter",(function(e,n,i){e===t.id&&t.updateCurrentPos(n[0]-t.data.data.spatial[0].z)})),tc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&t.updateCurrentPos(n[0]-t.data.data.spatial[0].z)})),tc.on("searchTime",(function(e,n){e===t.id&&t.highlightCurrentPlot(n-t.data.data.spatial[0].z)})),Qh.on("resetScatterplots",(function(e){e===t.id&&t.reset()})),Qh.on("updateTimeRange",(function(e,n){e===t.id&&(t.timeRange=n,t.computeRange(t.state.xItem,t.state.yItem),t.updateScatterplots(t.state.xItem,t.state.yItem))})),xh.on("showClusteringResults",(function(){if("z"===t.state.xItem||"z"===t.state.yItem){var e=xh.getSubsequences(),n=xh.getLabels(),i=xh.getClusterColors();t.showClusteringResults(e,n,i)}}))}},{key:"initalizeElements",value:function(){this.zoom=nu().scaleExtent([.5,20]),this.sp=se("#"+this.divID).append("svg").attr("id","scatterplotsSVG_"+this.SPID).attr("class","scatterplot scatterplots"+this.id+" "+this.divID),this.xScale=Ca(),this.xScaleTmp=this.xScale,this.xAxis=this.sp.append("g").attr("class","x_axis "+this.divID),this.xAxisText=Ds("g.x_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("text-anchor","middle"),this.yScale=Ca(),this.yScaleTmp=this.yScale,this.yAxis=this.sp.append("g").attr("class","y_axis "+this.divID).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.yAxisText=Ds("g.y_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle"),this.tooltip=se("#"+this.divID).append("div").attr("class","tooltip "+this.divID).attr("id","tooltip_"+this.SPID).style("opacity",.75).style("visibility","hidden"),this.line=Us().x((function(t){return t[0]})).y((function(t){return t[1]})),this.lineH=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineH "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.lineV=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineV "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.clip=this.sp.append("defs").append("clipPath").attr("id","clipScatterplots_"+this.SPID).append("rect"),this.point_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("points_g",!0),this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id),this.commentMarks_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("comments_g",!0),this.symbolGenerator=function(){var t=zs(Ws),e=zs(64),n=null;function i(){var i;if(n||(n=i=er()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return i.type=function(e){return arguments.length?(t="function"==typeof e?e:zs(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:zs(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}().size(50),this.commentMarks=this.commentMarks_g.selectAll("path").data(this.commentsList).enter().append("path").attr("d",function(t){return this.symbolGenerator.type(Qs),this.symbolGenerator()}.bind(this))}},{key:"drawScatterplots",value:function(){this.id;var t=this.SPID,e=(this.divID,this.margin),n=(this.data,this.props.width),i=Math.max(this.props.height,200),r=n-this.margin.left-this.margin.right,a=i-this.margin.top-this.margin.bottom,o=this.state.xItem,s=this.state.yItem;this.tooltip,this.zoom.extent([[0,0],[r,a]]).on("zoom",function(){var t=$t.transform.rescaleX(this.xScale),e=$t.transform.rescaleY(this.yScale);this.xScaleTmp=t,this.yScaleTmp=e,this.xMinMax=t.domain(),this.yMinMax=e.domain(),this.xAxis.call(this.xLabel.scale(t)),this.yAxis.call(this.yLabel.scale(e)),this.points.attr("cx",(function(e){return t(e[o])})).attr("cy",(function(t){return e(t[s])})),this.SSRects&&this.SSRects.attr("x",(function(e){return t(e[0].z)})).attr("width",(function(e){return t(e[e.length-1].z)-t(e[0].z)})),"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",(function(e){return"translate("+t(e.start)+", 6)"})).attr("fill",(function(t){return t.labelColor.replace("0x","#")}));var n=se("circle.current."+this.divID);if(n._groups[0][0]){var i=n.attr("cx"),l=n.attr("cy");l<=0||a<=l?this.lineH.attr("transform","translate("+this.margin.left+","+l+")").style("visibility","hidden"):this.lineH.transition().duration(0).attr("transform","translate("+this.margin.left+","+l+")").style("visibility","visible"),i<=0||r<=i?this.lineV.attr("transform","translate("+i+","+this.margin.top+")").style("visibility","hidden"):this.lineV.transition().duration(0).attr("transform","translate("+i+","+this.margin.top+")").style("visibility","visible")}}.bind(this)),this.sp.attr("width",n).attr("height",i).call(this.zoom).on("dblclick.zoom",null),this.xScale.domain(this.xMinMax).nice().range([0,r]),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-a).tickFormat(ud),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+a)+")").call(this.xLabel),this.xAxisText.attr("x",r/2).attr("y",this.margin.bottom/2+10).text(this.data.data.lookup[o]).on("click",function(){var n=se("#changeXAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var i=document.getElementById("changeXAxisPanel_"+t).clientHeight,o=document.getElementById("changeXAxisPanel_"+t).clientWidth;n.style("transform","translate("+(r/2+e.left-o/2)+"px,"+(a+e.top-i)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")})),this.yScale.domain(this.yMinMax).nice().range([a,0]),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-r).tickFormat(ud),this.yAxis.call(this.yLabel),this.yAxisText.attr("x",-a/2).attr("y",-this.margin.left/2-10).text(this.data.data.lookup[s]).on("click",function(){var n=se("#changeYAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({yItemonPanel:this.state.yItem});else{var i=document.getElementById("changeXAxisPanel_"+t).clientHeight;document.getElementById("changeXAxisPanel_"+t).clientWidth,n.style("transform","translate("+e.left+"px,"+(a/2+e.top-i/2)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")}));var l=[[0,this.margin.top],[r,this.margin.top]],u=[[this.margin.left,0],[this.margin.left,a]];if(this.lineH.attr("d",this.line(l)),this.lineV.attr("d",this.line(u)),this.clip.attr("width",r).attr("height",a),this.data.data.merge){for(var c={},h=this.data.name.split(","),d=[],f=0;f<h.length;f++){var p=Gu.getIdFromName(h[f]);c[h[f]]=f;var m=h[f].split("+");if(m.length>1)for(var g=0;g<m.length;g++)c[m[g]]=f;d.push(tc.getPlotColor(p))}this.points.attr("cx",function(t){return this.xScale(t[o])}.bind(this)).attr("cy",function(t){return this.yScale(t[s])}.bind(this)).attr("fill",(function(t){return d[c[t.source]]})).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var v=tc.getPlotColor(this.id);this.points.attr("cx",function(t){return this.xScale(t[o])}.bind(this)).attr("cy",function(t){return this.yScale(t[s])}.bind(this)).attr("fill",v).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",function(t){return"translate("+this.xScale(t.start)+", 6)"}.bind(this)).attr("fill",(function(t){return t.labelColor.replace("0x","#")})).on("mouseover",this.commentMarksMouseOver()).on("mouseout",this.commentMarksMouseOut()).on("dblclick",this.commentMarksDblClick())}},{key:"spMouseOver",value:function(){var t=this.tooltip,e=this.data,n=this.state.xItem,i=this.state.yItem;return function(r){se(this).attr("stroke-width",1).attr("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>"+e.data.lookup[n]+"</i>: "+r[n]+"<br/><i>"+e.data.lookup[i]+"</i>: "+r[i]).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"spMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);n.style("fill")!==ke("red").toString()&&(n.attr("stroke-width",.5).attr("stroke","dimgray"),n.attr("class").indexOf("current")<0?n.attr("stroke-width",.5).attr("stroke","dimgray"):n.attr("stroke","orange").attr("stroke-width",1)),t.transition().duration(150).style("visibility","hidden")}}},{key:"spDblClick",value:function(){var t=this.id;return function(e){Mu(t,e.z)}}},{key:"commentMarksMouseOver",value:function(){var t=this.tooltip;return function(e){se(this).style("stroke-width",1).style("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>Time stamp</i>: "+e.timeStamp+"<br/><i>User name</i>: "+e.userName+"<br/><i>Comment</i>: "+e.comment).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"commentMarksMouseOut",value:function(){var t=this.tooltip;return function(){se(this).style("stroke-width",0),t.transition().duration(150).style("visibility","hidden")}}},{key:"commentMarksDblClick",value:function(){var t=this.id;return function(e){Mu(t,e.start)}}},{key:"highlightCurrentPlot",value:function(t){var e=this.margin,n=this.divID,i=t+this.data.data.spatial[0].z,r=Ds("svg."+n),a=this.state.xItem,o=this.state.yItem;function s(t){var i=se(this),r=(i.attr("class").split(" ")[1],se("svg."+n)),a=r.selectAll(".currentLineH"),o=r.selectAll(".currentLineV");a.transition().duration(0).style("visibility","visible").attr("transform","translate("+e.left+","+i.attr("cy")+")"),o.transition().duration(0).style("visibility","visible").attr("transform","translate("+i.attr("cx")+","+e.top+")")}r.each((function(t){var e=se(this),n=e.selectAll("circle"),r=e.attr("class").split(" ");n.attr("stroke-width",.5).attr("stroke","dimgray").attr("class",r[1]+" "+r[2]);var l=n.filter((function(t){return t.z===i&&a in t&&o in t}));l._groups.length>0&&l.attr("stroke","orange").attr("stroke-width",1).attr("class",r[1]+" "+r[2]+" current").moveToFront().each(s)}))}},{key:"updateCurrentPos",value:function(t){var e=this.sp.attr("height");if("z"===this.state.xItem){var n=Ca().domain([this.xMinMax[0],this.xMinMax[1]]).range([0,this.props.width-this.margin.left-this.margin.right]),i=t+this.data.data.spatial[0].z;this.lineH.style("visibility","hidden"),this.lineV.transition().duration(0).style("visibility","visible").attr("transform","translate("+n(i)+","+this.margin.top+")")}else if("z"===this.state.yItem){var r=Ca().domain([this.yMinMax[0],this.yMinMax[1]]).range([0,e-this.margin.top-this.margin.bottom]),a=t+this.data.data.spatial[0].z;this.lineV.style("visibility","hidden"),this.lineH.transition().duration(0).style("visibility","visible").attr("transform","translate("+this.margin.left+","+r(a)+")")}}},{key:"changePlotColor",value:function(t){se("#"+this.divID).selectAll("circle").attr("fill",(function(e){return t}))}},{key:"changePlotColorMerge",value:function(t,e){se("#"+this.divID).selectAll("circle").filter((function(e){return t.indexOf(e.source)>=0})).attr("fill",e)}},{key:"onSelectXItem",value:function(t){this.setState({xItemonPanel:t.target.value})}},{key:"onSelectYItem",value:function(t){this.setState({yItemonPanel:t.target.value})}},{key:"computeRange",value:function(t,e){this.slicedData=this.data.data.spatial.filter(function(n){return t in n&&e in n&&this.timeRange[0]<=n.z&&n.z<=this.timeRange[1]}.bind(this)),this.xMinMax=p(this.slicedData,(function(e){return e[t]})),this.yMinMax=p(this.slicedData,(function(t){return t[e]}))}},{key:"updateScatterplots",value:function(t,e){if(this.xScale.domain(this.xMinMax).nice(),this.yScale.domain(this.yMinMax).nice(),this.xMinMax=this.xScale.domain(),this.yMinMax=this.yScale.domain(),this.data.data.merge){for(var n={},i=this.data.name.split(","),r=[],a=0;a<i.length;a++){var o=Gu.getIdFromName(i[a]);n[i[a]]=a;var s=i[a].split("+");if(s.length>1)for(var l=0;l<s.length;l++)n[s[l]]=a;r.push(tc.getPlotColor(o))}this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).select((function(n){return t in n&&e in n?this:null})).attr("fill",(function(t){return r[n[t.source]]})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var u=tc.getPlotColor(this.id);if(this.points._groups[0].length<=this.slicedData.length){var c=this.point_g.selectAll("circle").data(this.slicedData),h=c.enter().append("circle");this.points=h.merge(c),this.points.attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).attr("fill",u).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else this.points=this.point_g.selectAll("circle").data(this.slicedData).attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).attr("fill",u).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick()),this.points.exit().remove()}this.xAxis.call(this.xLabel.scale(this.xScale)),this.yAxis.call(this.yLabel.scale(this.yScale)),"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",function(t){return"translate("+this.xScale(t.start)+", 6)"}.bind(this)).attr("fill",(function(t){return t.labelColor.replace("0x","#")})).on("mouseover",this.commentMarksMouseOver()).on("mouseout",this.commentMarksMouseOut()).on("dblclick",this.commentMarksDblClick())}},{key:"onClickXAxisDone",value:function(t){this.setState({xItem:this.state.xItemonPanel}),this.computeRange(this.state.xItemonPanel,this.state.yItem),this.updateScatterplots(this.state.xItemonPanel,this.state.yItem),this.xAxisText.text(this.data.data.lookup[this.state.xItemonPanel]),se("#changeXAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"onClickYAxisDone",value:function(t){this.setState({yItem:this.state.yItemonPanel}),this.computeRange(this.state.xItem,this.state.yItemonPanel),this.updateScatterplots(this.state.xItem,this.state.yItemonPanel),this.yAxisText.text(this.data.data.lookup[this.state.yItemonPanel]),se("#changeYAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"reset",value:function(){this.sp.transition().duration(500).call(this.zoom.transform,$l)}},{key:"showClusteringResults",value:function(t,e,n){for(var i=[],r=[],a=0;a<t.length;a++)Number(t[a].id)===this.id&&(i.push(t[a]),r.push(e[a]));var o=this.sp.append("g").attr("class","SSRectGroup").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")");this.SSRects=o.selectAll("rect.SSRect").data(i).enter().append("rect").attr("class","SSRect").attr("x",function(t){return this.xScale(t[0].z)}.bind(this)).attr("width",function(t){return this.xScale(t[t.length-1].z)-this.xScale(t[0].z)}.bind(this)).attr("height",this.yScale.range()[0]).attr("fill",(function(t,e){var i=n["object"===hd(r[e])?r[e].cluster:r[e]];return Fe(i[0],i[1],i[2])})).attr("opacity",.3),this.point_g.moveToFront()}},{key:"render",value:function(){Ds("svg#scatterplotsSVG_"+this.SPID).size()>0&&this.drawScatterplots();var t=[],e=[],n=this.data.data.lookup;for(var i in n){var a="";(a=n[i].length>1?n[i].join(","):n[i]).indexOf("JD")<0?(t.push(r.a.createElement("div",{className:"form-check",key:a},r.a.createElement("input",{type:"radio",name:"selectXAxisForm_"+this.SPID,value:i,checked:this.state.xItemonPanel===i,onChange:this.onSelectXItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))),e.push(r.a.createElement("div",{className:"form-check",key:a},r.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:i,checked:this.state.yItemonPanel===i,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a)))):(t.unshift(r.a.createElement("div",{className:"form-check",key:a},r.a.createElement("input",{type:"radio",name:"selectXAxisForm_"+this.SPID,value:i,checked:this.state.xItemonPanel===i,onChange:this.onSelectXItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))),e.unshift(r.a.createElement("div",{className:"form-check",key:a},r.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:i,checked:this.state.yItemonPanel===i,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))))}return r.a.createElement("div",{id:"scatterplotsSelectors_"+this.SPID},r.a.createElement("div",{className:"overlayPanel",id:"changeXAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},r.a.createElement("h6",null,"Change x axis"),r.a.createElement("div",{id:"changeXAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},r.a.createElement("form",{id:"selectXAxisForm_"+this.SPID},t)),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_"+this.SPID,onClick:this.onClickXAxisDone.bind(this)},"Done")),r.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},r.a.createElement("h6",null,"Change y axis"),r.a.createElement("div",{id:"changeYAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},r.a.createElement("form",{id:"selectYAxisForm_"+this.SPID},e)),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeYAxisBtn_"+this.SPID,onClick:this.onClickYAxisDone.bind(this)},"Done")))}}])&&dd(e.prototype,n),i&&dd(e,i),o}(r.a.Component);function yd(t){return(yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xd(t,e){return(xd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Sd(t);if(e){var r=Sd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wd(this,n)}}function wd(t,e){return!e||"object"!==yd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sd(t){return(Sd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ed=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xd(t,e)}(o,t);var e,n,i,a=_d(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.menuHeight=24,e.state={scatterplotsList:[],width:t.width,height:t.height},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Gu.on("showInitSP",(function(e){if(e===t.id){var n=t.state.scatterplotsList;n.push({x:"z",y:"V"}),t.setState({scatterplotsList:n})}}))}},{key:"addScatterplots",value:function(){var t=document.getElementById("scatterSelectXAxis_"+this.id),e=document.getElementById("scatterSelectYAxis_"+this.id),n=t.options[t.selectedIndex].value,i=e.options[e.selectedIndex].value;if("unselected"!==n&&"unselected"!==i){var r=this.state.scatterplotsList;r.push({x:n,y:i}),this.setState({scatterplotsList:r})}}},{key:"resetScatterplotsZoom",value:function(){var t;t=this.id,iu.dispatch({type:"RESET_SCATTERPLOTS",id:t})}},{key:"render",value:function(){var t=this,e=this.state.scatterplotsList.map((function(e,n){return r.a.createElement("div",{key:t.id+"_"+n,id:"scatterplots"+t.id+"_"+n,style:{display:"inline-block"}},r.a.createElement(vd,{key:t.id+"_"+n,id:t.id,divID:"scatterplots"+t.id+"_"+n,xItem:e.x,yItem:e.y,width:t.props.width,height:t.props.height-t.menuHeight}))})),n=[];for(var i in this.data.lookup){var a="";a=this.data.lookup[i].length>1?this.data.lookup[i].join(","):this.data.lookup[i],n.push(r.a.createElement("option",{key:i,value:i},a))}return r.a.createElement("div",{className:"scatterplotsHolder",id:"scatterplotsHolder_"+this.id},r.a.createElement("div",{className:"scatterplotsMenu row"},this.fileName,r.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"scatterResetBtn_"+this.id,onClick:this.resetScatterplotsZoom.bind(this)},"Reset"),r.a.createElement("select",{className:"custom-select select_axis",id:"scatterSelectXAxis_"+this.id,defaultValue:"unselected",style:{width:"6rem",height:"1.5rem",float:"right"}},r.a.createElement("option",{value:"unselected"},"x axis"),n),r.a.createElement("select",{className:"custom-select select_axis",id:"scatterSelectYAxis_"+this.id,defaultValue:"unselected",style:{width:"6rem",height:"1.5rem",float:"right"}},r.a.createElement("option",{value:"unselected"},"y axis"),n),r.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"showScatter_"+this.id,style:{float:"right"},onClick:this.addScatterplots.bind(this)},"+")),r.a.createElement("div",{id:"scatterplots_"+this.id,className:"scatterplotsViewports",style:{height:this.props.height-this.menuHeight+"px",width:this.props.width+"px"}},e,r.a.createElement("div",{style:{clear:"both"}})))}}])&&bd(e.prototype,n),i&&bd(e,i),o}(r.a.Component);function Md(t){return(Md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Td(t,e){return(Td=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ad(t);if(e){var r=Ad(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Pd(this,n)}}function Pd(t,e){return!e||"object"!==Md(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ad(t){return(Ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Od=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Td(t,e)}(o,t);var e,n,i,a=kd(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.state={width:t.width,heightTT:t.heightTT,heightSP:t.heightSP},e}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{className:"dataColumn",id:"dataColumn_"+this.id,style:{padding:"unset",display:"table-cell"}},r.a.createElement(ld,{id:this.id,data:this.data,width:this.props.width,height:this.props.heightTT}),r.a.createElement(Ed,{id:this.id,data:this.data,width:this.props.width,height:this.props.heightSP}))}}])&&Cd(e.prototype,n),i&&Cd(e,i),o}(r.a.Component);function Ld(t){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Id(t,e){return(Id=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=zd(t);if(e){var r=zd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Dd(this,n)}}function Dd(t,e){return!e||"object"!==Ld(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zd(t){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Id(t,e)}(o,t);var e,n,i,a=Nd(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={data:Gu.getAllData(),width:$(window).width(),heightTT:$(window).height()/2,heightSP:$(window).height()/2},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Gu.on("upload",(function(){t.setState({data:Gu.getAllData(),width:$(window).width()/Gu.getDataNum()})}))}},{key:"collapseSidebar",value:function(){$("#Controllers").toggle("slow")}},{key:"collapseFeature",value:function(){$("#Feature").toggle("slow")}},{key:"render",value:function(){var t=this.state.data,e=this.state.width,n=this.state.heightTT,i=this.state.heightSP,a=Gu.getDataNum();if(a>0){e=a<=3?window.innerWidth/a:Math.ceil(window.innerWidth/3);var o=$(window).height()-$("#appHeader").outerHeight()-$("#tubeControllers").outerHeight();n=Math.ceil(.6*o)+100,i=o-n}var s=t.map((function(t){return r.a.createElement(Od,{key:t.id,id:t.id,data:t.data,width:e,heightTT:n,heightSP:i})}));return r.a.createElement("div",{className:"contents",id:"mainVisArea"},r.a.createElement(Vh,null),r.a.createElement("div",{id:"dataColumns",className:"container",style:{display:"inline-block",maxWidth:"100%",width:"100vw",padding:"unset",overflowX:"scroll",overflowY:"hidden"}},r.a.createElement("div",{style:{margin:"unset"}},s)))}}])&&Rd(e.prototype,n),i&&Rd(e,i),o}(r.a.Component);function Fd(t){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jd(t,e){return(jd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ud(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gd(t);if(e){var r=Gd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Hd(this,n)}}function Hd(t,e){return!e||"object"!==Fd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gd(t){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jd(t,e)}(o,t);var e,n,i,a=Ud(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).sourceId=t.sourceId,e.selectedPeriod=dh.getSelectedPeriod(),e.data=Gu.getData(e.sourceId),e.texture=tc.getTexture(),e.segment=tc.getSegment(),e.division=tc.getDivision(),e.activeVar=dh.getActive(),e.clusterCenter={},e.splinesClusterCenter={},e}return e=o,(n=[{key:"render",value:function(){var t=this;return $("#selectedIntervalViewArea").width(),r.a.createElement("div",{className:"TimeTubes",id:"selectedTimeSliceView",ref:function(e){t.mount=e}},r.a.createElement("div",{className:"overlayHidingPanel"}))}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"componentDidMount",value:function(){var t=this;this.initializeScene(),this.sourceId>=0&&this.selectedPeriod[0]>=0&&this.selectedPeriod[1]>=0&&(this.tube||this.setUpScene(),this.hideClusteringTube(),this.updateTimePeriod(),this.redrawTube()),tc.on("switch",(function(){t.camera&&t.switchCamera()})),dh.on("switchQueryMode",(function(e){"QBE"!==e&&(t.sourceId=dh.getSource(),t.activeVar=[],t.tube&&t.deselectAll())})),dh.on("updateSource",(function(){t.sourceId=dh.getSource(),t.data=Gu.getData(t.sourceId),t.setUpScene()})),dh.on("resetSelection",(function(){t.tube&&t.deselectAll()})),dh.on("updateSelectedPeriod",(function(){t.hideClusteringTube(),t.selectedPeriod=dh.getSelectedPeriod(),t.updateTimePeriod()})),dh.on("selectPeriodfromSP",(function(e){t.selectedPeriod=dh.getSelectedPeriod(),t.hideClusteringTube(),t.selectedPeriod[1]-t.selectedPeriod[0]>0?t.updateTimePeriod():t.tube&&t.deselectAll()})),dh.on("selectTimeInterval",(function(e,n){t.hideClusteringTube(),t.selectedPeriod=dh.getSelectedPeriod(),t.updateTimePeriod()})),dh.on("setActiveVariables",(function(e){t.activeVar=e,t.redrawTube()})),dh.on("convertResultIntoQuery",(function(e,n,i){if("QBE"===dh.getMode()){t.sourceId=e,t.selectedPeriod=n,t.activeVar=i,t.data=Gu.getData(t.sourceId),t.tube||t.setUpScene();for(var r=document.getElementById("sourceList"),a=0;a<r.options.length;a++)if(Number(r.options[a].value)===e){r.selectedIndex=a;break}$("#selectedInterval").text("JD: "+n[0].toFixed(3)+" - "+n[1].toFixed(3)),$("#targetLengthMin").val(Math.floor(n[1])-Math.ceil(n[0])),$("#targetLengthMax").val(Math.floor(n[1])-Math.ceil(n[0])),i&&$("input[name=QBEActive]").each((function(t,e){i.indexOf(e.value)<0?e.checked=!1:e.checked=!0})),t.hideClusteringTube(),t.updateTimePeriod(),t.redrawTube()}})),dh.on("recoverQuery",(function(e){"QBE"===dh.getMode()&&(t.sourceId=dh.getSource(),t.selectedPeriod=dh.getSelectedPeriod(),t.activeVar=dh.getActive(),t.data=Gu.getData(t.sourceId),t.tube||t.setUpScene(),t.hideClusteringTube(),t.updateTimePeriod(),t.redrawTube())})),dh.on("convertClusterCenterIntoQuery",(function(e){"QBE"===dh.getMode()&&(t.clusterCenter=e,t.splinesClusterCenter={},t.computeSplines(e),(new Ru.TextureLoader).load("img/1_256.png",function(t){this.textureCluster=t,this.drawClusterCenterTube(e)}.bind(t)))}))}},{key:"componentDidUpdate",value:function(){var t=$("#selectedIntervalViewArea").width(),e=t;this.renderer.setSize(t,e)}},{key:"hideClusteringTube",value:function(){this.tube&&(this.tube.visible=!0),this.tubeCluster&&(this.tubeCluster.visible=!1)}},{key:"initializeScene",value:function(){var t=$("#selectedIntervalViewArea").width(),e=t;this.scene=new Ru.Scene,this.setCameras(),this.renderer=new Ru.WebGLRenderer,this.renderer.setClearColor("#000000"),this.renderer.setSize(t,e),this.renderer.domElement.id="selectedTimeSliceView",this.mount.appendChild(this.renderer.domElement);var n=new Ru.DirectionalLight(16777215,.7);n.position.set(-20,40,60),this.scene.add(n);var i=new Ru.AmbientLight(2697513);this.scene.add(i);var r=new Ru.AxesHelper(1e3);this.scene.add(r),this.renderScene(),this.start(),this.addControls(),this.sourceId>=0&&this.setPlaceHolder()}},{key:"setUpScene",value:function(){this.updateCameras(),this.setPlaceHolder(),this.renderScene(),this.start(),this.addControls()}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.renderer&&this.renderer.render(this.scene,this.camera)}},{key:"setCameras",value:function(){var t;t=this.sourceId>=0?tc.getCameraProp(this.sourceId):tc.getDefaultCameraProp(),this.cameraSet={},this.cameraSet.perspective=new Ru.PerspectiveCamera(t.fov,1,.1,t.far);var e=50*t.depth,n=50*t.depth*1;this.cameraSet.orthographic=new Ru.OrthographicCamera(-n/2,n/2,e/2,-e/2,.1,t.far),"Perspective"===t.type?this.camera=this.cameraSet.perspective:this.camera=this.cameraSet.orthographic,this.camera.position.z=50,this.camera.lookAt(-this.scene.position)}},{key:"updateCameras",value:function(){var t;t=this.sourceId>=0?tc.getCameraProp(this.sourceId):tc.getDefaultCameraProp(),this.cameraSet.perspective.fov=t.fov,this.cameraSet.perspective.far=t.far;var e=50*t.depth,n=50*t.depth*1;this.cameraSet.orthographic.left=-n/2,this.cameraSet.orthographic.right=n/2,this.cameraSet.orthographic.top=e/2,this.cameraSet.orthographic.bottom=-e/2,this.cameraSet.orthographic.far=t.far,"Perspective"===t.type?this.camera=this.cameraSet.perspective:this.camera=this.cameraSet.orthographic,this.camera.position.z=50,this.camera.lookAt(-this.scene.position)}},{key:"setPlaceHolder",value:function(){if(void 0===this.tube){var t=tc.getTexture(this.sourceId),e=new Float32Array(0),n=new Float32Array(0),i=new Float32Array(0),r=new Float32Array(0),a=new Uint32Array(0),o=new Ru.BufferGeometry;o.setAttribute("position",new Ru.BufferAttribute(new Float32Array(e),3)),o.setAttribute("normal",new Ru.BufferAttribute(i,3)),o.setAttribute("colorData",new Ru.BufferAttribute(new Float32Array(n),2)),o.setAttribute("selected",new Ru.BufferAttribute(new Float32Array(r),1)),o.setIndex(new Ru.BufferAttribute(new Uint32Array(a),1)),o.computeVertexNormals();var s=new Ru.ShaderMaterial({vertexShader:document.getElementById("vertexShader_tube").textContent,fragmentShader:document.getElementById("fragmentShader_tube").textContent,uniforms:{lightPosition:{value:new Ru.Vector3(-20,40,60)},tubeNum:{value:1},shade:{value:!1},texture:{value:t},minmaxH:{value:new Ru.Vector2(this.data.data.meta.min.H,this.data.data.meta.max.H)},minmaxV:{value:new Ru.Vector2(this.data.data.meta.min.V,this.data.data.meta.max.V)},flagH:{value:!0},flagV:{value:!0}},side:Ru.DoubleSide,transparent:!0});this.tube=new Ru.Mesh(o,s),this.tube.rotateY(Math.PI),this.scene.add(this.tube)}}},{key:"switchCamera",value:function(){var t=this.camera.position,e=tc.getCameraProp(this.sourceId);"Perspective"===e.type?(this.camera=this.cameraSet.perspective,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)):"Orthographic"===e.type&&(this.camera=this.cameraSet.orthographic,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)),this.addControls()}},{key:"addControls",value:function(){this.controls=new Eh.a(this.camera,this.renderer.domElement),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"drawSelectedTube",value:function(t,e,n){this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.normal.needsUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0,this.tube.geometry.index.needsUpdate=!0,this.tube.geometry.attributes.position=new Ru.BufferAttribute(new Float32Array(t),3),this.tube.geometry.attributes.colorData=new Ru.BufferAttribute(new Float32Array(e),3),this.tube.geometry.attributes.selected=new Ru.BufferAttribute(new Float32Array(t.length/3),1),this.tube.geometry.attributes.normal=new Ru.BufferAttribute(new Float32Array(t.length),1),this.tube.geometry.index=new Ru.BufferAttribute(new Uint32Array(n),1),this.tube.geometry.computeVertexNormals(),this.redrawTube(),this.renderer.render(this.scene,this.camera)}},{key:"deselectAll",value:function(){this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.normal.needsUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0,this.tube.geometry.index.needsUpdate=!0,this.tube.geometry.attributes.position=new Ru.BufferAttribute(new Float32Array(0),3),this.tube.geometry.attributes.colorData=new Ru.BufferAttribute(new Float32Array(0),2),this.tube.geometry.attributes.selected=new Ru.BufferAttribute(new Float32Array(0),1),this.tube.geometry.attributes.normal=new Ru.BufferAttribute(new Float32Array(0),1),this.tube.geometry.index=new Ru.BufferAttribute(new Uint32Array(0),1),this.tube.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}},{key:"extractTubeAttributes",value:function(){for(var t=dh.getTubeAttributes(Number(this.sourceId)),e=Math.ceil(this.selectedPeriod[0]-this.data.data.meta.min.z)*this.division*this.segment,n=Math.ceil(this.selectedPeriod[1]-this.data.data.meta.min.z)*this.division*this.segment,i=t.position.slice(3*e,3*n),r=t.color.slice(3*e,3*n),a=i[2],o=0;o<i.length/3;o++)i[3*o+2]-=a,r[3*o+2]=1;return{pos:i,col:r,indices:t.indices.slice(0,((n-e)/this.segment-1)*(this.segment-1)*3*2)}}},{key:"updateTimePeriod",value:function(){var t=this.extractTubeAttributes();this.drawSelectedTube(t.pos,t.col,t.indices)}},{key:"redrawTube",value:function(){if(this.tube&&this.tube.visible){var t,e=this.activeVar.indexOf("x")>=0,n=this.activeVar.indexOf("y")>=0,i=this.activeVar.indexOf("r_x")>=0,r=this.activeVar.indexOf("r_y")>=0,a=this.activeVar.indexOf("H")>=0,o=this.activeVar.indexOf("V")>=0,s=this.data.data.meta.min.z,l=this.data.data.meta.max.z,u=this.data.data.meta.range,c=(l-s)/(this.division*Math.ceil(l-s)),h=Math.ceil((this.data.data.splines.position.getPoint(1).z-this.data.data.splines.position.getPoint(0).z)/c),d=this.data.data.splines.position.getSpacedPoints(h),f=this.data.data.splines.radius.getSpacedPoints(h);this.data.data.splines.hue.points.length>0&&(t=Math.ceil((this.data.data.splines.hue.getPoint(1).z-this.data.data.splines.hue.getPoint(0).z)/c),this.data.data.splines.hue.getSpacedPoints(t));for(var p,m,g,v,y,b=Math.ceil((this.data.data.splines.value.getPoint(1).z-this.data.data.splines.value.getPoint(0).z)/c),x=(this.data.data.splines.value.getSpacedPoints(b),2*Math.PI/(this.segment-1)),_=Math.ceil((this.selectedPeriod[0]-s)/c),w=this.tube.geometry.attributes.position.array.length/3/this.segment,S=(Math.ceil((this.selectedPeriod[1]-s)/c),[]),E=_;E<_+w;E++){m=e?d[E].x:0,g=n?d[E].y:0,v=i?f[E].x:1/u,y=r?f[E].y:1/u;for(var M=0;M<this.segment;M++)p=x*M,S.push(-1*(m*u+v*u*Math.cos(p))),S.push(g*u+y*u*Math.sin(p)),S.push(d[E].z-this.selectedPeriod[0])}this.tube.material.uniforms.flagH.value=a,this.tube.material.uniforms.flagV.value=o,this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.position=new Ru.BufferAttribute(new Float32Array(S),3),this.tube.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}else if(this.tubeCluster&&this.tubeCluster.visible){for(var C,T,k,P,A,O=this.activeVar.indexOf("x")>=0,L=this.activeVar.indexOf("y")>=0,R=this.activeVar.indexOf("r_x")>=0,I=this.activeVar.indexOf("r_y")>=0,N=this.activeVar.indexOf("H")>=0,D=this.activeVar.indexOf("V")>=0,z=this.clusterCenter.values[Object.keys(this.clusterCenter.values)[0]].length,B=this.division*z,F=2*Math.PI/(this.segment-1),V=this.splinesClusterCenter.position.getSpacedPoints(B),j=this.splinesClusterCenter.radius.getSpacedPoints(B),U=[],H=0;H<=B;H++){T=O?V[H].x:0,k=L?V[H].y:0,P=R?j[H].x:1/this.rangeClusterCenter,A=I?j[H].y:1/this.rangeClusterCenter;for(var G=0;G<this.segment;G++)C=F*G,U.push(-1*(T*this.rangeClusterCenter+P*this.rangeClusterCenter*Math.cos(C))),U.push(k*this.rangeClusterCenter+A*this.rangeClusterCenter*Math.sin(C)),U.push(V[H].z)}this.tubeCluster.material.uniforms.flagH.value=N,this.tubeCluster.material.uniforms.flagV.value=D,this.tubeCluster.geometry.attributes.position.needsUpdate=!0,this.tubeCluster.geometry.attributes.position=new Ru.BufferAttribute(new Float32Array(U),3),this.tubeCluster.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}}},{key:"computeSplines",value:function(t){this.minmax={},this.minmax.x=[1/0,-1/0],this.minmax.y=[1/0,-1/0],this.minmax.H=[1/0,-1/0],this.minmax.V=[1/0,-1/0];for(var e=[],n=[],i=[],r=0;r<t.values[Object.keys(t.values)[0]].length;r++){var a={x:"x"in t.values?t.values.x[r]:0,y:"y"in t.values?t.values.y[r]:0,r_x:"r_x"in t.values?t.values.r_x[r]:1,r_y:"r_y"in t.values?t.values.r_y[r]:1,H:"H"in t.values?t.values.H[r]:.5,V:"V"in t.values?t.values.V[r]:.5};for(var o in e.push(new Ru.Vector3(a.x,a.y,r)),n.push(new Ru.Vector3(a.r_x,a.r_y,r)),i.push(new Ru.Vector3(a.H,a.V,r)),this.minmax)a[o]<this.minmax[o][0]&&(this.minmax[o][0]=a[o]),this.minmax[o][1]<a[o]&&(this.minmax[o][1]=a[o])}this.splinesClusterCenter.position=new Ru.CatmullRomCurve3(e,!1,"catmullrom"),this.splinesClusterCenter.radius=new Ru.CatmullRomCurve3(n,!1,"catmullrom"),this.splinesClusterCenter.color=new Ru.CatmullRomCurve3(i,!1,"catmullrom");var s=this.minmax.x[1]-this.minmax.x[0],l=this.minmax.y[1]-this.minmax.y[0],u=Math.round(Math.max(s,l)*Math.pow(10,2-Math.ceil(Math.log10(Math.max(s,l)))));this.rangeClusterCenter=tc.getGridSize()/(5*Math.ceil(u/5)*Math.pow(10,-(2-Math.ceil(Math.log10(Math.max(s,l))))))}},{key:"drawClusterCenterTube",value:function(t){if(this.tube&&(this.tube.visible=!1),this.tubeCluster){var e=this.tubeCluster.geometry,n=this.tubeCluster.material;this.scene.remove(this.tubeCluster),e.dispose(),n.dispose(),this.tubeCluster=void 0}for(var i,r,a=tc.getTextureDefault(),o=Object.keys(t.values),s=t.values[Object.keys(t.values)[0]].length,l=this.division*s,u=2*Math.PI/(this.segment-1),c=[],h=[],d=[],f=this.splinesClusterCenter.position.getSpacedPoints(l),p=this.splinesClusterCenter.radius.getSpacedPoints(l),m=this.splinesClusterCenter.color.getSpacedPoints(l),g=o.indexOf("r_x")>=0,v=o.indexOf("r_y")>=0,y=0;y<=l;y++){i=g?p[y].x:1/this.rangeClusterCenter,r=v?p[y].y:1/this.rangeClusterCenter;for(var b=0;b<this.segment;b++){var x=u*b;c.push(-1*(f[y].x*this.rangeClusterCenter+i*this.rangeClusterCenter*Math.cos(x))),c.push(f[y].y*this.rangeClusterCenter+r*this.rangeClusterCenter*Math.sin(x)),c.push(f[y].z),h.push(m[y].x),h.push(m[y].y),h.push(1),b!==this.segment-1&&(d.push(b+y*this.segment),d.push(b+this.segment+y*this.segment),d.push(b+1+y*this.segment),d.push(b+this.segment+y*this.segment),d.push(b+1+this.segment+y*this.segment),d.push(b+1+y*this.segment))}}d=d.slice(0,-1*this.segment*3*2);var _=new Float32Array(c.length),w=new Ru.BufferGeometry;w.setAttribute("position",new Ru.BufferAttribute(new Float32Array(c),3)),w.setAttribute("normal",new Ru.BufferAttribute(_,3)),w.setAttribute("colorData",new Ru.BufferAttribute(new Float32Array(h),3)),w.setIndex(new Ru.BufferAttribute(new Uint32Array(d),1)),w.computeVertexNormals();var S=new Ru.ShaderMaterial({vertexShader:document.getElementById("vertexShader_tube").textContent,fragmentShader:document.getElementById("fragmentShader_tube").textContent,uniforms:{lightPosition:{value:new Ru.Vector3(-20,40,60)},shade:{value:!0},texture:{value:a},minmaxH:{value:new Ru.Vector2(this.minmax.H[0],this.minmax.H[1])},minmaxV:{value:new Ru.Vector2(this.minmax.V[0],this.minmax.V[1])},flagH:{value:!0},flagV:{value:!0}},side:Ru.DoubleSide,transparent:!0}),E=new Ru.Mesh(w,S);E.rotateY(Math.PI),this.scene.add(E),this.tubeCluster=E,this.renderer.render(this.scene,this.camera)}}])&&Vd(e.prototype,n),i&&Vd(e,i),o}(r.a.Component);function qd(t){return(qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qd(t,e){return(Qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Zd(t);if(e){var r=Zd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Xd(this,n)}}function Xd(t,e){return!e||"object"!==qd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zd(t){return(Zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qd(t,e)}(o,t);var e,n,i,a=Yd(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={dragSelection:!0,source:-1},e}return e=o,(n=[{key:"componentDidMount",value:function(){dh.on("recoverQuery",(function(t){if("QBE"===dh.getMode())for(var e=document.getElementById("sourceList"),n=0;n<e.options.length;n++)if(Number(e.options[n].value)===Number(dh.getSource())){e.selectedIndex=n;break}}))}},{key:"extractionSource",value:function(){var t=Gu.getAllIdsFileNames().map((function(t){return r.a.createElement("option",{value:t.id,key:t.id},t.name)}));return t.unshift(r.a.createElement("option",{value:"default",key:"default"},"Select a source")),r.a.createElement("div",{className:"featureElem"},r.a.createElement("h5",null,"Source"),r.a.createElement("select",{className:"custom-select custom-select-sm",id:"sourceList",style:{width:"40%"},onChange:this.updateSource.bind(this)},t))}},{key:"updateSource",value:function(){var t=document.getElementById("sourceList"),e=t.selectedIndex,n=t.options[e].value;Promise.resolve().then((function(){ou(n)})).then((function(){Pc(n)}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"QBEQuerying"},this.extractionSource())}}])&&$d(e.prototype,n),i&&$d(e,i),o}(r.a.Component),Kd=n(2),tf=n.n(Kd);function ef(t){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return rf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rf(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function af(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function of(t,e){return(of=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=uf(t);if(e){var r=uf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return lf(this,n)}}function lf(t,e){return!e||"object"!==ef(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uf(t){return(uf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&of(t,e)}(o,t);var e,n,i,a=sf(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=(e=a.call(this)).updateLookup(),i=dh.getTarget(),r={},s={},l=[],u=[];for(var c in n){l=[],u=[];for(var h=0;h<i.length;h++)l.push(Gu.getData(i[h]).data.meta.min[c]),u.push(Gu.getData(i[h]).data.meta.max[c]);r[c]=l,s[c]=u}return e.state={xItem:t.xItem,yItem:t.yItem,xItemonPanel:t.xItem,yItemonPanel:t.yItem,size:0,lookup:n,selector:"pen",targetList:i,minList:r,maxList:s,detectWidth:!0,assignVariables:!1},e.margin={bottom:20,left:20},e.curveSegment=10,e.sketching=!1,e.touch=!1,e.path=null,e.pathWidth=null,e.penSizeCircle=null,e.radiuses=null,e.segPoints=[],e.pathUpper=null,e.pathLower=null,e.highlightedPoint=null,e.highlightedPointIdx=-1,e.controlPoints=[],e.widthVar=null,e.widthRange=[],e.timeStamps=[],e.selectedIdx=-1,e.selectedHandle=null,e.selectedPoint=null,e.xMinMax=[],e.yMinMax=[],e.queryData={},e.updateQueryFlag=!1,e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;if(this.initCanvas(),this.state.targetList.length>0){var e=this.computeMinMaxValue(this.state.minList,this.state.maxList);this.xMinMax=e.xMinMax,this.yMinMax=e.yMinMax,this.updateAxis(),this.updateWidthVariable()}dh.on("updateTarget",(function(){var e=dh.getTarget(),n=t.updateLookup(),i=t.extractMinMaxList(n,e);t.setState({targetList:e,minList:i.minList,maxList:i.maxList,lookup:n})})),dh.on("switchQueryMode",(function(e){if(t.initCanvas(),"QBS"===e){var n=dh.getTarget(),i=t.updateLookup(),r=t.extractMinMaxList(i,n);t.setState({targetList:n,minList:r.minList,maxList:r.maxList,lookup:i});var a=t.computeMinMaxValue(r.minList,r.maxList);t.xMinMax=a.xMinMax,t.yMinMax=a.yMinMax,t.xAxisText.text(i[t.state.xItem]),t.yAxisText.text(i[t.state.yItem]),t.updateAxis(),t.updateWidthVariable()}})),dh.on("convertResultIntoQuery",(function(e,n,i){if("QBS"===dh.getMode()){t.clearCanvas();var r=dh.getTarget(),a=t.updateLookup(),o=t.extractMinMaxList(a,r);if(t.queryData={id:e,period:n,targetData:Gu.getDataArray(e,1)},t.setState({targetList:r,minList:o.minList,maxList:o.maxList,lookup:a}),!t.widthVar){var s=document.getElementById("widthVariables"),l=s.selectedIndex,u=s.options[l].value;t.widthVar=u,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}t.transformDataIntoSketch(t.state.xItem,t.state.yItem)}})),dh.on("recoverQuery",(function(e){setTimeout(function(){if("QBS"===dh.getMode()){var t=this.updateLookup();this.initCanvas(),this.clearCanvas(),this.xMinMax=e.query.xRange,this.yMinMax=e.query.yRange,this.updateAxis();for(var n,i,r=dh.getTarget(),a=this.extractMinMaxList(t,r),o=0;o<e.query.xItem.length;o++)for(var s in t)if(t[s].indexOf(e.query.xItem[o])>=0){n=s;break}for(var l=0;l<e.query.yItem.length;l++)for(var u in t)if(t[u].indexOf(e.query.yItem[l])>=0){i=u;break}if(e.query.widthVar){for(var c=0;c<e.query.widthVar.length;c++)for(var h in t)if(t[h].indexOf(e.query.widthVar[c])>=0){this.widthVar=h;break}this.widthRange=e.query.widthRange,this.changeWidthVariable(this.widthVar,this.widthRange),$("#sketchWidthSlider").slider("option","disabled",!this.state.detectWidth)}this.xAxisText&&this.xAxisText.text(t[n]),this.yAxisText&&this.yAxisText.text(t[i]),$("#periodOfSketchQuery").val(e.query.length),this.recoverQuery(e,t),this.setState({targetList:r,lookup:t,xItem:n,xItemonPanel:n,yItem:i,yItemonPanel:i,detectWidth:!!this.widthVar,minList:a.minList,maxList:a.maxList})}}.bind(t),0)})),dh.on("convertClusterCenterIntoQuery",(function(e){setTimeout(function(){if("QBS"===dh.getMode()){this.clearCanvas();var t=dh.getTarget(),n=this.updateLookup();if(this.extractMinMaxList(n,t),this.queryData={id:"clustering",targetData:e.values,parameters:e.parameters,subsequenceParameters:e.subsequenceParameters},!this.widthVar){var i=document.getElementById("widthVariables"),r=i.selectedIndex,a=i.options[r].value;this.widthVar=a,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}this.transformDataIntoSketch(this.state.xItem,this.state.yItem),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}.bind(t))}))}},{key:"updateLookup",value:function(){var t=[];Gu.getAllData().forEach((function(e){t.push(e.data.lookup)}));var e={};return t.forEach((function(t){var n=function(n){e[n]?t[n].forEach((function(t){e[n].indexOf(t)<0&&e[n].push(t)})):e[n]=t[n]};for(var i in t)n(i)})),e}},{key:"extractMinMaxList",value:function(t,e){var n={},i={},r=[],a=[];for(var o in t){r=[],a=[];for(var s=0;s<e.length;s++)r.push(Gu.getData(e[s]).data.meta.min[o]),a.push(Gu.getData(e[s]).data.meta.max[o]);n[o]=r,i[o]=a}return{minList:n,maxList:i}}},{key:"computeMinMaxValue",value:function(t,e){var n=Math.min.apply(null,t[this.state.xItem]),i=Math.max.apply(null,e[this.state.xItem]),r=Math.min.apply(null,t[this.state.yItem]),a=Math.max.apply(null,e[this.state.yItem]);return"z"===this.state.xItem&&(i=Math.min(i-n,50),n=0),"z"===this.state.yItem&&(a=Math.min(a-r,50),r=0),{xMinMax:[n,i],yMinMax:[r,a]}}},{key:"initCanvas",value:function(){var t=Number($("#featureArea").css("padding-left").replace("px","")),e=Number($("#featureArea").css("padding-right").replace("px","")),n=Math.floor(.3*$("#mainFeatureArea").width()-t-e);this.setState({size:n});var i=se("#QBSCanvasArea").style("position","relative").style("padding-bottom",n+"px");se("#QBSSketchPadSVG").remove(),this.svg=i.append("svg").attr("id","QBSSketchPadSVG").attr("width",n).attr("height",n).style("position","absolute"),se("#QBSSketchPad").remove(),this.canvas=i.append("canvas").attr("width",n+"px !important").attr("height",n+"px !important").attr("id","QBSSketchPad").style("position","absolute").style("border","1px solid lightgray"),tf.a.setup(this.canvas.node()),this.svg.select("g.x_axis").remove(),this.xAxis=this.svg.append("g").attr("class","x_axis"),se("#sketchPadXLabel").remove(),this.xAxisText=i.append("text").attr("class","axisLabel").attr("id","sketchPadXLabel").attr("fill","black").attr("text-anchor","middle").style("font-size","0.7rem").style("position","absolute").style("background-color","white").style("left",n/2+"px").style("top",n-18+"px").text(this.state.lookup[this.state.xItem]).on("click",this.CanvasXLabelOnClick().bind(this)),this.xScale=Ca(),this.svg.select("g.y_axis").remove(),this.yAxis=this.svg.append("g").attr("class","y_axis"),se("#sketchPadYLabel").remove(),this.yAxisText=i.append("text").attr("class","axisLabel").attr("id","sketchPadYLabel").attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle").style("font-size","0.7rem").style("position","absolute").style("background-color","white").style("left",this.margin.left/2+"px").style("top",n/2+"px").text(this.state.lookup[this.state.yItem]).on("click",this.CanvasYLabelOnClick().bind(this)),this.yScale=Ca(),this.tool=new tf.a.Tool,this.tool.minDistance=15,this.tool.onMouseDown=this.CanvasOnMouseDown().bind(this),this.tool.onMouseDrag=this.CanvasOnMouseDrag().bind(this),this.tool.onMouseUp=this.CanvasOnMouseUp().bind(this),document.getElementById("QBSSketchPad").addEventListener("touchmove",this.CanvasOnTouchMove().bind(this)),tf.a.view.onFrame=this.CanvasOnFrame().bind(this),$("#periodOfSketchQuery").val(20)}},{key:"CanvasOnFrame",value:function(){return function(t){if(this.sketching&&!this.touch&&this.penSizeCircle){var e=this.penSizeCircle.position,n=Date.now()-this.timeStamps[this.timeStamps.length-1],i=Math.min(n/1e3*30+2.5,100);this.penSizeCircle.remove(),this.penSizeCircle=new tf.a.Path.Circle(e,i),this.penSizeCircle.strokeColor="#325D88"}}}},{key:"clearCanvas",value:function(){this.path&&(this.path.remove(),this.path=null),this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.penSizeCircle&&(this.penSizeCircle.remove(),this.penSizeCircle=null),this.highlightedPoint&&this.highlightedPoint.remove();for(var t=0;t<this.controlPoints.length;t++)this.controlPoints[t].label&&(this.controlPoints[t].label.remove(),this.controlPoints[t].label=null,this.controlPoints[t].labelRect.remove(),this.controlPoints[t].labelRect=null);this.controlPoints=[],this.timeStamps=[],this.radiuses=[],this.queryData={},this.pathUpper=null,this.pathLower=null,this.segPoints=[]}},{key:"CanvasOnTouchMove",value:function(){return function(t){if(this.sketching&&this.touch&&this.penSizeCircle){var e=this.penSizeCircle.position,n=97.5*t.touches[0].force+2.5;this.penSizeCircle.remove(),this.penSizeCircle=new tf.a.Path.Circle(e,n),this.penSizeCircle.strokeColor="#325D88"}}}},{key:"CanvasOnMouseDown",value:function(){return function(t){var e;if(this.state.assignVariables){if(e=null,e=this.path.hitTest(t.point,{segments:!0,tolerance:5})){this.highlightedPointIdx=e.segment.index,this.highlightedPoint&&this.highlightedPoint.remove(),this.highlightedPoint=new tf.a.Path.Circle({center:e.point,radius:5,fillColor:"#d23430"});var n=$("#controlPointPopover");n.css("display","block");var i,r=$("#controlPointPopoverArrow"),a=n.outerWidth()+8,o=n.outerHeight()+8,s=null,l={},u=this.state.size-e.point.x,c=e.point.x,h=e.point.y,d=this.state.size-e.point.y;for(var f in u>=a?(s="right",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),i={x:e.point.x,y:e.point.y-o/2},l={top:o/2-16+"px"}):c>=a?(s="left",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),i={x:e.point.x-a,y:e.point.y-o/2},l={top:o/2-16+"px"}):h>=o?(s="top",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),i={x:e.point.x-a/2,y:e.point.y-o},l={left:a/2-16+"px"}):d>=o&&(s="bottom",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),i={x:e.point.x-a/2,y:e.point.y},l={left:a/2-16+"px"}),i.x<0?(i.x=0,l={left:e.point.x-16+"px"}):i.x>this.state.size-a&&(i.x=this.state.size-a,l={left:this.state.size-e.point.x-16+"px"}),i.y<0?(i.y=0,l={top:e.point.y-16+"px"}):i.y>this.state.size-o&&(i.y=this.state.size-o,l={top:o-(this.state.size-e.point.y)-16+"px"}),n.css({left:i.x+"px",top:i.y+"px"}),r.css({top:"",left:""}),r.css(l),this.controlPoints[this.highlightedPointIdx].assignedVariables)if(this.controlPoints[this.highlightedPointIdx].assignedVariables[f].length<=0)if(f===this.state.xItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd(this.xScale.invert(this.controlPoints[this.highlightedPointIdx].position.x)));else if(f===this.state.yItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd(this.yScale.invert(this.controlPoints[this.highlightedPointIdx].position.y)));else if(f!==this.widthVar)$("#valueAssignmentCheckbox_"+f).prop("checked",!1),$("#valueAssignmentCheckbox_"+f).prop("disabled",!1),$("#slider_"+f).css("display","block"),$("#slider_"+f).slider("option","values",[0,100]),$("#slider_"+f).slider("option","disabled",!0),$("#widthValue_"+f).css("display","none");else{$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none");var m=nf(p(this.controlPoints,(function(t){return t.radius})),2),g=m[0],v=m[1];Math.min.apply(null,this.state.minList[f]),Math.max.apply(null,this.state.maxList[f]),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd((this.widthRange[1]-this.widthRange[0])/(v-g)*(this.controlPoints[this.highlightedPointIdx].radius-g)+this.widthRange[0]))}else if(f===this.state.xItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd(this.xScale.invert(this.controlPoints[this.highlightedPointIdx].position.x)));else if(f===this.state.yItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd(this.yScale.invert(this.controlPoints[this.highlightedPointIdx].position.y)));else if(f!==this.widthVar){$("#valueAssignmentCheckbox_"+f).prop("checked",!0),$("#valueAssignmentCheckbox_"+f).prop("disabled",!1);var y=Math.min.apply(null,this.state.minList[f]),b=Math.max.apply(null,this.state.maxList[f]);$("#slider_"+f).slider("option","values",[(this.controlPoints[this.highlightedPointIdx].assignedVariables[f][0]-y)/(b-y)*100,(this.controlPoints[this.highlightedPointIdx].assignedVariables[f][1]-y)/(b-y)*100]),$("#slider_"+f).slider("option","disabled",!1)}else{$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none");var x=nf(p(this.controlPoints,(function(t){return t.radius})),2),_=x[0],w=x[1];Math.min.apply(null,this.state.minList[f]),Math.max.apply(null,this.state.maxList[f]),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(cd((this.widthRange[1]-this.widthRange[0])/(w-_)*(this.controlPoints[this.highlightedPointIdx].radius-_)+this.widthRange[0]))}}}else{var S=t.event.type;switch(this.state.selector){case"pen":this.sketching=!0,"touchstart"===S&&(this.touch=!0),this.clearCanvas(),this.state.detectWidth&&(this.radiuses.push(0),this.pathWidth=new tf.a.Path({segments:[t.point],strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5}),this.penSizeCircle=new tf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88",this.timeStamps.push(Date.now())),this.path=new tf.a.Path({segments:[t.point],strokeColor:"black",strokeWidth:5});break;case"addPoint":if(e=null,e=this.path.hitTest(t.point,{fill:!0,stroke:!0,tolerance:5})){var E=e.location.curve,M=E.length;for(var C in this.path.insert(E.segment2.index,e.point),this.controlPoints.splice(E.segment2.index,0,{position:{x:e.point.x,y:e.point.x},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[E.segment2.index].assignedVariables[C]=[];this.path.getOffsetOf(e.point);for(var T=0;T<E.segment1.index;T++)this.path.curves[T].length;if(this.state.detectWidth){var k=this.controlPoints[E.segment1.index].radius,P=(this.controlPoints[E.segment2.index+1].radius-k)*E.length/M+k;this.controlPoints[E.segment2.index].radius=P,this.drawPathWidth()}}break;case"eraser":if(e=null,e=this.path.hitTest(t.point,{segments:!0,tolerance:5})){var A=e.segment.index;this.path.removeSegment(A),this.controlPoints.splice(A,1),this.state.detectWidth&&this.drawPathWidth()}break;case"controlPoint":this.tool.minDistance=1,this.selectedIdx=-1,this.selectedHandle=null,this.selectedPoint=null,e=null,(e=this.path.hitTest(t.point,{handles:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,"handle-in"===e.type?this.selectedHandle=e.segment.handleIn:"handle-out"===e.type&&(this.selectedHandle=e.segment.handleOut)),null==this.selectedHandle&&(e=this.path.hitTest(t.point,{segments:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,this.selectedPoint=e.segment);break;case"changeWidth":this.state.detectWidth&&(this.tool.minDistance=1,this.selectedIdx=-1,this.selectedPoint=null,e=null,(e=this.path.hitTest(t.point,{segments:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,this.selectedPoint=e.segment))}}}}},{key:"CanvasOnMouseDrag",value:function(){return function(t){var e=t.event.type;if(!this.state.assignVariables)switch(this.state.selector){case"pen":if(this.path.add(t.point),this.state.detectWidth)if("mousemove"===e){var n=Date.now(),i=n-this.timeStamps[this.timeStamps.length-1];this.timeStamps.push(n);var r=Math.min(i/1e3*30+2.5,100),a=t.delta.x,o=t.delta.y,s=Math.sqrt(a*a+o*o),l=t.delta;l.angle+=90;var u={x:t.middlePoint.x+r/s*l.x,y:t.middlePoint.y+r/s*l.y},c={x:t.middlePoint.x-r/s*l.x,y:t.middlePoint.y-r/s*l.y};this.pathWidth.add(u),this.pathWidth.insert(0,c),this.pathWidth.smooth(),this.radiuses.push(r),this.penSizeCircle.remove(),this.penSizeCircle=new tf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88"}else if("touchmove"===e&&t.event.touches.length>0){var h=97.5*t.event.touches[0].force+2.5,d=t.delta.x,f=t.delta.y,p=Math.sqrt(d*d+f*f),m=t.delta;m.angle+=90;var g={x:t.middlePoint.x+h/p*m.x,y:t.middlePoint.y+h/p*m.y},v={x:t.middlePoint.x-h/p*m.x,y:t.middlePoint.y-h/p*m.y};this.pathWidth.add(g),this.pathWidth.insert(0,v),this.pathWidth.smooth(),this.radiuses.push(h),this.penSizeCircle.remove(),this.penSizeCircle=new tf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88"}break;case"controlPoint":if(this.selectedIdx>=0&&(this.selectedHandle&&(this.selectedHandle.x+=t.delta.x,this.selectedHandle.y+=t.delta.y),this.selectedPoint&&(this.selectedPoint.point.x+=t.delta.x,this.selectedPoint.point.y+=t.delta.y,this.controlPoints[this.selectedIdx].position={x:this.selectedPoint.point.x+t.delta.x,y:this.selectedPoint.point.y+t.delta.y}),null!==this.controlPoints[this.selectedIdx].label&&(this.controlPoints[this.selectedIdx].label.position=new tf.a.Point(this.controlPoints[this.selectedIdx].position.x,this.controlPoints[this.selectedIdx].position.y-10),this.controlPoints[this.selectedIdx].labelRect.position=this.controlPoints[this.selectedIdx].label.bounds)),this.state.detectWidth){if(this.selectedIdx>0&&this.selectedIdx<this.path.segments.length-1){for(var y=0,b=0;b<this.selectedIdx-1;b++)y+=this.path.curves[b].length;for(var x=this.controlPoints[this.selectedIdx-1].radius,_=this.controlPoints[this.selectedIdx].radius,w=this.controlPoints[this.selectedIdx+1].radius,S=this.path.curves[this.selectedIdx-1].length,E=1;E<this.curveSegment;E++){var M=(_-x)*E/this.curveSegment+x,C=this.path.getPointAt(y+S/this.curveSegment*E),T=void 0,k=(this.selectedIdx-1)*this.curveSegment+E,P=this.segPoints[k-1];T=new tf.a.Point(C.x-P.x,C.y-P.y);var A=Math.sqrt(T.x*T.x+T.y*T.y);T.angle+=90,this.segPoints[k]=C,this.pathUpper[k]={x:C.x+M/A*T.x,y:C.y+M/A*T.y},this.pathLower[k]={x:C.x-M/A*T.x,y:C.y-M/A*T.y}}y+=S,S=this.path.curves[this.selectedIdx].length;for(var O=0;O<this.curveSegment;O++){var L=(w-_)*O/this.curveSegment+_,R=this.path.getPointAt(y+S/this.curveSegment*O),I=void 0,N=this.selectedIdx*this.curveSegment+O,D=this.segPoints[N-1];I=new tf.a.Point(R.x-D.x,R.y-D.y);var z=Math.sqrt(I.x*I.x+I.y*I.y);I.angle+=90,this.segPoints[N]=R,this.pathUpper[N]={x:R.x+L/z*I.x,y:R.y+L/z*I.y},this.pathLower[N]={x:R.x-L/z*I.x,y:R.y-L/z*I.y}}}else if(0===this.selectedIdx)for(var B=this.controlPoints[0].radius,F=this.controlPoints[1].radius,V=this.path.curves[0].length,j=0;j<this.curveSegment;j++){var U=(F-B)*j/this.curveSegment+B,H=this.path.getPointAt(V/this.curveSegment*j),G=void 0;if(0===j)G=new tf.a.Point(this.path.segments[0].handleOut.x,this.path.segments[0].handleOut.y);else{var W=this.segPoints[j-1];G=new tf.a.Point(H.x-W.x,H.y-W.y)}var q=Math.sqrt(G.x*G.x+G.y*G.y);G.angle+=90,this.segPoints[j]=H,this.pathUpper[j]={x:H.x+U/q*G.x,y:H.y+U/q*G.y},this.pathLower[j]={x:H.x-U/q*G.x,y:H.y-U/q*G.y}}else if(this.selectedIdx===this.path.segments.length-1){for(var $=0,Q=0;Q<this.selectedIdx-1;Q++)$+=this.path.curves[Q].length;for(var Y=this.controlPoints[this.selectedIdx-1].radius,X=this.controlPoints[this.selectedIdx].radius,Z=this.path.curves[this.selectedIdx-1].length,J=1;J<=this.curveSegment;J++){var K=(X-Y)*J/this.curveSegment+Y,tt=void 0;tt=J!==this.curveSegment?this.path.getPointAt($+Z/this.curveSegment*J):this.path.segments[this.path.segments.length-1].point;var et=void 0,nt=(this.selectedIdx-1)*this.curveSegment+J,it=this.segPoints[nt-1];et=new tf.a.Point(tt.x-it.x,tt.y-it.y);var rt=Math.sqrt(et.x*et.x+et.y*et.y);et.angle+=90,this.segPoints[nt]=tt,this.pathUpper[nt]={x:tt.x+K/rt*et.x,y:tt.y+K/rt*et.y},this.pathLower[nt]={x:tt.x-K/rt*et.x,y:tt.y-K/rt*et.y}}}var at=this.pathLower.slice().reverse(),ot=this.pathUpper.concat(at);this.pathWidth.remove(),this.pathWidth=null,this.pathWidth=new tf.a.Path({segments:ot,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5,closed:!0}),this.pathWidth.smooth(),this.pathWidth.sendToBack()}break;case"changeWidth":if(this.state.detectWidth&&this.selectedPoint){var st=t.point.x-this.selectedPoint.point.x,lt=t.point.y-this.selectedPoint.point.y,ut=Math.sqrt(st*st+lt*lt);this.penSizeCircle&&this.penSizeCircle.remove(),this.penSizeCircle=new tf.a.Path.Circle(this.selectedPoint.point,ut),this.penSizeCircle.strokeColor="#325D88"}}}}},{key:"CanvasOnMouseUp",value:function(){return function(t){var e=t.event.type;if(!this.state.assignVariables){switch(this.state.selector){case"pen":this.path.add(t.point);var n=this.path.segments.slice(0,this.path.segments.length);if(n[n.length-2].point.x,n[n.length-1].point.x,this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.state.detectWidth){var i=0;if("mouseup"===e){var r=Date.now(),a=r-this.timeStamps[this.timeStamps.length-1];this.timeStamps.push(r),i=Math.min(a/1e3*30+2.5,100)}else"touchend"===e&&t.event.touches.length>0&&(i=97.5*t.event.touches[0].force+2.5);this.radiuses.push(i);var o=n.length/this.path.segments.length;o=Math.floor(o)%2==1?Math.floor(o):Math.ceil(o);for(var s=0,l=0;s<n.length&&l<this.path.segments.length;)if(n[s].point.x!==this.path.segments[l].point.x||n[s].point.y!==this.path.segments[l].point.y)s++;else{var u=0,c=0,h=s-Math.floor(o/2),d=s+Math.floor(o/2);h=Math.max(0,h),d=Math.min(n.length-1,d);for(var f=h;f<=d;f++)u+=this.radiuses[f],c++;u/=c,this.controlPoints[l].radius=u,s++,l++}this.radiuses=[],this.drawPathWidth(),this.penSizeCircle.remove()}this.penSizeCircle=null,this.sketching=!1,this.touch=!1,this.touchPressure=0;break;case"controlPoint":this.selectedHandle=null,this.selectedPoint=null;break;case"changeWidth":if(this.state.detectWidth&&this.penSizeCircle&&this.selectedPoint){var p=this.penSizeCircle.segments[0].point.x-this.selectedPoint.point.x,m=this.penSizeCircle.segments[0].point.y-this.selectedPoint.point.y,g=Math.sqrt(p*p+m*m);this.controlPoints[this.selectedIdx].radius=g,this.selectedHandle=null,this.selectedPoint=null,this.selectedIdx=-1,this.drawPathWidth(),this.penSizeCircle.remove()}}this.tool.minDistance=15}this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"drawPathWidth",value:function(){if(this.path.curves.length>0){this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.segPoints=[];for(var t=[],e=[],n=0,i=0;i<this.path.curves.length;i++){for(var r=this.controlPoints[i].radius,a=this.controlPoints[i+1].radius,o=this.path.curves[i].length,s=0;s<this.curveSegment;s++){var l=(a-r)*s/this.curveSegment+r,u=this.path.getPointAt(n+o/this.curveSegment*s),c=void 0;if(0===s&&0!==this.path.segments[i].handleOut.x&&0!==this.path.segments[i].handleOut.y)c=new tf.a.Point(this.path.segments[i].handleOut.x,this.path.segments[i].handleOut.y);else{var h=this.segPoints[this.segPoints.length-1];c=new tf.a.Point(u.x-h.x,u.y-h.y)}var d=Math.sqrt(c.x*c.x+c.y*c.y);c.angle+=90,this.segPoints.push(u),t.push({x:u.x+l/d*c.x,y:u.y+l/d*c.y}),e.push({x:u.x-l/d*c.x,y:u.y-l/d*c.y})}n+=o}var f=this.controlPoints[this.controlPoints.length-1].radius,p=this.path.segments[this.path.segments.length-1].point,m=this.segPoints[this.segPoints.length-1],g=new tf.a.Point(p.x-m.x,p.y-m.y),v=Math.sqrt(g.x*g.x+g.y*g.y);g.angle+=90,this.segPoints.push(p),t.push({x:p.x+f/v*g.x,y:p.y+f/v*g.y}),e.push({x:p.x-f/v*g.x,y:p.y-f/v*g.y}),this.pathUpper=t,this.pathLower=e;var y=e.slice().reverse(),b=t.concat(y);this.pathWidth=new tf.a.Path({segments:b,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5,closed:!0}),this.pathWidth.smooth(),this.pathWidth.sendToBack()}}},{key:"convertSketchIntoQuery",value:function(t,e){if(this.state.targetList.length>0&&this.path&&this.path.curves.length>0){var n={};for(var i in this.state.lookup)"z"!==i&&(n[i]=[]);if("z"!==t&&"z"!==e){var r=this.path.length,a=$("#periodOfSketchQuery").val();if(""!==a){var o,s=r/(a=Number(a)),l=this.path.curves[0].length,u=0,c=0,h=[],d=[];if(this.widthVar){var f=nf(p(this.controlPoints,(function(t){return t.radius})),2);h=[f[0],f[1]],d=this.widthRange}for(var m in n)this.controlPoints[0].assignedVariables[m].length>0&&n[m].push(this.controlPoints[0].assignedVariables[m]);o=this.controlPoints[0].position;for(var g=0;g<=a;g++){var v=this.path.getPointAt(s*g);if(v){for(var y in n)if(y===t)n[y].push(this.xScale.invert(v.x));else if(y===e)n[y].push(this.yScale.invert(v.y));else if(y===this.widthVar){var b=(this.controlPoints[u+1].radius-this.controlPoints[u].radius)*(s*g-c)/l+this.controlPoints[u].radius;n[y].push((d[1]-d[0])/(h[1]-h[0])*(b-h[0])+d[0])}else n[y].push(null);if(c+l<=s*g){var x=this.controlPoints[u+1].position,_=this.controlPoints[u+1].assignedVariables;if(Math.sqrt(Math.pow(x.x-o.x,2)+Math.pow(x.y-o.y,2))<=Math.sqrt(Math.pow(x.x-v.x,2)+Math.pow(x.y-v.y,2)))for(var w in n)_[w].length>0&&(n[w][n[w].length-2]=_[w]);else for(var S in n)_[S].length>0&&(n[S][n[S].length-1]=_[S]);c+=l,(u+=1)<this.path.curves.length&&(l=this.path.curves[u].length)}o=v}}var E=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var M in E)E[M].length>0&&(n[M][n[M].length-1]=E[M])}}else if("z"===t){var C=this.controlPoints[0].position.x,T=this.controlPoints[this.controlPoints.length-1].position.x,k=this.xScale.invert(T-C);$("#periodOfSketchQuery").val(cd(k)),$("#targetLengthMin").val(Math.floor(k)),$("#targetLengthMax").val(Math.ceil(k));var P,A=this.path.curves[0].length,O=0,L=0,R=[],I=[];if(this.widthVar){var N=nf(p(this.controlPoints,(function(t){return t.radius})),2),D=N[0],z=N[1];Math.min.apply(null,this.state.minList[this.widthVar]),Math.max.apply(null,this.state.maxList[this.widthVar]),R=[D,z],I=this.widthRange}var B=this.xScale(1),F=new tf.a.Path.Line(new tf.a.Point(C,0),new tf.a.Point(C,this.state.size)),V=C;for(P=this.controlPoints[0].position;V<=T;){var j=this.path.getIntersections(F);if(j.length>0){var U=this.path.getOffsetOf(j[0].point);for(var H in n)if(H===this.state.yItem)n[H].push(this.yScale.invert(j[0].point.y));else if(H===this.widthVar){var G=(this.controlPoints[O+1].radius-this.controlPoints[O].radius)*(U-L)/A+this.controlPoints[O].radius;n[H].push((I[1]-I[0])/(R[1]-R[0])*(G-R[0])+I[0])}else"z"!==H&&n[H].push(null);if(L+A<=U){var W=this.controlPoints[O+1].position,q=this.controlPoints[O+1].assignedVariables;if(Math.sqrt(Math.pow(W.x-P.x,2)+Math.pow(W.y-P.y,2))<=Math.sqrt(Math.pow(W.x-j[0].point.x,2)+Math.pow(W.y-j[0].point.y,2)))for(var Q in n)q[Q].length>0&&(n[Q][n[Q].length-2]=q[Q]);else for(var Y in n)q[Y].length>0&&(n[Y][n[Y].length-1]=q[Y]);L+=A,(O+=1)<this.path.curves.length&&(A=this.path.curves[O].length)}}V+=B,F.segments[0].point.x=V,F.segments[1].point.x=V}F.remove();var X=this.controlPoints[0].assignedVariables;for(var Z in n)X[Z].length>0&&(n[Z][0]=X[Z]);var J=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var K in J)J[K].length>0&&(n[K][n[K].length-1]=J[K])}else if("z"===e){var tt=this.controlPoints[0].position.y,et=this.controlPoints[this.controlPoints.length-1].position.y,nt=this.yScale.invert(et-tt);$("#periodOfSketchQuery").val(cd(nt));var it,rt=this.path.curves[0].length,at=0,ot=0,st=[],lt=[];if(this.widthVar){var ut=nf(p(this.controlPoints,(function(t){return t.radius})),2),ct=ut[0],ht=ut[1];Math.min.apply(null,this.state.minList[this.widthVar]),Math.max.apply(null,this.state.maxList[this.widthVar]),st=[ct,ht],lt=this.widthRange}var dt=this.state.size-this.yScale(1),ft=new tf.a.Path.Line(new tf.a.Point(0,tt),new tf.a.Point(this.state.size,tt)),pt=tt;for(it=this.controlPoints[0].position;pt>=et;){var mt=this.path.getIntersections(ft),gt=this.path.getOffsetOf(mt[0].point);for(var vt in n)if(vt===t)n[vt].push(this.xScale.invert(mt[0].point.x));else if(vt===this.widthVar){var yt=(this.controlPoints[at+1].radius-this.controlPoints[at].radius)*(gt-ot)/rt+this.controlPoints[at].radius;n[vt].push((lt[1]-lt[0])/(st[1]-st[0])*(yt-st[0])+lt[0])}else"z"!==vt&&n[vt].push(null);if(ot+rt<=gt){var bt=this.controlPoints[at+1].position,xt=this.controlPoints[at+1].assignedVariables;if(Math.sqrt(Math.pow(bt.x-it.x,2)+Math.pow(bt.y-it.y,2))<=Math.sqrt(Math.pow(bt.x-mt[0].point.x,2)+Math.pow(bt.y-mt[0].point.y,2)))for(var _t in n)xt[_t].length>0&&(n[_t][n[_t].length-2]=xt[_t]);else for(var wt in n)xt[wt].length>0&&(n[wt][n[wt].length-1]=xt[wt]);ot+=rt,(at+=1)<this.path.curves.length&&(rt=this.path.curves[at].length)}pt-=dt,ft.segments[0].point.y=pt,ft.segments[1].point.y=pt}ft.remove();var St=this.controlPoints[0].assignedVariables;for(var Et in n)St[Et].length>0&&(n[Et][0]=St[Et]);var Mt=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var Ct in Mt)Mt[Ct].length>0&&(n[Ct][n[Ct].length-1]=Mt[Ct])}n.arrayLength=n[Object.keys(n)[0]].length,function(t){iu.dispatch({type:"SET_QUERY",query:t})}({mode:"visual query",option:"query-by-sketch",query:{xItem:this.state.lookup[t],yItem:this.state.lookup[e],xRange:this.xScale.domain(),yRange:this.yScale.domain(),widthVar:this.state.lookup[this.widthVar],widthRange:this.widthRange,controlPoints:this.controlPoints,path:this.path.segments,size:this.state.size,length:n.arrayLength},values:n})}this.updateQueryFlag=!1}},{key:"transformDataIntoSketch",value:function(t,e){if(this.path&&(this.path.remove(),this.path=null),this.controlPoints=[],"clustering"!==this.queryData.id){var n=this.queryData.targetData,i=n.z.indexOf(this.queryData.period[0]),r=n.z.indexOf(this.queryData.period[1]);if("z"!==t&&"z"!==e){var a=n[t].slice(i,r+1),o=n[e].slice(i,r+1);this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var s=0;s<a.length;s++)this.path.add(new tf.a.Point(this.xScale(a[s]),this.yScale(o[s])))}else if("z"===t){var l=n[e].slice(i,r+1),u=Math.floor(this.xScale.domain()[1]/2)-Math.floor(l.length/2);this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var c=0;c<l.length;c++)this.path.add(new tf.a.Point(this.xScale(c+u),this.yScale(l[c])))}else if("z"===e){var h=n[t].slice(i,r+1),d=Math.floor(this.yScale.domain()[1]/2)-Math.floor(h.length/2);this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var f=0;f<h.length;f++)this.path.add(new tf.a.Point(this.xScale(h[f]),this.yScale(f+d)))}var m=this.path.segments.slice(0,this.path.segments.length);if(this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.widthVar){for(var g=n[this.widthVar].slice(i,r+1),v=Math.min.apply(null,g),y=Math.max.apply(null,g),b=0;b<g.length;b++)this.radiuses.push((g[b]-v)/(y-v)*22.5+2.5);var x=m.length/this.path.segments.length;x=Math.floor(x)%2==1?Math.floor(x):Math.ceil(x);for(var _=0,w=0;_<m.length&&w<this.path.segments.length;)if(m[_].point.x!==this.path.segments[w].point.x||m[_].point.y!==this.path.segments[w].point.y)_++;else{var S=0,E=0,M=_-Math.floor(x/2),C=_+Math.floor(x/2);M=Math.max(0,M),C=Math.min(m.length-1,C);for(var T=M;T<=C;T++)S+=this.radiuses[T],E++;S/=E,this.controlPoints[w].radius=S,_++,w++}this.radiuses=[],this.drawPathWidth()}}else{var k=this.queryData.targetData;if("z"!==t&&"z"!==e)if(this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var P=p(k[t]),A=p(k[e]);P[0]*=1.2,P[1]*=1.2,A[0]*=1.2,A[1]*=1.2;var O,L,R=this.xScale.domain(),I=this.yScale.domain();"x"!==t&&"y"!==t||(O=Math.abs(R[0])<Math.abs(R[1])?Math.abs(R[0]/P[0]):Math.abs(R[1]/P[1])),"x"!==e&&"y"!==e||(L=Math.abs(I[0])<Math.abs(I[1])?Math.abs(I[0]/A[0]):Math.abs(I[1]/A[1]));for(var N=0;N<k[t].length;N++){var D=void 0,z=void 0;D=void 0!==O?k[t][N]*O:(k[t][N]-P[0])/(P[1]-P[0])*(R[1]-R[0])+R[0],z=void 0!==L?k[e][N]*L:(k[e][N]-A[0])/(A[1]-A[0])*(I[1]-I[0])+I[0],this.path.add(new tf.a.Point(this.xScale(D),this.yScale(z)))}}else for(var B=0;B<k[t].length;B++)this.path.add(new tf.a.Point(this.xScale(k[t][B]),this.yScale(k[e][B])));else if("z"===t)if(this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var F=p(k[e]);F[0]*=1.2,F[1]*=1.2;for(var V=this.xScale.domain(),j=this.yScale.domain(),U=0;U<k[e].length;U++){var H=U/k[e].length*(V[1]-V[0])+V[0],G=(k[e][U]-F[0])/(F[1]-F[0])*(j[1]-j[0])+j[0];this.path.add(new tf.a.Point(this.xScale(H),this.yScale(G)))}}else for(var W=0;W<k[e].length;W++){var q=W/k[e].length*(currentXRange[1]-currentXRange[0])+currentXRange[0];this.path.add(new tf.a.Point(this.xScale(q),this.yScale(k[e][W])))}else if("z"===e)if(this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var $=p(k[t]);$[0]*=1.2,$[1]*=1.2;for(var Q=this.xScale.domain(),Y=this.yScale.domain(),X=0;X<k[t].length;X++){var Z=(k[t][X]-$[0])/($[1]-$[0])*(Q[1]-Q[0])+Q[0],J=X/k[e].length*(Y[1]-Y[0])+Y[0];this.path.add(new tf.a.Point(this.xScale(Z),this.yScale(J)))}}else for(var K=0;K<k[e].length;K++){var tt=K/k[e].length*(currentYRange[1]-currentYRange[0])+currentYRange[0];this.path.add(new tf.a.Point(this.xScale(k[t][K]),this.yScale(tt)))}var et=this.path.segments.slice(0,this.path.segments.length);if(this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.widthVar&&k[this.widthVar]){for(var nt=k[this.widthVar],it=nf(p(nt),2),rt=it[0],at=it[1],ot=0;ot<nt.length;ot++)this.radiuses.push((nt[ot]-rt)/(at-rt)*22.5+2.5);var st=et.length/this.path.segments.length;st=Math.floor(st)%2==1?Math.floor(st):Math.ceil(st);for(var lt=0,ut=0;lt<et.length&&ut<this.path.segments.length;)if(et[lt].point.x!==this.path.segments[ut].point.x||et[lt].point.y!==this.path.segments[ut].point.y)lt++;else{var ct=0,ht=0,dt=lt-Math.floor(st/2),ft=lt+Math.floor(st/2);dt=Math.max(0,dt),ft=Math.min(et.length-1,ft);for(var pt=dt;pt<=ft;pt++)ct+=this.radiuses[pt],ht++;ct/=ht,this.controlPoints[ut].radius=ct,lt++,ut++}this.radiuses=[],this.drawPathWidth()}}}},{key:"CanvasXLabelOnClick",value:function(){return function(){var t=this.state.xItemonPanel,e=Math.min.apply(null,this.state.minList[t]),n=Math.max.apply(null,this.state.maxList[t]);"z"===t&&(n=Math.min(n-e,50),e=0),this.setValueSlider("sketchPadXRangeSlider",e,n),$("#sketchPadXRangeSlider").slider("option","disabled",!1);var i=se("#changeXAxisPanel_SketchPad");if("visible"===i.style("visibility"))i.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var r=document.getElementById("changeXAxisPanel_SketchPad").clientHeight,a=document.getElementById("changeXAxisPanel_SketchPad").clientWidth;if(i.style("transform","translate("+(this.state.size/2-a/2)+"px,"+(this.state.size-r-this.margin.bottom)+"px)").style("visibility","visible"),this.state.xItem===t){var o=(this.xMinMax[0]-e)/(n-e)*100,s=(this.xMinMax[1]-e)/(n-e)*100;$("#sketchPadXRangeSlider").slider("option","values",[o,s])}}}}},{key:"CanvasYLabelOnClick",value:function(){return function(){var t=this.state.yItemonPanel,e=Math.min.apply(null,this.state.minList[t]),n=Math.max.apply(null,this.state.maxList[t]);"z"===t&&(n=Math.min(n-e,50),e=0),this.setValueSlider("sketchPadYRangeSlider",e,n),$("#sketchPadYRangeSlider").slider("option","disabled",!1);var i=se("#changeYAxisPanel_SketchPad");if("visible"===i.style("visibility"))i.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var r=document.getElementById("changeYAxisPanel_SketchPad").clientHeight;document.getElementById("changeYAxisPanel_SketchPad").clientWidth,i.style("transform","translate("+(this.margin.left+10)+"px,"+(this.state.size/2-r/2)+"px)").style("visibility","visible")}if(this.state.yItem===t){var a=(this.yMinMax[0]-e)/(n-e)*100,o=(this.yMinMax[1]-e)/(n-e)*100;$("#sketchPadYRangeSlider").slider("option","values",[a,o])}}}},{key:"onSelectXItem",value:function(t){var e=t.target.value;this.setState({xItemonPanel:e});var n=Math.min.apply(null,this.state.minList[e]),i=Math.max.apply(null,this.state.maxList[e]);"z"===e&&(i=Math.min(i-n,50),n=0),this.setValueSlider("sketchPadXRangeSlider",n,i),$("#sketchPadXRangeSlider").slider("option","disabled",!1)}},{key:"onSelectYItem",value:function(t){var e=t.target.value;this.setState({yItemonPanel:e});var n=Math.min.apply(null,this.state.minList[e]),i=Math.max.apply(null,this.state.maxList[e]);"z"===e&&(i=Math.min(i-n,50),n=0),this.setValueSlider("sketchPadYRangeSlider",n,i),$("#sketchPadYRangeSlider").slider("option","disabled",!1)}},{key:"updateXAxisValue",value:function(t,e){this.xMinMax=[t,e],this.updateAxis()}},{key:"updateYAxisValue",value:function(t,e){this.yMinMax=[t,e],this.updateAxis()}},{key:"updateAxis",value:function(){var t,e=Number($("#featureArea").css("padding-left").replace("px","")),n=Number($("#featureArea").css("padding-right").replace("px","")),i=Math.floor(.3*$("#mainFeatureArea").width()-e-n);this.setState({size:i}),se("#QBSCanvasArea").style("padding-bottom",i+"px"),this.svg.attr("width",i).attr("height",i),this.canvas.attr("width",i+"px !important").attr("height",i+"px !important"),tf.a.setup(this.canvas.node()),this.xScale.domain(this.xMinMax).range([0,i]).nice(),this.xLabel=(t=this.xScale,F(1,t)).ticks(5).tickSize(-i).tickFormat(ud),this.xAxis.call(this.xLabel),this.xAxis.select(".domain").remove(),this.xAxis.selectAll(".tick text").attr("y",i-this.margin.bottom).style("color","#8c7b7b"),this.xAxisText.style("left",i/2+"px").style("top",i-18+"px"),this.yScale.domain(this.yMinMax).range([i,0]).nice(),this.yLabel=function(t){return F(2,t)}(this.yScale).ticks(5).tickSize(i).tickFormat(ud),this.yAxis.call(this.yLabel),this.yAxis.select(".domain").remove(),this.yAxis.selectAll(".tick text").attr("x",this.margin.left).attr("y","-0.5em").style("color","#79897b"),this.yAxisText.style("left",this.margin.left/2+"px").style("top",i/2+"px")}},{key:"changeXAxis",value:function(){this.setState({xItem:this.state.xItemonPanel}),this.xAxisText&&this.xAxisText.text(this.state.lookup[this.state.xItemonPanel]);var t=Math.min.apply(null,this.state.minList[this.state.xItemonPanel]),e=Math.max.apply(null,this.state.maxList[this.state.xItemonPanel]);"z"===this.state.xItemonPanel&&(e=Math.min(e-t,50),t=0);var n=$("#sketchPadXRangeSlider").slider("option","values"),i=n[0]/100*(e-t)+t,r=n[1]/100*(e-t)+t;this.updateXAxisValue(i,r),se("#changeXAxisPanel_SketchPad").transition().duration(50).style("visibility","hidden"),"z"!==this.state.xItemonPanel&&"z"!==this.state.yItem&&$("#periodOfSketchQuery").val(20),Object.keys(this.queryData).length<=0?this.recoverStroke(this.state.xItemonPanel,this.state.yItem):Object.keys(this.queryData.targetData).indexOf(this.state.xItemonPanel)>=0?this.transformDataIntoSketch(this.state.xItemonPanel,this.state.yItem):Object.keys(this.queryData.targetData).indexOf(this.state.xItemonPanel)<0&&this.clearCanvas(),this.convertSketchIntoQuery(this.state.xItemonPanel,this.state.yItem)}},{key:"changeYAxis",value:function(){this.setState({yItem:this.state.yItemonPanel}),this.yAxisText&&this.yAxisText.text(this.state.lookup[this.state.yItemonPanel]);var t=Math.min.apply(null,this.state.minList[this.state.yItemonPanel]),e=Math.max.apply(null,this.state.maxList[this.state.yItemonPanel]);"z"===this.state.yItemonPanel&&(e=Math.min(e-t,50),t=0);var n=$("#sketchPadYRangeSlider").slider("option","values"),i=n[0]/100*(e-t)+t,r=n[1]/100*(e-t)+t;this.updateYAxisValue(i,r),se("#changeYAxisPanel_SketchPad").transition().duration(50).style("visibility","hidden"),"z"!==this.state.xItem&&"z"!==this.state.yItemonPanel&&$("#periodOfSketchQuery").val(20),Object.keys(this.queryData).length<=0?this.recoverStroke(this.state.xItem,this.state.yItemonPanel):Object.keys(this.queryData.targetData).indexOf(this.state.yItemonPanel)>=0?this.transformDataIntoSketch(this.state.xItem,this.state.yItemonPanel):Object.keys(this.queryData.targetData).indexOf(this.state.yItemonPanel)<0&&this.clearCanvas(),this.convertSketchIntoQuery(this.state.xItem,this.state.yItemonPanel)}},{key:"recoverStroke",value:function(t,e){if(0===Object.keys(this.queryData).length){if(this.path){var n=this.path;this.path=new tf.a.Path({segments:n.segments,strokeColor:"black",strokeWidth:5})}if(this.pathWidth){var i=this.pathWidth;this.pathWidth=new tf.a.Path({segments:i.segments,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5}),this.pathWidth.sendToBack()}}else this.transformDataIntoSketch(t,e)}},{key:"selectPen",value:function(){this.setState({selector:"pen"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorPen").addClass("selected"),this.updateSelectedStatus("pen")}},{key:"selectEraser",value:function(){this.setState({selector:"eraser"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorEraser").addClass("selected"),this.updateSelectedStatus("eraser")}},{key:"selectAddPoint",value:function(){this.setState({selector:"addPoint"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorAddPoint").addClass("selected"),this.updateSelectedStatus("addPoint")}},{key:"selectControlPoint",value:function(){this.setState({selector:"controlPoint"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorControlPoint").addClass("selected"),this.updateSelectedStatus("controlPoint")}},{key:"selectChangeWidth",value:function(){this.setState({selector:"changeWidth"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorChangeWidth").addClass("selected"),this.updateSelectedStatus("changeWidth")}},{key:"switchVariableAssignment",value:function(){var t=!this.state.assignVariables;if(this.setState({assignVariables:t}),t)$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected"),$(this).addClass("disabled")}));else{var e=this.state.selector;$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled"),$(this).attr("value")===e&&$(this).addClass("selected")}))}$("#variableAssignmentSwitch").prop("checked",t),t&&this.path?this.path.fullySelected=!0:t||(this.setState({popover:!1}),this.highlightedPoint&&this.highlightedPoint.remove(),this.updateSelectedStatus(this.state.selector))}},{key:"updateSelectedStatus",value:function(t){"addPoint"===t||"eraser"===t||"controlPoint"===t||"changeWidth"===t?this.path&&(this.path.fullySelected=!0):"pen"===t&&this.path&&(this.path.fullySelected=!1)}},{key:"removeAllAsignment",value:function(){for(var t=0;t<this.controlPoints.length;t++){for(var e in this.controlPoints[t].assignedVariables)this.controlPoints[t].assignedVariables[e]=[];this.controlPoints[t].label&&(this.controlPoints[t].label.remove(),this.controlPoints[t].label=null,this.controlPoints[t].labelRect.remove(),this.controlPoints[t].labelRect=null)}}},{key:"axisSelectionPanel",value:function(){var t=[],e=[];for(var n in this.state.lookup){var i="";(i=this.state.lookup[n].length>1?this.state.lookup[n].join(","):this.state.lookup[n]).indexOf("JD")<0?(t.push(r.a.createElement("div",{className:"form-check",key:i,style:{paddingLeft:"0px"}},r.a.createElement("input",{type:"radio",name:"selectXAxis_SketchPad",value:n,checked:this.state.xItemonPanel===n,onChange:this.onSelectXItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",key:i},i))),e.push(r.a.createElement("div",{className:"form-check",key:i,style:{paddingLeft:"0px"}},r.a.createElement("input",{type:"radio",name:"selectYAxis_SketchPad",value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",key:i},i)))):(t.unshift(r.a.createElement("div",{className:"form-check",key:i,style:{paddingLeft:"0px"}},r.a.createElement("input",{type:"radio",name:"selectXAxis_SketchPad",value:n,checked:this.state.xItemonPanel===n,onChange:this.onSelectXItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",key:i},i))),e.unshift(r.a.createElement("div",{className:"form-check",key:i,style:{paddingLeft:"0px"}},r.a.createElement("input",{type:"radio",name:"selectYAxis_SketchPad",value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",key:i},i))))}return{x:r.a.createElement("div",{className:"overlayPanel",id:"changeXAxisPanel_SketchPad",style:{visibility:"hidden",textAlign:"center",zIndex:"101"}},r.a.createElement("h6",null,"Change x axis"),r.a.createElement("div",{id:"changeXAxisItem_SketchPad",style:{textAlign:"left"}},r.a.createElement("form",{id:"changeXAxisForm_SketchPad"},t),r.a.createElement("div",{className:"featureElem",id:"sketchPadXRangeSlider",style:{width:"150px"}},r.a.createElement("output",{id:"sketchPadXRangeSliderMax",style:{bottom:"1.3rem",zIndex:200}}),r.a.createElement("output",{id:"sketchPadXRangeSliderMin",style:{bottom:"1.3rem",zIndex:201}})),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_SketchPad",style:{float:"right"},onClick:this.changeXAxis.bind(this)},"Done"))),y:r.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_SketchPad",style:{visibility:"hidden",textAlign:"center",zIndex:"102"}},r.a.createElement("h6",null,"Change y axis"),r.a.createElement("div",{id:"changeYAxisItem_SketchPad",style:{textAlign:"left"}},r.a.createElement("form",{id:"changeYAxisForm_SketchPad"},e)),r.a.createElement("div",{className:"featureElem",id:"sketchPadYRangeSlider",style:{width:"150px"}},r.a.createElement("output",{id:"sketchPadYRangeSliderMax",style:{bottom:"1.3rem",zIndex:200}}),r.a.createElement("output",{id:"sketchPadYRangeSliderMin",style:{bottom:"1.3rem",zIndex:201}})),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_SketchPad",style:{float:"right"},onClick:this.changeYAxis.bind(this)},"Done"))}}},{key:"sketchMenu",value:function(){return r.a.createElement("div",{id:"QBSSelectorMenu",className:"featureElem"},r.a.createElement("h5",null,"Selection"),r.a.createElement("form",{className:"selector featureRow"},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("img",{id:"selectorPen",className:"selectorIcon selected",name:"QBSSelector",value:"pen",src:"img/icons/pen.png",alt:"pen",width:"30",height:"30",title:"draw a sketch",onClick:this.selectPen.bind(this),readOnly:!0}),r.a.createElement("img",{id:"selectorAddPoint",className:"selectorIcon",name:"QBSSelector",value:"addPoint",src:"img/icons/add.png",alt:"add point",width:"30",height:"30",title:"add a control point on the sketch",onClick:this.selectAddPoint.bind(this),readOnly:!0}),r.a.createElement("img",{id:"selectorEraser",className:"selectorIcon",name:"QBSSelector",value:"eraser",src:"img/icons/delete.png",alt:"delete point",width:"30",height:"30",title:"remove a control point from the sketch",onClick:this.selectEraser.bind(this),readOnly:!0}),r.a.createElement("img",{id:"selectorControlPoint",className:"selectorIcon",name:"QBSSelector",value:"controlPoint",src:"img/icons/control.png",alt:"control point",width:"30",height:"30",title:"move a control point on the sketch",onClick:this.selectControlPoint.bind(this),readOnly:!0}),r.a.createElement("img",{id:"selectorChangeWidth",className:"selectorIcon",name:"QBSSelector",value:"changeWidth",src:"img/icons/width.png",alt:"change width",width:"30",height:"30",title:"change the width of the sketch",onClick:this.selectChangeWidth.bind(this),readOnly:!0})),r.a.createElement("div",{id:"selectorExploration",className:"tooltip",style:{visibility:"hidden"}})))}},{key:"sketchOptions",value:function(){return r.a.createElement("div",{id:"QBSSketchOptions",className:"featureElem"},r.a.createElement("h5",{onClick:this.collapseQBSSketchOptions},"Options of Query-by-sketch"),r.a.createElement("div",{id:"QBSSketchOptionsMain"},this.sketchWidthControl(),this.assignVariablesArea(),this.definePeriodOfQuery()))}},{key:"sketchPadPreset",value:function(){return r.a.createElement("div",{className:"featureElem form-inline",style:{float:"left"}},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"sketchPadPreset",style:{width:"8rem"},onChange:this.changeSketchPadAxes.bind(this)},r.a.createElement("option",{value:"Stokes"},"Stokes plane"),r.a.createElement("option",{value:"lightCurve"},"Light curve")))}},{key:"changeSketchPadAxes",value:function(){var t=document.getElementById("sketchPadPreset");if(t&&t.options.length>0){var e,n,i,r,a=t.selectedIndex;switch(t.options[a].value){case"Stokes":this.xAxisText&&this.xAxisText.text(this.state.lookup.x),this.yAxisText&&this.yAxisText.text(this.state.lookup.y),e=Math.min.apply(null,this.state.minList.x),n=Math.max.apply(null,this.state.maxList.x),i=Math.min.apply(null,this.state.minList.y),r=Math.max.apply(null,this.state.maxList.y),this.setValueSlider("sketchPadXRangeSlider",e,n),this.updateXAxisValue(e,n),this.setValueSlider("sketchPadYRangeSlider",i,r),this.updateYAxisValue(i,r),Object.keys(this.queryData).length<=0?this.recoverStroke("x","y"):this.transformDataIntoSketch("x","y"),this.convertSketchIntoQuery("x","y"),this.setState({xItem:"x",xItemonPanel:"x",yItem:"y",yItemonPanel:"y"});break;case"lightCurve":this.xAxisText&&this.xAxisText.text(this.state.lookup.z),this.yAxisText&&this.yAxisText.text(this.state.lookup.V),e=Math.min.apply(null,this.state.minList.z),n=Math.max.apply(null,this.state.maxList.z),n=Math.min(n-e,50),e=0,i=Math.min.apply(null,this.state.minList.V),r=Math.max.apply(null,this.state.maxList.V),this.setValueSlider("sketchPadXRangeSlider",e,n),this.updateXAxisValue(e,n),this.setValueSlider("sketchPadYRangeSlider",i,r),this.updateYAxisValue(i,r),Object.keys(this.queryData).length<=0?this.recoverStroke("z","V"):this.transformDataIntoSketch("z","V"),this.convertSketchIntoQuery("z","V"),this.setState({xItem:"z",xItemonPanel:"z",yItem:"V",yItemonPanel:"V"})}}}},{key:"importExportQueryMenu",value:function(){return r.a.createElement("div",{id:"importExportQuery",className:"featureElem form-inline",style:{float:"right"}},r.a.createElement("div",{className:"custom-file",style:{width:"170px",marginRight:"0.5rem"}},r.a.createElement("input",{type:"file",id:"importQuery",className:"custom-file-input",onChange:this.importQuery.bind(this)}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"importQuery",style:{justifyContent:"start"}},"Import")),r.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.exportQuery.bind(this)},"Export"))}},{key:"importQuery",value:function(){var t=document.getElementById("importQuery").files,e=new FileReader;e.readAsText(t[0]),e.onload=function(){var t=e.result,n=JSON.parse(t);if("query-by-sketch"===n.option){var i,r;this.clearCanvas();for(var a=0;a<n.query.xItem.length;a++)for(var o in this.state.lookup)if(this.state.lookup[o].indexOf(n.query.xItem[a])>=0){i=o;break}for(var s=0;s<n.query.yItem.length;s++)for(var l in this.state.lookup)if(this.state.lookup[l].indexOf(n.query.yItem[s])>=0){r=l;break}this.setState({xItem:i,xItemonPanel:i,yItem:r,yItemonPanel:r,detectWidth:!!n.query.widthVar}),this.xAxisText&&this.xAxisText.text(this.state.lookup[i]),this.yAxisText&&this.yAxisText.text(this.state.lookup[r]),this.xMinMax=n.query.xRange,this.yMinMax=n.query.yRange,this.updateAxis(),$("#periodOfSketchQuery").val(n.query.length);for(var u=this.state.size/n.query.size,c=0;c<n.query.controlPoints.length;c++)this.controlPoints.push(n.query.controlPoints[c]),this.controlPoints[this.controlPoints.length-1].position.x=this.controlPoints[this.controlPoints.length-1].position.x*u,this.controlPoints[this.controlPoints.length-1].position.y=this.controlPoints[this.controlPoints.length-1].position.y*u;this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var h=0;h<n.query.path.length;h++)this.path.add(new tf.a.Point(n.query.path[h][1][0]*u,n.query.path[h][1][1]*u)),this.path.segments[this.path.segments.length-1].handleIn.x=n.query.path[h][2][0]*u,this.path.segments[this.path.segments.length-1].handleIn.y=n.query.path[h][2][1]*u,this.path.segments[this.path.segments.length-1].handleOut.x=n.query.path[h][3][0]*u,this.path.segments[this.path.segments.length-1].handleOut.y=n.query.path[h][3][1]*u;if(n.query.widthVar){for(var d=0;d<n.query.widthVar.length;d++)for(var f in this.state.lookup)if(this.state.lookup[f].indexOf(n.query.widthVar[d])>=0){this.widthVar=f;break}this.widthRange=n.query.widthRange,this.changeWidthVariable(this.widthVar,this.widthRange);for(var p=0;p<this.controlPoints.length;p++)this.controlPoints[p].radius=n.query.controlPoints[p].radius;this.drawPathWidth()}for(var m=0;m<this.controlPoints.length;m++){var g="";for(var v in this.controlPoints[m].assignedVariables)this.controlPoints[m].assignedVariables[v].length>0&&(g+=this.state.lookup[v]+", ");""!==g&&(this.controlPoints[m].label=new tf.a.PointText({position:{x:this.controlPoints[m].position.x,y:this.controlPoints[m].position.y},fillColor:"#7b7971",justification:"center",fontSize:8}),g=g.slice(0,-2),this.controlPoints[m].label.content=g,this.controlPoints[m].labelRect=new tf.a.Path.Rectangle(this.controlPoints[m].label.bounds),this.controlPoints[m].labelRect.fillColor="white",this.controlPoints[m].labelRect.strokeColor="white",this.controlPoints[m].label.insertAbove(this.controlPoints[m].labelRect))}this.convertSketchIntoQuery(i,r)}else alert("This file is not for a query-by-sketch.")}.bind(this)}},{key:"exportQuery",value:function(){if(this.path){var t=dh.getQuery();if("query-by-sketch"===t.option){t=JSON.stringify(t,null,"\t");var e="sketchQuery_"+Jc()+".json",n=new Blob([t],{type:"application/json"}),i=(window.URL||window.webkitURL).createObjectURL(n),r=document.createElement("a");r.download=decodeURI(e),r.href=i,r.click()}else alert("You can export only a query-by-sketch.")}}},{key:"recoverQuery",value:function(t,e){for(var n=this.state.size/t.query.size,i=0;i<t.query.controlPoints.length;i++)this.controlPoints.push(t.query.controlPoints[i]),this.controlPoints[this.controlPoints.length-1].position.x*=n,this.controlPoints[this.controlPoints.length-1].position.y*=n;this.path=new tf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var r=0;r<t.query.path.length;r++)this.path.add(new tf.a.Point(t.query.path[r][1][0]*n,t.query.path[r][1][1]*n)),this.path.segments[this.path.segments.length-1].handleIn.x=t.query.path[r][2][0]*n,this.path.segments[this.path.segments.length-1].handleIn.y=t.query.path[r][2][1]*n,this.path.segments[this.path.segments.length-1].handleOut.x=t.query.path[r][3][0]*n,this.path.segments[this.path.segments.length-1].handleOut.y=t.query.path[r][3][1]*n;if(this.widthVar){for(var a=0;a<this.controlPoints.length;a++)this.controlPoints[a].radius=t.query.controlPoints[a].radius;this.drawPathWidth()}for(var o=0;o<this.controlPoints.length;o++){var s="";for(var l in this.controlPoints[o].assignedVariables)this.controlPoints[o].assignedVariables[l].length>0&&(s+=e[l]+", ");""!==s&&(this.controlPoints[o].label=new tf.a.PointText({position:{x:this.controlPoints[o].position.x,y:this.controlPoints[o].position.y},fillColor:"#7b7971",justification:"center",fontSize:8}),s=s.slice(0,-2),this.controlPoints[o].label.content=s,this.controlPoints[o].labelRect=new tf.a.Path.Rectangle(this.controlPoints[o].label.bounds),this.controlPoints[o].labelRect.fillColor="white",this.controlPoints[o].labelRect.strokeColor="white",this.controlPoints[o].label.insertAbove(this.controlPoints[o].labelRect))}this.updateQueryFlag=!0}},{key:"collapseQBSSketchOptions",value:function(){$("#QBSSketchOptionsMain").slideToggle()}},{key:"sketchWidthControl",value:function(){var t=[];for(var e in this.state.lookup)if(e!==this.state.xItem&&e!==this.state.yItem){var n="";n=this.state.lookup[e].length>1?this.state.lookup[e].join(","):this.state.lookup[e],"z"!==e&&(e===this.widthVar?t.push(r.a.createElement("option",{key:e,value:e,selected:!0},n)):t.push(r.a.createElement("option",{key:e,value:e},n)))}return r.a.createElement("div",{id:"sketchWidthControl",className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},r.a.createElement("h6",null,"Variable assigned to the sketch width"),r.a.createElement("div",{className:"row matchingOption",style:{paddingLeft:"15px",paddingRight:"15px"}},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"widthDetectionSwitch",checked:this.state.detectWidth,onChange:this.updateWidthDetection.bind(this)}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"widthDetectionSwitch"},"Detect width"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-5"},"Variable assigned to width"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"widthVariables",style:{width:"40%"},disabled:!this.state.detectWidth,defaultValue:this.widthVar,onChange:this.updateWidthVariable.bind(this)},t))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-5"},"Value range"),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"featureElem",id:"sketchWidthSlider",style:{width:"150px"}},r.a.createElement("output",{id:"sketchWidthSliderMax",style:{bottom:"1.3rem",zIndex:200}}),r.a.createElement("output",{id:"sketchWidthSliderMin",style:{bottom:"1.3rem",zIndex:201}})))))}},{key:"updateWidthDetection",value:function(){var t=!this.state.detectWidth;if(this.setState({detectWidth:t}),t){var e=document.getElementById("widthVariables"),n=e.selectedIndex,i=e.options[n].value;this.widthVar=i,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}else this.widthVar=null,this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem),$("img[name=QBSSelector]").each((function(){"changeWidth"===$(this).attr("value")&&$(this).addClass("disabled")}))}},{key:"updateWidthVariable",value:function(){var t=document.getElementById("widthVariables");if(t&&t.options.length>0){var e=t.selectedIndex,n=t.options[e].value;this.widthRange=[Math.min.apply(null,this.state.minList[n]),Math.max.apply(null,this.state.maxList[n])],this.setValueSlider("sketchWidthSlider",this.widthRange[0],this.widthRange[1]),$("#sketchWidthSlider").on("slidestop",this.stopSlidingWidthSlider().bind(this)),$("#sketchWidthSlider").slider("option","disabled",!this.state.detectWidth),this.widthVar=n,Object.keys(this.queryData).length>0&&this.transformDataIntoSketch(this.state.xItem,this.state.yItem),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"changeWidthVariable",value:function(t,e){var n=document.getElementById("widthVariables"),i=-1;if(n&&n.options.length>0)for(i=0;i<n.options.length&&n.options[i].value!==t;i++);if(i<n.options.length&&(n.selectedIndex=i),void 0!==e){var r=Math.min.apply(null,this.state.minList[t]),a=Math.max.apply(null,this.state.maxList[t]),o=(e[0]-r)/(a-r)*100,s=(e[1]-r)/(a-r)*100;this.widthRange=e,this.setValueSlider("sketchWidthSlider",e[0],e[1]),(o||s)&&$("#sketchWidthSlider").slider("option","values",[o,s])}}},{key:"stopSlidingWidthSlider",value:function(){return function(t,e){this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"definePeriodOfQuery",value:function(){return r.a.createElement("div",{id:"timeLengthOfSketch"},r.a.createElement("h6",null,"The length of time of the sketch"),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Length of the sketched query"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"Length of time",id:"periodOfSketchQuery",style:{width:"40%",marginRight:"0.5rem"},onChange:this.updateTimeLength.bind(this),required:!0,disabled:"z"===this.state.xItem||"z"===this.state.yItem}),r.a.createElement("label",{className:"col-form-label col-form-label-sm",htmlFor:"periodOfSketchQuery"},"days"))))}},{key:"updateTimeLength",value:function(){var t=$("#periodOfSketchQuery").val();if(""!==t){t=Number(t);var e=$("#QBSSketchPad").width();if("z"===this.state.xItem){var n=this.controlPoints[0].position.x,i=this.controlPoints[this.controlPoints.length-1].position.x;this.updateXAxisValue(0,cd(t/(i-n)*e))}else if("z"===this.state.yItem){var r=this.controlPoints[0].position.y,a=this.controlPoints[this.controlPoints.length-1].position.y;this.updateYAxisValue(0,cd(t/(a-r)*e))}this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"assignVariablesArea",value:function(){return r.a.createElement("div",{id:"variableAssignment"},r.a.createElement("h6",null,"Assign variables to the sketch"),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"variableAssignmentSwitch",onChange:this.switchVariableAssignment.bind(this)}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"variableAssignmentSwitch"},"Assign variables"))),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"removeAllAssignment",onClick:this.removeAllAsignment.bind(this)},"Remove all assignments"))))}},{key:"onClickValueAssignmentCheckbox",value:function(t){var e=t.target.value,n=t.target.checked;$("#slider_"+e).slider("option","disabled",!n)}},{key:"onClickValueAssignmentDone",value:function(){$("#controlPointPopover").css("display","none");for(var t=$("input[name=assignedVariableList]"),e="",n=(this.controlPoints[this.highlightedPointIdx].assignedVariables,0);n<t.length;n++)if(t[n].checked){var i=t[n].value,r=Math.min.apply(null,this.state.minList[i]),a=Math.max.apply(null,this.state.maxList[i]),o=$("#slider_"+t[n].value).slider("option","values");this.controlPoints[this.highlightedPointIdx].assignedVariables[i]=[r+(a-r)*o[0]/100,r+(a-r)*o[1]/100],e+=this.state.lookup[i]+", "}else{var s=t[n].value;this.controlPoints[this.highlightedPointIdx].assignedVariables[s]=[]}this.controlPoints[this.highlightedPointIdx].label&&(this.controlPoints[this.highlightedPointIdx].label.remove(),this.controlPoints[this.highlightedPointIdx].label=null,this.controlPoints[this.highlightedPointIdx].labelRect.remove(),this.controlPoints[this.highlightedPointIdx].labelRect=null),""!==e&&(this.controlPoints[this.highlightedPointIdx].label=new tf.a.PointText({position:{x:this.controlPoints[this.highlightedPointIdx].position.x,y:this.controlPoints[this.highlightedPointIdx].position.y-10},fillColor:"#7b7971",justification:"center",fontSize:8}),e=e.slice(0,-2),this.controlPoints[this.highlightedPointIdx].label.content=e,this.controlPoints[this.highlightedPointIdx].labelRect=new tf.a.Path.Rectangle(this.controlPoints[this.highlightedPointIdx].label.bounds),this.controlPoints[this.highlightedPointIdx].labelRect.fillColor="white",this.controlPoints[this.highlightedPointIdx].labelRect.strokeColor="white",this.controlPoints[this.highlightedPointIdx].label.insertAbove(this.controlPoints[this.highlightedPointIdx].labelRect)),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}},{key:"setValueSlider",value:function(t,e,n){var i=$("#"+t),r=$("#"+t+"Min"),a=$("#"+t+"Max");t.slice("_")[1],i.slider({range:!0,disabled:!0,
//!$('#valueAssignmentCheckbox_' + key).prop('checked'),
min:0,max:100,values:[0,100],slide:function(i,o){var s=o.values[0]/100*(n-e)+e,l=o.values[1]/100*(n-e)+e;r.val(cd(s)),a.val(cd(l)),"sketchWidthSlider"===t&&(this.widthRange=[s,l]);var u=150*o.values[0]/100-8,c=142-150*o.values[1]/100;0===o.handleIndex?(r.css("display","initial"),r.css("left",u+"px")):1===o.handleIndex&&(a.css("display","initial"),a.css("right",c+"px"))}.bind(this),stop:function(){r.css("display","none"),a.css("display","none")}}),r.val(i.slider("values",0)),a.val(i.slider("values",1))}},{key:"controlPointPopover",value:function(){var t=0,e=[];for(var n in this.state.lookup){var i="";if((i=this.state.lookup[n].length>1?this.state.lookup[n].join(","):this.state.lookup[n][0]).indexOf("JD")<0){var a="slider_"+n;e.push(r.a.createElement("div",{id:"assignVariable_"+n,className:"row align-items-center",key:i},r.a.createElement("div",{className:"form-check col-4",style:{paddingLeft:"0px"},onChange:this.onClickValueAssignmentCheckbox.bind(this)},r.a.createElement("input",{type:"checkbox",id:"valueAssignmentCheckbox_"+n,name:"assignedVariableList",value:n}),r.a.createElement("label",{className:"form-check-label",key:i},i)),r.a.createElement("div",{className:"col",id:a,style:{width:"150px"}},r.a.createElement("output",{id:a+"Max",style:{bottom:"1.3rem",zIndex:100+t}}),r.a.createElement("output",{id:a+"Min",style:{bottom:"1.3rem",zIndex:150+t}})),r.a.createElement("div",{id:"widthValue_"+n,style:{display:"none"}}))),this.setValueSlider(a,Math.min.apply(null,this.state.minList[n]),Math.max.apply(null,this.state.maxList[n]))}t++}return r.a.createElement("div",{id:"controlPointPopover",className:"popover",style:{position:"absolute",opacity:"0.85",display:"none",padding:"0.5rem 0.8rem"}},r.a.createElement("div",{id:"controlPointPopoverArrow",className:"arrow"}),r.a.createElement("form",{className:"container",name:"assignVariablesForm",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},e),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"valueAssignmentDoneBtn",style:{float:"right"},onClick:this.onClickValueAssignmentDone.bind(this)},"Done"))}},{key:"render",value:function(){var t=this.axisSelectionPanel();return this.updateQueryFlag&&"feature"===mu.getMenu()&&this.convertSketchIntoQuery(this.state.xItem,this.state.yItem),r.a.createElement("div",{id:"QBSQuerying"},this.sketchMenu(),r.a.createElement("div",{id:"QBSCanvasArea"},t.x,t.y,this.controlPointPopover(),r.a.createElement("div",{className:"overlayHidingPanel"})),r.a.createElement("div",{id:"QBSSketchMenuArea"},this.sketchPadPreset(),this.importExportQueryMenu(),r.a.createElement("div",{style:{clear:"both"}}),this.sketchOptions()))}}])&&af(e.prototype,n),i&&af(e,i),o}(r.a.Component);function hf(t){return(hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function df(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ff(t,e){return(ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gf(t);if(e){var r=gf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mf(this,n)}}function mf(t,e){return!e||"object"!==hf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gf(t){return(gf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ff(t,e)}(o,t);var e,n,i,a=pf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.fileName=Gu.getFileName(e.id),e.thumbnail=t.thumbnail,e.result=t.result,e.rank=t.rank,e.activeVar=dh.getActive(),e.lookup=Gu.getData(e.id).data.lookup,e.variables=[],e.clickedX=null,e.clickedY=null,e.moved=!1,e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=document.getElementById("resultSummaryCanvas_"+this.rank).getContext("2d"),n=Math.min(this.thumbnail.height,this.thumbnail.width),i=this.thumbnail.width/2-n/2,r=this.thumbnail.height/2-n/2;this.thumbnail.onload=function(){e.drawImage(this.thumbnail,i,r,n,n,0,0,300,150)}.bind(this),document.getElementById("resultSummary_"+this.rank).addEventListener("mousedown",this.onMouseDownOnResultSummary.bind(this),!1),dh.on("focusResultFromTimeline",(function(e){var n=!1;if(void 0!==e.V&&t.result.flares){for(var i=0;i<t.result.flares.length;i++)if(Object(dc.isEqual)(t.result.flares[i],e)){n=!0;break}}else Object(dc.isEqual)(t.result,e)&&(n=!0);n&&se("#resultSummary_"+t.rank).transition().duration(300).style("border","1px solid #d23430").transition().duration(1e3).style("border","1px solid rgba(223, 215, 202, 0.75)")})),dh.on("selectResultFromTimeline",(function(e){var n=!1;if(void 0!==e.V&&t.result.flares){for(var i=0;i<t.result.flares.length;i++)if(Object(dc.isEqual)(t.result.flares[i],e)){n=!0;break}}else Object(dc.isEqual)(t.result,e)&&(n=!0);n&&(se("#resultSummary_"+t.rank).transition().duration(300).style("border","1px solid #d23430").transition().duration(1e3).style("border","1px solid rgba(223, 215, 202, 0.75)"),t.showDetails())}))}},{key:"showFileName",value:function(){return r.a.createElement("div",{style:{wordWrap:"anywhere"}},r.a.createElement("label",null,this.fileName))}},{key:"showThumbnail",value:function(){return r.a.createElement("canvas",{id:"resultSummaryCanvas_"+this.rank,className:"resultSummaryCanvas"})}},{key:"showPeriod",value:function(){return this.result.period?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col4"},r.a.createElement("label",null,"Period")),r.a.createElement("div",{className:"col"},Math.floor(this.result.start)," - ",Math.ceil(this.result.start+this.result.period))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col4"},r.a.createElement("label",null,"JD")),r.a.createElement("div",{className:"col"},Math.floor(this.result.start)))}},{key:"showDistance",value:function(){return isNaN(this.result.distance)?isNaN(this.result.V)?isNaN(this.result.angle)?void 0:r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col4"},r.a.createElement("label",null,"Angle")),r.a.createElement("div",{className:"col"},cd(this.result.angle))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col4"},r.a.createElement("label",null,"Intensity")),r.a.createElement("div",{className:"col"},cd(this.result.V))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col4"},r.a.createElement("label",null,"Distance")),r.a.createElement("div",{className:"col"},cd(this.result.distance)))}},{key:"showDetails",value:function(){"none"===$("#resultDetailArea").css("display")&&eh();var t=document.getElementById("detailThumbnailCanvas"),e=$("#extractionDetailThumbnail").width();$("#detailThumbnailCanvas").width(e),$("#detailThumbnailCanvas").height(e);var n=t.getContext("2d");n.clearRect(0,0,e,e);var i=Math.min(this.thumbnail.height,this.thumbnail.width),r=this.thumbnail.width/2-i/2,a=this.thumbnail.height/2-i/2;n.drawImage(this.thumbnail,r,a,i,i,0,0,300,150),$("#extractionDetailLC").height(e)}},{key:"onMouseDownOnResultSummary",value:function(t){this.moved=!1;var e=document.getElementById("resultSummaryHolder_"+this.rank);e.classList.add("drag");var n=document.getElementById("resultSummary_"+this.rank);this.clickedX=t.pageX-n.offsetLeft,this.clickedY=t.pageY-n.offsetTop,document.body.addEventListener("mousemove",this.onMouseMoveOnResultSummary.bind(this),!1),e.addEventListener("mouseup",this.onMouseUpFromResultSummary.bind(this),!1)}},{key:"onMouseMoveOnResultSummary",value:function(t){this.moved=!0;var e=document.getElementsByClassName("drag")[0];if(e)switch(e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX+"px",dh.getMode()){case"AE":break;case"QBE":var n=$("#selectedTimeSliceView"),i=n.offset(),r=n.width(),a=n.height();if(i.left<=t.pageX&&t.pageX<=i.left+r&&i.top<=t.pageY&&t.pageY<=i.top+a){var o=$("#selectedTimeSliceView > .overlayHidingPanel");o.css("display","block"),o.css("width",Math.min(r,a)),o.css("height",Math.min(r,a))}break;case"QBS":var s=$("#QBSSketchPad"),l=s.offset(),u=s.width(),c=s.innerHeight();if(l.left<=t.pageX&&t.pageX<=l.left+u&&l.top<=t.pageY&&t.pageY<=l.top+c){var h=$("#QBSCanvasArea > .overlayHidingPanel");h.css("display","block"),h.css("width",Math.min(u,c)),h.css("height",Math.min(u,c))}}}},{key:"onMouseUpFromResultSummary",value:function(t){document.body.removeEventListener("mousemove",this.onMouseMoveOnResultSummary.bind(this),!1);var e=document.getElementsByClassName("drag")[0];if(e&&(e.removeEventListener("mouseup",this.onMouseUpFromResultSummary.bind(this),!1),e.classList.remove("drag"),e.style.position="static"),this.moved){switch(dh.getMode()){case"AE":break;case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var n=$("#selectedTimeSliceView"),i=n.offset(),r=n.width(),a=n.height();i&&i.left<=t.pageX&&t.pageX<=i.left+r&&i.top<=t.pageY&&t.pageY<=i.top+a&&("none"===$("#QBESourceMain").css("display")&&(th(),au()),zc(this.result.id,[this.result.start,this.result.start+this.result.period],this.activeVar),"block"===$("#resultDetailArea").css("display")&&eh(),dh.getSource()!==this.result.id&&Pc(this.result.id));break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var o=$("#QBSSketchPad"),s=o.offset(),l=o.width(),u=o.innerHeight();s&&s.left<=t.pageX&&t.pageX<=s.left+l&&s.top<=t.pageY&&t.pageY<=s.top+u&&(zc(this.result.id,[this.result.start,this.result.start+this.result.period],this.activeVar),"block"===$("#resultDetailArea").css("display")&&eh())}this.moveToOriginalPos(),this.moved=!1}else{this.showDetails();var c=$("#extractionDetailLC").width();!function(t,e,n){iu.dispatch({type:"UPDATE_SELECTED_RESULT",result:t,width:e,height:n})}(this.result,c,200)}}},{key:"moveToOriginalPos",value:function(){var t=$("#resultSummaryHolder_"+(this.rank+1));t?t.before($("#resultSummaryHolder_"+this.rank)):$("#resultSummaryHolder_"+(this.rank-1)).after($("#resultSummaryHolder_"+this.rank))}},{key:"render",value:function(){return r.a.createElement("div",{className:"resultSummary",id:"resultSummary_"+this.rank},this.showFileName(),this.showThumbnail(),r.a.createElement("div",{className:"container",style:{paddingLeft:"0px",paddingRight:"0px"}},this.showPeriod(),this.showDistance()))}}])&&df(e.prototype,n),i&&df(e,i),o}(r.a.Component);function yf(t){return(yf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bf(t,e){var n,i;switch(t){case"minmax":if(Array.isArray(e)){n=[];var r=Math.min.apply(null,e),a=Math.max.apply(null,e);if(a-r!=0)for(var o=0;o<e.length;o++)n.push((e[o]-r)/(a-r));else for(var s=0;s<e.length;s++)n.push(0)}else if("object"===yf(e))for(var l in n={},e)if(Array.isArray(e[l])&&e[l].indexOf(null)<0)if("theta"!==l){var u=Math.min.apply(null,e[l]),c=Math.max.apply(null,e[l]);if(n[l]=[],c-u!=0)for(var h=0;h<e[l].length;h++)n[l].push((e[l][h]-u)/(c-u));else for(var d=0;d<e[l].length;d++)n[l].push(0)}else n[l]=xf(t,e[l]);else n[l]=e[l];break;case"centralize":if(Array.isArray(e)){n=[],i=P(e);for(var p=0;p<e.length;p++)n.push(e[p]-i)}else for(var m in n={},e)if(Array.isArray(e[m])&&e[m].indexOf(null)<0)if("theta"!==m){i=P(e[m]),n[m]=[];for(var g=0;g<e[m].length;g++)n[m].push(e[m][g]-i)}else n[m]=xf(t,e[m]);else n[m]=e[m];break;case"zScore":if(Array.isArray(e)){n=[],i=P(e);for(var v=f(e),y=0;y<e.length;y++)n.push((e[y]-i)/v)}else if("object"===yf(e))for(var b in n={},e)if(Array.isArray(e[b])&&e[b].indexOf(null)<0)if("theta"!==b){i=P(e[b]);var x=f(e[b]);n[b]=[];for(var _=0;_<e[b].length;_++)n[b].push((e[b][_]-i)/x)}else n[b]=xf(t,e[b]);else n[b]=e[b]}return n}function xf(t,e){for(var n,i=[],r=[],a=(e[0],Nf(e[0])),o=0,s=0;s<e.length;s++){var l=Nf(e[s]);1===a&&4===l?o-=360:4==a&&1===l&&(o+=360),r.push(e[s]+o),e[s]+o,a=l}switch(t){case"minmax":for(var u=Math.min.apply(null,r),c=Math.max.apply(null,r),h=0;h<r.length;h++)i.push((r[h]-u)/(c-u));break;case"centralize":n=P(r);for(var d=0;d<r.length;d++)i.push(r[d]-n);break;case"zScore":n=P(r);for(var p=f(r),m=0;m<r.length;m++)i.push((r[m]-n)/p)}return i}function _f(t,e,n){for(var i=[],r=0;r<=t.length;r++){i[r]=[];for(var a=0;a<=e.length;a++)i[r][a]=1/0}i[0][0]=0;for(var o=1;o<=t.length;o++)for(var s=1;s<=e.length;s++)i[o][s]=n(t[o-1],e[s-1])+Math.min(i[o-1][s],i[o][s-1],i[o-1][s-1]);for(var l=[],u=1;u<i.length;u++)l.push(i[u].slice(1,i[u].length));return l}function wf(t,e,n,i){for(var r=[],a=0;a<=t.arrayLength;a++){r[a]=[];for(var o=0;o<=e.arrayLength;o++)r[a][o]=1/0}r[0][0]=0;for(var s=function(a){var o=[];n.forEach((function(e){o.push(t[e][a-1])}));for(var s=function(t){var s=[];n.forEach((function(n){s.push(e[n][t-1])})),r[a][t]=i(o,s)+Math.min(r[a-1][t],r[a][t-1],r[a-1][t-1])},l=1;l<=e.arrayLength;l++)s(l)},l=1;l<=t.arrayLength;l++)s(l);for(var u=[],c=1;c<r.length;c++)u.push(r[c].slice(1,r[c].length));return u}function Sf(t,e,n,i){var r=[];n=Math.max(n,Math.abs(t.length-e.length));for(var a=0;a<=t.length;a++){r[a]=[];for(var o=0;o<=e.length;o++)r[a][o]=1/0}r[0][0]=0;for(var s=1;s<=t.length;s++)for(var l=Math.max(1,s-n),u=Math.min(e.length,s+n),c=l;c<=u;c++)r[s][c]=0;for(var h=1;h<=t.length;h++)for(var d=Math.max(1,h-n),f=Math.min(e.length,h+n),p=d;p<=f;p++)r[h][p]=i(t[h-1],e[p-1])+Math.min(r[h-1][p],r[h][p-1],r[h-1][p-1]);for(var m=[],g=1;g<r.length;g++)m.push(r[g].slice(1,r[g].length));return m}function Ef(t,e,n,i,r){var a=[];n=Math.max(n,Math.abs(t.arrayLength-e.arrayLength));for(var o=0;o<=t.arrayLength;o++){a[o]=[];for(var s=0;s<=e.arrayLength;s++)a[o][s]=1/0}a[0][0]=0;for(var l=1;l<=t.arrayLength;l++)for(var u=Math.max(1,l-n),c=Math.min(e.arrayLength,l+n),h=u;h<=c;h++)a[l][h]=0;for(var d=function(o){var s=Math.max(1,o-n),l=Math.min(e.arrayLength,o+n),u=[];i.forEach((function(e){u.push(t[e][o-1])}));for(var c=function(t){var n=[];i.forEach((function(i){n.push(e[i][t-1])})),a[o][t]=r(u,n)+Math.min(a[o-1][t],a[o][t-1],a[o-1][t-1])},h=s;h<=l;h++)c(h)},f=1;f<=t.arrayLength;f++)d(f);for(var p=[],m=1;m<a.length;m++)p.push(a[m].slice(1,a[m].length));return p}function Mf(t){if(Array.isArray(t)){var e,n=t.length-1,i=t[0].length-1;for(e=[[n,i]];n>0||i>0;)n>0?i>0?t[n-1][i]<t[n-1][i-1]?t[n-1][i]<t[n][i-1]?(e.push([n-1,i]),n--):(e.push([n,i-1]),i--):t[n-1][i-1]<t[n][i-1]?(e.push([n-1,i-1]),n--,i--):(e.push([n,i-1]),i--):(e.push([n-1,i]),n--):(e.push([n,i-1]),i--);return e}var r={};for(var a in t){var o=void 0,s=t[a].length-1,l=t[a][0].length-1;for(o=[[s,l]];s>0||l>0;)s>0?l>0?t[a][s-1][l]<t[a][s-1][l-1]?t[a][s-1][l]<t[a][s][l-1]?(o.push([s-1,l]),s--):(o.push([s,l-1]),l--):t[a][s-1][l-1]<t[a][s][l-1]?(o.push([s-1,l-1]),s--,l--):(o.push([s,l-1]),l--):(o.push([s-1,l]),s--):(o.push([s,l-1]),l--);r[a]=o}return r}function Cf(t,e){if(Array.isArray(t)){for(var n=0,i=0;i<t.length;i++)n+=Math.pow(t[i]-e[i],2);return Math.sqrt(n)}return Math.abs(t-e)}function Tf(t){var e;switch(t){case"distance":e=function(t,e){return t.distance-e.distance};break;case"timeStamp":e=function(t,e){var n=t.start-e.start;return 0===n&&(n=t.id-e.id),n};break;case"data":e=function(t,e){var n=t.id-e.id;return 0===n&&(n=t.distance-e.distance),n};break;case"significance":e=function(t,e){return t.significance-e.significance};break;case"intensity":e=function(t,e){return t.intensity-e.intensity};break;case"angle":e=function(t,e){return t.angle-e.angle};break;case"diameter":e=function(t,e){return t.diameter-e.diameter};break;case"period":e=function(t,e){return t.period-e.period};break;case"anomalyDegree":e=function(t,e){return e.anomalyDegree-t.anomalyDegree};break;case"fileName":e=function(t,e){return e=(t=t.toString().toLowerCase()).toString().toLowerCase(),t<e?-1:t>e?1:0}}return e}function kf(){var t=dh.getMode(),e=document.getElementById("resultOrderList").options,n=0;if("AE"===t){for(n=0;n<e.length;n++)if("timeStamp"===e[n].value){document.getElementById("resultOrderList").selectedIndex=n;break}}else if("QBE"===t||"QBS"===t)for(n=0;n<e.length;n++)if("distance"===e[n].value){document.getElementById("resultOrderList").selectedIndex=n;break}jc(e[n].value)}function Pf(){"none"!==$("#QBESourceMain").css("display")&&th();var t=dh.getOrder(),e=dh.getKValue(),n=dh.getDistanceThreshold(),i=dh.getExtractionResults();if($("#topKResults").prop("disabled"))i.sort(Tf(t));else{var a=dh.getMode();"QBE"===a||"QBS"===a?i.sort(Tf("distance")):"AE"===a&&dh.getAEOptionStatus("anomaly")&&i.sort(Tf("anomalyDegree")),""!==e&&(i=i.slice(0,e)),i.sort(Tf(t))}""!==n&&(i=i.filter((function(t){return t.distance<n}))),function(t){iu.dispatch({type:"UPDATE_SHOWN_RESULTS",results:t})}(i);for(var s=dh.getTarget(),l={},u={},c={},h={},d=0;d<s.length;d++)l[String(s[d])]=tc.getCameraProp(s[d]),u[String(s[d])]=tc.getFocused(s[d]),c[String(s[d])]=Gu.getData(s[d]).data.meta.min.z,h[String(s[d])]=document.getElementById("TimeTubes_viewport_"+s[d]),Eu(s[d]);for(var f,p,m,g=document.getElementById("resultsArea");g.firstChild;)o.a.unmountComponentAtNode(g.firstChild),g.removeChild(g.firstChild);for(var v=0;v<i.length;v++){var y=document.createElement("div");y.id="resultSummaryHolder_"+v,g.appendChild(y);var b=i[v];Ou(b.id,b.start-c[String(b.id)],b.period);var x=h[String(b.id)].height,_=h[String(b.id)].width,w=new Image;w.src=h[String(b.id)].toDataURL(),w.height=x,w.width=_,o.a.render(r.a.createElement(vf,{key:v,id:b.id,thumbnail:w,result:b,period:[b.start,b.start+b.period],distance:b.distance,path:b.path,rank:v}),y)}for(var S=0;S<s.length;S++)f=s[S],p=l[String(s[S])],m=u[String(s[S])],iu.dispatch({type:"RECOVER_TUBE",id:f,cameraProp:p,tubePos:m});i.length>0?$("#matchingStatus").text(i.length+" results are found"):$("#matchingStatus").text("No results are found")}function Af(t,e,n){for(var i=Gu.getData(t).data.splines.value.points,r=i[e].y,a=i.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=0;o<a.length;o++)a[o]=r-a[o];for(var s=i.slice(e+1,e+n<i.length?e+n+1:i.length-1).map((function(t){return t.y})),l=0;l<s.length;l++)s[l]=r-s[l];var u=k(a),c=k(s);return u?c?(u+c)/2:u:c}function Of(t,e,n){for(var i=Gu.getData(t).data.splines.value.points,r=i[e].y,a=i.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=0;o<a.length;o++)a[o]=r-a[o];for(var s=i.slice(e+1,e+n<i.length?e+n+1:i.length-1).map((function(t){return t.y})),l=0;l<s.length;l++)s[l]=r-s[l];var u=P(a),c=P(s);return u?c?(u+c)/2:u:c}function Lf(t,e,n){var i=Gu.getData(t).data.splines.value.points,r=i[e].y,a=i.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=i.slice(e+1,e+n<i.length?e+n+1:i.length-1).map((function(t){return t.y})),s=r-P(a),l=r-P(o);return s?l?(s+l)/2:s:l}function Rf(t,e){var n=Math.atan2(t.y-e.y,t.x-e.x);return n>=0?180*n/Math.PI:180*(2*Math.PI+n)/Math.PI}function If(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Nf(t){return t>=0&&t<90?1:t>=90&&t<180?2:t>=180&&t<270?3:4}function Df(t){return t>=0?180*t/Math.PI:180*(2*Math.PI+t)/Math.PI}function zf(t){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ff(t,e){return(Ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Uf(t);if(e){var r=Uf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return jf(this,n)}}function jf(t,e){return!e||"object"!==zf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Uf(t){return(Uf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ff(t,e)}(o,t);var e,n,i,a=Vf(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={dragSelection:!0,queryMode:dh.getMode(),selector:!0,source:-1,selectedInterval:[-1,-1],coordinate:"rectangular",DTWMode:"DTWD"},t.clusterCenter={},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#stepSizeOfSlidingWindow").val(5),mu.on("showExtractionSourcePanel",(function(e){t.setState({queryMode:"QBE"})})),dh.on("updateSource",(function(){t.clusterCenter={},t.setState({source:dh.getSource()})})),dh.on("switchQueryMode",(function(e){t.setState({queryMode:e}),"block"===$("#resultDetailArea").css("display")&&eh(),"QBS"===e&&t.setState({DTWMode:"DTWD"}),""===$("#stepSizeOfSlidingWindow").val()&&$("#stepSizeOfSlidingWindow").val(5),"QBE"!==e&&(document.getElementById("sourceList").selectedIndex=0,"block"===$("#QBESourceMain").css("display")&&th())})),dh.on("updateSelectedPeriod",(function(){var e=dh.getSelectedPeriod();e[1]-e[0]>0&&(t.clusterCenter={},t.setState({selectedInterval:e}),t.cancelDisablementOfNormalizationOption(),t.updateSelectedInterval())})),dh.on("selectTimeInterval",(function(e,n){Number(t.state.source)===e&&(t.clusterCenter={},t.setState({selectedInterval:dh.getSelectedPeriod()}),t.cancelDisablementOfNormalizationOption(),t.updateSelectedInterval())})),dh.on("convertResultIntoQuery",(function(e,n,i){t.clusterCenter={},t.setState({source:e,selectedInterval:n}),t.cancelDisablementOfNormalizationOption()})),dh.on("recoverQuery",(function(e){var n=dh.getMode();if("AE"!==n){if(t.clusterCenter={},"QBE"===n){var i=dh.getSelectedPeriod();t.setState({source:dh.getSource(),selectedInterval:i,coordinate:e.parameters.coordinate,DTWMode:e.parameters.DTWType,queryMode:n}),"none"===$("#QBESourceMain").css("display")&&th()}else"QBS"===n&&t.setState({coordinate:e.parameters.coordinate,DTWMode:e.parameters.DTWType,queryMode:n});var r=dh.getParameters();t.cancelDisablementOfNormalizationOption(),$("#NormalizeSwitch").prop("checked",r.normalize);var a=document.getElementById("normalizationOptions");if(r.normalizationOption){for(var o=0;o<a.options.length;o++)if(a.options[o].value===r.normalizationOption){a.selectedIndex=o;break}}else a.selectedIndex=0;for(var s=document.getElementById("distanceMetric"),l=0;l<s.options.length;l++)if(s.options[l].value===r.distanceMetric){s.selectedIndex=l;break}var u=document.getElementById("distanceNormalization");if(r.distanceNormalization){for(var c=0;c<u.options.length;c++)if(u.options[c].value===r.distanceNormalization){u.selectedIndex=c;break}}else u.selectedIndex=0;$("#warpingWindowSize").val(r.warpingWindowSize),$("#targetLengthMin").val(r.timeSliceLength[0]),$("#targetLengthMax").val(r.timeSliceLength[1]),$("#stepSizeOfSlidingWindow").val(r.slidingWindow)}else t.setState({queryMode:n})})),dh.on("changeDTWMode",(function(e){t.setState({DTWMode:e})})),dh.on("convertClusterCenterIntoQuery",(function(e){t.clusterCenter=e,t.setState({source:-1})}))}},{key:"switchSelector",value:function(){this.setState({selector:!this.state.selector}),Ac()}},{key:"switchDragSelection",value:function(){this.setState({dragSelection:!this.state.dragSelection}),iu.dispatch({type:"SWITCH_DRAGSELECTION"})}},{key:"switchQueryMode",value:function(t){Ic($("input[name=queryMode]:checked").val())}},{key:"switchDTWMode",value:function(){var t=$("input[name=DTWType]:checked").val();this.setState({DTWMode:t})}},{key:"switchCoordinate",value:function(){var t=$("input[name=coordinate]:checked").val();this.setState({coordinate:t})}},{key:"resetSelection",value:function(){Oc()}},{key:"selectTimeInterval",value:function(){var t=$("#selectTimeIntervalInput").val();isNaN(t)||""==t||Lc(this.state.source)}},{key:"updateSelectedInterval",value:function(){$("#selectedInterval").text("JD: "+this.state.selectedInterval[0].toFixed(3)+" - "+this.state.selectedInterval[1].toFixed(3)),$("#targetLengthMin").val(Math.floor(this.state.selectedInterval[1])-Math.ceil(this.state.selectedInterval[0])),$("#targetLengthMax").val(Math.floor(this.state.selectedInterval[1])-Math.ceil(this.state.selectedInterval[0]))}},{key:"updateActiveVariables",value:function(){Nc(nh())}},{key:"queryModes",value:function(){return r.a.createElement("div",{className:"featureElem"},r.a.createElement("h5",null,"Query mode"),r.a.createElement("form",{className:"form-check form-check-inline",id:"queryMode",onChange:this.switchQueryMode.bind(this)},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"QBE",name:"queryMode",className:"custom-control-input",value:"QBE",checked:"QBE"===this.state.queryMode,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"QBE"},"Query-by-example")),r.a.createElement("div",{className:"custom-control custom-radio",style:{marginLeft:"0.5rem"}},r.a.createElement("input",{type:"radio",id:"QBS",name:"queryMode",className:"custom-control-input",value:"QBS",checked:"QBS"===this.state.queryMode,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"QBS"},"Query-by-sketch"))))}},{key:"QBESelection",value:function(){return r.a.createElement("div",{className:"featureElem",id:"QBEArea",style:{display:"QBE"===this.state.queryMode?"block":"none"}},r.a.createElement(Jd,null))}},{key:"QBSSelection",value:function(){var t=[];return Gu.getAllData().forEach((function(e){t.push(e.data.lookup)})),r.a.createElement("div",{className:"featureElem",id:"QBSArea",style:{display:"QBS"===this.state.queryMode?"block":"none"}},r.a.createElement(cf,{xItem:"x",yItem:"y"}))}},{key:"selectionDetail",value:function(){var t,e;if("QBE"===this.state.queryMode&&(t=r.a.createElement(Wd,{sourceId:this.state.source})),"QBE"===this.state.queryMode){var n="";this.state.selectedInterval[0]>0&&this.state.selectedInterval[1]>0&&(n="JD: "+this.state.selectedInterval[0].toFixed(3)+" - "+this.state.selectedInterval[1].toFixed(3)),e=r.a.createElement("div",{className:"featureElem",style:{position:"relative"}},r.a.createElement("h5",null,"Selection Detail"),r.a.createElement("span",{id:"selectedInterval"},n),r.a.createElement("div",{id:"selectedIntervalViewArea"},t))}return e}},{key:"matchingControllers",value:function(){var t=[];if(this.state.source>=0){var e=Gu.getData(Number(this.state.source)).data.lookup,n=dh.getActive();if(0===n.length)for(var i in e){var a="";"z"!==i&&"PA"!==i&&"PD"!==i&&(a=e[i].length>1?e[i].join(","):e[i],t.push(r.a.createElement("div",{className:"form-check form-check-inline",key:i},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:i,id:"QBEActive_"+i}),r.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+i},a))))}else if(n.length>0)for(var o in e){var s="";if(s=e[o].length>1?e[o].join(","):e[o],"z"!==o&&"PA"!==o&&"PD"!==o){var l=n.indexOf(o)>=0;t.push(r.a.createElement("div",{className:"form-check form-check-inline",key:o},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:o,defaultChecked:l,id:"QBEActive_"+o}),r.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+o},s)))}}}else if(this.state.source<0&&Object.keys(this.clusterCenter).length>0){for(var u={},c=dh.getTarget(),h=dh.getActive(),d=this.clusterCenter.parameters.variables,f=0;f<c.length;f++)for(var p=Gu.getData(c[f]).data.lookup,m=0;m<d.length;m++)if(u[d[m]])for(var g=0;g<p[d[m]].length;g++)u[d[m]].push(p[d[m]][g]);else{u[d[m]]=[];for(var v=0;v<p[d[m]].length;v++)u[d[m]].push(p[d[m]][v])}for(var y in u){var b="";if(b=u[y].length>1?u[y].join(","):u[y],"z"!==y&&"PA"!==y&&"PD"!==y){var x=h.indexOf(y)>=0;t.push(r.a.createElement("div",{className:"form-check form-check-inline",key:y},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:y,defaultChecked:x,id:"QBEActive_"+y}),r.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+y},b)))}}}return r.a.createElement("div",{className:"featureElem",style:{position:"relative"}},r.a.createElement("h5",{onClick:this.collapseMatchingOptions},"Matching"),r.a.createElement("div",{id:"matchingOptionsMain"},r.a.createElement("div",{id:"activeVariablesArea",style:{display:"QBE"===this.state.queryMode?"block":"none"}},r.a.createElement("h6",null,"Active variables"),r.a.createElement("form",{id:"QBEActiveVariables",onChange:this.updateActiveVariables.bind(this)},t)),r.a.createElement("h6",null,"Computation"),r.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},r.a.createElement("div",{className:"row matchingOption",style:{paddingLeft:"15px",paddingRight:"15px"}},r.a.createElement("div",{className:"col-5",style:{paddingLeft:"0"}},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"NormalizeSwitch"}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"NormalizeSwitch"},"Normalize"))),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"normalizationOptions",style:{width:"60%"}},r.a.createElement("option",{value:"minmax"},"Min-max"),r.a.createElement("option",{value:"centralize"},"Centralize"),r.a.createElement("option",{value:"zScore"},"z-score")))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col"},r.a.createElement("form",{className:"form-check form-inline",id:"coordinate",onChange:this.switchCoordinate.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"rectangularCoordinate",name:"coordinate",value:"rectangular",checked:"rectangular"===this.state.coordinate,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"rectangularCoordinate"},"Rectangular coordinate")),r.a.createElement("div",{className:"custom-control custom-radio",style:{marginLeft:"1.5rem"}},r.a.createElement("input",{type:"radio",id:"polarCoordinate",name:"coordinate",value:"polar",checked:"polar"===this.state.coordinate,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"polarCoordinate"},"Polar coordinate")))))),r.a.createElement("h6",null,"Settings of DTW"),r.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Distance metric"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"distanceMetric",style:{width:"60%"}},r.a.createElement("option",{value:"Euclidean"},"Euclidean")))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Distance normalization"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"distanceNormalization",style:{width:"60%"}},r.a.createElement("option",{value:"none"},"None"),r.a.createElement("option",{value:"warpingPathLength"},"Warping path length"),r.a.createElement("option",{value:"minLength"},"Minimum length"),r.a.createElement("option",{value:"maxLength"},"Maximum length"),r.a.createElement("option",{value:"timeNormalization"},"Time normalization"),r.a.createElement("option",{value:"pathLengthRatio"},"Warping path ratio")))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Warping window size"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"window size",id:"warpingWindowSize",style:{width:"40%",marginRight:"0.5rem"}}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Length of the target time series"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"targetLengthMin",style:{width:"20%",marginRight:"0.5rem"},required:!0}),"~",r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"targetLengthMax",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},required:!0}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Step size of sliding window"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"step size",id:"stepSizeOfSlidingWindow",style:{width:"40%",marginRight:"0.5rem"},required:!0}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Type of DTW"),r.a.createElement("div",{className:"col"},r.a.createElement("form",{className:"form-check",id:"DTWType",onChange:this.switchDTWMode.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"DTWI",name:"DTWType",value:"DTWI",checked:"DTWI"===this.state.DTWMode,disabled:"QBS"===this.state.queryMode,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWI"},"DTW",r.a.createElement("sub",null,"I"))),r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"DTWD",name:"DTWType",value:"DTWD",checked:"DTWD"===this.state.DTWMode,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWD"},"DTW",r.a.createElement("sub",null,"D"))))))),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runMatchingBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run")))}},{key:"cancelDisablementOfNormalizationOption",value:function(){$("#NormalizeSwitch").prop("disabled",!1),$("#normalizationOptions").prop("disabled",!1)}},{key:"collapseMatchingOptions",value:function(){$("#matchingOptionsMain").slideToggle()}},{key:"clickRunButton",value:function(){$("#topKLabelResults").text("Top "+dh.getKValue()+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){this.runMatching()}.bind(this),0)}},{key:"runMatching",value:function(){var t=$("#NormalizeSwitch").prop("checked"),e=document.getElementById("normalizationOptions"),n=e.selectedIndex,i=e.options[n].value,r=document.getElementById("distanceMetric"),a=r.selectedIndex,o=r.options[a].value,s=document.getElementById("distanceNormalization"),l=s.selectedIndex,u=s.options[l].value,c=$("#warpingWindowSize").val();c=""===c?0:Number(c);var h=$("#targetLengthMin").val(),d=$("#targetLengthMax").val();h=""===h?0:Number(h),d=""===d?0:Number(d);var f=$("#stepSizeOfSlidingWindow").val();f=""===f?1:Number(f);var p=$("input[name=DTWType]:checked").val(),m=dh.getTarget();switch(this.state.queryMode){case"QBE":var g=Number(this.state.source);if(m.length>0)if(0===Object.keys(this.clusterCenter).length){var v,y=dh.getSelectedPeriod(),b=nh();if(v={normalize:t,normalizationOption:i,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p},NaN!==g){var x=function(t,e,n,i){var r=[Math.floor(e[0]),Math.ceil(e[1])],a=Gu.getData(t).data.meta.min.z,o=(Gu.getData(t).data.lookup,{}),s=[];if(s=n,"rectangular"===i){for(var l=0;l<s.length;l++)o[s[l]]=[];for(var u=r[0];u<=r[1];u++){var c=Gu.getValues(t,u-a);for(var h in o)"z"!==h?o[h].push(c[h]):"z"===h&&o[h].push(u)}o.minJD=r[0],o.arrayLength=r[1]-r[0]+1}else if("polar"===i){if(s.indexOf("x")<0||s.indexOf("y")<0)return alert("To use the polar coordinate for computing similarities, you cannot ignore the Stokes parameters (Q/I and U/I)."),!1;for(var d=0;d<s.length;d++)o[s[d]]=[];o.r=[],o.theta=[];for(var f=r[0];f<=r[1];f++){var p=Gu.getValues(t,f-a),m=Math.sqrt(Math.pow(p.x,2)+Math.pow(p.y,2)),g=Df(Math.atan2(p.y,p.x));for(var v in o)"r"===v?o[v].push(m):"theta"===v?o[v].push(g):"z"!==v?o[v].push(p[v]):"z"===v&&o[v].push(f)}o.minJD=r[0],o.arrayLength=r[1]-r[0]+1}return{mode:"visual query",option:"query-by-example",query:{source:Gu.getData(Number(dh.getSource())).name,period:r,activeVariables:n},values:o}}(g,y,b,this.state.coordinate);x&&(Dc(v,function(t,e,n){for(var i=[],r=e[1]-e[0],a=0;a<n.length;a++)if(t===n[a].id){var o=0;e[0]<=n[a].start&&n[a].start<=e[1]?o=e[1]-n[a].start:e[0]<=n[a].start+n[a].period&&n[a].start+n[a].period<=e[1]?o=n[a].start+n[a].period-e[0]:n[a].start<=e[0]&&e[1]<=n[a].start+n[a].period?o=r:e[0]<=n[a].start&&n[a].start+n[a].period<=e[1]&&(o=n[a].period),o/r<.3&&i.push(n[a])}else i.push(n[a]);return i}(g,y,function(t,e,n){var i,r=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":i=Cf}a&&(t=bf(o,t));for(var f=function(n){var s=e[n],f=Gu.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Df(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0],x=[];if(t.r)for(var _ in t)"x"!==_&&"y"!==_&&Array.isArray(t[_])&&"z"!==_&&x.push(_);else for(var w in t)Array.isArray(t[w])&&"z"!==w&&x.push(w);switch(r){case"DTWI":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],r=function(r){if(e+r>f.arrayLength-1)return"break";var s=0,u={};x.forEach((function(n){if(Array.isArray(f[n])&&"z"!==n){var c=f[n].slice(e,e+r);a&&(c="theta"!==n?bf(o,c):xf(o,c));var d=Sf(t[n],c,l,i);switch(u[n]=Mf(d),h){case"none":s+=d[t[n].length-1][c.length-1];break;case"warpingPathLength":s+=d[t[n].length-1][c.length-1]/u[n].length;break;case"minLength":s+=d[t[n].length-1][c.length-1]/Math.min(t.arrayLength,r);break;case"maxLength":s+=d[t[n].length-1][c.length-1]/Math.max(t.arrayLength,r);break;case"timeNormalization":for(var p=0,m=0,g=0,v=0;v<u[n].length-1;v++)p+=(g=u[n][v][0]-u[n][v+1][0]+(u[n][v][1]-u[n][v+1][1]))*(d[u[n][v][1]][u[n][v][0]]-d[u[n][v+1][1]][u[n][v+1][0]]),m+=g;p+=(g=1)*d[0][0],s+=p/=m+=g;break;case"pathLengthRatio":s+=d[t[n].length-1][c.length-1]/(u[n].length/(t.arrayLength+r))}}})),n.push({dist:s,path:u})},p=c[0];p<=c[1]&&"break"!==r(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++)n[v].dist<g.dist&&(g=n[v],m=v);g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},r=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(s){if(Array.isArray(f[s])&&"z"!==s){var l=f[s].slice(e,e+r);a&&(l="theta"!==s?bf(o,l):xf(o,l));var u=_f(t[s],l,i);n[s]=u}}));for(var l=r-c[0]+1,p=[],m=1;m<=l;m++){var g=0,v={};for(var y in n){for(var _=n[y][0].length-l+m,w=[],S=0;S<n[y].length;S++)w.push(n[y][S].slice(0,_));switch(v[y]=Mf(w),h){case"none":g+=w[t.arrayLength-1][_-1];break;case"warpingPathLength":g+=w[t.arrayLength-1][_-1]/v[y].length;break;case"minLength":g+=w[t.arrayLength-1][_-1]/Math.min(t.arrayLength,_);break;case"maxLength":g+=w[t.arrayLength-1][_-1]/Math.max(t.arrayLength,_);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<v[y].length-1;T++)E+=(C=v[y][T][0]-v[y][T+1][0]+(v[y][T][1]-v[y][T+1][1]))*(w[v[y][T][1]][v[y][T][0]]-w[v[y][T+1][1]][v[y][T+1][0]]),M+=C;E+=(C=1)*w[0][0],g+=E/=M+=C;break;case"pathLengthRatio":g+=w[t.arrayLength-1][_-1]/(v[y].length/(t.arrayLength+_))}}p.push({dist:g,paths:v})}for(var k=0,P={dist:1/0},A=0;A<p.length;A++)p[A].dist<P.dist&&(P=p[A],k=A);P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.paths}),e+=u};e<f.arrayLength-c[0];)n()}();break;case"DTWD":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],r=function(r){if(e+r>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+r)})),s.arrayLength=r,a&&(s=bf(o,s)),n.push(Ef(t,s,l,x,i))},p=c[0];p<=c[1]&&"break"!==r(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Mf(n[v]),_=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":_/=y.length;break;case"minLength":_/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":_/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var w=0,S=0,E=0,M=0;M<y.length-1;M++)w+=(E=y[M][0]-y[M+1][0]+(y[M][1]-y[M+1][1]))*(n[v][y[M][1]][y[M][0]]-n[v][y[M+1][1]][y[M+1][0]]),S+=E;w+=(E=1)*n[v][0][0],_=w/=S+=E;break;case"pathLengthRatio":_/=y.length/(t.arrayLength+target.arrayLength)}_<g.dist&&(g={dist:_,path:y},m=v)}g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},r=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e-1;x.forEach((function(t){n[t]=f[t].slice(e,e+r)})),n.arrayLength=r,a&&(n=bf(o,n));for(var l=wf(t,n,x,i),p=r-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var _=Mf(v),w=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":w/=_.length;break;case"minLength":w/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":w/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<_.length-1;C++)S+=(M=_[C][0]-_[C+1][0]+(_[C][1]-_[C+1][1]))*(v[_[C][1]][_[C][0]]-v[_[C+1][1]][_[C+1][0]]),E+=M;S+=(M=1)*v[0][0],M+=M,w=S/=E;break;case"pathLengthRatio":w/=_.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:w,path:_})}for(var T=0,k={dist:1/0},P=1;P<m.length;P++)m[P].dist<k.dist&&(k=m[P],T=P);k.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+T,distance:k.dist,path:k.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(x.values,m,v)),x,b),kf())}Pf()}else Promise.resolve().then((function(){var t;t="featureExtraction",iu.dispatch({type:"SHOW_RESULTS_PANEL",resultsPanel:t})})).then(function(){var e;e={normalize:t,normalizationOption:i,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p};for(var n=nh(),r={},a=0;a<n.length;a++)r[n[a]]=this.clusterCenter.values[n[a]];r.arrayLength=this.clusterCenter.values.arrayLength;var s={mode:"visual query",option:"query-by-example",query:{source:"clustering",activeVariables:n},values:r};Dc(e,function(t,e,n){var i,r=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":i=Cf}for(var f=function(n){var s=e[n],f=Gu.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Df(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0],x=[];if(t.r)for(var _ in t)"x"!==_&&"y"!==_&&Array.isArray(t[_])&&"z"!==_&&x.push(_);else for(var w in t)Array.isArray(t[w])&&"z"!==w&&x.push(w);switch(r){case"DTWI":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],r=function(r){if(e+r>f.arrayLength-1)return"break";var s=0,u={};x.forEach((function(n){if(Array.isArray(f[n])&&"z"!==n){var c=f[n].slice(e,e+r);a&&(c="theta"!==n?bf(o,c):xf(o,c));var d=Sf(t[n],c,l,i);switch(u[n]=Mf(d),h){case"none":s+=d[t[n].length-1][c.length-1];break;case"warpingPathLength":s+=d[t[n].length-1][c.length-1]/u[n].length;break;case"minLength":s+=d[t[n].length-1][c.length-1]/Math.min(t.arrayLength,r);break;case"maxLength":s+=d[t[n].length-1][c.length-1]/Math.max(t.arrayLength,r);break;case"timeNormalization":for(var p=0,m=0,g=0,v=0;v<u[n].length-1;v++)p+=(g=u[n][v][0]-u[n][v+1][0]+(u[n][v][1]-u[n][v+1][1]))*(d[u[n][v][1]][u[n][v][0]]-d[u[n][v+1][1]][u[n][v+1][0]]),m+=g;p+=(g=1)*d[0][0],s+=p/=m+=g;break;case"pathLengthRatio":s+=d[t[n].length-1][c.length-1]/(u[n].length/(t.arrayLength+r))}}})),n.push({dist:s,path:u})},p=c[0];p<=c[1]&&"break"!==r(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++)n[v].dist<g.dist&&(g=n[v],m=v);g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},r=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(s){if(Array.isArray(f[s])&&"z"!==s){var l=f[s].slice(e,e+r);a&&(l="theta"!==s?bf(o,l):xf(o,l));var u=_f(t[s],l,i);n[s]=u}}));for(var l=r-c[0]+1,p=[],m=1;m<=l;m++){var g=0,v={};for(var y in n){for(var _=n[y][0].length-l+m,w=[],S=0;S<n[y].length;S++)w.push(n[y][S].slice(0,_));switch(v[y]=Mf(w),h){case"none":g+=w[t.arrayLength-1][_-1];break;case"warpingPathLength":g+=w[t.arrayLength-1][_-1]/v[y].length;break;case"minLength":g+=w[t.arrayLength-1][_-1]/Math.min(t.arrayLength,_);break;case"maxLength":g+=w[t.arrayLength-1][_-1]/Math.max(t.arrayLength,_);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<v[y].length-1;T++)E+=(C=v[y][T][0]-v[y][T+1][0]+(v[y][T][1]-v[y][T+1][1]))*(w[v[y][T][1]][v[y][T][0]]-w[v[y][T+1][1]][v[y][T+1][0]]),M+=C;E+=(C=1)*w[0][0],g+=E/=M+=C;break;case"pathLengthRatio":g+=w[t.arrayLength-1][_-1]/(v[y].length/(t.arrayLength+_))}}p.push({dist:g,paths:v})}for(var k=0,P={dist:1/0},A=0;A<p.length;A++)p[A].dist<P.dist&&(P=p[A],k=A);P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.paths}),e+=u};e<f.arrayLength-c[0];)n()}();break;case"DTWD":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],r=function(r){if(e+r>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+r)})),s.arrayLength=r,a&&(s=bf(o,s)),n.push(Ef(t,s,l,x,i))},p=c[0];p<=c[1]&&"break"!==r(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Mf(n[v]),_=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":_/=y.length;break;case"minLength":_/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":_/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var w=0,S=0,E=0,M=0;M<y.length-1;M++)w+=(E=y[M][0]-y[M+1][0]+(y[M][1]-y[M+1][1]))*(n[v][y[M][1]][y[M][0]]-n[v][y[M+1][1]][y[M+1][0]]),S+=E;w+=(E=1)*n[v][0][0],_=w/=S+=E;break;case"pathLengthRatio":_/=y.length/(t.arrayLength+target.arrayLength)}_<g.dist&&(g={dist:_,path:y},m=v)}g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},r=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e-1;x.forEach((function(t){n[t]=f[t].slice(e,e+r)})),n.arrayLength=r,a&&(n=bf(o,n));for(var l=wf(t,n,x,i),p=r-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var _=Mf(v),w=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":w/=_.length;break;case"minLength":w/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":w/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<_.length-1;C++)S+=(M=_[C][0]-_[C+1][0]+(_[C][1]-_[C+1][1]))*(v[_[C][1]][_[C][0]]-v[_[C+1][1]][_[C+1][0]]),E+=M;S+=(M=1)*v[0][0],M+=M,w=S/=E;break;case"pathLengthRatio":w/=_.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:w,path:_})}for(var T=0,k={dist:1/0},P=1;P<m.length;P++)m[P].dist<k.dist&&(k=m[P],T=P);k.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+T,distance:k.dist,path:k.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(r,m,e),s,n),kf()}.bind(this)).then((function(){Pf()}));break;case"QBS":if(m.length>0){var _,w=dh.getQuery(),S=[];for(var E in w.values)if(Array.isArray(w.values[E])){if(w.values[E].indexOf(null)<0){S.push(E);continue}for(var M=!0,C=0;C<w.values[E].length;C++)if(null!==w.values[E][C]){M=!1;break}M||S.push(E)}_={normalize:t,normalizationOption:i,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p},"polar"===this.state.coordinate&&(w.values=function(t){var e=Object.keys(t),n={};if(e.indexOf("x")<0||e.indexOf("y")<0)return alert("To use the polar coordinate for computing similarities, you cannot ignore the Stokes parameters (Q/I and U/I)."),!1;if(t.x.indexOf(null)>=0||t.y.indexOf(null)>=0)return alert("To use the polar coordinate for computing similarities, you have to assign Q/I and U/I to x axis, y axis, or width."),!1;for(var i=[],r=[],a=0;a<t.arrayLength;a++){var o=Math.sqrt(Math.pow(t.x[a],2)+Math.pow(t.y[a],2)),s=Df(Math.atan2(t.y[a],t.x[a]));i.push(o),r.push(s)}for(var l in n.r=i,n.theta=r,t)n[l]=t[l];return n}(w.values)),w.values&&(Dc(_,function(t,e,n){var i,r=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":i=Cf}a&&(t=bf(o,t));for(var f=function(n){var s=e[n],f=Gu.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Df(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0];switch(r){case"DTWD":var x=[],_=[];if(t.r)for(var w in t)"x"!==w&&"y"!==w&&(Array.isArray(t[w])&&t[w].indexOf(null)<0&&"z"!==w?x.push(w):Array.isArray(t[w])&&t[w].indexOf(null)>=0&&_.push(w));else for(var S in t)Array.isArray(t[S])&&t[S].indexOf(null)<0&&"z"!==S?x.push(S):Array.isArray(t[S])&&t[S].indexOf(null)>=0&&_.push(S);l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],r=function(r){if(e+r>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+r)})),s.arrayLength=r,a&&(s=bf(o,s)),n.push(Ef(t,s,l,x,i))},p=c[0];p<=c[1]&&"break"!==r(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Mf(n[v]),w=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":w/=y.length;break;case"minLength":w/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":w/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<y.length-1;C++)S+=(M=y[C][0]-y[C+1][0]+(y[C][1]-y[C+1][1]))*(n[v][y[C][1]][y[C][0]]-n[v][y[C+1][1]][y[C+1][0]]),E+=M;S+=(M=1)*n[v][0][0],w=S/=E+=M;break;case"pathLengthRatio":w/=y.length/(t.arrayLength+target.arrayLength)}w<g.dist&&(g={dist:w,path:y},m=v)}var T=!0;for(var k in _){for(var P=0;P<t[_[k]].length;P++){if(t[_[k]][P])for(var A=0;A<g.path.length&&!(g.path[A][1]<P);A++)if(g.path[A][1]===P){var O=f[_[k]][e+g.path[A][0]];if(O<t[_[k]][P][0]||t[_[k]][P][1]<O){T=!1;break}}if(!T)break}if(!T)break}T&&g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},r=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(t){n[t]=f[t].slice(e,e+r)})),n.arrayLength=r,a&&(n=bf(o,n));for(var l=wf(t,n,x,i),p=r-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var w=Mf(v),S=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":S/=w.length;break;case"minLength":S/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":S/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<w.length-1;T++)E+=(C=w[T][0]-w[T+1][0]+(w[T][1]-w[T+1][1]))*(v[w[T][1]][w[T][0]]-v[w[T+1][1]][w[T+1][0]]),M+=C;E+=(C=1)*v[0][0],C+=C,S=E/=M;break;case"pathLengthRatio":S/=w.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:S,path:w})}for(var k=0,P={dist:1/0},A=0;A<m.length;A++)m[A].dist<P.dist&&(P=m[A],k=A);var O=!0;for(var L in _){for(var R=0;R<t[_[L]].length;R++){if(t[_[L]][R])for(var I=0;I<P.path.length&&!(P.path[I][1]<R);I++)if(P.path[I][1]===R){var N=f[_[L]][e+P.path[I][0]];if(N<t[_[L]][R][0]||t[_[L]][R][1]<N){O=!1;break}}if(!O)break}if(!O)break}O&&P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(w.values,m,_),w,S),kf())}Pf()}}},{key:"render",value:function(){return r.a.createElement("div",{id:"featureArea",className:"controllersElem featureArea"},this.queryModes(),r.a.createElement("div",{id:"queryModes"},this.QBESelection(),this.QBSSelection()),this.selectionDetail(),this.matchingControllers())}}])&&Bf(e.prototype,n),i&&Bf(e,i),o}(r.a.Component);function Gf(t){return(Gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qf(t,e){return(qf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Yf(t);if(e){var r=Yf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Qf(this,n)}}function Qf(t,e){return!e||"object"!==Gf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yf(t){return(Yf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qf(t,e)}(o,t);var e,n,i,a=$f(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).gaussMargin={top:10,bottom:10,left:10,right:10},e.state={flare:!1,flareOption:"automatic AveAve",rotation:!1,anomaly:!1},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;document.getElementById("weightForAverageList").selectedIndex="2",document.getElementById("stdConstraintsList").selectedIndex="1",this.setGaussCurve(),this.setDefaultValues(),dh.on("recoverQuery",(function(e){if("AE"===dh.getMode()){var n=!1,i=t.state.flareOption,r=!1,a=!1;if(e.option.indexOf("flare")>=0&&(n=!0,"threshold"in e.query?(i="manual",$("#flareThreshold").val(e.query.threshold)):(i="automatic "+e.query.peakFunction,$("#flareLookaround").val(e.query.lookaround),$("#flareSensitivity").val(e.query.sensitivity),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peak"+e.query.peakFunction).addClass("selected"))),e.option.indexOf("rotation")>=0){r=!0,$("#rotationPeriodMin").val(e.query.rotationPeriod[0]),$("#rotationPeriodMax").val(e.query.rotationPeriod[1]),$("#rotationDiameter").val(e.query.rotationDiameter),$("#rotationAngle").val(e.query.rotationAngle);for(var o=document.getElementById("stdConstraintsList"),s=o.options,l=0;l<s.length;l++)if(s[l].value===e.query.stdOfthePeriod){o.selectedIndex=l;break}for(var u=document.getElementById("weightForAverageList"),c=u.options,h=0;h<c.length;h++)if(c[h].value===e.query.weightForAverage){u.selectedIndex=h;break}}e.option.indexOf("anomaly")>=0&&(a=!0),t.setState({flare:n,flareOption:i,rotation:r,anomaly:a})}}))}},{key:"setDefaultValues",value:function(){$("#flareLookaround").val(3),$("#flareSensitivity").val(2),$("#rotationPeriodMin").val(20),$("#rotationPeriodMax").val(30),$("#rotationAngle").val(270),$("#alphaES").val(.5)}},{key:"setGaussCurve",value:function(){var t=150-this.gaussMargin.left-this.gaussMargin.right,e=150-this.gaussMargin.top-this.gaussMargin.bottom,n=se("#gaussCurveArea").append("svg").attr("width",150).attr("height",150).attr("id","gaussCurve");n.append("rect").attr("width",t).attr("height",e).style("fill","none").style("stroke","lightgray").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")"),this.xScaleGauss=Ca().range([0,t]),this.yScaleGauss=Ca().range([e,0]);var i=document.getElementById("weightForAverageList"),r=i.selectedIndex,a=i.options[r].value,o=pc(Number(a));this.xScaleGauss.domain([A(o,(function(t){return t.x})),k(o,(function(t){return t.x}))]),this.yScaleGauss.domain([A(o,(function(t){return t.y})),k(o,(function(t){return t.y}))]),this.gaussPath=n.append("path").datum(o).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","gaussCurvePath").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")").attr("d",Us().x(function(t){return this.xScaleGauss(t.x)}.bind(this)).y(function(t){return this.yScaleGauss(t.y)}.bind(this)).curve(Zs))}},{key:"updateWeight",value:function(){se("#gaussCurvePath").remove();var t=document.getElementById("weightForAverageList"),e=t.selectedIndex,n=t.options[e].value,i=pc(Number(n));this.xScaleGauss.domain([A(i,(function(t){return t.x})),k(i,(function(t){return t.x}))]),this.yScaleGauss.domain([A(i,(function(t){return t.y})),k(i,(function(t){return t.y}))]),this.gaussPath=se("#gaussCurve").append("path").datum(i).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","gaussCurvePath").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")").attr("d",Us().x(function(t){return this.xScaleGauss(t.x)}.bind(this)).y(function(t){return this.yScaleGauss(t.y)}.bind(this)).curve(Zs))}},{key:"clickRunButton",value:function(){$("#topKLabelResults").text("Top "+dh.getKValue()+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){this.runAutomaticExtraction()}.bind(this),0)}},{key:"runAutomaticExtraction",value:function(){var t,e,n,i=dh.getTarget(),r={mode:"automatic extraction",option:[],query:{}};if(this.state.flare){r.option.push("flare");var a=this.state.flareOption.split(" ")[0];if("automatic"===a){var o=this.state.flareOption.split(" ")[1],s=$("#flareLookaround").val(),l=$("#flareSensitivity").val();""!==s&&""!==l&&(t=function(t,e,n,i){for(var r=[],a=0;a<t.length;a++){for(var o=t[a],s=Gu.getData(o),l=[],u=void 0,c=0;c<s.data.splines.value.points.length;c++){switch(e){case"AveMaximum":u=Af(o,c,n);break;case"AveAve":u=Of(o,c,n);break;case"AveDist":u=Lf(o,c,n)}l.push({index:c,significance:u,V:s.data.splines.value.points[c].y})}for(var h=l.filter((function(t){return t.significance>0})),d=P(h,(function(t){return t.significance})),p=f(h,(function(t){return t.significance})),m=0;m<h.length;m++)h[m].significance-d>i*p&&r.push({id:o,start:s.data.splines.value.points[h[m].index].z,significance:h[m].significance,V:h[m].V})}return r}(i,o,s=Number(s),l=Number(l))),r.query.lookaround=s,r.query.sensitivity=l,r.query.peakFunction=o}else"manual"===a&&(t=function(t,e){for(var n=[],i=0;i<t.length;i++)for(var r=t[i],a=Gu.getData(r),o=0;o<a.data.splines.value.points.length;o++)a.data.splines.value.points[o].y>=e&&n.push({id:r,start:a.data.splines.value.points[o].z,V:a.data.splines.value.points[o].y});return n}(i,Number($("#flareThreshold").val())),r.query.threshold=Number($("#flareThreshold").val()))}if(this.state.rotation){r.option.push("rotation");var u=[Number($("#rotationPeriodMin").val()),Number($("#rotationPeriodMax").val())],c=$("#rotationDiameter").val(),h=$("#rotationAngle").val(),d=$("#alphaES").val();c=""===c?0:Number(c),h=""===h?0:Number(h),d=""===d?.1:Number(d);var p=document.getElementById("stdConstraintsList"),m=p.selectedIndex,g=p.options[m].value,v=document.getElementById("weightForAverageList");m=v.selectedIndex;var y=Number(v.options[m].value);e=function(t,e,n,i,r,a,o){for(var s=[],l=0;l<t.length;l++){for(var u=t[l],c=Gu.getData(u).data.splines.position.points,h=[],d=0;d<c.length;d++){for(var f=[],p=e[0];p<=e[1]&&!(c[d].z+p>c[c.length-1].z);p++){for(var m=!1,g=1;d+g<c.length&&c[d+g].z-c[d].z<p;g++)if(c[d+g].z-c[d+g-1].z>5){m=!0;break}var v={x:0,y:0},y=[];if(0===r){for(var b=0;b<p;b++){var x=Gu.getValues(u,c[d].z+b-c[0].z);y.push(x),v.x+=x.x,v.y+=x.y}v.x/=p,v.y/=p}else{for(var _=8/p,w=-4,S=0,E=0;E<p;E++){var M=Gu.getValues(u,c[d].z+E-c[0].z);y.push(M);var C=mc(w,r);v.x+=C*M.x,v.y+=C*M.y,S+=C,w+=_}v.x/=S,v.y/=S}for(var T={x:0,y:0},k={x:y[0].x,y:y[0].y},P={x:y[0].x,y:y[0].y},A=[],O=[],L=0;L<p;L++){var R={x:y[L].x,y:y[L].y},I=Rf(R,v),N=If(R,v);A.push({z:y[L].z,angle:I}),O.push({z:y[L].z,degree:N}),T.x+=Math.pow(y[L].x-v.x,2),T.y+=Math.pow(y[L].y-v.y,2),y[L].x<k.x&&(k.x=y[L].x),P.x<y[L].x&&(P.x=y[L].x),y[L].y<k.y&&(k.y=y[L].y),P.y<y[L].y&&(P.y=y[L].y)}var D={x:Math.sqrt(T.x/p),y:Math.sqrt(T.y/p)};if(!m&&(P.x-k.x>n||P.y-k.y>n)){var z=Gu.getData(u).data.meta.std.x,B=Gu.getData(u).data.meta.std.y,F=!1;switch(a){case"no":F=!0;break;case"and":z<D.x&&B<D.y&&(F=!0);break;case"or":(z<D.x||B<D.y)&&(F=!0);break;case"x":z<D.x&&(F=!0);break;case"y":B<D.y&&(F=!0);break;default:F=!1}if(F){for(var V=0,j=A[0],U=o,H=A[0].angle,G=0;G<p;G++){var W=void 0,q=U*j.angle+(1-U)*H;Math.abs(A[G].angle-j.angle)>180?(W=q-H<0?j.angle>A[G].angle?-1*(j.angle-A[G].angle):-1*(j.angle+360-A[G].angle):j.angle>A[G].angle?A[G].angle+360-j.angle:A[G].angle-j.angle,H=1===Nf(A[G].angle)&&4===Nf(A[G-1].angle)||4===Nf(A[G].angle)&&1===Nf(A[G-1].angle)?A[G].angle:q):(W=A[G].angle-j.angle,H=q),V+=W,j=A[G]}Math.abs(V)>i&&f.push({id:u,start:c[d].z,angle:Math.abs(V),period:p,center:v,diameter:{x:P.x-k.x,y:P.y-k.y},direction:V<0?"clockwise":"counterclockwise"})}}}if(f.length>0){for(var $=Math.abs(f[0].angle),Q=0,Y=1;Y<f.length;Y++)$<Math.abs(f[Y].angle)&&($=Math.abs(f[Y].angle),Q=Y);h.push(f[Q])}}if(h.length>0){for(var X=0,Z=0,J=h[X].angle,K=1;K<h.length;)if(h[X].start<=h[K].start&&h[X].start+h[X].period<=h[K].start+h[K].period||h[X].start<=h[K].start&&h[K].start+h[K].period<=h[X].start+h[X].period){var tt=Math.max(h[X].start,h[K].start);Math.min(h[X].start+h[X].period,h[K].start+h[K].period)-tt>.5*h[X].period?(h[K].angle<J&&(J=h[K].angle,Z=K),K++):(s.push(h[Z]),X=Z=K,J=h[Z],K++)}s.push(h[Z])}}return s}(i,u,c,h,y,g,d),r.query.rotationPeriod=u,r.query.rotationDiameter=c,r.query.rotationAngle=h,r.query.stdOfthePeriod=g,r.query.alpha=d,r.query.weightForAverage=0===y?"flat":y}this.state.anomaly&&(r.option.push("anomaly"),n=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n],r=Gu.getData(i),a=r.data.spatial,o=0;o<a.length-1;o++){var s=a[o].z,l=a[o+1].z,u=Gu.getValues(i,s-a[0].z),c=Gu.getValues(i,l-a[0].z),h=100*Math.sqrt(Math.pow((c.x-u.x)/(r.data.meta.max.x-r.data.meta.min.x),2)+Math.pow((c.y-u.y)/(r.data.meta.max.y-r.data.meta.min.y),2))/(l-s);(0===h||isNaN(h))&&(h=1);var d=Math.abs(c.V-u.V)/(r.data.meta.max.V-r.data.meta.min.V)*100/(l-s);(0===d||isNaN(d))&&(d=1);var f=Math.abs(c.H-u.H)/(r.data.meta.max.H-r.data.meta.min.H)*100/(l-s);(0===f||isNaN(f))&&(f=1),e.push({id:i,start:s,anomalyDegree:h*d*f})}return e}(i));var b=[];if(this.state.flare&&this.state.rotation){for(var x,_=0,w=0;_<t.length&&w<e.length;)e[w].id<t[_].id?w++:t[_].id<e[w].id?_++:e[w].start<=t[_].start&&t[_].start<=e[w].start+e[w].period?(void 0===(x=e[w]).flares&&(x.flares=[]),x.flares.push(t[_]),_++):t[_].start<e[w].start?_++:e[w].start+e[w].period<t[_].start&&(x&&(b.push(x),x=null),w++);x&&b.push(x)}else if(this.state.anomaly&&this.state.rotation){for(var S,E=0,M=0;E<n.length&&M<e.length;)e[M].id<n[E].id?M++:n[E].id<e[M].id?E++:e[M].start<=n[E].start&&n[E].start<=e[M].start+e[M].period?(void 0===(S=e[M]).anomalies&&(S.anomalies=[]),S.anomalies.push(n[E]),E++):n[E].start<e[M].start?E++:e[M].start+e[M].period<n[E].start&&(S&&(b.push(S),S=null),M++);S&&b.push(S)}else this.state.flare?b=t:this.state.rotation?b=e:this.state.anomaly&&(b=n);Dc(void 0,b,r),kf(),Pf()}},{key:"flareOptions",value:function(){return r.a.createElement("form",{className:"form-check",id:"flareOptions",style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"flareAutomatic",name:"flareOptions",value:"automatic",checked:this.state.flareOption.indexOf("automatic")>=0,disabled:!this.state.flare,onChange:this.switchFlareOption.bind(this),className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"flareAutomatic"},"Automatic"),r.a.createElement("h6",null,"Parameters"),r.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}}),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Lookaround"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"k neightbors",id:"flareLookaround",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Sensitivity cutoff"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"h",id:"flareSensitivity",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}}))),r.a.createElement("h6",null,"Peak function"),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("img",{id:"peakAveMaximum",className:"selectorIcon",name:"peakFunction",value:"AveMaximum",src:"img/icons/flare1.png",alt:"Average of the maximums among k left & right neightbors",width:"80",height:"80",title:"Average of the maximums among k left & right neightbors",onClick:this.selectFlareAveMaximum.bind(this),readOnly:!0}),r.a.createElement("img",{id:"peakAveAve",className:"selectorIcon selected",name:"peakFunction",value:"AveAve",src:"img/icons/flare2.png",alt:"Average of the averages of the signed distance from k left & right neightbors",width:"80",height:"80",title:"Average of the averages of the signed distance from k left & right neightbors",onClick:this.selectFlareAveAve.bind(this),readOnly:!0}),r.a.createElement("img",{id:"peakAveDist",className:"selectorIcon",name:"peakFunction",value:"AveDist",src:"img/icons/flare3.png",alt:"Average signed distance from the averages of k neightbors",width:"80",height:"80",title:"Average signed distance from the averages of k neightbors",onClick:this.selectFlareAveDist.bind(this),readOnly:!0}))),r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"flareManual",name:"flareOptions",value:"manual",checked:"manual"===this.state.flareOption,disabled:!this.state.flare,onChange:this.switchFlareOption.bind(this),className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"flareManual"},"Manual"),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Intensity Threshold"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"flareThreshold",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}})))))}},{key:"rotationOptions",value:function(){return r.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Rotation period"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"rotationPeriodMin",disabled:!this.state.rotation,style:{width:"20%",marginRight:"0.5rem"}}),"~",r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"rotationPeriodMax",disabled:!this.state.rotation,style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"}}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Rotation diameter"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"diameter",id:"rotationDiameter",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Rotation angle"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"angle",id:"rotationAngle",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5",title:"X and Y are standard deviations of the entire data,  x and y are those of the time interval"},"Standard deviation of the period"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"stdConstraintsList",style:{width:"60%"},disabled:!this.state.rotation},r.a.createElement("option",{value:"no"},"No constraints"),r.a.createElement("option",{value:"and"},"X < x  Y < y"),r.a.createElement("option",{value:"or"},"X < x  Y < y"),r.a.createElement("option",{value:"x"},"X < x"),r.a.createElement("option",{value:"y"},"Y < y")))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"}," of the exponential smoothing"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"alpha",id:"alphaES",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Weight for average"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"weightForAverageList",style:{width:"60%"},disabled:!this.state.rotation,onChange:this.updateWeight.bind(this)},r.a.createElement("option",{value:"0"},"Flat (arithmetic mean)"),r.a.createElement("option",{value:"1"},"=1"),r.a.createElement("option",{value:"3"},"=3"),r.a.createElement("option",{value:"5"},"=5")))),r.a.createElement("div",{id:"gaussCurveArea",style:{textAlign:"center"}}))}},{key:"switchFlareOption",value:function(){var t=$("input[name=flareOptions]:checked").val();"automatic"===t&&$("img[name=peakFunction]").each((function(e,n){if($(this).attr("class").indexOf("selected")>=0){var i=$(n).attr("id");t+=" "+i.slice(4,i.length)}})),this.setState({flareOption:t})}},{key:"selectFlareAveMaximum",value:function(){this.setState({flareOption:"automatic AveMaximum"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveMaximum").addClass("selected")}},{key:"selectFlareAveAve",value:function(){this.setState({flareOption:"automatic AveAve"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveAve").addClass("selected")}},{key:"selectFlareAveDist",value:function(){this.setState({flareOption:"automatic AveDist"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveDist").addClass("selected")}},{key:"clickFlare",value:function(){var t=!this.state.flare;this.setState({flare:t}),Bc("flare",t)}},{key:"clickRotation",value:function(){var t=!this.state.rotation;this.setState({rotation:t}),Bc("rotation",t)}},{key:"clickAnomaly",value:function(){var t=!this.state.anomaly;this.setState({anomaly:t}),Bc("anomaly",t)}},{key:"render",value:function(){return r.a.createElement("div",{id:"AEQuerying",className:"featureArea",style:{padding:"15px"}},r.a.createElement("div",{className:"form-group",name:"AEModeForm"},r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"flareExtractionCheck",name:"AEMode",value:"flare",onChange:this.clickFlare.bind(this),checked:this.state.flare}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"flareExtractionCheck"},"Flare"),this.flareOptions()),r.a.createElement("div",{id:"rotationExtraction"},r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"rotationExtractionCheck",name:"AEMode",value:"rotation",onChange:this.clickRotation.bind(this),checked:this.state.rotation}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"rotationExtractionCheck"},"Rotation")),this.rotationOptions()),r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",name:"AEMode",value:"anomaly",id:"anomalyExtractionCheck",onChange:this.clickAnomaly.bind(this),checked:this.state.anomaly}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"anomalyExtractionCheck"},"Anomaly"))),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runAutomaticExtractionBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run"))}}])&&Wf(e.prototype,n),i&&Wf(e,i),o}(r.a.Component);function Zf(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=tp(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Jf(t){return(Jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||tp(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tp(t,e){if(t){if("string"==typeof t)return ep(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ep(t,e):void 0}}function ep(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function np(t,e){for(var n=[],i=0;i<e;i++)n.push([]);if("object"===Jf(t[0]))for(var r=0;r<t.length;r++)n[t[r].cluster].push(r);else for(var a=0;a<t.length;a++)n[t[a]].push(a);return n}function ip(t,e,n,i,r,a){for(var o=0,s=0,l=0;l<t.length;l++)o+=t[l]*i[l];switch(r.metric){case"Euclidean":break;case"DTWD":if(r.window>0)for(var u=0;u<e.length;u++){var c=bp(e[u],n,a,r.window,r.distFunc);s+=i[u]*c[c.length-1][c[0].length-1]}else for(var h=0;h<e.length;h++){var d=vp(e[h],n,a,r.distFunc);s+=i[h]*d[d.length-1][d[0].length-1]}break;case"DTWI":if(r.window>0)for(var f=function(t){var o=yp(e[t],n,a,r.window,r.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=i[t]*l},p=0;p<e.length;p++)f(p);else for(var m=function(t){var o=gp(e[t],n,a,r.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=i[t]*l},g=0;g<e.length;g++)m(g);break;case"DTW":if(r.window>0)for(var v=function(t){var o=yp(e[t],n,a,r.window,r.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=i[t]*l},y=0;y<e.length;y++)v(y);else for(var b=function(t){var o=gp(e[t],n,a,r.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=i[t]*l},x=0;x<e.length;x++)b(x)}var _=i.reduce((function(t,e){return t+e}),0);return s/o*((_-e.length)/(e.length-1))}function rp(t,e){for(var n=[],i=0;i<t.length;i++)for(var r=i;r<t.length;r++){var a=t[r].z-t[i].z;if(a>e[1])break;e[0]<=a&&a<=e[1]&&n.push([i,r])}return n}function ap(t,e){for(var n=[],i=function(i){var r={};e.forEach((function(e){r[e]=t[e][i]})),n.push(r)},r=0;r<t.z.length;r++)i(r);return n}function op(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(Array.isArray(t)){for(var o=[],s=[],l=0;l<e.length;l++){var u=(t[e[l][1]].z-t[e[l][0]].z)/n,c=[],h=[];h=t.slice(e[l][0],e[l][1]+1);for(var d=0;d<=n;d++){for(var f=d*u+t[e[l][0]].z,p=void 0,m=e[l][0];m<=e[l][1];m++){if(t[m].z===f){p=t[m];break}if(t[m].z<f&&f<t[m+1].z){var g=(f-t[m].z)/(t[m+1].z-t[m].z);if(0===m){var v=vc(t[m],vc(t[m+1],t[m]));(p=sp(g,v,t[m],t[m+1],t[m+2])).z=f}else if(m==t.length-2){var y=gc(t[m+1],vc(t[m+1],t[m]));(p=sp(g,t[m-1],t[m],t[m+1],y)).z=f}else(p=sp(g,t[m-1],t[m],t[m+1],t[m+2])).z=f;break}}c.push(p)}if(s.push(up(c,r,a)),i){var b=[],x=void 0,_=void 0,w=lp(c,["z"]),S=Kf(w,3);c=S[0],x=S[1],_=S[2];for(var E=0;E<h.length;E++){var M={};for(var C in c[0])M[C]="z"===C?h[E].z:(h[E][C]-x[C])/_[C];b.push(M)}c.dataPoints=b,c.idx=l}else c.dataPoints=h,c.idx=l;o.push(c)}return[o,s]}var T={},k={};for(var P in t){for(var A=[],O=[],L=0;L<e[P].length;L++){var R=(t[P][e[P][L][1]].z-t[P][e[P][L][0]].z)/n,I=[],N=[];N=t[P].slice(e[P][L][0],e[P][L][1]+1);for(var D=0;D<=n;D++){for(var z=D*R+t[P][e[P][L][0]].z,B=void 0,F=e[P][L][0];F<=e[P][L][1];F++){if(t[P][F].z===z){B=t[P][F];break}if(t[P][F].z<z&&z<t[P][F+1].z){var V=(z-t[P][F].z)/(t[P][F+1].z-t[P][F].z);if(0===F){var j=vc(t[P][F],vc(t[P][F+1],t[P][F]));(B=sp(V,j,t[P][F],t[P][F+1],t[P][F+2])).z=z}else if(F==t[P].length-2){var U=gc(t[P][F+1],vc(t[P][F+1],t[P][F]));(B=sp(V,t[P][F-1],t[P][F],t[P][F+1],U)).z=z}else(B=sp(V,t[P][F-1],t[P][F],t[P][F+1],t[P][F+2])).z=z;break}}I.push(B)}if(O.push(up(I,r[P],a[P])),i){var H=[],G=void 0,W=void 0,q=lp(I,["z"]),$=Kf(q,3);I=$[0],G=$[1],W=$[2];for(var Q=0;Q<N.length;Q++){var Y={};for(var X in I[0])Y[X]="z"===X?N[Q].z:(N[Q][X]-G[X])/W[X];H.push(Y)}I.dataPoints=H,I.id=P,I.idx=L}else I.dataPoints=N,I.id=P,I.idx=L;A.push(I)}T[P]=A,k[P]=O}return[T,k]}function sp(t,e,n,i,r){var a=n,o=gc(yc(-.5,e),yc(.5,i)),s=vc(gc(vc(e,yc(2.5,n)),yc(2,i)),yc(.5,r)),l=gc(vc(gc(yc(-.5,e),yc(1.5,n)),yc(1.5,i)),yc(.5,r));return gc(yc(gc(yc(gc(yc(l,t),s),t),o),t),a)}function lp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=[],i={},r={};for(var a in t[0])(void 0===e||e.indexOf(a)<0)&&(i[a]=0,r[a]=0);for(var o=0;o<t.length;o++)for(var s in t[o])(void 0===e||e.indexOf(s)<0)&&(i[s]+=t[o][s]);for(var l in i)i[l]/=t.length;for(var u=0;u<t.length;u++)for(var c in t[u])(void 0===e||e.indexOf(c)<0)&&(r[c]+=Math.pow(t[u][c]-i[c],2));for(var h in r)r[h]=Math.sqrt(r[h]/t.length);for(var d=0;d<t.length;d++){var f={};for(var p in t[d])(void 0===e||e.indexOf(p)<0)&&(f[p]=(t[d][p]-i[p])/r[p]),void 0!==e&&e.indexOf(p)>=0&&(f[p]=t[d][p]);n.push(f)}return[n,i,r]}function up(t,e,n){var i=vc(n,e),r={};for(var a in t[0])r[a]=0;for(var o=0;o<t.length-1;o++){var s=bc(vc(t[o],e),i);r=gc(r,xc(bc(vc(t[o+1],e),i),s))}return function(t,e){var n=0;if(e)for(var i in t)e.indexOf(i)<0&&(n+=t[i]);else for(var r in t)n+=t[r];return n}(r,["z"])/t.length}function cp(t,e){var n=0;return t[0]<=e[0]&&e[0]<=t[1]?n=e[1]<=t[1]?(e[1]-e[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:(t[1]-e[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:e[0]<=t[0]&&t[0]<=e[1]&&(n=t[1]<=e[1]?(t[1]-t[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:(e[1]-t[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100),n}function hp(t,e,n){var i=[];switch(e.metric){case"DTWD":if(e.window>0)for(var r=0;r<t.length-1;r++){for(var a=[],o=r+1;o<t.length;o++){var s=bp(t[r],t[o],n,e.window,e.distFunc);a.push(s[s.length-1][s[0].length-1])}i.push(a)}else for(var l=0;l<t.length-1;l++){for(var u=[],c=l+1;c<t.length;c++){var h=vp(t[l],t[c],n,e.distFunc);u.push(h[h.length-1][h[0].length-1])}i.push(u)}break;case"DTWI":if(e.window>0)for(var d=0;d<t.length-1;d++){for(var f=[],p=function(i){var r=0,a=yp(t[d],t[i],n,e.window,disranceParameter.distFunc);n.forEach((function(t){r+=a[t][a[t].length-1][a[t][0].length-1]})),f.push(r)},m=d+1;m<t.length;m++)p(m);i.push(f)}else for(var g=0;g<t.length-1;g++){for(var v=[],y=function(i){var r=0,a=gp(t[g],t[i],n,e.distFunc);n.forEach((function(t){r+=a[t][a[t].length-1][a[t][0].length-1]})),v.push(r)},b=g+1;b<t.length;b++)y(b);i.push(v)}break;case"DTW":if(e.window>0)for(var x=0;x<t.length-1;x++){for(var _=[],w=function(i){var r={},a=yp(t[x],t[i],n,e.window,disranceParameter.distFunc);n.forEach((function(t){r[t]=a[t][a[t].length-1][a[t][0].length-1]})),_.push(r)},S=x+1;S<t.length;S++)w(S);i.push(_)}else for(var E=0;E<t.length-1;E++){for(var M=[],C=function(i){var r={},a=gp(t[E],t[i],n,e.distFunc);n.forEach((function(t){r[t]=a[t][a[t].length-1][a[t][0].length-1]})),M.push(r)},T=E+1;T<t.length;T++)C(T);i.push(M)}}return i}function dp(t,e,n,i){var r=[],a=[],o=0,s=e.metric;switch("DTW"===s&&(s="DTWI"),s){case"Euclidean":break;case"DTWD":r=t[Math.floor(Math.random()*Math.floor(t.length))];for(var l=function(){for(var s=[],l=[],u=function(t){var e={};n.forEach((function(t){e[t]=0})),s.push(e),l.push(0)},c=0;c<=i;c++)u();if(e.window>0)for(var h=function(i){for(var a=xp(bp(r,t[i],n,e.window,e.distFunc)),o=function(e){n.forEach((function(n){s[a[e][0]][n]+=t[i][a[e][1]][n]})),l[a[e][0]]++},u=0;u<a.length;u++)o(u)},d=0;d<t.length;d++)h(d);else for(var f=function(i){for(var a=xp(vp(r,t[i],n,e.distFunc)),o=function(e){n.forEach((function(n){s[a[e][0]][n]+=t[i][a[e][1]][n]})),l[a[e][0]]++},u=0;u<a.length;u++)o(u)},p=0;p<t.length;p++)f(p);for(var m=0;m<s.length;m++)for(var g in s[m])s[m][g]/=l[m];a=s,o++};o<300&&c(r,a);)l();break;case"DTWI":r=t[Math.floor(Math.random()*Math.floor(t.length))];for(var u=function(){for(var s=[],l=[],u=function(t){var e={},i={};n.forEach((function(t){e[t]=0,i[t]=0})),s.push(e),l.push(i)},c=0;c<=i;c++)u();if(e.window>0)for(var h=function(i){var a=xp(yp(r,t[i],n,e.window,e.distFunc));n.forEach((function(e){for(var n=0;n<a[e].length;n++)s[a[e][n][0]][e]+=t[i][a[e][n][1]][e],l[a[e][n][0]][e]++}))},d=0;d<t.length;d++)h(d);else for(var f=function(i){var a=xp(gp(r,t[i],n,e.distFunc));n.forEach((function(e){for(var n=0;n<a[e].length;n++)s[a[e][n][0]][e]+=t[i][a[e][n][1]][e],l[a[e][n][0]][e]++}))},p=0;p<t.length;p++)f(p);for(var m=0;m<s.length;m++)for(var g in s[m])s[m][g]/=l[m][g];a=s,o++};o<300&&c(r,a);)u()}return a;function c(t,e){var i=!1;if(0===t.length||0===e.length)return!0;for(var r=0;r<t.length;r++){for(var a in n)if(t[r][a]!==e[r][a]){i=!0;break}if(i)break}return i}}function fp(t,e,n,i){for(var r,a,o,s=i.filter((function(t){return"z"!==t})),l=hp(t,n,s),u=[],c=[],h={},d=1/0,f=0;f<10;f++){var p=1/0;u=[],c=[];for(var m=0;m<5;m++){var g=Kf(B(s),3),v=g[0],y=g[1],b=g[2];y<p&&(p=y,u=v,c=b)}for(var x=[],_=[],w=[],S=0;!F(u,x,s)&&S<300;){0!==x.length&&0!==_.length&&(u=x,c=_);var E=Kf(j(c,s),2);x=E[0],w=E[1],_=V(x,s),S++}u=x,_=c;for(var M=0,C=[],T=0;T<w.length;T++){var k=0;for(var P in w[T])M+=w[T][P],k+=w[T][P];C.push(k)}M<d&&(d=M,o=C,r=u,a=c)}u=r,c=a;for(var A=[],O=0;O<u.length;O++){for(var L=[],R=0;R<t[0].length;R++)L.push({});for(var I in u[O])for(var N=0;N<t[u[O][I]].length;N++)L[N][I]=t[u[O][I]][N][I];A.push(L)}var D=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var i=0;i<c.length;i++)t[c[i]].push(i);return t}();h.clusterRadiuses=function(t){for(var n=[],i=0;i<e;i++)n.push(o[i]/t[i]);return n}(D.map((function(t){return t.length})));var z=Kf(function(){var e,n=[];n=Array(t.length).fill(0);for(var i=function(t){for(var e=function(e){for(var i=0,r=0,a=void 0,o=1/0,c=function(n){if(n!==t){var i=0;s.forEach((function(r){if(D[t][e]!==u[n][r]){var a=Math.min(D[t][e],u[n][r]),o=Math.max(D[t][e],u[n][r]);i+=l[a][o-a-1][r]}})),i<o&&(o=i,a=n)}},h=0;h<u.length;h++)c(h);for(var d=0;d<D[t].length;d++)D[t][e]!==D[t][d]&&function(){var n=Math.min(D[t][e],D[t][d]),r=Math.max(D[t][e],D[t][d]);s.forEach((function(t){i+=l[n][r-n-1][t]}))}();i/=D[t].length-1;for(var f=function(n){var i=Math.min(D[t][e],D[a][n]),o=Math.max(D[t][e],D[a][n]);s.forEach((function(t){r+=l[i][o-i-1][t]}))},p=0;p<D[a].length;p++)f(p);r/=D[a].length,n[D[t][e]]=(r-i)/Math.max(i,r)},i=0;i<D[t].length;i++)e(i)},r=0;r<D.length;r++)i(r);return e=n.reduce((function(t,e){return t+e}),0),[e/=n.length,n]}(),2);return h.silhouette=z[0],h.silhouetteSS=z[1],h.davisBouldin=function(){for(var t=0,e=function(e){for(var n=-1/0,i=function(t){if(e===t)return"continue";var i=0;s.forEach((function(n){var r=Math.min(u[e][n],u[t][n]),a=Math.max(u[e][n],u[t][n]);i+=l[r][a-r-1][n]}));var r=(h.clusterRadiuses[e]+h.clusterRadiuses[t])/i;n<r&&(n=r)},r=e+1;r<D.length;r++)i(r);isFinite(n)&&(t+=n)},n=0;n<D.length;n++)e(n);return t/=D.length}(),[A,c,h];function B(n){for(var i=[],r=function(){var e={};n.forEach((function(n){for(var r;void 0===r;){r=Math.floor(Math.random()*Math.floor(t.length));for(var a=0;a<i.length;a++)if(i[a][n]===r){r=void 0;break}}e[n]=r})),i.push(e)};i.length<e;)r();var a=V(i,n),o=function(t,e,n){for(var i=0,r=function(r){n.forEach((function(n){r<t[e[r]][n]?i+=l[r][t[e[r]][n]-r-1][n]:t[e[r]][n]<r&&(i+=l[t[e[r]][n]][r-t[e[r]][n]-1][n])}))},a=0;a<e.length;a++)r(a);return i}(i,a,n);return[i,o,a]}function F(t,e,n){var i=!0;if(t.length!==e.length)i=!1;else for(var r=0;r<e.length;r++){for(var a=!1,o=0;o<t.length;o++){var s,l=!0,u=Zf(n);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(e[r][c]!==t[o][c]){l=!1;break}}}catch(t){u.e(t)}finally{u.f()}if(l){a=!0;break}}if(!a){i=!1;break}}return i}function V(e,n){for(var i=[],r=function(t){for(var r=0,a=1/0,o=function(i){var o=0;n.forEach((function(n){t<e[i][n]?o+=l[t][e[i][n]-t-1][n]:e[i][n]<t?o+=l[e[i][n]][t-e[i][n]-1][n]:o+=0})),o<a&&(r=i,a=o)},s=0;s<e.length;s++)o(s);i.push(r)},a=0;a<t.length;a++)r(a);return i}function j(t,n){for(var i=[],r=0;r<e;r++)i.push([]);for(var a=0;a<t.length;a++)i[t[a]].push(a);for(var o=[],s=[],u=function(t){var e={},r={};n.forEach((function(t){e[t]=0,r[t]=1/0}));for(var a=0;a<i[t].length;a++){var u={};for(var c in r)u[c]=0;for(var h=0;h<i[t].length;h++){var d=0;if(i[t][a]!==i[t][h]){if(i[t][a]<i[t][h])for(var f in r)u[f]+=l[i[t][a]][i[t][h]-i[t][a]-1][f],r[f]<u[f]&&d++;else if(i[t][h]<i[t][a])for(var p in r)u[p]+=l[i[t][h]][i[t][a]-i[t][h]-1][p],r[p]<u[p]&&d++;if(d===Object.keys(r))break}}for(var m in r)u[m]<r[m]&&(r[m]=u[m],e[m]=i[t][a])}o.push(e),s.push(r)},c=0;c<e;c++)u(c);return[o,s]}}function pp(t,e,n,i){for(var r,a,o,s,l,u=i.filter((function(t){return"z"!==t})),c=hp(t,n,u),h=1/0,d={},f=1/0,p=function(t){for(var e=0;e<5;e++){var n=Kf(x(),3),i=n[0],u=n[1],c=n[2];u<h&&(h=u,r=i,a=c)}for(var d=[],p=[],m=[],g=0;r.filter((function(t){return-1==d.indexOf(t)})).length>0&&g<300;){0!==d.length&&0!==p.length&&(r=d,a=p);var v=Kf(w(a),2);d=v[0],m=v[1],p=_(d),g++}for(var y=0,b=0;b<m.length;b++)y+=m[b];y<f&&(f=y,l=m,o=d,s=p)},m=0;m<10;m++)p();r=o,a=s;for(var g=[],v=0;v<r.length;v++)g.push(t[r[v]]);var y=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var i=0;i<a.length;i++)t[a[i]].push(i);return t}();d.clusterRadiuses=function(t){for(var n=[],i=0;i<e;i++)n.push(l[i]/t[i]);return n}(y.map((function(t){return t.length})));var b=Kf(function(){var e,n=[];n=Array(t.length).fill(0);for(var i=0;i<y.length;i++)for(var a=0;a<y[i].length;a++){for(var o=0,s=0,l=void 0,u=1/0,h=0;h<r.length;h++)if(h!==i){var d=Math.min(y[i][a],r[h]),f=Math.max(y[i][a],r[h]),p=c[d][f-d-1];p<u&&(u=p,l=h)}for(var m=0;m<y[i].length;m++)if(y[i][a]!==y[i][m]){var g=Math.min(y[i][a],y[i][m]),v=Math.max(y[i][a],y[i][m]);o+=c[g][v-g-1]}o/=y[i].length-1;for(var b=0;b<y[l].length;b++){var x=Math.min(y[i][a],y[l][b]),_=Math.max(y[i][a],y[l][b]);s+=c[x][_-x-1]}s/=y[l].length,n[y[i][a]]=(s-o)/Math.max(o,s)}return e=n.reduce((function(t,e){return t+e}),0),[e/=n.length,n]}(),2);return d.silhouette=b[0],d.silhouetteSS=b[1],d.davisBouldin=function(){for(var t=0,e=0;e<y.length;e++){for(var n=-1/0,i=e+1;i<y.length;i++)if(e!==i){var a=Math.min(r[e],r[i]),o=Math.max(r[e],r[i]),s=c[a][o-a-1],l=(d.clusterRadiuses[e]+d.clusterRadiuses[i])/s;n<l&&(n=l)}isFinite(n)&&(t+=n)}return t/=y.length}(),[g,a,d];function x(){for(var n=[];n.length<e;){var i=Math.floor(Math.random()*Math.floor(t.length));n.indexOf(i)<0&&n.push(i)}var r=_(n);return[n,function(t,e){for(var n=0,i=0;i<e.length;i++)i<t[e[i]]?n+=c[i][t[e[i]]-i-1]:t[e[i]]<i&&(n+=c[t[e[i]]][i-t[e[i]]-1]);return n}(n,r),r]}function _(e){for(var n=[],i=0;i<t.length;i++){var r=e.indexOf(i);if(r>=0)n.push(r);else{for(var a=0,o=c[Math.min(i,a)][Math.max(i,a)-Math.min(i,a)-1],s=1;s<e.length;s++)i<e[s]?c[i][e[s]-i-1]<o&&(a=s,o=c[i][e[s]-i-1]):e[s]<i&&c[e[s]][i-e[s]-1]<o&&(a=s,o=c[e[s]][i-e[s]-1]);n.push(a)}}return n}function w(t){for(var n=[],i=0;i<e;i++)n.push([]);for(var r=0;r<t.length;r++)n[t[r]].push(r);for(var a=[],o=[],s=0;s<e;s++){for(var l=0,u=1/0,h=0;h<n[s].length;h++){for(var d=0,f=0;f<n[s].length&&!(n[s][h]!==n[s][f]&&(n[s][h]<n[s][f]?d+=c[n[s][h]][n[s][f]-n[s][h]-1]:n[s][f]<n[s][h]&&(d+=c[n[s][f]][n[s][h]-n[s][f]-1]),u<d));f++);d<u&&(l=n[s][h],u=d)}a.push(l),o.push(u)}return[a,o]}}function mp(t,e,n,i){var r,a=i.filter((function(t){return"z"!==t})),o=hp(t,n,a),s=t[0].length,l={},u=[],c=[],h=[],d=function(){for(var i=[],r=[],o=0;o<e;o++)r.push([]);for(var l=0;l<e;l++)i.push(l),r[i[i.length-1]].push(l);for(var u=e;u<t.length;u++)i.push(Math.floor(Math.random()*e)),r[i[i.length-1]].push(u);var c=[];switch(n.metric){case"Euclidean":break;case"DTWD":for(var h=function(e){var i=t[r[e][Math.floor(Math.random()*r[e].length)]],o=0;if(n.window>0)for(var l=function(){for(var l=[],u=[],h=function(t){var e={};a.forEach((function(t){e[t]=0})),l.push(e),u.push(0)},d=0;d<s;d++)h();for(var f=function(o){for(var s=xp(bp(i,t[r[e][o]],a,n.window,n.distFunc)),c=function(n){a.forEach((function(i){l[s[n][0]][i]+=t[r[e][o]][s[n][1]][i]})),u[s[n][0]]++},h=0;h<s.length;h++)c(h)},p=0;p<r[e].length;p++)f(p);for(var g=0;g<l.length;g++)for(var v in l[g])l[g][v]/=u[g];if(!m(i,l))return c.push(l),"break";o++};o<10;){if("break"===l())break}else for(var u=function(){for(var l=[],u=[],h=function(t){var e={};a.forEach((function(t){e[t]=0})),l.push(e),u.push(0)},d=0;d<s;d++)h();for(var f=function(o){for(var s=xp(vp(i,t[r[e][o]],a,n.distFunc)),c=function(n){a.forEach((function(i){l[s[n][0]][i]+=t[r[e][o]][s[n][1]][i]})),u[s[n][0]]++},h=0;h<s.length;h++)c(h)},p=0;p<r[e].length;p++)f(p);for(var g=0;g<l.length;g++)for(var v in l[g])l[g][v]/=u[g];if(!m(i,l))return c.push(l),"break";o++};o<10;){if("break"===u())break}},d=0;d<r.length;d++)h(d);break;case"DTWI":for(var f=function(e){var i=t[r[e][Math.floor(Math.random()*r[e].length)]],o=0;if(n.window>0)for(var l=function(){for(var l=[],u=[],h=function(t){var e={},n={};a.forEach((function(t){e[t]=0,n[t]=0})),l.push(e),u.push(n)},d=0;d<s;d++)h();for(var f=function(o){var s=xp(yp(i,t[r[e][o]],a,n.window,n.distFunc));a.forEach((function(n){for(var i=0;i<s[n].length;i++)l[s[n][i][0]][n]+=t[r[e][o]][s[n][i][1]][n],u[s[n][i][0]][n]++}))},p=0;p<r[e].length;p++)f(p);for(var g=0;g<l.length;g++)for(var v in l[g])l[g][v]/=u[g][v];if(!m(i,l))return c.push(l),"break";o++};o<10;){if("break"===l())break}else for(var u=function(){for(var l=[],u=[],h=function(t){var e={},n={};a.forEach((function(t){e[t]=0,n[t]=0})),l.push(e),u.push(n)},d=0;d<s;d++)h();for(var f=function(o){var s=xp(gp(i,t[r[e][o]],a,n.distFunc));a.forEach((function(n){for(var i=0;i<s[n].length;i++)l[s[n][i][0]][n]+=t[r[e][o]][s[n][i][1]][n],u[s[n][i][0]][n]++}))},p=0;p<r[e].length;p++)f(p);for(var g=0;g<l.length;g++)for(var v in l[g])l[g][v]/=u[g][v];if(!m(i,l))return c.push(l),"break";o++};o<10;){if("break"===u())break}},p=0;p<r.length;p++)f(p)}return c;function m(t,e){for(var n=!1,i=0;i<t.length;i++){for(var r in a)if(t[i][r]!==e[i][r]){n=!0;break}if(n)break}return n}}(),f=Kf(y(d),2);u=f[0],r=f[1];for(var p=0;p<300&&x(u,h);){0!==c.length&&0!==h.length&&(d=c,u=h);var m=Kf(y(c=b(u,s)),2);h=m[0],r=m[1],p++}d=c,u=h;var g=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var i=0;i<u.length;i++)t[u[i].cluster].push(i);return t}();l.clusterRadiuses=function(t){for(var n=[],i=[],a=0;a<e;a++)i.push(0);for(var o=0;o<u.length;o++)i[u[o].cluster]+=r[o][u[o].cluster];for(var s=0;s<e;s++)n.push(i[s]/t[s]);return n}(g.map((function(t){return t.length})));var v=Kf(function(){var n,i=[];i=Array(t.length).fill(0);for(var a=0;a<g.length;a++)for(var s=0;s<g[a].length;s++){for(var l=0,u=0,c=void 0,h=1/0,d=0;d<e;d++)d!==a&&r[g[a][s]][d]<h&&(h=r[g[a][s]][d],c=d);for(var f=0;f<g[a].length;f++)if(g[a][s]!==g[a][f]){var p=Math.min(g[a][s],g[a][f]),m=Math.max(g[a][s],g[a][f]);l+=o[p][m-p-1]}l/=g[a].length-1;for(var v=0;v<g[c].length;v++){var y=Math.min(g[a][s],g[c][v]),b=Math.max(g[a][s],g[c][v]);u+=o[y][b-y-1]}u/=g[c].length,i[g[a][s]]=(u-l)/Math.max(l,u)}return n=i.reduce((function(t,e){return t+e}),0),[n/=i.length,i]}(),2);return l.silhouette=v[0],l.silhouetteSS=v[1],l.davisBouldin=function(){for(var t=0,e=0;e<g.length;e++){for(var i=-1/0,r=e+1;r<g.length;r++)if(e!==r)switch(n.metric){case"Euclidean":break;case"DTWD":if(n.window>0){var o=bp(d[e],d[r],a,n.window,n.distFunc),s=(l.clusterRadiuses[e]+l.clusterRadiuses[r])/o[o.length-1][o[0].length-1];i<s&&(i=s)}else{var u=vp(d[e],d[r],a,n.distFunc),c=(l.clusterRadiuses[e]+l.clusterRadiuses[r])/u[u.length-1][u[0].length-1];i<c&&(i=c)}break;case"DTWI":n.window>0?function(){var t=yp(d[e],d[r],a,n.window,n.distFunc),o=0;a.forEach((function(e){o+=t[e][t[e].length-1][t[e][0].length-1]}));var s=(l.clusterRadiuses[e]+l.clusterRadiuses[r])/o;i<s&&(i=s)}():function(){var t=gp(d[e],d[r],a,n.distFunc),o=0;a.forEach((function(e){o+=t[e][t[e].length-1][t[e][0].length-1]}));var s=(l.clusterRadiuses[e]+l.clusterRadiuses[r])/o;i<s&&(i=s)}()}isFinite(i)&&(t+=i)}return t/=g.length}(),[d,u,l];function y(i){for(var r=[],o=[],l=[],u=0;u<e;u++)l.push(0);for(var c=0;c<t.length;c++){var h=1/0,d=void 0,f=void 0;o.push([]);for(var p=function(e){var r=0;switch(n.metric){case"Euclidean":break;case"DTWD":n.window>0?(r=bp(i[e],t[c],a,n.window,n.distFunc),o[c].push(r[r.length-1][r[0].length-1]),r[r.length-1][r[0].length-1]<h&&(h=r[r.length-1][r[0].length-1],f=e,d=r)):(r=vp(i[e],t[c],a,n.distFunc),o[c].push(r[r.length-1][r[0].length-1]),r[r.length-1][r[0].length-1]<h&&(h=r[r.length-1][r[0].length-1],f=e,d=r));break;case"DTWI":if(n.window>0){r=yp(i[e],t[c],a,n.window,n.distFunc);var s=0;a.forEach((function(t){s+=r[t][r[t].length-1][r[t][0].length-1]})),o[c].push(s),s<h&&(h=s,f=e,d=r)}else{r=gp(i[e],t[c],a,n.distFunc);var l=0;a.forEach((function(t){l+=r[t][r[t].length-1][r[t][0].length-1]})),o[c].push(l),l<h&&(h=l,f=e,d=r)}}},m=0;m<i.length;m++)p(m);r.push({cluster:f,path:xp(d)}),l[f]++}for(var g=[],v=0;v<e;v++)0===l[v]&&function(){for(var e=-1,l=-1/0,u=0;u<o.length;u++)l<o[u][v]&&(e=u,l=o[u][v]);var c={};a.forEach((function(t){for(var e=[],n=0;n<s;n++)e.push([n,n]);c[t]=e})),g.push(e),r[e]={cluster:v,path:c};for(var h=[],d=function(n){var i={};a.forEach((function(n){i[n]=t[e][n]})),h.push(i)},f=0;f<t[e].length;f++)d();i[v]=h;for(var p=function(r){if(r===e)return o[e][v]=0,"continue";var s=0;switch(n.metric){case"Euclidean":break;case"DTWD":n.window>0?(s=bp(i[v],t[r],a,n.window,n.distFunc),o[r][v]=s[s.length-1][s[0].length-1]):(s=vp(i[v],t[r],a,n.distFunc),o[r][v]=s[s.length-1][s[0].length-1]);break;case"DTWI":if(n.window>0){s=yp(i[v],t[r],a,n.window,n.distFunc);var l=0;a.forEach((function(t){l+=s[t][s[t].length-1][s[t][0].length-1]})),o[r][v]=l}else{s=gp(i[v],t[r],a,n.distFunc);var u=0;a.forEach((function(t){u+=s[t][s[t].length-1][s[t][0].length-1]})),o[r][v]=u}}},m=0;m<t.length;m++)p(m)}();return[r,o]}function b(i,r){for(var o=[],s=0;s<e;s++)o.push([]);for(var l=0;l<i.length;l++)o[i[l].cluster].push(l);var u=[];switch(n.metric){case"Euclidean":break;case"DTWD":for(var c=function(e){for(var n=[],s=[],l=function(t){var e={};a.forEach((function(t){e[t]=0})),n.push(e),s.push(0)},c=0;c<r;c++)l();for(var h=function(r){for(var l=function(l){a.forEach((function(a){n[i[o[e][r]].path[l][0]][a]+=t[o[e][r]][i[o[e][r]].path[l][1]][a]})),s[i[o[e][r]].path[l][0]]++},u=0;u<i[o[e][r]].path.length;u++)l(u)},d=0;d<o[e].length;d++)h(d);for(var f=function(t){a.forEach((function(e){n[t][e]/=s[t]}))},p=0;p<n.length;p++)f(p);u.push(n)},h=0;h<o.length;h++)c(h);break;case"DTWI":for(var d=function(e){for(var n=[],s=[],l=function(t){var e={},i={};a.forEach((function(t){e[t]=0,i[t]=0})),n.push(e),s.push(i)},c=0;c<r;c++)l();for(var h=function(r){a.forEach((function(a){for(var l=0;l<i[o[e][r]].path[a].length;l++)n[i[o[e][r]].path[a][l][0]][a]+=t[o[e][r]][i[o[e][r]].path[a][l][1]][a],s[i[o[e][r]].path[a][l][0]][a]++}))},d=0;d<o[e].length;d++)h(d);for(var f=function(t){a.forEach((function(e){n[t][e],n[t][e]/=s[t][e]}))},p=0;p<n.length;p++)f(p);u.push(n)},f=0;f<o.length;f++)d(f)}return u}function x(t,e){var n=!1;if(0===t.length||0===e.length)return!0;for(var i=0;i<t.length;i++)if(t[i].cluster!==e[i].cluster){n=!0;break}return n}}function gp(t,e,n,i){var r={};n.forEach((function(n){for(var i=[],a=0;a<=t.length;a++){i[a]=[];for(var o=0;o<=e.length;o++)i[a][o]=1/0}i[0][0]=0,r[n]=i}));for(var a=function(a){for(var o=function(o){n.forEach((function(n){r[n][a][o]=i(t[a-1][n],e[o-1][n])+Math.min(r[n][a-1][o],r[n][a][o-1],r[n][a-1][o-1])}))},s=1;s<=e.length;s++)o(s)},o=1;o<=t.length;o++)a(o);var s={};return n.forEach((function(t){s[t]=[];for(var e=1;e<r[t].length;e++)s[t].push(r[t][e].slice(1,r[t][e].length))})),s}function vp(t,e,n,i){for(var r=[],a=0;a<=t.length;a++){r[a]=[];for(var o=0;o<=e.length;o++)r[a][o]=1/0}r[0][0]=0;for(var s=1;s<=t.length;s++)for(var l=1;l<=e.length;l++)r[s][l]=i(t[s-1],e[l-1],n)+Math.min(r[s-1][l],r[s][l-1],r[s-1][l-1]);for(var u=[],c=1;c<r.length;c++)u.push(r[c].slice(1,r[c].length));return u}function yp(t,e,n,i,r){var a={};i=Math.max(i,Math.abs(t.length-e.length)),n.forEach((function(n){for(var r=[],o=0;o<=t.length;o++){r[o]=[];for(var s=0;s<=e.length;s++)r[o][s]=1/0}r[0][0]=0;for(var l=1;l<=t.length;l++)for(var u=Math.max(1,l-i),c=Math.min(e.length,l+i),h=u;h<=c;h++)r[l][h]=0;a[n]=r}));for(var o=function(o){for(var s=Math.max(1,o-i),l=Math.min(e.length,o+i),u=function(i){n.forEach((function(n){a[n][o][i]=r(t[o-1][n],e[i-1][n])+Math.min(a[n][o-1][i],a[n][o][i-1],a[n][o-1][i-1])}))},c=s;c<=l;c++)u(c)},s=1;s<=t.length;s++)o(s);var l={};return n.forEach((function(t){l[t]=[];for(var e=1;e<a[t].length;e++)l[t].push(a[t][e].slice(1,a[t][e].length))})),l}function bp(t,e,n,i,r){var a=[];i=Math.max(i,Math.abs(t.length-e.length));for(var o=0;o<=t.length;o++){a[o]=[];for(var s=0;s<=e.length;s++)a[o][s]=1/0}a[0][0]=0;for(var l=1;l<=t.length;l++)for(var u=Math.max(1,l-i),c=Math.min(e.length,l+i),h=u;h<=c;h++)a[l][h]=0;for(var d=1;d<=t.length;d++)for(var f=Math.max(1,d-i),p=Math.min(e.length,d+i),m=f;m<=p;m++)a[d][m]=r(t[d-1],e[m-1],n)+Math.min(a[d-1][m],a[d][m-1],a[d-1][m-1]);for(var g=[],v=1;v<a.length;v++)g.push(a[v].slice(1,a[v].length));return g}function xp(t){if(Array.isArray(t)){var e,n=t.length-1,i=t[0].length-1;for(e=[[n,i]];n>0||i>0;)n>0?i>0?t[n-1][i]<t[n-1][i-1]?t[n-1][i]<t[n][i-1]?(e.push([n-1,i]),n--):(e.push([n,i-1]),i--):t[n-1][i-1]<t[n][i-1]?(e.push([n-1,i-1]),n--,i--):(e.push([n,i-1]),i--):(e.push([n-1,i]),n--):(e.push([n,i-1]),i--);return e}var r={};for(var a in t){var o=void 0,s=t[a].length-1,l=t[a][0].length-1;for(o=[[s,l]];s>0||l>0;)s>0?l>0?t[a][s-1][l]<t[a][s-1][l-1]?t[a][s-1][l]<t[a][s][l-1]?(o.push([s-1,l]),s--):(o.push([s,l-1]),l--):t[a][s-1][l-1]<t[a][s][l-1]?(o.push([s-1,l-1]),s--,l--):(o.push([s,l-1]),l--):(o.push([s-1,l]),s--):(o.push([s,l-1]),l--);r[a]=o}return r}function _p(t,e,n){if(Array.isArray(t)){for(var i=0,r=0;r<t.length;r++)i+=Math.pow(t[r]-e[r],2);return Math.sqrt(i)}if("number"==typeof t)return Math.abs(t-e);if("object"===Jf(t)){var a=0;return n.forEach((function(n){a+=Math.pow(t[n]-e[n],2)})),Math.sqrt(a)}}function wp(t){iu.dispatch({type:"SHOW_CLUSTER_DETAILS",cluster:t})}function Sp(t){iu.dispatch({type:"SHOW_FILTERING_STEP",selectedProcess:t})}function Ep(t,e){iu.dispatch({type:"UPDATE_SS_SELECTION",selectedSS:t,updatedSS:e})}function Mp(t){return(Mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Tp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tp(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tp(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function kp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ap(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Lp(t);if(e){var r=Lp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Op(this,n)}}function Op(t,e){return!e||"object"!==Mp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lp(t){return(Lp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pp(t,e)}(o,t);var e,n,i,a=Ap(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:dh.getMode(),normalize:!0,clusteringMethod:"kmedoids",distanceMetric:"DTW",medoidDefinition:"each",targetList:dh.getTarget(),filteringSS:["dataDrivenSlidingWindow","sameStartingPoint","overlappingDegree"]},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#targetLengthMinClustering").val(20),$("#targetLengthMaxClustering").val(30),$("#resolutionOfTimeNormalizedSS").val(30),$("#overlappingDegreeThreshold").val(70),$("#clusterNumber").val(6),dh.on("switchQueryMode",(function(e){t.setState({queryMode:e})})),dh.on("updateTarget",(function(){t.setState({targetList:dh.getTarget()})}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"clusteringSetting",className:"controllersElem featureArea"},this.subsequenceSetting(),this.variableSelector(),this.clusteringMethodsSetting(),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runAutomaticExtractionBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run"))}},{key:"subsequenceSetting",value:function(){var t;return this.state.filteringSS.indexOf("overlappingDegree")>=0&&(t=r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Threshold of overlapping degree"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"overlappingDegreeThreshold",style:{width:"40%",marginRight:"0.5rem"},required:!0}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," %")))),r.a.createElement("div",{className:"featureElem"},r.a.createElement("h5",null,"Subsequence setting"),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Length of the target time series"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"targetLengthMinClustering",style:{width:"20%",marginRight:"0.5rem"},required:!0}),"~",r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"targetLengthMaxClustering",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},required:!0}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"normalizeSwitchClustering",checked:this.state.normalize,onClick:this.onClickNormalize.bind(this)}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"normalizeSwitchClustering"},"Normalize"))),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"normalizationOptionsClustering",style:{width:"60%"},disabled:!this.state.normalize},r.a.createElement("option",{value:"zScore"},"z-score")))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Resolution of the time-normalized subsequences"),r.a.createElement("div",{className:"col form-inline"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"resolution",id:"resolutionOfTimeNormalizedSS",style:{width:"40%",marginRight:"0.5rem"},required:!0}),r.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Options of filtering subsequences"),r.a.createElement("div",{className:"col form-group",id:"filteringSSOptions",onChange:this.onChangeFilteringSS.bind(this)},r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"dataDrivenSlidingWindow",name:"filteringSS",value:"dataDrivenSlidingWindow",checked:this.state.filteringSS.indexOf("dataDrivenSlidingWindow")>=0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"dataDrivenSlidingWindow"},"Data-driven sliding window")),r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"SSFilterStartingPoint",name:"filteringSS",value:"sameStartingPoint",checked:this.state.filteringSS.indexOf("sameStartingPoint")>=0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"SSFilterStartingPoint"},"Representative of subsequences starting from the same data points")),r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"SSFilterOverlappingDegree",name:"filteringSS",value:"overlappingDegree",checked:this.state.filteringSS.indexOf("overlappingDegree")>=0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"SSFilterOverlappingDegree"},"Filtering out highly overlapping subsequences")))),t)}},{key:"onChangeFilteringSS",value:function(){for(var t=document.getElementsByName("filteringSS"),e=[],n=0;n<t.length;n++)t[n].checked&&e.push(t[n].value);this.setState({filteringSS:e})}},{key:"variableSelector",value:function(){var t=[],e={},n=dh.getTarget();if(n.length>0){for(var i=0;i<n.length;i++){var a=Gu.getData(n[i]).data.lookup;for(var o in a)if(o in e)for(var s=0;s<a[o].length;s++)e[o].indexOf(a[o][s])<0&&e[o].push(a[o][s]);else e[o]=a[o]}for(var l in e){var u="";"z"!==l&&"PA"!==l&&"PD"!==l&&(u=e[l].length>1?e[l].join(","):e[l][0],t.push(r.a.createElement("div",{className:"form-check form-check-inline",key:l},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"clusteringVariables",value:l,id:"clusteringVaribales_"+l}),r.a.createElement("label",{className:"form-check-label",htmlFor:"clusteringVaribales_"+l},u))))}}return r.a.createElement("div",{className:"featureElem"},r.a.createElement("h6",null,"Variables to be consideded"),t)}},{key:"clusteringMethodsSetting",value:function(){var t,e=r.a.createElement("div",{className:"form-group"},r.a.createElement("select",{className:"custom-select custom-select-sm",id:"clusteringMethod",style:{width:"60%"},onChange:this.onChangeClusteringMethod.bind(this)},r.a.createElement("option",{value:"kmedoids"},"kMedoids"),r.a.createElement("option",{value:"kmeans"},"kMeans")));switch(this.state.clusteringMethod){case"kmedoids":var n=r.a.createElement("form",{className:"form-check",id:"distanceMetricClustering",onChange:this.switchDistanceMetric.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"EuclideanClustering",name:"distanceMetricClustering",value:"Euclidean",checked:"Euclidean"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"EuclideanClustering"},"Euclidean")),r.a.createElement("div",{className:"custom-control custom-radio",style:{display:"each"===this.state.medoidDefinition?"block":"none"}},r.a.createElement("input",{type:"radio",id:"DTWClustering",name:"distanceMetricClustering",value:"DTW",checked:"DTW"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWClustering"},"DTW")),r.a.createElement("div",{className:"custom-control custom-radio",style:{display:"unified"===this.state.medoidDefinition?"block":"none"}},r.a.createElement("input",{type:"radio",id:"DTWIClustering",name:"distanceMetricClustering",value:"DTWI",checked:"DTWI"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWIClustering"},"DTW",r.a.createElement("sub",null,"I"))),r.a.createElement("div",{className:"custom-control custom-radio",style:{display:"unified"===this.state.medoidDefinition?"block":"none"}},r.a.createElement("input",{type:"radio",id:"DTWDClustering",name:"distanceMetricClustering",value:"DTWD",checked:"DTWD"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWDClustering"},"DTW",r.a.createElement("sub",null,"D")))),i=r.a.createElement("form",{className:"form-check",id:"medoidDefinition",onChange:this.switchMedoidDefinition.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"medoidEachVariable",name:"medoidDefinition",value:"each",checked:"each"===this.state.medoidDefinition,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"medoidEachVariable"},"Independent medoid for each variable")),r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"medoidAllVariables",name:"medoidDefinition",value:"unified",checked:"unified"===this.state.medoidDefinition,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"medoidAllVariables"},"Unified medoid for all variables")));t=r.a.createElement("div",{id:"clusteringOptions"},r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Cluster number"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"cluster number",id:"clusterNumber",style:{width:"50%",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Distance metric"),r.a.createElement("div",{className:"col"},n)),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Definition of medoids"),r.a.createElement("div",{className:"col"},i)));break;case"kmeans":t=r.a.createElement("div",{id:"clusteringOptions"},r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Cluster number"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"cluster number",id:"clusterNumber",style:{width:"50%",marginRight:"0.5rem"}}))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Distance metric"),r.a.createElement("div",{className:"col"},r.a.createElement("form",{className:"form-check",id:"distanceMetricClustering",onChange:this.switchDistanceMetric.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"EuclideanClustering",name:"distanceMetricClustering",value:"Euclidean",checked:"Euclidean"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"EuclideanClustering"},"Euclidean")),r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"DTWIClustering",name:"distanceMetricClustering",value:"DTWI",checked:"DTWI"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWIClustering"},"DTW",r.a.createElement("sub",null,"I"))),r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"DTWDClustering",name:"distanceMetricClustering",value:"DTWD",checked:"DTWD"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWDClustering"},"DTW",r.a.createElement("sub",null,"D")))))),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Cluster center definition"),r.a.createElement("div",{className:"col"},r.a.createElement("form",{className:"form-check",id:"clusterCenter",style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"DBA",name:"clusterCenter",value:"DBA",className:"custom-control-input",checked:!0,readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"DBA"},"DTW barycenter averaging"))))))}return r.a.createElement("div",{className:"featureElem"},r.a.createElement("h5",null,"Clustering settings"),r.a.createElement("div",{className:"row matchingOption"},r.a.createElement("div",{className:"col-5"},"Method"),r.a.createElement("div",{className:"col"},e)),t)}},{key:"switchDistanceMetric",value:function(){var t=$("input[name=distanceMetricClustering]:checked").val();this.setState({distanceMetric:t})}},{key:"switchMedoidDefinition",value:function(){var t=$("input[name=medoidDefinition]:checked").val();this.setState({distanceMetric:"each"===t?"DTW":"DTWD",medoidDefinition:t})}},{key:"onChangeClusteringMethod",value:function(){var t,e=document.getElementById("clusteringMethod"),n=e.selectedIndex,i=e.options[n].value;t=i,iu.dispatch({type:"CHANGE_CLUSTERING_METHOD",method:t}),this.setState({clusteringMethod:i,distanceMetric:"kmedoids"===i?"DTW":"DTWD"})}},{key:"onClickNormalize",value:function(){var t=this.state.normalize;this.setState({normalize:!t})}},{key:"clickRunButton",value:function(){for(var t=[],e=0;e<this.state.targetList.length;e++)t.push(Gu.getData(this.state.targetList[e]));for(var n,i=[],r=document.getElementsByName("clusteringVariables"),a=0;a<r.length;a++)r[a].checked&&i.push(r[a].value);switch(this.state.clusteringMethod){case"kmedoids":n={method:"kmedoids",clusterNum:Number($("#clusterNumber").val()),medoidDefinition:this.state.medoidDefinition,distanceMetric:this.state.distanceMetric,window:0,variables:i};break;case"kmeans":n={method:"kmeans",clusterNum:Number($("#clusterNumber").val()),distanceMetric:this.state.distanceMetric,window:0,clusterCenter:$("input[name=clusterCenter]:checked").val(),variables:i}}var o={};o.filtering=this.state.filteringSS,o.SSperiod=[Number($("#targetLengthMinClustering").val()),Number($("#targetLengthMaxClustering").val())],o.isometryLen=Number($("#resolutionOfTimeNormalizedSS").val()),o.normalize=this.state.normalize,this.state.filteringSS.indexOf("overlappingDegree")>=0&&(o.overlappingTh=Number($("#overlappingDegreeThreshold").val()));for(var s=Cp(function(t,e,n){var i=e.variables.slice();i.push("z");for(var r={},a={},o={},s=0;s<t.length;s++){for(var l=[],u=0;u<t[s].data.spatial.length;u++){var c={};c.z=t[s].data.spatial[u].z;for(var h=0;h<i.length;h++)c[i[h]]=t[s].data.spatial[u][i[h]];l.push(c)}r[t[s].id]=l,a[t[s].id]=t[s].data.meta.min,o[t[s].id]=t[s].data.meta.max}var d,f,p={},m=[],g=[],v={};if(n.filtering.indexOf("dataDrivenSlidingWindow")>=0){var y=function(t,e){var n={};for(var i in t){for(var r=[],a=0;a<t[i].length;a++)for(var o=a;o<t[i].length;o++){var s=t[i][o].z-t[i][a].z;if(s>e[1])break;e[0]<=s&&s<=e[1]&&r.push([a,o])}n[i]=r}return n}(r,n.SSperiod);for(var b in v.dataDrivenSlidingWindow={},y){p[b]=[],v.dataDrivenSlidingWindow[b]=[];for(var x=0;x<y[b].length;x++)p[b].push(x),v.dataDrivenSlidingWindow[b].push(x)}var _=Kf(op(r,y,n.isometryLen,n.normalize,a,o),2);if(d=_[0],f=_[1],v.subsequences=d,n.filtering.indexOf("sameStartingPoint")>=0)for(var w in v.sameStartingPoint={},y){for(var S=0,E=[];S<y[w].length;){var M=y[w][S][0],C=S;for(S++;S<y[w].length&&y[w][S][0]==M;)if(f[w][C]<f[w][S])C=S,S++;else{if(S+1<y[w].length&&y[w][S+1][0]!==M)break;S++}E.push(C),S++}p[w]=E,v.sameStartingPoint[w]=E}if(n.filtering.indexOf("overlappingDegree")>=0&&(v.overlappingDegree={},n.overlappingTh>0))for(var T in y){for(var k=[],P=0;P<p[T].length;){for(var A=y[T][p[T][P]],O=p[T][P],L=P+1;L<p[T].length;){var R=cp(A,y[T][p[T][L]]);if(R<n.overlappingTh)break;R>=n.overlappingTh&&(f[O]<f[p[T][L]]?O=p[T][L]:f[O]===f[p[T][L]]&&(O=y[T][p[T][P]][1]-y[T][p[T][P]][0]<y[T][p[T][L]][1]-y[T][p[T][L]][0]?p[T][L]:p[T][P])),L++}k.push(O),P=L}p[T]=k,v.overlappingDegree[T]=k}for(var I in p)for(var N=0;N<p[I].length;N++){var D=d[I][p[I][N]];m.push(D),g.push(y[I][p[I][N]])}}else{v.normalSlidingWindow={};for(var z=0;z<t.length;z++){var B=t[z].id,F=Gu.getDataArray(B,1),V=rp(F=ap(F,i),n.SSperiod);p[B]=[],v.normalSlidingWindow[B]=[];for(var j=0;j<V.length;j++)p[B].push(j),v.normalSlidingWindow[B].push(j);var U=Kf(op(F,V,n.isometryLen,n.normalize,a[B],o[B]),2);if(d=U[0],f=U[1],v.subsequences=d,n.filtering.indexOf("sameStartingPoint")>=0){var H=0,G=[];for(v.sameStartingPoint={};H<V.length;){var W=V[H][0],q=H;for(H++;H<V.length&&V[H][0]==W;)if(f[q]<f[H])q=H,H++;else{if(H+1<V.length&&V[H+1][0]!==W)break;H++}G.push(q),H++}p[B]=G,v.sameStartingPoint[B]=G}if(n.filtering.indexOf("overlappingDegree")>=0&&(v.overlappingDegree={},n.overlappingTh>0)){for(var $=[],Q=0;Q<p[B].length;){for(var Y=V[p[B][Q]],X=p[B][Q],Z=Q+1;Z<p[B].length;){var J=cp(Y,V[p[B][Z]]);if(J<n.overlappingTh)break;J>=n.overlappingTh&&(f[X]<f[p[B][Z]]?X=p[B][Z]:f[X]===f[p[B][Z]]&&(X=V[B][p[B][Q]][1]-V[B][p[B][Q]][0]<V[B][p[B][Z]][1]-V[B][p[B][Z]][0]?p[B][Z]:p[B][Q])),Z++}$.push(X),Q=Z}p[B]=$,v.overlappingDegree[B]=$}for(var K=0;K<p[B].length;K++){var tt=d[p[B][K]];m.push(tt),g.push(V[p[B][K]])}}}var et,nt,it,rt={window:e.window,metric:e.distanceMetric,distFunc:_p};switch(e.method){case"kmedoids":if("unified"===e.medoidDefinition){var at=Kf(pp(m,e.clusterNum,rt,i),3);et=at[0],nt=at[1],it=at[2]}else if("each"===e.medoidDefinition){var ot=Kf(fp(m,e.clusterNum,rt,i),3);et=ot[0],nt=ot[1],it=ot[2]}break;case"kmeans":var st=Kf(mp(m,e.clusterNum,rt,i),3);et=st[0],nt=st[1],it=st[2]}var lt=dp(m,rt,i.filter((function(t){return"z"!==t})),n.isometryLen),ut=np(nt,e.clusterNum);return it.pseudoF=ip(it.clusterRadiuses,et,lt,ut.map((function(t){return t.length})),rt,i.filter((function(t){return"z"!==t}))),[m,g,et,nt,it,v]}(t,n,o),6),l=s[0],u=s[1],c=s[2],h=s[3],d=s[4],f=s[5],p=[],m=0;m<t.length;m++)p.push(t[m].id);Kc("none"),$("#clusteringResults").css("width","100%"),function(t,e,n,i,r,a,o,s,l){iu.dispatch({type:"SHOW_CLUSTERING_RESULTS",datasets:t,subsequences:e,ranges:n,clusterCenters:i,labels:r,clusteringParameters:a,subsequenceParameters:o,clusteringScores:s,filteringProcess:l})}(p,l,u,c,h,n,o,d,f)}}])&&kp(e.prototype,n),i&&kp(e,i),o}(r.a.Component);function Ip(t){return(Ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Np(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dp(t,e){return(Dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Fp(t);if(e){var r=Fp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Bp(this,n)}}function Bp(t,e){return!e||"object"!==Ip(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fp(t){return(Fp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dp(t,e)}(o,t);var e,n,i,a=zp(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:dh.getMode()},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;dh.on("switchQueryMode",(function(e){t.setState({queryMode:e})})),dh.on("recoverQuery",(function(e){var n=dh.getMode();t.setState({queryMode:n});var i=$("#automaticExtraction"),r=$("#visualQuery"),a=$("#clusteringSetting");"AE"===n?(i.hasClass("active")||i.addClass("show").addClass("active"),r.hasClass("active")&&r.removeClass("show").removeClass("active"),a.hasClass("active")&&a.removeClass("show").removeClass("active")):"QBE"!==n&&"QBS"!==n||(r.hasClass("active")||r.addClass("show").addClass("active"),i.hasClass("active")&&i.removeClass("show").removeClass("active"),a.hasClass("active")&&a.removeClass("show").removeClass("active"));for(var o=$("input[name=targetList]"),s=0;s<o.length;s++)o[s].checked=!0}))}},{key:"selectTabAE",value:function(){Ic("AE")}},{key:"selectTabClustering",value:function(){Ic("Clustering")}},{key:"updateTargets",value:function(){for(var t,e=$("input[name=targetList]:checked"),n=[],i=0;i<e.length;i++)n.push(Number(e[i].value));t=n,iu.dispatch({type:"UPDATE_TARGET",ids:t})}},{key:"clickCloseExtractionMenu",value:function(){Kc(),au()}},{key:"render",value:function(){var t=Gu.getAllIdsFileNames().map((function(t){return r.a.createElement("label",{className:"form-check form-check-inline",htmlFor:"inlineCheckbox1",key:t.id},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"targetList",id:"checkboxTarget"+t.id,value:t.id,key:t.id}),t.name)}));return r.a.createElement("div",{id:"extractionMenu",className:"featureColumn",style:{float:"left",position:"relative"}},r.a.createElement("div",{id:"extractionMainMenu"},r.a.createElement("div",{id:"targetDatasetsList",className:"controllersElem"},r.a.createElement("h5",null,"Target"),r.a.createElement("form",{onChange:this.updateTargets.bind(this)},t)),r.a.createElement("ul",{className:"nav nav-tabs"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link active","data-toggle":"tab",href:"#automaticExtraction",onClick:this.selectTabAE},"Automatic Extraction")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#visualQuery"},"Visual Query")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#clustering",onClick:this.selectTabClustering},"Clustering"))),r.a.createElement("div",{id:"extractionMenuTabs",className:"tab-content"},r.a.createElement("div",{className:"tab-pane fade show active",id:"automaticExtraction"},r.a.createElement(Xf,null)),r.a.createElement("div",{className:"tab-pane fade",id:"visualQuery"},r.a.createElement(Hf,null)),r.a.createElement("div",{className:"tab-pane fade",id:"clustering"},r.a.createElement(Rp,null)))),r.a.createElement("button",{id:"collapseExtractionMenu",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",top:"0px",right:"-4rem",zIndex:100},onClick:this.clickCloseExtractionMenu},"Close"))}}])&&Np(e.prototype,n),i&&Np(e,i),o}(r.a.Component);function jp(t){return(jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Up(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Hp(t,e){return(Hp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=qp(t);if(e){var r=qp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Wp(this,n)}}function Wp(t,e){return!e||"object"!==jp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qp(t){return(qp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hp(t,e)}(o,t);var e,n,i,a=Gp(o);function o(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:30,bottom:30,right:30,left:60},e.tickWidth=10,e.id=t.id,e.item=t.item,e.itemName=Gu.getData(e.id).data.lookup[e.item],void 0===e.itemName&&(e.itemName=e.item),e.query=t.query,e.target=t.target,e.path=t.path,e.filter=!1,e.query.indexOf(null)>=0&&(e.filter=!0),e.yMinMax,e.filter){var n=e.query.filter((function(t){return null!==t}));if(n.length>0){for(var i=n[0][0],r=n[0][1],s=1;s<n.length;s++)n[s][0]<i&&(i=n[s][0]),r<n[s][1]&&(r=n[s][1]);e.yMinMax=[Math.min(i,Math.min.apply(null,e.target)),Math.max(r,Math.max.apply(null,e.target))]}else e.yMinMax=[Math.min.apply(null,e.target),Math.max.apply(null,e.target)]}else{var l=Math.min.apply(null,e.query),u=Math.max.apply(null,e.query);"PA"===e.item&&(l/=2,u/=2),"PD"===e.item&&(l*=100,u*=100),e.yMinMax=[Math.min(l,Math.min.apply(null,e.target)),Math.max(u,Math.max.apply(null,e.target))]}return e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"componentDidMount",value:function(){this.initLineChart()}},{key:"componentWillUnmount",value:function(){}},{key:"initLineChart",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;if(this.parentArea=se("#lineChartArea_"+this.item),this.svg=this.parentArea.append("svg").attr("id","lineChart_"+this.item).attr("class","lineChart").attr("width",this.state.width).attr("height",this.state.height),this.graphName=this.svg.append("text").attr("x",this.margin.left+t/2).attr("y",this.margin.top).attr("text-anchor","middle").style("fill","black").style("font-size","0.8rem").text(this.itemName),this.xScale=Ca().domain([0,this.filter?this.target.length-1:Math.max(this.query.length-1,this.target.length-1)]).nice().range([0,t]),this.xLabel=V(this.xScale).tickFormat(ud),this.xAxis=this.svg.append("g").attr("class","x_axis").attr("transform","translate("+this.margin.left+","+(this.margin.top+e)+")").call(this.xLabel),this.yScale=Ca().domain(this.yMinMax).nice().range([e,0]),this.yLabel=j(this.yScale).ticks(5).tickFormat(ud),this.yAxis=this.svg.append("g").attr("class","y_axis").attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.yLabel),this.filter){for(var n=[],i=0;i<this.query.length;i++)if(this.query[i])for(var r=0;r<this.path.length&&!(this.path[r][1]<i);r++)this.path[r][1]===i&&n.push({x:this.path[r][0],range:this.query[i]});this.ranges=this.svg.selectAll("line.filteredRange").data(n).enter().append("line").attr("class","filteredRange").attr("x1",function(t){return this.xScale(t.x)}.bind(this)).attr("x2",function(t){return this.xScale(t.x)}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeTop=this.svg.selectAll("line.filteredRangeTop").data(n).enter().append("line").attr("class","filteredRangeTop").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[0])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeBottom=this.svg.selectAll("line.filteredRangeBottom").data(n).enter().append("line").attr("class","filteredRangeBottom").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[1])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}else this.queryPath=this.svg.append("path").datum(this.query).attr("fill","none").attr("stroke","#80b139").attr("stroke-width",1.5).attr("id","lineChartQuery_"+this.item).attr("d",Us().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){var e=t;return"PA"===this.item&&(e/=2),"PD"===this.item&&(e*=100),this.yScale(e)}.bind(this))).attr("transform","translate("+this.margin.left+","+this.margin.top+")");this.targetPath=this.svg.append("path").datum(this.target).attr("fill","none").attr("stroke","#f26418").attr("stroke-width",1.5).attr("id","lineChartTarget_"+this.item).attr("d",Us().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){return this.yScale(t)}.bind(this))).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}},{key:"updateLineChart",value:function(){if(this.id=this.props.id,this.item=this.props.item,this.query=this.props.query,this.target=this.props.target,this.path=this.props.path,this.filter=!1,this.query.indexOf(null)>=0&&(this.filter=!0),this.filter){var t=this.query.filter((function(t){return null!==t}));if(t.length>0){for(var e=t[0][0],n=t[0][1],i=1;i<t.length;i++)t[i][0]<e&&(e=t[i][0]),n<t[i][1]&&(n=t[i][1]);this.yMinMax=[Math.min(e,Math.min.apply(null,this.target)),Math.max(n,Math.max.apply(null,this.target))]}else this.yMinMax=[Math.min.apply(null,this.target),Math.max.apply(null,this.target)]}else this.yMinMax=[Math.min(Math.min.apply(null,this.query),Math.min.apply(null,this.target)),Math.max(Math.max.apply(null,this.query),Math.max.apply(null,this.target))];this.svg.selectAll("line.filteredRange").remove(),this.svg.selectAll("line.filteredRangeTop").remove(),this.svg.selectAll("line.filteredRangeBottom").remove(),this.changeLineChart()}},{key:"changeLineChart",value:function(){if(this.xScale.domain([0,Math.max(this.query.length,this.target.length)]).nice(),this.xLabel=V(this.xScale).tickFormat(ud),this.xAxis.call(this.xLabel),this.yScale.domain(this.yMinMax).nice(),this.yLabel=j(this.yScale).ticks(5).tickFormat(ud),this.yAxis.call(this.yLabel),this.filter){for(var t=[],e=0;e<this.query.length;e++)if(this.query[e])for(var n=0;n<this.path.length&&!(this.path[n][1]<e);n++)this.path[n][1]===e&&t.push({x:this.path[n][0],range:this.query[e]});this.ranges=this.svg.selectAll("line.filteredRange").data(t).enter().append("line").attr("class","filteredRange").attr("x1",function(t){return this.xScale(t.x)}.bind(this)).attr("x2",function(t){return this.xScale(t.x)}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeTop=this.svg.selectAll("line.filteredRangeTop").data(t).enter().append("line").attr("class","filteredRangeTop").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[0])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeBottom=this.svg.selectAll("line.filteredRangeBottom").data(t).enter().append("line").attr("class","filteredRangeBottom").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[1])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}else this.queryPath.datum(this.query).attr("d",Us().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){var e=t;return"PA"===this.item&&(e/=2),"PD"===this.item&&(e*=100),this.yScale(e)}.bind(this)));this.targetPath.datum(this.target).attr("d",Us().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){return this.yScale(t)}.bind(this)))}},{key:"render",value:function(){return document.getElementById("lineChartArea_"+this.item)&&this.updateLineChart(),r.a.createElement("div",{id:"lineChartArea_"+this.item})}}])&&Up(e.prototype,n),i&&Up(e,i),o}(r.a.Component);function Qp(t){return(Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xp(t,e){return(Xp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Kp(t);if(e){var r=Kp(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Jp(this,n)}}function Jp(t,e){return!e||"object"!==Qp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kp(t){return(Kp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var tm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xp(t,e)}(o,t);var e,n,i,a=Zp(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).data=Gu.getData(t.id),e.margin={left:20,right:20},e.importedFlag=t.importedFlag,e.divId=e.importedFlag?"resultTimeline_"+t.id+"_imported":"resultTimeline_"+t.id,e.state={id:t.id,results:t.results,importedResults:[],height:t.height,width:0},e.resultsVQ=null,e.resultsFlare=null,e.resultsRotation=null,e.resultsAnomaly=null,e}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{id:this.divId,className:"timeline"})}},{key:"componentDidMount",value:function(){var t=this;this.initializeTimeline(),this.setUpTimeline(),dh.on("updateShownResults",(function(e){t.updateTimeline()})),dh.on("switchQueryMode",(function(e){t.setState({width:$("#resultTimelineArea_"+t.state.id).width()}),t.resizeTimeLine()})),mu.on("resizeExtractionResultsArea",(function(){t.setState({width:$("#resultTimelineArea_"+t.state.id).width()}),t.resizeTimeLine()})),dh.on("recoverQuery",(function(e){"QBE"===dh.getMode()&&t.state.results.length>0&&(t.setState({width:Math.max($("#resultTimelineArea_"+t.state.id).width(),400)}),t.resizeTimeLine())}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById(this.divId);if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"initializeTimeline",value:function(){this.svg=se("#"+this.divId).append("svg").attr("id","resultTimelineSVG_"+this.state.id),this.xScale=Ca().domain([this.data.data.meta.min.z,this.data.data.meta.max.z]),this.xAxis=this.svg.append("g").attr("class","x-axis"),this.tooltip=se("#"+this.divId).append("div").attr("class","tooltip").attr("id","tooltipResultTimeline_"+this.state.id).style("opacity",.75).style("visibility","hidden")}},{key:"updateTimeline",value:function(){this.data=Gu.getData(this.props.id),this.setState({id:this.props.id,results:this.props.results,height:this.props.height}),this.resultsVQ=null,this.resultsFlare=null,this.resultsRotation=null,this.resultsAnomaly=null,this.setUpTimeline()}},{key:"setUpTimeline",value:function(){var t=$("#resultTimelineArea_"+this.state.id).width(),e=this.state.height;this.setState({width:t});var n=t-this.margin.left-this.margin.right,i=e;this.svg.attr("width",t).attr("height",e),this.xScale.domain([this.data.data.meta.min.z,this.data.data.meta.max.z]).nice().range([0,n]),this.xLabel=V(this.xScale).ticks(10).tickSize(10),this.xAxis.attr("transform","translate("+this.margin.left+","+(i/2-5)+")").call(this.xLabel);var r=this.state.results.filter((function(t){return void 0!==t.distance})),a=this.state.results.filter((function(t){return t.angle})),o=[];this.state.results.forEach((function(t){t.V?o=o.concat(t):t.flares&&(o=o.concat(t.flares))}));var s=this.state.results.filter((function(t){return t.anomalyDegree}));this.svg.selectAll("line.resultsVQ").remove(),this.svg.selectAll("line.resultsRotation").remove(),this.svg.selectAll("circle.resultsFlare").remove(),this.svg.selectAll("circle.resultsAnomaly").remove(),r.length>0&&(this.resultsVQ=this.svg.selectAll("line.resultsVQ").data(r).enter().append("line").attr("class","resultsVQ").attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("y1",i/2-5).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)).attr("y2",i/2-5).attr("stroke",this.importedFlag?"#1d33c6":"#1d95c6").attr("stroke-width",20).attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),a.length>0&&(this.resultsRotation=this.svg.selectAll("line.resultsRotation").data(a).enter().append("line").attr("class","resultsRotation").attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("y1",i/2-5).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)).attr("y2",i/2-5).attr("stroke",this.importedFlag?"#b1a639":"#80b139").attr("stroke-width",20).attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),o.length>0&&(this.resultsFlare=this.svg.selectAll("circle.resultsFlare").data(o).enter().append("circle").attr("class","resultsFlare").attr("cx",function(t){return this.xScale(t.start)}.bind(this)).attr("cy",i/2-5).attr("r",10).attr("fill",this.importedFlag?"#f2d118":"#f26418").attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),s.length>0&&(this.resultsAnomaly=this.svg.selectAll("circle.resultsAnomaly").data(s).enter().append("circle").attr("class","resultsAnomaly").attr("cx",function(t){return this.xScale(t.start)}.bind(this)).attr("cy",i/2-5).attr("r",10).attr("fill",this.importedFlag?"#f2d118":"#d23430").attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick()))}},{key:"resizeTimeLine",value:function(){var t=$("#resultTimelineArea_"+this.state.id).width(),e=t-this.margin.left-this.margin.right;this.svg.attr("width",t),this.xScale.range([0,e]),this.xLabel=V(this.xScale).ticks(10).tickSize(10),this.xAxis.call(this.xLabel),this.resultsVQ&&this.resultsVQ.attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)),this.resultsRotation&&this.resultsRotation.attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)),this.resultsFlare&&this.resultsFlare.attr("cx",function(t){return this.xScale(t.start)}.bind(this)),this.resultsAnomaly&&this.resultsAnomaly.attr("cx",function(t){return this.xScale(t.start)}.bind(this))}},{key:"timelineMouseOver",value:function(){var t=this.tooltip,e=this.xScale,n=this.svg.attr("width");return function(i){var r=se(this);r.attr("stroke")?r.attr("stroke","#284a6c").moveToFront():r.attr("fill")&&r.attr("fill","#284a6c").moveToFront(),t.transition().duration(50).style("visibility","visible");var a,o="";for(var s in i)if("id"!==s&&"start"!==s&&"period"!==s&&"flares"!==s&&"path"!==s){var l=i[s];if("object"===Qp(i[s])){for(var u in l="(",i[s])l+=cd(i[s][u])+", ";l=l.slice(0,l.length-2),l+=")"}else"number"==typeof i[s]&&(l=cd(i[s]));o+="<tr><td>"+ih(s)+"</td><td>"+l+"</td></tr>"}if(e(i.start)<n/2)t.html("<table><tbody>"+o+"</tbody></table>").style("left",e(i.start)+50+"px").style("top","10px");else{var c=Number(t.style("width").slice(0,-2));t.html("<table><tbody>"+o+"</tbody></table>").style("left",e(i.start)-c+20+"px").style("top","10px")}a=i,iu.dispatch({type:"FOCUS_RESULT_FROM_TIMELINE",result:a})}}},{key:"timelineImportedResultsMouseOver",value:function(){var t=this.tooltip,e=this.xScale,n=this.svg.attr("width");return function(i){var r=se(this);r.attr("stroke")?r.attr("stroke","#28286c").moveToFront():r.attr("fill")&&r.attr("fill","#28286c").moveToFront(),t.transition().duration(50).style("visibility","visible");var a="";for(var o in i)if("fileName"!==o&&"path"!==o){var s=i[o];if(Array.isArray(i[o]))s=i[o].join(", ");else if("object"===Qp(i[o])){for(var l in s="(",i[o])s+=cd(i[o][l])+", ";s=s.slice(0,s.length-2),s+=")"}else"number"==typeof i[o]&&(s=cd(i[o]));a+="<tr><td>"+ih(o)+"</td><td>"+s+"</td></tr>"}if(e(i.start)<n/2)t.html("<table><tbody>"+a+"</tbody></table>").style("left",e(i.start)+50+"px").style("top","10px");else{var u=Number(t.style("width").slice(0,-2));t.html("<table><tbody>"+a+"</tbody></table>").style("left",e(i.start)-u+20+"px").style("top","10px")}}}},{key:"timelineMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);e.distance?n.attr("stroke","#1d95c6"):e.angle?n.attr("stroke","#80b139"):e.V?n.attr("fill","#f26418"):e.anomalyDegree&&n.attr("fill","#d23430"),t.transition().duration(100).style("visibility","hidden")}}},{key:"timelineImportedReusltsMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);e.distance?n.attr("stroke","#1d33c6"):e.angle?n.attr("stroke","#b1a639"):(e.V||e.anomalyDegree)&&n.attr("fill","#f2d118"),t.transition().duration(100).style("visibility","hidden")}}},{key:"timelineClick",value:function(){return function(t){var e;e=t,iu.dispatch({type:"SELECT_RESULT_FROM_TIMELINE",result:e})}}}])&&Yp(e.prototype,n),i&&Yp(e,i),o}(r.a.Component);function em(t){return(em="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nm(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function im(t,e){return(im=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=om(t);if(e){var r=om(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return am(this,n)}}function am(t,e){return!e||"object"!==em(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function om(t){return(om=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sm=n(360),lm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&im(t,e)}(o,t);var e,n,i,a=rm(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).height=100,e.margin={left:30,right:10,top:5,bottom:22},e.results=[],e.bins=[],e.dragFlag=!1,e.handleFlag=!1,e}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{id:"distanceHistogram",style:{width:"100%"}})}},{key:"componentDidMount",value:function(){var t=this;this.initHistogram(),mu.on("resizeExtractionResultsArea",(function(){t.results.length>0&&t.updateHistogram()})),dh.on("updateShownResults",(function(){var e=dh.getParameters(),n=dh.getQuery();e&&"visual query"===n.mode&&(t.results=dh.getExtractionResults(),t.updateHistogram())})),dh.on("recoverQuery",(function(e){"QBE"===dh.getMode()&&t.results.length>0&&t.updateHistogram()}))}},{key:"initHistogram",value:function(){this.svg=se("#distanceHistogram").append("svg").attr("id","distanceHistogramSVG"),this.xScale=Ca(),this.xAxis=this.svg.append("g").attr("class","x-axis"),this.yScale=Ca(),this.yAxis=this.svg.append("g").attr("class","y-axis"),this.brushRect=this.svg.append("rect").attr("id","brushingRectHistogram").style("fill","rgb(119, 119, 119)").style("fill-opacity",.3),this.brushLine=this.svg.append("line").attr("id","brushingLineHistogram").attr("stroke","#80b139").attr("stroke-width",4),this.horizontalLine=this.svg.append("line").attr("id","horizontalLineHistogram").attr("stroke","orange").attr("stroke-width",2).attr("fill","none").style("visibility","hidden")}},{key:"updateHistogram",value:function(){var t=Math.max($("#distanceHistogram").width(),400),e=t-this.margin.left-this.margin.right,n=this.height-this.margin.top-this.margin.bottom;this.svg.attr("width",t).attr("height",this.height);var i=p(this.results,(function(t){return t.distance}));this.xScale.domain(i).range([0,e]).nice(),this.xLabel=V(this.xScale).tickFormat(ud),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+n)+")").call(this.xLabel);var r=T().value((function(t){return t.distance})).domain(this.xScale.domain()).thresholds(this.xScale.ticks(Math.min(20,Math.floor(this.results.length/4))));this.bins=r(this.results),this.yScale.range([n,0]).domain([0,k(this.bins,(function(t){return t.length}))]),this.yLabel=j(this.yScale).ticks(5),this.yAxis.attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.yLabel),this.svg.selectAll("rect.histogramRect").remove(),this.bars=this.svg.selectAll("rect.histogramRect").data(this.bins).enter().append("rect").attr("class","histogramRect").attr("x",1).attr("transform",function(t){return"translate("+(this.xScale(t.x0)+this.margin.left)+","+(this.yScale(t.length)+this.margin.top)+")"}.bind(this)).attr("width",function(t){return this.xScale(t.x1)-this.xScale(t.x0)-1}.bind(this)).attr("height",function(t){return n-this.yScale(t.length)}.bind(this)).style("fill","#284a6c").style("opacity",.75).on("mouseover",this.mouseOverOnHistogram()).on("mouseout",this.mouseOutFromHistogram());for(var a=dh.getKValue(),o=0,s=0;s<this.bins.length;s++){if(o+this.bins[s].length>=a){var l=this.xScale(this.bins[s].x0+(this.bins[s].x1-this.bins[s].x0)/this.bins[s].length*(a-o));this.brushRect.attr("x",this.margin.left).attr("y",this.margin.top).attr("width",l).attr("height",this.yScale(0)),this.brushLine.attr("x1",l+this.margin.left).attr("y1",this.margin.top).attr("x2",l+this.margin.left).attr("y2",this.yScale(0)+this.margin.top);break}o+=this.bins[s].length}var u=pr().on("start",this.dragStartOnHistogram()).on("drag",this.dragOnHistogram()).on("end",this.dragEndOnHistogram());this.brushLine.call(u),sm.element(this.brushLine.node()).toTop()}},{key:"mouseOverOnHistogram",value:function(){var t=this.horizontalLine,e=this.xScale,n=this.yScale,i=this.margin;return function(r){Ds("rect.histogramRect").style("fill","#7b7971"),se(this).style("fill","#284a6c"),t.attr("x1",e(e.domain()[0])+i.left).attr("y1",n(r.length)+i.top).attr("x2",e(r.x1)+i.left).attr("y2",n(r.length)+i.top).style("visibility","visible"),sm.element(t.node()).toTop()}}},{key:"mouseOutFromHistogram",value:function(){var t=this.horizontalLine;return function(e){Ds("rect.histogramRect").style("fill","#284a6c"),t.style("visibility","hidden")}}},{key:"dragStartOnHistogram",value:function(){return function(){se(this).classed("brushingLineHistogram",!0)}}},{key:"dragOnHistogram",value:function(){var t=this.margin,e=this.xScale.range(),n=this.xScale,i=this.bins;return function(){var r=se("#brushingLineHistogram"),a=$t.x;a<=t.left?a=t.left:t.left+e[1]<=a&&(a=t.left+e[1]),r.attr("x1",a).attr("x2",a),se("rect#brushingRectHistogram").attr("width",a-t.left);for(var o=se("rect#brushingRectHistogram").attr("width"),s=n.invert(o),l=0,u=0;u<i.length;u++)if(i[u].x1<=s)l+=i[u].length;else if(i[u].x0<=s&&s<=i[u].x1){var c=s-i[u].x0;l+=Math.ceil(i[u].length*c/(i[u].x1-i[u].x0));break}$("#topKLabelResults").text("Top "+l+" results")}}},{key:"dragEndOnHistogram",value:function(){var t=this.xScale,e=this.bins;return function(){se(this).classed("brushingLineHistogram",!0);for(var n=se("rect#brushingRectHistogram").attr("width"),i=t.invert(n),r=0,a=0;a<e.length;a++)if(e[a].x1<=i)r+=e[a].length;else if(e[a].x0<=i&&i<=e[a].x1){var o=i-e[a].x0;r+=Math.ceil(e[a].length*o/(e[a].x1-e[a].x0));break}Vc(r),$("#topKResults").val(r),$("#topKLabelResults").text("Top "+r+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){Pf()}.bind(this),0)}}}])&&nm(e.prototype,n),i&&nm(e,i),o}(r.a.Component);function um(t){return(um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cm(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function hm(t,e){return(hm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=pm(t);if(e){var r=pm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fm(this,n)}}function fm(t,e){return!e||"object"!==um(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pm(t){return(pm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hm(t,e)}(o,t);var e,n,i,a=dm(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).LCWidth=300,e.LCHeight=200,e.optimalWarpPath=null,e.state={shownResults:[],LC:[],selected:{},accessibility:"private",mode:dh.getMode(),AEOptions:dh.getAEOptions(),importedResults:{}},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#topKResults").val(20),dh.on("setExtractionResults",(function(){t.setState({selected:{}}),"block"===$("#resultDetailArea").css("display")&&eh()})),dh.on("showLineCharts",(function(e){t.setState({LC:e})})),dh.on("updateSelectedResult",(function(e,n,i){t.LCWidth=Math.max(300,n),t.LCHeight=Math.max(200,i),e.path&&(t.optimalWarpPath=e.path),t.setState({selected:e})})),dh.on("clearResults",(function(){t.setState({shownResults:[],importedResults:{}})})),dh.on("updateShownResults",(function(e){t.setState({shownResults:e,importedResults:{}})})),dh.on("selectResultFromTimeline",(function(e){var n=$("#extractionDetailLC").width();t.LCWidth=Math.max(300,n),t.LCHeight=200,e.path&&(t.optimalWarpPath=e.path),t.setState({selected:e})})),dh.on("switchQueryMode",(function(){t.setState({mode:dh.getMode()})})),dh.on("updateAEOption",(function(){t.setState({AEOptions:dh.getAEOptions()})})),dh.on("recoverQuery",(function(e){t.setState({mode:dh.getMode()}),"block"===$("#resultDetailArea").css("display")&&eh()}))}},{key:"updateOrder",value:function(){var t=document.getElementById("resultOrderList"),e=t.selectedIndex;jc(t.options[e].value),Pf()}},{key:"updateKValue",value:function(){Vc(Number($("#topKResults").val())),$("#topKLabelResults").text("Top "+$("#topKResults").val()+" results"),Pf()}},{key:"updateDistanceThreshold",value:function(){var t;t=$("#distanceThreshold").val(),iu.dispatch({type:"UPDATE_DISTANCE_THRESHOLD",threshold:t}),Pf()}},{key:"orderOfResults",value:function(){return r.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"},onChange:this.updateOrder.bind(this)},r.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Sort results by"),r.a.createElement("select",{id:"resultOrderList",className:"custom-select custom-select-sm",style:{width:"7rem"}},function(){var t=[];t.push("Time stamp"),t.push("Data");var e=[];"AE"===dh.getMode()?(dh.getAEOptionStatus("flare")&&(t.push("Significance"),t.push("Intensity")),dh.getAEOptionStatus("rotation")&&(t.push("Angle"),t.push("Diameter"),t.push("Period")),dh.getAEOptionStatus("anomaly")&&t.push("Anomaly degree")):t.push("Distance");for(var n=0;n<t.length;n++){var i=rh(t[n]);e.push(r.a.createElement("option",{value:i,key:i},t[n]))}return e}()))}},{key:"distanceThreshold",value:function(){return r.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"}},r.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Distance threshold"),r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"distanceThreshold",onChange:this.updateDistanceThreshold.bind(this),style:{width:"7rem"}}))}},{key:"topKResults",value:function(){var t=!1;return"AE"===this.state.mode&&(this.state.AEOptions.flare||this.state.AEOptions.rotation)&&(t=!0),r.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"}},r.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Top k result"),r.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"k value",id:"topKResults",disabled:t,onChange:this.updateKValue.bind(this),style:{width:"7rem"}}))}},{key:"importResultsButton",value:function(){return r.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"right"}},r.a.createElement("button",{id:"importResultsBtn",className:"btn btn-primary btn-sm",onClick:this.importResultsClick.bind(this)},"Import"))}},{key:"importResultsClick",value:function(){"block"===document.getElementById("importResultsForm").style.display?document.getElementById("importResultsForm").style.display="none":document.getElementById("importResultsForm").style.display="block"}},{key:"exportResultsButton",value:function(){return r.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"right"}},r.a.createElement("button",{id:"exportResultsBtn",className:"btn btn-primary btn-sm",onClick:this.exportResults.bind(this)},"Export"))}},{key:"exportResults",value:function(){var t={};t.query=dh.getQuery(),t.query.parameters=dh.getParameters(),t.results=[];for(var e=0;e<this.state.shownResults.length;e++){var n={};for(var i in this.state.shownResults[e])"id"===i?n.fileName=Gu.getFileName(Number(this.state.shownResults[e][i])):n[i]=this.state.shownResults[e][i];t.results.push(n)}t=JSON.stringify(t,null,"\t");var r="extractionResults_"+Jc()+".json",a=new Blob([t],{type:"application/json"}),o=(window.URL||window.webkitURL).createObjectURL(a),s=document.createElement("a");s.download=decodeURI(r),s.href=o,s.click()}},{key:"popupCommentForm",value:function(){return r.a.createElement("div",{className:"formPopup",id:"commentFormFeatureExtraction"},r.a.createElement("form",{className:"formContainer"},r.a.createElement("h6",null,"User name"),r.a.createElement("input",{type:"text",id:"userNameComment",className:"form-control form-control-sm",placeholder:"Enter Name",name:"name",required:!0}),r.a.createElement("h6",null,"Accessibility"),r.a.createElement("div",{className:"form-check form-inline",id:"accessibility",onChange:this.updateAccessibility.bind(this),style:{paddingLeft:"0px"}},r.a.createElement("div",{className:"custom-control custom-radio"},r.a.createElement("input",{type:"radio",id:"privateComment",name:"accessibility",value:"private",checked:"private"===this.state.accessibility,className:"custom-control-input",readOnly:!0}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"privateComment"},"Private"))),r.a.createElement("h6",null,"Label"),r.a.createElement("div",{className:"form-check form-check-inline menuItem"},r.a.createElement("select",{className:"form-control custom-select",id:"commentLabelColorList",style:{fontSize:"0.8rem",height:"1.5rem",width:"7rem"}},r.a.createElement("option",{value:"0x29ABE0",style:{color:"#29ABE0"}},"Blue"),r.a.createElement("option",{value:"0x80b139",style:{color:"#80b139"}},"Green"),r.a.createElement("option",{value:"0xffd700",style:{color:"#ffd700"}},"Yellow"),r.a.createElement("option",{value:"0xF47C3C",style:{color:"#F47C3C"}},"Orange"),r.a.createElement("option",{value:"0xd9534f",style:{color:"#d9534f"}},"Red"),r.a.createElement("option",{value:"0xba55d3",style:{color:"#ba55d3"}},"Purple"))),r.a.createElement("h6",null,"Comment"),r.a.createElement("textarea",{className:"form-control",id:"textareaComment",placeholder:"Enter comment",rows:"3",style:{marginBottom:"0.5rem"}}),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"submitCommentBtn",onClick:this.submitComment.bind(this),style:{float:"right"}},"Submit"),r.a.createElement("button",{className:"btn btn-secondary btn-sm",type:"button",id:"cancelCommentBtn",style:{float:"right"},onClick:this.cancelComment.bind(this)},"Cancel")))}},{key:"popupImportResultsForm",value:function(){var t=[];if(Object.keys(this.state.importedResults).length>0)for(var e in this.state.importedResults.query)if("mode"===e||"option"===e){var n=this.state.importedResults.query[e];Array.isArray(n)&&(n=n.join(", ")),t.push(r.a.createElement("tr",{key:e},r.a.createElement("td",null,ih(e)),r.a.createElement("td",null,n)))}else if("query"===e)for(var i in this.state.importedResults.query.query)if("controlPoints"!==i&&"path"!==i&&"size"!==i&&"length"!==i){var a=this.state.importedResults.query.query[i];if("inactiveVariables"===i){for(var o=[],s=0;s<this.state.importedResults.query.query[i].length;s++)o.push(this.state.importedResults.query.query[i][s].join(", "));a=o.join(", ")}else if("activeVariables"===i){for(var l=[],u=0;u<this.state.importedResults.query.query[i].length;u++)l.push(this.state.importedResults.query.query[i][u].join(", "));a=l.join(", ")}else Array.isArray(a)&&(a=a.join(", "));t.push(r.a.createElement("tr",{key:i},r.a.createElement("td",null,ih(i)),r.a.createElement("td",null,a)))}return r.a.createElement("div",{className:"formPopup",id:"importResultsForm"},r.a.createElement("h6",null,"From a file"),r.a.createElement("div",{className:"custom-file",style:{marginRight:"0.5rem"}},r.a.createElement("input",{type:"file",id:"importResultsFile",className:"custom-file-input",onChange:this.importResultsFile.bind(this)}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"importResultsFile",style:{justifyContent:"start"}},"Import results")),r.a.createElement("div",{id:"importedQueryInfo",style:{display:Object.keys(this.state.importedResults).length>0?"block":"none"}},r.a.createElement("h6",null,"Query information"),r.a.createElement("table",{id:"importedQueryInfoTable",className:"table table-hover"},r.a.createElement("tbody",{id:"importedQueryInfoBody"},t)),r.a.createElement("div",{id:"importedQueryMenu",style:{float:"right"}},r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"clearTheImportedResultsBtn",onClick:this.clearTheImportedResults.bind(this)},"Clear"),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"recoverTheImportedQueryBtn",onClick:this.recoverTheQuery.bind(this)},"Recover the query"))))}},{key:"importResultsFile",value:function(){var t=document.getElementById("importResultsFile").files,e=new FileReader;e.readAsText(t[0]),e.onload=function(){var t=JSON.parse(e.result);this.setState({importedResults:t})}.bind(this)}},{key:"recoverTheQuery",value:function(){if(Object.keys(this.state.importedResults).length>0){var t=!0;"visual query"===this.state.importedResults.query.mode&&"query-by-example"===this.state.importedResults.query.option?Gu.getIdFromName(this.state.importedResults.query.query.source)<0&&(alert("You have to open the file whose file name is "+this.state.importedResults.query.query.source+"to recover the query-by-example."),t=!1):"visual query"===this.state.importedResults.query.mode&&this.state.importedResults.query.option,t&&(Uc(this.state.importedResults.query),ru("feature"))}}},{key:"clearTheImportedResults",value:function(){this.setState({importedResults:{}}),"block"===document.getElementById("importResultsForm").style.display&&(document.getElementById("importResultsForm").style.display="none")}},{key:"updateAccessibility",value:function(){var t=$("input[name=accessibility]:checked").val();this.setState({accessibility:t})}},{key:"addComment",value:function(){document.getElementById("commentFormFeatureExtraction").style.display="block"}},{key:"cancelComment",value:function(){document.getElementById("commentFormFeatureExtraction").style.display="none"}},{key:"submitComment",value:function(t){var e=$("#userNameComment").val(),n=this.state.accessibility,i=$("#textareaComment").val(),r=(new Date).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),a=document.getElementById("commentLabelColorList"),o=a.selectedIndex,s=a.options[o].value;"private"===n&&function(t,e,n){var i=Qc();null===Wc&&(Wc=JSON.parse(localStorage.getItem("privateComment"))),null===qc&&(qc=JSON.parse(localStorage.getItem("queryTable")));var r,a=!1;for(r in qc)if(qc[r].mode!==e.mode||JSON.stringify(qc[r].option)!==JSON.stringify(e.option));else{var o=!0;for(var s in qc[r])if("id"!==s)if("parameters"===s){if(!Object(dc.isEqual)(n,qc[r][s])){o=!1;break}}else if(!(s in e)||!Object(dc.isEqual)(e[s],qc[r][s])){o=!1;break}if(o){a=!0;break}}if(a)t.queryId=r;else{var l={},u=Qc();for(var c in e)"values"!==c&&(l[c]=e[c]);l.parameters=n,qc[u]=l,localStorage.setItem("queryTable",JSON.stringify(qc)),t.queryId=u}Wc[i]=t,localStorage.setItem("privateComment",JSON.stringify(Wc))}({timeStamp:r,fileName:Gu.getData(this.state.selected.id).name,userName:e,labelColor:s,start:this.state.selected.start,period:"period"in this.state.selected?this.state.selected.period:void 0,comment:i},dh.getQuery(),dh.getParameters()),document.getElementById("commentFormFeatureExtraction").style.display="none",$("#userNameComment").val(""),$("#textareaComment").val(""),hc()}},{key:"showTT",value:function(){var t,e,n;ru("visualization"),this.state.selected.angle?(t=this.state.selected.id,e=[this.state.selected.start,this.state.selected.start+this.state.selected.period],n=this.state.selected.center,iu.dispatch({type:"SHOW_ROTATION_CENTER",id:t,period:e,center:n})):this.state.selected.period?Lu(this.state.selected.id,[this.state.selected.start,this.state.selected.start+this.state.selected.period]):Mu(this.state.selected.id,this.state.selected.start)}},{key:"showLegendOfLC",value:function(){return r.a.createElement("svg",{id:"lineChartLegend",height:"20px",width:"300px"},r.a.createElement("line",{x1:"0",y1:"12",x2:"40",y2:"12",style:{stroke:"#80b139",strokeWidth:3}}),r.a.createElement("text",{x:"50px",y:"15px",fill:"black",fontSize:"0.8rem"},"Query"),r.a.createElement("line",{x1:"100",y1:"12",x2:"140",y2:"12",style:{stroke:"#f26418",strokeWidth:3}}),r.a.createElement("text",{x:"150px",y:"15px",fill:"black",fontSize:"0.8rem"},"Result"))}},{key:"splitResultsByData",value:function(){for(var t=this.state.shownResults.slice().sort(Tf("data")),e={},n=0,i=[],r=t[0].id;n<t.length;)t[n].id!==r&&(e[r]=i,r=t[n].id,i=[]),i.push(t[n]),n++;return i.length>0&&(e[r]=i),e}},{key:"splitImportedResultsByData",value:function(){for(var t=this.state.importedResults.results.slice().sort(Tf("fileName")),e={},n=0,i=[],r=t[0].fileName,a=Gu.getIdFromName(r);n<t.length;)a>=0&&(t[n].fileName!==r&&(e[a]=i,r=t[n].fileName,a=Gu.getIdFromName(r),i=[]),i.push(t[n])),n++;return i.length>0&&(e[a]=i),e}},{key:"render",value:function(){var t=[],e=[];if(Object.keys(this.state.selected).length>0){if(this.state.selected.period&&!this.state.selected.angle){var n,i=Gu.getDataArray(this.state.selected.id,1),a=dh.getQuery(),o=i.z.indexOf(this.state.selected.start),s=i.z.indexOf(this.state.selected.start+this.state.selected.period);for(var l in a.values)if(Array.isArray(a.values[l])&&(Array.isArray(i[l])||"r"==l||"theta"===l)&&"z"!==l){if(a.values[l].indexOf(null)>=0){for(var u=!1,c=0;c<a.values[l].length;c++)if(a.values[l][c]){u=!0;break}if(!u)continue}var h=l;"r"===l?(n=i.PD.slice(o,s+1),h="PD"):"theta"===l?(n=i.PA.slice(o,s+1),h="PA"):n=i[l].slice(o,s+1),t.push(r.a.createElement($p,{key:l,id:this.state.selected.id,item:h,query:a.values[l],target:n,width:this.LCWidth,height:this.LCHeight,path:"Object"==typeof this.optimalWarpPath?this.optimalWarpPath[l]:this.optimalWarpPath}))}}for(var d in this.state.selected)if("id"!==d&&"path"!==d&&!Array.isArray(this.state.selected[d])){var f=void 0;f="V"===d?"Flx(V)":ih(d);var p=this.state.selected[d];if("object"===um(p)){var m="(";for(var g in p)m+=cd(p[g])+", ";m=m.slice(0,m.length-2),p=m+=")"}else"string"==typeof p||"number"==typeof p&&(p=cd(p));e.push(r.a.createElement("tr",{id:"extractionDetail"+f,key:d},r.a.createElement("td",null,f),r.a.createElement("td",{id:"extractionDetail"+f+"Value"},p)))}var v=Gu.getData(this.state.selected.id).data.lookup,y=dh.getActive();if(y){for(var b="",x=0;x<y.length;x++)b+=v[y[x]]+", ";b=b.slice(0,b.length-2),e.push(r.a.createElement("tr",{id:"extractionDetailVariables",key:"variables"},r.a.createElement("td",null,"Variables"),r.a.createElement("td",{id:"extractionDetailVariablesValue"},b)))}}var _=[];if(this.state.shownResults.length>0){var w=this.splitResultsByData();if(Object.keys(this.state.importedResults).length<=0)for(var S in w)_.push(r.a.createElement("div",{className:"row",key:S},r.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},r.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Gu.getFileName(Number(S)))),r.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+S},r.a.createElement(tm,{id:Number(S),results:w[S],importedFlag:!1,height:40}))));else{var E=this.splitImportedResultsByData();for(var M in w)E[M]?_.push(r.a.createElement("div",{className:"row",key:M},r.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},r.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Gu.getFileName(Number(M)))),r.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+M},r.a.createElement(tm,{id:Number(M),results:w[M],importedFlag:!1,height:40}),r.a.createElement(tm,{id:Number(M),results:E[M],importedFlag:!0,height:40})))):_.push(r.a.createElement("div",{className:"row",key:M},r.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},r.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Gu.getFileName(Number(M)))),r.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+M},r.a.createElement(tm,{id:Number(M),results:w[M],importedFlag:!1,height:40}))))}}return r.a.createElement("div",{id:"extractionResults",className:"resultElem"},r.a.createElement("div",{id:"resultMenus",style:{overflow:"hidden",height:"2rem"}},this.topKResults(),this.distanceThreshold(),this.orderOfResults(),this.exportResultsButton(),this.importResultsButton(),this.popupImportResultsForm()),r.a.createElement("div",{id:"mainResultArea"},r.a.createElement("div",{id:"distanceHistogramArea",className:"resultAreaElem",style:{display:"QBE"===this.state.mode||"QBS"===this.state.mode?"block":"none"}},r.a.createElement("h5",null,"Distance distribution (number vs. distance)"),r.a.createElement("label",{id:"topKLabelResults"}),r.a.createElement(lm,null)),r.a.createElement("div",{id:"resultTimelinesArea",className:"container resultAreaElem"},_),r.a.createElement("div",{id:"resultDetail",style:{position:"relative",height:"1.5rem",marginBottom:"0px"}},r.a.createElement("div",{id:"resultDetailArea",className:"container",style:{display:"none"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3",id:"extractionDetailThumbnail"},r.a.createElement("canvas",{id:"detailThumbnailCanvas"})),r.a.createElement("div",{className:"col-3",id:"extractionDetailInfo"},r.a.createElement("table",{id:"extractionDetailInfoTable",style:{width:"100%"}},r.a.createElement("tbody",null,e)),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"showTTBtn",style:{float:"right"},onClick:this.showTT.bind(this)},"TimeTubes"),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"commentBtn",style:{float:"right"},onClick:this.addComment.bind(this)},"Comment")),r.a.createElement("div",{className:"col",id:"extractionDetailLC"},this.showLegendOfLC(),t))),this.popupCommentForm(),r.a.createElement("button",{id:"collapseResultDetailPanel",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",right:"0.5rem"},onClick:eh},"Open")),r.a.createElement("label",{id:"matchingStatus"}),r.a.createElement("div",{id:"resultsArea"})))}}])&&cm(e.prototype,n),i&&cm(e,i),o}(r.a.Component);function gm(t){return(gm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vm(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ym(t,e){return(ym=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_m(t);if(e){var r=_m(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xm(this,n)}}function xm(t,e){return!e||"object"!==gm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _m(t){return(_m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var wm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ym(t,e)}(o,t);var e,n,i,a=bm(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:10,left:50},e.id=t.id,e.divID=t.divID,e.SPID="QBE_SP_Selector",e.data=Gu.getData(e.id);var n=Qh.getTimeRange(e.id);return e.timeRange=void 0===n?[e.data.data.meta.min.z,e.data.data.meta.max.z]:n,e.slicedData=e.data.data.spatial,e.xMinMax=[0,0],e.yMinMax=[0,0],e.selectedPeriod=dh.getSelectedPeriod(),e.selector="selectRegion",e.state={yItem:t.yItem,yItemonPanel:t.yItem,width:t.width,height:Math.max(t.height,200)},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initalizeElements(),this.computeRange(this.state.yItem),this.drawScatterplots(),this.selectedPeriod[0]>0&&this.selectedPeriod[1]>0&&(this.highlightSelectedTimePeriod(),this.timeRange=[this.selectedPeriod[0]-10,this.selectedPeriod[1]+10],this.updateTimeRange()),tc.on("updateFocus",(function(e,n,i){e===t.id&&(i?t.highlightCurrentPlot(n):t.updateCurrentPos(n))})),tc.on("changePlotColor",(function(e){e===t.id&&t.changePlotColor(tc.getPlotColor(e))})),dh.on("switchQueryMode",(function(e){"QBE"===e&&"default"!==dh.getSource()&&t.setState({width:t.props.width,height:Math.max(t.props.height,200)})})),dh.on("updateSelectedPeriod",(function(){"QBE"===dh.getMode()&&Number(dh.getSource())===t.id&&(t.selectedPeriod=dh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.timeRange=[t.selectedPeriod[0]-10,t.selectedPeriod[1]+10],t.updateTimeRange())})),dh.on("convertResultIntoQuery",(function(e,n,i){"QBE"===dh.getMode()&&Number(e)===t.id&&(t.selectedPeriod=dh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.timeRange=[t.selectedPeriod[0]-10,t.selectedPeriod[1]+10],t.updateTimeRange())})),dh.on("switchQBESelectorSP",(function(e){"reset"===e?t.resetScatterplots():(t.selector=e,t.switchMouseInteraction())})),dh.on("resetSelection",(function(){t.resetSelection()})),dh.on("selectTimeInterval",(function(e,n){"QBE"===dh.getMode()&&Number(e)===t.id&&(t.selectedPeriod=dh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.spBrusher.call(t.brush.move,[t.xScale(t.selectedPeriod[0]),t.xScale(t.selectedPeriod[1])]))}))}},{key:"initalizeElements",value:function(){this.zoom=nu().scaleExtent([.05,10]),this.sp=se("#"+this.divID).append("svg").attr("id",this.SPID).attr("class","scatterplot scatterplots"+this.id+" "+this.divID),this.xScale=Ca(),this.xScaleTmp=this.xScale,this.xAxis=this.sp.append("g").attr("class","x_axis "+this.divID),this.xAxisText=Ds("g.x_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("text-anchor","middle"),this.yScale=Ca(),this.yScaleTmp=this.yScale,this.yAxis=this.sp.append("g").attr("class","y_axis "+this.divID).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.yAxisText=Ds("g.y_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle"),this.tooltip=se("#"+this.divID).append("div").attr("class","tooltip "+this.divID).attr("id","tooltip_"+this.SPID).style("opacity",.75).style("visibility","hidden"),this.line=Us().x((function(t){return t[0]})).y((function(t){return t[1]})),this.lineH=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineH "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.lineV=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineV "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.clip=this.sp.append("defs").append("clipPath").attr("id","clipScatterplots_"+this.SPID).append("rect"),this.point_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("points_g",!0);var t=this.state.yItem;this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").select((function(e){return"z"in e&&t in e?this:null})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id),this.brush=Qi(),this.spBrusher=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").attr("class","brush");var e=this.props.width,n=Math.max(this.props.height,200);this.setState({width:e,height:n})}},{key:"drawScatterplots",value:function(){var t=this.SPID,e=this.margin,n=this.state.width,i=this.state.height,r=n-this.margin.left-this.margin.right,a=i-this.margin.top-this.margin.bottom,o=this.state.yItem;this.zoom.extent([[0,0],[r,a]]).on("zoom",this.zoomed().bind(this)),this.sp.attr("width",n).attr("height",i).call(this.zoom).on("dblclick.zoom",null).on("mousedown.zoom",null),this.brush.extent([[0,0],[r,a]]).on("start brush",this.brushed().bind(this)).on("end",this.brushedEnd().bind(this)),this.spBrusher.call(this.brush),this.xScale.domain(this.xMinMax).nice().range([0,r]),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-a).tickFormat(ud),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+a)+")").call(this.xLabel),this.xAxisText.attr("x",r/2).attr("y",this.margin.bottom/2+10).text(this.data.data.lookup.z),this.yScale.domain(this.yMinMax).nice().range([a,0]),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-r).tickFormat(ud),this.yAxis.call(this.yLabel),this.yAxisText.attr("x",-a/2).attr("y",-this.margin.left/2-10).text(this.data.data.lookup[o]).on("click",function(){var n=se("#changeYAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({yItemonPanel:this.state.yItem});else{var i=document.getElementById("changeXAxisPanel_"+t).clientHeight;document.getElementById("changeXAxisPanel_"+t).clientWidth,n.style("transform","translate("+e.left+"px,"+(a/2+e.top-i/2)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")}));var s=[[0,this.margin.top],[r,this.margin.top]],l=[[this.margin.left,0],[this.margin.left,a]];if(this.lineH.attr("d",this.line(s)),this.lineV.attr("d",this.line(l)),this.clip.attr("width",r).attr("height",a),this.data.data.merge){for(var u={},c=this.data.name.split(","),h=[],d=0;d<c.length;d++){var f=Gu.getIdFromName(c[d]);u[c[d]]=d;var p=c[d].split("+");if(p.length>1)for(var m=0;m<p.length;m++)u[p[m]]=d;h.push(tc.getPlotColor(f))}this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[o])}.bind(this)).attr("fill",(function(t){return h[u[t.source]]})).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var g=tc.getPlotColor(this.id);this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[o])}.bind(this)).attr("fill",g).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}}},{key:"zoomed",value:function(){return function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom,n=this.state.yItem,i=$t.transform.rescaleX(this.xScale),r=$t.transform.rescaleY(this.yScale);this.xScaleTmp=i,this.yScaleTmp=r,this.xMinMax=i.domain(),this.yMinMax=r.domain(),this.xAxis.call(this.xLabel.scale(i)),this.yAxis.call(this.yLabel.scale(r)),this.points.attr("cx",(function(t){return i(t.z)})).attr("cy",(function(t){return r(t[n])})),this.spBrusher.call(this.brush.move,[i(this.selectedPeriod[0]),i(this.selectedPeriod[1])]);var a=se("circle.current."+this.divID);if(a._groups[0][0]){var o=a.attr("cx"),s=a.attr("cy");s<=0||e<=s?this.lineH.attr("transform","translate("+this.margin.left+","+s+")").style("visibility","hidden"):this.lineH.transition().duration(0).attr("transform","translate("+this.margin.left+","+s+")").style("visibility","visible"),o<=0||t<=o?this.lineV.attr("transform","translate("+o+","+this.margin.top+")").style("visibility","hidden"):this.lineV.transition().duration(0).attr("transform","translate("+o+","+this.margin.top+")").style("visibility","visible")}}}},{key:"brushed",value:function(){return function(){var t=($t.selection||this.xScaleTmp.range).map(this.xScaleTmp.invert,this.xScaleTmp);this.selectedPeriod=t}}},{key:"brushedEnd",value:function(){return function(){if("QBE"===dh.getMode()&&Number(dh.getSource())===this.id){var t=dh.getSelectedPeriod();(Math.abs(t[0]-this.selectedPeriod[0])>1e-5||Math.abs(t[1]-this.selectedPeriod[1])>1e-5)&&(e=this.selectedPeriod,iu.dispatch({type:"SELECT_PERIOD_FROM_SP",period:e}),this.selectedPeriod[1]-this.selectedPeriod[0]>0?(this.highlightSelectedTimePeriod(),this.timeRange=[this.selectedPeriod[0]-10,this.selectedPeriod[1]+10],this.updateTimeRange()):(this.resetSelection(),this.timeRange=[this.data.data.meta.min.z,this.data.data.meta.max.z],this.updateTimeRange()))}var e}}},{key:"spMouseOver",value:function(){var t=this.tooltip,e=this.data,n=this.state.yItem;return function(i){se(this).attr("stroke-width",1).attr("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>"+e.data.lookup.z+"</i>: "+i.z+"<br/><i>"+e.data.lookup[n]+"</i>: "+i[n]).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"spMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);n.style("fill")!==ke("red").toString()&&(n.attr("stroke-width",.5).attr("stroke","dimgray"),n.attr("class").indexOf("current")<0?n.attr("stroke-width",.5).attr("stroke","dimgray"):n.attr("stroke","orange").attr("stroke-width",1)),t.transition().duration(150).style("visibility","hidden")}}},{key:"spDblClick",value:function(){var t=this.id;return function(e){Mu(t,e.z)}}},{key:"resetScatterplots",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;switch(this.timeRange=[this.data.data.meta.min.z,this.data.data.meta.max.z],this.updateTimeRange(),this.zoom=nu().scaleExtent([.05,10]).extent([[0,0],[t,e]]).on("zoom",this.zoomed().bind(this)),this.selector){case"selectRegion":this.sp.call(this.zoom).call(this.zoom.transform,$l).on("dblclick.zoom",null).on("mousedown.zoom",null);break;case"move":this.sp.call(this.zoom).call(this.zoom.transform,$l).on("dblclick.zoom",null)}}},{key:"highlightCurrentPlot",value:function(t){var e=this.margin,n=this.divID,i=t+this.data.data.spatial[0].z,r=Ds("svg."+n),a=this.state.yItem;function o(t){var i=se(this),r=(i.attr("class").split(" ")[1],se("svg."+n)),a=r.selectAll(".currentLineH"),o=r.selectAll(".currentLineV");a.transition().duration(0).style("visibility","visible").attr("transform","translate("+e.left+","+i.attr("cy")+")"),o.transition().duration(0).style("visibility","visible").attr("transform","translate("+i.attr("cx")+","+e.top+")")}r.each((function(t){var e=se(this),n=e.selectAll("circle"),r=e.attr("class").split(" ");n.attr("stroke-width",.5).attr("stroke","dimgray").attr("class",r[1]+" "+r[2]);var s=n.filter((function(t){return t.z===i&&a in t}));s._groups.length>0&&s.attr("stroke","orange").attr("stroke-width",1).attr("class",r[1]+" "+r[2]+" current").moveToFront().each(o)}))}},{key:"updateCurrentPos",value:function(t){var e=this.state.width-this.margin.left-this.margin.right,n=Ca().domain([this.xMinMax[0],this.xMinMax[1]]).range([0,e]),i=t+this.data.data.spatial[0].z;this.lineH.style("visibility","hidden"),this.lineV.transition().duration(0).style("visibility","visible").attr("transform","translate("+n(i)+","+this.margin.top+")")}},{key:"changePlotColor",value:function(t){se("#"+this.divID).selectAll("circle").attr("fill",t)}},{key:"onSelectYItem",value:function(t){this.setState({yItemonPanel:t.target.value})}},{key:"onClickYAxisDone",value:function(t){this.setState({yItem:this.state.yItemonPanel}),this.computeRange(this.state.yItemonPanel),this.updateScatterplots(this.state.yItemonPanel),this.yAxisText.text(this.data.data.lookup[this.state.yItemonPanel]),se("#changeYAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"computeRange",value:function(t){this.slicedData=this.data.data.spatial.filter(function(t){return this.timeRange[0]<=t.z&&t.z<=this.timeRange[1]}.bind(this)),this.xMinMax=this.timeRange,this.yMinMax=p(this.slicedData,(function(e){return e[t]}))}},{key:"updateScatterplots",value:function(t){if(this.xScale.domain(this.xMinMax).nice(),this.yScale.domain(this.yMinMax).nice(),this.xMinMax=this.xScale.domain(),this.yMinMax=this.yScale.domain(),this.points.remove(),this.data.data.merge){for(var e={},n=this.data.name.split(","),i=[],r=0;r<n.length;r++){var a=Gu.getIdFromName(n[r]);e[n[r]]=r;var o=n[r].split("+");if(o.length>1)for(var s=0;s<o.length;s++)e[o[s]]=r;i.push(tc.getPlotColor(a))}this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(e){return this.yScale(e[t])}.bind(this)).select((function(e){return z in e&&t in e?this:null})).attr("fill",(function(t){return i[e[t.source]]})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var l=tc.getPlotColor(this.id);this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(e){return this.yScale(e[t])}.bind(this)).select((function(e){return"z"in e&&t in e?this:null})).attr("fill",l).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}this.xAxis.call(this.xLabel.scale(this.xScale)),this.yAxis.call(this.yLabel.scale(this.yScale))}},{key:"highlightSelectedTimePeriod",value:function(){var t=this.selectedPeriod;this.points.attr("stroke","dimgray").attr("stroke-width",.5),this.points.select((function(e){return t[0]<=e.z&&e.z<=t[1]?this:null})).attr("stroke","#d23430").attr("stroke-width",1)}},{key:"updateTimeRange",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;this.computeRange(this.state.yItem),this.xScale.domain(this.xMinMax).nice(),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-e).tickFormat(ud),this.xAxis.transition().duration(500).call(this.xLabel.scale(this.xScale)),this.yScale.domain(this.yMinMax).nice(),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-t).tickFormat(ud),this.yAxis.transition().duration(500).call(this.yLabel.scale(this.yScale)),this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[this.state.yItem])}.bind(this)),this.spBrusher.call(this.brush.move,[this.xScale(this.selectedPeriod[0]),this.xScale(this.selectedPeriod[1])])}},{key:"resetSelection",value:function(){this.selectedPeriod=[-1,-1],this.points.attr("stroke","dimgray").attr("stroke-width",.5)}},{key:"switchMouseInteraction",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;switch(this.zoom=nu().scaleExtent([.05,10]).extent([[0,0],[t,e]]).on("zoom",this.zoomed().bind(this)),this.selector){case"selectRegion":this.sp.call(this.zoom).on("dblclick.zoom",null).on("mousedown.zoom",null),this.spBrusher.attr("class","brush").call(this.brush);break;case"move":this.sp.call(this.zoom).on("dblclick.zoom",null),this.spBrusher.on(".brush",null)}}},{key:"render",value:function(){"feature"===mu.getMenu()&&Ds("svg#"+this.SPID).size()>0&&this.drawScatterplots();var t=[],e=this.data.data.lookup;for(var n in e){var i="";(i=e[n].length>1?e[n].join(","):e[n]).indexOf("JD")<0?t.push(r.a.createElement("div",{className:"form-check",key:i},r.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:i},i))):t.unshift(r.a.createElement("div",{className:"form-check",key:i},r.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),r.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:i},i)))}return r.a.createElement("div",{id:"scatterplotsSelectors_"+this.SPID},r.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},r.a.createElement("h6",null,"Change y axis"),r.a.createElement("div",{id:"changeYAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},r.a.createElement("form",{id:"selectYAxisForm_"+this.SPID},t)),r.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeYAxisBtn_"+this.SPID,onClick:this.onClickYAxisDone.bind(this)},"Done")))}}])&&vm(e.prototype,n),i&&vm(e,i),o}(r.a.Component);function Sm(t){return(Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Em(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mm(t,e){return(Mm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=km(t);if(e){var r=km(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tm(this,n)}}function Tm(t,e){return!e||"object"!==Sm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function km(t){return(km=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mm(t,e)}(o,t);var e,n,i,a=Cm(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={data:Gu.getAllData(),source:dh.getSource()},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Gu.on("upload",(function(){t.setState({data:Gu.getAllData()})})),Gu.on("updateDetail",(function(e,n){if(Number(t.state.source)===e){var i=document.getElementById("currentJDValue");i&&(i.innerText=(n+t.state.data[e].data.meta.min.z).toFixed(3))}})),dh.on("updateSource",(function(){t.setState({source:dh.getSource()})})),dh.on("recoverQuery",(function(e){"QBE"===dh.getMode()&&t.setState({source:dh.getSource()})}))}},{key:"render",value:function(){var t=this,e=400;if(null!==document.getElementById("featureArea")){var n=$("#featureArea").outerWidth(!0)-2*Number($("#featureArea").css("padding-left").replace("px",""));n>0&&(e=n)}var i=this.state.data.map((function(n){return r.a.createElement("div",{key:n.id,id:"QBE_SP_"+n.id,style:{display:n.id===Number(t.state.source)?"block":"none"}},r.a.createElement(wm,{key:n.id,id:n.id,divID:"QBE_SP_"+n.id,xItem:"z",yItem:"V",width:e,height:Math.ceil(.8*e)}))}));return r.a.createElement("div",{id:"QBESource",className:"controllersElem featureColumn",style:{float:"left",width:"30%",position:"relative"}},r.a.createElement("div",{id:"QBESourceMain",style:{display:"block"}},this.QBESelector(),r.a.createElement("div",{id:"QBESourceTT",className:"featureElem"},this.selectorOptionsTT()),r.a.createElement("div",{id:"QBESourceSP",className:"featureElem"},this.selectorOptionsSP(),i)),r.a.createElement("button",{id:"collapseSourcePanel",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",top:"0px",right:"-4rem"},onClick:this.clickCloseSourcePanelBtn},"Close"))}},{key:"clickCloseSourcePanelBtn",value:function(){th(),au()}},{key:"QBESelector",value:function(){return r.a.createElement("div",{className:"featureElem"},r.a.createElement("div",{id:"selectTimeInterval",className:"form-row featureRow"},r.a.createElement("span",{style:{marginRight:"0.3rem"}},"Select"),r.a.createElement("input",{type:"text",className:"form-control custom-input",id:"selectTimeIntervalInput",style:{width:"5rem"}}),r.a.createElement("span",{style:{marginLeft:"0.3rem"}},"days from JD="),r.a.createElement("span",{id:"currentJDValue"}),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"selectTimeIntervalBtn",style:{display:"block",margin:"0 0 0 auto"},onClick:this.selectTimeInterval.bind(this)},"Select")),r.a.createElement("button",{id:"resetSelectionBtn",className:"btn btn-primary btn-sm featureRow",style:{display:"block",margin:"0 0 0 auto"},onClick:this.resetSelection.bind(this)},"Deselect all"))}},{key:"selectorOptionsTT",value:function(){return r.a.createElement("div",{id:"selectorForQBETT"},r.a.createElement("h5",null,"Selection options for TimeTubes"),r.a.createElement("form",{className:"form-check form-check-inline selector featureRow",id:"QBESelectorTT"},r.a.createElement("img",{id:"QBESelectTT",className:"selectorIcon selected",name:"QBESelectorTT",value:"Select",src:"img/icons/pen.png",alt:"pen",width:"30",height:"30",title:"select a part of the tube",onClick:this.selectSelect.bind(this),readOnly:!0}),r.a.createElement("img",{id:"QBEDeselectTT",className:"selectorIcon",name:"QBESelectorTT",value:"Deselect",src:"img/icons/eraser.png",alt:"eraser",width:"30",height:"30",title:"deselect a part of the tube",onClick:this.selectDeselect.bind(this),readOnly:!0})))}},{key:"selectorOptionsSP",value:function(){return r.a.createElement("div",{id:"selectorForQBESP"},r.a.createElement("h5",null,"Selection options for scatterplots"),r.a.createElement("form",{className:"form-check form-check-inline selector featureRow",id:"QBESelectorSP"},r.a.createElement("img",{id:"QBESelectRegionSP",className:"selectorIcon selected",name:"QBESelectorSP",value:"SelectRegion",src:"img/icons/selectRegion.png",alt:"select region",width:"30",height:"30",title:"select a part of the scatterplot",onClick:this.selectSelectRegion.bind(this),readOnly:!0}),r.a.createElement("img",{id:"QBEMoveSP",className:"selectorIcon",name:"QBESelectorSP",value:"Move",src:"img/icons/move.png",alt:"move",width:"30",height:"30",title:"move the scatteplot",onClick:this.selectMove.bind(this),readOnly:!0}),r.a.createElement("img",{id:"QBEResetSP",className:"selectorIcon",name:"QBESelectorSP",value:"Reset",src:"img/icons/reset.png",alt:"reset",width:"30",height:"30",title:"reset changes on the scatterplot",onClick:this.selectReset.bind(this),readOnly:!0})))}},{key:"selectTimeInterval",value:function(){var t=$("#selectTimeIntervalInput").val();isNaN(t)||""==t||Lc(t)}},{key:"resetSelection",value:function(){Oc()}},{key:"selectSelect",value:function(){$("img[name=QBESelectorTT]").each((function(){$(this).removeClass("selected")})),$("#QBESelectTT").addClass("selected"),Ac(!0)}},{key:"selectDeselect",value:function(){$("img[name=QBESelectorTT]").each((function(){$(this).removeClass("selected")})),$("#QBEDeselectTT").addClass("selected"),Ac(!1)}},{key:"selectSelectRegion",value:function(){$("img[name=QBESelectorSP]").each((function(){$(this).removeClass("selected")})),$("#QBESelectRegionSP").addClass("selected"),Fc("selectRegion")}},{key:"selectMove",value:function(){$("img[name=QBESelectorSP]").each((function(){$(this).removeClass("selected")})),$("#QBEMoveSP").addClass("selected"),Fc("move")}},{key:"selectReset",value:function(){Fc("reset")}}])&&Em(e.prototype,n),i&&Em(e,i),o}(r.a.Component);function Am(t){return(Am="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Om(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Lm(t,e){return(Lm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Nm(t);if(e){var r=Nm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Im(this,n)}}function Im(t,e){return!e||"object"!==Am(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nm(t){return(Nm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Dm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lm(t,e)}(o,t);var e,n,i,a=Rm(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:20,right:20},t.datasets=[],t.custerCenters=[],t.subsequences=[],t.labels=[],t.dataIdxInCluster=[],t.clusterColors=[],t.timelines=[],t.xScales=[],t.xLabels=[],t.xAxes=[],t}return e=o,(n=[{key:"render",value:function(){var t=this;return r.a.createElement("div",{id:"clusteringTimeline",className:"resultAreaElem",ref:function(e){t.mount=e}})}},{key:"componentDidMount",value:function(){var t=this;xh.on("showClusteringResults",(function(){t.datasets=xh.getDatasets(),t.clusterCenters=xh.getClusterCenters(),t.subsequences=xh.getSubsequences(),t.labels=xh.getLabels(),t.clusterColors=xh.getClusterColors(),t.divideDataIntoCluster(),t.drawTimelines()})),xh.on("updateClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.subsequences=xh.getSubsequences(),t.labels=xh.getLabels(),t.divideDataIntoCluster(),t.drawTimelines()})),xh.on("resetClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.subsequences=xh.getSubsequences(),t.labels=xh.getLabels(),t.divideDataIntoCluster(),t.drawTimelines()})),mu.on("resizeExtractionResultsArea",(function(){t.resizeTimelines()}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringTimeline");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"divideDataIntoCluster",value:function(){this.dataIdxInCluster=[];for(var t=0;t<this.clusterCenters.length;t++)this.dataIdxInCluster.push([]);for(var e=0;e<this.labels.length;e++)"object"===Am(this.labels[e])?this.dataIdxInCluster[this.labels[e].cluster].push(e):this.dataIdxInCluster[this.labels[e]].push(e)}},{key:"drawTimelines",value:function(){var t=this;$("#clusteringTimelineArea").remove(),this.timelines=[],this.xScales=[],this.xLabels=[],this.xAxes=[];for(var e=$("#clusteringResultsOverview").width()-(this.margin.left+this.margin.right),n=e-(this.margin.left+this.margin.right),i=n-100,r=se("#clusteringTimeline").append("div").attr("id","clusteringTimelineArea"),a=0;a<this.datasets.length;a++){var o=Gu.getData(this.datasets[a]),s=r.append("svg").attr("id","clusteringTimelineSVG_"+this.datasets[a]).attr("class","clusteringTimelineSVG").attr("width",e).attr("height",40),l=(s.append("text").attr("x",0).attr("y",20).attr("id","clusteringTimeline_"+this.datasets[a]).attr("text-anchor","left").style("font-size","10px").text(o.name).on("click",function(t,e,n){var i=Number(n[0].id.split("_")[1]);if(40===Number(this.timelines[i].attr("height"))){this.timelines[i].transition().duration(1e3).attr("height",40*this.clusterCenters.length);for(var r=0;r<this.clusterCenters.length;r++)0!==r&&this.timelines[i].append("g").attr("class","x-axis clusteringTimelineXAxis_"+i).attr("id","clusteringTimelineXAxis_"+i+"_"+r).attr("transform","translate("+(this.margin.left+100)+",15)").transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+","+(40*r+20-5)+")").call(this.xLabels[i]),this.timelines[i].selectAll("rect.clusterLine_"+i+"_"+r).transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+","+40*r+")")}else this.timelines[i].selectAll("rect.clusterLine_"+i).transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+",0)"),Ds(".clusteringTimelineXAxis_"+i).transition().duration(1e3).attr("translate("+ +(this.margin.left+100)+",15)"),Ds(".clusteringTimelineXAxis_"+i).transition().delay(1e3).remove(),this.timelines[i].transition().duration(1e3).attr("height",40);setTimeout((function(){au()}),1e3)}.bind(this)),Ca().domain([o.data.meta.min.z,o.data.meta.max.z]).nice().range([0,i])),u=V(l).ticks(10).tickSize(10),c=s.append("g").attr("class","x-axis").attr("id","clusteringTimelineXAxis_"+this.datasets[a]).attr("transform","translate("+(this.margin.left+100)+",15)").call(u);this.timelines.push(s),this.xScales.push(l),this.xLabels.push(u),this.xAxes.push(c)}for(var h=0;h<this.dataIdxInCluster.length;h++)for(var d=function(e){t.timelines[e].selectAll("line.clusterLine_"+t.datasets[e]+"_"+h).data(t.dataIdxInCluster[h].filter(function(t){return Number(this.subsequences[t].id)===this.datasets[e]}.bind(t))).enter().append("rect").attr("class","clusterLine_"+t.datasets[e]+" clusterLine_"+t.datasets[e]+"_"+h).attr("id",function(t){return"clusterLine_"+this.datasets[e]+"_"+this.subsequences[t].idx}.bind(t)).attr("x",function(t){return this.xScales[e](this.subsequences[t][0].z)}.bind(t)).attr("y",5).attr("width",function(t){return this.xScales[e](this.subsequences[t][this.subsequences[t].length-1].z)-this.xScales[e](this.subsequences[t][0].z)}.bind(t)).attr("height",20).attr("fill",Fe(t.clusterColors[h][0],t.clusterColors[h][1],t.clusterColors[h][2])).attr("opacity",.5).attr("transform","translate("+(t.margin.left+100)+",0)").on("mouseover",t.onMouseOverClusterLine().bind(t)).on("mouseout",t.onMouseOutClusterLine().bind(t)).on("click",t.onClickClusterLine().bind(t)).on("dblclick",t.onDoubleClickClusterLine().bind(t))},f=0;f<this.datasets.length;f++)d(f)}},{key:"onMouseOverClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){var n,i=$("#tooltipClusteringResults"),r=e.split("_"),a=r[1],o=Number(r[2]),s=0;for(s=0;s<this.subsequences.length;s++)if(this.subsequences[s].id===a&&this.subsequences[s].idx===o){n=this.subsequences[s];break}var l=Gu.getFileName(a),u=[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z],c=n.dataPoints.length,h=$t.clientX+5,d=$t.clientY+5;i.html('<table><tbody><tr><td>File name</td><td class="tooltipTableValues">'+l+'</td></tr><tr><td>Period</td><td class="tooltipTableValues">'+u[0]+"-"+u[1]+'</td></tr><tr><td>Data points number</td><td class="tooltipTableValues">'+c+"</td></tr></tbody></table>"),i.css({left:h+"px",top:d+"px",right:"unset",bottom:"unset"}),i.css("display","block"),se("#"+e).attr("stroke","black").attr("stroke-width",1.5).moveToFront(),$("#subsequenceDetailTr_"+a+"_"+o).length>0&&(Ds(".clusterMemberLineChart_"+a+"_"+o).attr("stroke","#f26418"),se("#SSLengthBar_"+Math.floor(u[1]-u[0])).attr("stroke","black").attr("stroke-width",1.5),se("#subsequenceDetailTr_"+a+"_"+o).classed("table-active",!0)),$("#subsequenceTr_"+a+"_"+o).length&&se("#subsequenceTr_"+a+"_"+o).classed("table-active",!0),$("#updatedSubsequenceTr_"+a+"_"+o).length&&se("#updatedSubsequenceTr_"+a+"_"+o).classed("table-active",!0)}}}},{key:"onMouseOutClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){var n=e.split("_"),i=n[1],r=Number(n[2]);$("#tooltipClusteringResults").css("display","none"),se("#"+e).attr("stroke-width",0),$("#subsequenceDetailTr_"+i+"_"+r).length>0&&(Ds(".clusterMemberLineChart_"+i+"_"+r).attr("stroke","lightgray"),Ds(".SSLengthBar").attr("stroke-width",0),se("#subsequenceDetailTr_"+i+"_"+r).classed("table-active",!1)),$("#subsequenceTr_"+i+"_"+r).length&&se("#subsequenceTr_"+i+"_"+r).classed("table-active",!1),$("#updatedSubsequenceTr_"+i+"_"+r).length&&se("#updatedSubsequenceTr_"+i+"_"+r).classed("table-active",!1)}}}},{key:"onClickClusterLine",value:function(){return function(t){if($t.target){var e=$t.target.classList[1].split("_");wp(Number(e[2]))}}}},{key:"onDoubleClickClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){for(var n,i=e.split("_"),r=i[1],a=Number(i[2]),o=0;o<this.subsequences.length;o++)if(this.subsequences[o].id===r&&this.subsequences[o].idx===a){n=this.subsequences[o];break}$("#tooltipClusteringResults").css("display","none"),ru("visualization"),Lu(Number(r),[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"resizeTimelines",value:function(){for(var t=this,e=$("#clusteringResultsOverview").width()-(this.margin.left+this.margin.right),n=e-(this.margin.left+this.margin.right)-100,i=function(i){t.timelines[i].attr("width",e),t.xScales[i].range([0,n]),t.xLabels[i]=V(t.xScales[i]).ticks(10).tickSize(10),t.xAxes[i].call(t.xLabels[i]),Ds(".x-axis.clusteringTimelineXAxis_"+t.datasets[i]).call(t.xLabels[i]);for(var r=0;r<t.dataIdxInCluster.length;r++)Ds("rect.clusterLine_"+t.datasets[i]+"_"+r).attr("x",function(t){return this.xScales[i](this.subsequences[t][0].z)}.bind(t)).attr("width",function(t){return this.xScales[i](this.subsequences[t][this.subsequences[t].length-1].z)-this.xScales[i](this.subsequences[t][0].z)}.bind(t))},r=0;r<this.datasets.length;r++)i(r)}}])&&Om(e.prototype,n),i&&Om(e,i),o}(r.a.Component),zm=n(137),Bm=n.n(zm);function Fm(t){return(Fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vm(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jm(t,e){return(jm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Um(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gm(t);if(e){var r=Gm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Hm(this,n)}}function Hm(t,e){return!e||"object"!==Fm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gm(t){return(Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jm(t,e)}(o,t);var e,n,i,a=Um(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).tubes=[],t.axes=[],t.labels=[],t.tubeNum=16,t.segment=16,t.division=5,t.cameraPosZ=50,t.tubeGroups=[],t.splines=[],t.opacityCurve=tc.getOpacityCurve("Default"),t.vertex=document.getElementById("vertexShader_tube").textContent,t.fragment=document.getElementById("fragmentShader_tube").textContent,t.raycaster=new Ru.Raycaster,t.clusterCenters=[],t.clusterColors=[],t.clusteringScores={},t.queryMode=dh.getMode(),t.clickedX,t.clickedY,t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=$("#clusteringResultsOverview").width(),n=$("#appHeader").outerHeight(!0),i=$("#clusteringResultsOverview").height()-n;this.scene=new Ru.Scene,this.setCameras(e,i),this.renderer=new Ru.WebGLRenderer,this.renderer.setClearColor(new Ru.Color(Number(tc.getBackgroundColor()))),this.renderer.setSize(e,i),this.renderer.localClippingEnabled=!0,this.renderer.domElement.id="clusteringResultsViewport",this.canvas=this.renderer.domElement,this.mount.appendChild(this.renderer.domElement),this.renderScene(),this.start(),this.initDetailView();var r=new Ru.DirectionalLight(16777215,.7);r.position.set(-20,40,60),this.scene.add(r);var a=new Ru.AmbientLight(2697513);this.scene.add(a),this.addControls();var o=this.onMouseClick();this.canvas.addEventListener("click",o.bind(this),!1),xh.on("showClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.clusterColors=xh.getClusterColors(),t.clusteringScores=xh.getClusteringScores(),t.setRendererSize(),t.computeSplines(),t.drawClusterCentersAsTubes(),t.showClusteringScores()})),xh.on("showClusterDetails",(function(e){t.setCameraDetail(),t.setDetailView(e)})),xh.on("updateClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.clusteringScores=xh.getClusteringScores(),t.setRendererSize(),t.computeSplines(),t.drawClusterCentersAsTubes(),t.showClusteringScores(),t.resetDetailView()})),xh.on("resetClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.clusteringScores=xh.getClusteringScores(),t.setRendererSize(),t.computeSplines(),t.drawClusterCentersAsTubes(),t.showClusteringScores(),t.resetDetailView()})),mu.on("resizeExtractionResultsArea",(function(){t.setRendererSize()}))}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{id:"clusteringOverview",className:"clusteringPanel",ref:function(e){t.mount=e}},r.a.createElement("div",{id:"clusteringScores"},r.a.createElement("table",{id:"clusteringScoresTable"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Pseudo F"),r.a.createElement("td",{id:"pseudoFValue",className:"clusteringScoresValues"})),r.a.createElement("tr",null,r.a.createElement("td",null,"Silhouette coefficient"),r.a.createElement("td",{id:"silhouetteValue",className:"clusteringScoresValues"})),r.a.createElement("tr",null,r.a.createElement("td",null,"Davis Bouldin index"),r.a.createElement("td",{id:"davisBouldinValue",className:"clusteringScoresValues"}))))))}},{key:"showClusteringScores",value:function(){$("#pseudoFValue").text(cd(this.clusteringScores.pseudoF)),$("#silhouetteValue").text(cd(this.clusteringScores.silhouette)),$("#davisBouldinValue").text(cd(this.clusteringScores.davisBouldin))}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.renderer&&this.renderer.render(this.scene,this.camera),this.detailRenderer&&this.detailRenderer.render(this.scene,this.cameraDetail)}},{key:"setRendererSize",value:function(){var t=$("#clusteringResultsOverview").width(),e=$("#appHeader").outerHeight(!0),n=$("#clusteringTimeline").outerHeight(!0),i=window.innerHeight-e-n;this.renderer.setSize(t,i);var r=t/i,a=2*Math.tan(22.5*Math.PI/180),o=a*this.cameraPosZ,s=a*this.cameraPosZ*r;this.cameraSet.orthographic=new Ru.OrthographicCamera(-s/2,s/2,o/2,-o/2,.1,1e3),this.camera=this.cameraSet.orthographic,this.camera.position.z=this.cameraPosZ,this.camera.lookAt(this.scene.position),this.renderer.render(this.scene,this.camera),this.addControls()}},{key:"initDetailView",value:function(){this.detailRenderer=new Ru.WebGLRenderer,this.detailRenderer.setSize(300,300),this.detailRenderer.setClearColor("#000000"),this.detailRenderer.domElement.id="selectedClusterCenterTimeTubes"}},{key:"setDetailView",value:function(t){if(void 0!==t&&$("#selectedClusterCenterTimeTubes").length){$("#selectedClusterCenterTimeTubesRenderer").remove();var e=$("#selectedClusterCenterTimeTubes").width()-32;this.detailRenderer.setSize(e,e),this.detailRenderer.domElement.id="selectedClusterCenterTimeTubesRenderer";var n=.7*xh.getViewportSize(),i=n*Math.cos(.5*Math.PI-2*Math.PI/this.clusterCenters.length*t),r=n*Math.sin(.5*Math.PI-2*Math.PI/this.clusterCenters.length*t);this.cameraDetail.position.x=i,this.cameraDetail.position.y=r,this.cameraDetail.lookAt(i,r,0),document.getElementById("selectedClusterCenterTimeTubes").appendChild(this.detailRenderer.domElement),document.getElementById("selectedClusterCenterTimeTubesRenderer").addEventListener("mousedown",this.onMouseDownClusterCenterTimeTubesRenderer().bind(this),!1)}}},{key:"onMouseDownClusterCenterTimeTubesRenderer",value:function(){return function(t){if(this.queryMode=dh.getMode(),"QBE"===this.queryMode||"QBS"===this.queryMode){var e=t.target;e.classList.add("drag"),this.clickedX=t.pageX-e.offsetLeft,this.clickedY=t.pageY-e.offsetTop,document.body.addEventListener("mousemove",this.onMouseMoveClusterCenterTimeTubesRenderer().bind(this),!1),e.addEventListener("mouseup",this.onMouseUpClusterCenterTimeTubesRenderer().bind(this),!1)}}}},{key:"onMouseMoveClusterCenterTimeTubesRenderer",value:function(){return function(t){var e=document.getElementsByClassName("drag")[0];if(e)switch(e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX+"px",this.queryMode){case"QBE":var n=$("#selectedTimeSliceView"),i=n.offset(),r=n.width(),a=n.height();if(i.left<=t.pageX&&t.pageX<=i.left+r&&i.top<=t.pageY&&t.pageY<=i.top+a){var o=$("#selectedTimeSliceView > .overlayHidingPanel");o.css("display","block"),o.css("width",Math.min(r,a)),o.css("height",Math.min(r,a))}break;case"QBS":var s=$("#QBSSketchPad"),l=s.offset(),u=s.width(),c=s.innerHeight();if(l.left<=t.pageX&&t.pageX<=l.left+u&&l.top<=t.pageY&&t.pageY<=l.top+c){var h=$("#QBSCanvasArea > .overlayHidingPanel");h.css("display","block"),h.css("width",Math.min(u,c)),h.css("height",Math.min(u,c))}}}}},{key:"onMouseUpClusterCenterTimeTubesRenderer",value:function(){return function(t){document.body.removeEventListener("mousemove",this.onMouseMoveClusterCenterTimeTubesRenderer().bind(this),!1);var e=document.getElementsByClassName("drag")[0];e&&(e.removeEventListener("mouseup",this.onMouseUpClusterCenterTimeTubesRenderer.bind(this),!1),e.classList.remove("drag"),e.style.position="static");var n=xh.getSelectedCluster(),i=xh.getClusteringParameters(),r=xh.getSubsequenceParameters();switch(this.queryMode){case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var a=$("#selectedTimeSliceView"),o=a.offset(),s=a.width(),l=a.height();if(o&&o.left<=t.pageX&&t.pageX<=o.left+s&&o.top<=t.pageY&&t.pageY<=o.top+l){for(var u={},c=0;c<i.variables.length;c++)u[i.variables[c]]=[];for(var h=0;h<i.variables.length;h++)for(var d=0;d<this.clusterCenters[n].length;d++)u[i.variables[h]].push(this.clusterCenters[n][d][i.variables[h]]);u.arrayLength=this.clusterCenters[n].length;var f={parameters:i,values:u};if(r.normalize){$("#NormalizeSwitch").prop("checked",!0);for(var p=document.getElementById("normalizationOptions"),m=0;m<p.options.length;m++)if("zScore"===p.options[m].value){p.selectedIndex=m;break}$("#NormalizeSwitch").prop("disabled",!0),$("#normalizationOptions").prop("disabled",!0)}switch(i.distanceMetric){case"DTWD":Gc("DTWD");break;case"DTWI":case"DTW":Gc("DTWI")}$("#warpingWindowSize").val(i.window),Nc(i.variables),Hc(f)}break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var g=$("#QBSSketchPad"),v=g.offset(),y=g.width(),b=g.innerHeight();if(v&&v.left<=t.pageX&&t.pageX<=v.left+y&&v.top<=t.pageY&&t.pageY<=v.top+b){for(var x={},_=0;_<i.variables.length;_++)x[i.variables[_]]=[];for(var w=0;w<i.variables.length;w++)for(var S=0;S<this.clusterCenters[n].length;S++)x[i.variables[w]].push(this.clusterCenters[n][S][i.variables[w]]);x.arrayLength=this.clusterCenters[n].length;var E={parameters:i,subsequenceParameters:xh.getSubsequenceParameters(),values:x};if(r.normalize){$("#NormalizeSwitch").prop("checked",!0);for(var M=document.getElementById("normalizationOptions"),C=0;C<M.options.length;C++)if("zScore"===M.options[C].value){M.selectedIndex=C;break}}Gc("DTWD"),$("#warpingWindowSize").val(i.window),Hc(E)}}}}},{key:"resetDetailView",value:function(){if($("#selectedClusterCenterTimeTubes").length){var t=$("#selectedClusterCenterTimeTubes").width()-32;this.detailRenderer.setSize(t,t),this.cameraDetail.position.x=0,this.cameraDetail.position.y=0,this.cameraDetail.lookAt(0,0,0)}}},{key:"addControls",value:function(){this.controls=new Eh.a(this.camera,this.renderer.domElement),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"onMouseClick",value:function(){return function(t){var e=this.getIntersectedIndex(t);e&&wp(e=Number(e.split("_")[1]))}}},{key:"getIntersectedIndex",value:function(t){var e,n=new Ru.Vector2;n.x=t.offsetX/this.renderer.domElement.clientWidth*2-1,n.y=-t.offsetY/this.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(n,this.camera);for(var i=0;i<this.labels.length;i++){var r=this.raycaster.intersectObject(this.labels[i]);if(r.length>0){e=r[0].object.name;break}}return e}},{key:"setCameras",value:function(t,e){var n=2*Math.tan(22.5*Math.PI/180),i=t/e;this.cameraSet={},this.cameraSet.perspective=new Ru.PerspectiveCamera(45,i,.1,1e3);var r=n*this.cameraPosZ,a=n*this.cameraPosZ*i;this.cameraSet.orthographic=new Ru.OrthographicCamera(-a/2,a/2,r/2,-r/2,.1,1e3),this.camera=this.cameraSet.orthographic,this.camera.position.z=this.cameraPosZ,this.camera.lookAt(this.scene.position);var o=.7*xh.getGridSize();this.cameraDetail=new Ru.OrthographicCamera(-o/2,o/2,o/2,-o/2,.1,1e3),this.cameraDetail.position.z=this.cameraPosZ}},{key:"setCameraDetail",value:function(){var t=.7*xh.getViewportSize();this.cameraDetail=new Ru.OrthographicCamera(-t/2,t/2,t/2,-t/2,.1,1e3),this.cameraDetail.position.z=this.cameraPosZ}},{key:"computeSplines",value:function(){this.minmax={},this.splines=[],this.range=void 0;var t=xh.getClusteringParameters().variables;if(this.minmax.x=[1/0,-1/0],this.minmax.y=[1/0,-1/0],this.minmax.H=[1/0,-1/0],this.minmax.V=[1/0,-1/0],t.indexOf("x")>=0&&t.indexOf("y")>=0)for(var e=0;e<this.clusterCenters.length;e++){for(var n=[],i=[],r=[],a=0;a<this.clusterCenters[e].length;a++){var o=this.clusterCenters[e][a],s={x:o.x,y:o.y,r_x:"r_x"in o?o.r_x:.5,r_y:"r_y"in o?o.r_y:.5,H:"H"in o?o.H:.5,V:"V"in o?o.V:.5};for(var l in n.push(new Ru.Vector3(s.x,s.y,a)),i.push(new Ru.Vector3(s.r_x,s.r_y,a)),r.push(new Ru.Vector3(s.H,s.V,a)),this.minmax)s[l]<this.minmax[l][0]&&(this.minmax[l][0]=s[l]),this.minmax[l][1]<s[l]&&(this.minmax[l][1]=s[l])}var u={};u.position=new Ru.CatmullRomCurve3(n,!1,"catmullrom"),u.radius=new Ru.CatmullRomCurve3(i,!1,"catmullrom"),u.color=new Ru.CatmullRomCurve3(r,!1,"catmullrom"),this.splines.push(u)}else if(t.indexOf("PA")>=0&&t.indexOf("PD")>=0)for(var c=0;c<this.clusterCenters.length;c++){for(var h=[],d=[],f=[],p=0;p<this.clusterCenters[c].length;p++){var m=this.clusterCenters[c][p],g=m.PA*Math.PI/180,v={x:m.PD*Math.cos(2*g),y:m.PD*Math.sin(2*g),r_x:"r_x"in m?m.r_x:.5,r_y:"r_y"in m?m.r_y:.5,H:"H"in m?m.H:.5,V:"V"in m?m.V:.5};for(var y in h.push(new Ru.Vector3(v.x,v.y,p)),d.push(new Ru.Vector3(v.r_x,v.r_y,p)),f.push(new Ru.Vector3(v.H,v.V,p)),this.minmax)v[y]<this.minmax[y][0]&&(this.minmax[y][0]=v[y]),this.minmax[y][1]<v[y]&&(this.minmax[y][1]=v[y])}var b={};b.position=new Ru.CatmullRomCurve3(h,!1,"catmullrom"),b.radius=new Ru.CatmullRomCurve3(d,!1,"catmullrom"),b.color=new Ru.CatmullRomCurve3(f,!1,"catmullrom"),this.splines.push(b)}else if((t.indexOf("x")>=0||t.indexOf("y")>=0)&&(t.indexOf("PA")>=0||t.indexOf("PD")>=0))for(var x=0;x<this.clusterCenters.length;x++){for(var _=[],w=[],S=[],E=0;E<this.clusterCenters[x].length;E++){var M=this.clusterCenters[x][E],C=void 0,T=void 0;if(t.indexOf("PA")>=0)if(t.indexOf("x")>=0){C=M.x;var k=M.PA*Math.PI/180;90<M.PA&&(k=(M.PA-180)*Math.PI/180),T=Math.tan(2*k)*M.x}else t.indexOf("y")>=0&&(C=M.y/Math.sin(2*M.PA)*Math.cos(2*M.PA),T=M.y);else if(t.indexOf("PD")>=0){var P=void 0;t.indexOf("x")>=0?(P=Math.acos(M.x/M.PD)/2,C=M.x,T=M.PD*Math.sin(2*P)):t.indexOf("y")>=0&&(P=Math.asin(M.y/M.PD)/2,C=M.PD*Math.cos(2*P),T=M.y)}var A={x:C,y:T,r_x:"r_x"in M?M.r_x:.5,r_y:"r_y"in M?M.r_y:.5,H:"H"in M?M.H:.5,V:"V"in M?M.V:.5};for(var O in _.push(new Ru.Vector3(A.x,A.y,E)),w.push(new Ru.Vector3(A.r_x,A.r_y,E)),S.push(new Ru.Vector3(A.H,A.V,E)),this.minmax)A[O]<this.minmax[O][0]&&(this.minmax[O][0]=A[O]),this.minmax[O][1]<A[O]&&(this.minmax[O][1]=A[O])}var L={};L.position=new Ru.CatmullRomCurve3(_,!1,"catmullrom"),L.radius=new Ru.CatmullRomCurve3(w,!1,"catmullrom"),L.color=new Ru.CatmullRomCurve3(S,!1,"catmullrom"),this.splines.push(L)}else if(t.indexOf("x")>=0||t.indexOf("y")>=0)for(var R=0;R<this.clusterCenters.length;R++){for(var I=[],N=[],D=[],z=0;z<this.clusterCenters[R].length;z++){var B=this.clusterCenters[R][z],F={x:"x"in B?B.x:0,y:"y"in B?B.y:0,r_x:"r_x"in B?B.r_x:.5,r_y:"r_y"in B?B.r_y:.5,H:"H"in B?B.H:.5,V:"V"in B?B.V:.5};for(var V in I.push(new Ru.Vector3(F.x,F.y,z)),N.push(new Ru.Vector3(F.r_x,F.r_y,z)),D.push(new Ru.Vector3(F.H,F.V,z)),this.minmax)F[V]<this.minmax[V][0]&&(this.minmax[V][0]=F[V]),this.minmax[V][1]<F[V]&&(this.minmax[V][1]=F[V])}var j={};j.position=new Ru.CatmullRomCurve3(I,!1,"catmullrom"),j.radius=new Ru.CatmullRomCurve3(N,!1,"catmullrom"),j.color=new Ru.CatmullRomCurve3(D,!1,"catmullrom"),this.splines.push(j)}else if(t.indexOf("PA")>=0||t.indexOf("PD")>=0)for(var U=0;U<this.clusterCenters.length;U++){for(var H=[],G=[],W=[],q=0;q<this.clusterCenters[U].length;q++){var $=this.clusterCenters[U][q],Q=void 0,Y=void 0;if(t.indexOf("PA")>=0)Q=1*Math.cos(2*$.PA),Y=1*Math.sin(2*$.PA);else if(t.indexOf("PD")>=0){var X=.5*Math.PI/180;Q=$.PD*Math.cos(X),Y=$.PD*Math.sin(X)}var Z={x:Q,y:Y,r_x:"r_x"in $?$.r_x:.5,r_y:"r_y"in $?$.r_y:.5,H:"H"in $?$.H:.5,V:"V"in $?$.V:.5};for(var J in H.push(new Ru.Vector3(Z.x,Z.y,q)),G.push(new Ru.Vector3(Z.r_x,Z.r_y,q)),W.push(new Ru.Vector3(Z.H,Z.V,q)),this.minmax)Z[J]<this.minmax[J][0]&&(this.minmax[J][0]=Z[J]),this.minmax[J][1]<Z[J]&&(this.minmax[J][1]=Z[J])}var K={};K.position=new Ru.CatmullRomCurve3(H,!1,"catmullrom"),K.radius=new Ru.CatmullRomCurve3(G,!1,"catmullrom"),K.color=new Ru.CatmullRomCurve3(W,!1,"catmullrom"),this.splines.push(K)}var tt=this.minmax.x[1]-this.minmax.x[0],et=this.minmax.y[1]-this.minmax.y[0],nt=Math.round(Math.max(tt,et)*Math.pow(10,2-Math.ceil(Math.log10(Math.max(tt,et)))));this.range=xh.getGridSize()/(5*Math.ceil(nt/5)*Math.pow(10,-(2-Math.ceil(Math.log10(Math.max(tt,et))))))}},{key:"drawClusterCentersAsTubes",value:function(){void 0===this.texture?(new Ru.TextureLoader).load("img/1_256.png",function(t){this.texture=t,this.drawTubes()}.bind(this)):this.drawTubes(),this.drawAxes(),this.drawLabels()}},{key:"drawTubes",value:function(){for(var t=0;t<this.tubes.length;t++){var e=this.tubes[t].geometry,n=this.tubes[t].material;this.scene.remove(this.tubes[t]),e.dispose(),n.dispose(),this.tubes[t]=void 0}this.tubes=[];for(var i=xh.getClusteringParameters().variables,r=xh.getSubsequenceParameters().isometryLen+1,a=this.division*r,o=2*Math.PI/(this.segment-1),s=.7*xh.getViewportSize(),l=0;l<this.splines.length;l++){var u=void 0,c=[],h=[],d=[],f=this.splines[l].position.getSpacedPoints(a),p=this.splines[l].radius.getSpacedPoints(a),m=this.splines[l].color.getSpacedPoints(a),g=s*Math.cos(.5*Math.PI-2*Math.PI/this.clusterCenters.length*l),v=s*Math.sin(.5*Math.PI-2*Math.PI/this.clusterCenters.length*l);if("r_x"in i||"r_y"in i){for(var y=this.opacityCurve.getSpacedPoints(this.tubeNum),b=[],x=1;x<=this.tubeNum;x++)b.push(1-(1-y[x-1].y)/(1-y[x].y));for(var _=0;_<this.tubeNum;_++)c[_]=[],h[_]=[];for(var w=0;w<=a;w++)for(var S=("r_x"in this.clusterCenters[0][0]?p[w].x*this.range:.5),E=("r_y"in this.clusterCenters[0][0]?p[w].y*this.range:.5),M=0;M<this.segment;M++){for(var C=0;C<this.tubeNum;C++){var T=1/this.tubeNum*(C+1),k=o*M;c[C].push(-1*(g+f[w].x*this.range+T*S*Math.cos(k))),c[C].push(v+f[w].y*this.range+T*E*Math.sin(k)),c[C].push(f[w].z),h[C].push(m[w].x),h[C].push(m[w].y),h[C].push(b[C])}M!==this.segment-1&&(d.push(M+w*this.segment),d.push(M+this.segment+w*this.segment),d.push(M+1+w*this.segment),d.push(M+this.segment+w*this.segment),d.push(M+1+this.segment+w*this.segment),d.push(M+1+w*this.segment))}d=d.slice(0,-1*this.segment*3*2);for(var P=new Float32Array(c[0].length),A=[],O=0;O<this.tubeNum;O++){var L=new Ru.BufferGeometry;L.setAttribute("position",new Ru.BufferAttribute(new Float32Array(c[O]),3)),L.setAttribute("normal",new Ru.BufferAttribute(P,3)),L.setAttribute("colorData",new Ru.BufferAttribute(new Float32Array(h[O]),3)),L.setIndex(new Ru.BufferAttribute(new Uint32Array(d),1)),L.computeVertexNormals(),A.push(L)}u=wh.mergeBufferGeometries(A)}else{for(var R=0;R<=a;R++)for(var I=0;I<this.segment;I++){var N=o*I;c.push(-1*(g+f[R].x*this.range+.5*Math.cos(N))),c.push(v+f[R].y*this.range+.5*Math.sin(N)),c.push(f[R].z),h.push(m[R].x),h.push(m[R].y),h.push(1),I!==this.segment-1&&(d.push(I+R*this.segment),d.push(I+this.segment+R*this.segment),d.push(I+1+R*this.segment),d.push(I+this.segment+R*this.segment),d.push(I+1+this.segment+R*this.segment),d.push(I+1+R*this.segment))}d=d.slice(0,-1*this.segment*3*2);var D=new Float32Array(c.length);(u=new Ru.BufferGeometry).setAttribute("position",new Ru.BufferAttribute(new Float32Array(c),3)),u.setAttribute("normal",new Ru.BufferAttribute(D,3)),u.setAttribute("colorData",new Ru.BufferAttribute(new Float32Array(h),3)),u.setIndex(new Ru.BufferAttribute(new Uint32Array(d),1)),u.computeVertexNormals()}var z=new Ru.ShaderMaterial({vertexShader:this.vertex,fragmentShader:this.fragment,uniforms:{lightPosition:{value:new Ru.Vector3(-20,40,60)},shade:{value:!0},texture:{value:this.texture},minmaxH:{value:new Ru.Vector2(this.minmax.H[0],this.minmax.H[1])},minmaxV:{value:new Ru.Vector2(this.minmax.V[0],this.minmax.V[1])},flagH:{value:!0},flagV:{value:!0}},side:Ru.DoubleSide,transparent:!0}),B=new Ru.Mesh(u,z);B.rotateY(Math.PI),this.scene.add(B),this.tubes.push(B)}}},{key:"drawAxes",value:function(){for(var t=0;t<this.axes.length;t++){var e=this.axes[t].geometry,n=this.axes[t].material;this.scene.remove(this.axes[t]),this.axes[t]=void 0,e.dispose(),n.dispose()}this.axes=[];for(var i=.7*xh.getGridSize(),r=.7*xh.getViewportSize(),a=0;a<this.clusterCenters.length;a++){var o=new Ru.BufferGeometry,s=new Ru.LineBasicMaterial({color:"white",opacity:.5}),l=[],u=[],c=0;l.push(-1*i,0,0),l.push(i,0,0),l.push(0,i,0),l.push(0,-1*i,0),l.push(0,0,0),l.push(0,0,this.clusterCenters[a].length),u.push(c+0,c+1,c+2,c+3,c+4,c+5),c+=6,o.setIndex(u),o.setAttribute("position",new Ru.Float32BufferAttribute(l,3)),this.axes.push(new Ru.LineSegments(o,s)),this.axes[this.axes.length-1].rotateY(Math.PI);var h=r*Math.cos(.5*Math.PI-2*Math.PI/this.clusterCenters.length*a),d=r*Math.sin(.5*Math.PI-2*Math.PI/this.clusterCenters.length*a);this.axes[this.axes.length-1].translateX(h),this.axes[this.axes.length-1].translateY(d),this.scene.add(this.axes[this.axes.length-1])}}},{key:"drawLabels",value:function(){for(var t=0;t<this.labels.length;t++)this.scene.remove(this.labels[t]),this.labels[t].dispose(),this.labels[t]=void 0;this.labels=[];for(var e=.7*xh.getGridSize(),n=.7*xh.getViewportSize(),i=0;i<this.clusterCenters.length;i++){var r=new Bm.a({alignment:"center",color:"hsl("+this.clusterColors[i][0]+","+100*this.clusterColors[i][1]+"%,"+100*this.clusterColors[i][2]+"%)",fontFamily:"Arial, Helvetica, sans-serif",textSize:.8,text:"Cluster "+i});r.name="Cluster_"+i,this.labels.push(r);var a=n*Math.cos(.5*Math.PI-2*Math.PI/this.clusterCenters.length*i),o=n*Math.sin(.5*Math.PI-2*Math.PI/this.clusterCenters.length*i)+e;this.labels[this.labels.length-1].position.set(a,o,-3),this.scene.add(this.labels[this.labels.length-1])}}}])&&Vm(e.prototype,n),i&&Vm(e,i),o}(r.a.Component);function qm(t){return(qm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qm(t,e){return(Qm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ym(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Zm(t);if(e){var r=Zm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Xm(this,n)}}function Xm(t,e){return!e||"object"!==qm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zm(t){return(Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Jm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qm(t,e)}(o,t);var e,n,i,a=Ym(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:30,right:10,top:20,bottom:20},t.paddingCard=16,t.areaPadding={left:16,right:16,top:8,bottom:8},t.queryMode,t.clickedX,t.clickedY,t.clusterCenters,t.clusterColors,t.subsequences,t.datasetsIdx,t.labels,t.clusteringScores,t.subsequenceParameters,t.variables,t.state={cluster:-1},t}return e=o,(n=[{key:"render",value:function(){var t,e,n,i,a,o=this;return t=this.clusterCenterTimeTubesView(),e=this.clusterCenterLineCharts(),n=this.subsequenceLengthDistribution(),i=this.clusterFeatureTable(),a=this.subsequencesOverview(),r.a.createElement("div",{id:"clusteringDetail",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)},ref:function(t){o.mount=t}},t,e,n,i,a)}},{key:"componentDidMount",value:function(){var t=this;xh.on("showClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.clusterColors=xh.getClusterColors(),t.labels=xh.getLabels(),t.subsequences=xh.getSubsequences(),t.datasetsIdx=xh.getDatasets(),t.clusteringScores=xh.getClusteringScores(),t.subsequenceParameters=xh.getSubsequenceParameters()})),xh.on("showClusterDetails",(function(e){t.variables=xh.getClusteringParameters().variables,t.variables=t.variables.filter((function(t){return"z"!==t})),t.createVariableLabels(),t.extractSubsequencesInCluster(e),t.setState({cluster:e})})),xh.on("updateClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.labels=xh.getLabels(),t.subsequences=xh.getSubsequences(),t.clusteringScores=xh.getClusteringScores(),t.extractSubsequencesInCluster(-1),t.setState({cluster:-1})})),xh.on("resetClusteringResults",(function(){t.clusterCenters=xh.getClusterCenters(),t.labels=xh.getLabels(),t.subsequences=xh.getSubsequences(),t.clusteringScores=xh.getClusteringScores(),t.extractSubsequencesInCluster(-1),t.setState({cluster:-1})})),xh.on("updateSSSelection",(function(){t.showSSStatus()}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringDetail");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"componentDidUpdate",value:function(){this.drawClusterCenterLineCharts(),this.drawSubsequenceLengthHistogram(),this.drawSparklinesTable(),this.showSSStatus()}},{key:"clusterCenterTimeTubesView",value:function(){return r.a.createElement("div",{id:"selectedClusterCenterTimeTubes",className:"resultAreaElem"})}},{key:"clusterCenterLineCharts",value:function(){return r.a.createElement("div",{id:"selectedClusterCenterLineCharts",className:"resultAreaElem"})}},{key:"subsequenceLengthDistribution",value:function(){return r.a.createElement("div",{id:"subsequenceLengthHistogram",className:"resultAreaElem"})}},{key:"clusterFeatureTable",value:function(){var t,e=this;return this.state.cluster>=0&&function(){var n=$("#clusteringDetail").width()-2*e.paddingCard,i=0,a=0,o={};e.variables.forEach((function(t){o[t]=0}));for(var s=function(t){if(i+=e.SSCluster[t].dataPoints.length,a+=e.SSCluster[t].dataPoints[e.SSCluster[t].dataPoints.length-1].z-e.SSCluster[t].dataPoints[0].z,!1===e.subsequenceParameters.normalize)for(var n=function(n){e.variables.forEach((function(i){o[i]+=e.SSCluster[t].dataPoints[n][i]}))},r=0;r<e.SSCluster[t].dataPoints.length;r++)n(r)},l=0;l<e.SSCluster.length;l++)s(l);e.variables.forEach((function(t){o[t]/=i})),i/=e.SSCluster.length,a/=e.SSCluster.length;var u=[];!1===e.subsequenceParameters.normalize&&e.variables.forEach((function(t){u.push(r.a.createElement("tr",{key:t},r.a.createElement("td",{style:{width:n/2}},"Average of ",e.variableLabels[t]),r.a.createElement("td",{className:"clusterFeaturesValues",style:{width:n/2}},cd(o[t]))))})),t=r.a.createElement("table",{id:"clusterFeatureTable",className:"table table-hover",style:{width:n,marginBottom:"unset"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{width:n/2}},"Member number"),r.a.createElement("td",{className:"clusterFeaturesValues",style:{width:n/2}},e.SSCluster.length)),r.a.createElement("tr",null,r.a.createElement("td",{style:{width:n/2}},"Cluster radius"),r.a.createElement("td",{className:"clusterFeaturesValues",style:{width:n/2}},cd(e.clusteringScores.clusterRadiuses[e.state.cluster]))),r.a.createElement("tr",null,r.a.createElement("td",{style:{width:n/2}},"Average data point number"),r.a.createElement("td",{className:"clusterFeaturesValues",style:{width:n/2}},cd(i))),r.a.createElement("tr",null,r.a.createElement("td",{style:{width:n/2}},"Average period"),r.a.createElement("td",{className:"clusterFeaturesValues",style:{width:n/2}},cd(a))),u))}(),r.a.createElement("div",{id:"clusterFeature",className:"resultAreaElem"},t)}},{key:"subsequencesOverview",value:function(){if(this.state.cluster>=0){var t=$("#clusteringDetail").width()-this.areaPadding.left-this.areaPadding.right,e=(t-30)/this.variables.length,n=[];n.push("");for(var i=0;i<this.variables.length;i++)this.variableLabels[this.variables[i]].length>1?n.push(this.variableLabels[this.variables[i]].join(", ")):n.push(this.variableLabels[this.variables[i]]);for(var a=[],o=0;o<n.length;o++)a.push(r.a.createElement("th",{key:o,id:0===o?"subsequencesOverviewTableTh_checkbox":"subsequencesOverviewTableTh_"+this.variables[o-1],style:{width:0===o?30:e,height:30}},n[o]));for(var s=r.a.createElement("thead",{style:{width:t,height:30},id:"subsequencesOverviewTableHeader"},r.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},a)),l=[],u=0;u<this.SSCluster.length;u++){var c=[],h=this.SSCluster[u].id,d=this.SSCluster[u].idx;c.push(r.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},r.a.createElement("input",{type:"checkbox",className:"subsequenceDetailCheckbox",name:"subsequenceSelector",id:"selectSSDetail_"+h+"_"+d,onClick:this.onClickSSSelector().bind(this)})));for(var f=0;f<this.variables.length;f++)c.push(r.a.createElement("td",{key:this.variables[f],id:"subsequenceDetailTd_"+h+"_"+d+"_"+this.variables[f],style:{width:e,height:30}}));l.push(r.a.createElement("tr",{id:"subsequenceDetailTr_"+h+"_"+d,key:"subsequenceDetailTr_"+h+"_"+d,style:{width:t,height:30},onMouseOver:this.onMouseOverSubsequenceDetailTr().bind(this),onMouseOut:this.onMouseOutSubsequenceDetailTr().bind(this),onDoubleClick:this.onDoubleClickSubsequenceDetailTr().bind(this)},c))}return r.a.createElement("div",{id:"subsequencesOverview",className:"resultAreaElem"},r.a.createElement("table",{id:"subsequencesOverviewTable",className:"table table-hover sparkTable",style:{width:t}},s,r.a.createElement("tbody",{id:"subsequencesOverviewTableBody"},l)))}}},{key:"extractSubsequencesInCluster",value:function(t){var e=this;if(this.SSCluster=[],this.yMinMax={},t>=0){this.variables.forEach(function(t){this.yMinMax[t]=[1/0,-1/0]}.bind(this));for(var n=function(n){if("object"===qm(e.labels[n])){if(e.labels[n].cluster===t){e.SSCluster.push(e.subsequences[n]);for(var i=function(t){e.variables.forEach(function(e){this.subsequences[n][t][e]<this.yMinMax[e][0]&&(this.yMinMax[e][0]=this.subsequences[n][t][e]),this.yMinMax[e][1]<this.subsequences[n][t][e]&&(this.yMinMax[e][1]=this.subsequences[n][t][e])}.bind(e))},r=0;r<e.subsequences[n].length;r++)i(r)}}else if(e.labels[n]===t){e.SSCluster.push(e.subsequences[n]);for(var a=function(t){e.variables.forEach(function(e){this.subsequences[n][t][e]<this.yMinMax[e][0]&&(this.yMinMax[e][0]=this.subsequences[n][t][e]),this.yMinMax[e][1]<this.subsequences[n][t][e]&&(this.yMinMax[e][1]=this.subsequences[n][t][e])}.bind(e))},o=0;o<e.subsequences[n].length;o++)a(o)}},i=0;i<this.labels.length;i++)n(i)}}},{key:"createVariableLabels",value:function(){for(var t={},e=0;e<this.datasetsIdx.length;e++){var n=Gu.getData(this.datasetsIdx[e]).data.lookup;for(var i in n)if(i in t)for(var r=0;r<n[i].length;r++)t[i].indexOf(n[i][r])<0&&t[i].push(n[i][r]);else t[i]=n[i]}this.variableLabels=t}},{key:"drawClusterCenterLineCharts",value:function(){var t=this;if($("#clusterCenterLineChartsSVG").remove(),this.state.cluster>=0)for(var e=$("#clusteringDetail").width()-2*this.paddingCard,n=e/2,i=e/2*.6,r=se("#selectedClusterCenterLineCharts").append("svg").attr("id","clusterCenterLineChartsSVG").attr("width",e).attr("height",i*Math.ceil(this.variables.length/2)),a=function(e){var a=Ca().domain([0,t.clusterCenters[t.state.cluster].length-1]).range([n*(e%2)+t.margin.left,n*(e%2)+n-t.margin.right]),o=Ca().domain(t.yMinMax[t.variables[e]]).range([i*Math.floor(e/2)+i-t.margin.bottom,i*Math.floor(e/2)+t.margin.top]),s=V(a).ticks(5),l=j(o).ticks(5).tickFormat(ud),u=n*(e%2),c=i*Math.floor(e/2);r.append("g").attr("transform","translate(0,"+(c+i-t.margin.bottom)+")").call(s),r.append("g").attr("transform","translate("+(u+t.margin.left)+",0)").call(l);for(var h=0;h<t.SSCluster.length;h++)r.append("path").datum(t.SSCluster[h]).attr("fill","none").attr("stroke","lightgray").attr("stroke-width",.7).attr("class","clusterMemberLineChart_"+t.SSCluster[h].id+"_"+t.SSCluster[h].idx).attr("id","clusterMemberLineChart_"+t.SSCluster[h].id+"_"+t.SSCluster[h].idx+"_"+t.variables[e]).attr("d",Us().x((function(t,e){return a(e)})).y(function(t){return o(t[this.variables[e]])}.bind(t)).curve(el.alpha(1)));r.append("path").datum(t.clusterCenters[t.state.cluster]).attr("fill","none").attr("stroke",Fe(t.clusterColors[t.state.cluster][0],t.clusterColors[t.state.cluster][1],t.clusterColors[t.state.cluster][2])).attr("stroke-width",1.5).attr("d",Us().x((function(t,e){return a(e)})).y(function(t){return o(t[this.variables[e]])}.bind(t)).curve(el.alpha(1)));var d="";d=t.variableLabels[t.variables[e]].length>1?t.variableLabels[t.variables[e]].join(", "):t.variableLabels[t.variables[e]],r.append("text").attr("x",u+n/2).attr("y",c+t.margin.top/2).attr("fill","black").attr("font-size","0.5rem").attr("text-anchor","middle").text(d)},o=0;o<this.variables.length;o++)a(o)}},{key:"drawSubsequenceLengthHistogram",value:function(){if($("#subsequenceLengthHistogramSVG").remove(),this.state.cluster>=0){var t=$("#clusteringDetail").width()-2*this.paddingCard,e=.3*t,n={left:30,right:10,top:5,bottom:20},i=se("#subsequenceLengthHistogram").append("svg").attr("id","subsequenceLengthHistogramSVG").attr("width",t).attr("height",e),r=xh.getSubsequenceParameters().SSperiod,a=Ca().domain(r).range([n.left,t-n.right]);i.append("g").attr("transform","translate(0,"+(e-n.bottom)+")").call(V(a));for(var o=[],s=0;s<this.labels.length;s++)("object"===qm(this.labels[s])?this.labels[s].cluster:this.labels[s])===this.state.cluster&&o.push(this.subsequences[s]);var l=T().value((function(t){return t[t.length-1].z-t[0].z})).domain(r).thresholds(a.ticks(10))(o),u=Ca().range([e-n.bottom,n.top]).domain([0,k(l,(function(t){return t.length}))]);if(i.append("g").attr("transform","translate("+n.left+",0)").call(j(u).ticks(5)),1===this.datasetsIdx.length){var c=tc.getPlotColor(this.datasetsIdx[0]);i.selectAll("rect").data(l).enter().append("rect").attr("class","SSLengthBar").attr("id",(function(t){return"SSLengthBar_"+t.x0})).attr("x",1).attr("transform",(function(t){return"translate("+a(t.x0)+","+u(t.length)+")"})).attr("width",(function(t){return a(t.x1)-a(t.x0)-1})).attr("height",function(t){return e-n.bottom-u(t.length)}.bind(this)).attr("fill",c)}else if(this.datasetsIdx.length>1){for(var h=[],d=0;d<l.length;d++){for(var f={},p=0;p<this.datasetsIdx.length;p++)f[this.datasetsIdx[p]]=0;for(var m=0;m<l[d].length;m++)f[l[d][m].id]++;h.push(f)}for(var g=function(){var t=zs([]),e=rl,n=il,i=al;function r(r){var a,o,s=t.apply(this,arguments),l=r.length,u=s.length,c=new Array(u);for(a=0;a<u;++a){for(var h,d=s[a],f=c[a]=new Array(l),p=0;p<l;++p)f[p]=h=[0,+i(r[p],d,p,r)],h.data=r[p];f.key=d}for(a=0,o=e(c);a<u;++a)c[o[a]].index=a;return n(c,o),c}return r.keys=function(e){return arguments.length?(t="function"==typeof e?e:zs(nl.call(e)),r):t},r.value=function(t){return arguments.length?(i="function"==typeof t?t:zs(+t),r):i},r.order=function(t){return arguments.length?(e=null==t?rl:"function"==typeof t?t:zs(nl.call(t)),r):e},r.offset=function(t){return arguments.length?(n=null==t?il:t,r):n},r}().keys(this.datasetsIdx),v=[],y=0;y<this.datasetsIdx.length;y++)v.push(tc.getPlotColor(this.datasetsIdx[y]));var b=g(h);i.selectAll("g.stackedBarGroup").data(b).enter().append("g").attr("class","stackedBarGroup").style("fill",(function(t,e){return v[e]})).selectAll("rect").data((function(t){return t})).enter().append("rect").attr("x",(function(t,e){return a(l[e].x0)})).attr("y",(function(t,e){return u(t[1])})).attr("width",(function(t,e){return a(l[e].x1)-a(l[e].x0)-1})).attr("height",function(t){return u(t[0])-u(t[1])}.bind(this))}}}},{key:"drawSparklinesTable",value:function(){var t=this;$("#subsequencesOverviewTable svg").remove(),this.state.cluster>=0&&function(){for(var e=$("#clusteringDetail").width()-t.areaPadding.left-t.areaPadding.right,n=(e-30)/t.variables.length,i=n-6,r=[0,xh.getSubsequenceParameters().isometryLen],a={},o=0;o<t.variables.length;o++){a[t.variables[o]]=[1/0,-1/0];for(var s=0;s<t.SSCluster.length;s++)for(var l=0;l<t.SSCluster[s].length;l++)t.SSCluster[s][l][t.variables[o]]<a[t.variables[o]][0]&&(a[t.variables[o]][0]=t.SSCluster[s][l][t.variables[o]]),a[t.variables[o]][1]<t.SSCluster[s][l][t.variables[o]]&&(a[t.variables[o]][1]=t.SSCluster[s][l][t.variables[o]])}for(var u=Ca().range([1,i-1]).domain(r),c={},h={},d=function(e){c[t.variables[e]]=Ca().range([23,1]).domain(a[t.variables[e]]).nice(),h[t.variables[e]]=Us().x((function(t,e){return u(e)})).y(function(t){return c[this.variables[e]](t[this.variables[e]])}.bind(t)).curve(el.alpha(1))},f=0;f<t.variables.length;f++)d(f);for(var p={},m=0;m<t.datasetsIdx.length;m++)p[t.datasetsIdx[m]]=tc.getPlotColor(t.datasetsIdx[m]);for(var g=0;g<t.variables.length;g++)se("#subsequencesOverviewTableTh_"+t.variables[g]).attr("width",n);se("#subsequencesOverviewTable").attr("height",Math.min(e,30*(t.SSCluster.length+1))),se("#subsequencesOverviewTableBody").attr("height",Math.min(e,30*t.SSCluster.length));for(var v=function(e){for(var n=t.SSCluster[e].id,a=t.SSCluster[e].idx,o=function(o){var s=se("#subsequenceDetailTd_"+n+"_"+a+"_"+t.variables[o]).append("svg").attr("id","subsequenceDetailSVG_"+n+"_"+a+"_"+t.variables[o]).attr("class","spark").attr("width",i).attr("height",24).append("g");s.datum(t.SSCluster[e]).append("path").attr("fill","none").attr("stroke",p[t.SSCluster[e].id]).attr("stroke-width",1.5).attr("d",function(t,e){return h[this.variables[o]](t)}.bind(t)),s.selectAll("circle").data(t.SSCluster[e].dataPoints).enter().append("circle").attr("cx",function(t){var n=(t.z-this.SSCluster[e].dataPoints[0].z)/(this.SSCluster[e].dataPoints[this.SSCluster[e].dataPoints.length-1].z-this.SSCluster[e].dataPoints[0].z)*r[1];return u(n)}.bind(t)).attr("cy",function(t){return c[this.variables[o]](t[this.variables[o]])}.bind(t)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},s=0;s<t.variables.length;s++)o(s)},y=0;y<t.SSCluster.length;y++)v(y)}()}},{key:"showSSStatus",value:function(){var t=xh.getSelectedSS(),e=xh.getUpdatedSS();for(var n in t)for(var i=0;i<t[n].length;i++){var r=t[n][i],a=$("#selectSSDetail_"+n+"_"+r);a.length>0&&a.prop("checked",!0)}for(var o in e)for(var s=0;s<e[o].length;s++){var l=e[o][s].idx,u=$("#subsequenceDetailTr_"+o+"_"+l);u.length>0&&("add"===e[o][s].status?u.addClass("table-success"):"remove"===e[o][s].status&&u.addClass("table-danger"))}}},{key:"onClickSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=Number(n[2]),a=xh.getSelectedSS(),o=xh.getUpdatedSS();if($("#"+t.target.id).prop("checked")){a[i].indexOf(r)<0&&(a[i].push(r),se("#subsequenceDetailTr_"+i+"_"+r).classed("table-danger",!1));for(var s=0;s<o[i].length;s++)if(o[i][s].idx===r){o[i].splice(s,1);break}}else a[i].splice(a[i].indexOf(r),1),o[i].push({idx:r,status:"remove"}),se("#subsequenceDetailTr_"+i+"_"+r).classed("table-danger",!0);Ep(a,o)}}}},{key:"onMouseOverSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){var n,i=$("#tooltipClusteringResults"),r=e.split("_"),a=r[1],o=Number(r[2]),s=0;for(s=0;s<this.subsequences.length;s++)if(this.subsequences[s].id===a&&this.subsequences[s].idx===o){n=this.subsequences[s];break}var l=Gu.getFileName(a),u=[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z],c=n.dataPoints.length,h=this.clusteringScores.silhouetteSS[s],d=window.innerWidth-t.clientX+5,f=window.innerHeight-t.clientY+5;i.html('<table><tbody><tr><td>File name</td><td class="tooltipTableValues">'+l+'</td></tr><tr><td>Period</td><td class="tooltipTableValues">'+u[0]+"-"+u[1]+'</td></tr><tr><td>Data points number</td><td class="tooltipTableValues">'+c+'</td></tr><tr><td>Silhouette coefficient</td><td class="tooltipTableValues">'+cd(h)+"</td></tr></tbody></table>"),i.css({right:d+"px",bottom:f+"px",left:"unset",top:"unset"}),i.css("display","block"),se("#SSLengthBar_"+Math.floor(u[1]-u[0])).attr("stroke","black").attr("stroke-width",1.5),Ds(".clusterMemberLineChart_"+a+"_"+o).attr("stroke","#f26418"),se("#clusterLine_"+a+"_"+o).attr("stroke","black").attr("stroke-width",1.5).moveToFront(),$("#subsequenceTr_"+a+"_"+o).length&&se("#subsequenceTr_"+a+"_"+o).classed("table-active",!0),$("#updatedSubsequenceTr_"+a+"_"+o).length&&se("#updatedSubsequenceTr_"+a+"_"+o).classed("table-active",!0)}}}},{key:"onMouseOutSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=Number(n[2]);$("#tooltipClusteringResults").css("display","none"),Ds(".SSLengthBar").attr("stroke-width",0),Ds(".clusterMemberLineChart_"+i+"_"+r).attr("stroke","lightgray"),se("#clusterLine_"+i+"_"+r).attr("stroke-width",0),$("#subsequenceTr_"+i+"_"+r).length&&se("#subsequenceTr_"+i+"_"+r).classed("table-active",!1),$("#updatedSubsequenceTr_"+i+"_"+r).length&&se("#updatedSubsequenceTr_"+i+"_"+r).classed("table-active",!1)}}}},{key:"onMouseDownSubsequenceDetailTr",value:function(){return function(t){if(this.queryMode=dh.getMode(),"QBE"===this.queryMode||"QBS"===this.queryMode){var e=t.target.id.split("_"),n=document.getElementById("subsequenceDetailTr_"+e[1]+"_"+e[2]);n.classList.add("drag"),this.clickedX=n.offsetLeft,this.clickedY=n.offsetTop,document.body.addEventListener("mousemove",this.onMouseMoveSubsequenceDetailTr().bind(this),!1),n.addEventListener("mouseup",this.onMouseUpSubsequenceDetailTr().bind(this),!1)}}}},{key:"onMouseMoveSubsequenceDetailTr",value:function(){return function(t){var e=document.getElementsByClassName("drag")[0];if(e)switch(e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX+"px",this.queryMode){case"QBE":var n=$("#selectedTimeSliceView"),i=n.offset(),r=n.width(),a=n.height();if(i.left<=t.pageX&&t.pageX<=i.left+r&&i.top<=t.pageY&&t.pageY<=i.top+a){var o=$("#selectedTimeSliceView > .overlayHidingPanel");o.css("display","block"),o.css("width",Math.min(r,a)),o.css("height",Math.min(r,a))}break;case"QBS":var s=$("#QBSSketchPad"),l=s.offset(),u=s.width(),c=s.innerHeight();if(l.left<=t.pageX&&t.pageX<=l.left+u&&l.top<=t.pageY&&t.pageY<=l.top+c){var h=$("#QBSCanvasArea > .overlayHidingPanel");h.css("display","block"),h.css("width",Math.min(u,c)),h.css("height",Math.min(u,c))}}}}},{key:"onMouseUpSubsequenceDetailTr",value:function(){return function(t){document.body.removeEventListener("mousemove",this.onMouseMoveSubsequenceDetailTr().bind(this),!1);var e=document.getElementsByClassName("drag")[0];switch(e&&(e.removeEventListener("mouseup",this.onMouseUpSubsequenceDetailTr.bind(this),!1),e.classList.remove("drag"),e.style.position="static"),this.queryMode){case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var n=$("#selectedTimeSliceView"),i=n.offset(),r=n.width();n.height(),i&&i.left<=t.pageX&&t.pageX<=i.left+r&&i.top<=t.pageY&&(t.pageY,i.top);break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var a=$("#QBSSketchPad"),o=a.offset(),s=a.width();a.innerHeight(),o&&o.left<=t.pageX&&t.pageX<=o.left+s&&o.top<=t.pageY&&(t.pageY,o.top)}this.moveToOriginalPos()}}},{key:"moveToOriginalPos",value:function(){}},{key:"onDoubleClickSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){for(var n,i=e.split("_"),r=i[1],a=Number(i[2]),o=0;o<this.subsequences.length;o++)if(this.subsequences[o].id===r&&this.subsequences[o].idx===a){n=this.subsequences[o];break}$("#tooltipClusteringResults").css("display","none"),ru("visualization"),Lu(Number(r),[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}}])&&$m(e.prototype,n),i&&$m(e,i),o}(r.a.Component);function Km(t){return(Km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tg(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return eg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eg(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eg(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ng(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ig(t,e){return(ig=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=og(t);if(e){var r=og(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ag(this,n)}}function ag(t,e){return!e||"object"!==Km(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function og(t){return(og=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var sg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ig(t,e)}(o,t);var e,n,i,a=rg(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:10,right:10,top:10,bottom:20},t.areaPadding={left:16,right:16,top:8,bottom:8},t.steps=[],t.filteringProcess={},t.yMinMax={},t.updateSparklineTableFlag=!1,t.updataUpdatedSSSparklineTableFlag=!1,t.filteringStepColors=[Ns(1),Ns(.8),Ns(.6),Ns(.4),Ns(.2)],t.filteringNames={normalSlidingWindow:"Normal sliding window",dataDrivenSlidingWindow:"Data-driven sliding window",sameStartingPoint:"Same starting data point",overlappingDegree:"Overlapping degree"},t.state={subsequencesFilteringProcess:[],selectedProcess:"",selectedSS:{},updatedSS:{}},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;xh.on("showClusteringResults",(function(){t.filteringProcess=xh.getFilteringProcess(),t.steps=Object.keys(t.filteringProcess),t.steps=t.steps.filter((function(t){return"subsequences"!==t})),t.steps.sort(function(t,e){var n=0;for(var i in this.filteringProcess[t])n+=this.filteringProcess[t][i].length;var r=0;for(var a in this.filteringProcess[e])r+=this.filteringProcess[e][a].length;return n<r?1:-1}.bind(t)),t.datasetsIdx=xh.getDatasets(),t.variables=xh.getClusteringParameters().variables,t.variables=t.variables.filter((function(t){return"z"!==t})),t.clusterColors=xh.getClusterColors(),t.subsequences=xh.getSubsequences(),t.labels=xh.getLabels(),t.createVariableLabels(),t.filteringSummary(),t.initSparklines(),t.setState({selectedSS:xh.getSelectedSS(),updatedSS:xh.getUpdatedSS()})})),xh.on("showFilteringStep",(function(e){t.updateSparklineTableFlag=!0,t.setState({selectedProcess:e})})),xh.on("updateSSSelection",(function(){t.updataUpdatedSSSparklineTableFlag=!0,t.setState({selectedSS:xh.getSelectedSS(),updatedSS:xh.getUpdatedSS()})}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringProcess");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"componentDidUpdate",value:function(){this.drawSparklinesOfSubsequencesInTheSelectedStep(),this.checkCurrentlySelectedSS(),this.drawSparklinesOfUpdatedSubsequences()}},{key:"render",value:function(){var t,e,n=this;return""!==this.state.selectedProcess?(t=this.subsequencesInTheSelectedStepTable(),e=this.updatedSubsequencesTable()):this.updataUpdatedSSSparklineTableFlag&&(e=this.updatedSubsequencesTable()),r.a.createElement("div",{id:"clusteringProcess",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").height()},ref:function(t){n.mount=t}},r.a.createElement("div",{id:"filteringProcessSummary",className:"resultAreaElem"},r.a.createElement("svg",{id:"filteringProcessSummarySVG"})),r.a.createElement("div",{id:"SSFilteringStep",className:"resultAreaElem"},r.a.createElement("h6",null,"Subsequences in the selected filtering step"),t),r.a.createElement("div",{id:"selectedSSList",className:"resultAreaElem"},r.a.createElement("h6",null,"Subsequences that will be ",r.a.createElement("span",{style:{color:"#80b139"}},"added"),"/",r.a.createElement("span",{style:{color:"#d9534f"}},"removed")),e),r.a.createElement("div",{id:"updateClusteringControllers",className:"resultAreaElem",style:{float:"right"}},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",style:{float:"right"},onClick:this.onClickRunClusteringAgainButton().bind(this)},"Run again"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",style:{float:"right"},onClick:this.onClickClearButton().bind(this)},"Clear")))}},{key:"initSparklines",value:function(){var t=this;this.yMinMax={};for(var e=0;e<this.variables.length;e++)this.yMinMax[this.variables[e]]=[1/0,-1/0];for(var n in this.filteringProcess.subsequences)for(var i=0;i<this.filteringProcess.subsequences[n].length;i++)for(var r=0;r<this.filteringProcess.subsequences[n][i].length;r++)for(var a=0;a<this.variables.length;a++)this.filteringProcess.subsequences[n][i][r][this.variables[a]]<this.yMinMax[this.variables[a]][0]&&(this.yMinMax[this.variables[a]][0]=this.filteringProcess.subsequences[n][i][r][this.variables[a]]),this.yMinMax[this.variables[a]][1]<this.filteringProcess.subsequences[n][i][r][this.variables[a]]&&(this.yMinMax[this.variables[a]][1]=this.filteringProcess.subsequences[n][i][r][this.variables[a]]);for(var o=($("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right-30)/this.variables.length-6,s=[0,xh.getSubsequenceParameters().isometryLen],l=Ca().range([1,o-1]).domain(s),u={},c={},h=function(e){u[t.variables[e]]=Ca().range([23,1]).domain(t.yMinMax[t.variables[e]]).nice(),c[t.variables[e]]=Us().x((function(t,e){return l(e)})).y(function(t){return u[this.variables[e]](t[this.variables[e]])}.bind(t)).curve(el.alpha(1))},d=0;d<this.variables.length;d++)h(d);this.xScale=l,this.yScales=u,this.curves=c}},{key:"createVariableLabels",value:function(){for(var t={},e=0;e<this.datasetsIdx.length;e++){var n=Gu.getData(this.datasetsIdx[e]).data.lookup;for(var i in n)if(i in t)for(var r=0;r<n[i].length;r++)t[i].indexOf(n[i][r])<0&&t[i].push(n[i][r]);else t[i]=n[i]}this.variableLabels=t}},{key:"filteringSummary",value:function(){$("#filteringProcessSummarySVG").children().remove();for(var t=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,e=t-this.margin.left-this.margin.right,n=Math.sqrt(3)*e/2,i=n*this.steps.length/(this.steps.length+1)+this.margin.top+this.margin.bottom,r=.5*e/(this.steps.length+1),a=n/(this.steps.length+1),o=se("#filteringProcessSummarySVG").attr("height",i).attr("width",t),s=0;s<this.steps.length;s++){var l=e*(this.steps.length+1-s)/(this.steps.length+1),u=e*(this.steps.length+1-s-1)/(this.steps.length+1),c=[{x:r*s,y:a*s},{x:r*(s+1),y:a*(s+1)},{x:r*(s+1)+u,y:a*(s+1)},{x:r*s+l,y:a*s},{x:r*s,y:a*s}],h=o.append("g").attr("class","filteringTrapezoidGroup");0!==s&&h.on("click",g),h.append("path").datum(c).attr("class","filteringTrapezoid").attr("id","filteringTrapezoid_"+this.steps[s]).attr("d",Us().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",this.filteringStepColors[s]).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),h.append("text").attr("x",t/2).attr("y",a*s+a/2+this.margin.top).text(this.filteringNames[this.steps[s]]).attr("fill","white").attr("text-anchor","middle").attr("text-weight","bold").attr("height",a).attr("width",u).attr("class","filteringProcessLabel")}for(var d=0;d<this.steps.length;d++){var f=0;for(var p in this.filteringProcess[this.steps[d]])f+=this.filteringProcess[this.steps[d]][p].length;var m=o.append("g").attr("class","filteredSSLabelGroup");m.append("rect").attr("x",t/2-25).attr("y",a*(d+1)-10+this.margin.top).attr("width",50).attr("height",20).attr("fill","white").attr("class","filteredSSRect"),m.append("text").attr("x",t/2).attr("y",a*(d+1)+6+this.margin.top).text(f).attr("fill","#3e3f3a").attr("text-anchor","middle").attr("class","filteredSSNumber").attr("font-size","1rem")}function g(){var t=$("path",this),e=$("text",this),n=t.attr("fill"),i=e.attr("fill");if("white"===n)t.attr("fill",i).attr("stroke-width",0),e.attr("fill","white"),Sp("");else{for(var r=$(this).parent().children("g.filteringTrapezoidGroup"),a=0;a<r.length;a++){var o=r[a].children[0],s=r[a].children[1];"white"===$(o).attr("fill")&&($(o).attr("fill",$(s).attr("fill")).attr("stroke-width",0),$(s).attr("fill","white"))}e.attr("fill",n),t.attr("fill","white").attr("stroke",n).attr("stroke-width","1.5px"),Sp(t.attr("id").split("_")[1])}}}},{key:"subsequencesInTheSelectedStepTable",value:function(){var t=this.steps[this.steps.indexOf(this.state.selectedProcess)-1],e=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,n=(this.mount.clientHeight-$("#filteringProcessSummary").height())/2,i=(e-30)/this.variables.length,a=[];a.push("");for(var o=0;o<this.variables.length;o++)this.variableLabels[this.variables[o]].length>1?a.push(this.variableLabels[this.variables[o]].join(", ")):a.push(this.variableLabels[this.variables[o]]);for(var s=[],l=0;l<a.length;l++)s.push(r.a.createElement("th",{key:l,style:{width:0===l?30:i,height:30}},a[l]));var u=r.a.createElement("thead",{style:{width:e,height:30},id:"subsequencesFilteringProcessTableHeader"},r.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},s)),c=[];this.yMinMax={};for(var h=0;h<this.variables.length;h++)this.yMinMax[this.variables[h]]=[1/0,-1/0];for(var d in this.filteringProcess[t])for(var f=0;f<this.filteringProcess[t][d].length;f++){var p=[],m=this.filteringProcess[t][d][f];p.push(r.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},r.a.createElement("input",{type:"checkbox",className:"subsequenceFilteringCheckbox",name:"subsequenceSelector",id:"selectSSFilteringProcess_"+d+"_"+m,onClick:this.onClickSSSelector().bind(this)})));for(var g=0;g<this.variables.length;g++){p.push(r.a.createElement("td",{key:this.variables[g],id:"subsequenceTd_"+d+"_"+m+"_"+this.variables[g],style:{width:i,height:30}}));for(var v=0;v<this.filteringProcess.subsequences[d][m].length;v++)this.filteringProcess.subsequences[d][m][v][this.variables[g]]<this.yMinMax[this.variables[g]][0]&&(this.yMinMax[this.variables[g]][0]=this.filteringProcess.subsequences[d][m][v][this.variables[g]]),this.yMinMax[this.variables[g]][1]<this.filteringProcess.subsequences[d][m][v][this.variables[g]]&&(this.yMinMax[this.variables[g]][1]=this.filteringProcess.subsequences[d][m][v][this.variables[g]])}c.push(r.a.createElement("tr",{id:"subsequenceTr_"+d+"_"+m,key:"subsequenceTr_"+d+"_"+m,style:{width:e,height:30},onMouseOver:this.onMouseOverFilteringStepSSRow().bind(this),onMouseOut:this.onMouseOutFilteringStepSSRow().bind(this),onClick:this.onClickFilteringStepSSRow().bind(this),onDoubleClick:this.onDoubleClickFilteringStepSSRow().bind(this)},p))}return r.a.createElement("table",{id:"subsequencesFilteringProcessTable",className:"table table-hover sparkTable",style:{width:e,height:n}},u,r.a.createElement("tbody",{id:"subsequencesFilteringProcessTableBody",style:{height:n-30}},c))}},{key:"updatedSubsequencesTable",value:function(){var t=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,e=(this.mount.clientHeight,$("#filteringProcessSummary").height(),(t-30)/this.variables.length),n=[];n.push("");for(var i=0;i<this.variables.length;i++)this.variableLabels[this.variables[i]].length>1?n.push(this.variableLabels[this.variables[i]].join(", ")):n.push(this.variableLabels[this.variables[i]]);for(var a=[],o=0;o<n.length;o++)a.push(r.a.createElement("th",{key:o,style:{width:0===o?30:e,height:30}},n[o]));var s=r.a.createElement("thead",{style:{width:t,height:30},id:"updatedSubsequencesTableHeader"},r.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},a)),l=[];for(var u in this.state.updatedSS)for(var c=0;c<this.state.updatedSS[u].length;c++){var h=[],d=this.state.updatedSS[u][c].idx;h.push(r.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},r.a.createElement("input",{type:"checkbox",className:"subsequenceCheckbox",name:"subsequenceSelector",id:"selectUpdatedSSFilteringProcess_"+u+"_"+d,onClick:this.onClickUpdatedSSSelector().bind(this)})));for(var f=0;f<this.variables.length;f++)h.push(r.a.createElement("td",{key:this.variables[f],id:"updatedSubsequenceTd_"+u+"_"+d+"_"+this.variables[f],style:{width:e,height:30}}));l.push(r.a.createElement("tr",{id:"updatedSubsequenceTr_"+u+"_"+d,key:"updatedSubsequenceTr_"+u+"_"+d,style:{width:t,height:30},onMouseOver:this.onMouseOverUpdatedSSRow().bind(this),onMouseOut:this.onMouseOutUpdatedSSRow().bind(this),onClick:this.onClickUpdatedSSRow().bind(this),onDoubleClick:this.onDoubleClickUpdatedSSRow().bind(this)},h))}return r.a.createElement("table",{id:"updatedSubsequencesTable",className:"table table-hover sparkTable",style:{width:t}},s,r.a.createElement("tbody",{id:"updatedSubsequencesTableBody"},l))}},{key:"onClickSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=Number(n[2]),a=$("#"+t.target.id).prop("checked"),o=!(this.filteringProcess[this.steps[this.steps.length-1]][i].indexOf(r)<0);if(a){var s=this.state.selectedSS;s[i].push(r);var l=this.state.updatedSS;if(o){for(var u=0;u<l[i].length;u++)if(l[i][u].idx===r){l[i].splice(u,1),se("#subsequenceTr_"+i+"_"+r).classed("table-danger",!1);break}}else l[i].push({idx:r,status:"add"}),se("#subsequenceTr_"+i+"_"+r).classed("table-success",!0);this.updataUpdatedSSSparklineTableFlag=!0,this.setState({selectedSS:s,updatedSS:l})}else{var c=this.state.selectedSS;c[i].splice(c[i].indexOf(r),1);var h=this.state.updatedSS;if(o)h[i].push({idx:r,status:"remove"}),se("#subsequenceTr_"+i+"_"+r).classed("table-danger",!0);else for(var d=0;d<h[i].length;d++)if(h[i][d].idx===r){h[i].splice(d,1),se("#subsequenceTr_"+i+"_"+r).classed("table-success",!1);break}this.updataUpdatedSSSparklineTableFlag=!0,Ep(c,h),this.setState({selectedSS:c,updatedSS:h})}}}}},{key:"onClickUpdatedSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=Number(n[2]),a=$("#"+t.target.id).prop("checked"),o=!(this.filteringProcess[this.steps[this.steps.length-1]][i].indexOf(r)<0);if(a){var s=this.state.selectedSS;s[i].push(r);var l=this.state.updatedSS;if(o){for(var u=0;u<l[i].length;u++)if(l[i][u].idx===r){l[i].splice(u,1),se("#subsequenceTr_"+i+"_"+r).classed("table-danger",!1);break}}else l[i].push({idx:r,status:"add"}),se("#subsequenceTr_"+i+"_"+r).classed("table-success",!0);this.updataUpdatedSSSparklineTableFlag=!0,Ep(s,l),this.setState({selectedSS:s,updatedSS:l})}else{var c=this.state.selectedSS;c[i].splice(c[i].indexOf(r),1);var h=this.state.updatedSS;if(o)h[i].push({idx:r,status:"remove"}),se("#subsequenceTr_"+i+"_"+r).classed("table-danger",!0);else for(var d=0;d<h[i].length;d++)if(h[i][d].idx===r){h[i].splice(d,1),se("#subsequenceTr_"+i+"_"+r).classed("table-success",!1);break}this.updataUpdatedSSSparklineTableFlag=!0,Ep(c,h),this.setState({selectedSS:c,updatedSS:h})}}}}},{key:"onClickRunClusteringAgainButton",value:function(){return function(){var t=[];for(var e in this.state.selectedSS)for(var n=0;n<this.state.selectedSS[e].length;n++)t.push(this.filteringProcess.subsequences[e][this.state.selectedSS[e][n]]);var i=tg(function(t,e,n){var i=e.variables.slice();i.push("z");var r,a,o,s={window:e.window,metric:e.distanceMetric,distFunc:_p};switch(e.method){case"kmedoids":if("unified"===e.medoidDefinition){var l=Kf(pp(t,e.clusterNum,s,i),3);r=l[0],a=l[1],o=l[2]}else if("each"===e.medoidDefinition){var u=Kf(fp(t,e.clusterNum,s,i),3);r=u[0],a=u[1],o=u[2]}break;case"kmeans":var c=Kf(mp(t,e.clusterNum,s,i),3);r=c[0],a=c[1],o=c[2]}var h=dp(t,s,e.variables,n),d=np(a,e.clusterNum);return o.pseudoF=ip(o.clusterRadiuses,r,h,d.map((function(t){return t.length})),s,e.variables),[r,a,o]}(t,xh.getClusteringParameters(),xh.getSubsequenceParameters().isometryLen),3);!function(t,e,n,i,r,a){iu.dispatch({type:"UPDATE_CLUSTERING_RESULTS",subsequences:t,clusterCenters:e,labels:n,clusteringScores:i,selectedSS:r,updatedSS:a})}(t,i[0],i[1],i[2],this.state.selectedSS,this.state.updatedSS)}}},{key:"onClickClearButton",value:function(){return function(){iu.dispatch({type:"RESET_CLUSTERING_RESULTS"})}}},{key:"onMouseOverFilteringStepSSRow",value:function(){return function(t){var e=this,n=t.target.id;n&&function(){for(var i=n.split("_"),r=i[1],a=Number(i[2]),o=e.xScale.domain(),s=e.filteringProcess.subsequences[r][a],l=function(t){se("#subsequenceSVG_"+r+"_"+a+"_"+e.variables[t]).select("g").selectAll("circle").data(s.dataPoints).enter().append("circle").attr("cx",function(t){var e=(t.z-s.dataPoints[0].z)/(s.dataPoints[s.dataPoints.length-1].z-s.dataPoints[0].z)*o[1];return this.xScale(e)}.bind(e)).attr("cy",function(e){return this.yScales[this.variables[t]](e[this.variables[t]])}.bind(e)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},u=0;u<e.variables.length;u++)l(u);var c=$("#tooltipClusteringResults"),h=Gu.getFileName(r),d=[s.dataPoints[0].z,s.dataPoints[s.dataPoints.length-1].z],f=s.dataPoints.length,p=t.clientX+5,m=window.innerHeight-t.clientY+5;c.html('<table><tbody><tr><td>File name</td><td class="tooltipTableValues">'+h+'</td></tr><tr><td>Period</td><td class="tooltipTableValues">'+d[0]+"-"+d[1]+'</td></tr><tr><td>Data points number</td><td class="tooltipTableValues">'+f+"</td></tr></tbody></table>"),c.css({left:p+"px",top:"unset",right:"unset",bottom:m+"px"}),c.css("display","block"),$("#updatedSubsequenceTr_"+r+"_"+a).length&&se("#updatedSubsequenceTr_"+r+"_"+a).classed("table-active",!0),$("#clusterLine_"+r+"_"+a).length&&se("#clusterLine_"+r+"_"+a).attr("stroke","black").attr("stroke-width",1.5).moveToFront(),$("#subsequenceDetailTr_"+r+"_"+a).length>0&&(Ds(".clusterMemberLineChart_"+r+"_"+a).attr("stroke","#f26418"),se("#SSLengthBar_"+Math.floor(d[1]-d[0])).attr("stroke","black").attr("stroke-width",1.5),se("#subsequenceDetailTr_"+r+"_"+a).classed("table-active",!0))}()}}},{key:"onMouseOutFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n=e.split("_"),i=n[1],r=n[2],a=0;a<this.variables.length;a++)se("#subsequenceSVG_"+i+"_"+r+"_"+this.variables[a]).select("g").selectAll("circle").remove();$("#tooltipClusteringResults").css("display","none"),$("#updatedSubsequenceTr_"+i+"_"+r).length&&se("#updatedSubsequenceTr_"+i+"_"+r).classed("table-active",!1),$("#clusterLine_"+i+"_"+r).length&&se("#clusterLine_"+i+"_"+r).attr("stroke-width",0),$("#subsequenceDetailTr_"+i+"_"+r).length>0&&(Ds(".clusterMemberLineChart_"+i+"_"+r).attr("stroke","lightgray"),Ds(".SSLengthBar").attr("stroke-width",0),se("#subsequenceDetailTr_"+i+"_"+r).classed("table-active",!1))}}}},{key:"onClickFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=n[2],a=document.getElementById("subsequenceTr_"+i+"_"+r).classList;if(a.length>0)for(var o=0;o<a.length;o++)if(a[o].indexOf("subsequenceTrCluster")>=0){var s=a[o].split("_");wp(Number(s[1]))}}}}},{key:"onDoubleClickFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n,i=e.split("_"),r=i[1],a=Number(i[2]),o=0;o<this.filteringProcess.subsequences[r].length;o++)if(this.filteringProcess.subsequences[r][o].id===r&&this.filteringProcess.subsequences[r][o].idx===a){n=this.filteringProcess.subsequences[r][o];break}$("#tooltipClusteringResults").css("display","none"),ru("visualization"),Lu(Number(r),[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"onMouseOverUpdatedSSRow",value:function(){return function(t){var e=this,n=t.target.id;n&&function(){for(var i=n.split("_"),r=i[1],a=Number(i[2]),o=e.xScale.domain(),s=e.filteringProcess.subsequences[r][a],l=function(t){se("#updateSubsequenceSVG_"+r+"_"+a+"_"+e.variables[t]).select("g").selectAll("circle").data(s.dataPoints).enter().append("circle").attr("cx",function(t){var e=(t.z-s.dataPoints[0].z)/(s.dataPoints[s.dataPoints.length-1].z-s.dataPoints[0].z)*o[1];return this.xScale(e)}.bind(e)).attr("cy",function(e){return this.yScales[this.variables[t]](e[this.variables[t]])}.bind(e)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},u=0;u<e.variables.length;u++)l(u);var c=$("#tooltipClusteringResults"),h=Gu.getFileName(r),d=[s.dataPoints[0].z,s.dataPoints[s.dataPoints.length-1].z],f=s.dataPoints.length,p=t.clientX+5,m=window.innerHeight-t.clientY+5;c.html('<table><tbody><tr><td>File name</td><td class="tooltipTableValues">'+h+'</td></tr><tr><td>Period</td><td class="tooltipTableValues">'+d[0]+"-"+d[1]+'</td></tr><tr><td>Data points number</td><td class="tooltipTableValues">'+f+"</td></tr></tbody></table>"),c.css({left:p+"px",top:"unset",right:"unset",bottom:m+"px"}),c.css("display","block"),$("#subsequenceTr_"+r+"_"+a).length&&se("#subsequenceTr_"+r+"_"+a).classed("table-active",!0),$("#clusterLine_"+r+"_"+a).length&&se("#clusterLine_"+r+"_"+a).attr("stroke","black").attr("stroke-width",1.5).moveToFront(),$("#subsequenceDetailTr_"+r+"_"+a).length>0&&(Ds(".clusterMemberLineChart_"+r+"_"+a).attr("stroke","#f26418"),se("#SSLengthBar_"+Math.floor(d[1]-d[0])).attr("stroke","black").attr("stroke-width",1.5),se("#subsequenceDetailTr_"+r+"_"+a).classed("table-active",!0))}()}}},{key:"onMouseOutUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n=e.split("_"),i=n[1],r=n[2],a=0;a<this.variables.length;a++)se("#updatedSubsequenceSVG_"+i+"_"+r+"_"+this.variables[a]).select("g").selectAll("circle").remove();$("#tooltipClusteringResults").css("display","none"),$("#subsequenceTr_"+i+"_"+r).length&&se("#subsequenceTr_"+i+"_"+r).classed("table-active",!1),$("#clusterLine_"+i+"_"+r).length&&se("#clusterLine_"+i+"_"+r).attr("stroke-width",0),$("#subsequenceDetailTr_"+i+"_"+r).length>0&&(Ds(".clusterMemberLineChart_"+i+"_"+r).attr("stroke","lightgray"),Ds(".SSLengthBar").attr("stroke-width",0),se("#subsequenceDetailTr_"+i+"_"+r).classed("table-active",!1))}}}},{key:"onClickUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),i=n[1],r=n[2],a=document.getElementById("updatedSubsequenceTr_"+i+"_"+r).classList;if(a.length>0)for(var o=0;o<a.length;o++)if(a[o].indexOf("updatedSubsequenceTrCluster")>=0){var s=a[o].split("_");wp(Number(s[1]))}}}}},{key:"onDoubleClickUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n,i=e.split("_"),r=i[1],a=Number(i[2]),o=0;o<this.filteringProcess.subsequences[r].length;o++)if(this.filteringProcess.subsequences[r][o].id===r&&this.filteringProcess.subsequences[r][o].idx===a){n=this.filteringProcess.subsequences[r][o];break}$("#tooltipClusteringResults").css("display","none"),ru("visualization"),Lu(Number(r),[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"drawSparklinesOfSubsequencesInTheSelectedStep",value:function(){var t=this;if(this.state.selectedProcess&&this.updateSparklineTableFlag){$("#subsequencesFilteringProcessTable svg").remove();var e=this.steps.indexOf(this.state.selectedProcess),n=this.steps[this.steps.indexOf(this.state.selectedProcess)-1],i=($("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right-30)/this.variables.length-6;for(var r in this.filteringProcess[n])for(var a=0;a<this.filteringProcess[n][r].length;a++)for(var o=this.filteringProcess[n][r][a],s=this.filteringProcess.subsequences[r][o],l=function(n){for(var a=se("#subsequenceTd_"+r+"_"+o+"_"+t.variables[n]).append("svg").attr("id","subsequenceSVG_"+r+"_"+o+"_"+t.variables[n]).attr("class","spark").attr("width",i).attr("height",24),l=t.filteringProcess[t.state.selectedProcess][r].indexOf(o)<0?t.filteringStepColors[e-1]:t.filteringStepColors[e],u=0;u<t.subsequences.length;u++)if(t.subsequences[u].id===r&&t.subsequences[u].idx===o){l="object"===Km(t.labels[u])?Fe(t.clusterColors[t.labels[u].cluster][0],t.clusterColors[t.labels[u].cluster][1],t.clusterColors[t.labels[u].cluster][2]):Fe(t.clusterColors[t.labels[u]][0],t.clusterColors[t.labels[u]][1],t.clusterColors[t.labels[u]][2]);var c="subsequenceTrCluster_"+t.labels[u];se("#subsequenceTr_"+r+"_"+o).classed(c,!0);break}a.append("g").datum(s).append("path").attr("fill","none").attr("stroke",l).attr("stroke-width",1.5).attr("d",function(t,e){return this.curves[this.variables[n]](t)}.bind(t))},u=0;u<this.variables.length;u++)l(u);this.updateSparklineTableFlag=!1}}},{key:"drawSparklinesOfUpdatedSubsequences",value:function(){var t=this;if(this.updataUpdatedSSSparklineTableFlag){$("#updatedSubsequencesTable svg").remove();var e=this.steps.indexOf(this.state.selectedProcess),n=(this.steps[this.steps.indexOf(this.state.selectedProcess)-1],$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right),i=.3*(this.mount.clientHeight-$("#filteringProcessSummary").height()),r=(n-30)/this.variables.length-6,a=0;for(var o in Object.keys(this.state.updatedSS).forEach(function(t){a+=this.state.updatedSS[t].length}.bind(this)),se("#updatedSubsequencesTable").attr("height",Math.min(i,30*(a+1))),se("#updatedSubsequencesTableBody").attr("height",Math.min(i-30,30*a)),this.state.updatedSS)for(var s=0;s<this.state.updatedSS[o].length;s++)for(var l=this.state.updatedSS[o][s].idx,u=this.filteringProcess.subsequences[o][l],c=function(n){var i="add"===t.state.updatedSS[o][s].status?"table-success":"table-danger";se("#updatedSubsequenceTr_"+o+"_"+l).classed(i,!0),se("#subsequenceTr_"+o+"_"+l).classed(i,!0);var a=se("#updatedSubsequenceTd_"+o+"_"+l+"_"+t.variables[n]).append("svg").attr("id","updateSubsequenceSVG_"+o+"_"+l+"_"+t.variables[n]).attr("class","spark").attr("width",r).attr("height",24),c=void 0;t.state.selectedProcess&&(c=t.filteringProcess[t.state.selectedProcess][o].indexOf(l)<0?t.filteringStepColors[e-1]:t.filteringStepColors[e]);for(var h=0;h<t.subsequences.length;h++)if(t.subsequences[h].id===o&&t.subsequences[h].idx===l){c="object"===Km(t.labels[h])?Fe(t.clusterColors[t.labels[h].cluster][0],t.clusterColors[t.labels[h].cluster][1],t.clusterColors[t.labels[h].cluster][2]):Fe(t.clusterColors[t.labels[h]][0],t.clusterColors[t.labels[h]][1],t.clusterColors[t.labels[h]][2]);var d="updatedSubsequenceTrCluster_"+t.labels[h];se("#updatedSubsequenceTr_"+o+"_"+l).classed(d,!0);break}a.append("g").datum(u).append("path").attr("fill","none").attr("stroke",c).attr("stroke-width",1.5).attr("d",function(t,e){return this.curves[this.variables[n]](t)}.bind(t))},h=0;h<this.variables.length;h++)c(h);this.updataUpdatedSSSparklineTableFlag=!1}}},{key:"checkCurrentlySelectedSS",value:function(){if(this.state.selectedProcess){for(var t in $(".subsequenceFilteringCheckbox").prop("checked",!1),this.state.selectedSS)for(var e=0;e<this.state.selectedSS[t].length;e++)$("#selectSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).prop("checked",!0),$("#selectUpdatedSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).length&&$("#selectUpdatedSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).prop("checked",!0);for(var n in this.state.updatedSS)for(var i=0;i<this.state.updatedSS[n].length;i++){var r="add"===this.state.updatedSS[n][i].status?"table-success":"table-danger";se("#subsequenceTr_"+n+"_"+this.state.updatedSS[n][i].idx).attr("class","").classed(r,!0)}}}}])&&ng(e.prototype,n),i&&ng(e,i),o}(r.a.Component);function lg(t){return(lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ug(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cg(t,e){return(cg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=fg(t);if(e){var r=fg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dg(this,n)}}function dg(t,e){return!e||"object"!==lg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fg(t){return(fg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cg(t,e)}(o,t);var e,n,i,a=hg(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).clusteringMethod="kmeans",e.subsequences=[],e.clusterCenters=[],e.labels=[],e.resultsSVGTmp=[],e}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{id:"clusteringResults",className:"clusteringPanel"},r.a.createElement(sg,null),r.a.createElement("div",{id:"clusteringResultsOverview"},r.a.createElement(Dm,null),r.a.createElement(Wm,null)),r.a.createElement(Jm,null),r.a.createElement("div",{className:"tooltip clusteringResults",id:"tooltipClusteringResults",style:{display:"none"}}))}},{key:"componentDidMount",value:function(){}}])&&ug(e.prototype,n),i&&ug(e,i),o}(r.a.Component);function mg(t){return(mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gg(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vg(t,e){return(vg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=xg(t);if(e){var r=xg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bg(this,n)}}function bg(t,e){return!e||"object"!==mg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xg(t){return(xg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vg(t,e)}(o,t);var e,n,i,a=yg(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:dh.getMode(),showQBESource:!1,resultsPanel:"featureExtraction"},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;dh.on("switchQueryMode",(function(e){setTimeout((function(){return t.setState({queryMode:e})})),"QBE"===e?$("#extractionResults").css({width:"40%"}):"Clustering"===e?$("#clusteringResults").css({width:"70%"}):$("#extractionResults").css({width:"70%"}),t.showResultsPanel(e)})),dh.on("recoverQuery",(function(e){var n=dh.getMode();t.setState({queryMode:n}),"QBE"===n?($("#extractionResults").css({width:"40%"}),t.setState({resultsPanel:"featureExtraction"})):"Clustering"===n?($("#clusteringResults").css({width:"70%"}),t.setState({resultsPanel:"clustering"})):($("#extractionResults").css({width:"70%"}),t.setState({resultsPanel:"featureExtraction"}))})),dh.on("setQuery",(function(){"featureExtraction"!==t.state.resultsPanel&&t.setState({resultsPanel:"featureExtraction"})})),mu.on("showExtractionSourcePanel",(function(e){"default"!==e&&Number(e)>=0?t.setState({showQBESource:!0,resultsPanel:"featureExtraction"}):t.setState({showQBESource:!1})})),mu.on("showResultsPanel",(function(e){t.setState({resultsPanel:e})}))}},{key:"showResultsPanel",value:function(t){var e;e=$("#clusteringTimelineArea").length>0?"AE"===t?"featureExtraction":"clustering":"Clustering"===t?"clustering":"featureExtraction",this.setState({resultsPanel:e})}},{key:"render",value:function(){var t,e;return this.state.showQBESource&&(t=r.a.createElement(Pm,null)),"clustering"===this.state.resultsPanel?e=r.a.createElement(pg,null):"featureExtraction"===this.state.resultsPanel&&(e=r.a.createElement(mm,null)),r.a.createElement("div",{className:"contents",id:"mainFeatureArea",style:{display:"flex"}},r.a.createElement(Vp,null),t,e)}}])&&gg(e.prototype,n),i&&gg(e,i),o}(r.a.Component);function wg(t){return(wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sg(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Eg(t,e){return(Eg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Tg(t);if(e){var r=Tg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Cg(this,n)}}function Cg(t,e){return!e||"object"!==wg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tg(t){return(Tg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eg(t,e)}(o,t);var e,n,i,a=Mg(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),a.call(this)}return e=o,(n=[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},this.overview(),this.demoVideo(),this.github(),this.authors())}},{key:"overview",value:function(){return r.a.createElement("div",{className:"aboutContainer"},r.a.createElement("h2",null,"TimeTubesX"),r.a.createElement("p",{style:{marginLeft:"2rem",marginRight:"2rem"}},"TimeTubes Web is a web-based visualization tool for BLAZAR observation data. It visualized observation time stamp and 6 variables simultaneously. It is helpful for the astronomers to analyze time variations of and correlations among intensity, polarization, and color of the light from blazars. It supports visual comparison of multiple datasets, feature extractions, etc."),r.a.createElement("p",null,"For more detail information about TimeTubes project, please refer our prior papers."),r.a.createElement("ul",null,r.a.createElement("li",null,"Naoko Sawada, Masanori Nakayama, Makoto Uemura, and Issei Fujishiro. TimeTubes: Automatic Extraction of Observable Blazar Features from Long-Term, Multi-Dimensional Datasets, in ",r.a.createElement("em",null,"Proceedings of 2018 IEEE Scientific Visualization Conference (SciVis),")," Berlin, Germany, DOI: 10.1109/SciVis.2018.8823802, October 2018.",r.a.createElement("a",{href:"https://ieeexplore.ieee.org/document/8823802"},"IEEE Xplore")),r.a.createElement("li",null,"Issei Fujishiro, Naoko Sawada, Masanori Nakayama, Hsiang-Yun Wu, Kazuho Watanabe, Shigeo Takahashi, and Makoto Uemura. TimeTubes: Visual Exploration of Observed Blazar Datasets,",r.a.createElement("em",null,"Journal of Physics: Conference Series (JPCS),"),"Vol. 1036, No. 1, Article No. 012011, DOI: 10.1088/1742-6596/1036/1/012011, Kyoto, Japan, 2018.",r.a.createElement("a",{href:"http://iopscience.iop.org/article/10.1088/1742-6596/1036/1/012011"},"IOPscience")),r.a.createElement("li",null,"Makoto Uemura, Ryosuke Itoh, Ioannis Liodakis, Dmitry Blinov, Masanori Nakayama, Longyin Xu, Naoko Sawada, Hsiang-Yun Wu, Issei Fujishiro. Optical polarization variations in the blazar PKS 1749+096,",r.a.createElement("em",null,"Publications of the Astronomical Society of Japan (PASJ),")," Vol. 69, No. 6, Article No. 96, DOI: 10.1093/pasj/psx111, November 2017.",r.a.createElement("a",{href:"https://academic.oup.com/pasj/article/69/6/96/4609697"},"Oxford Academic")),r.a.createElement("li",null,"Naoko Sawada, Masanori Nakayama, Hsiang-Yun Wu, Makoto Uemura, and Issei Fujishiro. TimeTubes: Visual Fusion and Validation for Ameliorating Uncertainty of Blazar Datasets from Different Observatories, Short papers, in ",r.a.createElement("em",null,"Proceedings of the Computer Graphics International Conference (CGI 2017),")," Article No. 14, Yokohama, Japan, DOI: 10.1145/3095140.3095154, June 2017.",r.a.createElement("a",{href:"http://dl.acm.org/citation.cfm?id=3095154"},"ACM Digital Library"))))}},{key:"demoVideo",value:function(){return r.a.createElement("div",{className:"aboutContainer"},r.a.createElement("h2",null,"Demo Videos"),r.a.createElement("h4",null,"Conventional Visualization in Astronomy"),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/izChQ4uKksQ",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("h4",null,"Automatic Feature Extraction"),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/B-0vTcWEc0s",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/L-5wIOhKko8",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/Ye7bqzJIjG4",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("h4",null,"Interactive Feature Extraction"),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/NmSI1F3qKwY",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/0o1kqOZ4eBk",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/8vGVtYPibqo",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("h4",null,"Auxiliary Functions"),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/CEMEJ9KDIpk",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),r.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/J0VlciD_ohs",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))}},{key:"github",value:function(){return r.a.createElement("div",{className:"aboutContainer"},r.a.createElement("h2",null,"Source code"),r.a.createElement("p",null,"All the source code of TimeTubesX is publicly accessible and open-source."),r.a.createElement("img",{className:"aboutIcons",src:"../../img/GitHub-Mark-120px-plus.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://github.com/MistletoeNaoko/TimeTubesWeb"},"https://github.com/MistletoeNaoko/TimeTubesWeb"))}},{key:"authors",value:function(){return r.a.createElement("div",{className:"aboutContainer"},r.a.createElement("h2",null,"Authors"),r.a.createElement("div",{className:"authorList"},r.a.createElement("h4",null,"Naoko Sawada"),r.a.createElement("p",null,"Ph.D Student at Keio University, visiting scholar in Visual Computing Group (VCG) at Harvard University (2018-2020)"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://mistletoenaoko.github.io/"},"https://mistletoenaoko.github.io/"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/Twitter_Logo_Blue.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://twitter.com/NaokoVis"},"NaokoVis"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"mailto:naoko.sawada@fj.ics.keio.ac.jp"},"Email")),r.a.createElement("div",{className:"authorList"},r.a.createElement("h4",null,"Makoto Uemura"),r.a.createElement("p",null,"Associate Professor in Hiroshima Astrophysical Science Center (HASC) at Hiroshima University"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://home.hiroshima-u.ac.jp/uemuram/"},"https://home.hiroshima-u.ac.jp/uemuram/")),r.a.createElement("div",{className:"authorList"},r.a.createElement("h4",null,"Johanna Beyer"),r.a.createElement("p",null,"Research Associate in Visual Computing Group (VCG) at Harvard University"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://johanna-b.github.io/"},"https://johanna-b.github.io/"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"mailto:jbeyer@g.harvard.edu"},"Email")),r.a.createElement("div",{className:"authorList"},r.a.createElement("h4",null,"Hanspeter Pfister"),r.a.createElement("p",null,"An Wang Professor of Computer Science at Harvard University"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://vcg.seas.harvard.edu/"},"https://vcg.seas.harvard.edu/"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/Twitter_Logo_Blue.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"https://twitter.com/hpfister"},"hpfister"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"mailto:pfister@seas.harvard.edu"},"Email")),r.a.createElement("div",{className:"authorList"},r.a.createElement("h4",null,"Issei Fujishiro"),r.a.createElement("p",null,"Professor of Information and Computer Science at Keio University, Adjunct Professor at School of Computer Science and Engineering at Hangzhou Dianzi University"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"http://fj.ics.keio.ac.jp/"},"http://fj.ics.keio.ac.jp/"),r.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),r.a.createElement("a",{href:"mailto:fuji@ics.keio.ac.jp"},"Email")))}}])&&Sg(e.prototype,n),i&&Sg(e,i),o}(r.a.Component);function Pg(t){return(Pg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ag(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Og(t,e){return(Og=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Lg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ig(t);if(e){var r=Ig(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rg(this,n)}}function Rg(t,e){return!e||"object"!==Pg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ig(t){return(Ig=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ng=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Og(t,e)}(o,t);var e,n,i,a=Lg(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),t=a.call(this);var e=Yc("privateComment");return Array.isArray(e)&&(e=$c()),t.state={privateComments:e,selectedComment:{},selectedQuery:{},selectedCommentId:"",selectedQueryId:""},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#privateCommentTable").tablesorter(),mu.on("selectMenu",(function(e){"comment"===e&&t.setState({privateComments:Yc("privateComment")})}))}},{key:"privateCommentListTr",value:function(){var t=[];if(this.state.privateComments)for(var e in this.state.privateComments){var n=this.state.privateComments[e].labelColor.replace("0x","#");t.push(r.a.createElement("tr",{key:e,className:"privateCommentBody",id:e,onClick:this.onClickCommentTableRow.bind(this)},r.a.createElement("td",{style:{textAlign:"center"}},r.a.createElement("input",{type:"checkbox",className:e+" selectComment",name:"privateCommentSelector"})),r.a.createElement("td",{style:{textAlign:"center"}},r.a.createElement("span",{style:{color:n}},"")),r.a.createElement("td",null,this.state.privateComments[e].timeStamp.toLocaleString("en-US")),r.a.createElement("td",null,this.state.privateComments[e].fileName),r.a.createElement("td",null,this.state.privateComments[e].start),r.a.createElement("td",null,this.state.privateComments[e].comment),r.a.createElement("td",null,this.state.privateComments[e].userName)))}return t}},{key:"commentDetailTr",value:function(){var t=[];for(var e in this.state.selectedComment)"labelColor"===e?t.push(r.a.createElement("tr",{key:e,className:"commentDetailTableTr",id:e},r.a.createElement("td",null,"Label"),r.a.createElement("td",null,r.a.createElement("span",{style:{color:this.state.selectedComment[e].replace("0x","#")}},"")))):"query"!==e&&"parameters"!==e&&"queryId"!==e&&t.push(r.a.createElement("tr",{key:e,className:"commentDetailTableTr",id:e},r.a.createElement("td",null,ih(e)),r.a.createElement("td",null,this.state.selectedComment[e])));return t}},{key:"queryDetailTr",value:function(){var t=[];for(var e in this.state.selectedQuery)"object"!==Pg(this.state.selectedQuery[e])&&t.push(r.a.createElement("tr",{key:e,className:"queryDetailTableTr",id:e},r.a.createElement("td",null,ih(e)),r.a.createElement("td",null,this.state.selectedQuery[e])));for(var n in this.state.selectedQuery.query)if("path"!==n&&"controlPoints"!==n){var i=this.state.selectedQuery.query[n];if(Array.isArray(this.state.selectedQuery.query[n])&&this.state.selectedQuery.query[n].length>1)if(Number(this.state.selectedQuery.query[n][0])){i="";for(var a=0;a<this.state.selectedQuery.query[n].length;a++)i+=cd(Number(this.state.selectedQuery.query[n][a]))+", ";i=i.substr(0,i.length-2)}else i=i.join(", ");t.push(r.a.createElement("tr",{key:n,className:"queryDetailTableTr",id:n},r.a.createElement("td",null,ih(n)),r.a.createElement("td",null,i)))}return t}},{key:"queryParametersDetailTr",value:function(){var t=[];for(var e in this.state.selectedQuery.parameters){var n="DTWType"===e?"DTW Type":ih(e),i="boolean"==typeof this.state.selectedQuery.parameters[e]?this.state.selectedQuery.parameters[e].toString():this.state.selectedQuery.parameters[e];if(Array.isArray(i)){for(var a="",o=0;o<i.length;o++)a+=cd(Number(i[o]))+", ";i=a=a.substr(0,a.length-2)}t.push(r.a.createElement("tr",{key:e,className:"queryParameterDetailTableTr",id:e},r.a.createElement("td",null,n),r.a.createElement("td",null,i)))}return t}},{key:"onClickCommentTableRow",value:function(t){this.updateCommentDetail(t.target.parentNode.id)}},{key:"updateCommentDetail",value:function(t){var e=Zc(t);if(e){var n=function(t){return qc[t]?qc[t]:{}}(e.queryId);this.setState({selectedCommentId:t,selectedComment:e,selectedQueryId:e.queryId,selectedQuery:n})}}},{key:"privateCommentListHeader",value:function(){return r.a.createElement("thead",null,r.a.createElement("tr",{id:"privateCommentHeader"},r.a.createElement("th",{className:"col-1"},"Select"),r.a.createElement("th",{className:"col-1"},"Label"),r.a.createElement("th",{className:"col-2 num",value:"timeStamp"},"Date (GMT)"),r.a.createElement("th",{className:"col-2 case",value:"fileName"},"File name"),r.a.createElement("th",{className:"col-1 num",value:"start"},"JD"),r.a.createElement("th",{className:"col-3",value:"comment"},"Comment"),r.a.createElement("th",{className:"col-2 case",value:"userName"},"User name")))}},{key:"getSelectedPrivateComment",value:function(){for(var t=$("input[name=privateCommentSelector]:checked"),e=[],n=0;n<t.length;n++)e.push($(t[n]).attr("class").split(" ")[0]);return e}},{key:"editPrivateComment",value:function(){}},{key:"deletePrivateComment",value:function(t){for(var e=this.getSelectedPrivateComment(),n=!1,i=0;i<e.length;i++)Xc(e[i]),e[i]===this.state.selectedCommentId&&(n=!0);n?this.setState({privateComments:Yc("privateComment"),selectedCommentId:"",selectedComment:{},selectedQueryId:"",selectedQuery:{}}):this.setState({privateComments:Yc("privateComment")}),hc()}},{key:"deleteThisComment",value:function(){Xc(this.state.selectedCommentId),this.setState({privateComments:Yc("privateComment"),selectedCommentId:"",selectedComment:{},selectedQueryId:"",selectedQuery:{}}),hc()}},{key:"recoverTheQuery",value:function(){if(Object.keys(this.state.selectedQuery).length>0){var t=!0;"visual query"===this.state.selectedQuery.mode&&"query-by-example"===this.state.selectedQuery.option?Gu.getIdFromName(this.state.selectedQuery.query.source)<0&&(alert("You have to open the file whose file name is "+this.state.selectedQuery.query.source+"to recover the query-by-example."),t=!1):"visual query"===this.state.selectedQuery.mode&&this.state.selectedQuery.option,t&&("visual query"===this.state.selectedQuery.mode&&"query-by-example"===this.state.selectedQuery.option?Promise.resolve().then(function(){ou(Gu.getIdFromName(this.state.selectedQuery.query.source))}.bind(this)).then(function(){Uc(this.state.selectedQuery),ru("feature")}.bind(this)):(Uc(this.state.selectedQuery),ru("feature")))}else Object.keys(this.state.selectedComment).length>0?alert("No query information is stored with this comment."):alert("Please select a comment from the left table.")}},{key:"exportPrivateComment",value:function(){!function(t){for(var e=[],n=[],i=0;i<t.length;i++){var r=Wc[t[i]];e.push(r),n.indexOf(r.queryId)<0&&n.push(qc[r.queryId])}var a={comments:e,query:n};a=JSON.stringify(a,null,"\t");var o="privateComment_"+Jc()+".json",s=new Blob([a],{type:"application/json"}),l=(window.URL||window.webkitURL).createObjectURL(s),u=document.createElement("a");u.download=decodeURI(o),u.href=l,u.click()}(this.getSelectedPrivateComment())}},{key:"selectAllPrivateComment",value:function(){var t=$("#selectAllPrivateCommentBtn").text(),e=$("input[name=privateCommentSelector]");"Select All"===t?(e.prop("checked",!0),$("#selectAllPrivateCommentBtn").text("Deselect All")):"Deselect All"===t&&(e.prop("checked",!1),$("#selectAllPrivateCommentBtn").text("Select All"))}},{key:"render",value:function(){var t=this.privateCommentListHeader(),e=this.privateCommentListTr(),n=this.commentDetailTr(),i=this.queryDetailTr(),a=this.queryParametersDetailTr();return r.a.createElement("div",{className:"contents commentRow",id:"mainCommentsArea"},r.a.createElement("div",{className:"commentColumn",id:"commentTableArea"},r.a.createElement("ul",{className:"nav nav-tabs"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link active","data-toggle":"tab",href:"#private"},"Private comments")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link disabled","data-toggle":"tab",href:"#public"},"Public comments"))),r.a.createElement("div",{id:"myTabContent",className:"tab-content"},r.a.createElement("div",{className:"tab-pane fade active show commentsArea",id:"private"},r.a.createElement("div",{id:"privateCommentMenu",style:{float:"right",marginBottom:"15px"}},r.a.createElement("button",{className:"btn btn-danger btn-sm",type:"button",id:"deleteCommentBtn",onClick:this.deletePrivateComment.bind(this)},"Delete"),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"selectAllPrivateCommentBtn",onClick:this.selectAllPrivateComment.bind(this)},"Select All"),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"exportPrivateCommentBtn",onClick:this.exportPrivateComment.bind(this)},"Export")),r.a.createElement("table",{id:"privateCommentTable",className:"table table-hover tablesorter"},t,r.a.createElement("tbody",{id:"privateCommentBody"},e))),r.a.createElement("div",{className:"tab-pane fade commentsArea",id:"public"},"Public comments will be here."))),r.a.createElement("div",{className:"commentColumn",id:"commentDetailArea"},r.a.createElement("div",{id:"commentMenu",style:{float:"right",marginBottom:"15px"}},r.a.createElement("button",{className:"btn btn-danger btn-sm",type:"button",id:"deleteThisCommentBtn",onClick:this.deleteThisComment.bind(this)},"Delete this comment"),r.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"recoverTheQueryBtn",onClick:this.recoverTheQuery.bind(this)},"Recover the query")),r.a.createElement("div",{style:{clear:"both"}}),r.a.createElement("h5",null,"Comment"),r.a.createElement("table",{id:"commentDetailTable",className:"table table-hover"},r.a.createElement("tbody",{id:"commentDetailBody"},n)),r.a.createElement("h5",null,"Query"),r.a.createElement("table",{id:"queryDetailTable",className:"table table-hover"},r.a.createElement("tbody",{id:"queryDetailBody"},i)),r.a.createElement("table",{id:"queryParametersDetailTable",className:"table table-hover"},r.a.createElement("tbody",{id:"queryParametersDetailBody"},a))))}}])&&Ag(e.prototype,n),i&&Ag(e,i),o}(r.a.Component);function Dg(t){return(Dg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zg(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Bg(t,e){return(Bg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=jg(t);if(e){var r=jg(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Vg(this,n)}}function Vg(t,e){return!e||"object"!==Dg(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jg(t){return(jg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ug=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bg(t,e)}(o,t);var e,n,i,a=Fg(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={menu:"visualization"},t.selectMainView("visualization"),t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;mu.on("selectMenu",(function(e){t.selectMainView(e),scrollTo(0,0),t.setState({menu:e})})),dh.on("recoverQuery",(function(e){setTimeout(function(){this.setState({menu:"feature"})}.bind(t),0)}))}},{key:"selectMainView",value:function(t){switch(t){case"about":$("body").css("overflow-y","scroll");break;case"visualization":$("body").css("overflow-y","hidden");break;case"feature":case"comment":$("body").css("overflow-y","scroll")}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(wu,null),r.a.createElement("div",{className:"maincontainer",id:"about",style:{display:"about"===this.state.menu?"block":"none",height:$(window).height()-$("#appHeader").outerHeight()}},r.a.createElement(kg,null)),r.a.createElement("div",{className:"maincontainer",id:"visualization",style:{display:"visualization"===this.state.menu?"block":"none"}},r.a.createElement(Bd,null)),r.a.createElement("div",{className:"maincontainer",id:"featureExtraction",style:{display:"feature"===this.state.menu?"block":"none"}},r.a.createElement(_g,null)),r.a.createElement("div",{className:"maincontainer",id:"fuserComments",style:{display:"comment"===this.state.menu?"block":"none"}},r.a.createElement(Ng,null)))}}])&&zg(e.prototype,n),i&&zg(e,i),o}(r.a.Component),Hg=document.getElementById("app");o.a.render(r.a.createElement(Ug,null),Hg),null!==localStorage.getItem("privateComment")&&"[]"!==localStorage.getItem("privateComment")||localStorage.setItem("privateComment",JSON.stringify({})),Array.isArray(JSON.parse(localStorage.getItem("privateComment")))&&$c(),null!==localStorage.getItem("queryTable")&&"[]"!==localStorage.getItem("queryTable")||localStorage.setItem("queryTable",JSON.stringify({}))}]);