!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=381)}([function(t,e,n){"use strict";t.exports=n(196)},function(t,e,n){"use strict";n.r(e),n.d(e,"ACESFilmicToneMapping",(function(){return at})),n.d(e,"AddEquation",(function(){return T})),n.d(e,"AddOperation",(function(){return K})),n.d(e,"AdditiveAnimationBlendMode",(function(){return Qe})),n.d(e,"AdditiveBlending",(function(){return S})),n.d(e,"AlphaFormat",(function(){return Bt})),n.d(e,"AlwaysDepth",(function(){return G})),n.d(e,"AlwaysStencilFunc",(function(){return Tn})),n.d(e,"AmbientLight",(function(){return _h})),n.d(e,"AmbientLightProbe",(function(){return Gh})),n.d(e,"AnimationClip",(function(){return kc})),n.d(e,"AnimationLoader",(function(){return Dc})),n.d(e,"AnimationMixer",(function(){return xd})),n.d(e,"AnimationObjectGroup",(function(){return yd})),n.d(e,"AnimationUtils",(function(){return mc})),n.d(e,"ArcCurve",(function(){return Gc})),n.d(e,"ArrayCamera",(function(){return As})),n.d(e,"ArrowHelper",(function(){return uf})),n.d(e,"Audio",(function(){return td})),n.d(e,"AudioAnalyser",(function(){return od})),n.d(e,"AudioContext",(function(){return jh})),n.d(e,"AudioListener",(function(){return Kh})),n.d(e,"AudioLoader",(function(){return Hh})),n.d(e,"AxesHelper",(function(){return cf})),n.d(e,"AxisHelper",(function(){return ap})),n.d(e,"BackSide",(function(){return v})),n.d(e,"BasicDepthPacking",(function(){return ln})),n.d(e,"BasicShadowMap",(function(){return d})),n.d(e,"BinaryTextureLoader",(function(){return cp})),n.d(e,"Bone",(function(){return pl})),n.d(e,"BooleanKeyframeTrack",(function(){return _c})),n.d(e,"BoundingBoxHelper",(function(){return op})),n.d(e,"Box2",(function(){return Pd})),n.d(e,"Box3",(function(){return Vr})),n.d(e,"Box3Helper",(function(){return rf})),n.d(e,"BoxBufferGeometry",(function(){return va})),n.d(e,"BoxGeometry",(function(){return ga})),n.d(e,"BoxHelper",(function(){return nf})),n.d(e,"BufferAttribute",(function(){return Mi})),n.d(e,"BufferGeometry",(function(){return Gi})),n.d(e,"BufferGeometryLoader",(function(){return Ph})),n.d(e,"ByteType",(function(){return kt})),n.d(e,"Cache",(function(){return Ac})),n.d(e,"Camera",(function(){return wa})),n.d(e,"CameraHelper",(function(){return Kd})),n.d(e,"CanvasRenderer",(function(){return fp})),n.d(e,"CanvasTexture",(function(){return Vl})),n.d(e,"CatmullRomCurve3",(function(){return Xc})),n.d(e,"CineonToneMapping",(function(){return it})),n.d(e,"CircleBufferGeometry",(function(){return nc})),n.d(e,"CircleGeometry",(function(){return ec})),n.d(e,"ClampToEdgeWrapping",(function(){return mt})),n.d(e,"Clock",(function(){return Yh})),n.d(e,"ClosedSplineCurve3",(function(){return np})),n.d(e,"Color",(function(){return gi})),n.d(e,"ColorKeyframeTrack",(function(){return wc})),n.d(e,"CompressedTexture",(function(){return Bl})),n.d(e,"CompressedTextureLoader",(function(){return zc})),n.d(e,"ConeBufferGeometry",(function(){return tc})),n.d(e,"ConeGeometry",(function(){return Ku})),n.d(e,"CubeCamera",(function(){return Ea})),n.d(e,"CubeGeometry",(function(){return ga})),n.d(e,"CubeReflectionMapping",(function(){return st})),n.d(e,"CubeRefractionMapping",(function(){return lt})),n.d(e,"CubeTexture",(function(){return Ya})),n.d(e,"CubeTextureLoader",(function(){return Vc})),n.d(e,"CubeUVReflectionMapping",(function(){return dt})),n.d(e,"CubeUVRefractionMapping",(function(){return ft})),n.d(e,"CubicBezierCurve",(function(){return th})),n.d(e,"CubicBezierCurve3",(function(){return eh})),n.d(e,"CubicInterpolant",(function(){return vc})),n.d(e,"CullFaceBack",(function(){return s})),n.d(e,"CullFaceFront",(function(){return l})),n.d(e,"CullFaceFrontBack",(function(){return u})),n.d(e,"CullFaceNone",(function(){return o})),n.d(e,"Curve",(function(){return Hc})),n.d(e,"CurvePath",(function(){return lh})),n.d(e,"CustomBlending",(function(){return C})),n.d(e,"CylinderBufferGeometry",(function(){return Ju})),n.d(e,"CylinderGeometry",(function(){return Zu})),n.d(e,"Cylindrical",(function(){return Td})),n.d(e,"DataTexture",(function(){return Ca})),n.d(e,"DataTexture2DArray",(function(){return Qa})),n.d(e,"DataTexture3D",(function(){return Xa})),n.d(e,"DataTextureLoader",(function(){return Fc})),n.d(e,"DecrementStencilOp",(function(){return gn})),n.d(e,"DecrementWrapStencilOp",(function(){return yn})),n.d(e,"DefaultLoadingManager",(function(){return Nc})),n.d(e,"DepthFormat",(function(){return qt})),n.d(e,"DepthStencilFormat",(function(){return Wt})),n.d(e,"DepthTexture",(function(){return jl})),n.d(e,"DirectionalLight",(function(){return xh})),n.d(e,"DirectionalLightHelper",(function(){return Xd})),n.d(e,"DirectionalLightShadow",(function(){return bh})),n.d(e,"DiscreteInterpolant",(function(){return bc})),n.d(e,"DodecahedronBufferGeometry",(function(){return tu})),n.d(e,"DodecahedronGeometry",(function(){return Kl})),n.d(e,"DoubleSide",(function(){return y})),n.d(e,"DstAlphaFactor",(function(){return F})),n.d(e,"DstColorFactor",(function(){return V})),n.d(e,"DynamicBufferAttribute",(function(){return Wf})),n.d(e,"DynamicCopyUsage",(function(){return In})),n.d(e,"DynamicDrawUsage",(function(){return Pn})),n.d(e,"DynamicReadUsage",(function(){return Nn})),n.d(e,"EdgesGeometry",(function(){return Xu})),n.d(e,"EdgesHelper",(function(){return sp})),n.d(e,"EllipseCurve",(function(){return Uc})),n.d(e,"EqualDepth",(function(){return $})),n.d(e,"EqualStencilFunc",(function(){return wn})),n.d(e,"EquirectangularReflectionMapping",(function(){return ut})),n.d(e,"EquirectangularRefractionMapping",(function(){return ct})),n.d(e,"Euler",(function(){return cr})),n.d(e,"EventDispatcher",(function(){return zn})),n.d(e,"ExtrudeBufferGeometry",(function(){return Du})),n.d(e,"ExtrudeGeometry",(function(){return Iu})),n.d(e,"Face3",(function(){return xi})),n.d(e,"Face4",(function(){return Of})),n.d(e,"FaceColors",(function(){return If})),n.d(e,"FileLoader",(function(){return Ic})),n.d(e,"FlatShading",(function(){return b})),n.d(e,"Float32Attribute",(function(){return tp})),n.d(e,"Float32BufferAttribute",(function(){return Ri})),n.d(e,"Float64Attribute",(function(){return ep})),n.d(e,"Float64BufferAttribute",(function(){return Li})),n.d(e,"FloatType",(function(){return Rt})),n.d(e,"Fog",(function(){return Ds})),n.d(e,"FogExp2",(function(){return Is})),n.d(e,"Font",(function(){return Fh})),n.d(e,"FontLoader",(function(){return Vh})),n.d(e,"FrontFaceDirectionCCW",(function(){return h})),n.d(e,"FrontFaceDirectionCW",(function(){return c})),n.d(e,"FrontSide",(function(){return g})),n.d(e,"Frustum",(function(){return Pa})),n.d(e,"GammaEncoding",(function(){return en})),n.d(e,"Geometry",(function(){return ma})),n.d(e,"GeometryUtils",(function(){return dp})),n.d(e,"GreaterDepth",(function(){return Q})),n.d(e,"GreaterEqualDepth",(function(){return Y})),n.d(e,"GreaterEqualStencilFunc",(function(){return Cn})),n.d(e,"GreaterStencilFunc",(function(){return En})),n.d(e,"GridHelper",(function(){return qd})),n.d(e,"Group",(function(){return Os})),n.d(e,"HalfFloatType",(function(){return Lt})),n.d(e,"HemisphereLight",(function(){return dh})),n.d(e,"HemisphereLightHelper",(function(){return Gd})),n.d(e,"HemisphereLightProbe",(function(){return Uh})),n.d(e,"IcosahedronBufferGeometry",(function(){return Jl})),n.d(e,"IcosahedronGeometry",(function(){return Zl})),n.d(e,"ImageBitmapLoader",(function(){return Dh})),n.d(e,"ImageLoader",(function(){return Bc})),n.d(e,"ImageUtils",(function(){return Gn})),n.d(e,"ImmediateRenderObject",(function(){return Rd})),n.d(e,"IncrementStencilOp",(function(){return mn})),n.d(e,"IncrementWrapStencilOp",(function(){return vn})),n.d(e,"InstancedBufferAttribute",(function(){return kh})),n.d(e,"InstancedBufferGeometry",(function(){return Th})),n.d(e,"InstancedInterleavedBuffer",(function(){return wd})),n.d(e,"InstancedMesh",(function(){return bl})),n.d(e,"Int16Attribute",(function(){return Xf})),n.d(e,"Int16BufferAttribute",(function(){return Pi})),n.d(e,"Int32Attribute",(function(){return Jf})),n.d(e,"Int32BufferAttribute",(function(){return Oi})),n.d(e,"Int8Attribute",(function(){return $f})),n.d(e,"Int8BufferAttribute",(function(){return Ci})),n.d(e,"IntType",(function(){return Ot})),n.d(e,"InterleavedBuffer",(function(){return zs})),n.d(e,"InterleavedBufferAttribute",(function(){return Vs})),n.d(e,"Interpolant",(function(){return gc})),n.d(e,"InterpolateDiscrete",(function(){return He})),n.d(e,"InterpolateLinear",(function(){return Ue})),n.d(e,"InterpolateSmooth",(function(){return Ge})),n.d(e,"InvertStencilOp",(function(){return bn})),n.d(e,"JSONLoader",(function(){return pp})),n.d(e,"KeepStencilOp",(function(){return fn})),n.d(e,"KeyframeTrack",(function(){return xc})),n.d(e,"LOD",(function(){return ul})),n.d(e,"LatheBufferGeometry",(function(){return Wu})),n.d(e,"LatheGeometry",(function(){return qu})),n.d(e,"Layers",(function(){return hr})),n.d(e,"LensFlare",(function(){return gp})),n.d(e,"LessDepth",(function(){return q})),n.d(e,"LessEqualDepth",(function(){return W})),n.d(e,"LessEqualStencilFunc",(function(){return Sn})),n.d(e,"LessStencilFunc",(function(){return _n})),n.d(e,"Light",(function(){return hh})),n.d(e,"LightProbe",(function(){return Eh})),n.d(e,"LightShadow",(function(){return fh})),n.d(e,"Line",(function(){return Cl})),n.d(e,"Line3",(function(){return Nd})),n.d(e,"LineBasicMaterial",(function(){return xl})),n.d(e,"LineCurve",(function(){return nh})),n.d(e,"LineCurve3",(function(){return rh})),n.d(e,"LineDashedMaterial",(function(){return fc})),n.d(e,"LineLoop",(function(){return Al})),n.d(e,"LinePieces",(function(){return Rf})),n.d(e,"LineSegments",(function(){return Pl})),n.d(e,"LineStrip",(function(){return Nf})),n.d(e,"LinearEncoding",(function(){return Ke})),n.d(e,"LinearFilter",(function(){return wt})),n.d(e,"LinearInterpolant",(function(){return yc})),n.d(e,"LinearMipMapLinearFilter",(function(){return Ct})),n.d(e,"LinearMipMapNearestFilter",(function(){return Et})),n.d(e,"LinearMipmapLinearFilter",(function(){return Mt})),n.d(e,"LinearMipmapNearestFilter",(function(){return St})),n.d(e,"LinearToneMapping",(function(){return et})),n.d(e,"Loader",(function(){return Rc})),n.d(e,"LoaderUtils",(function(){return Ch})),n.d(e,"LoadingManager",(function(){return Oc})),n.d(e,"LogLuvEncoding",(function(){return rn})),n.d(e,"LoopOnce",(function(){return Be})),n.d(e,"LoopPingPong",(function(){return je})),n.d(e,"LoopRepeat",(function(){return Ve})),n.d(e,"LuminanceAlphaFormat",(function(){return Ut})),n.d(e,"LuminanceFormat",(function(){return Ht})),n.d(e,"MOUSE",(function(){return i})),n.d(e,"Material",(function(){return wi})),n.d(e,"MaterialLoader",(function(){return Mh})),n.d(e,"Math",(function(){return jn})),n.d(e,"MathUtils",(function(){return jn})),n.d(e,"Matrix3",(function(){return Un})),n.d(e,"Matrix4",(function(){return sr})),n.d(e,"MaxEquation",(function(){return O})),n.d(e,"Mesh",(function(){return la})),n.d(e,"MeshBasicMaterial",(function(){return Si})),n.d(e,"MeshDepthMaterial",(function(){return Es})),n.d(e,"MeshDistanceMaterial",(function(){return Ms})),n.d(e,"MeshFaceMaterial",(function(){return zf})),n.d(e,"MeshLambertMaterial",(function(){return hc})),n.d(e,"MeshMatcapMaterial",(function(){return dc})),n.d(e,"MeshNormalMaterial",(function(){return cc})),n.d(e,"MeshPhongMaterial",(function(){return lc})),n.d(e,"MeshPhysicalMaterial",(function(){return sc})),n.d(e,"MeshStandardMaterial",(function(){return oc})),n.d(e,"MeshToonMaterial",(function(){return uc})),n.d(e,"MinEquation",(function(){return A})),n.d(e,"MirroredRepeatWrapping",(function(){return gt})),n.d(e,"MixOperation",(function(){return J})),n.d(e,"MultiMaterial",(function(){return Ff})),n.d(e,"MultiplyBlending",(function(){return M})),n.d(e,"MultiplyOperation",(function(){return Z})),n.d(e,"NearestFilter",(function(){return vt})),n.d(e,"NearestMipMapLinearFilter",(function(){return _t})),n.d(e,"NearestMipMapNearestFilter",(function(){return bt})),n.d(e,"NearestMipmapLinearFilter",(function(){return xt})),n.d(e,"NearestMipmapNearestFilter",(function(){return yt})),n.d(e,"NeverDepth",(function(){return U})),n.d(e,"NeverStencilFunc",(function(){return xn})),n.d(e,"NoBlending",(function(){return _})),n.d(e,"NoColors",(function(){return Lf})),n.d(e,"NoToneMapping",(function(){return tt})),n.d(e,"NormalAnimationBlendMode",(function(){return Ye})),n.d(e,"NormalBlending",(function(){return w})),n.d(e,"NotEqualDepth",(function(){return X})),n.d(e,"NotEqualStencilFunc",(function(){return Mn})),n.d(e,"NumberKeyframeTrack",(function(){return Sc})),n.d(e,"Object3D",(function(){return Mr})),n.d(e,"ObjectLoader",(function(){return Oh})),n.d(e,"ObjectSpaceNormalMap",(function(){return hn})),n.d(e,"OctahedronBufferGeometry",(function(){return Xl})),n.d(e,"OctahedronGeometry",(function(){return Ql})),n.d(e,"OneFactor",(function(){return R})),n.d(e,"OneMinusDstAlphaFactor",(function(){return B})),n.d(e,"OneMinusDstColorFactor",(function(){return j})),n.d(e,"OneMinusSrcAlphaFactor",(function(){return z})),n.d(e,"OneMinusSrcColorFactor",(function(){return I})),n.d(e,"OrthographicCamera",(function(){return yh})),n.d(e,"PCFShadowMap",(function(){return f})),n.d(e,"PCFSoftShadowMap",(function(){return p})),n.d(e,"PMREMGenerator",(function(){return Sf})),n.d(e,"ParametricBufferGeometry",(function(){return Gl})),n.d(e,"ParametricGeometry",(function(){return Ul})),n.d(e,"Particle",(function(){return Vf})),n.d(e,"ParticleBasicMaterial",(function(){return Uf})),n.d(e,"ParticleSystem",(function(){return jf})),n.d(e,"ParticleSystemMaterial",(function(){return Gf})),n.d(e,"Path",(function(){return uh})),n.d(e,"PerspectiveCamera",(function(){return Sa})),n.d(e,"Plane",(function(){return ei})),n.d(e,"PlaneBufferGeometry",(function(){return La})),n.d(e,"PlaneGeometry",(function(){return Ra})),n.d(e,"PlaneHelper",(function(){return af})),n.d(e,"PointCloud",(function(){return Bf})),n.d(e,"PointCloudMaterial",(function(){return Hf})),n.d(e,"PointLight",(function(){return vh})),n.d(e,"PointLightHelper",(function(){return Vd})),n.d(e,"Points",(function(){return Dl})),n.d(e,"PointsMaterial",(function(){return Ol})),n.d(e,"PolarGridHelper",(function(){return Wd})),n.d(e,"PolyhedronBufferGeometry",(function(){return Wl})),n.d(e,"PolyhedronGeometry",(function(){return ql})),n.d(e,"PositionalAudio",(function(){return ad})),n.d(e,"PropertyBinding",(function(){return vd})),n.d(e,"PropertyMixer",(function(){return sd})),n.d(e,"QuadraticBezierCurve",(function(){return ih})),n.d(e,"QuadraticBezierCurve3",(function(){return ah})),n.d(e,"Quaternion",(function(){return Xn})),n.d(e,"QuaternionKeyframeTrack",(function(){return Mc})),n.d(e,"QuaternionLinearInterpolant",(function(){return Ec})),n.d(e,"REVISION",(function(){return r})),n.d(e,"RGBADepthPacking",(function(){return un})),n.d(e,"RGBAFormat",(function(){return jt})),n.d(e,"RGBAIntegerFormat",(function(){return Jt})),n.d(e,"RGBA_ASTC_10x10_Format",(function(){return _e})),n.d(e,"RGBA_ASTC_10x5_Format",(function(){return ye})),n.d(e,"RGBA_ASTC_10x6_Format",(function(){return be})),n.d(e,"RGBA_ASTC_10x8_Format",(function(){return xe})),n.d(e,"RGBA_ASTC_12x10_Format",(function(){return we})),n.d(e,"RGBA_ASTC_12x12_Format",(function(){return Se})),n.d(e,"RGBA_ASTC_4x4_Format",(function(){return ce})),n.d(e,"RGBA_ASTC_5x4_Format",(function(){return he})),n.d(e,"RGBA_ASTC_5x5_Format",(function(){return de})),n.d(e,"RGBA_ASTC_6x5_Format",(function(){return fe})),n.d(e,"RGBA_ASTC_6x6_Format",(function(){return pe})),n.d(e,"RGBA_ASTC_8x5_Format",(function(){return me})),n.d(e,"RGBA_ASTC_8x6_Format",(function(){return ge})),n.d(e,"RGBA_ASTC_8x8_Format",(function(){return ve})),n.d(e,"RGBA_BPTC_Format",(function(){return Ee})),n.d(e,"RGBA_ETC2_EAC_Format",(function(){return ue})),n.d(e,"RGBA_PVRTC_2BPPV1_Format",(function(){return oe})),n.d(e,"RGBA_PVRTC_4BPPV1_Format",(function(){return ae})),n.d(e,"RGBA_S3TC_DXT1_Format",(function(){return te})),n.d(e,"RGBA_S3TC_DXT3_Format",(function(){return ee})),n.d(e,"RGBA_S3TC_DXT5_Format",(function(){return ne})),n.d(e,"RGBDEncoding",(function(){return sn})),n.d(e,"RGBEEncoding",(function(){return nn})),n.d(e,"RGBEFormat",(function(){return Gt})),n.d(e,"RGBFormat",(function(){return Vt})),n.d(e,"RGBIntegerFormat",(function(){return Zt})),n.d(e,"RGBM16Encoding",(function(){return on})),n.d(e,"RGBM7Encoding",(function(){return an})),n.d(e,"RGB_ETC1_Format",(function(){return se})),n.d(e,"RGB_ETC2_Format",(function(){return le})),n.d(e,"RGB_PVRTC_2BPPV1_Format",(function(){return ie})),n.d(e,"RGB_PVRTC_4BPPV1_Format",(function(){return re})),n.d(e,"RGB_S3TC_DXT1_Format",(function(){return Kt})),n.d(e,"RGFormat",(function(){return Qt})),n.d(e,"RGIntegerFormat",(function(){return Xt})),n.d(e,"RawShaderMaterial",(function(){return ac})),n.d(e,"Ray",(function(){return Zr})),n.d(e,"Raycaster",(function(){return Sd})),n.d(e,"RectAreaLight",(function(){return wh})),n.d(e,"RedFormat",(function(){return $t})),n.d(e,"RedIntegerFormat",(function(){return Yt})),n.d(e,"ReinhardToneMapping",(function(){return nt})),n.d(e,"RepeatWrapping",(function(){return pt})),n.d(e,"ReplaceStencilOp",(function(){return pn})),n.d(e,"ReverseSubtractEquation",(function(){return P})),n.d(e,"RingBufferGeometry",(function(){return Gu})),n.d(e,"RingGeometry",(function(){return Uu})),n.d(e,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return De})),n.d(e,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Re})),n.d(e,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return Le})),n.d(e,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Ie})),n.d(e,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return ze})),n.d(e,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Fe})),n.d(e,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Me})),n.d(e,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Ce})),n.d(e,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return Te})),n.d(e,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return ke})),n.d(e,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Pe})),n.d(e,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return Ae})),n.d(e,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Oe})),n.d(e,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Ne})),n.d(e,"Scene",(function(){return Cr})),n.d(e,"SceneUtils",(function(){return mp})),n.d(e,"ShaderChunk",(function(){return Ia})),n.d(e,"ShaderLib",(function(){return Da})),n.d(e,"ShaderMaterial",(function(){return _a})),n.d(e,"ShadowMaterial",(function(){return ic})),n.d(e,"Shape",(function(){return ch})),n.d(e,"ShapeBufferGeometry",(function(){return Yu})),n.d(e,"ShapeGeometry",(function(){return $u})),n.d(e,"ShapePath",(function(){return zh})),n.d(e,"ShapeUtils",(function(){return Nu})),n.d(e,"ShortType",(function(){return Pt})),n.d(e,"Skeleton",(function(){return fl})),n.d(e,"SkeletonHelper",(function(){return Bd})),n.d(e,"SkinnedMesh",(function(){return cl})),n.d(e,"SmoothShading",(function(){return x})),n.d(e,"Sphere",(function(){return Ur})),n.d(e,"SphereBufferGeometry",(function(){return Hu})),n.d(e,"SphereGeometry",(function(){return ju})),n.d(e,"Spherical",(function(){return Cd})),n.d(e,"SphericalHarmonics3",(function(){return Sh})),n.d(e,"SphericalReflectionMapping",(function(){return ht})),n.d(e,"Spline",(function(){return ip})),n.d(e,"SplineCurve",(function(){return oh})),n.d(e,"SplineCurve3",(function(){return rp})),n.d(e,"SpotLight",(function(){return mh})),n.d(e,"SpotLightHelper",(function(){return Id})),n.d(e,"SpotLightShadow",(function(){return ph})),n.d(e,"Sprite",(function(){return tl})),n.d(e,"SpriteMaterial",(function(){return js})),n.d(e,"SrcAlphaFactor",(function(){return D})),n.d(e,"SrcAlphaSaturateFactor",(function(){return H})),n.d(e,"SrcColorFactor",(function(){return L})),n.d(e,"StaticCopyUsage",(function(){return Ln})),n.d(e,"StaticDrawUsage",(function(){return kn})),n.d(e,"StaticReadUsage",(function(){return On})),n.d(e,"StereoCamera",(function(){return $h})),n.d(e,"StreamCopyUsage",(function(){return Dn})),n.d(e,"StreamDrawUsage",(function(){return An})),n.d(e,"StreamReadUsage",(function(){return Rn})),n.d(e,"StringKeyframeTrack",(function(){return Cc})),n.d(e,"SubtractEquation",(function(){return k})),n.d(e,"SubtractiveBlending",(function(){return E})),n.d(e,"TOUCH",(function(){return a})),n.d(e,"TangentSpaceNormalMap",(function(){return cn})),n.d(e,"TetrahedronBufferGeometry",(function(){return Yl})),n.d(e,"TetrahedronGeometry",(function(){return $l})),n.d(e,"TextBufferGeometry",(function(){return Vu})),n.d(e,"TextGeometry",(function(){return Bu})),n.d(e,"Texture",(function(){return Wn})),n.d(e,"TextureLoader",(function(){return jc})),n.d(e,"TorusBufferGeometry",(function(){return ou})),n.d(e,"TorusGeometry",(function(){return au})),n.d(e,"TorusKnotBufferGeometry",(function(){return iu})),n.d(e,"TorusKnotGeometry",(function(){return ru})),n.d(e,"Triangle",(function(){return di})),n.d(e,"TriangleFanDrawMode",(function(){return Je})),n.d(e,"TriangleStripDrawMode",(function(){return Ze})),n.d(e,"TrianglesDrawMode",(function(){return Xe})),n.d(e,"TubeBufferGeometry",(function(){return nu})),n.d(e,"TubeGeometry",(function(){return eu})),n.d(e,"UVMapping",(function(){return ot})),n.d(e,"Uint16Attribute",(function(){return Zf})),n.d(e,"Uint16BufferAttribute",(function(){return Ai})),n.d(e,"Uint32Attribute",(function(){return Kf})),n.d(e,"Uint32BufferAttribute",(function(){return Ni})),n.d(e,"Uint8Attribute",(function(){return Yf})),n.d(e,"Uint8BufferAttribute",(function(){return Ti})),n.d(e,"Uint8ClampedAttribute",(function(){return Qf})),n.d(e,"Uint8ClampedBufferAttribute",(function(){return ki})),n.d(e,"Uncharted2ToneMapping",(function(){return rt})),n.d(e,"Uniform",(function(){return _d})),n.d(e,"UniformsLib",(function(){return Aa})),n.d(e,"UniformsUtils",(function(){return xa})),n.d(e,"UnsignedByteType",(function(){return Tt})),n.d(e,"UnsignedInt248Type",(function(){return Ft})),n.d(e,"UnsignedIntType",(function(){return Nt})),n.d(e,"UnsignedShort4444Type",(function(){return It})),n.d(e,"UnsignedShort5551Type",(function(){return Dt})),n.d(e,"UnsignedShort565Type",(function(){return zt})),n.d(e,"UnsignedShortType",(function(){return At})),n.d(e,"VSMShadowMap",(function(){return m})),n.d(e,"Vector2",(function(){return Hn})),n.d(e,"Vector3",(function(){return Kn})),n.d(e,"Vector4",(function(){return $n})),n.d(e,"VectorKeyframeTrack",(function(){return Tc})),n.d(e,"Vertex",(function(){return qf})),n.d(e,"VertexColors",(function(){return Df})),n.d(e,"VideoTexture",(function(){return Fl})),n.d(e,"WebGLCubeRenderTarget",(function(){return Ma})),n.d(e,"WebGLMultisampleRenderTarget",(function(){return Qn})),n.d(e,"WebGLRenderTarget",(function(){return Yn})),n.d(e,"WebGLRenderTargetCube",(function(){return hp})),n.d(e,"WebGLRenderer",(function(){return Ls})),n.d(e,"WebGLUtils",(function(){return Ps})),n.d(e,"WireframeGeometry",(function(){return Hl})),n.d(e,"WireframeHelper",(function(){return lp})),n.d(e,"WrapAroundEnding",(function(){return $e})),n.d(e,"XHRLoader",(function(){return up})),n.d(e,"ZeroCurvatureEnding",(function(){return qe})),n.d(e,"ZeroFactor",(function(){return N})),n.d(e,"ZeroSlopeEnding",(function(){return We})),n.d(e,"ZeroStencilOp",(function(){return dn})),n.d(e,"sRGBEncoding",(function(){return tn})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var r="116",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,s=1,l=2,u=3,c=0,h=1,d=0,f=1,p=2,m=3,g=0,v=1,y=2,b=1,x=2,_=0,w=1,S=2,E=3,M=4,C=5,T=100,k=101,P=102,A=103,O=104,N=200,R=201,L=202,I=203,D=204,z=205,F=206,B=207,V=208,j=209,H=210,U=0,G=1,q=2,W=3,$=4,Y=5,Q=6,X=7,Z=0,J=1,K=2,tt=0,et=1,nt=2,rt=3,it=4,at=5,ot=300,st=301,lt=302,ut=303,ct=304,ht=305,dt=306,ft=307,pt=1e3,mt=1001,gt=1002,vt=1003,yt=1004,bt=1004,xt=1005,_t=1005,wt=1006,St=1007,Et=1007,Mt=1008,Ct=1008,Tt=1009,kt=1010,Pt=1011,At=1012,Ot=1013,Nt=1014,Rt=1015,Lt=1016,It=1017,Dt=1018,zt=1019,Ft=1020,Bt=1021,Vt=1022,jt=1023,Ht=1024,Ut=1025,Gt=jt,qt=1026,Wt=1027,$t=1028,Yt=1029,Qt=1030,Xt=1031,Zt=1032,Jt=1033,Kt=33776,te=33777,ee=33778,ne=33779,re=35840,ie=35841,ae=35842,oe=35843,se=36196,le=37492,ue=37496,ce=37808,he=37809,de=37810,fe=37811,pe=37812,me=37813,ge=37814,ve=37815,ye=37816,be=37817,xe=37818,_e=37819,we=37820,Se=37821,Ee=36492,Me=37840,Ce=37841,Te=37842,ke=37843,Pe=37844,Ae=37845,Oe=37846,Ne=37847,Re=37848,Le=37849,Ie=37850,De=37851,ze=37852,Fe=37853,Be=2200,Ve=2201,je=2202,He=2300,Ue=2301,Ge=2302,qe=2400,We=2401,$e=2402,Ye=2500,Qe=2501,Xe=0,Ze=1,Je=2,Ke=3e3,tn=3001,en=3007,nn=3002,rn=3003,an=3004,on=3005,sn=3006,ln=3200,un=3201,cn=0,hn=1,dn=0,fn=7680,pn=7681,mn=7682,gn=7683,vn=34055,yn=34056,bn=5386,xn=512,_n=513,wn=514,Sn=515,En=516,Mn=517,Cn=518,Tn=519,kn=35044,Pn=35048,An=35040,On=35045,Nn=35049,Rn=35041,Ln=35046,In=35050,Dn=35042;function zn(){}Object.assign(zn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var Fn=[],Bn=0;Bn<256;Bn++)Fn[Bn]=(Bn<16?"0":"")+Bn.toString(16);var Vn,jn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Fn[255&t]+Fn[t>>8&255]+Fn[t>>16&255]+Fn[t>>24&255]+"-"+Fn[255&e]+Fn[e>>8&255]+"-"+Fn[e>>16&15|64]+Fn[e>>24&255]+"-"+Fn[63&n|128]+Fn[n>>8&255]+"-"+Fn[n>>16&255]+Fn[n>>24&255]+Fn[255&r]+Fn[r>>8&255]+Fn[r>>16&255]+Fn[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*jn.DEG2RAD},radToDeg:function(t){return t*jn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((e+r)/2),c=o((e+r)/2),h=a((e-r)/2),d=o((e-r)/2),f=a((r-e)/2),p=o((r-e)/2);switch(i){case"XYX":t.set(s*c,l*h,l*d,s*u);break;case"YZY":t.set(l*d,s*c,l*h,s*u);break;case"ZXZ":t.set(l*h,l*d,s*c,s*u);break;case"XZX":t.set(s*c,l*p,l*f,s*u);break;case"YXY":t.set(l*f,s*c,l*p,s*u);break;case"ZYZ":t.set(l*p,l*f,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};function Hn(t,e){this.x=t||0,this.y=e||0}function Un(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Hn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Hn.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,a=this.y-t.y;return this.x=i*n-a*r+t.x,this.y=i*r+a*n+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Un.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=e,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],x=r[2],_=r[5],w=r[8];return i[0]=a*p+o*v+s*x,i[3]=a*m+o*y+s*_,i[6]=a*g+o*b+s*w,i[1]=l*p+u*v+c*x,i[4]=l*m+u*y+c*_,i[7]=l*g+u*b+c*w,i[2]=h*p+d*v+f*x,i[5]=h*m+d*y+f*_,i[8]=h*g+d*b+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*a*u-e*o*l-n*i*u+n*o*s+r*i*l-r*a*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=d*l-u*h,p=u*c-d*s,m=h*s-l*c,g=i*f+a*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var v=1/g;return r[0]=f*v,r[1]=(o*h-d*a)*v,r[2]=(u*a-o*l)*v,r[3]=p*v,r[4]=(d*i-o*c)*v,r[5]=(o*s-u*i)*v,r[6]=m*v,r[7]=(a*c-h*i)*v,r[8]=(l*i-a*s)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);this.set(n*s,n*l,-n*(s*a+l*o)+a+t,-r*l,r*s,-r*(-l*a+s*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],l=r[4],u=r[7];return r[0]=e*i+n*s,r[3]=e*a+n*l,r[6]=e*o+n*u,r[1]=-n*i+e*s,r[4]=-n*a+e*l,r[7]=-n*o+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Gn={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Vn&&(Vn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Vn.width=t.width,Vn.height=t.height;var n=Vn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Vn}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},qn=0;function Wn(t,e,n,r,i,a,o,s,l,u){Object.defineProperty(this,"id",{value:qn++}),this.uuid=jn.generateUUID(),this.name="",this.image=void 0!==t?t:Wn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Wn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:mt,this.wrapT=void 0!==r?r:mt,this.magFilter=void 0!==i?i:wt,this.minFilter=void 0!==a?a:Mt,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:jt,this.internalFormat=null,this.type=void 0!==s?s:Tt,this.offset=new Hn(0,0),this.repeat=new Hn(1,1),this.center=new Hn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Un,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ke,this.version=0,this.onUpdate=null}function $n(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Yn(t,e,n){this.width=t,this.height=e,this.scissor=new $n(0,0,t,e),this.scissorTest=!1,this.viewport=new $n(0,0,t,e),n=n||{},this.texture=new Wn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:wt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Qn(t,e,n){Yn.call(this,t,e,n),this.samples=4}function Xn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}Wn.DEFAULT_IMAGE=void 0,Wn.DEFAULT_MAPPING=ot,Wn.prototype=Object.assign(Object.create(zn.prototype),{constructor:Wn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=jn.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(Gn.getDataURL(r[a]))}else i=Gn.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==ot)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case pt:t.x=t.x-Math.floor(t.x);break;case mt:t.x=t.x<0?0:1;break;case gt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case pt:t.y=t.y-Math.floor(t.y);break;case mt:t.y=t.y<0?0:1;break;case gt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Wn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties($n.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign($n.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,a=t.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],f=a[6],p=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,g=(c+1)/2,v=(p+1)/2,y=(s+u)/4,b=(l+d)/4,x=(h+f)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=x/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=x/i),this.set(n,r,i,e),this}var _=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(_)<.001&&(_=1),this.x=(f-h)/_,this.y=(l-d)/_,this.z=(u-s)/_,this.w=Math.acos((o+c+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Yn.prototype=Object.assign(Object.create(zn.prototype),{constructor:Yn,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Qn.prototype=Object.assign(Object.create(Yn.prototype),{constructor:Qn,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Yn.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(Xn,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(c!==p||s!==h||l!==d||u!==f){var m=1-o,g=s*h+l*d+u*f+c*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,o=Math.sin(o*x)/b}var _=o*v;if(s=s*m+h*_,l=l*m+d*_,u=u*m+f*_,c=c*m+p*_,m===1-o){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=c},multiplyQuaternionsFlat:function(t,e,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],u=n[r+3],c=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return t[e]=o*f+u*c+s*d-l*h,t[e+1]=s*f+u*h+l*c-o*d,t[e+2]=l*f+u*d+o*h-s*c,t[e+3]=u*f-o*c-s*h-l*d,t}}),Object.defineProperties(Xn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(Xn.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,a=t.order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),h=s(n/2),d=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=r+s+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-l)*e,this._y=(a-u)*e,this._z=(o-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(c-l)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(a+u)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(a-u)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(o-i)/e,this._x=(a+u)/e,this._y=(l+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(jn.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,a=t._w,o=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-e;return this._w=l*a+e*this._w,this._x=l*n+e*this._x,this._y=l*r+e*this._y,this._z=l*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-e)*c)/u,d=Math.sin(e*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=i*h+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Zn=new Kn,Jn=new Xn;function Kn(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(Kn.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Jn.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Jn.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,a=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*r-o*n,u=s*n+o*e-i*r,c=s*r+i*n-a*e,h=-i*e-a*n-o*r;return this.x=l*s+h*-i+u*-o-c*-a,this.y=u*s+h*-a+c*-i-l*-o,this.z=c*s+h*-o+l*-a-u*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,a=e.x,o=e.y,s=e.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return Zn.copy(this).projectOnVector(t),this.sub(Zn)},reflect:function(t){return this.sub(Zn.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(jn.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var tr=new Kn,er=new sr,nr=new Kn(0,0,0),rr=new Kn(1,1,1),ir=new Kn,ar=new Kn,or=new Kn;function sr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(sr.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,a,o,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new sr).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/tr.setFromMatrixColumn(t,0).length(),i=1/tr.setFromMatrixColumn(t,1).length(),a=1/tr.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=a*u,d=a*c,f=o*u,p=o*c;e[0]=s*u,e[4]=-s*c,e[8]=l,e[1]=d+f*l,e[5]=h-p*l,e[9]=-o*s,e[2]=p-h*l,e[6]=f+d*l,e[10]=a*s}else if("YXZ"===t.order){var m=s*u,g=s*c,v=l*u,y=l*c;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*l,e[1]=a*c,e[5]=a*u,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*u,g=s*c,v=l*u,y=l*c;e[0]=m-y*o,e[4]=-a*c,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*u,e[9]=y-m*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){h=a*u,d=a*c,f=o*u,p=o*c;e[0]=s*u,e[4]=f*l-d,e[8]=h*l+p,e[1]=s*c,e[5]=p*l+h,e[9]=d*l-f,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var b=a*s,x=a*l,_=o*s,w=o*l;e[0]=s*u,e[4]=w-b*c,e[8]=_*c+x,e[1]=c,e[5]=a*u,e[9]=-o*u,e[2]=-l*u,e[6]=x*c+_,e[10]=b-w*c}else if("XZY"===t.order){b=a*s,x=a*l,_=o*s,w=o*l;e[0]=s*u,e[4]=-c,e[8]=l*u,e[1]=b*c+w,e[5]=a*u,e[9]=x*c-_,e[2]=_*c-x,e[6]=o*u,e[10]=w*c+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(nr,t,rr)},lookAt:function(t,e,n){var r=this.elements;return or.subVectors(t,e),0===or.lengthSq()&&(or.z=1),or.normalize(),ir.crossVectors(n,or),0===ir.lengthSq()&&(1===Math.abs(n.z)?or.x+=1e-4:or.z+=1e-4,or.normalize(),ir.crossVectors(n,or)),ir.normalize(),ar.crossVectors(or,ir),r[0]=ir.x,r[4]=ar.x,r[8]=or.x,r[1]=ir.y,r[5]=ar.y,r[9]=or.y,r[2]=ir.z,r[6]=ar.z,r[10]=or.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],_=r[0],w=r[4],S=r[8],E=r[12],M=r[1],C=r[5],T=r[9],k=r[13],P=r[2],A=r[6],O=r[10],N=r[14],R=r[3],L=r[7],I=r[11],D=r[15];return i[0]=a*_+o*M+s*P+l*R,i[4]=a*w+o*C+s*A+l*L,i[8]=a*S+o*T+s*O+l*I,i[12]=a*E+o*k+s*N+l*D,i[1]=u*_+c*M+h*P+d*R,i[5]=u*w+c*C+h*A+d*L,i[9]=u*S+c*T+h*O+d*I,i[13]=u*E+c*k+h*N+d*D,i[2]=f*_+p*M+m*P+g*R,i[6]=f*w+p*C+m*A+g*L,i[10]=f*S+p*T+m*O+g*I,i[14]=f*E+p*k+m*N+g*D,i[3]=v*_+y*M+b*P+x*R,i[7]=v*w+y*C+b*A+x*L,i[11]=v*S+y*T+b*O+x*I,i[15]=v*E+y*k+b*N+x*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+i*s*c-r*l*c-i*o*h+n*l*h+r*o*d-n*s*d)+t[7]*(+e*s*d-e*l*h+i*a*h-r*a*d+r*l*u-i*s*u)+t[11]*(+e*l*c-e*o*d-i*a*c+n*a*d+i*o*u-n*l*u)+t[15]*(-r*o*u-e*s*c+e*o*h+r*a*c-n*a*h+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15],x=f*y*h-v*p*h+v*c*m-u*y*m-f*c*b+u*p*b,_=g*p*h-d*y*h-g*c*m+l*y*m+d*c*b-l*p*b,w=d*v*h-g*f*h+g*u*m-l*v*m-d*u*b+l*f*b,S=g*f*c-d*v*c-g*u*p+l*v*p+d*u*y-l*f*y,E=i*x+a*_+o*w+s*S;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var M=1/E;return n[0]=x*M,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*b-a*p*b)*M,n[2]=(u*y*s-v*c*s+v*o*h-a*y*h-u*o*b+a*c*b)*M,n[3]=(f*c*s-u*p*s-f*o*h+a*p*h+u*o*m-a*c*m)*M,n[4]=_*M,n[5]=(d*y*s-g*p*s+g*o*m-i*y*m-d*o*b+i*p*b)*M,n[6]=(g*c*s-l*y*s-g*o*h+i*y*h+l*o*b-i*c*b)*M,n[7]=(l*p*s-d*c*s+d*o*h-i*p*h-l*o*m+i*c*m)*M,n[8]=w*M,n[9]=(g*f*s-d*v*s-g*a*m+i*v*m+d*a*b-i*f*b)*M,n[10]=(l*v*s-g*u*s+g*a*h-i*v*h-l*a*b+i*u*b)*M,n[11]=(d*u*s-l*f*s-d*a*h+i*f*h+l*a*m-i*u*m)*M,n[12]=S*M,n[13]=(d*v*o-g*f*o+g*a*p-i*v*p-d*a*y+i*f*y)*M,n[14]=(g*u*o-l*v*o-g*a*c+i*v*c+l*a*y-i*u*y)*M,n[15]=(l*f*o-d*u*o+d*a*c-i*f*c-l*a*p+i*u*p)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,a=t.x,o=t.y,s=t.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,f=i*c,p=a*u,m=a*c,g=o*c,v=s*l,y=s*u,b=s*c,x=n.x,_=n.y,w=n.z;return r[0]=(1-(p+g))*x,r[1]=(d+b)*x,r[2]=(f-y)*x,r[3]=0,r[4]=(d-b)*_,r[5]=(1-(h+g))*_,r[6]=(m+v)*_,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=tr.set(r[0],r[1],r[2]).length(),a=tr.set(r[4],r[5],r[6]).length(),o=tr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],er.copy(this);var s=1/i,l=1/a,u=1/o;return er.elements[0]*=s,er.elements[1]*=s,er.elements[2]*=s,er.elements[4]*=l,er.elements[5]*=l,er.elements[6]*=l,er.elements[8]*=u,er.elements[9]*=u,er.elements[10]*=u,e.setFromRotationMatrix(er),n.x=i,n.y=a,n.z=o,this},makePerspective:function(t,e,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(e-t),l=2*i/(n-r),u=(e+t)/(e-t),c=(n+r)/(n-r),h=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,r,i,a){var o=this.elements,s=1/(e-t),l=1/(n-r),u=1/(a-i),c=(e+t)*s,h=(n+r)*l,d=(a+i)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var lr=new sr,ur=new Xn;function cr(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||cr.DefaultOrder}function hr(){this.mask=1}cr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],cr.DefaultOrder="XYZ",Object.defineProperties(cr.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(cr.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=jn.clamp,i=t.elements,a=i[0],o=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],f=i[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return lr.makeRotationFromQuaternion(t),this.setFromRotationMatrix(lr,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return ur.setFromEuler(this),this.setFromQuaternion(ur,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Kn(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(hr.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var dr=0,fr=new Kn,pr=new Xn,mr=new sr,gr=new Kn,vr=new Kn,yr=new Kn,br=new Xn,xr=new Kn(1,0,0),_r=new Kn(0,1,0),wr=new Kn(0,0,1),Sr={type:"added"},Er={type:"removed"};function Mr(){Object.defineProperty(this,"id",{value:dr++}),this.uuid=jn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mr.DefaultUp.clone();var t=new Kn,e=new cr,n=new Xn,r=new Kn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new sr},normalMatrix:{value:new Un}}),this.matrix=new sr,this.matrixWorld=new sr,this.matrixAutoUpdate=Mr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Cr(){Mr.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Mr.DefaultUp=new Kn(0,1,0),Mr.DefaultMatrixAutoUpdate=!0,Mr.prototype=Object.assign(Object.create(zn.prototype),{constructor:Mr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return pr.setFromAxisAngle(t,e),this.quaternion.multiply(pr),this},rotateOnWorldAxis:function(t,e){return pr.setFromAxisAngle(t,e),this.quaternion.premultiply(pr),this},rotateX:function(t){return this.rotateOnAxis(xr,t)},rotateY:function(t){return this.rotateOnAxis(_r,t)},rotateZ:function(t){return this.rotateOnAxis(wr,t)},translateOnAxis:function(t,e){return fr.copy(t).applyQuaternion(this.quaternion),this.position.add(fr.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(xr,t)},translateY:function(t){return this.translateOnAxis(_r,t)},translateZ:function(t){return this.translateOnAxis(wr,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(mr.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?gr.copy(t):gr.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),vr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mr.lookAt(vr,gr,this.up):mr.lookAt(gr,vr,this.up),this.quaternion.setFromRotationMatrix(mr),r&&(mr.extractRotation(r.matrixWorld),pr.setFromRotationMatrix(mr),this.quaternion.premultiply(pr.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Sr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Er)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),mr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),mr.multiply(t.parent.matrixWorld)),t.applyMatrix4(mr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Kn),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Xn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vr,t,yr),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Kn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vr,br,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Kn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(t.shapes,u)}else i(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(i(t.materials,this.material[s]));r.material=c}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),d=m(t.materials),f=m(t.textures),p=m(t.images);o=m(t.shapes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),Cr.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Cr,isScene:!0,copy:function(t,e){return Mr.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Mr.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Tr=[new Kn,new Kn,new Kn,new Kn,new Kn,new Kn,new Kn,new Kn],kr=new Kn,Pr=new Vr,Ar=new Kn,Or=new Kn,Nr=new Kn,Rr=new Kn,Lr=new Kn,Ir=new Kn,Dr=new Kn,zr=new Kn,Fr=new Kn,Br=new Kn;function Vr(t,e){this.min=void 0!==t?t:new Kn(1/0,1/0,1/0),this.max=void 0!==e?e:new Kn(-1/0,-1/0,-1/0)}function jr(t,e,n,r,i){var a,o;for(a=0,o=t.length-3;a<=o;a+=3){Br.fromArray(t,a);var s=i.x*Math.abs(Br.x)+i.y*Math.abs(Br.y)+i.z*Math.abs(Br.z),l=e.dot(Br),u=n.dot(Br),c=r.dot(Br);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}Object.assign(Vr.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=kr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Kn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Kn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Pr.copy(e.boundingBox),Pr.applyMatrix4(t.matrixWorld),this.union(Pr));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Kn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,kr),kr.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(Dr),zr.subVectors(this.max,Dr),Ar.subVectors(t.a,Dr),Or.subVectors(t.b,Dr),Nr.subVectors(t.c,Dr),Rr.subVectors(Or,Ar),Lr.subVectors(Nr,Or),Ir.subVectors(Ar,Nr);var e=[0,-Rr.z,Rr.y,0,-Lr.z,Lr.y,0,-Ir.z,Ir.y,Rr.z,0,-Rr.x,Lr.z,0,-Lr.x,Ir.z,0,-Ir.x,-Rr.y,Rr.x,0,-Lr.y,Lr.x,0,-Ir.y,Ir.x,0];return!!jr(e,Ar,Or,Nr,zr)&&(!!jr(e=[1,0,0,0,1,0,0,0,1],Ar,Or,Nr,zr)&&(Fr.crossVectors(Rr,Lr),jr(e=[Fr.x,Fr.y,Fr.z],Ar,Or,Nr,zr)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Kn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return kr.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(kr).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Tr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Tr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Tr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Tr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Tr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Tr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Tr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Tr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Tr)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Hr=new Vr;function Ur(t,e){this.center=void 0!==t?t:new Kn,this.radius=void 0!==e?e:-1}Object.assign(Ur.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):Hr.setFromPoints(t).getCenter(n);for(var r=0,i=0,a=t.length;i<a;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Kn),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Vr),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Gr=new Kn,qr=new Kn,Wr=new Kn,$r=new Kn,Yr=new Kn,Qr=new Kn,Xr=new Kn;function Zr(t,e){this.origin=void 0!==t?t:new Kn,this.direction=void 0!==e?e:new Kn(0,0,-1)}Object.assign(Zr.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Kn),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Gr)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Kn),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Gr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Gr.copy(this.direction).multiplyScalar(e).add(this.origin),Gr.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){qr.copy(t).add(e).multiplyScalar(.5),Wr.copy(e).sub(t).normalize(),$r.copy(this.origin).sub(qr);var i,a,o,s,l=.5*t.distanceTo(e),u=-this.direction.dot(Wr),c=$r.dot(this.direction),h=-$r.dot(Wr),d=$r.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*c-h,s=l*f,(i=u*h-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(i*=p)*(i+u*(a*=p)+2*c)+a*(u*i+a+2*h)+d}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a<=-s?o=-(i=Math.max(0,-(-u*l+c)))*i+(a=i>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(i=Math.max(0,-(u*l+c)))*i+(a=i>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Wr).multiplyScalar(a).add(qr),o},intersectSphere:function(t,e){Gr.subVectors(t.center,this.origin);var n=Gr.dot(this.direction),r=Gr.dot(Gr)-n*n,i=t.radius*t.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),u>=0?(i=(t.min.y-h.y)*u,a=(t.max.y-h.y)*u):(i=(t.max.y-h.y)*u,a=(t.min.y-h.y)*u),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),c>=0?(o=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(o=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Gr)},intersectTriangle:function(t,e,n,r,i){Yr.subVectors(e,t),Qr.subVectors(n,t),Xr.crossVectors(Yr,Qr);var a,o=this.direction.dot(Xr);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}$r.subVectors(this.origin,t);var s=a*this.direction.dot(Qr.crossVectors($r,Qr));if(s<0)return null;var l=a*this.direction.dot(Yr.cross($r));if(l<0)return null;if(s+l>o)return null;var u=-a*$r.dot(Xr);return u<0?null:this.at(u/o,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Jr=new Kn,Kr=new Kn,ti=new Un;function ei(t,e){this.normal=void 0!==t?t:new Kn(1,0,0),this.constant=void 0!==e?e:0}Object.assign(ei.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=Jr.subVectors(n,e).cross(Kr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Kn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Kn);var n=t.delta(Jr),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Kn),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||ti.getNormalMatrix(t),r=this.coplanarPoint(Jr).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var ni=new Kn,ri=new Kn,ii=new Kn,ai=new Kn,oi=new Kn,si=new Kn,li=new Kn,ui=new Kn,ci=new Kn,hi=new Kn;function di(t,e,n){this.a=void 0!==t?t:new Kn,this.b=void 0!==e?e:new Kn,this.c=void 0!==n?n:new Kn}Object.assign(di,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Kn),r.subVectors(n,e),ni.subVectors(t,e),r.cross(ni);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){ni.subVectors(r,e),ri.subVectors(n,e),ii.subVectors(t,e);var a=ni.dot(ni),o=ni.dot(ri),s=ni.dot(ii),l=ri.dot(ri),u=ri.dot(ii),c=a*l-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Kn),0===c)return i.set(-2,-1,-1);var h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return i.set(1-d-f,f,d)},containsPoint:function(t,e,n,r){return di.getBarycoord(t,e,n,r,ai),ai.x>=0&&ai.y>=0&&ai.x+ai.y<=1},getUV:function(t,e,n,r,i,a,o,s){return this.getBarycoord(t,e,n,r,ai),s.set(0,0),s.addScaledVector(i,ai.x),s.addScaledVector(a,ai.y),s.addScaledVector(o,ai.z),s},isFrontFacing:function(t,e,n,r){return ni.subVectors(n,e),ri.subVectors(t,e),ni.cross(ri).dot(r)<0}}),Object.assign(di.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return ni.subVectors(this.c,this.b),ri.subVectors(this.a,this.b),.5*ni.cross(ri).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Kn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return di.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new ei),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return di.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return di.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return di.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return di.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Kn);var n,r,i=this.a,a=this.b,o=this.c;oi.subVectors(a,i),si.subVectors(o,i),ui.subVectors(t,i);var s=oi.dot(ui),l=si.dot(ui);if(s<=0&&l<=0)return e.copy(i);ci.subVectors(t,a);var u=oi.dot(ci),c=si.dot(ci);if(u>=0&&c<=u)return e.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),e.copy(i).addScaledVector(oi,n);hi.subVectors(t,o);var d=oi.dot(hi),f=si.dot(hi);if(f>=0&&d<=f)return e.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return r=l/(l-f),e.copy(i).addScaledVector(si,r);var m=u*f-d*c;if(m<=0&&c-u>=0&&d-f>=0)return li.subVectors(o,a),r=(c-u)/(c-u+(d-f)),e.copy(a).addScaledVector(li,r);var g=1/(m+p+h);return n=p*g,r=h*g,e.copy(i).addScaledVector(oi,n).addScaledVector(si,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var fi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pi={h:0,s:0,l:0},mi={h:0,s:0,l:0};function gi(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function vi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function yi(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function bi(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function xi(t,e,n,r,i,a){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new Kn,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new gi,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}Object.assign(gi.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=jn.euclideanModulo(t,1),e=jn.clamp(e,0,1),n=jn.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=vi(i,r,t+1/3),this.g=vi(i,r,t),this.b=vi(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=fi[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=yi(t.r),this.g=yi(t.g),this.b=yi(t.b),this},copyLinearToSRGB:function(t){return this.r=bi(t.r),this.g=bi(t.g),this.b=bi(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),l=(s+o)/2;if(s===o)e=0,n=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case r:e=(i-a)/u+(i<a?6:0);break;case i:e=(a-r)/u+2;break;case a:e=(r-i)/u+4}e/=6}return t.h=e,t.s=n,t.l=l,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(pi),pi.h+=t,pi.s+=e,pi.l+=n,this.setHSL(pi.h,pi.s,pi.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(pi),t.getHSL(mi);var n=jn.lerp(pi.h,mi.h,e),r=jn.lerp(pi.s,mi.s,e),i=jn.lerp(pi.l,mi.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),gi.NAMES=fi,Object.assign(xi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var _i=0;function wi(){Object.defineProperty(this,"id",{value:_i++}),this.uuid=jn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=w,this.side=g,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=z,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Tn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=fn,this.stencilZFail=fn,this.stencilZPass=fn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Si(t){wi.call(this),this.type="MeshBasicMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}wi.prototype=Object.assign(Object.create(zn.prototype),{constructor:wi,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===b;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==w&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==g&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),a=r(t.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(wi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Si.prototype=Object.create(wi.prototype),Si.prototype.constructor=Si,Si.prototype.isMeshBasicMaterial=!0,Si.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Ei=new Kn;function Mi(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=kn,this.updateRange={offset:0,count:-1},this.version=0}function Ci(t,e,n){Mi.call(this,new Int8Array(t),e,n)}function Ti(t,e,n){Mi.call(this,new Uint8Array(t),e,n)}function ki(t,e,n){Mi.call(this,new Uint8ClampedArray(t),e,n)}function Pi(t,e,n){Mi.call(this,new Int16Array(t),e,n)}function Ai(t,e,n){Mi.call(this,new Uint16Array(t),e,n)}function Oi(t,e,n){Mi.call(this,new Int32Array(t),e,n)}function Ni(t,e,n){Mi.call(this,new Uint32Array(t),e,n)}function Ri(t,e,n){Mi.call(this,new Float32Array(t),e,n)}function Li(t,e,n){Mi.call(this,new Float64Array(t),e,n)}function Ii(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Di(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Mi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Mi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new gi),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Hn),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Kn),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new $n),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)Ei.x=this.getX(e),Ei.y=this.getY(e),Ei.z=this.getZ(e),Ei.applyMatrix3(t),this.setXYZ(e,Ei.x,Ei.y,Ei.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Ei.x=this.getX(e),Ei.y=this.getY(e),Ei.z=this.getZ(e),Ei.applyMatrix4(t),this.setXYZ(e,Ei.x,Ei.y,Ei.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Ei.x=this.getX(e),Ei.y=this.getY(e),Ei.z=this.getZ(e),Ei.applyNormalMatrix(t),this.setXYZ(e,Ei.x,Ei.y,Ei.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Ei.x=this.getX(e),Ei.y=this.getY(e),Ei.z=this.getZ(e),Ei.transformDirection(t),this.setXYZ(e,Ei.x,Ei.y,Ei.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Ci.prototype=Object.create(Mi.prototype),Ci.prototype.constructor=Ci,Ti.prototype=Object.create(Mi.prototype),Ti.prototype.constructor=Ti,ki.prototype=Object.create(Mi.prototype),ki.prototype.constructor=ki,Pi.prototype=Object.create(Mi.prototype),Pi.prototype.constructor=Pi,Ai.prototype=Object.create(Mi.prototype),Ai.prototype.constructor=Ai,Oi.prototype=Object.create(Mi.prototype),Oi.prototype.constructor=Oi,Ni.prototype=Object.create(Mi.prototype),Ni.prototype.constructor=Ni,Ri.prototype=Object.create(Mi.prototype),Ri.prototype.constructor=Ri,Li.prototype=Object.create(Mi.prototype),Li.prototype.constructor=Li,Object.assign(Ii.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,n.push(e)),e={start:3*a,materialIndex:r})}void 0!==e&&(e.count=3*a-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=t.morphTargets,l=s.length;if(l>0){e=[];for(var u=0;u<l;u++)e[u]={name:s[u].name,data:[]};this.morphTargets.position=e}var c,h=t.morphNormals,d=h.length;if(d>0){c=[];for(u=0;u<d;u++)c[u]={name:h[u].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,p=t.skinWeights,m=f.length===r.length,g=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(x=i[0][u])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Hn,new Hn,new Hn));if(!0===o)void 0!==(x=i[1][u])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Hn,new Hn,new Hn));for(var S=0;S<l;S++){var E=s[S].vertices;e[S].data.push(E[v.a],E[v.b],E[v.c])}for(S=0;S<d;S++){var M=h[S].vertexNormals[u];c[S].data.push(M.a,M.b,M.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var zi=1,Fi=new sr,Bi=new Mr,Vi=new Kn,ji=new Vr,Hi=new Vr,Ui=new Kn;function Gi(){Object.defineProperty(this,"id",{value:zi+=2}),this.uuid=jn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Gi.prototype=Object.assign(Object.create(zn.prototype),{constructor:Gi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Di(t)>65535?Ni:Ai)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Un).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Fi.makeRotationX(t),this.applyMatrix4(Fi),this},rotateY:function(t){return Fi.makeRotationY(t),this.applyMatrix4(Fi),this},rotateZ:function(t){return Fi.makeRotationZ(t),this.applyMatrix4(Fi),this},translate:function(t,e,n){return Fi.makeTranslation(t,e,n),this.applyMatrix4(Fi),this},scale:function(t,e,n){return Fi.makeScale(t,e,n),this.applyMatrix4(Fi),this},lookAt:function(t){return Bi.lookAt(t),Bi.updateMatrix(),this.applyMatrix4(Bi.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vi).negate(),this.translate(Vi.x,Vi.y,Vi.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new Ri(3*e.vertices.length,3),r=new Ri(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new Ri(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Ri(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Ii).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Mi(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Mi(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new Mi(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Mi(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Mi(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],l=t.morphTargets[o],u=0,c=l.length;u<c;u++){var h=l[u],d=new Ri(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var f=new Ri(4*t.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new Ri(4*t.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vr);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];ji.setFromBufferAttribute(i),this.morphTargetsRelative?(Ui.addVectors(this.boundingBox.min,ji.min),this.boundingBox.expandByPoint(Ui),Ui.addVectors(this.boundingBox.max,ji.max),this.boundingBox.expandByPoint(Ui)):(this.boundingBox.expandByPoint(ji.min),this.boundingBox.expandByPoint(ji.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ur);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(ji.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var a=e[r];Hi.setFromBufferAttribute(a),this.morphTargetsRelative?(Ui.addVectors(ji.min,Hi.min),ji.expandByPoint(Ui),Ui.addVectors(ji.max,Hi.max),ji.expandByPoint(Ui)):(ji.expandByPoint(Hi.min),ji.expandByPoint(Hi.max))}ji.getCenter(n);var o=0;for(r=0,i=t.count;r<i;r++)Ui.fromBufferAttribute(t,r),o=Math.max(o,n.distanceToSquared(Ui));if(e)for(r=0,i=e.length;r<i;r++){a=e[r];for(var s=this.morphTargetsRelative,l=0,u=a.count;l<u;l++)Ui.fromBufferAttribute(a,l),s&&(Vi.fromBufferAttribute(t,l),Ui.add(Vi)),o=Math.max(o,n.distanceToSquared(Ui))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Mi(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,a=r.length;i<a;i++)r[i]=0;var o,s,l,u=e.normal.array,c=new Kn,h=new Kn,d=new Kn,f=new Kn,p=new Kn;if(t){var m=t.array;for(i=0,a=t.count;i<a;i+=3)o=3*m[i+0],s=3*m[i+1],l=3*m[i+2],c.fromArray(n,o),h.fromArray(n,s),d.fromArray(n,l),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[o]+=f.x,u[o+1]+=f.y,u[o+2]+=f.z,u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z}else for(i=0,a=n.length;i<a;i+=9)c.fromArray(n,i),h.fromArray(n,i+3),d.fromArray(n,i+6),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[i]=f.x,u[i+1]=f.y,u[i+2]=f.z,u[i+3]=f.x,u[i+4]=f.y,u[i+5]=f.z,u[i+6]=f.x,u[i+7]=f.y,u[i+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=t.attributes[r],o=a.array,s=a.itemSize*e,l=Math.min(o.length,i.length-s),u=0,c=s;u<l;u++,c++)i[c]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Ui.x=t.getX(e),Ui.y=t.getY(e),Ui.z=t.getZ(e),Ui.normalize(),t.setXYZ(e,Ui.x,Ui.y,Ui.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),a=0,o=0,s=0,l=e.length;s<l;s++){a=e[s]*r;for(var u=0;u<r;u++)i[o++]=n[a++]}return new Mi(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Gi,n=this.index.array,r=this.attributes;for(var i in r){var a=t(r[i],n);e.setAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],l=o[i],u=0,c=l.length;u<c;u++){a=t(l[u],n);s.push(a)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,d=(u=0,h.length);u<d;u++){var f=h[u];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var a=(d=i[n]).toJSON();""!==d.name&&(a.name=d.name),t.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var l=this.morphAttributes[n],u=[],c=0,h=l.length;c<h;c++){var d;a=(d=l[c]).toJSON();""!==d.name&&(a.name=d.name),u.push(a)}u.length>0&&(o[n]=u,s=!0)}s&&(t.data.morphAttributes=o,t.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var p=this.boundingSphere;return null!==p&&(t.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),t},clone:function(){return(new Gi).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var a=t.attributes;for(e in a){var o=a[e];this.setAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var l=[],u=s[e];for(n=0,r=u.length;n<r;n++)l.push(u[n].clone());this.morphAttributes[e]=l}this.morphTargetsRelative=t.morphTargetsRelative;var c=t.groups;for(n=0,r=c.length;n<r;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var qi=new sr,Wi=new Zr,$i=new Ur,Yi=new Kn,Qi=new Kn,Xi=new Kn,Zi=new Kn,Ji=new Kn,Ki=new Kn,ta=new Kn,ea=new Kn,na=new Kn,ra=new Hn,ia=new Hn,aa=new Hn,oa=new Kn,sa=new Kn;function la(t,e){Mr.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Gi,this.material=void 0!==e?e:new Si,this.updateMorphTargets()}function ua(t,e,n,r,i,a,o,s){if(null===(e.side===v?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,e.side!==y,s)))return null;sa.copy(s),sa.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(sa);return l<n.near||l>n.far?null:{distance:l,point:sa.clone(),object:t}}function ca(t,e,n,r,i,a,o,s,l,u,c,h){Yi.fromBufferAttribute(i,u),Qi.fromBufferAttribute(i,c),Xi.fromBufferAttribute(i,h);var d=t.morphTargetInfluences;if(e.morphTargets&&a&&d){ta.set(0,0,0),ea.set(0,0,0),na.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var m=d[f],g=a[f];0!==m&&(Zi.fromBufferAttribute(g,u),Ji.fromBufferAttribute(g,c),Ki.fromBufferAttribute(g,h),o?(ta.addScaledVector(Zi,m),ea.addScaledVector(Ji,m),na.addScaledVector(Ki,m)):(ta.addScaledVector(Zi.sub(Yi),m),ea.addScaledVector(Ji.sub(Qi),m),na.addScaledVector(Ki.sub(Xi),m)))}Yi.add(ta),Qi.add(ea),Xi.add(na)}t.isSkinnedMesh&&(t.boneTransform(u,Yi),t.boneTransform(c,Qi),t.boneTransform(h,Xi));var v=ua(t,e,n,r,Yi,Qi,Xi,oa);if(v){s&&(ra.fromBufferAttribute(s,u),ia.fromBufferAttribute(s,c),aa.fromBufferAttribute(s,h),v.uv=di.getUV(oa,Yi,Qi,Xi,ra,ia,aa,new Hn)),l&&(ra.fromBufferAttribute(l,u),ia.fromBufferAttribute(l,c),aa.fromBufferAttribute(l,h),v.uv2=di.getUV(oa,Yi,Qi,Xi,ra,ia,aa,new Hn));var y=new xi(u,c,h);di.getNormal(Yi,Qi,Xi,y.normal),v.face=y}return v}la.prototype=Object.assign(Object.create(Mr.prototype),{constructor:la,isMesh:!0,copy:function(t){return Mr.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),$i.copy(r.boundingSphere),$i.applyMatrix4(a),!1!==t.ray.intersectsSphere($i)&&(qi.getInverse(a),Wi.copy(t.ray).applyMatrix4(qi),null===r.boundingBox||!1!==Wi.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o,s,l,u,c,h,d,f,p,m=r.index,g=r.attributes.position,v=r.morphAttributes.position,y=r.morphTargetsRelative,b=r.attributes.uv,x=r.attributes.uv2,_=r.groups,w=r.drawRange;if(null!==m)if(Array.isArray(i))for(u=0,h=_.length;u<h;u++)for(p=i[(f=_[u]).materialIndex],c=Math.max(f.start,w.start),d=Math.min(f.start+f.count,w.start+w.count);c<d;c+=3)o=m.getX(c),s=m.getX(c+1),l=m.getX(c+2),(n=ca(this,p,t,Wi,g,v,y,b,x,o,s,l))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(u=Math.max(0,w.start),h=Math.min(m.count,w.start+w.count);u<h;u+=3)o=m.getX(u),s=m.getX(u+1),l=m.getX(u+2),(n=ca(this,i,t,Wi,g,v,y,b,x,o,s,l))&&(n.faceIndex=Math.floor(u/3),e.push(n));else if(void 0!==g)if(Array.isArray(i))for(u=0,h=_.length;u<h;u++)for(p=i[(f=_[u]).materialIndex],c=Math.max(f.start,w.start),d=Math.min(f.start+f.count,w.start+w.count);c<d;c+=3)(n=ca(this,p,t,Wi,g,v,y,b,x,o=c,s=c+1,l=c+2))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,e.push(n));else for(u=Math.max(0,w.start),h=Math.min(g.count,w.start+w.count);u<h;u+=3)(n=ca(this,i,t,Wi,g,v,y,b,x,o=u,s=u+1,l=u+2))&&(n.faceIndex=Math.floor(u/3),e.push(n))}else if(r.isGeometry){var S,E,M,C,T=Array.isArray(i),k=r.vertices,P=r.faces,A=r.faceVertexUvs[0];A.length>0&&(C=A);for(var O=0,N=P.length;O<N;O++){var R=P[O],L=T?i[R.materialIndex]:i;if(void 0!==L&&(S=k[R.a],E=k[R.b],M=k[R.c],n=ua(this,L,t,Wi,S,E,M,oa))){if(C&&C[O]){var I=C[O];ra.copy(I[0]),ia.copy(I[1]),aa.copy(I[2]),n.uv=di.getUV(oa,S,E,M,ra,ia,aa,new Hn)}n.face=R,n.faceIndex=O,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ha=0,da=new sr,fa=new Mr,pa=new Kn;function ma(){Object.defineProperty(this,"id",{value:ha+=2}),this.uuid=jn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ma.prototype=Object.assign(Object.create(zn.prototype),{constructor:ma,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Un).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return da.makeRotationX(t),this.applyMatrix4(da),this},rotateY:function(t){return da.makeRotationY(t),this.applyMatrix4(da),this},rotateZ:function(t){return da.makeRotationZ(t),this.applyMatrix4(da),this},translate:function(t,e,n){return da.makeTranslation(t,e,n),this.applyMatrix4(da),this},scale:function(t,e,n){return da.makeScale(t,e,n),this.applyMatrix4(da),this},lookAt:function(t){return fa.lookAt(t),fa.updateMatrix(),this.applyMatrix4(fa.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,l=void 0!==r.uv2?r.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0;u<i.length;u+=3)e.vertices.push((new Kn).fromArray(i,u)),void 0!==o&&e.colors.push((new gi).fromArray(o,u));function c(t,n,r,i){var u=void 0===o?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],c=new xi(t,n,r,void 0===a?[]:[(new Kn).fromArray(a,3*t),(new Kn).fromArray(a,3*n),(new Kn).fromArray(a,3*r)],u,i);e.faces.push(c),void 0!==s&&e.faceVertexUvs[0].push([(new Hn).fromArray(s,2*t),(new Hn).fromArray(s,2*n),(new Hn).fromArray(s,2*r)]),void 0!==l&&e.faceVertexUvs[1].push([(new Hn).fromArray(l,2*t),(new Hn).fromArray(l,2*n),(new Hn).fromArray(l,2*r)])}var h=t.groups;if(h.length>0)for(u=0;u<h.length;u++)for(var d=h[u],f=d.start,p=f,m=f+d.count;p<m;p+=3)void 0!==n?c(n[p],n[p+1],n[p+2],d.materialIndex):c(p,p+1,p+2,d.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)c(n[u],n[u+1],n[u+2]);else for(u=0;u<i.length/3;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(pa).negate(),this.translate(pa.x,pa.y,pa.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new sr;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new Kn,e=new Kn,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)o[e]=new Kn;if(t){var s,l,u,c=new Kn,h=new Kn;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],l=this.vertices[a.b],u=this.vertices[a.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),o[a.a].add(c),o[a.b].add(c),o[a.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,n=this.vertices.length;e<n;e++)o[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var d=(a=this.faces[r]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var a=new ma;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)l=new Kn,u={a:new Kn,b:new Kn,c:new Kn},o.push(l),s.push(u)}var l,u,c=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ur),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,l=t.faces,u=this.colors,c=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new Un).getNormalMatrix(e));for(var h=0,d=o.length;h<d;h++){var f=o[h].clone();void 0!==e&&f.applyMatrix4(e),a.push(f)}for(h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(h=0,d=l.length;h<d;h++){var p,m,g,v=l[h],y=v.vertexNormals,b=v.vertexColors;(p=new xi(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==r&&p.normal.applyMatrix3(r).normalize();for(var x=0,_=y.length;x<_;x++)m=y[x].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(x=0,_=b.length;x<_;x++)g=b[x],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(h=0,d=t.faceVertexUvs.length;h<d;h++){var w=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(x=0,_=w.length;x<_;x++){for(var S=w[x],E=[],M=0,C=S.length;M<C;M++)E.push(S[M].clone());this.faceVertexUvs[h].push(E)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,a,o,s,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[e]];var d=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],a=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new Kn(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===e&&(r=[]),o&&o.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],l={},u=[],c={},h=[],d={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,p),b=S(b,4,m),b=S(b,5,g),b=S(b,6,v),b=S(b,7,y),o.push(b),o.push(f.a,f.b,f.c),o.push(f.materialIndex),p){var x=this.faceVertexUvs[0][i];o.push(C(x[0]),C(x[1]),C(x[2]))}if(m&&o.push(E(f.normal)),g){var _=f.vertexNormals;o.push(E(_[0]),E(_[1]),E(_[2]))}if(v&&o.push(M(f.color)),y){var w=f.vertexColors;o.push(M(w[0]),M(w[1]),M(w[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function E(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=u.length,u.push(t.getHex())),c[e]}function C(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=r,t.data.normals=s,u.length>0&&(t.data.colors=u),h.length>0&&(t.data.uvs=[h]),t.data.faces=o,t},clone:function(){return(new ma).copy(this)},copy:function(t){var e,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var l=t.colors;for(e=0,n=l.length;e<n;e++)this.colors.push(l[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=c.length;r<i;r++){var h=c[r],d=[];for(a=0,o=h.length;a<o;a++){var f=h[a];d.push(f.clone())}this.faceVertexUvs[e].push(d)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)m.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(m.normals=[],r=0,i=p[e].normals.length;r<i;r++)m.normals.push(p[e].normals[r].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],r=0,i=g[e].vertexNormals.length;r<i;r++){var y=g[e].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],r=0,i=g[e].faceNormals.length;r<i;r++)v.faceNormals.push(g[e].faceNormals[r].clone());this.morphNormals.push(v)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ga extends ma{constructor(t,e,n,r,i,a){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new va(t,e,n,r,i,a)),this.mergeVertices()}}class va extends Gi{constructor(t,e,n,r,i,a){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],l=[],u=[],c=[],h=0,d=0;function f(t,e,n,r,i,a,f,p,m,g,v){var y,b,x=a/m,_=f/g,w=a/2,S=f/2,E=p/2,M=m+1,C=g+1,T=0,k=0,P=new Kn;for(b=0;b<C;b++){var A=b*_-S;for(y=0;y<M;y++){var O=y*x-w;P[t]=O*r,P[e]=A*i,P[n]=E,l.push(P.x,P.y,P.z),P[t]=0,P[e]=0,P[n]=p>0?1:-1,u.push(P.x,P.y,P.z),c.push(y/m),c.push(1-b/g),T+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var N=h+y+M*b,R=h+y+M*(b+1),L=h+(y+1)+M*(b+1),I=h+(y+1)+M*b;s.push(N,R,I),s.push(R,L,I),k+=6}o.addGroup(d,k,v),d+=k,h+=T}f("z","y","x",-1,-1,n,e,t,a,i,0),f("z","y","x",1,-1,n,e,-t,a,i,1),f("x","z","y",1,1,t,n,e,r,a,2),f("x","z","y",1,-1,t,n,-e,r,a,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new Ri(l,3)),this.setAttribute("normal",new Ri(u,3)),this.setAttribute("uv",new Ri(c,2))}}function ya(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function ba(t){for(var e={},n=0;n<t.length;n++){var r=ya(t[n]);for(var i in r)e[i]=r[i]}return e}var xa={clone:ya,merge:ba};function _a(t){wi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function wa(){Mr.call(this),this.type="Camera",this.matrixWorldInverse=new sr,this.projectionMatrix=new sr,this.projectionMatrixInverse=new sr}function Sa(t,e,n,r){wa.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}_a.prototype=Object.create(wi.prototype),_a.prototype.constructor=_a,_a.prototype.isShaderMaterial=!0,_a.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ya(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},_a.prototype.toJSON=function(t){var e=wi.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},wa.prototype=Object.assign(Object.create(Mr.prototype),{constructor:wa,isCamera:!0,copy:function(t,e){return Mr.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Kn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Mr.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Mr.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Sa.prototype=Object.assign(Object.create(wa.prototype),{constructor:Sa,isPerspectiveCamera:!0,copy:function(t,e){return wa.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*jn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*jn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*jn.RAD2DEG*Math.atan(Math.tan(.5*jn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*jn.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,e-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Mr.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function Ea(t,e,n,r){Mr.call(this),this.type="CubeCamera";var i=new Sa(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new Kn(1,0,0)),this.add(i);var a=new Sa(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new Kn(-1,0,0)),this.add(a);var o=new Sa(90,1,t,e);o.up.set(0,0,1),o.lookAt(new Kn(0,1,0)),this.add(o);var s=new Sa(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new Kn(0,-1,0)),this.add(s);var l=new Sa(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new Kn(0,0,1)),this.add(l);var u=new Sa(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new Kn(0,0,-1)),this.add(u),r=r||{format:Vt,magFilter:wt,minFilter:wt},this.renderTarget=new Ma(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,a),t.setRenderTarget(r,2),t.render(e,o),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,l),r.texture.generateMipmaps=c,t.setRenderTarget(r,5),t.render(e,u),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)t.setRenderTarget(a,o),t.clear(e,n,r);t.setRenderTarget(i)}}function Ma(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),Yn.call(this,t,t,e)}function Ca(t,e,n,r,i,a,o,s,l,u,c,h){Wn.call(this,null,a,o,s,l,u,r,i,c,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==l?l:vt,this.minFilter=void 0!==u?u:vt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ea.prototype=Object.create(Mr.prototype),Ea.prototype.constructor=Ea,Ma.prototype=Object.create(Yn.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isWebGLCubeRenderTarget=!0,Ma.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new Cr,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new _a({type:"CubemapFromEquirect",uniforms:ya(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:v,blending:_});i.uniforms.tEquirect.value=e;var a=new la(new va(5,5,5),i);n.add(a);var o=new Ea(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(t,n),a.geometry.dispose(),a.material.dispose(),this},Ca.prototype=Object.create(Wn.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isDataTexture=!0;var Ta=new Ur,ka=new Kn;function Pa(t,e,n,r,i,a){this.planes=[void 0!==t?t:new ei,void 0!==e?e:new ei,void 0!==n?n:new ei,void 0!==r?r:new ei,void 0!==i?i:new ei,void 0!==a?a:new ei]}Object.assign(Pa.prototype,{set:function(t,e,n,r,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(o-r,c-s,p-h,y-m).normalize(),e[1].setComponents(o+r,c+s,p+h,y+m).normalize(),e[2].setComponents(o+i,c+l,p+d,y+g).normalize(),e[3].setComponents(o-i,c-l,p-d,y-g).normalize(),e[4].setComponents(o-a,c-u,p-f,y-v).normalize(),e[5].setComponents(o+a,c+u,p+f,y+v).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ta.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ta)},intersectsSprite:function(t){return Ta.center.set(0,0,0),Ta.radius=.7071067811865476,Ta.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ta)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(ka.x=r.normal.x>0?t.max.x:t.min.x,ka.y=r.normal.y>0?t.max.y:t.min.y,ka.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(ka)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Aa={common:{diffuse:{value:new gi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Un},uv2Transform:{value:new Un},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Hn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new gi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new gi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}},sprite:{diffuse:{value:new gi(15658734)},opacity:{value:1},center:{value:new Hn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}}};function Oa(){var t=null,e=!1,n=null;function r(i,a){!1!==e&&(n(i,a),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Na(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var a=r.get(e);void 0===a?r.set(e,function(e,n){var r=e.array,i=e.usage,a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,r,i),e.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):a.version<e.version&&(!function(e,r,i){var a=r.array,o=r.updateRange;t.bindBuffer(i,e),-1===o.count?t.bufferSubData(i,0,a):(n?t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,e,i),a.version=e.version)}}}function Ra(t,e,n,r){ma.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new La(t,e,n,r)),this.mergeVertices()}function La(t,e,n,r){Gi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,a,o=(t=t||1)/2,s=(e=e||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,c=l+1,h=u+1,d=t/l,f=e/u,p=[],m=[],g=[],v=[];for(a=0;a<h;a++){var y=a*f-s;for(i=0;i<c;i++){var b=i*d-o;m.push(b,-y,0),g.push(0,0,1),v.push(i/l),v.push(1-a/u)}}for(a=0;a<u;a++)for(i=0;i<l;i++){var x=i+c*a,_=i+c*(a+1),w=i+1+c*(a+1),S=i+1+c*a;p.push(x,_,S),p.push(_,w,S)}this.setIndex(p),this.setAttribute("position",new Ri(m,3)),this.setAttribute("normal",new Ri(g,3)),this.setAttribute("uv",new Ri(v,2))}Ra.prototype=Object.create(ma.prototype),Ra.prototype.constructor=Ra,La.prototype=Object.create(Gi.prototype),La.prototype.constructor=La;var Ia={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Da={basic:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.fog]),vertexShader:Ia.meshbasic_vert,fragmentShader:Ia.meshbasic_frag},lambert:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.fog,Aa.lights,{emissive:{value:new gi(0)}}]),vertexShader:Ia.meshlambert_vert,fragmentShader:Ia.meshlambert_frag},phong:{uniforms:ba([Aa.common,Aa.specularmap,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,Aa.lights,{emissive:{value:new gi(0)},specular:{value:new gi(1118481)},shininess:{value:30}}]),vertexShader:Ia.meshphong_vert,fragmentShader:Ia.meshphong_frag},standard:{uniforms:ba([Aa.common,Aa.envmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.roughnessmap,Aa.metalnessmap,Aa.fog,Aa.lights,{emissive:{value:new gi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ia.meshphysical_vert,fragmentShader:Ia.meshphysical_frag},toon:{uniforms:ba([Aa.common,Aa.specularmap,Aa.aomap,Aa.lightmap,Aa.emissivemap,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.gradientmap,Aa.fog,Aa.lights,{emissive:{value:new gi(0)},specular:{value:new gi(1118481)},shininess:{value:30}}]),vertexShader:Ia.meshtoon_vert,fragmentShader:Ia.meshtoon_frag},matcap:{uniforms:ba([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,Aa.fog,{matcap:{value:null}}]),vertexShader:Ia.meshmatcap_vert,fragmentShader:Ia.meshmatcap_frag},points:{uniforms:ba([Aa.points,Aa.fog]),vertexShader:Ia.points_vert,fragmentShader:Ia.points_frag},dashed:{uniforms:ba([Aa.common,Aa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ia.linedashed_vert,fragmentShader:Ia.linedashed_frag},depth:{uniforms:ba([Aa.common,Aa.displacementmap]),vertexShader:Ia.depth_vert,fragmentShader:Ia.depth_frag},normal:{uniforms:ba([Aa.common,Aa.bumpmap,Aa.normalmap,Aa.displacementmap,{opacity:{value:1}}]),vertexShader:Ia.normal_vert,fragmentShader:Ia.normal_frag},sprite:{uniforms:ba([Aa.sprite,Aa.fog]),vertexShader:Ia.sprite_vert,fragmentShader:Ia.sprite_frag},background:{uniforms:{uvTransform:{value:new Un},t2D:{value:null}},vertexShader:Ia.background_vert,fragmentShader:Ia.background_frag},cube:{uniforms:ba([Aa.envmap,{opacity:{value:1}}]),vertexShader:Ia.cube_vert,fragmentShader:Ia.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ia.equirect_vert,fragmentShader:Ia.equirect_frag},distanceRGBA:{uniforms:ba([Aa.common,Aa.displacementmap,{referencePosition:{value:new Kn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ia.distanceRGBA_vert,fragmentShader:Ia.distanceRGBA_frag},shadow:{uniforms:ba([Aa.lights,Aa.fog,{color:{value:new gi(0)},opacity:{value:1}}]),vertexShader:Ia.shadow_vert,fragmentShader:Ia.shadow_frag}};function za(t,e,n,r){var i,a,o=new gi(0),s=0,l=null,u=0,c=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return o},setClearColor:function(t,e){o.set(t),h(o,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){h(o,s=t)},render:function(e,r,d,f){var p=r.background,m=t.xr,y=m.getSession&&m.getSession();if(y&&"additive"===y.environmentBlendMode&&(p=null),null===p?h(o,s):p&&p.isColor&&(h(p,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===dt)){void 0===a&&((a=new la(new va(1,1,1),new _a({type:"BackgroundCubeMaterial",uniforms:ya(Da.cube.uniforms),vertexShader:Da.cube.vertexShader,fragmentShader:Da.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));var b=p.isWebGLCubeRenderTarget?p.texture:p;a.material.uniforms.envMap.value=b,a.material.uniforms.flipEnvMap.value=b.isCubeTexture?-1:1,l===p&&u===b.version&&c===t.toneMapping||(a.material.needsUpdate=!0,l=p,u=b.version,c=t.toneMapping),e.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new la(new La(2,2),new _a({type:"BackgroundMaterial",uniforms:ya(Da.background.uniforms),vertexShader:Da.background.vertexShader,fragmentShader:Da.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&u===p.version&&c===t.toneMapping||(i.material.needsUpdate=!0,l=p,u=p.version,c=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function Fa(t,e,n,r){var i,a=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,o,s,l){if(0!==l){var u,c;if(a)u=t,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](i,o,s,l),n.update(s,i,l)}}}function Ba(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),c=t.getParameter(35660),h=t.getParameter(3379),d=t.getParameter(34076),f=t.getParameter(34921),p=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=c>0,y=a||!!e.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?t.getParameter(36183):0}}function Va(){var t=this,e=null,n=0,r=!1,i=!1,a=new ei,o=new Un,s={value:null,needsUpdate:!1};function l(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,n,r,i){var l=null!==e?e.length:0,u=null;if(0!==l){if(u=s.value,!0!==i||null===u){var c=r+4*l,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,f=r;d!==l;++d,f+=4)a.copy(e[d]).applyMatrix4(h,o),a.normal.toArray(u,f),u[f+3]=a.constant}s.value=u,s.needsUpdate=!0}return t.numPlanes=l,t.numIntersection=0,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,a){var o=0!==t.length||i||0!==n||r;return r=i,e=u(t,a,0),n=t.length,o},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,l()},this.setState=function(t,a,o,c,h,d){if(!r||null===t||0===t.length||i&&!o)i?u(null):l();else{var f=i?0:n,p=4*f,m=h.clippingState||null;s.value=m,m=u(t,c,p,d);for(var g=0;g!==p;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=f}}}function ja(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function Ha(t,e,n){var r=new WeakMap,i=new WeakMap;function a(t){var o=t.target,s=r.get(o);for(var l in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[l]);o.removeEventListener("dispose",a),r.delete(o);var u=i.get(s);u&&(e.remove(u),i.delete(s)),n.memory.geometries--}function o(t){var n=[],r=t.index,a=t.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{s=a.array;o=a.version;for(l=0,u=s.length/3-1;l<u;l+=3){c=l+0,h=l+1,d=l+2;n.push(c,h,h,d,d,c)}}var f=new(Di(n)>65535?Ni:Ai)(n,1);f.version=o,e.update(f,34963);var p=i.get(t);p&&e.remove(p),i.set(t,f)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",a),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Gi).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var a=t.morphAttributes;for(var i in a)for(var o=a[i],s=0,l=o.length;s<l;s++)e.update(o[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return i.get(t)}}}function Ua(t,e,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,a,e*o),n.update(r,i)},this.renderInstances=function(r,l,u,c){if(0!==c){var h,d;if(s)h=t,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[d](i,u,a,l*o,c),n.update(u,i,c)}}}function Ga(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function qa(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Wa(t){var e={},n=new Float32Array(8);return{update:function(r,i,a,o){var s=r.morphTargetInfluences,l=void 0===s?0:s.length,u=e[i.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];e[i.id]=u}var h=a.morphTargets&&i.morphAttributes.position,d=a.morphNormals&&i.morphAttributes.normal;for(c=0;c<l;c++){0!==(p=u[c])[1]&&(h&&i.deleteAttribute("morphTarget"+c),d&&i.deleteAttribute("morphNormal"+c))}for(c=0;c<l;c++){(p=u[c])[0]=c,p[1]=s[c]}u.sort(qa);var f=0;for(c=0;c<8;c++){var p;if(p=u[c]){var m=p[0],g=p[1];if(g){h&&i.setAttribute("morphTarget"+c,h[m]),d&&i.setAttribute("morphNormal"+c,d[m]),n[c]=g,f+=g;continue}}n[c]=0}var v=i.morphTargetsRelative?1:1-f;o.getUniforms().setValue(t,"morphTargetBaseInfluence",v),o.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function $a(t,e,n,r){var i=new WeakMap;return{update:function(t){var a=r.render.frame,o=t.geometry,s=e.get(t,o);return i.get(s)!==a&&(o.isGeometry&&s.updateFromObject(t),e.update(s),i.set(s,a)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function Ya(t,e,n,r,i,a,o,s,l,u){t=void 0!==t?t:[],e=void 0!==e?e:st,o=void 0!==o?o:Vt,Wn.call(this,t,e,n,r,i,a,o,s,l,u),this.flipY=!1}function Qa(t,e,n,r){Wn.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=vt,this.minFilter=vt,this.wrapR=mt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Xa(t,e,n,r){Wn.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=vt,this.minFilter=vt,this.wrapR=mt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Da.physical={uniforms:ba([Da.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Hn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new gi(0)},transparency:{value:0}}]),vertexShader:Ia.meshphysical_vert,fragmentShader:Ia.meshphysical_frag},Ya.prototype=Object.create(Wn.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isCubeTexture=!0,Object.defineProperty(Ya.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Qa.prototype=Object.create(Wn.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isDataTexture2DArray=!0,Xa.prototype=Object.create(Wn.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isDataTexture3D=!0;var Za=new Wn,Ja=new Qa,Ka=new Xa,to=new Ya,eo=[],no=[],ro=new Float32Array(16),io=new Float32Array(9),ao=new Float32Array(4);function oo(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,a=eo[i];if(void 0===a&&(a=new Float32Array(i),eo[i]=a),0!==e){r.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=n,t[o].toArray(a,s)}return a}function so(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function lo(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function uo(t,e){var n=no[e];void 0===n&&(n=new Int32Array(e),no[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function co(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function ho(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(so(n,e))return;t.uniform2fv(this.addr,e),lo(n,e)}}function fo(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(so(n,e))return;t.uniform3fv(this.addr,e),lo(n,e)}}function po(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(so(n,e))return;t.uniform4fv(this.addr,e),lo(n,e)}}function mo(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(so(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),lo(n,e)}else{if(so(n,r))return;ao.set(r),t.uniformMatrix2fv(this.addr,!1,ao),lo(n,r)}}function go(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(so(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),lo(n,e)}else{if(so(n,r))return;io.set(r),t.uniformMatrix3fv(this.addr,!1,io),lo(n,r)}}function vo(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(so(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),lo(n,e)}else{if(so(n,r))return;ro.set(r),t.uniformMatrix4fv(this.addr,!1,ro),lo(n,r)}}function yo(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Za,i)}function bo(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Ja,i)}function xo(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Ka,i)}function _o(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||to,i)}function wo(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function So(t,e){var n=this.cache;so(n,e)||(t.uniform2iv(this.addr,e),lo(n,e))}function Eo(t,e){var n=this.cache;so(n,e)||(t.uniform3iv(this.addr,e),lo(n,e))}function Mo(t,e){var n=this.cache;so(n,e)||(t.uniform4iv(this.addr,e),lo(n,e))}function Co(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function To(t,e){t.uniform1fv(this.addr,e)}function ko(t,e){t.uniform1iv(this.addr,e)}function Po(t,e){t.uniform2iv(this.addr,e)}function Ao(t,e){t.uniform3iv(this.addr,e)}function Oo(t,e){t.uniform4iv(this.addr,e)}function No(t,e){var n=oo(e,this.size,2);t.uniform2fv(this.addr,n)}function Ro(t,e){var n=oo(e,this.size,3);t.uniform3fv(this.addr,n)}function Lo(t,e){var n=oo(e,this.size,4);t.uniform4fv(this.addr,n)}function Io(t,e){var n=oo(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Do(t,e){var n=oo(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function zo(t,e){var n=oo(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Fo(t,e,n){var r=e.length,i=uo(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(e[a]||Za,i[a])}function Bo(t,e,n){var r=e.length,i=uo(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(e[a]||to,i[a])}function Vo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return co;case 35664:return ho;case 35665:return fo;case 35666:return po;case 35674:return mo;case 35675:return go;case 35676:return vo;case 5124:case 35670:return wo;case 35667:case 35671:return So;case 35668:case 35672:return Eo;case 35669:case 35673:return Mo;case 5125:return Co;case 35678:case 36198:case 36298:case 36306:case 35682:return yo;case 35679:case 36299:case 36307:return xo;case 35680:case 36300:case 36308:case 36293:return _o;case 36289:case 36303:case 36311:case 36292:return bo}}(e.type)}function jo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return To;case 35664:return No;case 35665:return Ro;case 35666:return Lo;case 35674:return Io;case 35675:return Do;case 35676:return zo;case 5124:case 35670:return ko;case 35667:case 35671:return Po;case 35668:case 35672:return Ao;case 35669:case 35673:return Oo;case 35678:case 36198:case 36298:case 36306:case 35682:return Fo;case 35680:case 36300:case 36308:case 36293:return Bo}}(e.type)}function Ho(t){this.id=t,this.seq=[],this.map={}}jo.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),lo(e,t)},Ho.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(t,e[o.id],n)}};var Uo=/([\w\d_]+)(\])?(\[|\.)?/g;function Go(t,e){t.seq.push(e),t.map[e.id]=e}function qo(t,e,n){var r=t.name,i=r.length;for(Uo.lastIndex=0;;){var a=Uo.exec(r),o=Uo.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){Go(n,void 0===u?new Vo(s,t,e):new jo(s,t,e));break}var c=n.map[s];void 0===c&&Go(n,c=new Ho(s)),n=c}}function Wo(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);qo(i,t.getUniformLocation(e,i.name),this)}}function $o(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}Wo.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},Wo.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Wo.upload=function(t,e,n,r){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,r)}},Wo.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var a=t[r];a.id in e&&n.push(a)}return n};var Yo=0;function Qo(t){switch(t){case Ke:return["Linear","( value )"];case tn:return["sRGB","( value )"];case nn:return["RGBE","( value )"];case an:return["RGBM","( value, 7.0 )"];case on:return["RGBM","( value, 16.0 )"];case sn:return["RGBD","( value, 256.0 )"];case en:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case rn:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function Xo(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Zo(t,e){var n=Qo(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Jo(t,e){var n;switch(e){case et:n="Linear";break;case nt:n="Reinhard";break;case rt:n="Uncharted2";break;case it:n="OptimizedCineon";break;case at:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ko(t){return""!==t}function ts(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function es(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var ns=/^[ \t]*#include +<([\w\d./]+)>/gm;function rs(t){return t.replace(ns,is)}function is(t,e){var n=Ia[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return rs(n)}var as=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,os=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function ss(t){return t.replace(os,us).replace(as,ls)}function ls(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),us(t,e,n,r)}function us(t,e,n,r){for(var i="",a=parseInt(e);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function cs(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function hs(t,e,n){var r,i,a,o,s,l=t.getContext(),u=n.defines,c=n.vertexShader,h=n.fragmentShader,d=function(t){var e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===f?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===p?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===m&&(e="SHADOWMAP_TYPE_VSM"),e}(n),g=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case st:case lt:e="ENVMAP_TYPE_CUBE";break;case dt:case ft:e="ENVMAP_TYPE_CUBE_UV";break;case ut:case ct:e="ENVMAP_TYPE_EQUIREC";break;case ht:e="ENVMAP_TYPE_SPHERE"}return e}(n),v=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case lt:case ct:e="ENVMAP_MODE_REFRACTION"}return e}(n),y=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Z:e="ENVMAP_BLENDING_MULTIPLY";break;case J:e="ENVMAP_BLENDING_MIX";break;case K:e="ENVMAP_BLENDING_ADD"}return e}(n),b=t.gammaFactor>0?t.gammaFactor:1,x=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ko).join("\n")}(n),_=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(u),w=l.createProgram();if(n.isRawShaderMaterial?((r=[_].filter(Ko).join("\n")).length>0&&(r+="\n"),(i=[x,_].filter(Ko).join("\n")).length>0&&(i+="\n")):(r=[cs(n),"#define SHADER_NAME "+n.shaderName,_,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ko).join("\n"),i=[x,cs(n),"#define SHADER_NAME "+n.shaderName,_,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+v:"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==tt?"#define TONE_MAPPING":"",n.toneMapping!==tt?Ia.tonemapping_pars_fragment:"",n.toneMapping!==tt?Jo("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Ia.encodings_pars_fragment:"",n.mapEncoding?Zo("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Zo("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Zo("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Zo("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Zo("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(a="linearToOutputTexel",o=n.outputEncoding,s=Qo(o),"vec4 "+a+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ko).join("\n")),c=es(c=ts(c=rs(c),n),n),h=es(h=ts(h=rs(h),n),n),c=ss(c),h=ss(h),n.isWebGL2&&!n.isRawShaderMaterial){var S=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==c.match(E)&&null!==h.match(E)&&(S=!0,c=c.replace(E,""),h=h.replace(E,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",S?"":"out highp vec4 pc_fragColor;",S?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i}var M,C,T=i+h,k=$o(l,35633,r+c),P=$o(l,35632,T);if(l.attachShader(w,k),l.attachShader(w,P),void 0!==n.index0AttributeName?l.bindAttribLocation(w,0,n.index0AttributeName):!0===n.morphTargets&&l.bindAttribLocation(w,0,"position"),l.linkProgram(w),t.debug.checkShaderErrors){var A=l.getProgramInfoLog(w).trim(),O=l.getShaderInfoLog(k).trim(),N=l.getShaderInfoLog(P).trim(),R=!0,L=!0;if(!1===l.getProgramParameter(w,35714)){R=!1;var I=Xo(l,k,"vertex"),D=Xo(l,P,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(w,35715),"gl.getProgramInfoLog",A,I,D)}else""!==A?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",A):""!==O&&""!==N||(L=!1);L&&(this.diagnostics={runnable:R,programLog:A,vertexShader:{log:O,prefix:r},fragmentShader:{log:N,prefix:i}})}return l.deleteShader(k),l.deleteShader(P),this.getUniforms=function(){return void 0===M&&(M=new Wo(l,w)),M},this.getAttributes=function(){return void 0===C&&(C=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var a=t.getActiveAttrib(e,i).name;n[a]=t.getAttribLocation(e,a)}return n}(l,w)),C},this.destroy=function(){l.deleteProgram(w),this.program=void 0},this.name=n.shaderName,this.id=Yo++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=k,this.fragmentShader=P,this}function ds(t,e,n){var r=[],i=n.isWebGL2,a=n.logarithmicDepthBuffer,o=n.floatVertexTextures,s=n.precision,l=n.maxVertexUniforms,u=n.vertexTextures,c={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function d(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=Ke,e}this.getParameters=function(r,h,f,p,m,g,b){var x=p.fog,_=r.isMeshStandardMaterial?p.environment:null,w=r.envMap||_,S=c[r.type],E=b.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(o)return 1024;var n=l,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(b):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var M=function(t,e){var n;if(e){var r=Da[e];n={name:t.type,uniforms:xa.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,S);r.onBeforeCompile(M,t);var C=t.getRenderTarget();return{isWebGL2:i,shaderID:S,shaderName:M.name,uniforms:M.uniforms,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===b.isInstancedMesh,supportsVertexTextures:u,outputEncoding:null!==C?d(C.texture):t.outputEncoding,map:!!r.map,mapEncoding:d(r.map),matcap:!!r.matcap,matcapEncoding:d(r.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:d(w),envMapCubeUV:!!w&&(w.mapping===dt||w.mapping===ft),lightMap:!!r.lightMap,lightMapEncoding:d(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:d(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===hn,tangentSpaceNormalMap:r.normalMapType===cn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!x,useFog:r.fog,fogExp2:x&&x.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:a,skinning:r.skinning&&E>0,maxBones:E,useVertexTexture:o,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:tt,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===y,flipSided:r.side===v,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<h.length;i++)n.push(e[h[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var i,a=0,o=r.length;a<o;a++){var s=r[a];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new hs(t,n,e),r.push(i)),i},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function fs(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function ps(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ms(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function gs(){var t=[],e=0,n=[],r=[],i={id:-1};function a(n,r,a,o,s,l){var u=t[e];return void 0===u?(u={id:n.id,object:n,geometry:r,material:a,program:a.program||i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:l},t[e]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=a,u.program=a.program||i,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=s,u.group=l),e++,u}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,o,s,l){var u=a(t,e,i,o,s,l);(!0===i.transparent?r:n).push(u)},unshift:function(t,e,i,o,s,l){var u=a(t,e,i,o,s,l);(!0===i.transparent?r:n).unshift(u)},finish:function(){for(var n=e,r=t.length;n<r;n++){var i=t[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){n.length>1&&n.sort(t||ps),r.length>1&&r.sort(e||ms)}}}function vs(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,a=t.get(n);return void 0===a?(i=new gs,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=a.get(r))&&(i=new gs,a.set(r,i)),i},dispose:function(){t=new WeakMap}}}function ys(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Kn,color:new gi};break;case"SpotLight":n={position:new Kn,direction:new Kn,color:new gi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Kn,color:new gi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Kn,skyColor:new gi,groundColor:new gi};break;case"RectAreaLight":n={color:new gi,position:new Kn,halfWidth:new Kn,halfHeight:new Kn}}return t[e.id]=n,n}}}var bs=0;function xs(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function _s(){for(var t,e=new ys,n=(t={},{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Hn};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Hn,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)r.probe.push(new Kn);var a=new Kn,o=new sr,s=new sr;return{setup:function(t,i,l){for(var u=0,c=0,h=0,d=0;d<9;d++)r.probe[d].set(0,0,0);var f=0,p=0,m=0,g=0,v=0,y=0,b=0,x=0,_=l.matrixWorldInverse;t.sort(xs),d=0;for(var w=t.length;d<w;d++){var S=t[d],E=S.color,M=S.intensity,C=S.distance,T=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)u+=E.r*M,c+=E.g*M,h+=E.b*M;else if(S.isLightProbe)for(var k=0;k<9;k++)r.probe[k].addScaledVector(S.sh.coefficients[k],M);else if(S.isDirectionalLight){if((O=e.get(S)).color.copy(S.color).multiplyScalar(S.intensity),O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(_),S.castShadow){var P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,r.directionalShadow[f]=A,r.directionalShadowMap[f]=T,r.directionalShadowMatrix[f]=S.shadow.matrix,y++}r.directional[f]=O,f++}else if(S.isSpotLight){if((O=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),O.color.copy(E).multiplyScalar(M),O.distance=C,O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(_),O.coneCos=Math.cos(S.angle),O.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),O.decay=S.decay,S.castShadow){P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,r.spotShadow[m]=A,r.spotShadowMap[m]=T,r.spotShadowMatrix[m]=S.shadow.matrix,x++}r.spot[m]=O,m++}else if(S.isRectAreaLight){(O=e.get(S)).color.copy(E).multiplyScalar(M),O.position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),s.identity(),o.copy(S.matrixWorld),o.premultiply(_),s.extractRotation(o),O.halfWidth.set(.5*S.width,0,0),O.halfHeight.set(0,.5*S.height,0),O.halfWidth.applyMatrix4(s),O.halfHeight.applyMatrix4(s),r.rectArea[g]=O,g++}else if(S.isPointLight){if((O=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(_),O.color.copy(S.color).multiplyScalar(S.intensity),O.distance=S.distance,O.decay=S.decay,S.castShadow){var A;P=S.shadow;(A=n.get(S)).shadowBias=P.bias,A.shadowRadius=P.radius,A.shadowMapSize=P.mapSize,A.shadowCameraNear=P.camera.near,A.shadowCameraFar=P.camera.far,r.pointShadow[p]=A,r.pointShadowMap[p]=T,r.pointShadowMatrix[p]=S.shadow.matrix,b++}r.point[p]=O,p++}else if(S.isHemisphereLight){var O;(O=e.get(S)).direction.setFromMatrixPosition(S.matrixWorld),O.direction.transformDirection(_),O.direction.normalize(),O.skyColor.copy(S.color).multiplyScalar(M),O.groundColor.copy(S.groundColor).multiplyScalar(M),r.hemi[v]=O,v++}}r.ambient[0]=u,r.ambient[1]=c,r.ambient[2]=h;var N=r.hash;N.directionalLength===f&&N.pointLength===p&&N.spotLength===m&&N.rectAreaLength===g&&N.hemiLength===v&&N.numDirectionalShadows===y&&N.numPointShadows===b&&N.numSpotShadows===x||(r.directional.length=f,r.spot.length=m,r.rectArea.length=g,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=x,r.spotShadowMap.length=x,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=b,r.spotShadowMatrix.length=x,N.directionalLength=f,N.pointLength=p,N.spotLength=m,N.rectAreaLength=g,N.hemiLength=v,N.numDirectionalShadows=y,N.numPointShadows=b,N.numSpotShadows=x,r.version=bs++)},state:r}}function ws(){var t=new _s,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Ss(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new ws,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new ws,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function Es(t){wi.call(this),this.type="MeshDepthMaterial",this.depthPacking=ln,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ms(t){wi.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Kn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Es.prototype=Object.create(wi.prototype),Es.prototype.constructor=Es,Es.prototype.isMeshDepthMaterial=!0,Es.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ms.prototype=Object.create(wi.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isMeshDistanceMaterial=!0,Ms.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Cs(t,e,n){var r=new Pa,i=new Hn,a=new Hn,o=new $n,s=[],l=[],u={},c={0:v,1:g,2:y},h=new _a({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Hn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONAL_PASS=1;var p=new Gi;p.setAttribute("position",new Mi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new la(p,h),x=this;function w(n,r){var i=e.update(b);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,h,b,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,d,b,null)}function S(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new Es({depthPacking:un,morphTargets:t,skinning:e}),s[r]=i),i}function E(t,e,n){var r=t<<0|e<<1|n<<2,i=l[r];return void 0===i&&(i=new Ms({morphTargets:t,skinning:e}),l[r]=i),i}function M(e,n,r,i,a,o,s){var l=null,h=S,d=e.customDepthMaterial;if(!0===i.isPointLight&&(h=E,d=e.customDistanceMaterial),void 0===d){var f=!1;!0===r.morphTargets&&(f=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var p=!1;!0===e.isSkinnedMesh&&(!0===r.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),l=h(f,p,!0===e.isInstancedMesh)}else l=d;if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var g=l.uuid,v=r.uuid,y=u[g];void 0===y&&(y={},u[g]=y);var b=y[v];void 0===b&&(b=l.clone(),y[v]=b),l=b}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=s===m?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:c[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=a,l.farDistance=o),l}function C(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===m)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=e.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var f=c[h],p=u[f.materialIndex];if(p&&p.visible){var g=M(n,l,p,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,g,n,f)}}else if(u.visible){g=M(n,l,u,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,g,n,null)}}for(var v=n.children,y=0,b=v.length;y<b;y++)C(v[y],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f,this.render=function(e,s,l){if(!1!==x.enabled&&(!1!==x.autoUpdate||!1!==x.needsUpdate)&&0!==e.length){var u=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(_),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=e.length;f<p;f++){var g=e[f],v=g.shadow;if(void 0!==v){i.copy(v.mapSize);var y=v.getFrameExtents();if(i.multiply(y),a.copy(v.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(a.x=Math.floor(n/y.x),i.x=a.x*y.x,v.mapSize.x=a.x),i.y>n&&(a.y=Math.floor(n/y.y),i.y=a.y*y.y,v.mapSize.y=a.y)),null===v.map&&!v.isPointLightShadow&&this.type===m){var b={minFilter:wt,magFilter:wt,format:jt};v.map=new Yn(i.x,i.y,b),v.map.texture.name=g.name+".shadowMap",v.mapPass=new Yn(i.x,i.y,b),v.camera.updateProjectionMatrix()}if(null===v.map){b={minFilter:vt,magFilter:vt,format:jt};v.map=new Yn(i.x,i.y,b),v.map.texture.name=g.name+".shadowMap",v.camera.updateProjectionMatrix()}t.setRenderTarget(v.map),t.clear();for(var S=v.getViewportCount(),E=0;E<S;E++){var M=v.getViewport(E);o.set(a.x*M.x,a.y*M.y,a.x*M.z,a.y*M.w),d.viewport(o),v.updateMatrices(g,E),r=v.getFrustum(),C(s,l,v.camera,g,this.type)}v.isPointLightShadow||this.type!==m||w(v,l)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}x.needsUpdate=!1,t.setRenderTarget(u,c,h)}}}function Ts(t,e,n){var r=n.isWebGL2;var i=new function(){var e=!1,n=new $n,r=null,i=new $n(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,a,o,s){!0===s&&(e*=o,r*=o,a*=o),n.set(e,r,a,o),!1===i.equals(n)&&(t.clearColor(e,r,a,o),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?bt(2929):xt(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case U:t.depthFunc(512);break;case G:t.depthFunc(519);break;case q:t.depthFunc(513);break;case W:t.depthFunc(515);break;case $:t.depthFunc(514);break;case Y:t.depthFunc(518);break;case Q:t.depthFunc(516);break;case X:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},u=new function(){var e=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?bt(2960):xt(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&a===o||(t.stencilFunc(e,n,o),r=e,i=n,a=o)},setOp:function(e,n,r){o===e&&s===n&&l===r||(t.stencilOp(e,n,r),o=e,s=n,l=r)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null}}},c=t.getParameter(34921),h=new Uint8Array(c),d=new Uint8Array(c),f=new Uint8Array(c),p={},m=null,g=null,b=null,x=null,Z=null,J=null,K=null,tt=null,et=null,nt=!1,rt=null,it=null,at=null,ot=null,st=null,lt=t.getParameter(35661),ut=!1,ct=0,ht=t.getParameter(7938);-1!==ht.indexOf("WebGL")?(ct=parseFloat(/^WebGL\ ([0-9])/.exec(ht)[1]),ut=ct>=1):-1!==ht.indexOf("OpenGL ES")&&(ct=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ht)[1]),ut=ct>=2);var dt=null,ft={},pt=new $n,mt=new $n;function gt(e,n,r){var i=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var o=0;o<r;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var vt={};function yt(n,i){(h[n]=1,0===d[n]&&(t.enableVertexAttribArray(n),d[n]=1),f[n]!==i)&&((r?t:e.get("ANGLE_instanced_arrays"))[r?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),f[n]=i)}function bt(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function xt(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}vt[3553]=gt(3553,3553,1),vt[34067]=gt(34067,34069,6),i.setClear(0,0,0,1),a.setClear(1),u.setClear(0),bt(2929),a.setFunc(W),Mt(!1),Ct(s),bt(2884),Et(_);var _t={[T]:32774,[k]:32778,[P]:32779};if(r)_t[A]=32775,_t[O]=32776;else{var wt=e.get("EXT_blend_minmax");null!==wt&&(_t[A]=wt.MIN_EXT,_t[O]=wt.MAX_EXT)}var St={[N]:0,[R]:1,[L]:768,[D]:770,[H]:776,[V]:774,[F]:772,[I]:769,[z]:771,[j]:775,[B]:773};function Et(e,n,r,i,a,o,s,l){if(e!==_){if(g||(bt(3042),g=!0),e===C)a=a||n,o=o||r,s=s||i,n===x&&a===K||(t.blendEquationSeparate(_t[n],_t[a]),x=n,K=a),r===Z&&i===J&&o===tt&&s===et||(t.blendFuncSeparate(St[r],St[i],St[o],St[s]),Z=r,J=i,tt=o,et=s),b=e,nt=null;else if(e!==b||l!==nt){if(x===T&&K===T||(t.blendEquation(32774),x=T,K=T),l)switch(e){case w:t.blendFuncSeparate(1,771,1,771);break;case S:t.blendFunc(1,1);break;case E:t.blendFuncSeparate(0,0,769,771);break;case M:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case w:t.blendFuncSeparate(770,771,1,771);break;case S:t.blendFunc(770,1);break;case E:t.blendFunc(0,769);break;case M:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}Z=null,J=null,tt=null,et=null,b=e,nt=l}}else g&&(xt(3042),g=!1)}function Mt(e){rt!==e&&(e?t.frontFace(2304):t.frontFace(2305),rt=e)}function Ct(e){e!==o?(bt(2884),e!==it&&(e===s?t.cullFace(1029):e===l?t.cullFace(1028):t.cullFace(1032))):xt(2884),it=e}function Tt(e,n,r){e?(bt(32823),ot===n&&st===r||(t.polygonOffset(n,r),ot=n,st=r)):xt(32823)}function kt(e){void 0===e&&(e=33984+lt-1),dt!==e&&(t.activeTexture(e),dt=e)}return{buffers:{color:i,depth:a,stencil:u},initAttributes:function(){for(var t=0,e=h.length;t<e;t++)h[t]=0},enableAttribute:function(t){yt(t,0)},enableAttributeAndDivisor:yt,disableUnusedAttributes:function(){for(var e=0,n=d.length;e!==n;++e)d[e]!==h[e]&&(t.disableVertexAttribArray(e),d[e]=0)},vertexAttribPointer:function(e,n,i,a,o,s){!0!==r||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,a,o,s):t.vertexAttribIPointer(e,n,i,a,o,s)},enable:bt,disable:xt,useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:Et,setMaterial:function(t,e){t.side===y?xt(2884):bt(2884);var n=t.side===v;e&&(n=!n),Mt(n),t.blending===w&&!1===t.transparent?Et(_):Et(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),i.setMask(t.colorWrite);var r=t.stencilWrite;u.setTest(r),r&&(u.setMask(t.stencilWriteMask),u.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),u.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Tt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:Mt,setCullFace:Ct,setLineWidth:function(e){e!==at&&(ut&&t.lineWidth(e),at=e)},setPolygonOffset:Tt,setScissorTest:function(t){t?bt(3089):xt(3089)},activeTexture:kt,bindTexture:function(e,n){null===dt&&kt();var r=ft[dt];void 0===r&&(r={type:void 0,texture:void 0},ft[dt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||vt[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=ft[dt];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===pt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),pt.copy(e))},viewport:function(e){!1===mt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),mt.copy(e))},reset:function(){for(var e=0;e<d.length;e++)1===d[e]&&(t.disableVertexAttribArray(e),d[e]=0);p={},dt=null,ft={},m=null,b=null,rt=null,it=null,i.reset(),a.reset(),u.reset()}}}function ks(t,e,n,r,i,a,o){var s,l=i.isWebGL2,u=i.maxTextures,c=i.maxCubemapSize,h=i.maxTextureSize,d=i.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function m(t,e){return p?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?jn.floorPowerOfTwo:Math.floor,o=a(i*t.width),l=a(i*t.height);void 0===s&&(s=m(o,l));var u=n?m(o,l):s;return u.width=o,u.height=l,u.getContext("2d").drawImage(t,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+l+")."),u}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function v(t){return jn.isPowerOfTwo(t.width)&&jn.isPowerOfTwo(t.height)}function y(t,e){return t.generateMipmaps&&e&&t.minFilter!==vt&&t.minFilter!==wt}function b(e,n,i,a){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function x(n,r,i){if(!1===l)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||e.get("EXT_color_buffer_float"),a}function _(t){return t===vt||t===yt||t===xt?9728:9729}function w(e){var n=e.target;n.removeEventListener("dispose",w),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&f.delete(n),o.memory.textures--}function S(e){var n=e.target;n.removeEventListener("dispose",S),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)t.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[a]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(e.texture),r.remove(e)}(n),o.memory.textures--}var E=0;function M(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=o.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void N(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function C(e,i){if(6===e.image.length){var o=r.get(e);if(e.version>0&&o.__version!==e.version){O(o,e),n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),u=e.image[0]&&e.image[0].isDataTexture,h=[],d=0;d<6;d++)h[d]=s||u?u?e.image[d].image:e.image[d]:g(e.image[d],!1,!0,c);var f,p=h[0],m=v(p)||l,_=a.convert(e.format),w=a.convert(e.type),S=x(e.internalFormat,_,w);if(A(34067,e,m),s){for(d=0;d<6;d++){f=h[d].mipmaps;for(var E=0;E<f.length;E++){var M=f[E];e.format!==jt&&e.format!==Vt?null!==_?n.compressedTexImage2D(34069+d,E,S,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+d,E,S,M.width,M.height,0,_,w,M.data)}}o.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(d=0;d<6;d++)if(u){n.texImage2D(34069+d,0,S,h[d].width,h[d].height,0,_,w,h[d].data);for(E=0;E<f.length;E++){var C=(M=f[E]).image[d].image;n.texImage2D(34069+d,E+1,S,C.width,C.height,0,_,w,C.data)}}else{n.texImage2D(34069+d,0,S,_,w,h[d]);for(E=0;E<f.length;E++){M=f[E];n.texImage2D(34069+d,E+1,S,_,w,M.image[d])}}o.__maxMipLevel=f.length}y(e,m)&&b(34067,e,p.width,p.height),o.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}}function T(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}var k={[pt]:10497,[mt]:33071,[gt]:33648},P={[vt]:9728,[yt]:9984,[xt]:9986,[wt]:9729,[St]:9985,[Mt]:9987};function A(n,a,o){o?(t.texParameteri(n,10242,k[a.wrapS]),t.texParameteri(n,10243,k[a.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,k[a.wrapR]),t.texParameteri(n,10240,P[a.magFilter]),t.texParameteri(n,10241,P[a.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),a.wrapS===mt&&a.wrapT===mt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,_(a.magFilter)),t.texParameteri(n,10241,_(a.minFilter)),a.minFilter!==vt&&a.minFilter!==wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=e.get("EXT_texture_filter_anisotropic");if(s){if(a.type===Rt&&null===e.get("OES_texture_float_linear"))return;if(a.type===Lt&&null===(l||e.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),o.memory.textures++)}function N(e,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),O(e,r),n.activeTexture(33984+i),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var s=function(t){return!l&&(t.wrapS!==mt||t.wrapT!==mt||t.minFilter!==vt&&t.minFilter!==wt)}(r)&&!1===v(r.image),u=g(r.image,s,!1,h),c=v(u)||l,d=a.convert(r.format),f=a.convert(r.type),p=x(r.internalFormat,d,f);A(o,r,c);var m,_=r.mipmaps;if(r.isDepthTexture)p=6402,l?p=r.type===Rt?36012:r.type===Nt?33190:r.type===Ft?35056:33189:r.type===Rt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===qt&&6402===p&&r.type!==At&&r.type!==Nt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=At,f=a.convert(r.type)),r.format===Wt&&6402===p&&(p=34041,r.type!==Ft&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ft,f=a.convert(r.type))),n.texImage2D(3553,0,p,u.width,u.height,0,d,f,null);else if(r.isDataTexture)if(_.length>0&&c){for(var w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,m.width,m.height,0,d,f,m.data);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,u.width,u.height,0,d,f,u.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(w=0,S=_.length;w<S;w++)m=_[w],r.format!==jt&&r.format!==Vt?null!==d?n.compressedTexImage2D(3553,w,p,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,p,m.width,m.height,0,d,f,m.data);e.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,u.width,u.height,u.depth,0,d,f,u.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,u.width,u.height,u.depth,0,d,f,u.data),e.__maxMipLevel=0;else if(_.length>0&&c){for(w=0,S=_.length;w<S;w++)m=_[w],n.texImage2D(3553,w,p,d,f,m);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,p,d,f,u),e.__maxMipLevel=0;y(r,c)&&b(o,r,u.width,u.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function R(e,i,o,s){var l=a.convert(i.texture.format),u=a.convert(i.texture.type),c=x(i.texture.internalFormat,l,u);n.texImage2D(s,0,c,i.width,i.height,0,l,u,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function L(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Rt?i=36012:o.type===Nt&&(i=33190));var s=D(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){s=D(n);t.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var l=a.convert(n.texture.format),u=a.convert(n.texture.type);i=x(n.texture.internalFormat,l,u);if(r){s=D(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height)}t.bindRenderbuffer(36161,null)}function I(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),M(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===qt)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Wt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=t.createRenderbuffer(),L(n.__webglDepthbuffer[a],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),L(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function D(t){return l&&t.isWebGLMultisampleRenderTarget?Math.min(d,t.samples):0}var z=!1,F=!1;this.allocateTextureUnit=function(){var t=E;return t>=u&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+u),E+=1,t},this.resetTextureUnits=function(){E=0},this.setTexture2D=M,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?N(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?N(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=C,this.setTextureCubeDynamic=T,this.setupRenderTarget=function(e){var i=r.get(e),s=r.get(e.texture);e.addEventListener("dispose",S),s.__webglTexture=t.createTexture(),o.memory.textures++;var u=!0===e.isWebGLCubeRenderTarget,c=!0===e.isWebGLMultisampleRenderTarget,h=v(e)||l;if(!l||e.texture.format!==Vt||e.texture.type!==Rt&&e.texture.type!==Lt||(e.texture.format=jt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){i.__webglFramebuffer=[];for(var d=0;d<6;d++)i.__webglFramebuffer[d]=t.createFramebuffer()}else if(i.__webglFramebuffer=t.createFramebuffer(),c)if(l){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var f=a.convert(e.texture.format),p=a.convert(e.texture.type),m=x(e.texture.internalFormat,f,p),g=D(e);t.renderbufferStorageMultisample(36161,g,m,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),L(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,s.__webglTexture),A(34067,e.texture,h);for(d=0;d<6;d++)R(i.__webglFramebuffer[d],e,36064,34069+d);y(e.texture,h)&&b(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),A(3553,e.texture,h),R(i.__webglFramebuffer,e,36064,3553),y(e.texture,h)&&b(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&I(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(y(e,v(t)||l)){var i=t.isWebGLCubeRenderTarget?34067:3553,a=r.get(e).__webglTexture;n.bindTexture(i,a),b(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(l){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,a=e.height,o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024),t.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),M(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?C(t,e):T(t,e)}}function Ps(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===Tt)return 5121;if(t===It)return 32819;if(t===Dt)return 32820;if(t===zt)return 33635;if(t===kt)return 5120;if(t===Pt)return 5122;if(t===At)return 5123;if(t===Ot)return 5124;if(t===Nt)return 5125;if(t===Rt)return 5126;if(t===Lt)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(t===Bt)return 6406;if(t===Vt)return 6407;if(t===jt)return 6408;if(t===Ht)return 6409;if(t===Ut)return 6410;if(t===qt)return 6402;if(t===Wt)return 34041;if(t===$t)return 6403;if(t===Yt)return 36244;if(t===Qt)return 33319;if(t===Xt)return 33320;if(t===Zt)return 36248;if(t===Jt)return 36249;if(t===Kt||t===te||t===ee||t===ne){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===Kt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===te)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===ee)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===ne)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===re||t===ie||t===ae||t===oe){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===re)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===ie)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ae)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===oe)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===se)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===le||t===ue)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(t===le)return n.COMPRESSED_RGB8_ETC2;if(t===ue)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===ce||t===he||t===de||t===fe||t===pe||t===me||t===ge||t===ve||t===ye||t===be||t===xe||t===_e||t===we||t===Se||t===Me||t===Ce||t===Te||t===ke||t===Pe||t===Ae||t===Oe||t===Ne||t===Re||t===Le||t===Ie||t===De||t===ze||t===Fe?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:t===Ee?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:t===Ft?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function As(t){Sa.call(this),this.cameras=t||[]}function Os(){Mr.call(this),this.type="Group"}function Ns(){this._targetRay=null,this._grip=null}function Rs(t,e){var n=this,r=null,i=1,a=null,o="local-floor",s=null,l=[],u=new Map,c=new Sa;c.layers.enable(1),c.viewport=new $n;var h=new Sa;h.layers.enable(2),h.viewport=new $n;var d=[c,h],f=new As;f.layers.enable(1),f.layers.enable(2);var p=null,m=null;function g(t){var e=u.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function v(){u.forEach((function(t,e){t.disconnect(e)})),u.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(t){a=t,E.setContext(r),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function b(t){for(var e=r.inputSources,n=0;n<l.length;n++)u.set(e[n],l[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(a=u.get(i))&&(a.dispatchEvent({type:"disconnected",data:i}),u.delete(i))}for(n=0;n<t.added.length;n++){var a;i=t.added[n];(a=u.get(i))&&a.dispatchEvent({type:"connected",data:i})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=l[t];return void 0===e&&(e=new Ns,l[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=l[t];return void 0===e&&(e=new Ns,l[t]=e),e.getGripSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",g),r.addEventListener("selectstart",g),r.addEventListener("selectend",g),r.addEventListener("squeeze",g),r.addEventListener("squeezestart",g),r.addEventListener("squeezeend",g),r.addEventListener("end",v);var n=e.getContextAttributes(),a={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,e,a);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(o).then(y),r.addEventListener("inputsourceschange",b)}};var x=new Kn,_=new Kn;function w(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=h.near=c.near=t.near,f.far=h.far=c.far=t.far,p===f.near&&m===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,m=f.far);var e=t.parent,n=f.cameras;w(f,e);for(var i=0;i<n.length;i++)w(n[i],e);t.matrixWorld.copy(f.matrixWorld);for(var a=t.children,o=(i=0,a.length);i<o;i++)a[i].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){x.setFromMatrixPosition(e.matrixWorld),_.setFromMatrixPosition(n.matrixWorld);var r=x.distanceTo(_),i=e.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=r/(-c+h),m=p*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=o+p,v=s+p,y=d-m,b=f+(r-m),w=l*s/v*g,S=u*s/v*g;t.projectionMatrix.makePerspective(y,b,w,S,g,v)}(f,c,h):f.projectionMatrix.copy(c.projectionMatrix),f};var S=null;var E=new Oa;E.setAnimationLoop((function(e,n){if(null!==(s=n.getViewerPose(a))){var i=s.views,o=r.renderState.baseLayer;t.setFramebuffer(o.framebuffer);var u=!1;i.length!==f.cameras.length&&(f.cameras.length=0,u=!0);for(var c=0;c<i.length;c++){var h=i[c],p=o.getViewport(h),m=d[c];m.matrix.fromArray(h.transform.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(p.x,p.y,p.width,p.height),0===c&&f.matrix.copy(m.matrix),!0===u&&f.cameras.push(m)}}var g=r.inputSources;for(c=0;c<l.length;c++){var v=l[c],y=g[c];v.update(y,n,a)}S&&S(e,n)})),this.setAnimationLoop=function(t){S=t},this.dispose=function(){}}function Ls(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",c=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,h=null,d=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ke,this.physicallyCorrectLights=!1,this.toneMapping=tt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,p,m,g,y,b,x,_,w,S,E,M,C,T,k,P,A,O,N=this,R=!1,L=null,I=0,D=0,z=null,F=null,B=-1,V={geometry:null,program:null,wireframe:!1},j=null,H=null,U=new $n,G=new $n,q=null,W=e.width,$=e.height,Y=1,Q=null,X=null,Z=new $n(0,0,W,$),J=new $n(0,0,W,$),K=!1,et=new Pa,nt=new Va,rt=!1,it=!1,at=new sr,ot=new Kn;function st(){return null===z?Y:1}try{var lt={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(e.addEventListener("webglcontextlost",dt,!1),e.addEventListener("webglcontextrestored",ft,!1),null===(f=n||e.getContext("webgl",lt)||e.getContext("experimental-webgl",lt)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function ut(){p=new ja(f),!1===(m=new Ba(f,p,t)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),O=new Ps(f,p,m),(g=new Ts(f,p,m)).scissor(G.copy(J).multiplyScalar(Y).floor()),g.viewport(U.copy(Z).multiplyScalar(Y).floor()),y=new Ga(f),b=new fs,x=new ks(f,p,g,b,m,O,y),_=new Na(f,m),w=new Ha(f,_,y),S=new $a(f,w,_,y),k=new Wa(f),E=new ds(N,p,m),M=new vs,C=new Ss,T=new za(N,g,S,s),P=new Fa(f,p,y,m),A=new Ua(f,p,y,m),y.programs=E.programs,N.capabilities=m,N.extensions=p,N.properties=b,N.renderLists=M,N.state=g,N.info=y}ut();var ct=new Rs(N,f);this.xr=ct;var ht=new Cs(N,S,m.maxTextureSize);function dt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function ft(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1,ut()}function pt(t){var e=t.target;e.removeEventListener("dispose",pt),function(t){mt(t),b.remove(t)}(e)}function mt(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&E.releaseProgram(e)}this.shadowMap=ht,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var t=p.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=p.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(t){void 0!==t&&(Y=t,this.setSize(W,$,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Hn),t.set(W,$)},this.setSize=function(t,n,r){ct.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=t,$=n,e.width=Math.floor(t*Y),e.height=Math.floor(n*Y),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Hn),t.set(W*Y,$*Y).floor()},this.setDrawingBufferSize=function(t,n,r){W=t,$=n,Y=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new $n),t.copy(U)},this.getViewport=function(t){return t.copy(Z)},this.setViewport=function(t,e,n,r){t.isVector4?Z.set(t.x,t.y,t.z,t.w):Z.set(t,e,n,r),g.viewport(U.copy(Z).multiplyScalar(Y).floor())},this.getScissor=function(t){return t.copy(J)},this.setScissor=function(t,e,n,r){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,n,r),g.scissor(G.copy(J).multiplyScalar(Y).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(t){g.setScissorTest(K=t)},this.setOpaqueSort=function(t){Q=t},this.setTransparentSort=function(t){X=t},this.getClearColor=function(){return T.getClearColor()},this.setClearColor=function(){T.setClearColor.apply(T,arguments)},this.getClearAlpha=function(){return T.getClearAlpha()},this.setClearAlpha=function(){T.setClearAlpha.apply(T,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",dt,!1),e.removeEventListener("webglcontextrestored",ft,!1),M.dispose(),C.dispose(),b.dispose(),S.dispose(),ct.dispose(),yt.stop()},this.renderBufferImmediate=function(t,e){g.initAttributes();var n=b.get(t);t.hasPositions&&!n.position&&(n.position=f.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),t.hasColors&&!n.color&&(n.color=f.createBuffer());var r=e.getAttributes();t.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,t.positionArray,35048),g.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,t.normalArray,35048),g.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,t.uvArray,35048),g.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,t.colorArray,35048),g.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,t.count),t.count=0};var gt=new Cr;this.renderBufferDirect=function(t,e,n,r,i,a){null===e&&(e=gt);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=St(t,e,r,i);g.setMaterial(r,o);var l=!1;V.geometry===n.id&&V.program===s.id&&V.wireframe===(!0===r.wireframe)||(V.geometry=n.id,V.program=s.id,V.wireframe=!0===r.wireframe,l=!0),(r.morphTargets||r.morphNormals)&&(k.update(i,n,r,s),l=!0),!0===i.isInstancedMesh&&(l=!0);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var h,d=1;!0===r.wireframe&&(u=w.getWireframeAttribute(n),d=2);var v=P;null!==u&&(h=_.get(u),(v=A).setIndex(h)),l&&(!function(t,e,n,r){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;g.initAttributes();var i=e.attributes,a=r.getAttributes(),o=n.defaultAttributeValues;for(var s in a){var l=a[s];if(l>=0){var u=i[s];if(void 0!==u){var c=u.normalized,h=u.itemSize;if(void 0===(S=_.get(u)))continue;var d=S.buffer,v=S.type,y=S.bytesPerElement;if(u.isInterleavedBufferAttribute){var b=u.data,x=b.stride,w=u.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(l,b.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(l),f.bindBuffer(34962,d),g.vertexAttribPointer(l,h,v,c,x*y,w*y)}else u.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=u.meshPerAttribute*u.count)):g.enableAttribute(l),f.bindBuffer(34962,d),g.vertexAttribPointer(l,h,v,c,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=_.get(t.instanceMatrix)))continue;d=S.buffer,v=S.type;g.enableAttributeAndDivisor(l+0,1),g.enableAttributeAndDivisor(l+1,1),g.enableAttributeAndDivisor(l+2,1),g.enableAttributeAndDivisor(l+3,1),f.bindBuffer(34962,d),f.vertexAttribPointer(l+0,4,v,!1,64,0),f.vertexAttribPointer(l+1,4,v,!1,64,16),f.vertexAttribPointer(l+2,4,v,!1,64,32),f.vertexAttribPointer(l+3,4,v,!1,64,48)}else if(void 0!==o){var E=o[s];if(void 0!==E)switch(E.length){case 2:f.vertexAttrib2fv(l,E);break;case 3:f.vertexAttrib3fv(l,E);break;case 4:f.vertexAttrib4fv(l,E);break;default:f.vertexAttrib1fv(l,E)}}}}g.disableUnusedAttributes()}(i,n,r,s),null!==u&&f.bindBuffer(34963,h.buffer));var y=null!==u?u.count:c.count,b=n.drawRange.start*d,x=n.drawRange.count*d,S=null!==a?a.start*d:0,E=null!==a?a.count*d:1/0,M=Math.max(b,S),C=Math.min(y,b+x,S+E)-1,T=Math.max(0,C-M+1);if(0!==T){if(i.isMesh)!0===r.wireframe?(g.setLineWidth(r.wireframeLinewidth*st()),v.setMode(1)):v.setMode(4);else if(i.isLine){var O=r.linewidth;void 0===O&&(O=1),g.setLineWidth(O*st()),i.isLineSegments?v.setMode(1):i.isLineLoop?v.setMode(2):v.setMode(3)}else i.isPoints?v.setMode(0):i.isSprite&&v.setMode(4);i.isInstancedMesh?v.renderInstances(n,M,T,i.count):n.isInstancedBufferGeometry?v.renderInstances(n,M,T,n.maxInstancedCount):v.render(M,T)}},this.compile=function(t,e){(d=C.get(t,e)).init(),t.traverse((function(t){t.isLight&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n==!1&&(wt(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n==!1&&(wt(e.material,t,e),n[e.material.uuid]=!0)}))};var vt=null;var yt=new Oa;function bt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||et.intersectsSprite(t)){r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at);var i=S.update(t);(a=t.material).visible&&h.push(t,i,a,n,ot.z,null)}}else if(t.isImmediateRenderObject)r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at),h.push(t,null,t.material,n,ot.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==y.render.frame&&(t.skeleton.update(),t.skeleton.frame=y.render.frame),!t.frustumCulled||et.intersectsObject(t))){r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(at);i=S.update(t);var a=t.material;if(Array.isArray(a))for(var o=i.groups,s=0,l=o.length;s<l;s++){var u=o[s],c=a[u.materialIndex];c&&c.visible&&h.push(t,i,c,n,ot.z,u)}else a.visible&&h.push(t,i,a,n,ot.z,null)}var f=t.children;for(s=0,l=f.length;s<l;s++)bt(f[s],e,n,r)}}function xt(t,e,n,r){for(var i=0,a=t.length;i<a;i++){var o=t[i],s=o.object,l=o.geometry,u=void 0===r?o.material:r,c=o.group;if(n.isArrayCamera){H=n;for(var h=n.cameras,f=0,p=h.length;f<p;f++){var m=h[f];s.layers.test(m.layers)&&(g.viewport(U.copy(m.viewport)),d.setupLights(m),_t(s,e,m,l,u,c))}}else H=null,_t(s,e,n,l,u,c)}}function _t(t,e,n,r,i,a){if(t.onBeforeRender(N,e,n,r,i,a),d=C.get(e,H||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=St(n,e,i,t);g.setMaterial(i),V.geometry=null,V.program=null,V.wireframe=!1,function(t,e){t.render((function(t){N.renderBufferImmediate(t,e)}))}(t,o)}else N.renderBufferDirect(n,e,r,i,t,a);t.onAfterRender(N,e,n,r,i,a),d=C.get(e,H||n)}function wt(t,e,n){var r=b.get(t),i=d.state.lights,a=d.state.shadowsArray,o=i.state.version,s=E.getParameters(t,i.state,a,e,nt.numPlanes,nt.numIntersection,n),l=E.getProgramCacheKey(s),u=r.program,c=!0;if(void 0===u)t.addEventListener("dispose",pt);else if(u.cacheKey!==l)mt(t);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(u=E.acquireProgram(s,l),r.program=u,r.uniforms=s.uniforms,r.outputEncoding=s.outputEncoding,t.program=u);var h=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var f=0;f<N.maxMorphTargets;f++)h["morphTarget"+f]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(f=0;f<N.maxMorphNormals;f++)h["morphNormal"+f]>=0&&t.numSupportedMorphNormals++}var p=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=nt.numPlanes,r.numIntersection=nt.numIntersection,p.clippingPlanes=nt.uniform),r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=o,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.directionalLightShadows.value=i.state.directionalShadow,p.spotLights.value=i.state.spot,p.spotLightShadows.value=i.state.spotShadow,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.pointLightShadows.value=i.state.pointShadow,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),g=Wo.seqWithValue(m.seq,p);r.uniformsList=g}function St(t,e,n,r){x.resetTextureUnits();var i=e.fog,a=n.isMeshStandardMaterial?e.environment:null,o=null===z?N.outputEncoding:z.texture.encoding,s=b.get(n),l=d.state.lights;if(rt&&(it||t!==j)){var u=t===j&&n.id===B;nt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,s,u)}n.version===s.__version?void 0===s.program||n.fog&&s.fog!==i||s.environment!==a||s.needsLights&&s.lightsStateVersion!==l.state.version?wt(n,e,r):void 0===s.numClippingPlanes||s.numClippingPlanes===nt.numPlanes&&s.numIntersection===nt.numIntersection?s.outputEncoding!==o&&wt(n,e,r):wt(n,e,r):(wt(n,e,r),s.__version=n.version);var c,h,p=!1,y=!1,_=!1,w=s.program,S=w.getUniforms(),E=s.uniforms;if(g.useProgram(w.program)&&(p=!0,y=!0,_=!0),n.id!==B&&(B=n.id,y=!0),p||j!==t){if(S.setValue(f,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&S.setValue(f,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),j!==t&&(j=t,y=!0,_=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var M=S.map.cameraPosition;void 0!==M&&M.setValue(f,ot.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&S.setValue(f,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&S.setValue(f,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){S.setOptional(f,r,"bindMatrix"),S.setOptional(f,r,"bindMatrixInverse");var C=r.skeleton;if(C){var T=C.bones;if(m.floatVertexTextures){if(void 0===C.boneTexture){var k=Math.sqrt(4*T.length);k=jn.ceilPowerOfTwo(k),k=Math.max(k,4);var P=new Float32Array(k*k*4);P.set(C.boneMatrices);var A=new Ca(P,k,k,jt,Rt);C.boneMatrices=P,C.boneTexture=A,C.boneTextureSize=k}S.setValue(f,"boneTexture",C.boneTexture,x),S.setValue(f,"boneTextureSize",C.boneTextureSize)}else S.setOptional(f,C,"boneMatrices")}}return(y||s.receiveShadow!==r.receiveShadow)&&(s.receiveShadow=r.receiveShadow,S.setValue(f,"receiveShadow",r.receiveShadow)),y&&(S.setValue(f,"toneMappingExposure",N.toneMappingExposure),S.setValue(f,"toneMappingWhitePoint",N.toneMappingWhitePoint),s.needsLights&&(h=_,(c=E).ambientLightColor.needsUpdate=h,c.lightProbe.needsUpdate=h,c.directionalLights.needsUpdate=h,c.directionalLightShadows.needsUpdate=h,c.pointLights.needsUpdate=h,c.pointLightShadows.needsUpdate=h,c.spotLights.needsUpdate=h,c.spotLightShadows.needsUpdate=h,c.rectAreaLights.needsUpdate=h,c.hemisphereLights.needsUpdate=h),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(E,i),n.isMeshBasicMaterial?Et(E,n):n.isMeshLambertMaterial?(Et(E,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(E,n)):n.isMeshToonMaterial?(Et(E,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshPhongMaterial?(Et(E,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshStandardMaterial?(Et(E,n,a),n.isMeshPhysicalMaterial?function(t,e,n){Mt(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===v&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(E,n,a):Mt(E,n,a)):n.isMeshMatcapMaterial?(Et(E,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshDepthMaterial?(Et(E,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isMeshDistanceMaterial?(Et(E,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(E,n)):n.isMeshNormalMaterial?(Et(E,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(E,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(E,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(E,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*Y,t.scale.value=.5*$,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(E,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(E,n):n.isShadowMaterial&&(E.color.value.copy(n.color),E.opacity.value=n.opacity),void 0!==E.ltc_1&&(E.ltc_1.value=Aa.LTC_1),void 0!==E.ltc_2&&(E.ltc_2.value=Aa.LTC_2),Wo.upload(f,s.uniformsList,E,x),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Wo.upload(f,s.uniformsList,E,x),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&S.setValue(f,"center",r.center),S.setValue(f,"modelViewMatrix",r.modelViewMatrix),S.setValue(f,"normalMatrix",r.normalMatrix),S.setValue(f,"modelMatrix",r.matrixWorld),w}function Et(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,a=e.envMap||n;a&&(t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=b.get(a).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function Mt(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}yt.setAnimationLoop((function(t){ct.isPresenting||vt&&vt(t)})),"undefined"!=typeof window&&yt.setContext(window),this.setAnimationLoop=function(t){vt=t,ct.setAnimationLoop(t),yt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),e&&e.isCamera){if(!R){V.geometry=null,V.program=null,V.wireframe=!1,B=-1,j=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ct.enabled&&ct.isPresenting&&(e=ct.getCamera(e)),t.onBeforeRender(N,t,e,n||z),(d=C.get(t,e)).init(),at.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),et.setFromProjectionMatrix(at),it=this.localClippingEnabled,rt=nt.init(this.clippingPlanes,it,e),(h=M.get(t,e)).init(),bt(t,e,0,N.sortObjects),h.finish(),!0===N.sortObjects&&h.sort(Q,X),rt&&nt.beginShadows();var i=d.state.shadowsArray;ht.render(i,t,e),d.setupLights(e),rt&&nt.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),T.render(h,t,e,r);var a=h.opaque,o=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&xt(a,t,e,s),o.length&&xt(o,t,e,s)}else a.length&&xt(a,t,e),o.length&&xt(o,t,e);t.onAfterRender(N,t,e),null!==z&&(x.updateRenderTargetMipmap(z),x.updateMultisampleRenderTarget(z)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){L!==t&&null===z&&f.bindFramebuffer(36160,t),L=t},this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return z},this.setRenderTarget=function(t,e,n){z=t,I=e,D=n,t&&void 0===b.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var r=L,i=!1;if(t){var a=b.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=a[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?b.get(t).__webglMultisampledFramebuffer:a,U.copy(t.viewport),G.copy(t.scissor),q=t.scissorTest}else U.copy(Z).multiplyScalar(Y).floor(),G.copy(J).multiplyScalar(Y).floor(),q=K;if(F!==r&&(f.bindFramebuffer(36160,r),F=r),g.viewport(U),g.scissor(G),g.setScissorTest(q),i){var o=b.get(t.texture);f.framebufferTexture2D(36160,36064,34069+(e||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,a,o){if(t&&t.isWebGLRenderTarget){var s=b.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){var l=!1;s!==F&&(f.bindFramebuffer(36160,s),l=!0);try{var u=t.texture,c=u.format,h=u.type;if(c!==jt&&O.convert(c)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===Tt||O.convert(h)===f.getParameter(35738)||h===Rt&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||h===Lt&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&f.readPixels(e,n,r,i,O.convert(c),O.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&f.bindFramebuffer(36160,F)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=O.convert(e.format);x.setTexture2D(e,0),f.copyTexImage2D(3553,n,o,t.x,t.y,i,a,0),g.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){void 0===r&&(r=0);var i=e.image.width,a=e.image.height,o=O.convert(n.format),s=O.convert(n.type);x.setTexture2D(n,0),e.isDataTexture?f.texSubImage2D(3553,r,t.x,t.y,i,a,o,s,e.image.data):e.isCompressedTexture?f.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):f.texSubImage2D(3553,r,t.x,t.y,o,s,e.image),0===r&&n.generateMipmaps&&f.generateMipmap(3553),g.unbindTexture()},this.initTexture=function(t){x.setTexture2D(t,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Is(t,e){this.name="",this.color=new gi(t),this.density=void 0!==e?e:25e-5}function Ds(t,e,n){this.name="",this.color=new gi(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function zs(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=kn,this.updateRange={offset:0,count:-1},this.version=0}As.prototype=Object.assign(Object.create(Sa.prototype),{constructor:As,isArrayCamera:!0}),Os.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Os,isGroup:!0}),Object.assign(Ns.prototype,{constructor:Ns,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Os,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Os,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(t,e,n){var r=null,i=null,a=this._targetRay,o=this._grip;return t&&(null!==a&&null!==(r=e.getPose(t.targetRaySpace,n))&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)),null!==o&&t.gripSpace&&null!==(i=e.getPose(t.gripSpace,n))&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==a&&(a.visible=null!==r),null!==o&&(o.visible=null!==i),this}}),Object.assign(Rs.prototype,zn.prototype),Object.assign(Is.prototype,{isFogExp2:!0,clone:function(){return new Is(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ds.prototype,{isFog:!0,clone:function(){return new Ds(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(zs.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(zs.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Fs,Bs=new Kn;function Vs(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function js(t){wi.call(this),this.type="SpriteMaterial",this.color=new gi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Vs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Vs.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Bs.x=this.getX(e),Bs.y=this.getY(e),Bs.z=this.getZ(e),Bs.applyMatrix4(t),this.setXYZ(e,Bs.x,Bs.y,Bs.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),js.prototype=Object.create(wi.prototype),js.prototype.constructor=js,js.prototype.isSpriteMaterial=!0,js.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Hs=new Kn,Us=new Kn,Gs=new Kn,qs=new Hn,Ws=new Hn,$s=new sr,Ys=new Kn,Qs=new Kn,Xs=new Kn,Zs=new Hn,Js=new Hn,Ks=new Hn;function tl(t){if(Mr.call(this),this.type="Sprite",void 0===Fs){Fs=new Gi;var e=new zs(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Fs.setIndex([0,1,2,0,2,3]),Fs.setAttribute("position",new Vs(e,3,0,!1)),Fs.setAttribute("uv",new Vs(e,2,3,!1))}this.geometry=Fs,this.material=void 0!==t?t:new js,this.center=new Hn(.5,.5)}function el(t,e,n,r,i,a){qs.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Ws.x=a*qs.x-i*qs.y,Ws.y=i*qs.x+a*qs.y):Ws.copy(qs),t.copy(e),t.x+=Ws.x,t.y+=Ws.y,t.applyMatrix4($s)}tl.prototype=Object.assign(Object.create(Mr.prototype),{constructor:tl,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Us.setFromMatrixScale(this.matrixWorld),$s.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Gs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Us.multiplyScalar(-Gs.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;el(Ys.set(-.5,-.5,0),Gs,a,Us,n,r),el(Qs.set(.5,-.5,0),Gs,a,Us,n,r),el(Xs.set(.5,.5,0),Gs,a,Us,n,r),Zs.set(0,0),Js.set(1,0),Ks.set(1,1);var o=t.ray.intersectTriangle(Ys,Qs,Xs,!1,Hs);if(null!==o||(el(Qs.set(-.5,.5,0),Gs,a,Us,n,r),Js.set(0,1),null!==(o=t.ray.intersectTriangle(Ys,Xs,Qs,!1,Hs)))){var s=t.ray.origin.distanceTo(Hs);s<t.near||s>t.far||e.push({distance:s,point:Hs.clone(),uv:di.getUV(Hs,Ys,Qs,Xs,Zs,Js,Ks,new Hn),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Mr.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var nl,rl,il,al,ol,sl=new Kn,ll=new Kn;function ul(){Mr.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function cl(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),la.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new sr,this.bindMatrixInverse=new sr}ul.prototype=Object.assign(Object.create(Mr.prototype),{constructor:ul,isLOD:!0,copy:function(t){Mr.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){sl.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(sl);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){sl.setFromMatrixPosition(t.matrixWorld),ll.setFromMatrixPosition(this.matrixWorld);var n=sl.distanceTo(ll)/t.zoom;e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=Mr.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),cl.prototype=Object.assign(Object.create(la.prototype),{constructor:cl,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new $n,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){la.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:(nl=new Kn,rl=new $n,il=new $n,al=new Kn,ol=new sr,function(t,e){var n=this.skeleton,r=this.geometry;rl.fromBufferAttribute(r.attributes.skinIndex,t),il.fromBufferAttribute(r.attributes.skinWeight,t),nl.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(var i=0;i<4;i++){var a=il.getComponent(i);if(0!==a){var o=rl.getComponent(i);ol.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),e.addScaledVector(al.copy(nl).applyMatrix4(ol),a)}}return e.applyMatrix4(this.bindMatrixInverse)})});var hl=new sr,dl=new sr;function fl(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new sr)}}function pl(){Mr.call(this),this.type="Bone"}Object.assign(fl.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new sr;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=t.length;i<a;i++){var o=t[i]?t[i].matrixWorld:dl;hl.multiplyMatrices(o,e[i]),hl.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new fl(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),pl.prototype=Object.assign(Object.create(Mr.prototype),{constructor:pl,isBone:!0});var ml=new sr,gl=new sr,vl=[],yl=new la;function bl(t,e,n){la.call(this,t,e),this.instanceMatrix=new Mi(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function xl(t){wi.call(this),this.type="LineBasicMaterial",this.color=new gi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}bl.prototype=Object.assign(Object.create(la.prototype),{constructor:bl,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(yl.geometry=this.geometry,yl.material=this.material,void 0!==yl.material)for(var i=0;i<r;i++){this.getMatrixAt(i,ml),gl.multiplyMatrices(n,ml),yl.matrixWorld=gl,yl.raycast(t,vl);for(var a=0,o=vl.length;a<o;a++){var s=vl[a];s.instanceId=i,s.object=this,e.push(s)}vl.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),xl.prototype=Object.create(wi.prototype),xl.prototype.constructor=xl,xl.prototype.isLineBasicMaterial=!0,xl.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var _l=new Kn,wl=new Kn,Sl=new sr,El=new Zr,Ml=new Ur;function Cl(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Mr.call(this),this.type="Line",this.geometry=void 0!==t?t:new Gi,this.material=void 0!==e?e:new xl}Cl.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Cl,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)_l.fromBufferAttribute(e,r-1),wl.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=_l.distanceTo(wl);t.setAttribute("lineDistance",new Ri(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ml.copy(n.boundingSphere),Ml.applyMatrix4(r),Ml.radius+=i,!1!==t.ray.intersectsSphere(Ml)){Sl.getInverse(r),El.copy(t.ray).applyMatrix4(Sl);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new Kn,l=new Kn,u=new Kn,c=new Kn,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,f=n.attributes.position.array;if(null!==d)for(var p=d.array,m=0,g=p.length-1;m<g;m+=h){var v=p[m],y=p[m+1];if(s.fromArray(f,3*v),l.fromArray(f,3*y),!(El.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=f.length/3-1;m<g;m+=h){if(s.fromArray(f,3*m),l.fromArray(f,3*m+3),!(El.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var b=n.vertices,x=b.length;for(m=0;m<x-1;m+=h){var _;if(!(El.distanceSqToSegment(b[m],b[m+1],c,u)>o))c.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(c))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Tl=new Kn,kl=new Kn;function Pl(t,e){Cl.call(this,t,e),this.type="LineSegments"}function Al(t,e){Cl.call(this,t,e),this.type="LineLoop"}function Ol(t){wi.call(this),this.type="PointsMaterial",this.color=new gi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Pl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Pl,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)Tl.fromBufferAttribute(e,r),kl.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Tl.distanceTo(kl);t.setAttribute("lineDistance",new Ri(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;for(n=t.lineDistances,r=0,i=a.length;r<i;r+=2)Tl.copy(a[r]),kl.copy(a[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Tl.distanceTo(kl)}return this}}),Al.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Al,isLineLoop:!0}),Ol.prototype=Object.create(wi.prototype),Ol.prototype.constructor=Ol,Ol.prototype.isPointsMaterial=!0,Ol.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Nl=new sr,Rl=new Zr,Ll=new Ur,Il=new Kn;function Dl(t,e){Mr.call(this),this.type="Points",this.geometry=void 0!==t?t:new Gi,this.material=void 0!==e?e:new Ol,this.updateMorphTargets()}function zl(t,e,n,r,i,a,o){var s=Rl.distanceSqToPoint(t);if(s<n){var l=new Kn;Rl.closestPointToPoint(t,l),l.applyMatrix4(r);var u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}function Fl(t,e,n,r,i,a,o,s,l){Wn.call(this,t,e,n,r,i,a,o,s,l),this.format=void 0!==o?o:Vt,this.minFilter=void 0!==a?a:wt,this.magFilter=void 0!==i?i:wt,this.generateMipmaps=!1}function Bl(t,e,n,r,i,a,o,s,l,u,c,h){Wn.call(this,null,a,o,s,l,u,r,i,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Vl(t,e,n,r,i,a,o,s,l){Wn.call(this,t,e,n,r,i,a,o,s,l),this.needsUpdate=!0}function jl(t,e,n,r,i,a,o,s,l,u){if((u=void 0!==u?u:qt)!==qt&&u!==Wt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===qt&&(n=At),void 0===n&&u===Wt&&(n=Ft),Wn.call(this,null,r,i,a,o,s,u,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:vt,this.minFilter=void 0!==s?s:vt,this.flipY=!1,this.generateMipmaps=!1}function Hl(t){Gi.call(this),this.type="WireframeGeometry";var e,n,r,i,a,o,s,l,u,c,h=[],d=[0,0],f={},p=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var g=m[e];for(n=0;n<3;n++)s=g[p[n]],l=g[p[(n+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]})}for(u in f)o=f[u],c=t.vertices[o.index1],h.push(c.x,c.y,c.z),c=t.vertices[o.index2],h.push(c.x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,b,x,_,w,S;if(c=new Kn,null!==t.index){for(v=t.attributes.position,y=t.index,0===(b=t.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,a=b.length;i<a;++i)for(e=_=(x=b[i]).start,r=_+x.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),l=y.getX(e+(n+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]});for(u in f)o=f[u],c.fromBufferAttribute(v,o.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,o.index2),h.push(c.x,c.y,c.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,c.fromBufferAttribute(v,w),h.push(c.x,c.y,c.z),S=3*e+(n+1)%3,c.fromBufferAttribute(v,S),h.push(c.x,c.y,c.z)}this.setAttribute("position",new Ri(h,3))}function Ul(t,e,n){ma.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Gl(t,e,n)),this.mergeVertices()}function Gl(t,e,n){Gi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,a=[],o=[],s=[],l=[],u=1e-5,c=new Kn,h=new Kn,d=new Kn,f=new Kn,p=new Kn;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=e;i++){var v=i/e;t(v,g,h),o.push(h.x,h.y,h.z),v-u>=0?(t(v-u,g,d),f.subVectors(h,d)):(t(v+u,g,d),f.subVectors(d,h)),g-u>=0?(t(v,g-u,d),p.subVectors(h,d)):(t(v,g+u,d),p.subVectors(d,h)),c.crossVectors(f,p).normalize(),s.push(c.x,c.y,c.z),l.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,b=r*m+i+1,x=(r+1)*m+i+1,_=(r+1)*m+i;a.push(y,b,_),a.push(b,x,_)}this.setIndex(a),this.setAttribute("position",new Ri(o,3)),this.setAttribute("normal",new Ri(s,3)),this.setAttribute("uv",new Ri(l,2))}function ql(t,e,n,r){ma.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Wl(t,e,n,r)),this.mergeVertices()}function Wl(t,e,n,r){Gi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],a=[];function o(t,e,n,r){var i,a,o=Math.pow(2,r),l=[];for(i=0;i<=o;i++){l[i]=[];var u=t.clone().lerp(n,i/o),c=e.clone().lerp(n,i/o),h=o-i;for(a=0;a<=h;a++)l[i][a]=0===a&&i===o?u:u.clone().lerp(c,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var d=Math.floor(a/2);a%2==0?(s(l[i][d+1]),s(l[i+1][d]),s(l[i][d])):(s(l[i][d+1]),s(l[i+1][d+1]),s(l[i+1][d]))}}function s(t){i.push(t.x,t.y,t.z)}function l(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function u(t,e,n,r){r<0&&1===t.x&&(a[e]=t.x-1),0===n.x&&0===n.z&&(a[e]=r/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}function h(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){for(var n=new Kn,r=new Kn,i=new Kn,a=0;a<e.length;a+=3)l(e[a+0],n),l(e[a+1],r),l(e[a+2],i),o(n,r,i,t)}(r=r||0),function(t){for(var e=new Kn,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new Kn,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=c(t)/2/Math.PI+.5,r=h(t)/Math.PI+.5;a.push(n,1-r)}(function(){for(var t=new Kn,e=new Kn,n=new Kn,r=new Kn,o=new Hn,s=new Hn,l=new Hn,h=0,d=0;h<i.length;h+=9,d+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=c(r);u(o,d+0,t,f),u(s,d+2,e,f),u(l,d+4,n,f)}})(),function(){for(var t=0;t<a.length;t+=6){var e=a[t+0],n=a[t+2],r=a[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(a[t+0]+=1),n<.2&&(a[t+2]+=1),r<.2&&(a[t+4]+=1))}}()}(),this.setAttribute("position",new Ri(i,3)),this.setAttribute("normal",new Ri(i.slice(),3)),this.setAttribute("uv",new Ri(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function $l(t,e){ma.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Yl(t,e)),this.mergeVertices()}function Yl(t,e){Wl.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ql(t,e){ma.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Xl(t,e)),this.mergeVertices()}function Xl(t,e){Wl.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Zl(t,e){ma.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Jl(t,e)),this.mergeVertices()}function Jl(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Wl.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Kl(t,e){ma.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new tu(t,e)),this.mergeVertices()}function tu(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Wl.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function eu(t,e,n,r,i,a){ma.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new nu(t,e,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function nu(t,e,n,r,i){Gi.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var a=t.computeFrenetFrames(e,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,l=new Kn,u=new Kn,c=new Hn,h=new Kn,d=[],f=[],p=[],m=[];function g(i){h=t.getPointAt(i/e,h);var o=a.normals[i],c=a.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);u.x=g*o.x+m*c.x,u.y=g*o.y+m*c.y,u.z=g*o.z+m*c.z,u.normalize(),f.push(u.x,u.y,u.z),l.x=h.x+n*u.x,l.y=h.y+n*u.y,l.z=h.z+n*u.z,d.push(l.x,l.y,l.z)}}!function(){for(o=0;o<e;o++)g(o);g(!1===i?e:0),function(){for(o=0;o<=e;o++)for(s=0;s<=r;s++)c.x=o/e,c.y=s/r,p.push(c.x,c.y)}(),function(){for(s=1;s<=e;s++)for(o=1;o<=r;o++){var t=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;m.push(t,n,a),m.push(n,i,a)}}()}(),this.setIndex(m),this.setAttribute("position",new Ri(d,3)),this.setAttribute("normal",new Ri(f,3)),this.setAttribute("uv",new Ri(p,2))}function ru(t,e,n,r,i,a,o){ma.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new iu(t,e,n,r,i,a)),this.mergeVertices()}function iu(t,e,n,r,i,a){Gi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,l=[],u=[],c=[],h=[],d=new Kn,f=new Kn,p=new Kn,m=new Kn,g=new Kn,v=new Kn,y=new Kn;for(o=0;o<=n;++o){var b=o/n*i*Math.PI*2;for(T(b,i,a,t,p),T(b+.01,i,a,t,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,_=-e*Math.cos(x),w=e*Math.sin(x);d.x=p.x+(_*y.x+w*g.x),d.y=p.y+(_*y.y+w*g.y),d.z=p.z+(_*y.z+w*g.z),u.push(d.x,d.y,d.z),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(o/n),h.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var S=(r+1)*(s-1)+(o-1),E=(r+1)*s+(o-1),M=(r+1)*s+o,C=(r+1)*(s-1)+o;l.push(S,E,C),l.push(E,M,C)}function T(t,e,n,r,i){var a=Math.cos(t),o=Math.sin(t),s=n/e*t,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(l),this.setAttribute("position",new Ri(u,3)),this.setAttribute("normal",new Ri(c,3)),this.setAttribute("uv",new Ri(h,2))}function au(t,e,n,r,i){ma.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ou(t,e,n,r,i)),this.mergeVertices()}function ou(t,e,n,r,i){Gi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],l=[],u=[],c=[],h=new Kn,d=new Kn,f=new Kn;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var p=o/r*i,m=a/n*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(p),d.y=(t+e*Math.cos(m))*Math.sin(p),d.z=e*Math.sin(m),l.push(d.x,d.y,d.z),h.x=t*Math.cos(p),h.y=t*Math.sin(p),f.subVectors(d,h).normalize(),u.push(f.x,f.y,f.z),c.push(o/r),c.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,b=(r+1)*a+o;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.setAttribute("position",new Ri(l,3)),this.setAttribute("normal",new Ri(u,3)),this.setAttribute("uv",new Ri(c,2))}Dl.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Dl,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ll.copy(n.boundingSphere),Ll.applyMatrix4(r),Ll.radius+=i,!1!==t.ray.intersectsSphere(Ll)){Nl.getInverse(r),Rl.copy(t.ray).applyMatrix4(Nl);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,l=n.attributes.position.array;if(null!==s)for(var u=s.array,c=0,h=u.length;c<h;c++){var d=u[c];Il.fromArray(l,3*d),zl(Il,d,o,r,t,e,this)}else{c=0;for(var f=l.length/3;c<f;c++)Il.fromArray(l,3*c),zl(Il,c,o,r,t,e,this)}}else{var p=n.vertices;for(c=0,f=p.length;c<f;c++)zl(p[c],c,o,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Fl.prototype=Object.assign(Object.create(Wn.prototype),{constructor:Fl,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Bl.prototype=Object.create(Wn.prototype),Bl.prototype.constructor=Bl,Bl.prototype.isCompressedTexture=!0,Vl.prototype=Object.create(Wn.prototype),Vl.prototype.constructor=Vl,Vl.prototype.isCanvasTexture=!0,jl.prototype=Object.create(Wn.prototype),jl.prototype.constructor=jl,jl.prototype.isDepthTexture=!0,Hl.prototype=Object.create(Gi.prototype),Hl.prototype.constructor=Hl,Ul.prototype=Object.create(ma.prototype),Ul.prototype.constructor=Ul,Gl.prototype=Object.create(Gi.prototype),Gl.prototype.constructor=Gl,ql.prototype=Object.create(ma.prototype),ql.prototype.constructor=ql,Wl.prototype=Object.create(Gi.prototype),Wl.prototype.constructor=Wl,$l.prototype=Object.create(ma.prototype),$l.prototype.constructor=$l,Yl.prototype=Object.create(Wl.prototype),Yl.prototype.constructor=Yl,Ql.prototype=Object.create(ma.prototype),Ql.prototype.constructor=Ql,Xl.prototype=Object.create(Wl.prototype),Xl.prototype.constructor=Xl,Zl.prototype=Object.create(ma.prototype),Zl.prototype.constructor=Zl,Jl.prototype=Object.create(Wl.prototype),Jl.prototype.constructor=Jl,Kl.prototype=Object.create(ma.prototype),Kl.prototype.constructor=Kl,tu.prototype=Object.create(Wl.prototype),tu.prototype.constructor=tu,eu.prototype=Object.create(ma.prototype),eu.prototype.constructor=eu,nu.prototype=Object.create(Gi.prototype),nu.prototype.constructor=nu,nu.prototype.toJSON=function(){var t=Gi.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},ru.prototype=Object.create(ma.prototype),ru.prototype.constructor=ru,iu.prototype=Object.create(Gi.prototype),iu.prototype.constructor=iu,au.prototype=Object.create(ma.prototype),au.prototype.constructor=au,ou.prototype=Object.create(Gi.prototype),ou.prototype.constructor=ou;var su=function(t,e,n){n=n||2;var r,i,a,o,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,d=lu(t,0,h,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(t,e,n,r){var i,a,o,s,l,u=[];for(i=0,a=e.length;i<a;i++)o=e[i]*r,s=i<a-1?e[i+1]*r:t.length,(l=lu(t,o,s,r,!1))===l.next&&(l.steiner=!0),u.push(bu(l));for(u.sort(mu),i=0;i<u.length;i++)gu(u[i],n),n=uu(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=a=t[0],i=o=t[1];for(var p=n;p<h;p+=n)(s=t[p])<r&&(r=s),(l=t[p+1])<i&&(i=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-r,o-i))?1/u:0}return cu(d,f,n,r,i,u),f};function lu(t,e,n,r,i){var a,o;if(i===function(t,e,n,r){for(var i=0,a=e,o=n-r;a<n;a+=r)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}(t,e,n,r)>0)for(a=e;a<n;a+=r)o=Pu(a,t[a],t[a+1],o);else for(a=n-r;a>=e;a-=r)o=Pu(a,t[a],t[a+1],o);return o&&Su(o,o.next)&&(Au(o),o=o.next),o}function uu(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Su(r,r.next)&&0!==wu(r.prev,r,r.next))r=r.next;else{if(Au(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function cu(t,e,n,r,i,a,o){if(t){!o&&a&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=yu(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,o,s,l,u=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(o>1)}(i)}(t,r,i,a);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?du(t,r,i,a):hu(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Au(t),t=l.next,u=l.next;else if((t=l)===u){o?1===o?cu(t=fu(uu(t),e,n),e,n,r,i,a,2):2===o&&pu(t,e,n,r,i,a):cu(uu(t),e,n,r,i,a,1);break}}}function hu(t){var e=t.prev,n=t,r=t.next;if(wu(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(xu(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&wu(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function du(t,e,n,r){var i=t.prev,a=t,o=t.next;if(wu(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=yu(s,l,e,n,r),d=yu(u,c,e,n,r),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&wu(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&wu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&wu(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&wu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function fu(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!Su(i,a)&&Eu(i,r,r.next,a)&&Tu(i,a)&&Tu(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),Au(r),Au(r.next),r=t=a),r=r.next}while(r!==t);return uu(r)}function pu(t,e,n,r,i,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&_u(o,s)){var l=ku(o,s);return o=uu(o,o.next),l=uu(l,l.next),cu(o,e,n,r,i,a),void cu(l,e,n,r,i,a)}s=s.next}o=o.next}while(o!==t)}function mu(t,e){return t.x-e.x}function gu(t,e){if(e=function(t,e){var n,r=e,i=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===o)return n;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&xu(a<h?i:o,a,c,h,a<h?o:i,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(i-r.x),Tu(r,t)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&vu(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(t,e)){var n=ku(e,t);uu(e,e.next),uu(n,n.next)}}function vu(t,e){return wu(t.prev,t,e.prev)<0&&wu(e.next,t,t.next)<0}function yu(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function bu(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function xu(t,e,n,r,i,a,o,s){return(i-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(r-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function _u(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Eu(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Tu(t,e)&&Tu(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(wu(t.prev,t,e.prev)||wu(t,e.prev,e))||Su(t,e)&&wu(t.prev,t,t.next)>0&&wu(e.prev,e,e.next)>0)}function wu(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Su(t,e){return t.x===e.x&&t.y===e.y}function Eu(t,e,n,r){var i=Cu(wu(t,e,n)),a=Cu(wu(t,e,r)),o=Cu(wu(n,r,t)),s=Cu(wu(n,r,e));return i!==a&&o!==s||(!(0!==i||!Mu(t,n,e))||(!(0!==a||!Mu(t,r,e))||(!(0!==o||!Mu(n,t,r))||!(0!==s||!Mu(n,e,r)))))}function Mu(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Cu(t){return t>0?1:t<0?-1:0}function Tu(t,e){return wu(t.prev,t,t.next)<0?wu(t,e,t.next)>=0&&wu(t,t.prev,e)>=0:wu(t,e,t.prev)<0||wu(t,t.next,e)<0}function ku(t,e){var n=new Ou(t.i,t.x,t.y),r=new Ou(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Pu(t,e,n,r){var i=new Ou(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Au(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ou(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Nu={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Nu.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];Ru(t),Lu(n,t);var a=t.length;e.forEach(Ru);for(var o=0;o<e.length;o++)r.push(a),a+=e[o].length,Lu(n,e[o]);var s=su(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function Ru(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Lu(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Iu(t,e){ma.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Du(t,e)),this.mergeVertices()}function Du(t,e){Gi.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],a=0,o=t.length;a<o;a++){s(t[a])}function s(t){var a=[],o=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,l=void 0!==e.depth?e.depth:100,u=void 0===e.bevelEnabled||e.bevelEnabled,c=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:c-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3,p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:zu;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);var g,v,y,b,x,_,w,S,E=!1;p&&(g=p.getSpacedPoints(s),E=!0,u=!1,v=p.computeFrenetFrames(s,!1),y=new Kn,b=new Kn,x=new Kn),u||(f=0,c=0,h=0,d=0);var M=t.extractPoints(o),C=M.shape,T=M.holes;if(!Nu.isClockWise(C))for(C=C.reverse(),w=0,S=T.length;w<S;w++)_=T[w],Nu.isClockWise(_)&&(T[w]=_.reverse());var k=Nu.triangulateShape(C,T),P=C;for(w=0,S=T.length;w<S;w++)_=T[w],C=C.concat(_);function A(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var O,N,R,L,I,D,z=C.length,F=k.length;function B(t,e,n){var r,i,a,o=t.x-e.x,s=t.y-e.y,l=n.x-t.x,u=n.y-t.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=e.x-s/d,m=e.y+o/d,g=((n.x-u/f-p)*u-(n.y+l/f-m)*l)/(o*u-s*l),v=(r=p+o*g-t.x)*r+(i=m+s*g-t.y)*i;if(v<=2)return new Hn(r,i);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new Hn(r/a,i/a)}for(var V=[],j=0,H=P.length,U=H-1,G=j+1;j<H;j++,U++,G++)U===H&&(U=0),G===H&&(G=0),V[j]=B(P[j],P[U],P[G]);var q,W,$=[],Y=V.concat();for(w=0,S=T.length;w<S;w++){for(_=T[w],q=[],j=0,U=(H=_.length)-1,G=j+1;j<H;j++,U++,G++)U===H&&(U=0),G===H&&(G=0),q[j]=B(_[j],_[U],_[G]);$.push(q),Y=Y.concat(q)}for(O=0;O<f;O++){for(R=O/f,L=c*Math.cos(R*Math.PI/2),N=h*Math.sin(R*Math.PI/2)+d,j=0,H=P.length;j<H;j++)X((I=A(P[j],V[j],N)).x,I.y,-L);for(w=0,S=T.length;w<S;w++)for(_=T[w],q=$[w],j=0,H=_.length;j<H;j++)X((I=A(_[j],q[j],N)).x,I.y,-L)}for(N=h+d,j=0;j<z;j++)I=u?A(C[j],Y[j],N):C[j],E?(b.copy(v.normals[0]).multiplyScalar(I.x),y.copy(v.binormals[0]).multiplyScalar(I.y),x.copy(g[0]).add(b).add(y),X(x.x,x.y,x.z)):X(I.x,I.y,0);for(W=1;W<=s;W++)for(j=0;j<z;j++)I=u?A(C[j],Y[j],N):C[j],E?(b.copy(v.normals[W]).multiplyScalar(I.x),y.copy(v.binormals[W]).multiplyScalar(I.y),x.copy(g[W]).add(b).add(y),X(x.x,x.y,x.z)):X(I.x,I.y,l/s*W);for(O=f-1;O>=0;O--){for(R=O/f,L=c*Math.cos(R*Math.PI/2),N=h*Math.sin(R*Math.PI/2)+d,j=0,H=P.length;j<H;j++)X((I=A(P[j],V[j],N)).x,I.y,l+L);for(w=0,S=T.length;w<S;w++)for(_=T[w],q=$[w],j=0,H=_.length;j<H;j++)I=A(_[j],q[j],N),E?X(I.x,I.y+g[s-1].y,g[s-1].x+L):X(I.x,I.y,l+L)}function Q(t,e){var n,r;for(j=t.length;--j>=0;){n=j,(r=j-1)<0&&(r=t.length-1);var i=0,a=s+2*f;for(i=0;i<a;i++){var o=z*i,l=z*(i+1);J(e+n+o,e+r+o,e+r+l,e+n+l)}}}function X(t,e,n){a.push(t),a.push(e),a.push(n)}function Z(t,e,i){K(t),K(e),K(i);var a=r.length/3,o=m.generateTopUV(n,r,a-3,a-2,a-1);tt(o[0]),tt(o[1]),tt(o[2])}function J(t,e,i,a){K(t),K(e),K(a),K(e),K(i),K(a);var o=r.length/3,s=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function K(t){r.push(a[3*t+0]),r.push(a[3*t+1]),r.push(a[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(u){var e=0,i=z*e;for(j=0;j<F;j++)Z((D=k[j])[2]+i,D[1]+i,D[0]+i);for(i=z*(e=s+2*f),j=0;j<F;j++)Z((D=k[j])[0]+i,D[1]+i,D[2]+i)}else{for(j=0;j<F;j++)Z((D=k[j])[2],D[1],D[0]);for(j=0;j<F;j++)Z((D=k[j])[0]+z*s,D[1]+z*s,D[2]+z*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(Q(P,e),e+=P.length,w=0,S=T.length;w<S;w++)Q(_=T[w],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new Ri(r,3)),this.setAttribute("uv",new Ri(i,2)),this.computeVertexNormals()}Iu.prototype=Object.create(ma.prototype),Iu.prototype.constructor=Iu,Iu.prototype.toJSON=function(){var t=ma.prototype.toJSON.call(this);return Fu(this.parameters.shapes,this.parameters.options,t)},Du.prototype=Object.create(Gi.prototype),Du.prototype.constructor=Du,Du.prototype.toJSON=function(){var t=Gi.prototype.toJSON.call(this);return Fu(this.parameters.shapes,this.parameters.options,t)};var zu={generateTopUV:function(t,e,n,r,i){var a=e[3*n],o=e[3*n+1],s=e[3*r],l=e[3*r+1],u=e[3*i],c=e[3*i+1];return[new Hn(a,o),new Hn(s,l),new Hn(u,c)]},generateSideWallUV:function(t,e,n,r,i,a){var o=e[3*n],s=e[3*n+1],l=e[3*n+2],u=e[3*r],c=e[3*r+1],h=e[3*r+2],d=e[3*i],f=e[3*i+1],p=e[3*i+2],m=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-c)<.01?[new Hn(o,1-l),new Hn(u,1-h),new Hn(d,1-p),new Hn(m,1-v)]:[new Hn(s,1-l),new Hn(c,1-h),new Hn(f,1-p),new Hn(g,1-v)]}};function Fu(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var a=t[r];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Bu(t,e){ma.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Vu(t,e)),this.mergeVertices()}function Vu(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ma;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Du.call(this,r,e),this.type="TextBufferGeometry"}function ju(t,e,n,r,i,a,o){ma.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Hu(t,e,n,r,i,a,o)),this.mergeVertices()}function Hu(t,e,n,r,i,a,o){Gi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,l,u=Math.min(a+o,Math.PI),c=0,h=[],d=new Kn,f=new Kn,p=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],b=l/n,x=0;for(0==l&&0==a?x=.5/e:l==n&&u==Math.PI&&(x=-.5/e),s=0;s<=e;s++){var _=s/e;d.x=-t*Math.cos(r+_*i)*Math.sin(a+b*o),d.y=t*Math.cos(a+b*o),d.z=t*Math.sin(r+_*i)*Math.sin(a+b*o),m.push(d.x,d.y,d.z),f.copy(d).normalize(),g.push(f.x,f.y,f.z),v.push(_+x,1-b),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(s=0;s<e;s++){var w=h[l][s+1],S=h[l][s],E=h[l+1][s],M=h[l+1][s+1];(0!==l||a>0)&&p.push(w,S,M),(l!==n-1||u<Math.PI)&&p.push(S,E,M)}this.setIndex(p),this.setAttribute("position",new Ri(m,3)),this.setAttribute("normal",new Ri(g,3)),this.setAttribute("uv",new Ri(v,2))}function Uu(t,e,n,r,i,a){ma.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Gu(t,e,n,r,i,a)),this.mergeVertices()}function Gu(t,e,n,r,i,a){Gi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},t=t||.5,e=e||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,l,u=[],c=[],h=[],d=[],f=t,p=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new Kn,g=new Hn;for(s=0;s<=r;s++){for(l=0;l<=n;l++)o=i+l/n*a,m.x=f*Math.cos(o),m.y=f*Math.sin(o),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);f+=p}for(s=0;s<r;s++){var v=s*(n+1);for(l=0;l<n;l++){var y=o=l+v,b=o+n+1,x=o+n+2,_=o+1;u.push(y,b,_),u.push(b,x,_)}}this.setIndex(u),this.setAttribute("position",new Ri(c,3)),this.setAttribute("normal",new Ri(h,3)),this.setAttribute("uv",new Ri(d,2))}function qu(t,e,n,r){ma.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Wu(t,e,n,r)),this.mergeVertices()}function Wu(t,e,n,r){Gi.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=jn.clamp(r,0,2*Math.PI);var i,a,o,s=[],l=[],u=[],c=1/e,h=new Kn,d=new Hn;for(a=0;a<=e;a++){var f=n+a*c*r,p=Math.sin(f),m=Math.cos(f);for(o=0;o<=t.length-1;o++)h.x=t[o].x*p,h.y=t[o].y,h.z=t[o].x*m,l.push(h.x,h.y,h.z),d.x=a/e,d.y=o/(t.length-1),u.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var g=i=o+a*t.length,v=i+t.length,y=i+t.length+1,b=i+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.setAttribute("position",new Ri(l,3)),this.setAttribute("uv",new Ri(u,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,_=new Kn,w=new Kn,S=new Kn;for(i=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)_.x=x[o+0],_.y=x[o+1],_.z=x[o+2],w.x=x[i+o+0],w.y=x[i+o+1],w.z=x[i+o+2],S.addVectors(_,w).normalize(),x[o+0]=x[i+o+0]=S.x,x[o+1]=x[i+o+1]=S.y,x[o+2]=x[i+o+2]=S.z}}function $u(t,e){ma.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Yu(t,e)),this.mergeVertices()}function Yu(t,e){Gi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(t))u(t);else for(var l=0;l<t.length;l++)u(t[l]),this.addGroup(o,s,l),o+=s,s=0;function u(t){var o,l,u,c=r.length/3,h=t.extractPoints(e),d=h.shape,f=h.holes;for(!1===Nu.isClockWise(d)&&(d=d.reverse()),o=0,l=f.length;o<l;o++)u=f[o],!0===Nu.isClockWise(u)&&(f[o]=u.reverse());var p=Nu.triangulateShape(d,f);for(o=0,l=f.length;o<l;o++)u=f[o],d=d.concat(u);for(o=0,l=d.length;o<l;o++){var m=d[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,l=p.length;o<l;o++){var g=p[o],v=g[0]+c,y=g[1]+c,b=g[2]+c;n.push(v,y,b),s+=3}}this.setIndex(n),this.setAttribute("position",new Ri(r,3)),this.setAttribute("normal",new Ri(i,3)),this.setAttribute("uv",new Ri(a,2))}function Qu(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function Xu(t,e){Gi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,a,o=[],s=Math.cos(jn.DEG2RAD*e),l=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(a=new ma).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,d=a.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],l[0]=Math.min(n,r),l[1]=Math.max(n,r),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var v=u[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.setAttribute("position",new Ri(o,3))}function Zu(t,e,n,r,i,a,o,s){ma.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Ju(t,e,n,r,i,a,o,s)),this.mergeVertices()}function Ju(t,e,n,r,i,a,o,s){Gi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var l=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var u=[],c=[],h=[],d=[],f=0,p=[],m=n/2,g=0;function v(n){var i,a,p,v=new Hn,y=new Kn,b=0,x=!0===n?t:e,_=!0===n?1:-1;for(a=f,i=1;i<=r;i++)c.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),f++;for(p=f,i=0;i<=r;i++){var w=i/r*s+o,S=Math.cos(w),E=Math.sin(w);y.x=x*E,y.y=m*_,y.z=x*S,c.push(y.x,y.y,y.z),h.push(0,_,0),v.x=.5*S+.5,v.y=.5*E*_+.5,d.push(v.x,v.y),f++}for(i=0;i<r;i++){var M=a+i,C=p+i;!0===n?u.push(C,C+1,M):u.push(C+1,C,M),b+=3}l.addGroup(g,b,!0===n?1:2),g+=b}!function(){var a,v,y=new Kn,b=new Kn,x=0,_=(e-t)/n;for(v=0;v<=i;v++){var w=[],S=v/i,E=S*(e-t)+t;for(a=0;a<=r;a++){var M=a/r,C=M*s+o,T=Math.sin(C),k=Math.cos(C);b.x=E*T,b.y=-S*n+m,b.z=E*k,c.push(b.x,b.y,b.z),y.set(T,_,k).normalize(),h.push(y.x,y.y,y.z),d.push(M,1-S),w.push(f++)}p.push(w)}for(a=0;a<r;a++)for(v=0;v<i;v++){var P=p[v][a],A=p[v+1][a],O=p[v+1][a+1],N=p[v][a+1];u.push(P,A,N),u.push(A,O,N),x+=6}l.addGroup(g,x,0),g+=x}(),!1===a&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new Ri(c,3)),this.setAttribute("normal",new Ri(h,3)),this.setAttribute("uv",new Ri(d,2))}function Ku(t,e,n,r,i,a,o){Zu.call(this,0,t,e,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function tc(t,e,n,r,i,a,o){Ju.call(this,0,t,e,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function ec(t,e,n,r){ma.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new nc(t,e,n,r)),this.mergeVertices()}function nc(t,e,n,r){Gi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],l=[],u=[],c=new Kn,h=new Hn;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),a=0,i=3;a<=e;a++,i+=3){var d=n+a/e*r;c.x=t*Math.cos(d),c.y=t*Math.sin(d),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,u.push(h.x,h.y)}for(i=1;i<=e;i++)o.push(i,i+1,0);this.setIndex(o),this.setAttribute("position",new Ri(s,3)),this.setAttribute("normal",new Ri(l,3)),this.setAttribute("uv",new Ri(u,2))}Bu.prototype=Object.create(ma.prototype),Bu.prototype.constructor=Bu,Vu.prototype=Object.create(Du.prototype),Vu.prototype.constructor=Vu,ju.prototype=Object.create(ma.prototype),ju.prototype.constructor=ju,Hu.prototype=Object.create(Gi.prototype),Hu.prototype.constructor=Hu,Uu.prototype=Object.create(ma.prototype),Uu.prototype.constructor=Uu,Gu.prototype=Object.create(Gi.prototype),Gu.prototype.constructor=Gu,qu.prototype=Object.create(ma.prototype),qu.prototype.constructor=qu,Wu.prototype=Object.create(Gi.prototype),Wu.prototype.constructor=Wu,$u.prototype=Object.create(ma.prototype),$u.prototype.constructor=$u,$u.prototype.toJSON=function(){var t=ma.prototype.toJSON.call(this);return Qu(this.parameters.shapes,t)},Yu.prototype=Object.create(Gi.prototype),Yu.prototype.constructor=Yu,Yu.prototype.toJSON=function(){var t=Gi.prototype.toJSON.call(this);return Qu(this.parameters.shapes,t)},Xu.prototype=Object.create(Gi.prototype),Xu.prototype.constructor=Xu,Zu.prototype=Object.create(ma.prototype),Zu.prototype.constructor=Zu,Ju.prototype=Object.create(Gi.prototype),Ju.prototype.constructor=Ju,Ku.prototype=Object.create(Zu.prototype),Ku.prototype.constructor=Ku,tc.prototype=Object.create(Ju.prototype),tc.prototype.constructor=tc,ec.prototype=Object.create(ma.prototype),ec.prototype.constructor=ec,nc.prototype=Object.create(Gi.prototype),nc.prototype.constructor=nc;var rc=Object.freeze({__proto__:null,WireframeGeometry:Hl,ParametricGeometry:Ul,ParametricBufferGeometry:Gl,TetrahedronGeometry:$l,TetrahedronBufferGeometry:Yl,OctahedronGeometry:Ql,OctahedronBufferGeometry:Xl,IcosahedronGeometry:Zl,IcosahedronBufferGeometry:Jl,DodecahedronGeometry:Kl,DodecahedronBufferGeometry:tu,PolyhedronGeometry:ql,PolyhedronBufferGeometry:Wl,TubeGeometry:eu,TubeBufferGeometry:nu,TorusKnotGeometry:ru,TorusKnotBufferGeometry:iu,TorusGeometry:au,TorusBufferGeometry:ou,TextGeometry:Bu,TextBufferGeometry:Vu,SphereGeometry:ju,SphereBufferGeometry:Hu,RingGeometry:Uu,RingBufferGeometry:Gu,PlaneGeometry:Ra,PlaneBufferGeometry:La,LatheGeometry:qu,LatheBufferGeometry:Wu,ShapeGeometry:$u,ShapeBufferGeometry:Yu,ExtrudeGeometry:Iu,ExtrudeBufferGeometry:Du,EdgesGeometry:Xu,ConeGeometry:Ku,ConeBufferGeometry:tc,CylinderGeometry:Zu,CylinderBufferGeometry:Ju,CircleGeometry:ec,CircleBufferGeometry:nc,BoxGeometry:ga,BoxBufferGeometry:va});function ic(t){wi.call(this),this.type="ShadowMaterial",this.color=new gi(0),this.transparent=!0,this.setValues(t)}function ac(t){_a.call(this,t),this.type="RawShaderMaterial"}function oc(t){wi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new gi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function sc(t){oc.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Hn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function lc(t){wi.call(this),this.type="MeshPhongMaterial",this.color=new gi(16777215),this.specular=new gi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function uc(t){wi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new gi(16777215),this.specular=new gi(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function cc(t){wi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function hc(t){wi.call(this),this.type="MeshLambertMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function dc(t){wi.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new gi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cn,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fc(t){xl.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}ic.prototype=Object.create(wi.prototype),ic.prototype.constructor=ic,ic.prototype.isShadowMaterial=!0,ic.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this},ac.prototype=Object.create(_a.prototype),ac.prototype.constructor=ac,ac.prototype.isRawShaderMaterial=!0,oc.prototype=Object.create(wi.prototype),oc.prototype.constructor=oc,oc.prototype.isMeshStandardMaterial=!0,oc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},sc.prototype=Object.create(oc.prototype),sc.prototype.constructor=sc,sc.prototype.isMeshPhysicalMaterial=!0,sc.prototype.copy=function(t){return oc.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new gi).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},lc.prototype=Object.create(wi.prototype),lc.prototype.constructor=lc,lc.prototype.isMeshPhongMaterial=!0,lc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},uc.prototype=Object.create(wi.prototype),uc.prototype.constructor=uc,uc.prototype.isMeshToonMaterial=!0,uc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},cc.prototype=Object.create(wi.prototype),cc.prototype.constructor=cc,cc.prototype.isMeshNormalMaterial=!0,cc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},hc.prototype=Object.create(wi.prototype),hc.prototype.constructor=hc,hc.prototype.isMeshLambertMaterial=!0,hc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dc.prototype=Object.create(wi.prototype),dc.prototype.constructor=dc,dc.prototype.isMeshMatcapMaterial=!0,dc.prototype.copy=function(t){return wi.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fc.prototype=Object.create(xl.prototype),fc.prototype.constructor=fc,fc.prototype.isLineDashedMaterial=!0,fc.prototype.copy=function(t){return xl.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var pc=Object.freeze({__proto__:null,ShadowMaterial:ic,SpriteMaterial:js,RawShaderMaterial:ac,ShaderMaterial:_a,PointsMaterial:Ol,MeshPhysicalMaterial:sc,MeshStandardMaterial:oc,MeshPhongMaterial:lc,MeshToonMaterial:uc,MeshNormalMaterial:cc,MeshLambertMaterial:hc,MeshDepthMaterial:Es,MeshDistanceMaterial:Ms,MeshBasicMaterial:Si,MeshMatcapMaterial:dc,LineDashedMaterial:fc,LineBasicMaterial:xl,Material:wi}),mc={arraySlice:function(t,e,n){return mc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*e,l=0;l!==e;++l)i[o++]=t[s+l];return i},flattenJSON:function(t,e,n,r){for(var i=1,a=t[0];void 0!==a&&void 0===a[r];)a=t[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(e.push(a.time),n.push.apply(n,o)),a=t[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(e.push(a.time),o.toArray(n,n.length)),a=t[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(e.push(a.time),n.push(o)),a=t[i++]}while(void 0!==a)}},subclip:function(t,e,n,r,i){i=i||30;var a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var f=l.times[d]*i;if(!(f<n||f>=r)){c.push(l.times[d]);for(var p=0;p<u;++p)h.push(l.values[d*u+p])}}0!==c.length&&(l.times=mc.convertArray(c,l.times.constructor),l.values=mc.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=t),(void 0===r||r<=0)&&(r=30);for(var i=t.tracks.length,a=e/r,o=0;o<i;++o){var s=n.tracks[o],l=s.ValueTypeName;if("bool"!==l&&"string"!==l){var u=t.tracks.find((function(t){return t.name===s.name&&t.ValueTypeName===l}));if(void 0!==u){var c,h=s.getValueSize(),d=s.times.length-1;if(a<=s.times[0])c=mc.arraySlice(s.values,0,s.valueSize);else if(a>=s.times[d]){var f=d*h;c=mc.arraySlice(s.values,f)}else{var p=s.createInterpolant();p.evaluate(a),c=p.resultBuffer}if("quaternion"===l)new Xn(c[0],c[1],c[2],c[3]).normalize().conjugate().toArray(c);for(var m=u.times.length,g=0;g<m;++g){var v=g*h;if("quaternion"===l)Xn.multiplyQuaternionsFlat(u.values,v,c,0,u.values,v);else for(var y=0;y<h;++y)u.values[v+y]-=c[y]}}}}return t.blendMode=Qe,t}};function gc(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function vc(t,e,n,r){gc.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function yc(t,e,n,r){gc.call(this,t,e,n,r)}function bc(t,e,n,r){gc.call(this,t,e,n,r)}function xc(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=mc.convertArray(e,this.TimeBufferType),this.values=mc.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function _c(t,e,n){xc.call(this,t,e,n)}function wc(t,e,n,r){xc.call(this,t,e,n,r)}function Sc(t,e,n,r){xc.call(this,t,e,n,r)}function Ec(t,e,n,r){gc.call(this,t,e,n,r)}function Mc(t,e,n,r){xc.call(this,t,e,n,r)}function Cc(t,e,n,r){xc.call(this,t,e,n,r)}function Tc(t,e,n,r){xc.call(this,t,e,n,r)}function kc(t,e,n,r){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==r?r:Ye,this.uuid=jn.generateUUID(),this.duration<0&&this.resetDuration()}function Pc(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sc;case"vector":case"vector2":case"vector3":case"vector4":return Tc;case"color":return wc;case"quaternion":return Mc;case"bool":case"boolean":return _c;case"string":return Cc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];mc.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(gc.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var a;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}a=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}a=n,n=0}for(;n<a;){var l=n+a>>>1;t<e[l]?a=l:n=l+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,a=0;a!==r;++a)e[a]=n[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(gc.prototype,{beforeStart_:gc.prototype.copySampleValue_,afterEnd_:gc.prototype.copySampleValue_}),vc.prototype=Object.assign(Object.create(gc.prototype),{constructor:vc,DefaultSettings_:{endingStart:qe,endingEnd:qe},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,a=t+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case We:i=t,o=2*e-n;break;case $e:o=e+r[i=r.length-2]-r[i+1];break;default:i=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case We:a=t,s=2*n-e;break;case $e:a=1,s=n+r[1]-r[0];break;default:a=t-1,s=e}var l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(r-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,x=0;x!==o;++x)i[x]=g*a[u+x]+v*a[l+x]+y*a[s+x]+b*a[c+x];return i}}),yc.prototype=Object.assign(Object.create(gc.prototype),{constructor:yc,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=(n-e)/(r-e),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}),bc.prototype=Object.assign(Object.create(gc.prototype),{constructor:bc,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(xc,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:mc.convertArray(t.times,Array),values:mc.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(xc.prototype,{constructor:xc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ue,InterpolantFactoryMethodDiscrete:function(t){return new bc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new yc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new vc(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case He:e=this.InterpolantFactoryMethodDiscrete;break;case Ue:e=this.InterpolantFactoryMethodLinear;break;case Ge:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return He;case this.InterpolantFactoryMethodLinear:return Ue;case this.InterpolantFactoryMethodSmooth:return Ge}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=mc.arraySlice(n,i,a),this.values=mc.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==r&&mc.isTypedArray(r)){o=0;for(var l=r.length;o!==l;++o){var u=r[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),t=!1;break}}}return t},optimize:function(){for(var t=mc.arraySlice(this.times),e=mc.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Ge,i=1,a=t.length-1,o=1;o<a;++o){var s=!1,l=t[o];if(l!==t[o+1]&&(1!==o||l!==l[0]))if(r)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var f=e[u+d];if(f!==e[c+d]||f!==e[h+d]){s=!0;break}}if(s){if(o!==i){t[i]=t[o];var p=o*n,m=i*n;for(d=0;d!==n;++d)e[m+d]=e[p+d]}++i}}if(a>0){t[i]=t[a];for(p=a*n,m=i*n,d=0;d!==n;++d)e[m+d]=e[p+d];++i}return i!==t.length?(this.times=mc.arraySlice(t,0,i),this.values=mc.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=mc.arraySlice(this.times,0),e=mc.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),_c.prototype=Object.assign(Object.create(xc.prototype),{constructor:_c,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:He,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),wc.prototype=Object.assign(Object.create(xc.prototype),{constructor:wc,ValueTypeName:"color"}),Sc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Sc,ValueTypeName:"number"}),Ec.prototype=Object.assign(Object.create(gc.prototype),{constructor:Ec,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=(n-e)/(r-e),u=s+o;s!==u;s+=4)Xn.slerpFlat(i,0,a,s-o,a,s,l);return i}}),Mc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Mc,ValueTypeName:"quaternion",DefaultInterpolation:Ue,InterpolantFactoryMethodLinear:function(t){return new Ec(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Cc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Cc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:He,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Tc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Tc,ValueTypeName:"vector"}),Object.assign(kc,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,a=n.length;i!==a;++i)e.push(Pc(n[i]).scale(r));return new kc(t.name,t.duration,e,t.blendMode)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode},i=0,a=n.length;i!==a;++i)e.push(xc.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=mc.getKeyframeOrder(s);s=mc.sortedArray(s,1,u),l=mc.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new Sc(".morphTargetInfluences["+e[o].name+"]",s,l).scale(1/n))}return new kc(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],l=s.name.match(i);if(l&&l.length>1){var u=r[h=l[1]];u||(r[h]=u=[]),u.push(s)}}var c=[];for(var h in r)c.push(kc.CreateFromMorphTargetSequence(h,r[h],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var a=[],o=[];mc.flattenJSON(n,a,o,r),0!==a.length&&i.push(new t(e,a,o))}},r=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.blendMode,l=t.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},d=0;d<c.length;d++)if(c[d].morphTargets)for(var f=0;f<c[d].morphTargets.length;f++)h[c[d].morphTargets[f]]=-1;for(var p in h){var m=[],g=[];for(f=0;f!==c[d].morphTargets.length;++f){var v=c[d];m.push(v.time),g.push(v.morphTarget===p?1:0)}r.push(new Sc(".morphTargetInfluence["+p+"]",m,g))}a=h.length*(o||1)}else{var y=".bones["+e[u].name+"]";n(Tc,y+".position",c,"pos",r),n(Mc,y+".quaternion",c,"rot",r),n(Tc,y+".scale",c,"scl",r)}}return 0===r.length?null:new kc(i,a,r,s)}}),Object.assign(kc.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new kc(this.name,this.duration,t,this.blendMode)}});var Ac={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Oc(t,e,n){var r=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===i&&void 0!==r.onStart&&r.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){var e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=l.length;e<n;e+=2){var r=l[e],i=l[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var Nc=new Oc;function Rc(t){this.manager=void 0!==t?t:Nc,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Rc.prototype,{load:function(){},loadAsync:function(t,e){var n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var Lc={};function Ic(t){Rc.call(this,t)}function Dc(t){Rc.call(this,t)}function zc(t){Rc.call(this,t)}function Fc(t){Rc.call(this,t)}function Bc(t){Rc.call(this,t)}function Vc(t){Rc.call(this,t)}function jc(t){Rc.call(this,t)}function Hc(){this.type="Curve",this.arcLengthDivisions=200}function Uc(t,e,n,r,i,a,o,s){Hc.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Gc(t,e,n,r,i,a){Uc.call(this,t,e,n,n,r,i,a),this.type="ArcCurve"}function qc(){var t=0,e=0,n=0,r=0;function i(i,a,o,s){t=i,e=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(t,e,n,r,a){i(e,n,a*(n-t),a*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,a,o,s){var l=(e-t)/a-(n-t)/(a+o)+(n-e)/o,u=(n-e)/o-(r-e)/(o+s)+(r-n)/s;i(e,n,l*=o,u*=o)},calc:function(i){var a=i*i;return t+e*i+n*a+r*(a*i)}}}Ic.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Ic,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Ac.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;if(void 0===Lc[t]){var o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],l=!!o[2],u=o[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),f=0;f<u.length;f++)d[f]=u.charCodeAt(f);c="blob"===h?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}setTimeout((function(){e&&e(c),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{Lc[t]=[],Lc[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,r=Lc[t];if(delete Lc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ac.add(t,n);for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=Lc[t],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=Lc[t];delete Lc[t];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=Lc[t];delete Lc[t];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}Lc[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Dc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Dc,load:function(t,e,n,r){var i=this,a=new Ic(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=kc.parse(t[n]);e.push(r)}return e}}),zc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:zc,load:function(t,e,n,r){var i=this,a=[],o=new Bl;o.image=a;var s=new Ic(this.manager);function l(l){s.load(t[l],(function(t){var n=i.parse(t,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=wt),o.format=n.format,o.needsUpdate=!0,e&&e(o))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=0,h=t.length;c<h;++c)l(c);else s.load(t,(function(t){var n=i.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=wt),o.format=n.format,o.needsUpdate=!0,e&&e(o)}),n,r);return o}}),Fc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Fc,load:function(t,e,n,r){var i=this,a=new Ca,o=new Ic(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,(function(t){var n=i.parse(t);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:mt,a.wrapT=void 0!==n.wrapT?n.wrapT:mt,a.magFilter=void 0!==n.magFilter?n.magFilter:wt,a.minFilter=void 0!==n.minFilter?n.minFilter:wt,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Mt),1===n.mipmapCount&&(a.minFilter=wt),a.needsUpdate=!0,e&&e(a,n))}),n,r),a}}),Bc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Bc,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Ac.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Ac.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o}}),Vc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Vc,load:function(t,e,n,r){var i=new Ya,a=new Bc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(t[n],(function(t){i.images[n]=t,6===++o&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var l=0;l<t.length;++l)s(l);return i}}),jc.prototype=Object.assign(Object.create(Rc.prototype),{constructor:jc,load:function(t,e,n,r){var i=new Wn,a=new Bc(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Vt:jt,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(Hc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=t;n++)a+=(e=this.getPoint(n/t)).distanceTo(i),r.push(a),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,a=r.length;n=e||t*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)},getTangent:function(t,e){var n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n),a=this.getPoint(r),o=e||(i.isVector2?new Hn:new Kn);return o.copy(a).sub(i).normalize(),o},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){var n,r,i,a=new Kn,o=[],s=[],l=[],u=new Kn,c=new sr;for(n=0;n<=t;n++)r=n/t,o[n]=this.getTangentAt(r,new Kn),o[n].normalize();s[0]=new Kn,l[0]=new Kn;var h=Number.MAX_VALUE,d=Math.abs(o[0].x),f=Math.abs(o[0].y),p=Math.abs(o[0].z);for(d<=h&&(h=d,a.set(1,0,0)),f<=h&&(h=f,a.set(0,1,0)),p<=h&&a.set(0,0,1),u.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],u),l[0].crossVectors(o[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(o[n-1],o[n]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(jn.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,i))),l[n].crossVectors(o[n],s[n]);if(!0===e)for(i=Math.acos(jn.clamp(s[0].dot(s[t]),-1,1)),i/=t,o[0].dot(u.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(c.makeRotationAxis(o[n],i*n)),l[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Uc.prototype=Object.create(Hc.prototype),Uc.prototype.constructor=Uc,Uc.prototype.isEllipseCurve=!0,Uc.prototype.getPoint=function(t,e){for(var n=e||new Hn,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)},Uc.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Uc.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Uc.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Gc.prototype=Object.create(Uc.prototype),Gc.prototype.constructor=Gc,Gc.prototype.isArcCurve=!0;var Wc=new Kn,$c=new qc,Yc=new qc,Qc=new qc;function Xc(t,e,n,r){Hc.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Zc(t,e,n,r,i){var a=.5*(r-e),o=.5*(i-n),s=t*t;return(2*n-2*r+a+o)*(t*s)+(-3*n+3*r-2*a-o)*s+a*t+n}function Jc(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Kc(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function th(t,e,n,r){Hc.call(this),this.type="CubicBezierCurve",this.v0=t||new Hn,this.v1=e||new Hn,this.v2=n||new Hn,this.v3=r||new Hn}function eh(t,e,n,r){Hc.call(this),this.type="CubicBezierCurve3",this.v0=t||new Kn,this.v1=e||new Kn,this.v2=n||new Kn,this.v3=r||new Kn}function nh(t,e){Hc.call(this),this.type="LineCurve",this.v1=t||new Hn,this.v2=e||new Hn}function rh(t,e){Hc.call(this),this.type="LineCurve3",this.v1=t||new Kn,this.v2=e||new Kn}function ih(t,e,n){Hc.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Hn,this.v1=e||new Hn,this.v2=n||new Hn}function ah(t,e,n){Hc.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Kn,this.v1=e||new Kn,this.v2=n||new Kn}function oh(t){Hc.call(this),this.type="SplineCurve",this.points=t||[]}Xc.prototype=Object.create(Hc.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isCatmullRomCurve3=!0,Xc.prototype.getPoint=function(t,e){var n,r,i,a,o=e||new Kn,s=this.points,l=s.length,u=(l-(this.closed?0:1))*t,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?n=s[(c-1)%l]:(Wc.subVectors(s[0],s[1]).add(s[0]),n=Wc),r=s[c%l],i=s[(c+1)%l],this.closed||c+2<l?a=s[(c+2)%l]:(Wc.subVectors(s[l-1],s[l-2]).add(s[l-1]),a=Wc),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),d),p=Math.pow(r.distanceToSquared(i),d),m=Math.pow(i.distanceToSquared(a),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),$c.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,f,p,m),Yc.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,f,p,m),Qc.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,f,p,m)}else"catmullrom"===this.curveType&&($c.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),Yc.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),Qc.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set($c.calc(h),Yc.calc(h),Qc.calc(h)),o},Xc.prototype.copy=function(t){Hc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Xc.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Xc.prototype.fromJSON=function(t){Hc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Kn).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},th.prototype=Object.create(Hc.prototype),th.prototype.constructor=th,th.prototype.isCubicBezierCurve=!0,th.prototype.getPoint=function(t,e){var n=e||new Hn,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Kc(t,r.x,i.x,a.x,o.x),Kc(t,r.y,i.y,a.y,o.y)),n},th.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},th.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},th.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},eh.prototype=Object.create(Hc.prototype),eh.prototype.constructor=eh,eh.prototype.isCubicBezierCurve3=!0,eh.prototype.getPoint=function(t,e){var n=e||new Kn,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Kc(t,r.x,i.x,a.x,o.x),Kc(t,r.y,i.y,a.y,o.y),Kc(t,r.z,i.z,a.z,o.z)),n},eh.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},eh.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},eh.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},nh.prototype=Object.create(Hc.prototype),nh.prototype.constructor=nh,nh.prototype.isLineCurve=!0,nh.prototype.getPoint=function(t,e){var n=e||new Hn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},nh.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},nh.prototype.getTangent=function(t,e){return(e||new Hn).copy(this.v2).sub(this.v1).normalize()},nh.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},nh.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},nh.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},rh.prototype=Object.create(Hc.prototype),rh.prototype.constructor=rh,rh.prototype.isLineCurve3=!0,rh.prototype.getPoint=function(t,e){var n=e||new Kn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},rh.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},rh.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},rh.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},rh.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ih.prototype=Object.create(Hc.prototype),ih.prototype.constructor=ih,ih.prototype.isQuadraticBezierCurve=!0,ih.prototype.getPoint=function(t,e){var n=e||new Hn,r=this.v0,i=this.v1,a=this.v2;return n.set(Jc(t,r.x,i.x,a.x),Jc(t,r.y,i.y,a.y)),n},ih.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ih.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ih.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ah.prototype=Object.create(Hc.prototype),ah.prototype.constructor=ah,ah.prototype.isQuadraticBezierCurve3=!0,ah.prototype.getPoint=function(t,e){var n=e||new Kn,r=this.v0,i=this.v1,a=this.v2;return n.set(Jc(t,r.x,i.x,a.x),Jc(t,r.y,i.y,a.y),Jc(t,r.z,i.z,a.z)),n},ah.prototype.copy=function(t){return Hc.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ah.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ah.prototype.fromJSON=function(t){return Hc.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},oh.prototype=Object.create(Hc.prototype),oh.prototype.constructor=oh,oh.prototype.isSplineCurve=!0,oh.prototype.getPoint=function(t,e){var n=e||new Hn,r=this.points,i=(r.length-1)*t,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Zc(o,s.x,l.x,u.x,c.x),Zc(o,s.y,l.y,u.y,c.y)),n},oh.prototype.copy=function(t){Hc.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},oh.prototype.toJSON=function(){var t=Hc.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},oh.prototype.fromJSON=function(t){Hc.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Hn).fromArray(r))}return this};var sh=Object.freeze({__proto__:null,ArcCurve:Gc,CatmullRomCurve3:Xc,CubicBezierCurve:th,CubicBezierCurve3:eh,EllipseCurve:Uc,LineCurve:nh,LineCurve3:rh,QuadraticBezierCurve:ih,QuadraticBezierCurve3:ah,SplineCurve:oh});function lh(){Hc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function uh(t){lh.call(this),this.type="Path",this.currentPoint=new Hn,t&&this.setFromPoints(t)}function ch(t){uh.call(this,t),this.uuid=jn.generateUUID(),this.type="Shape",this.holes=[]}function hh(t,e){Mr.call(this),this.type="Light",this.color=new gi(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function dh(t,e,n){hh.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.groundColor=new gi(e)}function fh(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Hn(512,512),this.map=null,this.mapPass=null,this.matrix=new sr,this._frustum=new Pa,this._frameExtents=new Hn(1,1),this._viewportCount=1,this._viewports=[new $n(0,0,1,1)]}function ph(){fh.call(this,new Sa(50,1,.5,500))}function mh(t,e,n,r,i,a){hh.call(this,t,e),this.type="SpotLight",this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.target=new Mr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new ph}function gh(){fh.call(this,new Sa(90,1,.5,500)),this._frameExtents=new Hn(4,2),this._viewportCount=6,this._viewports=[new $n(2,1,1,1),new $n(0,1,1,1),new $n(3,1,1,1),new $n(1,1,1,1),new $n(3,0,1,1),new $n(1,0,1,1)],this._cubeDirections=[new Kn(1,0,0),new Kn(-1,0,0),new Kn(0,0,1),new Kn(0,0,-1),new Kn(0,1,0),new Kn(0,-1,0)],this._cubeUps=[new Kn(0,1,0),new Kn(0,1,0),new Kn(0,1,0),new Kn(0,1,0),new Kn(0,0,1),new Kn(0,0,-1)]}function vh(t,e,n,r){hh.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new gh}function yh(t,e,n,r,i,a){wa.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function bh(){fh.call(this,new yh(-5,5,5,-5,.5,500))}function xh(t,e){hh.call(this,t,e),this.type="DirectionalLight",this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.target=new Mr,this.shadow=new bh}function _h(t,e){hh.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function wh(t,e,n,r){hh.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Sh(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Kn)}function Eh(t,e){hh.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new Sh}function Mh(t){Rc.call(this,t),this.textures={}}lh.prototype=Object.assign(Object.create(Hc.prototype),{constructor:lh,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new nh(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Hc.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Hc.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){Hc.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new sh[r.type]).fromJSON(r))}return this}}),uh.prototype=Object.assign(Object.create(lh.prototype),{constructor:uh,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new nh(this.currentPoint.clone(),new Hn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new ih(this.currentPoint.clone(),new Hn(t,e),new Hn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,a){var o=new th(this.currentPoint.clone(),new Hn(t,e),new Hn(n,r),new Hn(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this},splineThru:function(t){var e=new oh([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,n,r,i,a),this},absarc:function(t,e,n,r,i,a){return this.absellipse(t,e,n,n,r,i,a),this},ellipse:function(t,e,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,n,r,i,a,o,s),this},absellipse:function(t,e,n,r,i,a,o,s){var l=new Uc(t,e,n,r,i,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this},copy:function(t){return lh.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=lh.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return lh.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ch.prototype=Object.assign(Object.create(uh.prototype),{constructor:ch,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){uh.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=uh.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){uh.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new uh).fromJSON(r))}return this}}),hh.prototype=Object.assign(Object.create(Mr.prototype),{constructor:hh,isLight:!0,copy:function(t){return Mr.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Mr.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),dh.prototype=Object.assign(Object.create(hh.prototype),{constructor:dh,isHemisphereLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(fh.prototype,{_projScreenMatrix:new sr,_lightPositionWorld:new Kn,_lookTarget:new Kn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ph.prototype=Object.assign(Object.create(fh.prototype),{constructor:ph,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*jn.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),fh.prototype.updateMatrices.call(this,t)}}),mh.prototype=Object.assign(Object.create(hh.prototype),{constructor:mh,isSpotLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),gh.prototype=Object.assign(Object.create(fh.prototype),{constructor:gh,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),a.copy(n.position),a.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),vh.prototype=Object.assign(Object.create(hh.prototype),{constructor:vh,isPointLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),yh.prototype=Object.assign(Object.create(wa.prototype),{constructor:yh,isOrthographicCamera:!0,copy:function(t,e){return wa.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,a=n+t,o=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Mr.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),bh.prototype=Object.assign(Object.create(fh.prototype),{constructor:bh,isDirectionalLightShadow:!0,updateMatrices:function(t){fh.prototype.updateMatrices.call(this,t)}}),xh.prototype=Object.assign(Object.create(hh.prototype),{constructor:xh,isDirectionalLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),_h.prototype=Object.assign(Object.create(hh.prototype),{constructor:_h,isAmbientLight:!0}),wh.prototype=Object.assign(Object.create(hh.prototype),{constructor:wh,isRectAreaLight:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=hh.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(Sh.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScaledVector(a[1],.488603*r),e.addScaledVector(a[2],.488603*i),e.addScaledVector(a[3],.488603*n),e.addScaledVector(a[4],n*r*1.092548),e.addScaledVector(a[5],r*i*1.092548),e.addScaledVector(a[6],.315392*(3*i*i-1)),e.addScaledVector(a[7],n*i*1.092548),e.addScaledVector(a[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScaledVector(a[1],1.023328*r),e.addScaledVector(a[2],1.023328*i),e.addScaledVector(a[3],1.023328*n),e.addScaledVector(a[4],.858086*n*r),e.addScaledVector(a[5],.858086*r*i),e.addScaledVector(a[6],.743125*i*i-.247708),e.addScaledVector(a[7],.858086*n*i),e.addScaledVector(a[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(Sh,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),Eh.prototype=Object.assign(Object.create(hh.prototype),{constructor:Eh,isLightProbe:!0,copy:function(t){return hh.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){var e=hh.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),Mh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Mh,load:function(t,e,n,r){var i=this,a=new Ic(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new pc[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new gi).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var a=t.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new gi).setHex(a.value);break;case"v2":r.uniforms[i].value=(new Hn).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new Kn).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new $n).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new Un).fromArray(a.value);case"m4":r.uniforms[i].value=(new sr).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)r.extensions[o]=t.extensions[o];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Hn).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Hn).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var Ch={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function Th(){Gi.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function kh(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Mi.call(this,t,e,n),this.meshPerAttribute=r||1}function Ph(t){Rc.call(this,t)}Th.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Th,isInstancedBufferGeometry:!0,copy:function(t){return Gi.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Gi.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),kh.prototype=Object.assign(Object.create(Mi.prototype),{constructor:kh,isInstancedBufferAttribute:!0,copy:function(t){return Mi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Mi.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Ph.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Ph,load:function(t,e,n,r){var i=this,a=new Ic(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new Th:new Gi,n=t.data.index;if(void 0!==n){var r=new Ah[n.type](n.array);e.setIndex(new Mi(r,1))}var i=t.data.attributes;for(var a in i){var o=i[a],s=(r=new Ah[o.type](o.array),new(o.isInstancedBufferAttribute?kh:Mi)(r,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),e.setAttribute(a,s)}var l=t.data.morphAttributes;if(l)for(var a in l){for(var u=l[a],c=[],h=0,d=u.length;h<d;h++){o=u[h],s=new Mi(r=new Ah[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),c.push(s)}e.morphAttributes[a]=c}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var f=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==f){h=0;for(var p=f.length;h!==p;++h){var m=f[h];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new Kn;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new Ur(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var Ah={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Oh(t){Rc.call(this,t)}Oh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Oh,load:function(t,e,n,r){var i=this,a=""===this.path?Ch.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;var o=new Ic(i.manager);o.setPath(this.path),o.load(t,(function(n){var a=null;try{a=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),a=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,r,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new ch).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Ph,i=0,a=t.length;i<a;i++){var o,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new rc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new rc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new rc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new rc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new rc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new rc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new rc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new rc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new rc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new rc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new rc[s.type]((new sh[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new rc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new rc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],u=0,c=s.shapes.length;u<c;u++){var h=e[s.shapes[u]];l.push(h)}o=new rc[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],u=0,c=s.shapes.length;u<c;u++){h=e[s.shapes[u]];l.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new sh[d.type]).fromJSON(d)),o=new rc[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new Mh;i.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),l.push(n[c.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=kc.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),a.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var a=new Bc(new Oc(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var l=t[o],u=l.url;if(Array.isArray(u)){r[l.uuid]=[];for(var c=0,h=u.length;c<h;c++){var d=u[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;r[l.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.resourcePath+l.url;r[l.uuid]=i(f)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o,s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(e[s.image])?new Ya(e[s.image]):new Wn(e[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,Rh)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Lh),o.wrapT=n(s.wrap[1],Lh)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,Ih)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,Ih)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(n[a])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new Cr,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new gi(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Ds(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new Is(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new Sa(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new yh(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new _h(t.color,t.intensity);break;case"DirectionalLight":r=new xh(t.color,t.intensity);break;case"PointLight":r=new vh(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new wh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new mh(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new dh(t.color,t.groundColor,t.intensity);break;case"LightProbe":r=(new Eh).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=new la(o=i(t.geometry),s=a(t.material));break;case"InstancedMesh":var o=i(t.geometry),s=a(t.material),l=t.count,u=t.instanceMatrix;(r=new bl(o,s,l)).instanceMatrix=new Mi(new Float32Array(u.array),16);break;case"LOD":r=new ul;break;case"Line":r=new Cl(i(t.geometry),a(t.material),t.mode);break;case"LineLoop":r=new Al(i(t.geometry),a(t.material));break;case"LineSegments":r=new Pl(i(t.geometry),a(t.material));break;case"PointCloud":case"Points":r=new Dl(i(t.geometry),a(t.material));break;case"Sprite":r=new tl(a(t.material));break;case"Group":r=new Os;break;default:r=new Mr}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var c=t.children,h=0;h<c.length;h++)r.add(this.parseObject(c[h],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var d=t.levels,f=0;f<d.length;f++){var p=d[f],m=r.getObjectByProperty("uuid",p.object);void 0!==m&&r.addLevel(m,p.distance)}}return r}});var Nh,Rh={UVMapping:ot,CubeReflectionMapping:st,CubeRefractionMapping:lt,EquirectangularReflectionMapping:ut,EquirectangularRefractionMapping:ct,SphericalReflectionMapping:ht,CubeUVReflectionMapping:dt,CubeUVRefractionMapping:ft},Lh={RepeatWrapping:pt,ClampToEdgeWrapping:mt,MirroredRepeatWrapping:gt},Ih={NearestFilter:vt,NearestMipmapNearestFilter:yt,NearestMipmapLinearFilter:xt,LinearFilter:wt,LinearMipmapNearestFilter:St,LinearMipmapLinearFilter:Mt};function Dh(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Rc.call(this,t),this.options=void 0}function zh(){this.type="ShapePath",this.color=new gi,this.subPaths=[],this.currentPath=null}function Fh(t){this.type="Font",this.data=t}function Bh(t,e,n,r,i){var a=i.glyphs[t]||i.glyphs["?"];if(a){var o,s,l,u,c,h,d,f,p=new zh;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*e+n,s=m[g++]*e+r,p.moveTo(o,s);break;case"l":o=m[g++]*e+n,s=m[g++]*e+r,p.lineTo(o,s);break;case"q":l=m[g++]*e+n,u=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,p.quadraticCurveTo(c,h,l,u);break;case"b":l=m[g++]*e+n,u=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,d=m[g++]*e+n,f=m[g++]*e+r,p.bezierCurveTo(c,h,d,f,l,u)}}return{offsetX:a.ha*e,path:p}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}function Vh(t){Rc.call(this,t)}Dh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Dh,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Ac.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){Ac.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(zh.prototype,{moveTo:function(t,e){return this.currentPath=new uh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,a){return this.currentPath.bezierCurveTo(t,e,n,r,i,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],a=new ch;a.curves=i.curves,e.push(a)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=e[i],s=e[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=e[a],l=-l,s=e[i],u=-u),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var c=u*(t.x-o.x)-l*(t.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return r}var i=Nu.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return n(a);var o,s,l,u=[];if(1===a.length)return s=a[0],(l=new ch).curves=s.curves,u.push(l),u;var c=!i(a[0].getPoints());c=t?!c:c;var h,d,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=i(h=(s=a[v]).getPoints()),(o=t?!o:o)?(!c&&p[g]&&g++,p[g]={s:new ch,p:h},p[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!p[0])return n(a);if(p.length>1){for(var b=!1,x=[],_=0,w=p.length;_<w;_++)f[_]=[];for(_=0,w=p.length;_<w;_++)for(var S=m[_],E=0;E<S.length;E++){for(var M=S[E],C=!0,T=0;T<p.length;T++)r(M.p,p[T].p)&&(_!==T&&x.push({froms:_,tos:T,hole:E}),C?(C=!1,f[T].push(M)):b=!0);C&&f[_].push(M)}x.length>0&&(b||(m=f))}v=0;for(var k=p.length;v<k;v++){l=p[v].s,u.push(l);for(var P=0,A=(d=m[v]).length;P<A;P++)l.holes.push(d[P].h)}return u}}),Object.assign(Fh.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,l=0,u=0;u<r.length;u++){var c=r[u];if("\n"===c)s=0,l-=a;else{var h=Bh(c,i,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}(t,e,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Vh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Vh,load:function(t,e,n,r){var i=this,a=new Ic(this.manager);a.setPath(this.path),a.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new Fh(t)}});var jh={getContext:function(){return void 0===Nh&&(Nh=new(window.AudioContext||window.webkitAudioContext)),Nh},setContext:function(t){Nh=t}};function Hh(t){Rc.call(this,t)}function Uh(t,e,n){Eh.call(this,void 0,n);var r=(new gi).set(t),i=(new gi).set(e),a=new Kn(r.r,r.g,r.b),o=new Kn(i.r,i.g,i.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function Gh(t,e){Eh.call(this,void 0,e);var n=(new gi).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Hh.prototype=Object.assign(Object.create(Rc.prototype),{constructor:Hh,load:function(t,e,n,r){var i=new Ic(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);jh.getContext().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Uh.prototype=Object.assign(Object.create(Eh.prototype),{constructor:Uh,isHemisphereLightProbe:!0,copy:function(t){return Eh.prototype.copy.call(this,t),this},toJSON:function(t){return Eh.prototype.toJSON.call(this,t)}}),Gh.prototype=Object.assign(Object.create(Eh.prototype),{constructor:Gh,isAmbientLightProbe:!0,copy:function(t){return Eh.prototype.copy.call(this,t),this},toJSON:function(t){return Eh.prototype.toJSON.call(this,t)}});var qh=new sr,Wh=new sr;function $h(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Sa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Sa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Yh(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign($h.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),a=e.eyeSep/2,o=a*e.near/e.focus,s=e.near*Math.tan(jn.DEG2RAD*e.fov*.5)/e.zoom;Wh.elements[12]=-a,qh.elements[12]=a,n=-s*e.aspect+o,r=s*e.aspect+o,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-o,r=s*e.aspect-o,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Wh),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(qh)}}),Object.assign(Yh.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Qh=new Kn,Xh=new Xn,Zh=new Kn,Jh=new Kn;function Kh(){Mr.call(this),this.type="AudioListener",this.context=jh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Yh}function td(t){Mr.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Kh.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Kh,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Mr.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Qh,Xh,Zh),Jh.set(0,0,-1).applyQuaternion(Xh),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Qh.x,r),e.positionY.linearRampToValueAtTime(Qh.y,r),e.positionZ.linearRampToValueAtTime(Qh.z,r),e.forwardX.linearRampToValueAtTime(Jh.x,r),e.forwardY.linearRampToValueAtTime(Jh.y,r),e.forwardZ.linearRampToValueAtTime(Jh.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Qh.x,Qh.y,Qh.z),e.setOrientation(Jh.x,Jh.y,Jh.z,n.x,n.y,n.z)}}),td.prototype=Object.assign(Object.create(Mr.prototype),{constructor:td,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var ed=new Kn,nd=new Xn,rd=new Kn,id=new Kn;function ad(t){td.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function od(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function sd(t,e,n){var r,i,a;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}ad.prototype=Object.assign(Object.create(td.prototype),{constructor:ad,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Mr.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(ed,nd,rd),id.set(0,0,1).applyQuaternion(nd);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(ed.x,n),e.positionY.linearRampToValueAtTime(ed.y,n),e.positionZ.linearRampToValueAtTime(ed.z,n),e.orientationX.linearRampToValueAtTime(id.x,n),e.orientationY.linearRampToValueAtTime(id.y,n),e.orientationZ.linearRampToValueAtTime(id.z,n)}else e.setPosition(ed.x,ed.y,ed.z),e.setOrientation(id.x,id.y,id.z)}}}),Object.assign(od.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(sd.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},accumulateAdditive:function(t){var e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=e*this._origIndex;this._mixBufferRegion(n,r,s,1-i,e)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(var l=e,u=e+e;l!==u;++l)if(n[l]!==n[l+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(var i=n,a=r;i!==a;++i)e[i]=e[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){var t=this._addIndex*this.valueSize;this.buffer.fill(0,t,t+this.valueSize)},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;this.buffer.copyWithin(e,t,this.valueSize)},_select:function(t,e,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,r){Xn.slerpFlat(t,e,t,e,t,n,r)},_slerpAdditive:function(t,e,n,r,i){var a=this._workIndex*i;Xn.multiplyQuaternionsFlat(t,a,t,e,t,n),Xn.slerpFlat(t,e,t,e,t,a,r)},_lerp:function(t,e,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*r}},_lerpAdditive:function(t,e,n,r,i){for(var a=0;a!==i;++a){var o=e+a;t[o]=t[o]+t[n+a]*r}}});var ld=new RegExp("[\\[\\]\\.:\\/]","g"),ud="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",cd=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),hd=/(WCOD+)?/.source.replace("WCOD",ud),dd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),fd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),pd=new RegExp("^"+cd+hd+dd+fd+"$"),md=["material","materials","bones"];function gd(t,e,n){var r=n||vd.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function vd(t,e,n){this.path=e,this.parsedPath=n||vd.parseTrackName(e),this.node=vd.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function yd(){this.uuid=jn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function bd(t,e,n,r){this._mixer=t,this._clip=e,this._localRoot=n||null,this.blendMode=r||e.blendMode;for(var i=e.tracks,a=i.length,o=new Array(a),s={endingStart:qe,endingEnd:qe},l=0;l!==a;++l){var u=i[l].createInterpolant(null);o[l]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ve,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function xd(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function _d(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function wd(t,e,n){zs.call(this,t,e),this.meshPerAttribute=n||1}function Sd(t,e,n,r){this.ray=new Zr(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new hr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ed(t,e){return t.distance-e.distance}function Md(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r)for(var i=t.children,a=0,o=i.length;a<o;a++)Md(i[a],e,n,!0)}function Cd(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Td(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}Object.assign(gd.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(vd,{Composite:gd,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new vd.Composite(t,e,n):new vd(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(ld,"")},parseTrackName:function(t){var e=pd.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==md.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var a=r(i.children);if(a)return a}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(vd.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=vd.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[r];if(void 0!==s){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(vd.prototype,{_getValue_unbound:vd.prototype.getValue,_setValue_unbound:vd.prototype.setValue}),Object.assign(yd.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=r[d];if(void 0===f){f=e++,r[d]=f,t.push(h);for(var p=0,m=s;p!==m;++p)o[p].push(new vd(h,i[p],a[p]))}else if(f<n){l=t[f];var g=--n,v=t[g];r[v.uuid]=f,t[f]=v,r[d]=g,t[g]=h;for(p=0,m=s;p!==m;++p){var y=o[p],b=y[g],x=y[f];y[f]=b,void 0===x&&(x=new vd(h,i[p],a[p])),y[g]=x}}else t[f]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=n[l];if(void 0!==u&&u>=e){var c=e++,h=t[c];n[h.uuid]=u,t[u]=h,n[l]=c,t[c]=s;for(var d=0,f=i;d!==f;++d){var p=r[d],m=p[c],g=p[u];p[u]=m,p[c]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],u=l.uuid,c=r[u];if(void 0!==c)if(delete r[u],c<n){var h=--n,d=t[h],f=t[y=--e];r[d.uuid]=c,t[c]=d,r[f.uuid]=h,t[h]=f,t.pop();for(var p=0,m=a;p!==m;++p){var g=(b=i[p])[h],v=b[y];b[c]=g,b[h]=v,b.pop()}}else{var y;r[(f=t[y=--e]).uuid]=c,t[c]=f,t.pop();for(p=0,m=a;p!==m;++p){var b;(b=i[p])[c]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[t]=r,a.push(t),o.push(e),i.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new vd(f,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(bd.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,a=i/r,o=r/i;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=i,s[1]=i+n,l[0]=t/o,l[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(t-i)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0){var l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case Qe:for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);break;case Ye:default:for(c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(r,s)}}}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,a=r===je;if(0===t)return-1===i?e:a&&1==(1&i)?n-e:e;if(r===Be){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var l=t<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(a&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=We,r.endingEnd=We):(r.endingStart=t?this.zeroSlopeAtStart?We:qe:$e,r.endingEnd=e?this.zeroSlopeAtEnd?We:qe:$e)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=e,o[1]=i+t,s[1]=n,this}}),xd.prototype=Object.assign(Object.create(zn.prototype),{constructor:xd,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=r[c],d=h.name,f=u[d];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=e&&e._propertyBindings[c].binding.parsedPath;++(f=new sd(vd.create(n,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),a[c]=f}o[c].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,a=i[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],a=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new yc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){var r=e||this._root,i=r.uuid,a="string"==typeof t?kc.findByName(r,t):t,o=null!==a?a.uuid:t,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:Ye),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new bd(this,a,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?kc.findByName(n,t):t,a=i?i.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(r,t,i,a)}var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,e[u]=c,e.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),_d.prototype.clone=function(){return new _d(void 0===this.value.clone?this.value:this.value.clone())},wd.prototype=Object.assign(Object.create(zs.prototype),{constructor:wd,isInstancedInterleavedBuffer:!0,copy:function(t){return zs.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Sd.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return Md(t,this,r,e),r.sort(Ed),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=t.length;i<a;i++)Md(t[i],this,r,e);return r.sort(Ed),r}}),Object.assign(Cd.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(jn.clamp(e/this.radius,-1,1))),this}}),Object.assign(Td.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var kd=new Hn;function Pd(t,e){this.min=void 0!==t?t:new Hn(1/0,1/0),this.max=void 0!==e?e:new Hn(-1/0,-1/0)}Object.assign(Pd.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=kd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Hn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Hn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Hn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Hn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return kd.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ad=new Kn,Od=new Kn;function Nd(t,e){this.start=void 0!==t?t:new Kn,this.end=void 0!==e?e:new Kn}function Rd(t){Mr.call(this),this.material=t,this.render=function(){}}Object.assign(Nd.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Kn),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Kn),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Kn),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){Ad.subVectors(t,this.start),Od.subVectors(this.end,this.start);var n=Od.dot(Od),r=Od.dot(Ad)/n;return e&&(r=jn.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Kn),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Rd.prototype=Object.create(Mr.prototype),Rd.prototype.constructor=Rd,Rd.prototype.isImmediateRenderObject=!0;var Ld=new Kn;function Id(t,e){Mr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Gi,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new Ri(r,3));var l=new xl({fog:!1,toneMapped:!1});this.cone=new Pl(n,l),this.add(this.cone),this.update()}Id.prototype=Object.create(Mr.prototype),Id.prototype.constructor=Id,Id.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Id.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Ld.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ld),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Dd=new Kn,zd=new sr,Fd=new sr;function Bd(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new Gi,r=[],i=[],a=new gi(0,0,1),o=new gi(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new Ri(r,3)),n.setAttribute("color",new Ri(i,3));var u=new xl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Pl.call(this,n,u),this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Vd(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new Hu(e,4,2),i=new Si({wireframe:!0,fog:!1,toneMapped:!1});la.call(this,r,i),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Bd.prototype=Object.create(Pl.prototype),Bd.prototype.constructor=Bd,Bd.prototype.isSkeletonHelper=!0,Bd.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");Fd.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<e.length;i++){var o=e[i];o.parent&&o.parent.isBone&&(zd.multiplyMatrices(Fd,o.matrixWorld),Dd.setFromMatrixPosition(zd),r.setXYZ(a,Dd.x,Dd.y,Dd.z),zd.multiplyMatrices(Fd,o.parent.matrixWorld),Dd.setFromMatrixPosition(zd),r.setXYZ(a+1,Dd.x,Dd.y,Dd.z),a+=2)}n.getAttribute("position").needsUpdate=!0,Mr.prototype.updateMatrixWorld.call(this,t)},Vd.prototype=Object.create(la.prototype),Vd.prototype.constructor=Vd,Vd.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Vd.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var jd=new Kn,Hd=new gi,Ud=new gi;function Gd(t,e,n){Mr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Xl(e);r.rotateY(.5*Math.PI),this.material=new Si({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new Mi(a,3)),this.add(new la(r,this.material)),this.update()}function qd(t,e,n,r){t=t||10,e=e||10,n=new gi(void 0!==n?n:4473924),r=new gi(void 0!==r?r:8947848);for(var i=e/2,a=t/e,o=t/2,s=[],l=[],u=0,c=0,h=-o;u<=e;u++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=u===i?n:r;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var f=new Gi;f.setAttribute("position",new Ri(s,3)),f.setAttribute("color",new Ri(l,3));var p=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,f,p),this.type="GridHelper"}function Wd(t,e,n,r,i,a){t=t||10,e=e||16,n=n||8,r=r||64,i=new gi(void 0!==i?i:4473924),a=new gi(void 0!==a?a:8947848);var o,s,l,u,c,h,d,f=[],p=[];for(u=0;u<=e;u++)l=u/e*(2*Math.PI),o=Math.sin(l)*t,s=Math.cos(l)*t,f.push(0,0,0),f.push(o,0,s),d=1&u?i:a,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?i:a,h=t-t/n*u,c=0;c<r;c++)l=c/r*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b),l=(c+1)/r*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b);var m=new Gi;m.setAttribute("position",new Ri(f,3)),m.setAttribute("color",new Ri(p,3));var g=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,m,g),this.type="PolarGridHelper"}Gd.prototype=Object.create(Mr.prototype),Gd.prototype.constructor=Gd,Gd.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Gd.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Hd.copy(this.light.color),Ud.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?Hd:Ud;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(jd.setFromMatrixPosition(this.light.matrixWorld).negate())},qd.prototype=Object.assign(Object.create(Pl.prototype),{constructor:qd,copy:function(t){return Pl.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),Wd.prototype=Object.create(Pl.prototype),Wd.prototype.constructor=Wd;var $d=new Kn,Yd=new Kn,Qd=new Kn;function Xd(t,e,n){Mr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Gi;r.setAttribute("position",new Ri([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new xl({fog:!1,toneMapped:!1});this.lightPlane=new Cl(r,i),this.add(this.lightPlane),(r=new Gi).setAttribute("position",new Ri([0,0,0,0,0,1],3)),this.targetLine=new Cl(r,i),this.add(this.targetLine),this.update()}Xd.prototype=Object.create(Mr.prototype),Xd.prototype.constructor=Xd,Xd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Xd.prototype.update=function(){$d.setFromMatrixPosition(this.light.matrixWorld),Yd.setFromMatrixPosition(this.light.target.matrixWorld),Qd.subVectors(Yd,$d),this.lightPlane.lookAt(Yd),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Yd),this.targetLine.scale.z=Qd.length()};var Zd=new Kn,Jd=new wa;function Kd(t){var e=new Gi,n=new xl({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={},o=new gi(16755200),s=new gi(16711680),l=new gi(43775),u=new gi(16777215),c=new gi(3355443);function h(t,e,n){d(t,n),d(e,n)}function d(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.setAttribute("position",new Ri(r,3)),e.setAttribute("color",new Ri(i,3)),Pl.call(this,e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function tf(t,e,n,r,i,a,o){Zd.set(i,a,o).unproject(r);var s=e[t];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Zd.x,Zd.y,Zd.z)}Kd.prototype=Object.create(Pl.prototype),Kd.prototype.constructor=Kd,Kd.prototype.update=function(){var t=this.geometry,e=this.pointMap;Jd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),tf("c",e,t,Jd,0,0,-1),tf("t",e,t,Jd,0,0,1),tf("n1",e,t,Jd,-1,-1,-1),tf("n2",e,t,Jd,1,-1,-1),tf("n3",e,t,Jd,-1,1,-1),tf("n4",e,t,Jd,1,1,-1),tf("f1",e,t,Jd,-1,-1,1),tf("f2",e,t,Jd,1,-1,1),tf("f3",e,t,Jd,-1,1,1),tf("f4",e,t,Jd,1,1,1),tf("u1",e,t,Jd,.7,1.1,-1),tf("u2",e,t,Jd,-.7,1.1,-1),tf("u3",e,t,Jd,0,2,-1),tf("cf1",e,t,Jd,-1,0,1),tf("cf2",e,t,Jd,1,0,1),tf("cf3",e,t,Jd,0,-1,1),tf("cf4",e,t,Jd,0,1,1),tf("cn1",e,t,Jd,-1,0,-1),tf("cn2",e,t,Jd,1,0,-1),tf("cn3",e,t,Jd,0,-1,-1),tf("cn4",e,t,Jd,0,1,-1),t.getAttribute("position").needsUpdate=!0};var ef=new Vr;function nf(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Gi;i.setIndex(new Mi(n,1)),i.setAttribute("position",new Mi(r,3)),Pl.call(this,i,new xl({color:e,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function rf(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Gi;r.setIndex(new Mi(n,1)),r.setAttribute("position",new Ri([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Pl.call(this,r,new xl({color:e,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function af(t,e,n){this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Gi;i.setAttribute("position",new Ri([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Cl.call(this,i,new xl({color:r,toneMapped:!1})),this.type="PlaneHelper";var a=new Gi;a.setAttribute("position",new Ri([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new la(a,new Si({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}nf.prototype=Object.create(Pl.prototype),nf.prototype.constructor=nf,nf.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ef.setFromObject(this.object),!ef.isEmpty()){var e=ef.min,n=ef.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},nf.prototype.setFromObject=function(t){return this.object=t,this.update(),this},nf.prototype.copy=function(t){return Pl.prototype.copy.call(this,t),this.object=t.object,this},nf.prototype.clone=function(){return(new this.constructor).copy(this)},rf.prototype=Object.create(Pl.prototype),rf.prototype.constructor=rf,rf.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Mr.prototype.updateMatrixWorld.call(this,t))},af.prototype=Object.create(Cl.prototype),af.prototype.constructor=af,af.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?v:g,this.lookAt(this.plane.normal),Mr.prototype.updateMatrixWorld.call(this,t)};var of,sf,lf=new Kn;function uf(t,e,n,r,i,a){Mr.call(this),this.type="ArrowHelper",void 0===t&&(t=new Kn(0,0,1)),void 0===e&&(e=new Kn(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===of&&((of=new Gi).setAttribute("position",new Ri([0,0,0,0,1,0],3)),(sf=new Ju(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Cl(of,new xl({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new la(sf,new Si({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,a)}function cf(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Gi;n.setAttribute("position",new Ri(e,3)),n.setAttribute("color",new Ri([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new xl({vertexColors:!0,toneMapped:!1});Pl.call(this,n,r),this.type="AxesHelper"}uf.prototype=Object.create(Mr.prototype),uf.prototype.constructor=uf,uf.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{lf.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(lf,e)}},uf.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},uf.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},uf.prototype.copy=function(t){return Mr.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},uf.prototype.clone=function(){return(new this.constructor).copy(this)},cf.prototype=Object.create(Pl.prototype),cf.prototype.constructor=cf;var hf=Math.pow(2,8),df=[.125,.215,.35,.446,.526,.582],ff=5+df.length,pf={[Ke]:0,[tn]:1,[nn]:2,[an]:3,[on]:4,[sn]:5,[en]:6},mf=new yh,{_lodPlanes:gf,_sizeLods:vf,_sigmas:yf}=function(){for(var t=[],e=[],n=[],r=8,i=0;i<ff;i++){var a=Math.pow(2,r);e.push(a);var o=1/a;i>4?o=df[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=new Float32Array(108),d=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,g=p>2?0:-1,v=[m,g,0,m+2/3,g,0,m+2/3,g+1,0,m,g,0,m+2/3,g+1,0,m,g+1,0];h.set(v,18*p),d.set(c,12*p);var y=[p,p,p,p,p,p];f.set(y,6*p)}var b=new Gi;b.setAttribute("position",new Mi(h,3)),b.setAttribute("uv",new Mi(d,2)),b.setAttribute("faceIndex",new Mi(f,1)),t.push(b),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),bf=null,xf=(1+Math.sqrt(5))/2,_f=1/xf,wf=[new Kn(1,1,1),new Kn(-1,1,1),new Kn(1,1,-1),new Kn(-1,1,-1),new Kn(0,xf,_f),new Kn(0,xf,-_f),new Kn(_f,0,xf),new Kn(-_f,0,xf),new Kn(xf,_f,0),new Kn(-xf,_f,0)];function Sf(t){var e,n,r,i;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(e=20,n=new Float32Array(e),r=new Kn(0,1,0),(i=new ac({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${Af()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",i),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function Ef(t){return void 0!==t&&t.type===Tt&&(t.encoding===Ke||t.encoding===tn||t.encoding===en)}function Mf(t){var e=new Yn(3*hf,3*hf,t);return e.texture.mapping=dt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Cf(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Tf(){var t=new ac({uniforms:{envMap:{value:null},texelSize:{value:new Hn(1,1)},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${Af()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function kf(){var t=new ac({uniforms:{envMap:{value:null},inputEncoding:{value:pf[Ke]},outputEncoding:{value:pf[Ke]}},vertexShader:Pf(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${Af()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function Pf(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function Af(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function Of(t,e,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new xi(t,e,n,i,a,o)}Sf.prototype={constructor:Sf,fromScene:function(t,e=0,n=.1,r=100){bf=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},fromEquirectangular:function(t){return t.magFilter=vt,t.minFilter=vt,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){bf=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=kf(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Tf(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<gf.length;t++)gf[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(bf),t.scissorTest=!1,t.setSize(t.width,t.height)},_allocateTargets:function(t){var e={magFilter:vt,minFilter:vt,generateMipmaps:!1,type:Tt,format:Gt,encoding:Ef(t)?t.encoding:nn,depthBuffer:!1,stencilBuffer:!1},n=Mf(e);return n.depthBuffer=!t,this._pingPongRenderTarget=Mf(e),n},_compileMaterial:function(t){var e=new Cr;e.add(new la(gf[0],t)),this._renderer.compile(e,mf)},_sceneToCubeUV:function(t,e,n,r){var i=new Sa(90,1,e,n),a=[1,1,1,1,-1,1],o=[1,1,-1,-1,-1,1],s=this._renderer,l=s.outputEncoding,u=s.toneMapping,c=s.toneMappingExposure,h=s.getClearColor(),d=s.getClearAlpha();s.toneMapping=et,s.toneMappingExposure=1,s.outputEncoding=Ke,t.scale.z*=-1;var f=t.background;if(f&&f.isColor){f.convertSRGBToLinear();var p=Math.max(f.r,f.g,f.b),m=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);f=f.multiplyScalar(Math.pow(2,-m));var g=(m+128)/255;s.setClearColor(f,g),t.background=null}for(var v=0;v<6;v++){var y=v%3;0==y?(i.up.set(0,a[v],0),i.lookAt(o[v],0,0)):1==y?(i.up.set(0,0,a[v]),i.lookAt(0,o[v],0)):(i.up.set(0,a[v],0),i.lookAt(0,0,o[v])),Cf(r,y*hf,v>2?hf:0,hf,hf),s.setRenderTarget(r),s.render(t,i)}s.toneMapping=u,s.toneMappingExposure=c,s.outputEncoding=l,s.setClearColor(h,d),t.scale.z*=-1},_textureToCubeUV:function(t,e){var n=new Cr,r=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=kf()):null==this._equirectShader&&(this._equirectShader=Tf());var i=t.isCubeTexture?this._cubemapShader:this._equirectShader;n.add(new la(gf[0],i));var a=i.uniforms;a.envMap.value=t,t.isCubeTexture||a.texelSize.value.set(1/t.image.width,1/t.image.height),a.inputEncoding.value=pf[t.encoding],a.outputEncoding.value=pf[e.texture.encoding],Cf(e,0,0,3*hf,2*hf),r.setRenderTarget(e),r.render(n,mf)},_applyPMREM:function(t){var e=this._renderer,n=e.autoClear;e.autoClear=!1;for(var r=1;r<ff;r++){var i=Math.sqrt(yf[r]*yf[r]-yf[r-1]*yf[r-1]),a=wf[(r-1)%wf.length];this._blur(t,r-1,r,i,a)}e.autoClear=n},_blur:function(t,e,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,r,"latitudinal",i),this._halfBlur(a,t,n,n,r,"longitudinal",i)},_halfBlur:function(t,e,n,r,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Cr;u.add(new la(gf[r],l));var c=l.uniforms,h=vf[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):20;p>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);for(var m=[],g=0,v=0;v<20;++v){var y=v/f,b=Math.exp(-y*y/2);m.push(b),0==v?g+=b:v<p&&(g+=2*b)}for(v=0;v<m.length;v++)m[v]=m[v]/g;c.envMap.value=t.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=pf[t.texture.encoding],c.outputEncoding.value=pf[t.texture.encoding];var x=vf[r];Cf(e,y=3*Math.max(0,hf-2*x),(0===r?0:2*hf)+2*x*(r>4?r-8+4:0),3*x,2*x),s.setRenderTarget(e),s.render(u,mf)}};var Nf=0,Rf=1,Lf=0,If=1,Df=2;function zf(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Ff(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Bf(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Dl(t,e)}function Vf(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new tl(t)}function jf(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Dl(t,e)}function Hf(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function Uf(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function Gf(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ol(t)}function qf(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Kn(t,e,n)}function Wf(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Mi(t,e).setUsage(Pn)}function $f(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Ci(t,e)}function Yf(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ti(t,e)}function Qf(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ki(t,e)}function Xf(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Pi(t,e)}function Zf(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ai(t,e)}function Jf(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Oi(t,e)}function Kf(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ni(t,e)}function tp(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ri(t,e)}function ep(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Li(t,e)}function np(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom",this.closed=!0}function rp(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom"}function ip(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,t),this.type="catmullrom"}function ap(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new cf(t)}function op(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new nf(t,e)}function sp(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Pl(new Xu(t.geometry),new xl({color:void 0!==e?e:16777215}))}function lp(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Pl(new Hl(t.geometry),new xl({color:void 0!==e?e:16777215}))}function up(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ic(t)}function cp(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Fc(t)}function hp(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ma(t,n)}Hc.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Hc.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(lh.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ma,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new Kn(i.x,i.y,i.z||0))}return e}}),Object.assign(uh.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),np.prototype=Object.create(Xc.prototype),rp.prototype=Object.create(Xc.prototype),ip.prototype=Object.create(Xc.prototype),Object.assign(ip.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),qd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Bd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Rc.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ch.extractUrlBase(t)}}),Rc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Oh.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Pd.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Vr.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Ur.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Pa.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Nd.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(jn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),jn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),jn.ceilPowerOfTwo(t)}}),Object.assign(Un.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(sr.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Kn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,a)}}),ei.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Xn.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Zr.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(di.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(di,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),di.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),di.getNormal(t,e,n,r)}}),Object.assign(ch.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Iu(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new $u(this,t)}}),Object.assign(Hn.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Kn.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign($n.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ma.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Mr.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Mr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(la.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(la.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xe},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ul.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(fl.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),cl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Hc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Sa.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(hh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Mi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Pn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Pn)}}}),Object.assign(Mi.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Pn:kn),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Gi.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Mi(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Gi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Sd.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(zs.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Pn},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(zs.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Pn:kn),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Du.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(_d.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(wi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new gi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===b}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(lc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(_a.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Ls.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Ls.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?tn:Ke}}}),Object.defineProperties(Cs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Yn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(td.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Hh).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),od.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ea.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var dp={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function fp(){console.error("THREE.CanvasRenderer has been removed")}function pp(){console.error("THREE.JSONLoader has been removed.")}Gn.crossOrigin=void 0,Gn.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new jc;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},Gn.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Vc;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},Gn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var mp={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function gp(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}}))},function(t,e,n){var r,i,a;(function(o,s){var l=(o=o||n(368)).window,u=o.document,c=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],n=e.slice,r=Object.create,i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=e.forEach||function(t,e){for(var n=0,r=this.length;n<r;n++)t.call(e,this[n],n,this)},l=function(t,e){for(var n in this)this.hasOwnProperty(n)&&t.call(e,this[n],n,this)},u=Object.assign||function(t){for(var e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t},c=function(t,e,n){if(t){var r=i(t,"length");(r&&"number"==typeof r.value?o:l).call(t,e,n=n||t)}return n};function h(e,n,r,o,s){var l={};function u(t,u){"string"==typeof(u=u||(u=i(n,t))&&(u.get?u:u.value))&&"#"===u[0]&&(u=e[u.substring(1)]||u);var c,h="function"==typeof u,f=u,p=s||h&&!u.base?u&&u.get?t in e:e[t]:null;s&&p||(h&&p&&(u.base=p),h&&!1!==o&&(c=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(l[c[3].toLowerCase()+c[4]]=c[2]),f&&!h&&f.get&&"function"==typeof f.get&&d.isPlainObject(f)||(f={value:f,writable:!0}),(i(e,t)||{configurable:!0}).configurable&&(f.configurable=!0,f.enumerable=null!=r?r:!c),a(e,t,f))}if(n){for(var c in n)n.hasOwnProperty(c)&&!t.test(c)&&u(c);for(var c in l){var h=l[c],f=e["set"+h],p=e["get"+h]||f&&e["is"+h];!p||!0!==o&&0!==p.length||u(c,{get:p,set:f})}}return e}function d(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&u(this,n)}return this}return h(d,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,n=t.beans,r=t.preserve;e!==t&&h(this.prototype,t,t.enumerable,n,r),h(this,e,null,n,r)}for(var i=1,a=arguments.length;i<a;i++)this.inject(arguments[i]);return this},extend:function(){for(var t,e,n,i=this,o=0,s=arguments.length;o<s&&(!t||!e);o++)n=arguments[o],t=t||n.initialize,e=e||n.prototype;return e=(t=t||function(){i.apply(this,arguments)}).prototype=e||r(this.prototype),a(e,"constructor",{value:t,writable:!0,configurable:!0}),h(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=i,t}}).inject({enumerable:!1,initialize:d,set:d,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&h(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var t=r(this);return t.inject.apply(t,arguments)},each:function(t,e){return c(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:u,each:c,create:r,define:a,describe:i,clone:function(t){return u(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===d||"Object"===e.name)},pick:function(t,e){return t!==s?t:e},slice:function(t,e,r){return n.call(t,e,r)}}})};t.exports=c,c.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+c.each(this,(function(t,e){if(!/^_/.test(e)){var n=typeof t;this.push(e+": "+("number"===n?m.instance.number(t):"string"===n?"'"+t+"'":t))}}),[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return c.importJSON(t,this)},exportJSON:function(t){return c.exportJSON(this,t)},toJSON:function(){return c.serialize(this)},set:function(t,e){return t&&c.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),n=e.prototype._class;return n&&!c.exports[n]&&(c.exports[n]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){if((n=t.length)!==e.length)return!1;for(;n--;)if(!c.equals(t[n],e[n]))return!1}else{var n,r=Object.keys(t);if((n=r.length)!==Object.keys(e).length)return!1;for(;n--;){var i=r[n];if(!e.hasOwnProperty(i)||!c.equals(t[i],e[i]))return!1}}return!0}return!1},read:function(t,e,n,r){if(this===c){var i=this.peek(t,e);return t.__index++,i}var a=this.prototype,o=a._readIndex,l=e||o&&t.__index||0,u=t.length,h=t[l];if(r=r||u-l,h instanceof this||n&&n.readNull&&null==h&&r<=1)return o&&(t.__index=l+1),h&&n&&n.clone?h.clone():h;if(h=c.create(a),o&&(h.__read=!0),h=h.initialize.apply(h,l>0||l+r<u?c.slice(t,l,l+r):t)||h,o){t.__index=l+h.__read;var d=h.__filtered;d&&(t.__filtered=d,h.__filtered=s),h.__read=s}return h},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,n,r){for(var i,a=[],o=e||0,s=r?o+r:t.length,l=o;l<s;l++)a.push(Array.isArray(i=t[l])?this.read(i,0,n):this.read(t,l,n,1));return a},readNamed:function(t,e,n,r,i){var a=this.getNamed(t,e),o=a!==s;if(o){var l=t.__filtered;if(!l){var u=this.getSource(t);(l=t.__filtered=c.create(u)).__unfiltered=u}l[e]=s}return this.read(o?[a]:t,n,r,i)},readSupported:function(t,e){var n=this.getSource(t),r=this,i=!1;return n&&Object.keys(n).forEach((function(n){if(n in e){var a=r.readNamed(t,n);a!==s&&(e[n]=a),i=!0}})),i},getSource:function(t){var e=t.__source;if(e===s){var n=1===t.length&&t[0];e=t.__source=n&&c.isPlainObject(n)?n:null}return e},getNamed:function(t,e){var n=this.getSource(t);if(n)return e?n[e]:t.__filtered||n},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,n,r){var i;function a(r){if(!(n&&r in n||i&&r in i)){var a=e[r];a!==s&&(t[r]=a)}}if(r){for(var o,l={},u=0,c=r.length;u<c;u++)(o=r[u])in e&&(a(o),l[o]=!0);i=l}return Object.keys(e.__unfiltered||e).forEach(a),t},isPlainValue:function(t,e){return c.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,n,r){e=e||{};var i,a=!r;if(a&&(e.formatter=new m(e.precision),r={length:0,definitions:{},references:{},add:function(t,e){var n="#"+t._id,r=this.references[n];if(!r){this.length++;var i=e.call(t),a=t._class;a&&i[0]!==a&&i.unshift(a),this.definitions[n]=i,r=this.references[n]=[n]}return r}}),t&&t._serialize){i=t._serialize(e,r);var o=t._class;!o||t._compactSerialize||!a&&n||i[0]===o||i.unshift(o)}else if(Array.isArray(t)){i=[];for(var s=0,l=t.length;s<l;s++)i[s]=c.serialize(t[s],e,n,r)}else if(c.isPlainObject(t)){i={};var u=Object.keys(t);for(s=0,l=u.length;s<l;s++){var h=u[s];i[h]=c.serialize(t[h],e,n,r)}}else i="number"==typeof t?e.formatter.number(t,e.precision):t;return a&&r.length>0?[["dictionary",r.definitions],i]:i},deserialize:function(t,e,n,r,i){var a=t,o=!n,s=o&&t&&t.length&&"dictionary"===t[0][0];if(n=n||{},Array.isArray(t)){var l=t[0],u="dictionary"===l;if(1==t.length&&/^#/.test(l))return n.dictionary[l];a=[];for(var h=(l=c.exports[l])?1:0,d=t.length;h<d;h++)a.push(c.deserialize(t[h],e,n,u,s));if(l){var f=a;a=e?e(l,f,o||i):new l(f)}}else if(c.isPlainObject(t))for(var p in a={},r&&(n.dictionary=a),t)a[p]=c.deserialize(t[p],e,n);return s?a[1]:a},exportJSON:function(t,e){var n=c.serialize(t,e);return e&&0==e.asString?n:JSON.stringify(n)},importJSON:function(t,e){return c.deserialize("string"==typeof t?JSON.parse(t):t,(function(t,n,r){var i=r&&e&&e.constructor===t,a=i?e:c.create(t.prototype);if(1===n.length&&a instanceof T&&(i||!(a instanceof P))){var o=n[0];c.isPlainObject(o)&&(o.insert=!1,i&&(n=n.concat([{insert:!0}])))}return(i?a.set:t).apply(a,n),i&&(e=null),a}))},push:function(t,e){var n=e.length;if(n<4096)t.push.apply(t,e);else{var r=t.length;t.length+=n;for(var i=0;i<n;i++)t[r+i]=e[i]}return t},splice:function(t,e,n,r){var i=e&&e.length,a=n===s;(n=a?t.length:n)>t.length&&(n=t.length);for(var o=0;o<i;o++)e[o]._index=n+o;if(a)return c.push(t,e),[];var l=[n,r];e&&c.push(l,e);for(var u=t.splice.apply(t,l),h=(o=0,u.length);o<h;o++)u[o]._index=s;for(o=n+i,h=t.length;o<h;o++)t[o]._index=o;return u},capitalize:function(t){return t.replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}))},camelize:function(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var h={on:function(t,e){if("string"!=typeof t)c.each(t,(function(t,e){this.on(e,t)}),this);else{var n=this._eventTypes,r=n&&n[t],i=this._callbacks=this._callbacks||{};-1===(i=i[t]=i[t]||[]).indexOf(e)&&(i.push(e),r&&r.install&&1===i.length&&r.install.call(this,t))}return this},off:function(t,e){if("string"==typeof t){var n,r=this._eventTypes,i=r&&r[t],a=this._callbacks&&this._callbacks[t];return a&&(!e||-1!==(n=a.indexOf(e))&&1===a.length?(i&&i.uninstall&&i.uninstall.call(this,t),delete this._callbacks[t]):-1!==n&&a.splice(n,1)),this}c.each(t,(function(t,e){this.off(e,t)}),this)},once:function(t,e){return this.on(t,(function n(){e.apply(this,arguments),this.off(t,n)}))},emit:function(t,e){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;var r=c.slice(arguments,1),i=e&&e.target&&!e.currentTarget;n=n.slice(),i&&(e.currentTarget=this);for(var a=0,o=n.length;a<o;a++)if(0==n[a].apply(this,r)){e&&e.stop&&e.stop();break}return i&&delete e.currentTarget,!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,n=this._callbacks,r=t?"install":"uninstall";if(e)for(var i in n)if(n[i].length>0){var a=e[i],o=a&&a[r];o&&o.call(this,i)}},statics:{inject:function t(e){var n=e._events;if(n){var r={};c.each(n,(function(t,n){var i="string"==typeof t,a=i?t:n,o=c.capitalize(a),s=a.substring(2).toLowerCase();r[s]=i?{}:t,a="_"+a,e["get"+o]=function(){return this[a]},e["set"+o]=function(t){var e=this[a];e&&this.off(s,e),t&&this.on(s,t),this[a]=t}})),e._eventTypes=r}return t.base.apply(this,arguments)}}},d=c.extend({_class:"PaperScope",initialize:function t(){dt=this,this.settings=new c({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var e=t.prototype;if(!this.support){var n=lt.getContext(1,1)||{};e.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:ut.nativeModes},lt.release(n)}if(!this.agent){var r=o.navigator.userAgent.toLowerCase(),i=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(r)||[])[0],a="darwin"===i?"mac":i,s=e.agent=e.browser={platform:a};a&&(s[a]=!0),r.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,(function(t,e,n,r,i){if(!s.chrome){var a="opera"===e?r:/^(node|trident)$/.test(e)?i:n;s.version=a,s.versionNumber=parseFloat(a),e={trident:"msie",jsdom:"node"}[e]||e,s.name=e,s[e]=!0}})),s.chrome&&delete s.webkit,s.atom&&delete s.chrome}},version:"0.12.11",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var n=dt.PaperScript.execute(t,this,e);return J.updateFocus(),n},install:function(t){var e=this;for(var n in c.each(["project","view","tool"],(function(n){c.define(t,n,{configurable:!0,get:function(){return e[n]}})})),this)!/^_/.test(n)&&this[n]&&(t[n]=this[n])},setup:function(t){return dt=this,this.project=new C(t),this},createCanvas:function(t,e){return lt.getCanvas(t,e)},activate:function(){dt=this},clear:function(){for(var t=this.projects,e=this.tools,n=t.length-1;n>=0;n--)t[n].remove();for(n=e.length-1;n>=0;n--)e[n].remove()},remove:function(){this.clear(),delete d._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,n){return e[t](n)||e[t]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),f=c.extend(h,{initialize:function(t){this._scope=dt,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(c.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),p={findItemBoundsCollisions:function(t,e,n){function r(t){for(var e=new Array(t.length),n=0;n<t.length;n++){var r=t[n].getBounds();e[n]=[r.left,r.top,r.right,r.bottom]}return e}var i=r(t),a=e&&e!==t?r(e):i;return this.findBoundsCollisions(i,a,n||0)},findCurveBoundsCollisions:function(t,e,n,r){function i(t){for(var e=Math.min,n=Math.max,r=new Array(t.length),i=0;i<t.length;i++){var a=t[i];r[i]=[e(a[0],a[2],a[4],a[6]),e(a[1],a[3],a[5],a[7]),n(a[0],a[2],a[4],a[6]),n(a[1],a[3],a[5],a[7])]}return r}var a=i(t),o=e&&e!==t?i(e):a;if(r){for(var s=this.findBoundsCollisions(a,o,n||0,!1,!0),l=this.findBoundsCollisions(a,o,n||0,!0,!0),u=[],c=0,h=s.length;c<h;c++)u[c]={hor:s[c],ver:l[c]};return u}return this.findBoundsCollisions(a,o,n||0)},findBoundsCollisions:function(t,e,n,r,i){var a=!e||t===e,o=a?t:t.concat(e),s=t.length,l=o.length;function u(t,e,n){for(var r=0,i=t.length;r<i;){var a=i+r>>>1;o[t[a]][e]<n?r=a+1:i=a}return r-1}for(var c=r?1:0,h=c+2,d=r?0:1,f=d+2,p=new Array(l),m=0;m<l;m++)p[m]=m;p.sort((function(t,e){return o[t][c]-o[e][c]}));var g=[],v=new Array(s);for(m=0;m<l;m++){var y=p[m],b=o[y],x=a?y:y-s,_=y<s,w=a||!_,S=_?[]:null;if(g.length){var E=u(g,h,b[c]-n)+1;if(g.splice(0,E),a&&i){S=S.concat(g);for(var M=0;M<g.length;M++){v[k=g[M]].push(x)}}else{var C=b[f],T=b[d];for(M=0;M<g.length;M++){var k=g[M],P=o[k],A=k<s,O=a||k>=s;(i||(_&&O||w&&A)&&C>=P[d]-n&&T<=P[f]+n)&&(_&&O&&S.push(a?k:k-s),w&&A&&v[k].push(x))}}}if(_&&(t===e&&S.push(y),v[y]=S),g.length){var N=u(g,h,b[h]);g.splice(N+1,0,y)}else g.push(y)}for(m=0;m<v.length;m++){var R=v[m];R&&R.sort((function(t,e){return t-e}))}return v}},m=c.extend({initialize:function(t){this.precision=c.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,n){return this.number(t)+(n||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});m.instance=new m;var g=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,r=Math.sqrt,i=Math.pow,a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function o(t,e,n){return t<e?e:t>n?n:t}function s(t,e,r){function i(t){var e=134217729*t,n=t-e+e;return[n,t-n]}var a=e*e-t*r,o=e*e+t*r;if(3*n(a)<o){var s=i(t),l=i(e),u=i(r),c=e*e,h=t*r;a=c-h+(l[0]*l[0]-c+2*l[0]*l[1]+l[1]*l[1]-(s[0]*u[0]-h+s[0]*u[1]+s[1]*u[0]+s[1]*u[1]))}return a}function l(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?i(2,-Math.round(a(t))):0}return{EPSILON:1e-12,MACHINE_EPSILON:112e-18,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(r(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=1e-12},isMachineZero:function(t){return t>=-112e-18&&t<=112e-18},clamp:o,integrate:function(n,r,i,a){for(var o=t[a-2],s=e[a-2],l=.5*(i-r),u=l+r,c=0,h=a+1>>1,d=1&a?s[c++]*n(u):0;c<h;){var f=l*o[c];d+=s[c++]*(n(u+f)+n(u-f))}return l*d},findRoot:function(t,e,r,i,a,s,l){for(var u=0;u<s;u++){var c=t(r),h=c/e(r),d=r-h;if(n(h)<l){r=d;break}c>0?(a=r,r=d<=i?.5*(i+a):d):(i=r,r=d>=a?.5*(i+a):d)}return o(r,i,a)},solveQuadratic:function(t,e,i,a,u,c){var h,d=1/0;if(n(t)<1e-12){if(n(e)<1e-12)return n(i)<1e-12?-1:0;h=-i/e}else{var f=s(t,e*=-.5,i);if(f&&n(f)<112e-18){var p=l(n(t),n(e),n(i));p&&(f=s(t*=p,e*=p,i*=p))}if(f>=-112e-18){var m=f<0?0:r(f),g=e+(e<0?-m:m);0===g?d=-(h=i/t):(h=g/t,d=i/g)}}var v=0,y=null==u,b=u-1e-12,x=c+1e-12;return isFinite(h)&&(y||h>b&&h<x)&&(a[v++]=y?h:o(h,u,c)),d!==h&&isFinite(d)&&(y||d>b&&d<x)&&(a[v++]=y?d:o(d,u,c)),v},solveCubic:function(t,e,a,s,u,c,h){var d,f,p,m,v,y=l(n(t),n(e),n(a),n(s));function b(n){var r=t*(d=n);m=(r+(f=r+e))*d+(p=f*d+a),v=p*d+s}if(y&&(t*=y,e*=y,a*=y,s*=y),n(t)<1e-12)t=e,f=a,p=s,d=1/0;else if(n(s)<1e-12)f=e,p=a,d=0;else{b(-e/t/3);var x=v/t,_=i(n(x),1/3),w=x<0?-1:1,S=-m/t,E=S>0?1.324717957244746*Math.max(_,r(S)):_,M=d-w*E;if(M!==d){do{b(M),M=0===m?d:d-v/m/(1+112e-18)}while(w*M>w*d);n(t)*d*d>n(s/d)&&(f=((p=-s/d)-a)/d)}}var C=g.solveQuadratic(t,f,p,u,c,h),T=null==c;return isFinite(d)&&(0===C||C>0&&d!==u[0]&&d!==u[1])&&(T||d>c-1e-12&&d<h+1e-12)&&(u[C++]=T?d:o(d,c,h)),C}}},v={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}return this._id++}},y=c.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var n=typeof t,r=this.__read,i=0;if("number"===n){var a="number"==typeof e;this._set(t,a?e:t),r&&(i=a?2:1)}else if("undefined"===n||null===t)this._set(0,0),r&&(i=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;i=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"x"in o?this._set(o.x||0,o.y||0):"width"in o?this._set(o.width||0,o.height||0):"angle"in o?(this._set(o.length||0,0),this.setAngle(o.angle||0)):(this._set(0,0),i=0)}return r&&(this.__read=i),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new y(this.x,this.y)},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var n=t/this.getLength();g.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=y.read(arguments),e=this.getLength()*t.getLength();if(g.isZero(e))return NaN;var n=this.dot(t)/e;return Math.acos(n<-1?-1:n>1?1:n)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=y.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=y.read(t),n=e.x-this.x,r=e.y-this.y,i=n*n+r*r,a=c.read(t);return a?i:Math.sqrt(i)},normalize:function(t){t===s&&(t=1);var e=this.getLength(),n=0!==e?t/e:0,r=new y(this.x*n,this.y*n);return n>=0&&(r._angle=this._angle),r},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var n=e?this.subtract(e):this,r=Math.sin(t),i=Math.cos(t);return n=new y(n.x*i-n.y*r,n.x*r+n.y*i),e?n.add(e):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=y.read(arguments);return new y(this.x+t.x,this.y+t.y)},subtract:function(){var t=y.read(arguments);return new y(this.x-t.x,this.y-t.y)},multiply:function(){var t=y.read(arguments);return new y(this.x*t.x,this.y*t.y)},divide:function(){var t=y.read(arguments);return new y(this.x/t.x,this.y/t.y)},modulo:function(){var t=y.read(arguments);return new y(this.x%t.x,this.y%t.y)},negate:function(){return new y(-this.x,-this.y)},isInside:function(){return w.read(arguments).contains(this)},isClose:function(){var t=arguments,e=y.read(t),n=c.read(t);return this.getDistance(e)<=n},isCollinear:function(){var t=y.read(arguments);return y.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=y.read(arguments);return y.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=g.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=y.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=y.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=y.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new y(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=y.read(t),n=y.read(t);return new y(Math.min(e.x,n.x),Math.min(e.y,n.y))},max:function(){var t=arguments,e=y.read(t),n=y.read(t);return new y(Math.max(e.x,n.x),Math.max(e.y,n.y))},random:function(){return new y(Math.random(),Math.random())},isCollinear:function(t,e,n,r){return Math.abs(t*r-e*n)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+r*r))},isOrthogonal:function(t,e,n,r){return Math.abs(t*n+e*r)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+r*r))}}},c.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new y(e(this.x),e(this.y))}}),{})),b=y.extend({initialize:function(t,e,n,r){this._x=t,this._y=e,this._owner=n,this._setter=r},_set:function(t,e,n){return this._x=t,this._y=e,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),x=c.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var n=typeof t,r=this.__read,i=0;if("number"===n){var a="number"==typeof e;this._set(t,a?e:t),r&&(i=a?2:1)}else if("undefined"===n||null===t)this._set(0,0),r&&(i=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;i=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"width"in o?this._set(o.width||0,o.height||0):"x"in o?this._set(o.x||0,o.y||0):(this._set(0,0),i=0)}return r&&(this.__read=i),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new x(this.width,this.height)},toString:function(){var t=m.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=x.read(arguments);return new x(this.width+t.width,this.height+t.height)},subtract:function(){var t=x.read(arguments);return new x(this.width-t.width,this.height-t.height)},multiply:function(){var t=x.read(arguments);return new x(this.width*t.width,this.height*t.height)},divide:function(){var t=x.read(arguments);return new x(this.width/t.width,this.height/t.height)},modulo:function(){var t=x.read(arguments);return new x(this.width%t.width,this.height%t.height)},negate:function(){return new x(-this.width,-this.height)},isZero:function(){var t=g.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new x(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new x(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new x(Math.random(),Math.random())}}},c.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new x(e(this.width),e(this.height))}}),{})),_=x.extend({initialize:function(t,e,n,r){this._width=t,this._height=e,this._owner=n,this._setter=r},_set:function(t,e,n){return this._width=t,this._height=e,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),w=c.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,e,n,r){var i,a=arguments,o=typeof t;if("number"===o?(this._set(t,e,n,r),i=4):"undefined"===o||null===t?(this._set(0,0,0,0),i=null===t?1:0):1===a.length&&(Array.isArray(t)?(this._set.apply(this,t),i=1):t.x!==s||t.width!==s?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),i=1):t.from===s&&t.to===s&&(this._set(0,0,0,0),c.readSupported(a,this)&&(i=1))),i===s){var l,u,h=y.readNamed(a,"from"),d=c.peek(a),f=h.x,p=h.y;if(d&&d.x!==s||c.hasNamed(a,"to")){var m=y.readNamed(a,"to");l=m.x-f,u=m.y-p,l<0&&(f=m.x,l=-l),u<0&&(p=m.y,u=-u)}else{var g=x.read(a);l=g.width,u=g.height}this._set(f,p,l,u),i=a.__index}var v=a.__filtered;return v&&(this.__filtered=v),this.__read&&(this.__read=i),this},set:"#initialize",_set:function(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this},clone:function(){return new w(this.x,this.y,this.width,this.height)},equals:function(t){var e=c.isPlainValue(t)?w.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?y:b)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=y.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?x:_)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=x.read(arguments),e=this._sx,n=this._sy,r=t.width,i=t.height;e&&(this.x+=(this.width-r)*e),n&&(this.y+=(this.height-i)*n),this.width=r,this.height=i,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=2*(t-this.x)*this._sx),this.width=2*(t-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=2*(t-this.y)*this._sy),this.height=2*(t-this.y)),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?y:b)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=y.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==s||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(w.read(arguments)):this._containsPoint(y.read(arguments))},_containsPoint:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=w.read(arguments),e=c.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=w.read(arguments),e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),r=Math.min(this.x+this.width,t.x+t.width),i=Math.min(this.y+this.height,t.y+t.height);return new w(e,n,r-e,i-n)},unite:function(){var t=w.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x+this.width,t.x+t.width),i=Math.max(this.y+this.height,t.y+t.height);return new w(e,n,r-e,i-n)},include:function(){var t=y.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x+this.width,t.x),i=Math.max(this.y+this.height,t.y);return new w(e,n,r-e,i-n)},expand:function(){var t=x.read(arguments),e=t.width,n=t.height;return new w(this.x-e/2,this.y-n/2,this.width+e,this.height+n)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===s?t:e)-this.height)}},c.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],(function(t,e){var n=t.join(""),r=/^[RL]/.test(n);e>=4&&(t[1]+=r?"Y":"X");var i=t[r?0:1],a=t[r?1:0],o="get"+i,s="get"+a,l="set"+i,u="set"+a,c="set"+n;this["get"+n]=function(t){return new(t?y:b)(this[o](),this[s](),this,c)},this[c]=function(){var t=y.read(arguments);this[l](t.x),this[u](t.y)}}),{beans:!0})),S=w.extend({initialize:function(t,e,n,r,i,a){this._set(t,e,n,r,!0),this._owner=i,this._setter=a},_set:function(t,e,n,r,i){return this._x=t,this._y=e,this._width=n,this._height=r,i||this._owner[this._setter](this),this}},new function(){var t=w.prototype;return c.each(["x","y","width","height"],(function(t){var e=c.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._dontNotify||this._owner[this._setter](this)}}),c.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],(function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}}),{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),E=c.extend({_class:"Matrix",initialize:function t(e,n){var r=arguments,i=r.length,a=!0;if(i>=6?this._set.apply(this,r):1===i||2===i?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,n):Array.isArray(e)?this._set.apply(this,n?e.concat([n]):e):a=!1:i?a=!1:this.reset(),!a)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,n,r,i,a,o){return this._a=t,this._b=e,this._c=n,this._d=r,this._tx=i,this._ty=a,o||this._changed(),this},_serialize:function(t,e){return c.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new E(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=m.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var n=this._owner;return!!n&&(n.transform(null,c.pick(t,!0),e),this.isIdentity())},translate:function(){var t=y.read(arguments),e=t.x,n=t.y;return this._tx+=e*this._a+n*this._c,this._ty+=e*this._b+n*this._d,this._changed(),this},scale:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0});return n&&this.translate(n),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=y.read(arguments,1),n=e.x,r=e.y,i=Math.cos(t),a=Math.sin(t),o=n-n*i+r*a,s=r-n*a-r*i,l=this._a,u=this._b,c=this._c,h=this._d;return this._a=i*l+a*c,this._b=i*u+a*h,this._c=-a*l+i*c,this._d=-a*u+i*h,this._tx+=o*l+s*c,this._ty+=o*u+s*h,this._changed(),this},shear:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0});n&&this.translate(n);var r=this._a,i=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*r,this._d+=e.x*i,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var t=arguments,e=y.read(t),n=y.read(t,0,{readNull:!0}),r=Math.PI/180,i=new y(Math.tan(e.x*r),Math.tan(e.y*r));return this.shear(i,n)},append:function(t,e){if(t){var n=this._a,r=this._b,i=this._c,a=this._d,o=t._a,s=t._c,l=t._b,u=t._d,c=t._tx,h=t._ty;this._a=o*n+l*i,this._c=s*n+u*i,this._b=o*r+l*a,this._d=s*r+u*a,this._tx+=c*n+h*i,this._ty+=c*r+h*a,e||this._changed()}return this},prepend:function(t,e){if(t){var n=this._a,r=this._b,i=this._c,a=this._d,o=this._tx,s=this._ty,l=t._a,u=t._c,c=t._b,h=t._d,d=t._tx,f=t._ty;this._a=l*n+u*r,this._c=l*i+u*a,this._b=c*n+h*r,this._d=c*i+h*a,this._tx=l*o+u*s+d,this._ty=c*o+h*s+f,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,n=this._c,r=this._d,i=this._tx,a=this._ty,o=t*r-e*n,s=null;return o&&!isNaN(o)&&isFinite(i)&&isFinite(a)&&(this._a=r/o,this._b=-e/o,this._c=-n/o,this._d=t/o,this._tx=(n*a-r*i)/o,this._ty=(e*i-t*a)/o,s=this),s},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new E(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,n){return arguments.length<3?this._transformPoint(y.read(arguments)):this._transformCoordinates(t,e,n)},_transformPoint:function(t,e,n){var r=t.x,i=t.y;return e||(e=new y),e._set(r*this._a+i*this._c+this._tx,r*this._b+i*this._d+this._ty,n)},_transformCoordinates:function(t,e,n){for(var r=0,i=2*n;r<i;r+=2){var a=t[r],o=t[r+1];e[r]=a*this._a+o*this._c+this._tx,e[r+1]=a*this._b+o*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,n=t.y,r=e+t.width,i=n+t.height,a=[e,n,r,n,r,i,e,i];return this._transformCoordinates(a,a,4)},_transformBounds:function(t,e,n){for(var r=this._transformCorners(t),i=r.slice(0,2),a=i.slice(),o=2;o<8;o++){var s=r[o],l=1&o;s<i[l]?i[l]=s:s>a[l]&&(a[l]=s)}return e||(e=new w),e._set(i[0],i[1],a[0]-i[0],a[1]-i[1],n)},inverseTransform:function(){return this._inverseTransform(y.read(arguments))},_inverseTransform:function(t,e,n){var r=this._a,i=this._b,a=this._c,o=this._d,s=this._tx,l=this._ty,u=r*o-i*a,c=null;if(u&&!isNaN(u)&&isFinite(s)&&isFinite(l)){var h=t.x-this._tx,d=t.y-this._ty;e||(e=new y),c=e._set((h*o-d*a)/u,(d*r-h*i)/u,n)}return c},decompose:function(){var t,e,n,r=this._a,i=this._b,a=this._c,o=this._d,s=r*o-i*a,l=Math.sqrt,u=Math.atan2,c=180/Math.PI;if(0!==r||0!==i){var h=l(r*r+i*i);t=Math.acos(r/h)*(i>0?1:-1),e=[h,s/h],n=[u(r*a+i*o,h*h),0]}else if(0!==a||0!==o){var d=l(a*a+o*o);t=Math.asin(a/d)*(o>0?1:-1),e=[s/d,d],n=[0,u(r*a+i*o,d*d)]}else t=0,n=e=[0,0];return{translation:this.getTranslation(),rotation:t*c,scaling:new y(e),skewing:new y(n[0]*c,n[1]*c)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new y(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},c.each(["a","b","c","d","tx","ty"],(function(t){var e=c.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._changed()}}),{})),M=c.extend({_class:"Line",initialize:function(t,e,n,r,i){var a=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=n,this._vy=r,a=i):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,a=n),a||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new y(this._px,this._py)},getVector:function(){return new y(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return M.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return M.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return M.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return y.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return y.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,n,r,i,a,o,s,l,u){l||(n-=t,r-=e,o-=i,s-=a);var c=n*s-r*o;if(!g.isMachineZero(c)){var h=t-i,d=e-a,f=(o*d-s*h)/c,p=(n*d-r*h)/c;if(u||-1e-12<f&&f<1+1e-12&&-1e-12<p&&p<1+1e-12)return u||(f=f<=0?0:f>=1?1:f),new y(t+f*n,e+f*r)}},getSide:function(t,e,n,r,i,a,o,s){o||(n-=t,r-=e);var l=i-t,u=l*r-(a-e)*n;return!s&&g.isMachineZero(u)&&(u=(l*n+l*n)/(n*n+r*r))>=0&&u<=1&&(u=0),u<0?-1:u>0?1:0},getSignedDistance:function(t,e,n,r,i,a,o){return o||(n-=t,r-=e),0===n?r>0?i-t:t-i:0===r?n<0?a-e:e-a:((i-t)*r-(a-e)*n)/(r>n?r*Math.sqrt(1+n*n/(r*r)):n*Math.sqrt(1+r*r/(n*n)))},getDistance:function(t,e,n,r,i,a,o){return Math.abs(M.getSignedDistance(t,e,n,r,i,a,o))}}}),C=f.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){f.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Q(null,null,this),this._view=J.create(this,t||lt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return c.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var r=this._changes;if(r&&e){var i=this._changesById,a=e._id,o=i[a];o?o.flags|=t:r.push(i[a]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new P({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:N,match:function(n){var r=n._definition,i=r._id;return e[i]||(e[i]=!0,t.push(r)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var n in t){var r=t[n],i=r._selection;1&i&&r.isInserted()?e.push(r):i||this._updateSelection(r)}return e},_updateSelection:function(t){var e=t._id,n=this._selectionItems;t._selection?n[e]!==t&&(this._selectionCount++,n[e]=t):n[e]===t&&(this._selectionCount--,delete n[e])},selectAll:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(s,t)},insertLayer:function(t,e){if(e instanceof P){e._remove(!1,!0),c.splice(this._children,[e],t,0),e._setProject(this,!0);var n=e._name;n&&e.setName(n),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,n){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(s,new P(T.NO_INSERT),!0)).insertChild(t,e),n&&e.activate&&e.activate(),e},getItems:function(t){return T._getItems(this,t)},getItem:function(t){return T._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return c.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var n=e[t];if(n){for(var r in n){var i=n[r];for(var a in e){var o=e[a];o&&o!=n&&delete o[i._id]}i.remove()}e[t]=null}}},draw:function(t,e,n){this._updateVersion++,t.save(),e.applyToContext(t);for(var r=this._children,i=new c({offset:new y(0,0),pixelRatio:n,viewMatrix:e.isIdentity()?null:e,matrices:[new E],updateMatrix:!0}),a=0,o=r.length;a<o;a++)r[a].draw(t,i);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var s=this._selectionItems,l=this._scope.settings.handleSize,u=this._updateVersion;for(var h in s)s[h]._drawSelection(t,e,l,s,u);t.restore()}}}),T=c.extend(h,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=c.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new E,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return c.each(t,(function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}}),{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var n=t&&c.isPlainObject(t),r=n&&!0===t.internal,i=this._matrix=new E,a=n&&t.project||dt.project,o=dt.settings;return this._id=r?null:v.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&o.applyMatrix,e&&i.translate(e),i._owner=this,this._style=new Q(a._currentStyle,this,a),r||n&&0==t.insert||!o.insertItems&&(!n||!0!==t.insert)?this._setProject(a):(n&&t.parent||a)._insertItem(s,this,!0),n&&t!==T.NO_INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(t,e){var n={},r=this;function i(i){for(var a in i){var o=r[a];c.equals(o,"leading"===a?1.2*i.fontSize:i[a])||(n[a]=c.serialize(o,t,"data"!==a,e))}}return i(this._serializeFields),this instanceof k||i(this._style._defaults),[this._class,n]},_changed:function(t){var e=this._symbol,n=this._parent||e,r=this._project;8&t&&(this._bounds=this._position=this._decomposed=s),16&t&&(this._globalMatrix=s),n&&72&t&&T._clearBoundsCache(n),2&t&&T._clearBoundsCache(this),r&&r._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var n=e._children,r=e._namedChildren;(r[t]=r[t]||[]).push(this),t in n||(n[t]=this)}this._name=t||s,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},c.each(["locked","visible","blendMode","opacity","guide"],(function(t){var e=c.capitalize(t),n="_"+t,r={locked:256,visible:265};this["get"+e]=function(){return this[n]},this["set"+e]=function(e){e!=this[n]&&(this[n]=e,this._changed(r[t]||257))}}),{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,n=t.length;e<n;e++)if(t[e].isSelected())return!0;return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,n=0,r=e.length;n<r;n++)e[n].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var n=0,r=t.length;n<r;n++)if(!t[n].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var n=0,r=e.length;n<r;n++)e[n].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?y:b,n=this._position||(this._position=this._getPositionFromBounds());return new e(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(y.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new b(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=y.read(arguments,0,{clone:!0,readNull:!0}),this._position=s}},c.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},(function(t,e){this[e]=function(e){return this.getBounds(e,t)}}),{beans:!0,getBounds:function(t,e){var n=e||t instanceof E,r=c.set({},n?e:t,this._boundsOptions);r.stroke&&!this.getStrokeScaling()||(r.cacheItem=this);var i=this._getCachedBounds(n&&t,r).rect;return arguments.length?i:new S(i.x,i.y,i.width,i.height,this,"setBounds")},setBounds:function(){var t=w.read(arguments),e=this.getBounds(),n=this._matrix,r=new E,i=t.getCenter();r.translate(i),t.width==e.width&&t.height==e.height||(n.isInvertible()||(n.set(n._backup||(new E).translate(n.getTranslation())),e=this.getBounds()),r.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),i=e.getCenter(),r.translate(-i.x,-i.y),this.transform(r)},_getBounds:function(t,e){var n=this._children;return n&&n.length?(T._updateBoundsCache(this,e.cacheItem),T._getBounds(n,t,e)):new w},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,n){t=t&&t._orNullIfIdentity();var r=e.internal&&!n,i=e.cacheItem,a=r?null:this._matrix._orNullIfIdentity(),o=i&&(!t||t.equals(a))&&this._getBoundsCacheKey(e,r),s=this._bounds;if(T._updateBoundsCache(this._parent||this._symbol,i),o&&s&&o in s)return{rect:(d=s[o]).rect.clone(),nonscaling:d.nonscaling};var l=this._getBounds(t||a,e),u=l.rect||l,c=this._style,h=l.nonscaling||c.hasStroke()&&!c.getStrokeScaling();if(o){s||(this._bounds=s={});var d=s[o]={rect:u.clone(),nonscaling:h,internal:r}}return{rect:u,nonscaling:h}},_getStrokeMatrix:function(t,e){var n=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,r=n?n.getViewMatrix().invert():t;return r&&r._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var n=e._id,r=t._boundsCache=t._boundsCache||{ids:{},list:[]};r.ids[n]||(r.list.push(e),r.ids[n]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=s;for(var n=0,r=e.list,i=r.length;n<i;n++){var a=r[n];a!==t&&(a._bounds=a._position=s,a._boundsCache&&T._clearBoundsCache(a))}}},_getBounds:function(t,e,n){var r=1/0,i=-r,a=r,o=i,s=!1;n=n||{};for(var l=0,u=t.length;l<u;l++){var c=t[l];if(c._visible&&!c.isEmpty(!0)){var h=c._getCachedBounds(e&&e.appended(c._matrix),n,!0),d=h.rect;r=Math.min(d.x,r),a=Math.min(d.y,a),i=Math.max(d.x+d.width,i),o=Math.max(d.y+d.height,o),h.nonscaling&&(s=!0)}}return{rect:isFinite(r)?new w(r,a,i-r,o-a):new w,nonscaling:s}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var n=this._decomposed;this.rotate(t-e),n&&(n.rotation=t,this._decomposed=n)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new b(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=y.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var n=this.getRotation(),r=this._decomposed,i=new E,a=g.isZero;if(a(t.x)||a(t.y))i.translate(r.translation),n&&i.rotate(n),i.scale(e.x,e.y),this._matrix.set(i);else{var o=this.getPosition(!0);i.translate(o),n&&i.rotate(n),i.scale(e.x/t.x,e.y/t.y),n&&i.rotate(-n),i.translate(o.negate()),this.transform(i)}r&&(r.scaling=e,this._decomposed=r)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var n=this._parent,r=[];n;){if(!n._globalMatrix){e=null;for(var i=0,a=r.length;i<a;i++)r[i]._globalMatrix=null;break}r.push(n),n=n._parent}e||(e=this._globalMatrix=this._matrix.clone(),(n=this._parent)&&e.prepend(n.getGlobalMatrix(!0)));return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,r=0,i=n&&n.length;r<i;r++)n[r]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var n=this._children,r=0,i=n&&n.length;r<i;r++)n[r]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof P)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return c.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(T.NO_INSERT),n=this._children,r=c.pick(t?t.insert:s,t===s||!0===t),i=c.pick(t?t.deep:s,!0);n&&e.copyAttributes(this),n&&!i||e.copyContent(this),n||e.copyAttributes(this),r&&e.insertAbove(this);var a=this._name,o=this._parent;if(a&&o){n=o._children;for(var l=a,u=1;n[a];)a=l+" "+u++;a!==l&&e.setName(a)}return e},copyContent:function(t){for(var e=t._children,n=0,r=e&&e.length;n<r;n++)this.addChild(e[n].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],r=0,i=n.length;r<i;r++){var a=n[r];t.hasOwnProperty(a)&&(this[a]=t[a])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,s=t._name;this._data=o?c.clone(o):null,s&&this.setName(s)},rasterize:function(t,e){var n=this.getStrokeBounds(),r=(t||this.getView().getResolution())/72,i=n.getTopLeft().floor(),a=n.getBottomRight().ceil(),o=new x(a.subtract(i)),l=new O(T.NO_INSERT);if(!o.isZero()){var u=lt.getCanvas(o.multiply(r)),h=u.getContext("2d"),d=(new E).scale(r).translate(i.negate());h.save(),d.applyToContext(h),this.draw(h,new c({matrices:[d]})),h.restore(),l.setCanvas(u)}return l.transform((new E).translate(i.add(o.divide(2))).scale(1/r)),(e===s||e)&&l.insertAbove(this),l},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(y.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var n=e.length-1;n>=0;n--)if(e[n].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return w.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new V.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof T&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(y.read(t),L.getOptions(t))}function e(){var t=arguments,e=y.read(t),n=L.getOptions(t),r=[];return this._hitTest(e,new c({all:r},n)),r}function n(t,e,n,r){var i=this._children;if(i)for(var a=i.length-1;a>=0;a--){var o=i[a],s=o!==r&&o._hitTest(t,e,n);if(s&&!e.all)return s}return null}return C.inject({hitTest:t,hitTestAll:e,_hitTest:n}),{hitTest:t,hitTestAll:e,_hitTestChildren:n}},{_hitTest:function(t,e,n){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var r=this._matrix,i=n?n.appended(r):this.getGlobalMatrix().prepend(this.getView()._matrix),a=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new x(V._getStrokePadding(a,r._shiftless().invert()));if(!(t=r._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var s,l,u=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==c.hyphenate(this._class)||e.class&&!(this instanceof e.class)),h=e.match,d=this;function f(t){return t&&h&&!h(t)&&(t=null),t&&e.all&&e.all.push(t),t}function p(e,n){var r=n?s["get"+n]():d.getPosition();if(t.subtract(r).divide(o).length<=1)return new L(e,d,{name:n?c.hyphenate(n):e,point:r})}var m=e.position,g=e.center,v=e.bounds;if(u&&this._parent&&(m||g||v)){if((g||v)&&(s=this.getInternalBounds()),!(l=m&&p("position")||g&&p("center","Center"))&&v)for(var y=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],b=0;b<8&&!l;b++)l=p("bounds",y[b]);l=f(l)}return l||(l=this._hitTestChildren(t,e,i)||u&&f(this._hitTestSelf(t,e,i,this.getStrokeScaling()?null:i._shiftless().invert()))||null),l&&l.point&&(l.point=r.transform(l.point)),l},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new L("fill",this)},matches:function(t,e){var n=typeof t;if("object"===n){for(var r in t)if(t.hasOwnProperty(r)&&!this.matches(r,t[r]))return!1;return!0}if("function"===n)return t(this);if("match"===t)return e(this);var i=/^(empty|editable)$/.test(t)?this["is"+c.capitalize(t)]():"type"===t?c.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;i=this._class}if("function"==typeof e)return!!e(i);if(e){if(e.test)return e.test(i);if(c.isPlainObject(e))return function t(e,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=n[r];if(c.isPlainObject(i)&&c.isPlainObject(a)){if(!t(i,a))return!1}else if(!c.equals(i,a))return!1}return!0}(e,i)}return c.equals(i,e)},getItems:function(t){return T._getItems(this,t,this._matrix)},getItem:function(t){return T._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,n,r,i,a){if(!i){var o="object"==typeof n&&n,s=o&&o.overlapping,l=o&&o.inside,u=(y=s||l)&&w.read([y]);i={items:[],recursive:o&&!1!==o.recursive,inside:!!l,overlapping:!!s,rect:u,path:s&&new V.Rectangle({rectangle:u,insert:!1})},o&&(n=c.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var h=e._children,d=i.items;r=(u=i.rect)&&(r||new E);for(var f=0,p=h&&h.length;f<p;f++){var m=h[f],g=r&&r.appended(m._matrix),v=!0;if(u){var y=m.getBounds(g);if(!u.intersects(y))continue;u.contains(y)||i.overlapping&&(y.contains(u)||i.path.intersects(m,g))||(v=!1)}if(v&&m.matches(n)&&(d.push(m),a))break;if(!1!==i.recursive&&t(m,n,g,i,a),a&&d.length>0)break}return d}}},{importJSON:function(t){var e=c.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(s,t)},insertChild:function(t,e){var n=e?this.insertChildren(t,[e]):null;return n&&n[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var n=this._children;if(n&&e&&e.length>0){for(var r={},i=(e=c.slice(e)).length-1;i>=0;i--){var a=(u=e[i])&&u._id;!u||r[a]?e.splice(i,1):(u._remove(!1,!0),r[a]=!0)}c.splice(n,e,t,0);for(var o=this._project,s=o._changes,l=(i=0,e.length);i<l;i++){var u,h=(u=e[i])._name;u._parent=this,u._setProject(o,!0),h&&u.setName(h),s&&u._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var n=t&&t._getOwner(),r=t!==this&&n?this:null;return r&&(r._remove(!1,!0),n._insertItem(t._index+e,r)),r},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(s,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(s,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var n=e[0].reduce(t);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,n=t._namedChildren,r=this._name,i=n[r],a=i?i.indexOf(this):-1;-1!==a&&(e[r]==this&&delete e[r],i.splice(a,1),i.length?e[r]=i[0]:delete n[r])}},_remove:function(t,e){var n=this._getOwner(),r=this._project,i=this._index;return this._style&&this._style._dispose(),!!n&&(this._name&&this._removeNamed(),null!=i&&(r._activeLayer===this&&(r._activeLayer=this.getNextSibling()||this.getPreviousSibling()),c.splice(n._children,null,i,1)),this._installEvents(!1),t&&r._changes&&this._changed(5),e&&n._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=c.pick(e,this._children.length);for(var n=c.splice(this._children,null,t,e-t),r=n.length-1;r>=0;r--)n[r]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,n=e?e.length:0;if(t){for(var r=0;r<n;r++)if(!e[r].isEmpty(t))return!1;return!0}return!n},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var n=e(this),r=e(t),i=0,a=Math.min(n.length,r.length);i<a;i++)if(n[i]!=r[i])return n[i]._index<r[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},c.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,r=(e?c:y).read(n),i=y.read(n,0,{readNull:!0});return this.transform((new E)[t](r,i||this.getPosition(!0)))}}),{translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,n){var r=this._matrix,i=t&&!t.isIdentity(),a=n&&this._canApplyMatrix||this._applyMatrix&&(i||!r.isIdentity()||e&&this._children);if(!i&&!a)return this;if(i){!t.isInvertible()&&r.isInvertible()&&(r._backup=r.getValues()),r.prepend(t,!0);var o=this._style,s=o.getFillColor(!0),l=o.getStrokeColor(!0);s&&s.transform(t),l&&l.transform(t)}if(a&&(a=this._transformContent(r,e,n))){var u=this._pivot;u&&r._transformPoint(u,u,!0),r.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var c=this._bounds,h=this._position;(i||a)&&this._changed(25);var d=i&&c&&t.decompose();if(d&&d.skewing.isZero()&&d.rotation%90==0){for(var f in c){var p=c[f];if(p.nonscaling)delete c[f];else if(a||!p.internal){var m=p.rect;t._transformBounds(m,m)}}this._bounds=c;var g=c[this._getBoundsCacheKey(this._boundsOptions||{})];g&&(this._position=this._getPositionFromBounds(g.rect))}else i&&h&&this._pivot&&(this._position=t._transformPoint(h,h));return this},_transformContent:function(t,e,n){var r=this._children;if(r){for(var i=0,a=r.length;i<a;i++)r[i].transform(t,e,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(y.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(y.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(y.read(arguments))},localToParent:function(){return this._matrix._transformPoint(y.read(arguments))},fitBounds:function(t,e){t=w.read(arguments);var n=this.getBounds(),r=n.height/n.width,i=t.height/t.width,a=(e?r>i:r<i)?t.width/n.width:t.height/n.height,o=new w(new y,new x(n.width*a,n.height*a));o.setCenter(t.getCenter()),this.setBounds(o)}}),{_setStyles:function(t,e,n){var r=this._style,i=this._matrix;if(r.hasFill()&&(t.fillStyle=r.getFillColor().toCanvasStyle(t,i)),r.hasStroke()){t.strokeStyle=r.getStrokeColor().toCanvasStyle(t,i),t.lineWidth=r.getStrokeWidth();var a=r.getStrokeJoin(),o=r.getStrokeCap(),s=r.getMiterLimit();if(a&&(t.lineJoin=a),o&&(t.lineCap=o),s&&(t.miterLimit=s),dt.support.nativeDash){var l=r.getDashArray(),u=r.getDashOffset();l&&l.length&&("setLineDash"in t?(t.setLineDash(l),t.lineDashOffset=u):(t.mozDash=l,t.mozDashOffset=u))}}if(r.hasShadow()){var c=e.pixelRatio||1,h=n._shiftless().prepend((new E).scale(c,c)),d=h.transform(new y(r.getShadowBlur(),0)),f=h.transform(this.getShadowOffset());t.shadowColor=r.getShadowColor().toCanvasStyle(t),t.shadowBlur=d.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,n){this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var r=e.matrices,i=e.viewMatrix,a=this._matrix,o=r[r.length-1].appended(a);if(o.isInvertible()){i=i?i.appended(o):o,r.push(o),e.updateMatrix&&(this._globalMatrix=o);var s,l,u,c=this._blendMode,h=g.clamp(this._opacity,0,1),d="normal"===c,f=ut.nativeModes[c],p=d&&1===h||e.dontStart||e.clip||(f||d&&h<1)&&this._canComposite(),m=e.pixelRatio||1;if(!p){var v=this.getStrokeBounds(i);if(!v.width||!v.height)return void r.pop();u=e.offset,l=e.offset=v.getTopLeft().floor(),s=t,t=lt.getContext(v.getSize().ceil().add(1).multiply(m)),1!==m&&t.scale(m,m)}t.save();var y=n?n.appended(a):this._canScaleStroke&&!this.getStrokeScaling(!0)&&i,b=!p&&e.clipItem,x=!y||b;if(p?(t.globalAlpha=h,f&&(t.globalCompositeOperation=c)):x&&t.translate(-l.x,-l.y),x&&(p?a:i).applyToContext(t),b&&e.clipItem.draw(t,e.extend({clip:!0})),y){t.setTransform(m,0,0,m,0,0);var _=e.offset;_&&t.translate(-_.x,-_.y)}this._draw(t,e,i,y),t.restore(),r.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),p||(ut.process(c,t,s,h,l.subtract(u).multiply(m)),lt.release(t),e.offset=u)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof j)return e._isUpdated(t);var n=this._updateVersion===t;return!n&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,e,n,r,i){var a=this._selection,o=1&a,s=2&a||o&&this._selectBounds,l=4&a;if(this._drawSelected||(o=!1),(o||s||l)&&this._isUpdated(i)){var u,c=this.getSelectedColor(!0)||(u=this.getLayer())&&u.getSelectedColor(!0),h=e.appended(this.getGlobalMatrix(!0)),d=n/2;if(t.strokeStyle=t.fillStyle=c?c.toCanvasStyle(t):"#009dec",o&&this._drawSelected(t,h,r),l){var f=this.getPosition(!0),p=this._parent,m=p?p.localToGlobal(f):f,g=m.x,v=m.y;t.beginPath(),t.arc(g,v,d,0,2*Math.PI,!0),t.stroke();for(var y=[[0,-1],[1,0],[0,1],[-1,0]],b=d,x=n+1,_=0;_<4;_++){var w=y[_],S=w[0],E=w[1];t.moveTo(g+S*b,v+E*b),t.lineTo(g+S*x,v+E*x),t.stroke()}}if(s){var M=h._transformCorners(this.getInternalBounds());t.beginPath();for(_=0;_<8;_++)t[_?"lineTo":"moveTo"](M[_],M[++_]);t.closePath(),t.stroke();for(_=0;_<8;_++)t.fillRect(M[_]-d,M[++_]-d,n,n)}}},_canComposite:function(){return!1}},c.each(["down","drag","up","move"],(function(t){this["removeOn"+c.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}}),{removeOn:function(t){for(var e in t)if(t[e]){var n="mouse"+e,r=this._project,i=r._removeSets=r._removeSets||{};i[n]=i[n]||{},i[n][this._id]=this}return this}}),{tween:function(t,e,n){n||(n=e,e=t,t=null,n||(n=e,e=null));var r=n&&n.easing,i=n&&n.start,a=null!=n&&("number"==typeof n?n:n.duration),o=new ot(this,t,e,a,r,i);return a&&this.on("frame",(function t(e){o._handleFrame(1e3*e.time),o.running||this.off("frame",t)})),o},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),k=T.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(e){t.base.call(this,e),2050&e&&(this._clipItem=s)},_getClipItem:function(){var t=this._clipItem;if(t===s){t=null;for(var e=this._children,n=0,r=e.length;n<r;n++)if(e[n]._clipMask){t=e[n];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,n){var r=this._getClipItem();return r?r._getCachedBounds(r._matrix.prepended(e),c.set({},n,{stroke:!1})):t.base.call(this,e,n)},_hitTestChildren:function t(e,n,r){var i=this._getClipItem();return(!i||i.contains(e))&&t.base.call(this,e,n,r,i)},_draw:function(t,e){var n=e.clip,r=!n&&this._getClipItem();e=e.extend({clipItem:r,clip:!1}),n?(t.beginPath(),e.dontStart=e.dontFinish=!0):r&&r.draw(t,e.extend({clip:!0}));for(var i=this._children,a=0,o=i.length;a<o;a++){var s=i[a];s!==r&&s.draw(t,e)}}}),P=k.extend({_class:"Layer",initialize:function(){k.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),A=T.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&c.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new _(t.width,t.height,this,"setSize")},setSize:function(){var t=x.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,n=t.width,r=t.height;"rectangle"===e?this._radius.set(x.min(this._radius,t.divide(2).abs())):"circle"===e?(n=r=(n+r)/2,this._radius=n/2):"ellipse"===e&&this._radius._set(n/2,r/2),this._size._set(n,r),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new _(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var n=2*t;this._radius=t,this._size._set(n,n)}else if(t=x.read(arguments),this._radius){if(this._radius.equals(t))return;if(this._radius.set(t),"rectangle"===e){n=x.max(this._size,t.multiply(2));this._size.set(n)}else"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new(V[c.capitalize(this._type)])({center:new y,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),dt.settings.applyMatrix&&e.setApplyMatrix(!0),(t===s||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,n,r){var i=this._style,a=i.hasFill(),o=i.hasStroke(),s=e.dontFinish||e.clip,l=!r;if(a||o||s){var u=this._type,c=this._radius,h="circle"===u;if(e.dontStart||t.beginPath(),l&&h)t.arc(0,0,c,0,2*Math.PI,!0);else{var d=h?c:c.width,f=h?c:c.height,p=this._size,m=p.width,g=p.height;if(l&&"rectangle"===u&&0===d&&0===f)t.rect(-m/2,-g/2,m,g);else{var v=m/2,y=g/2,b=.44771525016920644,x=d*b,_=f*b,w=[-v,-y+f,-v,-y+_,-v+x,-y,-v+d,-y,v-d,-y,v-x,-y,v,-y+_,v,-y+f,v,y-f,v,y-_,v-x,y,v-d,y,-v+d,y,-v+x,y,-v,y-_,-v,y-f];r&&r.transform(w,w,32),t.moveTo(w[0],w[1]),t.bezierCurveTo(w[2],w[3],w[4],w[5],w[6],w[7]),v!==d&&t.lineTo(w[8],w[9]),t.bezierCurveTo(w[10],w[11],w[12],w[13],w[14],w[15]),y!==f&&t.lineTo(w[16],w[17]),t.bezierCurveTo(w[18],w[19],w[20],w[21],w[22],w[23]),v!==d&&t.lineTo(w[24],w[25]),t.bezierCurveTo(w[26],w[27],w[28],w[29],w[30],w[31])}}t.closePath()}s||!a&&!o||(this._setStyles(t,e,n),a&&(t.fill(i.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var n=new w(this._size).setCenter(0,0),r=this._style,i=e.stroke&&r.hasStroke()&&r.getStrokeWidth();return t&&(n=t._transformBounds(n)),i?n.expand(V._getStrokePadding(i,this._getStrokeMatrix(t,e))):n}},new function(){function t(t,e,n){var r=t._radius;if(!r.isZero())for(var i=t._size.divide(2),a=1;a<=4;a++){var o=new y(a>1&&a<4?-1:1,a>2?-1:1),s=o.multiply(i),l=s.subtract(o.multiply(r));if(new w(n?s.add(o.multiply(n)):s,l).contains(e))return{point:l,quadrant:a}}}function e(t,e,n,r){var i=t.divide(e);return(!r||i.isInQuadrant(r))&&i.subtract(i.normalize()).multiply(e).divide(n).length<=1}return{_contains:function e(n){if("rectangle"===this._type){var r=t(this,n);return r?n.subtract(r.point).divide(this._radius).getLength()<=1:e.base.call(this,n)}return n.divide(this.size).getLength()<=.5},_hitTestSelf:function n(r,i,a,o){var s=!1,l=this._style,u=i.stroke&&l.hasStroke(),c=i.fill&&l.hasFill();if(u||c){var h=this._type,d=this._radius,f=u?l.getStrokeWidth()/2:0,p=i._tolerancePadding.add(V._getStrokePadding(f,!l.getStrokeScaling()&&o));if("rectangle"===h){var m=p.multiply(2),g=t(this,r,m);if(g)s=e(r.subtract(g.point),d,p,g.quadrant);else{var v=new w(this._size).setCenter(0,0),y=v.expand(m),b=v.expand(m.negate());s=y._containsPoint(r)&&!b._containsPoint(r)}}else s=e(r,d,p)}return s?new L(u?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,n,r,i){var a=c.create(A.prototype);return a._type=t,a._size=n,a._radius=r,a._initialize(c.getNamed(i),e),a}return{Circle:function(){var e=arguments,n=y.readNamed(e,"center"),r=c.readNamed(e,"radius");return t("circle",n,new x(2*r),r,e)},Rectangle:function(){var e=arguments,n=w.readNamed(e,"rectangle"),r=x.min(x.readNamed(e,"radius"),n.getSize(!0).divide(2));return t("rectangle",n.getCenter(!0),n.getSize(!0),r,e)},Ellipse:function(){var e=arguments,n=A._readEllipse(e),r=n.radius;return t("ellipse",n.center,r.multiply(2),r,e)},_readEllipse:function(t){var e,n;if(c.hasNamed(t,"radius"))e=y.readNamed(t,"center"),n=x.readNamed(t,"radius");else{var r=w.readNamed(t,"rectangle");e=r.getCenter(!0),n=r.getSize(!0).divide(2)}return{center:e,radius:n}}}}}),O=T.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:!0,beans:!0,initialize:function(t,e){if(!this._initialize(t,e!==s&&y.read(arguments))){var n,r=typeof t,i="string"===r?u.getElementById(t):"object"===r?t:null;if(i&&i!==T.NO_INSERT)if(i.getContext||null!=i.naturalHeight)n=i;else if(i){var a=x.read(arguments);a.isZero()||(n=lt.getCanvas(a))}n?this.setImage(n):this.setSource(t)}this._size||(this._size=new x,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,n=t._canvas;if(e)this._setImage(e);else if(n){var r=lt.getCanvas(t._size);r.getContext("2d").drawImage(n,0,0),this._setImage(r)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new _(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(){var t=x.read(arguments);if(!t.equals(this._size))if(t.width>0&&t.height>0){var e=this.getElement();this._setImage(lt.getCanvas(t)),e&&this.getContext(!0).drawImage(e,0,0,t.width,t.height)}else this._canvas&&lt.release(this._canvas),this._size=t.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new y(0,0).transform(t),n=new y(1,0).transform(t).subtract(e),r=new y(0,1).transform(t).subtract(e);return new x(72/n.getLength(),72/r.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function n(t){var n=e.getView(),r=t&&t.type||"load";n&&e.responds(r)&&(dt=n._scope,e.emit(r,new tt(t)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&Z.add(t,{load:function(r){e._setImage(t),n(r)},error:n})},_setImage:function(t){this._canvas&&lt.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new x(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=lt.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){lt.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var e=new o.Image,n=this._crossOrigin;n&&(e.crossOrigin=n),t&&(e.src=t),this.setImage(e)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=t,this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=w.read(arguments),e=lt.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=w.read(arguments),e=new O(T.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(t){var e=y.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,n;if(t?t instanceof B?(n=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new w(t):"x"in t&&(e=new w(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var r=Math.min(e.width,32),i=Math.min(e.height,32),a=O._sampleContext;a?a.clearRect(0,0,33,33):a=O._sampleContext=lt.getContext(new x(32)),a.save();var o=(new E).scale(r/e.width,i/e.height).translate(-e.x,-e.y);o.applyToContext(a),n&&n.draw(a,new c({clip:!0,matrices:[o]})),this._matrix.applyToContext(a);var s=this.getElement(),l=this._size;s&&a.drawImage(s,-l.width/2,-l.height/2),a.restore();for(var u=a.getImageData(.5,.5,Math.ceil(r),Math.ceil(i)).data,h=[0,0,0],d=0,f=0,p=u.length;f<p;f+=4){var m=u[f+3];d+=m,m/=255,h[0]+=u[f]*m,h[1]+=u[f+1]*m,h[2]+=u[f+2]*m}for(f=0;f<3;f++)h[f]/=d;return d?W.read(h):null},getPixel:function(){var t=y.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new W("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=y.read(t),n=W.read(t),r=n._convert("rgb"),i=n._alpha,a=this.getContext(!0),o=a.createImageData(1,1),s=o.data;s[0]=255*r[0],s[1]=255*r[1],s[2]=255*r[2],s[3]=null!=i?255*i:255,a.putImageData(o,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=x.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=w.read(arguments);return t.isEmpty()&&(t=new w(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},setImageData:function(t){var e=y.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},_getBounds:function(t,e){var n=new w(this._size).setCenter(0,0);return t?t._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new L("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,n){var r=this.getElement();r&&r.width>0&&r.height>0&&(t.globalAlpha=g.clamp(this._opacity,0,1),this._setStyles(t,e,n),X.setPrefixed(t,"imageSmoothingEnabled",this._smoothing),t.drawImage(r,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),N=T.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,e){this._initialize(t,e!==s&&y.read(arguments,1))||this.setDefinition(t instanceof R?t:new R(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(t),e)},_hitTestSelf:function(t,e,n){var r=e.extend({all:!1}),i=this._definition._item._hitTest(t,r,n);return i&&(i.item=this),i},_draw:function(t,e){this._definition._item.draw(t,e)}}),R=c.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=v.get(),this.project=dt.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,(function(){return c.serialize([this._class,this._item],t,!1,e)}))},_changed:function(t){8&t&&T._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new y),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new N(this,t)},clone:function(){return new R(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),L=c.extend({_class:"HitResult",initialize:function(t,e,n){this.type=t,this.item=e,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&c.read(t);return new c({type:null,tolerance:dt.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),I=c.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,e,n,r,i,a){var o,l,u,c,h=arguments.length;h>0&&(null==t||"object"==typeof t?1===h&&t&&"point"in t?(o=t.point,l=t.handleIn,u=t.handleOut,c=t.selection):(o=t,l=e,u=n,c=r):(o=[t,e],l=n!==s?[n,r]:null,u=i!==s?[i,a]:null)),new D(o,this,"_point"),new D(l,this,"_handleIn"),new D(u,this,"_handleOut"),c&&this.setSelection(c)},_serialize:function(t,e){var n=this._point,r=this._selection,i=r||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return r&&i.push(r),c.serialize(i,t,!0,e)},_changed:function(t){var e=this._path;if(e){var n,r=e._curves,i=this._index;r&&(t&&t!==this._point&&t!==this._handleIn||!(n=i>0?r[i-1]:e._closed?r[r.length-1]:null)||n._changed(),t&&t!==this._point&&t!==this._handleOut||!(n=r[i])||n._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(y.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(y.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(y.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,n=this._path;this._selection=t=t||0,n&&t!==e&&(n._updateSelection(this,e,t),n._changed(257))},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==s?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new F(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,n){var r=t||{},i=r.type,a=r.factor,o=this.getPrevious(),l=this.getNext(),u=(o||this)._point,c=this._point,h=(l||this)._point,d=u.getDistance(c),f=c.getDistance(h);if(i&&"catmull-rom"!==i){if("geometric"!==i)throw new Error("Smoothing method '"+i+"' not supported.");if(o&&l){var p=u.subtract(h),m=a===s?.4:a,g=m*d/(d+f);e||this.setHandleIn(p.multiply(g)),n||this.setHandleOut(p.multiply(g-m))}}else{var v=a===s?.5:a,b=Math.pow(d,v),x=b*b,_=Math.pow(f,v),w=_*_;if(!e&&o){var S=2*w+3*_*b+x,E=3*_*(_+b);this.setHandleIn(0!==E?new y((w*u._x+S*c._x-x*h._x)/E-c._x,(w*u._y+S*c._y-x*h._y)/E-c._y):new y)}if(!n&&l){S=2*x+3*b*_+w,E=3*b*(b+_);this.setHandleOut(0!==E?new y((x*h._x+S*c._x-w*u._x)/E-c._x,(x*h._y+S*c._y-w*u._y)/E-c._y):new y)}}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,n=t.clone();t.set(e),e.set(n)},reversed:function(){return new I(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new I(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,n){var r=1-n,i=n,a=t._point,o=e._point,s=t._handleIn,l=e._handleIn,u=e._handleOut,c=t._handleOut;this._point._set(r*a._x+i*o._x,r*a._y+i*o._y,!0),this._handleIn._set(r*s._x+i*l._x,r*s._y+i*l._y,!0),this._handleOut._set(r*c._x+i*u._x,r*c._y+i*u._y,!0),this._changed()},_transformCoordinates:function(t,e,n){var r=this._point,i=n&&this._handleIn.isZero()?null:this._handleIn,a=n&&this._handleOut.isZero()?null:this._handleOut,o=r._x,s=r._y,l=2;return e[0]=o,e[1]=s,i&&(e[l++]=i._x+o,e[l++]=i._y+s),a&&(e[l++]=a._x+o,e[l++]=a._y+s),t&&(t._transformCoordinates(e,e,l/2),o=e[0],s=e[1],n?(r._x=o,r._y=s,l=2,i&&(i._x=e[l++]-o,i._y=e[l++]-s),a&&(a._x=e[l++]-o,a._y=e[l++]-s)):(i||(e[l++]=o,e[l++]=s),a||(e[l++]=o,e[l++]=s))),e}}),D=y.extend({initialize:function(t,e,n){var r,i,a;if(t)if((r=t[0])!==s)i=t[1];else{var o=t;(r=o.x)===s&&(r=(o=y.read(arguments)).x),i=o.y,a=o.selected}else r=i=0;this._x=r,this._y=i,this._owner=e,e[n]=this,a&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=g.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),z=c.extend({_class:"Curve",beans:!0,initialize:function(t,e,n,r,i,a,o,s){var l,u,c,h,d,f,p=arguments.length;3===p?(this._path=t,l=e,u=n):p?1===p?"segment1"in t?(l=new I(t.segment1),u=new I(t.segment2)):"point1"in t?(c=t.point1,d=t.handle1,f=t.handle2,h=t.point2):Array.isArray(t)&&(c=[t[0],t[1]],h=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],f=[t[4]-t[6],t[5]-t[7]]):2===p?(l=new I(t),u=new I(e)):4===p?(c=t,d=e,f=n,h=r):8===p&&(c=[t,e],h=[o,s],d=[n-t,r-e],f=[i-o,a-s]):(l=new I,u=new I),this._segment1=l||new I(c,null,d),this._segment2=u||new I(h,f,null)},_serialize:function(t,e){return c.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=s},clone:function(){return new z(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return z.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,n=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(n)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(y.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(y.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(y.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(y.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return z.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],n=0;n<8;n+=2)e.push(new y(t[n],t[n+1]));return e}},{getLength:function(){return null==this._length&&(this._length=z.getLength(this.getValues(),0,1)),this._length},getArea:function(){return z.getArea(this.getValues())},getLine:function(){return new M(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new z(z.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return z.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var n=null;if(t>=1e-8&&t<=1-1e-8){var r=z.subdivide(this.getValues(),t),i=r[0],a=r[1],o=e||this.hasHandles(),s=this._segment1,l=this._segment2,u=this._path;o&&(s._handleOut._set(i[2]-i[0],i[3]-i[1]),l._handleIn._set(a[4]-a[6],a[5]-a[7]));var c=i[6],h=i[7],d=new I(new y(c,h),o&&new y(i[4]-c,i[5]-h),o&&new y(a[2]-c,a[3]-h));u?(u.insert(s._index+1,d),n=this.getNext()):(this._segment2=d,this._changed(),n=new z(d,l))}return n},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===s?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===s?.5:e?t:this.getTimeAt(t))},reversed:function(){return new z(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,n,r){var i=t._point,a=t._handleOut,o=e._handleIn,s=e._point,l=i.x,u=i.y,c=s.x,h=s.y,d=r?[l,u,l,u,c,h,c,h]:[l,u,l+a._x,u+a._y,c+o._x,h+o._y,c,h];return n&&n._transformCoordinates(d,d,4),d},subdivide:function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],l=t[5],u=t[6],c=t[7];e===s&&(e=.5);var h=1-e,d=h*n+e*i,f=h*r+e*a,p=h*i+e*o,m=h*a+e*l,g=h*o+e*u,v=h*l+e*c,y=h*d+e*p,b=h*f+e*m,x=h*p+e*g,_=h*m+e*v,w=h*y+e*x,S=h*b+e*_;return[[n,r,d,f,y,b,w,S],[w,S,x,_,g,v,u,c]]},getMonoCurves:function(t,e){var n=[],r=e?0:1,i=t[r+0],a=t[r+2],o=t[r+4],s=t[r+6];if(i>=a==a>=o&&a>=o==o>=s||z.isStraight(t))n.push(t);else{var l=3*(a-o)-i+s,u=2*(i+o)-4*a,c=a-i,h=[],d=g.solveQuadratic(l,u,c,h,1e-8,1-1e-8);if(d){h.sort();var f=h[0],p=z.subdivide(t,f);n.push(p[0]),d>1&&(f=(h[1]-f)/(1-f),p=z.subdivide(p[1],f),n.push(p[0])),n.push(p[1])}else n.push(t)}return n},solveCubic:function(t,e,n,r,i,a){var o=t[e],s=t[e+2],l=t[e+4],u=t[e+6],c=0;if(!(o<n&&u<n&&s<n&&l<n||o>n&&u>n&&s>n&&l>n)){var h=3*(s-o),d=3*(l-s)-h,f=u-o-h-d;c=g.solveCubic(f,d,h,o-n,r,i,a)}return c},getTimeOf:function(t,e){var n=new y(t[0],t[1]),r=new y(t[6],t[7]);if(null===(e.isClose(n,1e-12)?0:e.isClose(r,1e-12)?1:null))for(var i=[e.x,e.y],a=[],o=0;o<2;o++)for(var s=z.solveCubic(t,o,i[o],a,0,1),l=0;l<s;l++){var u=a[l];if(e.isClose(z.getPoint(t,u),1e-7))return u}return e.isClose(n,1e-7)?0:e.isClose(r,1e-7)?1:null},getNearestTime:function(t,e){if(z.isStraight(t)){var n=t[0],r=t[1],i=t[6]-n,a=t[7]-r,o=i*i+a*a;if(0===o)return 0;var s=((e.x-n)*i+(e.y-r)*a)/o;return s<1e-12?0:s>.999999999999?1:z.getTimeOf(t,new y(n+s*i,r+s*a))}var l=1/0,u=0;function c(n){if(n>=0&&n<=1){var r=e.getDistance(z.getPoint(t,n),!0);if(r<l)return l=r,u=n,!0}}for(var h=0;h<=100;h++)c(h/100);for(var d=.005;d>1e-8;)c(u-d)||c(u+d)||(d/=2);return u},getPart:function(t,e,n){var r=e>n;if(r){var i=e;e=n,n=i}return e>0&&(t=z.subdivide(t,e)[1]),n<1&&(t=z.subdivide(t,(n-e)/(1-e))[0]),r?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=3*i-2*n-l,h=3*a-2*r-u,d=3*o-2*l-n,f=3*s-2*u-r;return Math.max(c*c,d*d)+Math.max(h*h,f*f)<=16*e*e},getArea:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7];return 3*((l-n)*(r+a)-(s-e)*(i+o)+i*(e-a)-r*(n-o)+l*(a+e/3)-s*(o+n/3))/20},getBounds:function(t){for(var e=t.slice(0,2),n=e.slice(),r=[0,0],i=0;i<2;i++)z._addBounds(t[i],t[i+2],t[i+4],t[i+6],i,0,e,n,r);return new w(e[0],e[1],n[0]-e[0],n[1]-e[1])},_addBounds:function(t,e,n,r,i,a,o,s,l){function u(t,e){var n=t-e,r=t+e;n<o[i]&&(o[i]=n),r>s[i]&&(s[i]=r)}a/=2;var c=o[i]+a,h=s[i]-a;if(t<c||e<c||n<c||r<c||t>h||e>h||n>h||r>h)if(e<t!=e<r&&n<t!=n<r)u(t,0),u(r,0);else{var d=3*(e-n)-t+r,f=2*(t+n)-4*e,p=e-t,m=g.solveQuadratic(d,f,p,l);u(r,0);for(var v=0;v<m;v++){var y=l[v],b=1-y;1e-8<=y&&y<=1-1e-8&&u(b*b*b*t+3*b*b*y*e+3*b*y*y*n+y*y*y*r,a)}}}}},c.each(["getBounds","getStrokeBounds","getHandleBounds"],(function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=V[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}}),{}),c.each({isStraight:function(t,e,n,r){if(e.isZero()&&n.isZero())return!0;var i=r.subtract(t);if(i.isZero())return!1;if(i.isCollinear(e)&&i.isCollinear(n)){var a=new M(t,r);if(a.getDistance(t.add(e))<1e-7&&a.getDistance(r.add(n))<1e-7){var o=i.dot(i),s=i.dot(e)/o,l=i.dot(n)/o;return s>=0&&s<=1&&l<=0&&l>=-1}}return!1},isLinear:function(t,e,n,r){var i=r.subtract(t).divide(3);return e.equals(i)&&n.negate().equals(i)}},(function(t,e){this[e]=function(e){var n=this._segment1,r=this._segment2;return t(n._point,n._handleOut,r._handleIn,r._point,e)},this.statics[e]=function(e,n){var r=e[0],i=e[1],a=e[6],o=e[7];return t(new y(r,i),new y(e[2]-r,e[3]-i),new y(e[4]-a,e[5]-o),new y(a,o),n)}}),{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new F(this,t):null},getTimeAt:function(t,e){return z.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=y.read(arguments);return t.isZero()?[]:z.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(y.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return z.getTimeOf(this.getValues(),y.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=y.read(arguments),e=this.getValues(),n=z.getNearestTime(e,t),r=z.getPoint(e,n);return new F(this,n,r,null,t.getDistance(r))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return c.each(t,(function(t){this[t+"At"]=function(e,n){var r=this.getValues();return z[t](r,n?e:z.getTimeAt(r,e))},this[t+"AtTime"]=function(e){return z[t](this.getValues(),e)}}),{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=9*(r-a)+3*(s-e),c=6*(e+a)-12*r,h=3*(r-e),d=9*(i-o)+3*(l-n),f=6*(n+o)-12*i,p=3*(i-n);return function(t){var e=(u*t+c)*t+h,n=(d*t+f)*t+p;return Math.sqrt(e*e+n*n)}}function e(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function n(t,e,n,r){if(null==e||e<0||e>1)return null;var i=t[0],a=t[1],o=t[2],s=t[3],l=t[4],u=t[5],c=t[6],h=t[7],d=g.isZero;d(o-i)&&d(s-a)&&(o=i,s=a),d(l-c)&&d(u-h)&&(l=c,u=h);var f,p,m=3*(o-i),v=3*(l-o)-m,b=c-i-m-v,x=3*(s-a),_=3*(u-s)-x,w=h-a-x-_;if(0===n)f=0===e?i:1===e?c:((b*e+v)*e+m)*e+i,p=0===e?a:1===e?h:((w*e+_)*e+x)*e+a;else{if(e<1e-8?(f=m,p=x):e>1-1e-8?(f=3*(c-l),p=3*(h-u)):(f=(3*b*e+2*v)*e+m,p=(3*w*e+2*_)*e+x),r){0===f&&0===p&&(e<1e-8||e>1-1e-8)&&(f=l-o,p=u-s);var S=Math.sqrt(f*f+p*p);S&&(f/=S,p/=S)}if(3===n){l=6*b*e+2*v,u=6*w*e+2*_;var E=Math.pow(f*f+p*p,1.5);f=0!==E?(f*u-p*l)/E:0,p=0}}return 2===n?new y(p,-f):new y(f,p)}return{statics:{classify:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],l=t[6],u=t[7],c=r*(n-u)+i*(l-e)+e*u-n*l,h=3*(a*(i-n)+o*(e-r)+r*n-i*e),d=h-c,f=d-c+(e*(u-o)+n*(a-l)+l*o-u*a),p=Math.sqrt(f*f+d*d+h*h),m=0!==p?1/p:0,v=g.isZero;function y(t,e,n){var r=e!==s,i=r&&e>0&&e<1,a=r&&n>0&&n<1;return!r||(i||a)&&("loop"!==t||i&&a)||(t="arch",i=a=!1),{type:t,roots:i||a?i&&a?e<n?[e,n]:[n,e]:[i?e:n]:null}}if(d*=m,h*=m,v(f*=m))return v(d)?y(v(h)?"line":"quadratic"):y("serpentine",h/(3*d));var b=3*d*d-4*f*h;if(v(b))return y("cusp",d/(2*f));var x=b>0?Math.sqrt(b/3):Math.sqrt(-b),_=2*f;return y(b>0?"serpentine":"loop",(d+x)/_,(d-x)/_)},getLength:function(n,r,i,a){if(r===s&&(r=0),i===s&&(i=1),z.isStraight(n)){var o=n;i<1&&(o=z.subdivide(o,i)[0],r/=i),r>0&&(o=z.subdivide(o,r)[1]);var l=o[6]-o[0],u=o[7]-o[1];return Math.sqrt(l*l+u*u)}return g.integrate(a||t(n),r,i,e(r,i))},getTimeAt:function(n,r,i){if(i===s&&(i=r<0?1:0),0===r)return i;var a=Math.abs,o=r>0,l=o?i:0,u=o?1:i,c=t(n),h=z.getLength(n,l,u,c),d=a(r)-h;if(a(d)<1e-12)return o?u:l;if(d>1e-12)return null;var f=r/h,p=0;return g.findRoot((function(t){return p+=g.integrate(c,i,t,e(i,t)),i=t,p-r}),c,i+f,l,u,32,1e-12)},getPoint:function(t,e){return n(t,e,0,!1)},getTangent:function(t,e){return n(t,e,1,!0)},getWeightedTangent:function(t,e){return n(t,e,1,!1)},getNormal:function(t,e){return n(t,e,2,!0)},getWeightedNormal:function(t,e){return n(t,e,2,!1)},getCurvature:function(t,e){return n(t,e,3,!1).x},getPeaks:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=3*r-e-3*a+t[6],l=3*e-6*r+3*a,u=-3*e+3*r,c=3*i-n-3*o+t[7],h=3*n-6*i+3*o,d=-3*n+3*i,f=[];return g.solveCubic(9*(s*s+c*c),9*(s*l+h*c),2*(l*l+h*h)+3*(u*s+d*c),u*l+h*d,f,1e-8,1-1e-8),f.sort()}}}},new function(){function t(t,e,n,r,i,a,o){var s=!o&&n.getPrevious()===i,l=!o&&n!==i&&n.getNext()===i;if(null!==r&&r>=(s?1e-8:0)&&r<=(l?1-1e-8:1)&&null!==a&&a>=(l?1e-8:0)&&a<=(s?1-1e-8:1)){var u=new F(n,r,null,o),c=new F(i,a,null,o);u._intersection=c,c._intersection=u,e&&!e(u)||F.insert(t,u,!0)}}function e(r,i,a,o,s,l,u,c,h,d,f,p,m){if(++h>=4096||++c>=40)return h;var g,v,y=i[0],b=i[1],x=i[6],_=i[7],w=M.getSignedDistance,S=w(y,b,x,_,i[2],i[3]),E=w(y,b,x,_,i[4],i[5]),C=S*E>0?3/4:4/9,T=C*Math.min(0,S,E),k=C*Math.max(0,S,E),P=w(y,b,x,_,r[0],r[1]),A=w(y,b,x,_,r[2],r[3]),O=w(y,b,x,_,r[4],r[5]),N=w(y,b,x,_,r[6],r[7]),R=function(t,e,n,r){var i,a=[0,t],o=[1/3,e],s=[2/3,n],l=[1,r],u=e-(2*t+r)/3,c=n-(t+2*r)/3;if(u*c<0)i=[[a,o,l],[a,s,l]];else{var h=u/c;i=[h>=2?[a,o,l]:h<=.5?[a,s,l]:[a,o,s,l],[a,l]]}return(u||c)<0?i.reverse():i}(P,A,O,N),L=R[0],I=R[1];if(0===S&&0===E&&0===P&&0===A&&0===O&&0===N||null==(g=n(L,I,T,k))||null==(v=n(L.reverse(),I.reverse(),T,k)))return h;var D=d+(f-d)*g,F=d+(f-d)*v;if(Math.max(m-p,F-D)<1e-9){var B=(D+F)/2,V=(p+m)/2;t(s,l,u?o:a,u?V:B,u?a:o,u?B:V)}else{r=z.getPart(r,g,v);var j=m-p;if(v-g>.8)if(F-D>j){B=(D+F)/2;h=e(i,(H=z.subdivide(r,.5))[0],o,a,s,l,!u,c,h,p,m,D,B),h=e(i,H[1],o,a,s,l,!u,c,h,p,m,B,F)}else{var H;V=(p+m)/2;h=e((H=z.subdivide(i,.5))[0],r,o,a,s,l,!u,c,h,p,V,D,F),h=e(H[1],r,o,a,s,l,!u,c,h,V,m,D,F)}else h=0===j||j>=1e-9?e(i,r,o,a,s,l,!u,c,h,p,m,D,F):e(r,i,a,o,s,l,u,c,h,D,F,p,m)}return h}function n(t,e,n,i){return t[0][1]<n?r(t,!0,n):e[0][1]>i?r(e,!1,i):t[0][0]}function r(t,e,n){for(var r=t[0][0],i=t[0][1],a=1,o=t.length;a<o;a++){var s=t[a][0],l=t[a][1];if(e?l>=n:l<=n)return l===n?s:r+(n-i)*(s-r)/(l-i);r=s,i=l}return null}function i(t,e,n,r,i){var a=g.isZero;if(a(r)&&a(i)){var o=z.getTimeOf(t,new y(e,n));return null===o?[]:[o]}for(var s=Math.atan2(-i,r),l=Math.sin(s),u=Math.cos(s),c=[],h=[],d=0;d<8;d+=2){var f=t[d]-e,p=t[d+1]-n;c.push(f*u-p*l,f*l+p*u)}return z.solveCubic(c,1,0,h,0,1),h}function a(e,n,r,a,o,s,l){for(var u=n[0],c=n[1],h=i(e,u,c,n[6]-u,n[7]-c),d=0,f=h.length;d<f;d++){var p=h[d],m=z.getPoint(e,p),g=z.getTimeOf(n,m);null!==g&&t(o,s,l?a:r,l?g:p,l?r:a,l?p:g)}}function o(e,n,r,i,a,o){var s=M.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);s&&t(a,o,r,z.getTimeOf(e,s),i,z.getTimeOf(n,s))}function s(n,r,i,s,l,c){var h=Math.min,d=Math.max;if(d(n[0],n[2],n[4],n[6])+1e-12>h(r[0],r[2],r[4],r[6])&&h(n[0],n[2],n[4],n[6])-1e-12<d(r[0],r[2],r[4],r[6])&&d(n[1],n[3],n[5],n[7])+1e-12>h(r[1],r[3],r[5],r[7])&&h(n[1],n[3],n[5],n[7])-1e-12<d(r[1],r[3],r[5],r[7])){var f=u(n,r);if(f)for(var p=0;p<2;p++){var m=f[p];t(l,c,i,m[0],s,m[1],!0)}else{var g=z.isStraight(n),v=z.isStraight(r),b=g&&v,x=g&&!v,_=l.length;if((b?o:g||v?a:e)(x?r:n,x?n:r,x?s:i,x?i:s,l,c,x,0,0,0,1,0,1),!b||l.length===_)for(p=0;p<4;p++){var w=p>>1,S=1&p,E=6*w,M=6*S,C=new y(n[E],n[E+1]),T=new y(r[M],r[M+1]);C.isClose(T,1e-12)&&t(l,c,i,w,s,S)}}}return l}function l(e,n,r,i){var a=z.classify(e);if("loop"===a.type){var o=a.roots;t(r,i,n,o[0],n,o[1])}return r}function u(t,e){function n(t){var e=t[6]-t[0],n=t[7]-t[1];return e*e+n*n}var r=Math.abs,i=M.getDistance,a=z.isStraight(t),o=z.isStraight(e),s=a&&o,l=n(t)<n(e),u=l?e:t,c=l?t:e,h=u[0],d=u[1],f=u[6]-h,p=u[7]-d;if(i(h,d,f,p,c[0],c[1],!0)<1e-7&&i(h,d,f,p,c[6],c[7],!0)<1e-7)!s&&i(h,d,f,p,u[2],u[3],!0)<1e-7&&i(h,d,f,p,u[4],u[5],!0)<1e-7&&i(h,d,f,p,c[2],c[3],!0)<1e-7&&i(h,d,f,p,c[4],c[5],!0)<1e-7&&(a=o=s=!0);else if(s)return null;if(a^o)return null;for(var m=[t,e],g=[],v=0;v<4&&g.length<2;v++){var b=1&v,x=1^b,_=v>>1,w=z.getTimeOf(m[b],new y(m[x][_?6:0],m[x][_?7:1]));if(null!=w){var S=b?[_,w]:[w,_];(!g.length||r(S[0]-g[0][0])>1e-8&&r(S[1]-g[0][1])>1e-8)&&g.push(S)}if(v>2&&!g.length)break}if(2!==g.length)g=null;else if(!s){var E=z.getPart(t,g[0][0],g[1][0]),C=z.getPart(e,g[0][1],g[1][1]);(r(C[2]-E[2])>1e-7||r(C[3]-E[3])>1e-7||r(C[4]-E[4])>1e-7||r(C[5]-E[5])>1e-7)&&(g=null)}return g}return{getIntersections:function(t){var e=this.getValues(),n=t&&t!==this&&t.getValues();return n?s(e,n,this,t,[]):l(e,this,[])},statics:{getOverlaps:u,getIntersections:function(t,e,n,r,i,a){var o=!e;o&&(e=t);for(var u=t.length,c=e.length,h=new Array(u),d=o?h:new Array(c),f=[],m=0;m<u;m++)h[m]=t[m].getValues(r);if(!o)for(m=0;m<c;m++)d[m]=e[m].getValues(i);for(var g=p.findCurveBoundsCollisions(h,d,1e-7),v=0;v<u;v++){var y=t[v],b=h[v];o&&l(b,y,f,n);var x=g[v];if(x)for(var _=0;_<x.length;_++){if(a&&f.length)return f;var w=x[_];if(!o||w>v){var S=e[w];s(b,d[w],y,S,f,n)}}}return f},getCurveLineIntersections:i,getTimesWithTangent:function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=e.normalize(),h=c.x,d=c.y,f=3*l-9*o+9*i-3*n,p=3*u-9*s+9*a-3*r,m=6*o-12*i+6*n,v=6*s-12*a+6*r,y=3*i-3*n,b=3*a-3*r,x=2*f*d-2*p*h,_=[];if(Math.abs(x)<g.CURVETIME_EPSILON){if(0!=(x=f*v-p*m)){var w=-(f*b-p*y)/x;w>=0&&w<=1&&_.push(w)}}else{var S=(m*m-4*f*y)*d*d+(-2*m*v+4*p*y+4*f*b)*h*d+(v*v-4*p*b)*h*h,E=m*d-v*h;if(S>=0&&0!=x){var M=Math.sqrt(S),C=-(E+M)/x,T=(-E+M)/x;C>=0&&C<=1&&_.push(C),T>=0&&T<=1&&_.push(T)}}return _}}}}),F=c.extend({_class:"CurveLocation",initialize:function(t,e,n,r,i){if(e>=.99999999){var a=t.getNext();a&&(e=0,t=a)}this._setCurve(t),this._time=e,this._point=n||t.getPointAtTime(e),this._overlap=r,this._distance=i,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),n=this.getTime();0===n?t=e._segment1:1===n?t=e._segment2:null!=n&&(t=e.getPartLength(0,n)<e.getPartLength(n,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function n(t){var n=t&&t.getCurve();if(n&&null!=(e._time=n.getTimeOf(e._point)))return e._setCurve(n),n}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),n=this.getIndex();if(e&&null!=n)for(var r=e.getCurves(),i=0;i<n;i++)t+=r[i].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),n=this.getTime();this._curveOffset=t=null!=n&&e&&e.getPartLength(0,n)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,n=t&&t.splitAtTime(this.getTime());return n&&this._setSegment(e.getLastSegment()),n},equals:function(t,e){var n=this===t;if(!n&&t instanceof F){var r=this.getCurve(),i=t.getCurve(),a=r._path;if(a===i._path){var o=Math.abs,s=o(this.getOffset()-t.getOffset()),l=!e&&this._intersection,u=!e&&t._intersection;n=(s<1e-7||a&&o(a.getLength()-s)<1e-7)&&(!l&&!u||l&&u&&l.equals(u,!0))}}return n},toString:function(){var t=[],e=this.getPoint(),n=m.instance;e&&t.push("point: "+e);var r=this.getIndex();null!=r&&t.push("index: "+r);var i=this.getTime();return null!=i&&t.push("time: "+n.number(i)),null!=this._distance&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),n=t.getCurve();return!(e.isStraight()&&n.isStraight()&&e.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),n=t.getTime(),r=e>=1e-8&&e<=1-1e-8,i=n>=1e-8&&n<=1-1e-8;if(r&&i)return!this.isTouching();var a=this.getCurve(),o=a&&e<1e-8?a.getPrevious():a,s=t.getCurve(),l=s&&n<1e-8?s.getPrevious():s;if(e>1-1e-8&&(a=a.getNext()),n>1-1e-8&&(s=s.getNext()),!(o&&a&&l&&s))return!1;var u=[];function c(t,e){var n=t.getValues(),r=z.classify(n).roots||z.getPeaks(n),i=r.length,a=z.getLength(n,e&&i?r[i-1]:0,!e&&i?r[0]:1);u.push(i?a:a/32)}function h(t,e,n){return e<n?t>e&&t<n:t>e||t<n}r||(c(o,!0),c(a,!1)),i||(c(l,!0),c(s,!1));var d=this.getPoint(),f=Math.min.apply(Math,u),p=r?a.getTangentAtTime(e):a.getPointAt(f).subtract(d),m=r?p.negate():o.getPointAt(-f).subtract(d),g=i?s.getTangentAtTime(n):s.getPointAt(f).subtract(d),v=i?g.negate():l.getPointAt(-f).subtract(d),y=m.getAngle(),b=p.getAngle(),x=v.getAngle(),_=g.getAngle();return!!(r?h(y,x,_)^h(b,x,_)&&h(y,_,x)^h(b,_,x):h(x,y,b)^h(_,y,b)&&h(x,b,y)^h(_,b,y))},hasOverlap:function(){return!!this._overlap}},c.each(z._evaluateMethods,(function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),n=this.getTime();return null!=n&&t&&t[e](n,!0)}}),{preserve:!0}),new function(){function t(t,e,n){var r=t.length,i=0,a=r-1;function o(n,i){for(var a=n+i;a>=-1&&a<=r;a+=i){var o=t[(a%r+r)%r];if(!e.getPoint().isClose(o.getPoint(),1e-7))break;if(e.equals(o))return o}return null}for(;i<=a;){var s,l=i+a>>>1,u=t[l];if(n&&(s=e.equals(u)?u:o(l,-1)||o(l,1)))return e._overlap&&(s._overlap=s._intersection._overlap=!0),s;var c=e.getPath(),h=u.getPath();(c!==h?c._id-h._id:e.getIndex()+e.getTime()-(u.getIndex()+u.getTime()))<0?a=l-1:i=l+1}return t.splice(i,0,e),e}return{statics:{insert:t,expand:function(e){for(var n=e.slice(),r=e.length-1;r>=0;r--)t(n,e[r]._intersection,!1);return n}}}}),B=T.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,n,r;if(c.isPlainObject(t)?(n=t.segments,e=t.pathData):Array.isArray(t)?n=t:"string"==typeof t&&(e=t),n){var i=n[0];r=i&&Array.isArray(i[0])}else e&&(r=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(r?j:V)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,n,r,i=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),a=!1,o=new y,s=new y;function l(t,n){var r=+e[t];return a&&(r+=o[n]),r}function u(t){return new y(l(t,"x"),l(t+1,"y"))}this.clear();for(var c=0,h=i&&i.length;c<h;c++){var d=i[c],f=d[0],p=f.toLowerCase(),m=(e=d.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(a=f===p,"z"!==n||/[mz]/.test(p)||this.moveTo(o),p){case"m":case"l":for(var g="m"===p,v=0;v<m;v+=2)this[g?"moveTo":"lineTo"](o=u(v)),g&&(s=o,g=!1);r=o;break;case"h":case"v":var b="h"===p?"x":"y";o=o.clone();for(v=0;v<m;v++)o[b]=l(v,b),this.lineTo(o);r=o;break;case"c":for(v=0;v<m;v+=6)this.cubicCurveTo(u(v),r=u(v+2),o=u(v+4));break;case"s":for(v=0;v<m;v+=4)this.cubicCurveTo(/[cs]/.test(n)?o.multiply(2).subtract(r):o,r=u(v),o=u(v+2)),n=p;break;case"q":for(v=0;v<m;v+=4)this.quadraticCurveTo(r=u(v),o=u(v+2));break;case"t":for(v=0;v<m;v+=2)this.quadraticCurveTo(r=/[qt]/.test(n)?o.multiply(2).subtract(r):o,o=u(v)),n=p;break;case"a":for(v=0;v<m;v+=7)this.arcTo(o=u(v+5),new x(+e[v],+e[v+1]),+e[v+2],+e[v+4],+e[v+3]);break;case"z":this.closePath(1e-12),o=s}n=p}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,n,r){var i=this===t||!t,a=this._matrix._orNullIfIdentity(),o=i?a:(n||t._matrix)._orNullIfIdentity();return i||this.getBounds(a).intersects(t.getBounds(o),1e-12)?z.getIntersections(this.getCurves(),!i&&t.getCurves(),e,a,o,r):[]},getCrossings:function(t){return this.getIntersections(t,(function(t){return t.isCrossing()}))},getNearestLocation:function(){for(var t=y.read(arguments),e=this.getCurves(),n=1/0,r=null,i=0,a=e.length;i<a;i++){var o=e[i].getNearestLocation(t);o._distance<n&&(n=o._distance,r=o)}return r},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,n){var r=!this._children,i=r?"_segments":"_children",a=t[i],o=e[i],s=this[i];if(!a||!o||a.length!==o.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var l=s.length,u=o.length;if(l<u)for(var c=r?I:V,h=l;h<u;h++)this.add(new c);else l>u&&this[r?"removeSegments":"removeChildren"](u,l);for(h=0;h<u;h++)s[h].interpolate(a[h],o[h],n);r&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var n=this._children||[this],r=t._children?t._children.slice():[t],i=n.length,a=r.length,o=[],s=0;e=!0;for(var l=p.findItemBoundsCollisions(n,r,g.GEOMETRIC_EPSILON),u=i-1;u>=0&&e;u--){var c=n[u];e=!1;var h=l[u];if(h)for(var d=h.length-1;d>=0&&!e;d--)c.compare(r[h[d]])&&(o[h[d]]||(o[h[d]]=!0,s++),e=!0)}e=e&&s===a}return e}}),V=B.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var e=arguments,n=Array.isArray(t)?"object"==typeof t[0]?t:e:!t||t.size!==s||t.x===s&&t.point===s?null:e;n&&n.length>0?this.setSegments(n):(this._curves=s,this._segmentSelection=0,n||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!n&&t)},_equals:function(t){return this._closed===t._closed&&c.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),8&e){if(this._length=this._area=s,32&e)this._version++;else if(this._curves)for(var n=0,r=this._curves.length;n<r;n++)this._curves[n]._changed()}else 64&e&&(this._bounds=s)},getStyle:function(){var t=this._parent;return(t instanceof j?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),n=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=s,n){var r=t[n-1];"boolean"==typeof r&&(this.setClosed(r),n--),this._add(I.readList(t,0,{},n))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var r=0;r<n;r++)t[r]=new z(this,e[r],e[r+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new z(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var n,r,i,a,o,s,l,u,c=this._segments,h=c.length,d=new m(e),f=new Array(6),p=!0,g=[];function v(e,c){if(e._transformCoordinates(t,f),n=f[0],r=f[1],p)g.push("M"+d.pair(n,r)),p=!1;else if(o=f[2],s=f[3],o===n&&s===r&&l===i&&u===a){if(!c){var h=n-i,m=r-a;g.push(0===h?"v"+d.number(m):0===m?"h"+d.number(h):"l"+d.pair(h,m))}}else g.push("c"+d.pair(l-i,u-a)+" "+d.pair(o-i,s-a)+" "+d.pair(n-i,r-a));i=n,a=r,l=f[4],u=f[5]}if(!h)return"";for(var y=0;y<h;y++)v(c[y]);return this._closed&&h>0&&(v(c[0],!0),g.push("z")),g.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,n=new Array(6),r=0,i=e.length;r<i;r++)e[r]._transformCoordinates(t,n,!0);return!0},_add:function(t,e){for(var n=this._segments,r=this._curves,i=t.length,a=null==e,o=(e=a?n.length:e,0);o<i;o++){var s=t[o];s._path&&(s=t[o]=s.clone()),s._path=this,s._index=e+o,s._selection&&this._updateSelection(s,0,s._selection)}if(a)c.push(n,t);else{n.splice.apply(n,[e,0].concat(t));o=e+i;for(var l=n.length;o<l;o++)n[o]._index=o}if(r){var u=this._countCurves(),h=e>0&&e+i-1===u?e-1:e,d=h,f=Math.min(h+i,u);t._curves&&(r.splice.apply(r,[h,0].concat(t._curves)),d+=t._curves.length);for(o=d;o<f;o++)r.splice(o,0,new z(this,null,null));this._adjustCurves(h,f)}return this._changed(41),t},_adjustCurves:function(t,e){for(var n,r=this._segments,i=this._curves,a=t;a<e;a++)(n=i[a])._path=this,n._segment1=r[a],n._segment2=r[a+1]||r[0],n._changed();(n=i[this._closed&&!t?r.length-1:t-1])&&(n._segment2=r[t]||r[0],n._changed()),(n=i[e])&&(n._segment1=r[e],n._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(I.readList(e)):this._add([I.read(e)])[0]},insert:function(t,e){var n=arguments;return n.length>2&&"number"!=typeof e?this._add(I.readList(n,1),t):this._add([I.read(n,1)],t)[0]},addSegment:function(){return this._add([I.read(arguments)])[0]},insertSegment:function(t){return this._add([I.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(I.readList(t))},insertSegments:function(t,e){return this._add(I.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,n){t=t||0,e=c.pick(e,this._segments.length);var r=this._segments,i=this._curves,a=r.length,o=r.splice(t,e-t),s=o.length;if(!s)return o;for(var l=0;l<s;l++){var u=o[l];u._selection&&this._updateSelection(u,u._selection,0),u._index=u._path=null}l=t;for(var h=r.length;l<h;l++)r[l]._index=l;if(i){var d=t>0&&e===a+(this._closed?1:0)?t-1:t;for(l=(i=i.splice(d,s)).length-1;l>=0;l--)i[l]._path=null;n&&(o._curves=i.slice(1)),this._adjustCurves(d,d)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,n=0,r=t.length;n<r;n++)e+=t[n].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,n=this._closed;t=0;for(var r=0,i=e.length;r<i;r++){var a=r+1===i;t+=z.getArea(z.getValues(e[r],e[a?0:r+1],null,a&&!n))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,n=e.length,r=t?7:0;this._segmentSelection=r*n;for(var i=0;i<n;i++)e[i]._selection=r},_updateSelection:function(t,e,n){t._selection=n,(this._segmentSelection+=n-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,n=this.getLocationAt(t);return n&&(e=n.getCurve().divideAt(n.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),n=e&&e.index,r=e&&e.time;r>1-1e-8&&(n++,r=0);var i=this.getCurves();if(n>=0&&n<i.length){r>=1e-8&&i[n++].divideAtTime(r);var a,o=this.removeSegments(n,this._segments.length,!0);return this._closed?(this.setClosed(!1),a=this):((a=new V(T.NO_INSERT)).insertAbove(this),a.copyAttributes(this)),a._add(o,0),this.addSegment(o[0]),a}return null},split:function(t,e){var n,r=e===s?t:(n=this.getCurves()[t])&&n.getLocationAtTime(e);return null!=r?this.splitAt(r):null},join:function(t,e){var n=e||0;if(t&&t!==this){var r=t._segments,i=this.getLastSegment(),a=t.getLastSegment();if(!a)return this;i&&i._point.isClose(a._point,n)&&t.reverse();var o=t.getFirstSegment();if(i&&i._point.isClose(o._point,n))i.setHandleOut(o._handleOut),this._add(r.slice(1));else{var s=this.getFirstSegment();s&&s._point.isClose(o._point,n)&&t.reverse(),a=t.getLastSegment(),s&&s._point.isClose(a._point,n)?(s.setHandleIn(a._handleIn),this._add(r.slice(0,r.length-1),0)):this._add(r.slice())}t._closed&&this._add([r[0]]),t.remove()}var l=this.getFirstSegment(),u=this.getLastSegment();return l!==u&&l._point.isClose(u._point,n)&&(l.setHandleIn(u._handleIn),u.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),n=t&&t.simplify,r=n?1e-7:0,i=e.length-1;i>=0;i--){var a=e[i];!a.hasHandles()&&(!a.hasLength(r)||n&&a.isCollinear(a.getNext()))&&a.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var n=this._segments[t],r=n._handleIn;n._handleIn=n._handleOut,n._handleOut=r,n._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new H(this,t||.25,256,!0).parts,n=e.length,r=[],i=0;i<n;i++)r.push(new I(e[i].curve.slice(0,2)));!this._closed&&n>0&&r.push(new I(e[n-1].curve.slice(6))),this.setSegments(r)},simplify:function(t){var e=new U(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,n=t||{},r=n.type||"asymmetric",i=this._segments,a=i.length,o=this._closed;function l(t,n){var r=t&&t.index;if(null!=r){var i=t.path;if(i&&i!==e)throw new Error(t._class+" "+r+" of "+i+" is not part of "+e);n&&t instanceof z&&r++}else r="number"==typeof t?t:n;return Math.min(r<0&&o?r%a:r<0?r+a:r,a-1)}var u=o&&n.from===s&&n.to===s,c=l(n.from,0),h=l(n.to,a-1);if(c>h)if(o)c-=a;else{var d=c;c=h,h=d}if(/^(?:asymmetric|continuous)$/.test(r)){var f="asymmetric"===r,p=Math.min,m=h-c+1,g=m-1,v=u?p(m,4):1,y=v,b=v,x=[];if(o||(y=p(1,c),b=p(1,a-h-1)),(g+=y+b)<=1)return;for(var _=0,w=c-y;_<=g;_++,w++)x[_]=i[(w<0?w+a:w)%a]._point;var S=x[0]._x+2*x[1]._x,E=x[0]._y+2*x[1]._y,M=2,C=g-1,T=[S],k=[E],P=[M],A=[],O=[];for(_=1;_<g;_++){var N=_<C,R=N?4:f?2:7,L=N?4:f?3:8,I=N?2:f?0:1,D=(N||f?1:2)/M;M=P[_]=R-D,S=T[_]=L*x[_]._x+I*x[_+1]._x-D*S,E=k[_]=L*x[_]._y+I*x[_+1]._y-D*E}A[C]=T[C]/P[C],O[C]=k[C]/P[C];for(_=g-2;_>=0;_--)A[_]=(T[_]-A[_+1])/P[_],O[_]=(k[_]-O[_+1])/P[_];A[g]=(3*x[g]._x-A[C])/2,O[g]=(3*x[g]._y-O[C])/2;_=y;var F=g-b;for(w=c;_<=F;_++,w++){var B=i[w<0?w+a:w],V=B._point,j=A[_]-V._x,H=O[_]-V._y;(u||_<F)&&B.setHandleOut(j,H),(u||_>y)&&B.setHandleIn(-j,-H)}}else for(_=c;_<=h;_++)i[_<0?_+a:_].smooth(n,!u&&_===c,!u&&_===h)},toShape:function(t){if(!this._closed)return null;var e,n,r,i,a,o,l,u=this._segments;function c(t,e){var n=u[t],r=n.getNext(),i=u[e],a=i.getNext();return n._handleOut.isZero()&&r._handleIn.isZero()&&i._handleOut.isZero()&&a._handleIn.isZero()&&r._point.subtract(n._point).isCollinear(a._point.subtract(i._point))}function h(t){var e=u[t],n=e.getNext(),r=e._handleOut,i=n._handleIn,a=.5522847498307936;if(r.isOrthogonal(i)){var o=e._point,s=n._point,l=new M(o,r,!0).intersect(new M(s,i,!0),!0);return l&&g.isZero(r.getLength()/l.subtract(o).getLength()-a)&&g.isZero(i.getLength()/l.subtract(s).getLength()-a)}return!1}function d(t,e){return u[t]._point.getDistance(u[e]._point)}if(!this.hasHandles()&&4===u.length&&c(0,2)&&c(1,3)&&(a=u[1],o=a.getPrevious(),l=a.getNext(),o._handleOut.isZero()&&a._handleIn.isZero()&&a._handleOut.isZero()&&l._handleIn.isZero()&&a._point.subtract(o._point).isOrthogonal(l._point.subtract(a._point)))?(e=A.Rectangle,n=new x(d(0,3),d(0,1)),i=u[1]._point.add(u[2]._point).divide(2)):8===u.length&&h(0)&&h(2)&&h(4)&&h(6)&&c(1,5)&&c(3,7)?(e=A.Rectangle,r=(n=new x(d(1,6),d(0,3))).subtract(new x(d(0,7),d(1,2))).divide(2),i=u[3]._point.add(u[4]._point).divide(2)):4===u.length&&h(0)&&h(1)&&h(2)&&h(3)&&(g.isZero(d(0,2)-d(1,3))?(e=A.Circle,r=d(0,2)/2):(e=A.Ellipse,r=new x(d(2,0)/2,d(3,1)/2)),i=u[1]._point),e){var f=this.getPosition(!0),p=new e({center:f,size:n,radius:r,insert:!1});return p.copyAttributes(this,!0),p._matrix.prepend(this._matrix),p.rotate(i.subtract(f).getAngle()+90),(t===s||t)&&p.insertAbove(this),p}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof j)return t.base.call(this,e);var n=this.getCurves(),r=e.getCurves(),i=n.length,a=r.length;if(!i||!a)return i==a;for(var o,s,l=n[0].getValues(),u=[],c=0,h=0,d=0;d<a;d++){var f=r[d].getValues();if(u.push(f),g=z.getOverlaps(l,f)){o=!d&&g[0][0]>0?a-1:d,s=g[0][1];break}}var p,m=Math.abs;for(f=u[o];l&&f;){var g;if(g=z.getOverlaps(l,f))if(m(g[0][0]-h)<1e-8){1===(h=g[1][0])&&(l=++c<i?n[c].getValues():null,h=0);var v=g[0][1];if(m(v-s)<1e-8){if(p||(p=[o,v]),1===(s=g[1][1])&&(++o>=a&&(o=0),f=u[o]||r[o].getValues(),s=0),!l)return p[0]===o&&p[1]===s;continue}}break}return!1},_hitTestSelf:function(t,e,n,r){var i,a,o,s,l,u,c=this,h=this.getStyle(),d=this._segments,f=d.length,p=this._closed,m=e._tolerancePadding,g=m,v=e.stroke&&h.hasStroke(),y=e.fill&&h.hasFill(),b=e.curves,x=v?h.getStrokeWidth()/2:y&&e.tolerance>0||b?0:null;function _(e,n){return t.subtract(e).divide(n).length<=1}function w(t,n,r){if(!e.selected||n.isSelected()){var i=t._point;if(n!==i&&(n=n.add(i)),_(n,g))return new L(r,c,{segment:t,point:n})}}function S(t,n){return(n||e.segments)&&w(t,t._point,"segment")||!n&&e.handles&&(w(t,t._handleIn,"handle-in")||w(t,t._handleOut,"handle-out"))}function E(t){s.add(t)}function M(e){var n,l=p||e._index>0&&e._index<f-1;return"round"===(l?i:a)?_(e._point,g):(s=new V({internal:!0,closed:!0}),l?e.isSmooth()||V._addBevelJoin(e,i,x,o,null,r,E,!0):"square"===a&&V._addSquareCap(e,a,x,null,r,E,!0),s.isEmpty()?void 0:s.contains(t)||(n=s.getNearestLocation(t))&&_(n.getPoint(),m))}if(null!==x&&(x>0?(i=h.getStrokeJoin(),a=h.getStrokeCap(),o=h.getMiterLimit(),g=g.add(V._getStrokePadding(x,r))):i=a="round"),!e.ends||e.segments||p){if(e.segments||e.handles)for(var C=0;C<f;C++)if(u=S(d[C]))return u}else if(u=S(d[0],!0)||S(d[f-1],!0))return u;if(null!==x){if(l=this.getNearestLocation(t)){var T=l.getTime();0===T||1===T&&f>1?M(l.getSegment())||(l=null):_(l.getPoint(),g)||(l=null)}if(!l&&"miter"===i&&f>1)for(C=0;C<f;C++){var k=d[C];if(t.getDistance(k._point)<=o*x&&M(k)){l=k.getLocation();break}}}return!l&&y&&this._contains(t)||l&&!v&&!b?new L("fill",this):l?new L(v?"stroke":"curve",this,{location:l,point:l.getPoint()}):null}},c.each(z._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this.getLocationAt(e);return n&&n[t]()}}),{beans:!1,getLocationOf:function(){for(var t=y.read(arguments),e=this.getCurves(),n=0,r=e.length;n<r;n++){var i=e[n].getLocationOf(t);if(i)return i}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),n=0,r=0,i=e.length;r<i;r++){var a=n,o=e[r];if((n+=o.getLength())>t)return o.getLocationAt(t-a)}if(e.length>0&&t<=this.getLength())return new F(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=y.read(arguments);if(t.isZero())return[];for(var e=[],n=0,r=this.getCurves(),i=0,a=r.length;i<a;i++){for(var o=r[i],s=o.getTimesWithTangent(t),l=0,u=s.length;l<u;l++){var c=n+o.getOffsetAtTime(s[l]);e.indexOf(c)<0&&e.push(c)}n+=o.length}return e}}),new function(){function t(t,e,n){var r,i,a,o,s,l,u,c,h=e._segments,d=h.length,f=new Array(6),p=!0;function m(e){if(n)e._transformCoordinates(n,f),r=f[0],i=f[1];else{var h=e._point;r=h._x,i=h._y}if(p)t.moveTo(r,i),p=!1;else{if(n)s=f[2],l=f[3];else{var d=e._handleIn;s=r+d._x,l=i+d._y}s===r&&l===i&&u===a&&c===o?t.lineTo(r,i):t.bezierCurveTo(u,c,s,l,r,i)}if(a=r,o=i,n)u=f[4],c=f[5];else{d=e._handleOut;u=a+d._x,c=o+d._y}}for(var g=0;g<d;g++)m(h[g]);e._closed&&d>0&&m(h[0])}return{_draw:function(e,n,r,i){var a=n.dontStart,o=n.dontFinish||n.clip,s=this.getStyle(),l=s.hasFill(),u=s.hasStroke(),c=s.getDashArray(),h=!dt.support.nativeDash&&u&&c&&c.length;function d(t){return c[(t%h+h)%h]}if(a||e.beginPath(),(l||u&&!h||o)&&(t(e,this,i),this._closed&&e.closePath()),!o&&(l||u)&&(this._setStyles(e,n,r),l&&(e.fill(s.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),u)){if(h){a||e.beginPath();for(var f,p=new H(this,.25,32,!1,i),m=p.length,g=-s.getDashOffset(),v=0;g>0;)g-=d(v--)+d(v--);for(;g<m;)f=g+d(v++),(g>0||f>0)&&p.drawPart(e,Math.max(g,0),Math.max(f,0)),g=f+d(v++)}e.stroke()}},_drawSelected:function(e,n){e.beginPath(),t(e,this,n),e.stroke(),function(t,e,n,r){if(!(r<=0))for(var i,a,o=r/2,s=r-2,l=o-1,u=new Array(6),c=0,h=e.length;c<h;c++){var d=e[c],f=d._selection;if(d._transformCoordinates(n,u),i=u[0],a=u[1],2&f&&m(2),4&f&&m(4),t.fillRect(i-o,a-o,r,r),s>0&&!(1&f)){var p=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(i-l,a-l,s,s),t.fillStyle=p}}function m(e){var n=u[e],r=u[e+1];i==n&&a==r||(t.beginPath(),t.moveTo(i,a),t.lineTo(n,r),t.stroke(),t.beginPath(),t.arc(n,r,o,0,2*Math.PI,!0),t.fill())}}(e,this._segments,n,dt.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new I(y.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new I(y.read(arguments))])},cubicCurveTo:function(){var e=arguments,n=y.read(e),r=y.read(e),i=y.read(e),a=t(this);a.setHandleOut(n.subtract(a._point)),this._add([new I(i,r.subtract(i))])},quadraticCurveTo:function(){var e=arguments,n=y.read(e),r=y.read(e),i=t(this)._point;this.cubicCurveTo(n.add(i.subtract(n).multiply(1/3)),n.add(r.subtract(n).multiply(1/3)),r)},curveTo:function(){var e=arguments,n=y.read(e),r=y.read(e),i=c.pick(c.read(e),.5),a=1-i,o=t(this)._point,s=n.subtract(o.multiply(a*a)).subtract(r.multiply(i*i)).divide(2*i*a);if(s.isNaN())throw new Error("Cannot put a curve through points with parameter = "+i);this.quadraticCurveTo(s,r)},arcTo:function(){var e,n,r,i,a=arguments,o=Math.abs,s=Math.sqrt,l=t(this),u=l._point,h=y.read(a),d=c.peek(a);if("boolean"==typeof(b=c.pick(d,!0)))var f=(w=u.add(h).divide(2)).add(w.subtract(u).rotate(b?-90:90));else if(c.remain(a)<=2)f=h,h=y.read(a);else if(!u.equals(h)){var p=x.read(a),m=g.isZero;if(m(p.width)||m(p.height))return this.lineTo(h);var v=c.read(a),b=!!c.read(a),_=!!c.read(a),w=u.add(h).divide(2),S=(Y=u.subtract(w).rotate(-v)).x,C=Y.y,T=o(p.width),k=o(p.height),P=T*T,A=k*k,O=S*S,N=C*C,R=s(O/P+N/A);if(R>1&&(P=(T*=R)*T,A=(k*=R)*k),o(R=(P*A-P*N-A*O)/(P*N+A*O))<1e-12&&(R=0),R<0)throw new Error("Cannot create an arc with the given arguments");e=new y(T*C/k,-k*S/T).multiply((_===b?-1:1)*s(R)).rotate(v).add(w),n=(r=(i=(new E).translate(e).rotate(v).scale(T,k))._inverseTransform(u)).getDirectedAngle(i._inverseTransform(h)),!b&&n>0?n-=360:b&&n<0&&(n+=360)}if(f){var L=new M(u.add(f).divide(2),f.subtract(u).rotate(90),!0),D=new M(f.add(h).divide(2),h.subtract(f).rotate(90),!0),z=new M(u,h),F=z.getSide(f);if(!(e=L.intersect(D,!0))){if(!F)return this.lineTo(h);throw new Error("Cannot create an arc with the given arguments")}n=(r=u.subtract(e)).getDirectedAngle(h.subtract(e));var B=z.getSide(e,!0);0===B?n=F*o(n):F===B&&(n+=n<0?360:-360)}if(n){for(var V=1e-7,j=o(n),H=j>=360?4:Math.ceil((j-V)/90),U=n/H,G=U*Math.PI/360,q=4/3*Math.sin(G)/(1+Math.cos(G)),W=[],$=0;$<=H;$++){var Y=h,Q=null;if($<H&&(Q=r.rotate(90).multiply(q),i?(Y=i._transformPoint(r),Q=i._transformPoint(r.add(Q)).subtract(Y)):Y=e.add(r)),$){var X=r.rotate(-90).multiply(q);i&&(X=i._transformPoint(r.add(X)).subtract(Y)),W.push(new I(Y,X,Q))}else l.setHandleOut(Q);r=r.rotate(U)}this._add(W)}},lineBy:function(){var e=y.read(arguments),n=t(this)._point;this.lineTo(n.add(e))},curveBy:function(){var e=arguments,n=y.read(e),r=y.read(e),i=c.read(e),a=t(this)._point;this.curveTo(a.add(n),a.add(r),i)},cubicCurveBy:function(){var e=arguments,n=y.read(e),r=y.read(e),i=y.read(e),a=t(this)._point;this.cubicCurveTo(a.add(n),a.add(r),a.add(i))},quadraticCurveBy:function(){var e=arguments,n=y.read(e),r=y.read(e),i=t(this)._point;this.quadraticCurveTo(i.add(n),i.add(r))},arcBy:function(){var e=arguments,n=t(this)._point,r=n.add(y.read(e)),i=c.pick(c.peek(e),!0);"boolean"==typeof i?this.arcTo(r,i):this.arcTo(r,n.add(y.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){var n=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return V[n](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,n,r,i,a){var o=t[0];if(!o)return new w;var s=new Array(6),l=o._transformCoordinates(r,new Array(6)),u=l.slice(0,2),c=u.slice(),h=new Array(2);function d(t){t._transformCoordinates(r,s);for(var e=0;e<2;e++)z._addBounds(l[e],l[e+4],s[e+2],s[e],e,a?a[e]:0,u,c,h);var n=l;l=s,s=n}for(var f=1,p=t.length;f<p;f++)d(t[f]);return e&&d(o),new w(u[0],u[1],c[0]-u[0],c[1]-u[1])},getStrokeBounds:function(t,e,n,r,i){var a=n.getStyle(),o=a.hasStroke(),s=a.getStrokeWidth(),l=o&&n._getStrokeMatrix(r,i),u=o&&V._getStrokePadding(s,l),c=V.getBounds(t,e,n,r,i,u);if(!o)return c;var h=s/2,d=a.getStrokeJoin(),f=a.getStrokeCap(),p=a.getMiterLimit(),m=new w(new x(u));function g(t){c=c.include(t)}function v(t){c=c.unite(m.setCenter(t._point.transform(r)))}function y(t,e){"round"===e||t.isSmooth()?v(t):V._addBevelJoin(t,e,h,p,r,l,g)}function b(t,e){"round"===e?v(t):V._addSquareCap(t,e,h,r,l,g)}var _=t.length-(e?0:1);if(_>0){for(var S=1;S<_;S++)y(t[S],d);e?y(t[0],d):(b(t[0],f),b(t[t.length-1],f))}return c},_getStrokePadding:function(t,e){if(!e)return[t,t];var n=new y(t,0).transform(e),r=new y(0,t).transform(e),i=n.getAngleInRadians(),a=n.getLength(),o=r.getLength(),s=Math.sin(i),l=Math.cos(i),u=Math.tan(i),c=Math.atan2(o*u,a),h=Math.atan2(o,u*a);return[Math.abs(a*Math.cos(c)*l+o*Math.sin(c)*s),Math.abs(o*Math.sin(h)*l+a*Math.cos(h)*s)]},_addBevelJoin:function(t,e,n,r,i,a,o,s){var l=t.getCurve(),u=l.getPrevious(),c=l.getPoint1().transform(i),h=u.getNormalAtTime(1).multiply(n).transform(a),d=l.getNormalAtTime(0).multiply(n).transform(a),f=h.getDirectedAngle(d);if((f<0||f>=180)&&(h=h.negate(),d=d.negate()),s&&o(c),o(c.add(h)),"miter"===e){var p=new M(c.add(h),new y(-h.y,h.x),!0).intersect(new M(c.add(d),new y(-d.y,d.x),!0),!0);p&&c.getDistance(p)<=r*n&&o(p)}o(c.add(d))},_addSquareCap:function(t,e,n,r,i,a,o){var s=t._point.transform(r),l=t.getLocation(),u=l.getNormal().multiply(0===l.getTime()?n:-n).transform(i);"square"===e&&(o&&(a(s.subtract(u)),a(s.add(u))),s=s.add(u.rotate(-90))),a(s.add(u)),a(s.subtract(u))},getHandleBounds:function(t,e,n,r,i){var a,o,s=n.getStyle();if(i.stroke&&s.hasStroke()){var l=n._getStrokeMatrix(r,i),u=s.getStrokeWidth()/2,c=u;"miter"===s.getStrokeJoin()&&(c=u*s.getMiterLimit()),"square"===s.getStrokeCap()&&(c=Math.max(c,u*Math.SQRT2)),a=V._getStrokePadding(u,l),o=V._getStrokePadding(c,l)}for(var h=new Array(6),d=1/0,f=-d,p=d,m=f,g=0,v=t.length;g<v;g++){t[g]._transformCoordinates(r,h);for(var y=0;y<6;y+=2){var b=y?a:o,x=b?b[0]:0,_=b?b[1]:0,S=h[y],E=h[y+1],M=S-x,C=S+x,T=E-_,k=E+_;M<d&&(d=M),C>f&&(f=C),T<p&&(p=T),k>m&&(m=k)}}return new w(d,p,f-d,m-p)}}});V.inject({statics:new function(){var t=.5522847498307936,e=[new I([-1,0],[0,t],[0,-t]),new I([0,-1],[-t,0],[t,0]),new I([1,0],[0,-t],[0,t]),new I([0,1],[t,0],[-t,0])];function n(t,e,n){var r=c.getNamed(n),i=new V(r&&0==r.insert&&T.NO_INSERT);return i._add(t),i._closed=e,i.set(r,{insert:!0})}function r(t,r,i){for(var a=new Array(4),o=0;o<4;o++){var s=e[o];a[o]=new I(s._point.multiply(r).add(t),s._handleIn.multiply(r),s._handleOut.multiply(r))}return n(a,!0,i)}return{Line:function(){var t=arguments;return n([new I(y.readNamed(t,"from")),new I(y.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,e=y.readNamed(t,"center"),n=c.readNamed(t,"radius");return r(e,new x(n),t)},Rectangle:function(){var e,r=arguments,i=w.readNamed(r,"rectangle"),a=x.readNamed(r,"radius",0,{readNull:!0}),o=i.getBottomLeft(!0),s=i.getTopLeft(!0),l=i.getTopRight(!0),u=i.getBottomRight(!0);if(!a||a.isZero())e=[new I(o),new I(s),new I(l),new I(u)];else{var c=(a=x.min(a,i.getSize(!0).divide(2))).width,h=a.height,d=c*t,f=h*t;e=[new I(o.add(c,0),null,[-d,0]),new I(o.subtract(0,h),[0,f]),new I(s.add(0,h),null,[0,-f]),new I(s.add(c,0),[-d,0],null),new I(l.subtract(c,0),null,[d,0]),new I(l.add(0,h),[0,-f],null),new I(u.subtract(0,h),null,[0,f]),new I(u.subtract(c,0),[d,0])]}return n(e,!0,r)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=A._readEllipse(t);return r(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=y.readNamed(t,"from"),n=y.readNamed(t,"through"),r=y.readNamed(t,"to"),i=c.getNamed(t),a=new V(i&&0==i.insert&&T.NO_INSERT);return a.moveTo(e),a.arcTo(n,r),a.set(i)},RegularPolygon:function(){for(var t=arguments,e=y.readNamed(t,"center"),r=c.readNamed(t,"sides"),i=c.readNamed(t,"radius"),a=360/r,o=r%3==0,s=new y(0,o?-i:i),l=o?-1:.5,u=new Array(r),h=0;h<r;h++)u[h]=new I(e.add(s.rotate((h+l)*a)));return n(u,!0,t)},Star:function(){for(var t=arguments,e=y.readNamed(t,"center"),r=2*c.readNamed(t,"points"),i=c.readNamed(t,"radius1"),a=c.readNamed(t,"radius2"),o=360/r,s=new y(0,-1),l=new Array(r),u=0;u<r;u++)l[u]=new I(e.add(s.rotate(o*u).multiply(u%2?a:i)));return n(l,!0,t)}}}});var j=B.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,n){var r=n,i=r[0];i&&"number"==typeof i[0]&&(r=[r]);for(var a=n.length-1;a>=0;a--){var o=r[a];r!==n||o instanceof V||(r=c.slice(r)),Array.isArray(o)?r[a]=new V({segments:o,insert:!1}):o instanceof j&&(r.splice.apply(r,[a,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,r)},reduce:function t(e){for(var n=this._children,r=n.length-1;r>=0;r--){var i;(i=n[r].reduce(e)).isEmpty()&&i.remove()}return n.length?t.base.call(this):((i=new V(T.NO_INSERT)).copyAttributes(this),i.insertAbove(this),this.remove(),i)},isClosed:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,n=0,r=e.length;n<r;n++)e[n].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],n=0,r=t.length;n<r;n++)c.push(e,t[n].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,n=0,r=t.length;n<r;n++)e+=t[n].getArea();return e},getLength:function(){for(var t=this._children,e=0,n=0,r=t.length;n<r;n++)e+=t[n].getLength();return e},getPathData:function(t,e){for(var n=this._children,r=[],i=0,a=n.length;i<a;i++){var o=n[i],s=o._matrix;r.push(o.getPathData(t&&!s.isIdentity()?t.appended(s):t,e))}return r.join("")},_hitTestChildren:function t(e,n,r){return t.base.call(this,e,n.class===V||"path"===n.type?n:c.set({},n,{fill:!1}),r)},_draw:function(t,e,n,r){var i=this._children;if(i.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var a=0,o=i.length;a<o;a++)i[a].draw(t,e,r);if(!e.clip){this._setStyles(t,e,n);var s=this._style;s.hasFill()&&(t.fill(s.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),s.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,n){for(var r=this._children,i=0,a=r.length;i<a;i++){var o=r[i],s=o._matrix;n[o._id]||o._drawSelected(t,s.isIdentity()?e:e.appended(s))}}},new function(){function t(t,e){var n=t._children;if(e&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return c.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],(function(e){this[e]=function(){var n=t(this,!0);n[e].apply(n,arguments)}}),{moveTo:function(){var e=t(this),n=e&&e.isEmpty()?e:new V(T.NO_INSERT);n!==e&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var e=t(this,!0),n=e&&e.getLastSegment(),r=y.read(arguments);this.moveTo(n?r.add(n._point):r)},closePath:function(e){t(this,!0).closePath(e)}})},c.each(["reverse","flatten","simplify","smooth"],(function(t){this[t]=function(e){for(var n,r=this._children,i=0,a=r.length;i<a;i++)n=r[i][t](e)||n;return n}}),{}));B.inject(new function(){var t=Math.min,e=Math.max,n=Math.abs,r={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function i(t){return t._children||[t]}function a(t,e){var n=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var r=i(n),a=0,o=r.length;a<o;a++){(t=r[a])._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0))}n=n.resolveCrossings().reorient("nonzero"===n.getFillRule(),!0)}return n}function o(t,e,n,r,i){var a=new j(T.NO_INSERT);return a.addChildren(t,!0),a=a.reduce({simplify:e}),i&&0==i.insert||a.insertAbove(r&&n.isSibling(r)&&n.getIndex()<r.getIndex()?r:n),a.copyAttributes(n,!0),a}function l(t){return t.hasOverlap()||t.isCrossing()}function u(t,e,n,s){if(s&&(0==s.trace||s.stroke)&&/^(subtract|intersect)$/.test(n))return h(t,e,n);var u=a(t,!0),d=e&&t!==e&&a(e,!0),f=r[n];f[n]=!0,d&&(f.subtract||f.exclude)^d.isClockwise()^u.isClockwise()&&d.reverse();var g,y=v(F.expand(u.getIntersections(d,l))),_=i(u),w=d&&i(d),S=[],E=[];function M(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];c.push(S,r._segments),c.push(E,r.getCurves()),r._overlapsOnly=!0}}function C(t){for(var e=[],n=0,r=t&&t.length;n<r;n++)e.push(E[t[n]]);return e}if(y.length){M(_),w&&M(w);for(var T=new Array(E.length),k=0,P=E.length;k<P;k++)T[k]=E[k].getValues();var A=p.findCurveBoundsCollisions(T,T,0,!0),O={};for(k=0;k<E.length;k++){var N=E[k],R=N._path._id;(O[R]=O[R]||{})[N.getIndex()]={hor:C(A[k].hor),ver:C(A[k].ver)}}for(k=0,P=y.length;k<P;k++)b(y[k]._segment,u,d,O,f);for(k=0,P=S.length;k<P;k++){var L=S[k],I=L._intersection;L._winding||b(L,u,d,O,f),I&&I._overlap||(L._path._overlapsOnly=!1)}g=x(S,f)}else g=m(w?_.concat(w):_.slice(),(function(t){return!!f[t]}));return o(g,!0,t,e,s)}function h(t,e,n){var r=a(t),i=a(e),s=r.getIntersections(i,l),u="subtract"===n,c="divide"===n,h={},d=[];function f(t){if(!h[t._id]&&(c||i.contains(t.getPointAt(t.getLength()/2))^u))return d.unshift(t),h[t._id]=!0}for(var p=s.length-1;p>=0;p--){var m=s[p].split();m&&(f(m)&&m.getFirstSegment().setHandleIn(0,0),r.getLastSegment().setHandleOut(0,0))}return f(r),o(d,!1,t,e)}function d(t,e){for(var n=t;n;){if(n===e)return;n=n._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function f(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function m(t,e,r){var i=t&&t.length;if(i){var a=c.each(t,(function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}}),{}),o=t.slice().sort((function(t,e){return n(e.getArea())-n(t.getArea())})),s=o[0],l=p.findItemBoundsCollisions(o,null,g.GEOMETRIC_EPSILON);null==r&&(r=s.isClockwise());for(var u=0;u<i;u++){var h=o[u],d=a[h._id],f=0,m=l[u];if(m)for(var v=null,y=m.length-1;y>=0;y--)if(m[y]<u){v=v||h.getInteriorPoint();var b=o[m[y]];if(b.contains(v)){var x=a[b._id];f=x.winding,d.winding+=f,d.container=x.exclude?x.container:b;break}}if(e(d.winding)===e(f))d.exclude=!0,t[d.index]=null;else{var _=d.container;h.setClockwise(_?!_.isClockwise():r)}}}return t}function v(t,e,n){var r,i,a,o=e&&[],s=!1,l=n||[],u=n&&{};function c(t){return t._path._id+"."+t._segment1._index}for(var h=(n&&n.length)-1;h>=0;h--){(p=n[h])._path&&(u[c(p)]=!0)}for(h=t.length-1;h>=0;h--){var p,m,g=t[h],v=g._time,y=v,b=e&&!e(g);if((p=g._curve)&&(p!==i?(s=!p.hasHandles()||u&&u[c(p)],r=[],a=null,i=p):a>=1e-8&&(v/=a)),b)r&&r.push(g);else{if(e&&o.unshift(g),a=y,v<1e-8)m=p._segment1;else if(v>1-1e-8)m=p._segment2;else{var x=p.divideAtTime(v,!0);s&&l.push(p,x),m=x._segment1;for(var _=r.length-1;_>=0;_--){var w=r[_];w._time=(w._time-v)/(1-v)}}g._setSegment(m);var S=m._intersection,E=g._intersection;if(S){d(S,E);for(var M=S;M;)d(M._intersection,S),M=M._next}else m._intersection=E}}return n||f(l),o||t}function y(r,i,a,o,s){var l,u,c=Array.isArray(i)?i:i[a?"hor":"ver"],h=a?1:0,d=1^h,f=[r.x,r.y],p=f[h],m=f[d],g=p-1e-9,v=p+1e-9,b=0,x=0,_=0,w=0,S=!1,E=!1,M=1,C=[];function T(n){var u=n[d+0],c=n[d+6];if(!(m<t(u,c)||m>e(u,c))){var f=n[h+0],b=n[h+2],x=n[h+4],E=n[h+6];if(u!==c){var T=m===u?0:m===c||g>e(f,b,x,E)||v<t(f,b,x,E)?1:z.solveCubic(n,d,m,C,0,1)>0?C[0]:1,k=0===T?f:1===T?E:z.getPoint(n,T)[a?"y":"x"],P=u>c?1:-1,A=l[d]>l[d+6]?1:-1,O=l[h+6];return m!==u?(k<g?_+=P:k>v?w+=P:S=!0,k>p-1e-6&&k<p+1e-6&&(M/=2)):(P!==A?f<g?_+=P:f>v&&(w+=P):f!=O&&(O<v&&k>v?(w+=P,S=!0):O>g&&k<g&&(_+=P,S=!0)),M/=4),l=n,!s&&k>g&&k<v&&0===z.getTangent(n,T)[a?"x":"y"]&&y(r,i,!a,o,!0)}(f<v&&E>g||E<v&&f>g)&&(S=!0)}}function k(n){var r=n[d+0],i=n[d+2],o=n[d+4],s=n[d+6];if(m<=e(r,i,o,s)&&m>=t(r,i,o,s))for(var l,u=n[h+0],c=n[h+2],f=n[h+4],p=n[h+6],y=g>e(u,c,f,p)||v<t(u,c,f,p)?[n]:z.getMonoCurves(n,a),b=0,x=y.length;b<x;b++)if(l=T(y[b]))return l}for(var P=0,A=c.length;P<A;P++){var O,N=c[P],R=N._path,L=N.getValues();if(!(P&&c[P-1]._path===R||(l=null,R._closed||(u=z.getValues(R.getLastCurve().getSegment2(),N.getSegment1(),null,!o))[d]!==u[d+6]&&(l=u),l))){l=L;for(var I=R.getLastCurve();I&&I!==N;){var D=I.getValues();if(D[d]!==D[d+6]){l=D;break}I=I.getPrevious()}}if(O=k(L))return O;if(P+1===A||c[P+1]._path!==R){if(u&&(O=k(u)))return O;!S||_||w||(_=w=R.isClockwise(o)^a?1:-1),b+=_,x+=w,_=w=0,S&&(E=!0,S=!1),u=null}}return b=n(b),x=n(x),{winding:e(b,x),windingL:b,windingR:x,quality:M,onPath:E}}function b(t,e,r,i,a){var o=[],s=t,l=0;do{if(b=t.getCurve()){var u=b.getLength();o.push({segment:t,curve:b,length:u}),l+=u}t=t.getNext()}while(t&&!t._intersection&&t!==s);for(var c=[.5,.25,.75],h={winding:0,quality:-1},d=0;d<c.length&&h.quality<.5;d++){u=l*c[d];for(var f=0,p=o.length;f<p;f++){var m=o[f],v=m.length;if(u<=v){var b,x=(b=m.curve)._path,_=x._parent,w=_ instanceof j?_:x,S=g.clamp(b.getTimeAt(u),.001,.999),E=b.getPointAtTime(S),M=n(b.getTangentAtTime(S).y)<Math.SQRT1_2,C=null;if(a.subtract&&r){var T=(w===e?r:e)._getWinding(E,M,!0);if(w===e&&T.winding||w===r&&!T.winding){if(T.quality<1)continue;C={winding:0,quality:1}}}(C=C||y(E,i[x._id][b.getIndex()],M,!0)).quality>h.quality&&(h=C);break}u-=v}}for(f=o.length-1;f>=0;f--)o[f].segment._winding=h}function x(t,e){var n,r=[];function i(t){var n;return!(!t||t._visited||e&&(!e[(n=t._winding||{}).winding]||e.unite&&2===n.winding&&n.windingL&&n.windingR))}function a(t){if(t)for(var e=0,r=n.length;e<r;e++)if(t===n[e])return!0;return!1}function o(t){for(var e=t._segments,n=0,r=e.length;n<r;n++)e[n]._visited=!0}function s(t,e){var r=t._intersection,o=r,s=[];function l(r,o){for(;r&&r!==o;){var l=r._segment,u=l&&l._path;if(u){var c=l.getNext()||u.getFirstSegment(),h=c._intersection;l!==t&&(a(l)||a(c)||c&&i(l)&&(i(c)||h&&i(h._segment)))&&s.push(l),e&&n.push(l)}r=r._next}}if(e&&(n=[t]),r){for(l(r);r&&r._previous;)r=r._previous;l(r,o)}return s}t.sort((function(t,e){var n=t._intersection,r=e._intersection,i=!(!n||!n._overlap),a=!(!r||!r._overlap),o=t._path,s=e._path;return i^a?i?1:-1:!n^!r?n?1:-1:o!==s?o._id-s._id:t._index-e._index}));for(var l=0,u=t.length;l<u;l++){var c,h,d,f=t[l],p=i(f),m=null,g=!1,v=!0,y=[];if(p&&f._path._overlapsOnly){var b=f._path,x=f._intersection._segment._path;b.compare(x)&&(b.getArea()&&r.push(b.clone(!1)),o(b),o(x),p=!1)}for(;p;){var _=!m,w=s(f,_),S=w.shift(),E=!(g=!_&&(a(f)||a(S)))&&S;if(_&&(m=new V(T.NO_INSERT),c=null),g){(f.isFirst()||f.isLast())&&(v=f._path._closed),f._visited=!0;break}if(E&&c&&(y.push(c),c=null),c||(E&&w.push(f),c={start:m._segments.length,crossings:w,visited:h=[],handleIn:d}),E&&(f=S),!i(f)){m.removeSegments(c.start);for(var M=0,C=h.length;M<C;M++)h[M]._visited=!1;h.length=0;do{(f=c&&c.crossings.shift())&&f._path||(f=null,(c=y.pop())&&(h=c.visited,d=c.handleIn))}while(c&&!i(f));if(!f)break}var k=f.getNext();m.add(new I(f._point,d,k&&f._handleOut)),f._visited=!0,h.push(f),f=k||f._path.getFirstSegment(),d=k&&k._handleIn}g&&(v&&(m.getFirstSegment().setHandleIn(d),m.setClosed(v)),0!==m.getArea()&&r.push(m))}return r}return{_getWinding:function(t,e,n){return y(t,this.getCurves(),e,n)},unite:function(t,e){return u(this,t,"unite",e)},intersect:function(t,e){return u(this,t,"intersect",e)},subtract:function(t,e){return u(this,t,"subtract",e)},exclude:function(t,e){return u(this,t,"exclude",e)},divide:function(t,e){return e&&(0==e.trace||e.stroke)?h(this,t,"divide"):o([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function n(t,e){var n=t&&t._intersection;return n&&n._overlap&&n._path===e}var r=!1,i=!1,a=this.getIntersections(null,(function(t){return t.hasOverlap()&&(r=!0)||t.isCrossing()&&(i=!0)})),o=r&&i&&[];if(a=F.expand(a),r)for(var s=v(a,(function(t){return t.hasOverlap()}),o),l=s.length-1;l>=0;l--){var u=s[l],h=u._path,d=u._segment,p=d.getPrevious(),m=d.getNext();n(p,h)&&n(m,h)&&(d.remove(),p._handleOut._set(0,0),m._handleIn._set(0,0),p===d||p.getCurve().hasLength()||(m._handleIn.set(p._handleIn),p.remove()))}i&&(v(a,r&&function(t){var e=t.getCurve(),n=t.getSegment(),r=t._intersection,i=r._curve,a=r._segment;if(e&&i&&e._path&&i._path)return!0;n&&(n._intersection=null),a&&(a._intersection=null)},o),o&&f(o),e=x(c.each(e,(function(t){c.push(this,t._segments)}),[])));var g,y=e.length;return y>1&&t?(e!==t&&this.setChildren(e),g=this):1!==y||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),g=this),g||((g=new j(T.NO_INSERT)).addChildren(e),(g=g.reduce()).copyAttributes(this),this.replaceWith(g)),g},reorient:function(t,e){var n=this._children;return n&&n.length?this.setChildren(m(this.removeChildren(),(function(e){return!!(t?e:1&e)}),e)):e!==s&&this.setClockwise(e),this},getInteriorPoint:function(){var n=this.getBounds().getCenter(!0);if(!this.contains(n)){for(var r=this.getCurves(),i=n.y,a=[],o=[],s=0,l=r.length;s<l;s++){var u=r[s].getValues(),c=u[1],h=u[3],d=u[5],f=u[7];if(i>=t(c,h,d,f)&&i<=e(c,h,d,f))for(var p=z.getMonoCurves(u),m=0,g=p.length;m<g;m++){var v=p[m],y=v[1],b=v[7];if(y!==b&&(i>=y&&i<=b||i>=b&&i<=y)){var x=i===y?v[0]:i===b?v[6]:1===z.solveCubic(v,1,i,o,0,1)?z.getPoint(v,o[0]).x:(v[0]+v[6])/2;a.push(x)}}}a.length>1&&(a.sort((function(t,e){return t-e})),n.x=(a[0]+a[1])/2)}return n}}});var H=c.extend({_class:"PathFlattener",initialize:function(t,e,n,r,i){var a,o=[],s=[],l=0,u=1/(n||32),c=t._segments,h=c[0];function d(t,n){var a=z.getValues(t,n,i);o.push(a),function t(n,i,a,o){if(!(o-a>u)||r&&z.isStraight(n)||z.isFlatEnough(n,e||.25)){var c=n[6]-n[0],h=n[7]-n[1],d=Math.sqrt(c*c+h*h);d>0&&(l+=d,s.push({offset:l,curve:n,index:i,time:o}))}else{var f=z.subdivide(n,.5),p=(a+o)/2;t(f[0],i,a,p),t(f[1],i,p,o)}}(a,t._index,0,1)}for(var f=1,p=c.length;f<p;f++)d(h,a=c[f]),h=a;t._closed&&d(a||h,c[0]),this.curves=o,this.parts=s,this.length=l,this.index=0},_get:function(t){for(var e,n=this.parts,r=n.length,i=this.index;e=i,i&&!(n[--i].offset<t););for(;e<r;e++){var a=n[e];if(a.offset>=t){this.index=e;var o=n[e-1],s=o&&o.index===a.index?o.time:0,l=o?o.offset:0;return{index:a.index,time:s+(a.time-s)*(t-l)/(a.offset-l)}}}return{index:n[r-1].index,time:1}},drawPart:function(t,e,n){for(var r=this._get(e),i=this._get(n),a=r.index,o=i.index;a<=o;a++){var s=z.getPart(this.curves[a],a===r.index?r.time:0,a===i.index?i.time:1);a===r.index&&t.moveTo(s[0],s[1]),t.bezierCurveTo.apply(t,s.slice(2))}}},c.each(z._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this._get(e);return z[t](this.curves[n.index],n.time)}}),{})),U=c.extend({initialize:function(t){for(var e,n=this.points=[],r=t._segments,i=t._closed,a=0,o=r.length;a<o;a++){var s=r[a].point;e&&e.equals(s)||n.push(e=s.clone())}i&&(n.unshift(n[n.length-1]),n.push(n[1])),this.closed=i},fit:function(t){var e=this.points,n=e.length,r=null;return n>0&&(r=[new I(e[0])],n>1&&(this.fitCubic(r,t,0,n-1,e[1].subtract(e[0]),e[n-2].subtract(e[n-1])),this.closed&&(r.shift(),r.pop()))),r},fitCubic:function(t,e,n,r,i,a){var o=this.points;if(r-n!=1){for(var s,l=this.chordLengthParameterize(n,r),u=Math.max(e,e*e),c=!0,h=0;h<=4;h++){var d=this.generateBezier(n,r,l,i,a),f=this.findMaxError(n,r,d,l);if(f.error<e&&c)return void this.addCurve(t,d);if(s=f.index,f.error>=u)break;c=this.reparameterize(n,r,l,d),u=f.error}var p=o[s-1].subtract(o[s+1]);this.fitCubic(t,e,n,s,i,p),this.fitCubic(t,e,s,r,p.negate(),a)}else{var m=o[n],g=o[r],v=m.getDistance(g)/3;this.addCurve(t,[m,m.add(i.normalize(v)),g.add(a.normalize(v)),g])}},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new I(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,n,r,i){for(var a=Math.abs,o=this.points,s=o[t],l=o[e],u=[[0,0],[0,0]],c=[0,0],h=0,d=e-t+1;h<d;h++){var f=n[h],p=1-f,m=3*f*p,g=p*p*p,v=m*p,y=m*f,b=f*f*f,x=r.normalize(v),_=i.normalize(y),w=o[t+h].subtract(s.multiply(g+v)).subtract(l.multiply(y+b));u[0][0]+=x.dot(x),u[0][1]+=x.dot(_),u[1][0]=u[0][1],u[1][1]+=_.dot(_),c[0]+=x.dot(w),c[1]+=_.dot(w)}var S,E,M=u[0][0]*u[1][1]-u[1][0]*u[0][1];if(a(M)>1e-12){var C=u[0][0]*c[1]-u[1][0]*c[0];S=(c[0]*u[1][1]-c[1]*u[0][1])/M,E=C/M}else{var T=u[0][0]+u[0][1],k=u[1][0]+u[1][1];S=E=a(T)>1e-12?c[0]/T:a(k)>1e-12?c[1]/k:0}var P,A,O=l.getDistance(s),N=1e-12*O;if(S<N||E<N)S=E=O/3;else{var R=l.subtract(s);P=r.normalize(S),A=i.normalize(E),P.dot(R)-A.dot(R)>O*O&&(S=E=O/3,P=A=null)}return[s,s.add(P||r.normalize(S)),l.add(A||i.normalize(E)),l]},reparameterize:function(t,e,n,r){for(var i=t;i<=e;i++)n[i-t]=this.findRoot(r,this.points[i],n[i-t]);i=1;for(var a=n.length;i<a;i++)if(n[i]<=n[i-1])return!1;return!0},findRoot:function(t,e,n){for(var r=[],i=[],a=0;a<=2;a++)r[a]=t[a+1].subtract(t[a]).multiply(3);for(a=0;a<=1;a++)i[a]=r[a+1].subtract(r[a]).multiply(2);var o=this.evaluate(3,t,n),s=this.evaluate(2,r,n),l=this.evaluate(1,i,n),u=o.subtract(e),c=s.dot(s)+u.dot(l);return g.isMachineZero(c)?n:n-u.dot(s)/c},evaluate:function(t,e,n){for(var r=e.slice(),i=1;i<=t;i++)for(var a=0;a<=t-i;a++)r[a]=r[a].multiply(1-n).add(r[a+1].multiply(n));return r[0]},chordLengthParameterize:function(t,e){for(var n=[0],r=t+1;r<=e;r++)n[r-t]=n[r-t-1]+this.points[r].getDistance(this.points[r-1]);r=1;for(var i=e-t;r<=i;r++)n[r]/=n[i];return n},findMaxError:function(t,e,n,r){for(var i=Math.floor((e-t+1)/2),a=0,o=t+1;o<e;o++){var s=this.evaluate(3,n,r[o-t]).subtract(this.points[o]),l=s.x*s.x+s.y*s.y;l>=a&&(a=l,i=o)}return{error:a,index:i}}}),G=T.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var e=t&&c.isPlainObject(t)&&t.x===s&&t.y===s;this._initialize(e&&t,!e&&y.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),q=G.extend({_class:"PointText",initialize:function(){G.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new b(t.x,t.y,this,"setPoint")},setPoint:function(){var t=y.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,n){if(this._content){this._setStyles(t,e,n);var r=this._lines,i=this._style,a=i.hasFill(),o=i.hasStroke(),s=i.getLeading(),l=t.shadowColor;t.font=i.getFontStyle(),t.textAlign=i.getJustification();for(var u=0,c=r.length;u<c;u++){t.shadowColor=l;var h=r[u];a&&(t.fillText(h,0,0),t.shadowColor="rgba(0,0,0,0)"),o&&t.strokeText(h,0,0),t.translate(0,s)}}},_getBounds:function(t,e){var n=this._style,r=this._lines,i=r.length,a=n.getJustification(),o=n.getLeading(),s=this.getView().getTextWidth(n.getFontStyle(),r),l=0;"left"!==a&&(l-=s/("center"===a?2:1));var u=new w(l,i?-.75*o:0,s,i*o);return t?t._transformBounds(u,u):u}}),W=c.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},n={},r={transparent:[0,0,0,0]};function i(e){var n,i=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),a="rgb";if(i){var o=i[4]?4:3;n=new Array(o);for(var s=0;s<o;s++){var u=i[s+1];n[s]=parseInt(1==u.length?u+u:u,16)/255}}else if(i=e.match(/^(rgb|hsl)a?\((.*)\)$/)){a=i[1],n=i[2].trim().split(/[,\s]+/g);for(var c="hsl"===a,h=(s=0,Math.min(n.length,4));s<h;s++){var d=n[s];u=parseFloat(d);if(c)if(0===s){var f=d.match(/([a-z]*)$/)[1];u*={turn:360,rad:180/Math.PI,grad:.9}[f]||1}else s<3&&(u/=100);else s<3&&(u/=/%$/.test(d)?100:255);n[s]=u}}else{var p=r[e];if(!p)if(l){t||((t=lt.getContext(1,1)).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var m=t.getImageData(0,0,1,1).data;p=r[e]=[m[0]/255,m[1]/255,m[2]/255]}else p=[0,0,0];n=p.slice()}return[a,n]}var a=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(t,e,n){var r=Math.max(t,e,n),i=r-Math.min(t,e,n);return[0===i?0:60*(r==t?(e-n)/i+(e<n?6:0):r==e?(n-t)/i+2:(t-e)/i+4),0===r?0:i/r,r]},"hsb-rgb":function(t,e,n){var r,i=(t=(t/60%6+6)%6)-(r=Math.floor(t)),o=[n,n*(1-e),n*(1-e*i),n*(1-e*(1-i))];return[o[(r=a[r])[0]],o[r[1]],o[r[2]]]},"rgb-hsl":function(t,e,n){var r=Math.max(t,e,n),i=Math.min(t,e,n),a=r-i,o=0===a,s=(r+i)/2;return[o?0:60*(r==t?(e-n)/a+(e<n?6:0):r==e?(n-t)/a+2:(t-e)/a+4),o?0:s<.5?a/(r+i):a/(2-r-i),s]},"hsl-rgb":function(t,e,n){if(0===e)return[n,n,n];for(var r=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],i=n<.5?n*(1+e):n+e-n*e,a=2*n-i,o=[],s=0;s<3;s++){var l=r[s];l<0&&(l+=1),l>1&&(l-=1),o[s]=6*l<1?a+6*(i-a)*l:2*l<1?i:3*l<2?a+(i-a)*(2/3-l)*6:a}return o},"rgb-gray":function(t,e,n){return[.2989*t+.587*e+.114*n]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return c.each(e,(function(t,r){n[r]=[],c.each(t,(function(t,i){var a=c.capitalize(t),o=/^(hue|saturation)$/.test(t),s=n[r][i]="gradient"===r?"gradient"===t?function(t){var e=this._components[0];return e!==(t=$.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return y.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+a]=function(){return this._type===r||o&&/^hs[bl]$/.test(this._type)?this._components[i]:this._convert(r)[i]},this["set"+a]=function(t){this._type===r||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(r),this._properties=e[r],this._type=r),this._components[i]=s.call(this,t),this._changed()}}),this)}),{_class:"Color",_readIndex:!0,initialize:function t(r){var a,o,s,l,u=arguments,h=this.__read,d=0;Array.isArray(r)&&(r=(u=r)[0]);var f=null!=r&&typeof r;if("string"===f&&r in e&&(a=r,r=u[1],Array.isArray(r)?(o=r,s=u[2]):(h&&(d=1),u=c.slice(u,1),f=typeof r)),!o){if(l="number"===f?u:"object"===f&&null!=r.length?r:null){a||(a=l.length>=3?"rgb":"gray");var p=e[a].length;s=l[p],h&&(d+=l===arguments?p+(null!=s?1:0):1),l.length>p&&(l=c.slice(l,0,p))}else if("string"===f){var m=i(r);a=m[0],4===(o=m[1]).length&&(s=o[3],o.length--)}else if("object"===f)if(r.constructor===t){if(a=r._type,o=r._components.slice(),s=r._alpha,"gradient"===a)for(var g=1,v=o.length;g<v;g++){var y=o[g];y&&(o[g]=y.clone())}}else if(r.constructor===$)a="gradient",l=u;else{var b=e[a="hue"in r?"lightness"in r?"hsl":"hsb":"gradient"in r||"stops"in r||"radial"in r?"gradient":"gray"in r?"gray":"rgb"],x=n[a];this._components=o=[];for(g=0,v=b.length;g<v;g++){null==(_=r[b[g]])&&!g&&"gradient"===a&&"stops"in r&&(_={stops:r.stops,radial:r.radial}),null!=(_=x[g].call(this,_))&&(o[g]=_)}s=r.alpha}h&&a&&(d=1)}if(this._type=a||"rgb",!o){this._components=o=[];for(g=0,v=(x=n[this._type]).length;g<v;g++){var _;null!=(_=x[g].call(this,l&&l[g]))&&(o[g]=_)}}return this._components=o,this._properties=e[this._type],this._alpha=s,h&&(this.__read=d),this},set:"#initialize",_serialize:function(t,e){var n=this.getComponents();return c.serialize(/^(gray|rgb)$/.test(this._type)?n:[this._type].concat(n),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=o[this._type+"-"+t])?e.apply(this,this._components):o["rgb-"+t].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new W(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=c.isPlainValue(t,!0)?W.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&c.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],n="gradient"===this._type,r=m.instance,i=0,a=t.length;i<a;i++){var o=this._components[i];null!=o&&e.push(t[i]+": "+(n?o:r.number(o)))}return null!=this._alpha&&e.push("alpha: "+r.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),n=t||null==this._alpha?1:this._alpha;function r(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[r(e[0]),r(e[1]),r(e[2])],n<1&&e.push(n<0?0:n),t?"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var n,r=this._components,i=r[0],a=i._stops,o=r[1],s=r[2],l=r[3],u=e&&e.inverted();if(u&&(o=u._transformPoint(o),s=u._transformPoint(s),l&&(l=u._transformPoint(l))),i._radial){var c=s.getDistance(o);if(l){var h=l.subtract(o);h.getLength()>c&&(l=o.add(h.normalize(c-.1)))}var d=l||o;n=t.createRadialGradient(d.x,d.y,0,o.x,o.y,c)}else n=t.createLinearGradient(o.x,o.y,s.x,s.y);for(var f=0,p=a.length;f<p;f++){var m=a[f],g=m._offset;n.addColorStop(null==g?f/(p-1):g,m._color.toCanvasStyle())}return this._canvasStyle=n},transform:function(t){if("gradient"===this._type){for(var e=this._components,n=1,r=e.length;n<r;n++){var i=e[n];t._transformPoint(i,i,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new W(t(),t(),t())},_setOwner:function(t,e,n){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=n||null)),t}}})},new function(){return c.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},(function(t,e){this[e]=function(e){e=W.read(arguments);for(var n=this._type,r=this._components,i=e._convert(n),a=0,o=r.length;a<o;a++)i[a]=t(r[a],i[a]);return new W(n,i,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}}),{})}),$=c.extend({_class:"Gradient",initialize:function(t,e){this._id=v.get(),t&&c.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,(function(){return c.serialize([this._stops,this._radial],t,!0,e)}))},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;-1!=e&&(this._owners.splice(e,1),this._owners.length||(this._owners=s))},clone:function(){for(var t=[],e=0,n=this._stops.length;e<n;e++)t[e]=this._stops[e].clone();return new $(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var n=0,r=e.length;n<r;n++)e[n]._owner=s;for(n=0,r=(e=this._stops=Y.readList(t,0,{clone:!0})).length;n<r;n++)e[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,n=t._stops,r=e.length;if(r===n.length){for(var i=0;i<r;i++)if(!e[i].equals(n[i]))return!1;return!0}}return!1}}),Y=c.extend({_class:"GradientStop",initialize:function(t,e){var n=t,r=e;"object"==typeof t&&e===s&&(Array.isArray(t)&&"number"!=typeof t[0]?(n=t[0],r=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(n=t.color,r=t.offset||t.rampPoint||0)),this.setColor(n),this.setOffset(r)},clone:function(){return new Y(this._color.clone(),this._offset)},_serialize:function(t,e){var n=this._color,r=this._offset;return c.serialize(null==r?[n]:[n,r],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){W._setOwner(this._color,null),this._color=W._setOwner(W.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),Q=c.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new y,selectedColor:null},e=c.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=c.set({},e,{fillColor:new W}),r={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},i={beans:!0},a={_class:"Style",beans:!0,initialize:function(r,i,a){this._values={},this._owner=i,this._project=i&&i._project||a||dt.project,this._defaults=!i||i instanceof k?e:i instanceof G?n:t,r&&this.set(r)}};return c.each(e,(function(t,e){var n=/Color$/.test(e),o="shadowOffset"===e,l=c.capitalize(e),u=r[e],h="set"+l,d="get"+l;a[h]=function(t){var r=this._owner,i=r&&r._children,a=i&&i.length>0&&!(r instanceof j);if(a)for(var o=0,s=i.length;o<s;o++)i[o]._style[h](t);if(("selectedColor"===e||!a)&&e in this._defaults){var l=this._values[e];l!==t&&(n&&(l&&(W._setOwner(l,null),l._canvasStyle=null),t&&t.constructor===W&&(t=W._setOwner(t,r,a&&h))),this._values[e]=t,r&&r._changed(u||129))}},a[d]=function(t){var r=this._owner,i=r&&r._children,a=i&&i.length>0&&!(r instanceof j);if(a&&!t)for(var l=0,u=i.length;l<u;l++){var f=i[l]._style[d]();if(l){if(!c.equals(p,f))return s}else p=f}else if(e in this._defaults){var p;if((p=this._values[e])===s)(p=this._defaults[e])&&p.clone&&(p=p.clone());else{var m=n?W:o?y:null;!m||p&&p.constructor===m||(this._values[e]=p=m.read([p],0,{readNull:!0,clone:!0}))}}return p&&n&&(p=W._setOwner(p,r,a&&h)),p},i[d]=function(t){return this._style[d](t)},i[h]=function(t){this._style[h](t)}})),c.each({Font:"FontFamily",WindingRule:"FillRule"},(function(t,e){var n="get"+e,r="set"+e;a[n]=i[n]="#get"+t,a[r]=i[r]="#set"+t})),T.inject(i),a},{set:function(t){var e=t instanceof Q,n=e?t._values:t;if(n)for(var r in n)if(r in this._defaults){var i=n[r];this[r]=i&&e&&i.clone?i.clone():i}},equals:function(t){function e(t,e,n){var r=t._values,i=e._values,a=e._defaults;for(var o in r){var l=r[o],u=i[o];if(!(n&&o in i||c.equals(l,u===s?a[o]:u)))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=e?e:1.2*n}}),X=new function(){function t(t,e,n,r){for(var i=["","webkit","moz","Moz","ms","o"],a=e[0].toUpperCase()+e.substring(1),o=0;o<6;o++){var s=i[o],l=s?s+a:e;if(l in t){if(!n)return t[l];t[l]=r;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,n=e&&e.defaultView;return n&&n.getComputedStyle(t,"")},getBounds:function(t,e){var n,r=t.ownerDocument,i=r.body,a=r.documentElement;try{n=t.getBoundingClientRect()}catch(t){n={left:0,top:0,width:0,height:0}}var o=n.left-(a.clientLeft||i.clientLeft||0),s=n.top-(a.clientTop||i.clientTop||0);if(!e){var l=r.defaultView;o+=l.pageXOffset||a.scrollLeft||i.scrollLeft,s+=l.pageYOffset||a.scrollTop||i.scrollTop}return new w(o,s,n.width,n.height)},getViewportBounds:function(t){var e=t.ownerDocument,n=e.defaultView,r=e.documentElement;return new w(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(t,e){return X.getBounds(t,e).getPoint()},getSize:function(t){return X.getBounds(t,!0).getSize()},isInvisible:function(t){return X.getSize(t).equals(new x(0,0))},isInView:function(t){return!X.isInvisible(t)&&X.getViewportBounds(t).intersects(X.getBounds(t,!0))},isInserted:function(t){return u.body.contains(t)},getPrefixed:function(e,n){return e&&t(e,n)},setPrefixed:function(e,n,r){if("object"==typeof n)for(var i in n)t(e,i,!0,n[i]);else t(e,n,!0,r)}}},Z={add:function(t,e){if(t)for(var n in e)for(var r=e[n],i=n.split(/[\s,]+/g),a=0,o=i.length;a<o;a++){var s=i[a],l=t===u&&("touchstart"===s||"touchmove"===s)&&{passive:!1};t.addEventListener(s,r,l)}},remove:function(t,e){if(t)for(var n in e)for(var r=e[n],i=n.split(/[\s,]+/g),a=0,o=i.length;a<o;a++)t.removeEventListener(i[a],r,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new y(e.pageX||e.clientX+u.documentElement.scrollLeft,e.pageY||e.clientY+u.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return Z.getPoint(t).subtract(X.getOffset(e||Z.getTarget(t)))}};Z.requestAnimationFrame=new function(){var t,e=X.getPrefixed(l,"requestAnimationFrame"),n=!1,r=[];function i(){var t=r;r=[];for(var a=0,o=t.length;a<o;a++)t[a]();(n=e&&r.length)&&e(i)}return function(a){r.push(a),e?n||(e(i),n=!0):t||(t=setInterval(i,1e3/60))}};var J=c.extend(h,{_class:"View",initialize:function t(e,n){function r(t){return n[t]||parseInt(n.getAttribute(t),10)}function i(){var t=X.getSize(n);return t.isNaN()||t.isZero()?new x(r("width"),r("height")):t}var a;if(l&&n){this._id=n.getAttribute("id"),null==this._id&&n.setAttribute("id",this._id="paper-view-"+t._id++),Z.add(n,this._viewEvents);if(X.setPrefixed(n.style,{userDrag:"none",userSelect:"none",touchCallout:"none",contentZooming:"none",tapHighlightColor:"rgba(0,0,0,0)"}),d.hasAttribute(n,"resize")){var o=this;Z.add(l,this._windowEvents={resize:function(){o.setViewSize(i())}})}if(a=i(),d.hasAttribute(n,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var s=this._stats.domElement,c=s.style,h=X.getOffset(n);c.position="absolute",c.left=h.x+"px",c.top=h.y+"px",u.body.appendChild(s)}}else a=new x(n),n=null;this._project=e,this._scope=e._scope,this._element=n,this._pixelRatio||(this._pixelRatio=l&&l.devicePixelRatio||1),this._setElementSize(a.width,a.height),this._viewSize=a,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new E)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!dt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;J._focused===this&&(J._focused=null),J._views.splice(J._views.indexOf(this),1),delete J._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),Z.remove(this._element,this._viewEvents),Z.remove(l,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:c.each(T._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),(function(t){this[t]={}}),{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;Z.requestAnimationFrame((function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;X.getPrefixed(u,"hidden")&&"true"!==d.getAttribute(e,"keepalive")||!X.isInView(e)||t._handleFrame()}t._autoUpdate&&t.update()})),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){dt=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new c({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var n=this._frameItems;e?(n[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var n=this._frameItems[e];n.item.emit("frame",new c(t,{time:n.time+=t.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=s},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new _(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=x.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var n=this._element;n&&(n.width!==t&&(n.width=t),n.height!==e&&(n.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new w(new y,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return X.isInView(this._element)},isInserted:function(){return X.isInserted(this._element)},getPixelSize:function(t){var e,n=this._element;if(n){var r=n.parentNode,i=u.createElement("div");i.style.fontSize=t,r.appendChild(i),e=parseFloat(X.getStyles(i).fontSize),r.removeChild(i)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},c.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,r=(e?c:y).read(n),i=y.read(n,0,{readNull:!0});return this.transform((new E)[t](r,i||this.getCenter(!0)))}}),{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=y.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform((new E).scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new b(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=y.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(y.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(y.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(y.read(arguments))},getEventPoint:function(t){return this.viewToProject(Z.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return u&&"string"==typeof e&&(e=u.getElementById(e)),new(l?K:J)(t,e)}}},new function(){if(l){var t,e,n,r,i,a=!1,o=!1,s=l.navigator;s.pointerEnabled||s.msPointerEnabled?(n="pointerdown MSPointerDown",r="pointermove MSPointerMove",i="pointerup pointercancel MSPointerUp MSPointerCancel"):(n="touchstart",r="touchmove",i="touchend touchcancel","ontouchstart"in l&&s.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(n+=" mousedown",r+=" mousemove",i+=" mouseup"));var c={},h={mouseout:function(t){var e=J._focused,n=Z.getRelatedTarget(t);if(e&&(!n||"HTML"===n.nodeName)){var r=Z.getOffset(t,e._element),i=r.x,a=Math.abs,o=a(i),s=o-(1<<25);r.x=a(s)<o?s*(i<0?-1:1):i,T(e,t,e.viewToProject(r))}},scroll:C};c[n]=function(t){var e=J._focused=M(t);a||(a=!0,e._handleMouseEvent("mousedown",t))},h[r]=function(n){var r=J._focused;if(!o){var i=M(n);i?r!==i&&(r&&T(r,n),t||(t=r),r=J._focused=e=i):e&&e===r&&(t&&!t.isInserted()&&(t=null),r=J._focused=t,t=null,C())}r&&T(r,n)},h[n]=function(){o=!0},h[i]=function(t){var e=J._focused;e&&a&&e._handleMouseEvent("mouseup",t),o=a=!1},Z.add(u,h),Z.add(l,{load:C});var d,f,p,m,g,v,y,b,x=!1,_=!1,w={doubleclick:"click",mousedrag:"mousemove"},S=!1,E={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:c,_handleMouseEvent:function(t,e,n){var r=this._itemEvents,i=r.native[t],o="mousemove"===t,s=this._scope.tool,l=this;function u(t){return r.virtual[t]||l.responds(t)||s&&s.responds(t)}o&&a&&u("mousedrag")&&(t="mousedrag"),n||(n=this.getEventPoint(e));var c=this.getBounds().contains(n),h=i&&c&&l._project.hitTest(n,{tolerance:0,fill:!0,stroke:!0}),w=h&&h.item||null,E=!1,M={};if(M[t.substr(5)]=!0,i&&w!==m&&(m&&k(m,null,"mouseleave",e,n),w&&k(w,null,"mouseenter",e,n),m=w),S^c&&(k(this,null,c?"mouseenter":"mouseleave",e,n),c?this:null,E=!0),!c&&!M.drag||n.equals(f)||(P(this,w,o?t:"mousemove",e,n,f),E=!0),S=c,M.down&&c||M.up&&d){if(P(this,w,t,e,n,d),M.down){if(b=w===v&&Date.now()-y<300,p=v=w,!_&&w){for(var C=w;C&&!C.responds("mousedrag");)C=C._parent;C&&(g=w)}d=n}else M.up&&(_||w!==p||(y=Date.now(),P(this,w,b?"doubleclick":"click",e,n,d),b=!1),p=g=null);S=!1,E=!0}f=n,E&&s&&(x=s._handleMouseEvent(t,e,n,M)||x),!1!==e.cancelable&&(x&&!M.move||M.down&&u("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,n,r){var i,a=this._scope,o=a.tool;function s(o){o.responds(t)&&(dt=a,o.emit(t,i=i||new et(t,e,n,r)))}this.isVisible()&&(s(this),o&&o.responds(t)&&s(o))},_countItemEvent:function(t,e){var n=this._itemEvents,r=n.native,i=n.virtual;for(var a in E)r[a]=(r[a]||0)+(E[a][t]||0)*e;i[t]=(i[t]||0)+e},statics:{updateFocus:C,_resetState:function(){a=o=x=S=!1,t=e=d=f=p=m=g=v=y=b=null}}}}function M(t){var e=Z.getTarget(t);return e.getAttribute&&J._viewsById[e.getAttribute("id")]}function C(){var t=J._focused;if(!t||!t.isVisible())for(var n=0,r=J._views.length;n<r;n++)if((t=J._views[n]).isVisible()){J._focused=e=t;break}}function T(t,e,n){t._handleMouseEvent("mousemove",e,n)}function k(t,e,n,r,i,a,o){var s,l=!1;function u(t,n){if(t.responds(n)){if(s||(s=new rt(n,r,i,e||t,a?i.subtract(a):null)),t.emit(n,s)&&(x=!0,s.prevented&&(_=!0),s.stopped))return l=!0}else{var o=w[n];if(o)return u(t,o)}}for(;t&&t!==o&&!u(t,n);)t=t._parent;return l}function P(t,e,n,r,i,a){return t._project.removeOn(n),_=x=!1,g&&k(g,null,n,r,i,a)||e&&e!==g&&!e.isDescendant(g)&&k(e,null,"mousedrag"===n?"mousemove":n,r,i,a,g)||k(t,g||e||t,n,r,i,a)}}),K=J.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof l.HTMLCanvasElement)){var n=x.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+c.slice(arguments,1));e=lt.getCanvas(n)}var r=this._context=e.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(d.getAttribute(e,"hidpi"))){var i=l.devicePixelRatio||1,a=X.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=i/a}J.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,n){var r=this._pixelRatio;if(t.base.call(this,e*r,n*r),1!==r){var i=this._element,a=this._context;if(!d.hasAttribute(i,"resize")){var o=i.style;o.width=e+"px",o.height=n+"px"}a.restore(),a.save(),a.scale(r,r)}},getContext:function(){return this._context},getPixelSize:function t(e){var n,r=dt.agent;if(r&&r.firefox)n=t.base.call(this,e);else{var i=this._context,a=i.font;i.font=e+" serif",n=parseFloat(i.font),i.font=a}return n},getTextWidth:function(t,e){var n=this._context,r=n.font,i=0;n.font=t;for(var a=0,o=e.length;a<o;a++)i=Math.max(i,n.measureText(e[a]).width);return n.font=r,i},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,n=this._viewSize;return e.clearRect(0,0,n.width+1,n.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),tt=c.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return nt.modifiers}}),et=tt.extend({_class:"KeyEvent",initialize:function(t,e,n,r){this.type=t,this.event=e,this.key=n,this.character=r},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),nt=new function(){var t,e,n={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},r={tab:"\t",space:" ",enter:"\r"},i={},a={},o=new c({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=dt&&dt.agent;return t&&t.mac?this.meta:this.control}}});function h(t){var e=t.key||t.keyIdentifier;return e=/^U\+/.test(e)?String.fromCharCode(parseInt(e.substr(2),16)):/^Arrow[A-Z]/.test(e)?e.substr(5):"Unidentified"===e||e===s?String.fromCharCode(t.keyCode):e,n[e]||(e.length>1?c.hyphenate(e):e.toLowerCase())}function d(e,n,r,s){var l,u=J._focused;if(i[n]=e,e?a[n]=r:delete a[n],n.length>1&&(l=c.camelize(n))in o){o[l]=e;var h=dt&&dt.agent;if("meta"===l&&h&&h.mac)if(e)t={};else{for(var f in t)f in a&&d(!1,f,t[f],s);t=null}}else e&&t&&(t[n]=r);u&&u._handleKeyEvent(e?"keydown":"keyup",s,n,r)}return Z.add(u,{keydown:function(t){var n=h(t),i=dt&&dt.agent;n.length>1||i&&i.chrome&&(t.altKey||i.mac&&t.metaKey||!i.mac&&t.ctrlKey)?d(!0,n,r[n]||(n.length>1?"":n),t):e=n},keypress:function(t){if(e){var n=h(t),r=t.charCode,i=r>=32?String.fromCharCode(r):n.length>1?"":n;n!==e&&(n=i.toLowerCase()),d(!0,n,i,t),e=null}},keyup:function(t){var e=h(t);e in a&&d(!1,e,a[e],t)}}),Z.add(l,{blur:function(t){for(var e in a)d(!1,e,a[e],t)}}),{modifiers:o,isDown:function(t){return!!i[t]}}},rt=tt.extend({_class:"MouseEvent",initialize:function(t,e,n,r,i){this.type=t,this.event=e,this.point=n,this.target=r,this.delta=i},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),it=tt.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,n){this.tool=t,this.type=e,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,n=e._parent;/^(Group|CompoundPath)$/.test(n._class);)e=n,n=n._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),at=f.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){f.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,n,r){dt=this._scope,r.drag&&!this.responds(t)&&(t="mousemove");var i=r.move||r.drag,a=this.responds(t),o=this.minDistance,s=this.maxDistance,l=!1,u=this;function c(t,e){var a=n,o=i?u._point:u._downPoint||a;if(i){if(u._moveCount>=0&&a.equals(o))return!1;if(o&&(null!=t||null!=e)){var s=a.subtract(o),l=s.getLength();if(l<(t||0))return!1;e&&(a=o.add(s.normalize(Math.min(l,e))))}u._moveCount++}return u._point=a,u._lastPoint=o||a,r.down&&(u._moveCount=-1,u._downPoint=a,u._downCount++),!0}function h(){a&&(l=u.emit(t,new it(u,t,e))||l)}if(r.down)c(),h();else if(r.up)c(null,s),h();else if(a)for(;c(o,s);)h();return l}}),ot=c.extend(h,{_class:"Tween",statics:{easings:{linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:2*(2-t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}}},initialize:function t(e,n,r,i,a,o){this.object=e;var s=typeof a,l="function"===s;this.type=l?s:"string"===s?a:"linear",this.easing=l?a:t.easings[this.type],this.duration=i,this.running=!1,this._then=null,this._startTime=null;var u=n||r;this._keys=u?Object.keys(u):[],this._parsedKeys=this._parseKeys(this._keys),this._from=u&&this._getState(n),this._to=u&&this._getState(r),!1!==o&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),n=this._keys,r=function(n){return"function"==typeof n?n(e,t):n},i=0,a=n&&n.length;i<a;i++){var o=n[i],s=r(this._from[o]),l=r(this._to[o]),u=s&&l&&s.__add&&l.__add?l.__subtract(s).__multiply(e).__add(s):(l-s)*e+s;this._setProperty(this._parsedKeys[o],u)}this.responds("update")&&this.emit("update",new c({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,n=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(n)},_getState:function(t){for(var e=this._keys,n={},r=0,i=e.length;r<i;r++){var a,o=e[r],s=this._parsedKeys[o],l=this._getProperty(s);if(t){var u=this._resolveValue(l,t[o]);this._setProperty(s,u),a=(a=this._getProperty(s))&&a.clone?a.clone():a,this._setProperty(s,l)}else a=l&&l.clone?l.clone():l;n[o]=a}return n},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var n=e[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(t,n[0],e[1]):e}if("string"==typeof e){var r=e.match(/^[+\-*/]=(.*)/);if(r){var i=JSON.parse(r[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],i)}}}return e},_calculate:function(t,e,n){return dt.PaperScript.calculateBinary(t,e,n)},_parseKeys:function(t){for(var e={},n=0,r=t.length;n<r;n++){var i=t[n],a=i.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[i]=a.split("/")}return e},_getProperty:function(t,e){for(var n=this.object,r=0,i=t.length-(e||0);r<i&&n;r++)n=n[t[r]];return n},_setProperty:function(t,e){var n=this._getProperty(t,1);n&&(n[t[t.length-1]]=e)}}),st=function(t){var e=new o.XMLHttpRequest;return e.open((t.method||"get").toUpperCase(),t.url,c.pick(t.async,!0)),t.mimeType&&e.overrideMimeType(t.mimeType),e.onload=function(){var n=e.status;0===n||200===n?t.onLoad&&t.onLoad.call(e,e.responseText):e.onerror()},e.onerror=function(){var n=e.status,r='Could not load "'+t.url+'" (Status: '+n+")";if(!t.onError)throw new Error(r);t.onError(r,n)},e.send(null)},lt=c.exports.CanvasProvider={canvases:[],getCanvas:function(t,e){if(!l)return null;var n,r=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?n=this.canvases.pop():(n=u.createElement("canvas"),r=!1);var i=n.getContext("2d");if(!i)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===t&&n.height===e?r&&i.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),i.save(),n},getContext:function(t,e){var n=this.getCanvas(t,e);return n?n.getContext("2d"):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},ut=new function(){var t,e,n,r,i,a,o,s,l,u,h,d=Math.min,f=Math.max,p=Math.abs;function m(t,e,n){return.2989*t+.587*e+.114*n}function g(t,e,n,r){var i=r-m(t,e,n),a=(r=m(l=t+i,u=e+i,h=n+i),d(l,u,h)),o=f(l,u,h);if(a<0){var s=r-a;l=r+(l-r)*r/s,u=r+(u-r)*r/s,h=r+(h-r)*r/s}if(o>255){var c=255-r,p=o-r;l=r+(l-r)*c/p,u=r+(u-r)*c/p,h=r+(h-r)*c/p}}function v(t,e,n){return f(t,e,n)-d(t,e,n)}function y(t,e,n,r){var i,a=[t,e,n],o=f(t,e,n),s=d(t,e,n);i=0===d(s=s===t?0:s===e?1:2,o=o===t?0:o===e?1:2)?1===f(s,o)?2:1:0,a[o]>a[s]?(a[i]=(a[i]-a[s])*r/(a[o]-a[s]),a[o]=r):a[i]=a[o]=0,a[s]=0,l=a[0],u=a[1],h=a[2]}var b={multiply:function(){l=i*t/255,u=a*e/255,h=o*n/255},screen:function(){l=i+t-i*t/255,u=a+e-a*e/255,h=o+n-o*n/255},overlay:function(){l=i<128?2*i*t/255:255-2*(255-i)*(255-t)/255,u=a<128?2*a*e/255:255-2*(255-a)*(255-e)/255,h=o<128?2*o*n/255:255-2*(255-o)*(255-n)/255},"soft-light":function(){var r=t*i/255;l=r+i*(255-(255-i)*(255-t)/255-r)/255,u=(r=e*a/255)+a*(255-(255-a)*(255-e)/255-r)/255,h=(r=n*o/255)+o*(255-(255-o)*(255-n)/255-r)/255},"hard-light":function(){l=t<128?2*t*i/255:255-2*(255-t)*(255-i)/255,u=e<128?2*e*a/255:255-2*(255-e)*(255-a)/255,h=n<128?2*n*o/255:255-2*(255-n)*(255-o)/255},"color-dodge":function(){l=0===i?0:255===t?255:d(255,255*i/(255-t)),u=0===a?0:255===e?255:d(255,255*a/(255-e)),h=0===o?0:255===n?255:d(255,255*o/(255-n))},"color-burn":function(){l=255===i?255:0===t?0:f(0,255-255*(255-i)/t),u=255===a?255:0===e?0:f(0,255-255*(255-a)/e),h=255===o?255:0===n?0:f(0,255-255*(255-o)/n)},darken:function(){l=i<t?i:t,u=a<e?a:e,h=o<n?o:n},lighten:function(){l=i>t?i:t,u=a>e?a:e,h=o>n?o:n},difference:function(){(l=i-t)<0&&(l=-l),(u=a-e)<0&&(u=-u),(h=o-n)<0&&(h=-h)},exclusion:function(){l=i+t*(255-i-i)/255,u=a+e*(255-a-a)/255,h=o+n*(255-o-o)/255},hue:function(){y(t,e,n,v(i,a,o)),g(l,u,h,m(i,a,o))},saturation:function(){y(i,a,o,v(t,e,n)),g(l,u,h,m(i,a,o))},luminosity:function(){g(i,a,o,m(t,e,n))},color:function(){g(t,e,n,m(i,a,o))},add:function(){l=d(i+t,255),u=d(a+e,255),h=d(o+n,255)},subtract:function(){l=f(i-t,0),u=f(a-e,0),h=f(o-n,0)},average:function(){l=(i+t)/2,u=(a+e)/2,h=(o+n)/2},negation:function(){l=255-p(255-t-i),u=255-p(255-e-a),h=255-p(255-n-o)}},x=this.nativeModes=c.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],(function(t){this[t]=!0}),{}),_=lt.getContext(1,1);_&&(c.each(b,(function(t,e){var n="darken"===e,r=!1;_.save();try{_.fillStyle=n?"#300":"#a00",_.fillRect(0,0,1,1),_.globalCompositeOperation=e,_.globalCompositeOperation===e&&(_.fillStyle=n?"#a00":"#300",_.fillRect(0,0,1,1),r=_.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(t){}_.restore(),x[e]=r})),lt.release(_)),this.process=function(c,d,f,p,m){var g=d.canvas,v="normal"===c;if(v||x[c])f.save(),f.setTransform(1,0,0,1,0,0),f.globalAlpha=p,v||(f.globalCompositeOperation=c),f.drawImage(g,m.x,m.y),f.restore();else{var y=b[c];if(!y)return;for(var _=f.getImageData(m.x,m.y,g.width,g.height),w=_.data,S=d.getImageData(0,0,g.width,g.height).data,E=0,M=w.length;E<M;E+=4){t=S[E],i=w[E],e=S[E+1],a=w[E+1],n=S[E+2],o=w[E+2],r=S[E+3],s=w[E+3],y();var C=r*p/255,T=1-C;w[E]=C*l+T*i,w[E+1]=C*u+T*a,w[E+2]=C*h+T*o,w[E+3]=r*p+T*s}f.putImageData(_,m.x,m.y)}}},ct=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",r={href:n,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function i(t,e,n){for(var i in e){var a=e[i],o=r[i];"number"==typeof a&&n&&(a=n.number(a)),o?t.setAttributeNS(o,i,a):t.setAttribute(i,a)}return t}return{svg:t,xmlns:e,xlink:n,create:function(e,n,r){return i(u.createElementNS(t,e),n,r)},get:function(t,e){var n=r[e],i=n?t.getAttributeNS(n,e):t.getAttribute(e);return"null"===i?null:i},set:i}},ht=c.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof B||t instanceof A||t instanceof G)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},(function(t,e){var n=c.capitalize(e),r=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:r,fromSVG:r&&c.each(r,(function(t,e){this[t]=e}),{}),exportFilter:t[3],get:"get"+n,set:"set"+n}}),{});new function(){var t;function e(e,n,r){var i,a=new c,o=e.getTranslation();n&&(e.isInvertible()?(i=(e=e._shiftless())._inverseTransform(o),o=null):i=new y,a[r?"cx":"x"]=i.x,a[r?"cy":"y"]=i.y);if(!e.isIdentity()){var s=e.decompose();if(s){var l=[],u=s.rotation,h=s.scaling,d=s.skewing;o&&!o.isZero()&&l.push("translate("+t.point(o)+")"),u&&l.push("rotate("+t.number(u)+")"),g.isZero(h.x-1)&&g.isZero(h.y-1)||l.push("scale("+t.point(h)+")"),d.x&&l.push("skewX("+t.number(d.x)+")"),d.y&&l.push("skewY("+t.number(d.y)+")"),a.transform=l.join(" ")}else a.transform="matrix("+e.getValues().join(",")+")"}return a}function n(n,r){for(var i=e(n._matrix),a=n._children,o=ct.create("g",i,t),s=0,l=a.length;s<l;s++){var c=a[s],h=d(c,r);if(h)if(c.isClipMask()){var f=ct.create("clipPath");f.appendChild(h),u(c,f,"clip"),ct.set(o,{"clip-path":"url(#"+f.id+")"})}else o.appendChild(h)}return o}function r(n){var r=n._type,i=n._radius,a=e(n._matrix,!0,"rectangle"!==r);if("rectangle"===r){r="rect";var o=n._size,s=o.width,l=o.height;a.x-=s/2,a.y-=l/2,a.width=s,a.height=l,i.isZero()&&(i=null)}return i&&("circle"===r?a.r=i:(a.rx=i.width,a.ry=i.height)),ct.create(r,a,t)}var i,a={Group:n,Layer:n,Raster:function(n,r){var i=e(n._matrix,!0),a=n.getSize(),o=n.getImage();return i.x-=a.width/2,i.y-=a.height/2,i.width=a.width,i.height=a.height,i.href=0==r.embedImages&&o&&o.src||n.toDataURL(),ct.create("image",i,t)},Path:function(n,i){var a=i.matchShapes;if(a){var o=n.toShape(!1);if(o)return r(o)}var s,l=n._segments,u=l.length,c=e(n._matrix);if(a&&u>=2&&!n.hasHandles())if(u>2){s=n._closed?"polygon":"polyline";for(var h=[],d=0;d<u;d++)h.push(t.point(l[d]._point));c.points=h.join(" ")}else{s="line";var f=l[0]._point,p=l[1]._point;c.set({x1:f.x,y1:f.y,x2:p.x,y2:p.y})}else s="path",c.d=n.getPathData(null,i.precision);return ct.create(s,c,t)},Shape:r,CompoundPath:function(n,r){var i=e(n._matrix),a=n.getPathData(null,r.precision);return a&&(i.d=a),ct.create("path",i,t)},SymbolItem:function(n,r){var i=e(n._matrix,!0),a=n._definition,o=l(a,"symbol"),s=a._item,c=s.getStrokeBounds();return o||((o=ct.create("symbol",{viewBox:t.rectangle(c)})).appendChild(d(s,r)),u(a,o,"symbol")),i.href="#"+o.id,i.x+=c.x,i.y+=c.y,i.width=c.width,i.height=c.height,i.overflow="visible",ct.create("use",i,t)},PointText:function(n){var r=ct.create("text",e(n._matrix,!0),t);return r.textContent=n._content,r}};function s(e,n,r){var i={},a=!r&&e.getParent(),o=[];return null!=e._name&&(i.id=e._name),c.each(ht,(function(n){var r=n.get,s=n.type,h=e[r]();if(n.exportFilter?n.exportFilter(e,h):!a||!c.equals(a[r](),h)){if("color"===s&&null!=h){var d=h.getAlpha();d<1&&(i[n.attribute+"-opacity"]=d)}"style"===s?o.push(n.attribute+": "+h):i[n.attribute]=null==h?"none":"color"===s?h.gradient?function(e){var n=l(e,"color");if(!n){var r,i=e.getGradient(),a=i._radial,o=e.getOrigin(),s=e.getDestination();if(a){r={cx:o.x,cy:o.y,r:o.getDistance(s)};var c=e.getHighlight();c&&(r.fx=c.x,r.fy=c.y)}else r={x1:o.x,y1:o.y,x2:s.x,y2:s.y};r.gradientUnits="userSpaceOnUse",n=ct.create((a?"radial":"linear")+"Gradient",r,t);for(var h=i._stops,d=0,f=h.length;d<f;d++){var p=h[d],m=p._color,g=m.getAlpha(),v=p._offset;r={offset:null==v?d/(f-1):v},m&&(r["stop-color"]=m.toCSS(!0)),g<1&&(r["stop-opacity"]=g),n.appendChild(ct.create("stop",r,t))}u(e,n,"color")}return"url(#"+n.id+")"}(h):h.toCSS(!0):"array"===s?h.join(","):"lookup"===s?n.toSVG[h]:h}})),o.length&&(i.style=o.join(";")),1===i.opacity&&delete i.opacity,e._visible||(i.visibility="hidden"),ct.set(n,i,t)}function l(t,e){return i||(i={ids:{},svgs:{}}),t&&i.svgs[e+"-"+(t._id||t.__id||(t.__id=v.get("svg")))]}function u(t,e,n){i||l();var r=i.ids[n]=(i.ids[n]||0)+1;e.id=n+"-"+r,i.svgs[n+"-"+(t._id||t.__id)]=e}function h(t,e){var n=t,r=null;if(i){for(var a in n="svg"===t.nodeName.toLowerCase()&&t,i.svgs)r||(n||(n=ct.create("svg")).appendChild(t),r=n.insertBefore(ct.create("defs"),n.firstChild)),r.appendChild(i.svgs[a]);i=null}return e.asString?(new o.XMLSerializer).serializeToString(n):n}function d(t,e,n){var r=a[t._class],i=r&&r(t,e);if(i){var o=e.onExport;o&&(i=o(t,i,e)||i);var l=JSON.stringify(t._data);l&&"{}"!==l&&"null"!==l&&i.setAttribute("data-paper-data",l)}return i&&s(t,i,n)}function f(e){return e||(e={}),t=new m(e.precision),e}T.inject({exportSVG:function(t){return h(d(this,t=f(t),!0),t)}}),C.inject({exportSVG:function(n){n=f(n);var r=this._children,i=this.getView(),a=c.pick(n.bounds,"view"),o=n.matrix||"view"===a&&i._matrix,s=o&&E.read([o]),l="view"===a?new w([0,0],i.getViewSize()):"content"===a?T._getBounds(r,s,{stroke:!0}).rect:w.read([a],0,{readNull:!0}),u={version:"1.1",xmlns:ct.svg,"xmlns:xlink":ct.xlink};l&&(u.width=l.width,u.height=l.height,(l.x||0===l.x||l.y||0===l.y)&&(u.viewBox=t.rectangle(l)));var p=ct.create("svg",u,t),m=p;s&&!s.isIdentity()&&(m=p.appendChild(ct.create("g",e(s),t)));for(var g=0,v=r.length;g<v;g++)m.appendChild(d(r[g],n,!0));return h(p,n)}})},new function(){var t,e={};function n(e,n,r,i,a,o){var s=ct.get(e,n)||o,l=null==s?i?null:r?"":0:r?s:parseFloat(s);return/%\s*$/.test(s)?l/100*(a?1:t[/x|^width/.test(n)?"width":"height"]):l}function r(t,e,r,i,a,o,s){return e=n(t,e||"x",!1,i,a,o),r=n(t,r||"y",!1,i,a,s),!i||null!=e&&null!=r?new y(e,r):null}function i(t,e,r,i,a){return e=n(t,e||"width",!1,i,a),r=n(t,r||"height",!1,i,a),!i||null!=e&&null!=r?new x(e,r):null}function a(t,e,n){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?S(t)||t:"lookup"===e?n[t]:t}function h(t,e,n,r){var i=t.childNodes,a="clippath"===e,o="defs"===e,s=new k,l=s._project,u=l._currentStyle,c=[];if(a||o||(s=_(s,t,r),l._currentStyle=s._style.clone()),r)for(var h=t.querySelectorAll("defs"),d=0,f=h.length;d<f;d++)M(h[d],n,!1);for(d=0,f=i.length;d<f;d++){var p,m=i[d];1!==m.nodeType||/^defs$/i.test(m.nodeName)||!(p=M(m,n,!1))||p instanceof R||c.push(p)}return s.addChildren(c),a&&(s=_(s.reduce(),t,r)),l._currentStyle=u,(a||o)&&(s.remove(),s=null),s}function d(t,e){for(var n=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),r=[],i=0,a=n.length;i<a;i+=2)r.push(new y(parseFloat(n[i]),parseFloat(n[i+1])));var o=new V(r);return"polygon"===e&&o.closePath(),o}function f(t,i){var a,o=(n(t,"href",!0)||"").substring(1),s="radialgradient"===i;if(o)(a=e[o].getGradient())._radial^s&&((a=a.clone())._radial=s);else{for(var l=t.childNodes,u=[],c=0,h=l.length;c<h;c++){var d=l[c];1===d.nodeType&&u.push(_(new Y,d))}a=new $(u,s)}var f,p,m,g="userSpaceOnUse"!==n(t,"gradientUnits",!0);return s?(p=(f=r(t,"cx","cy",!1,g,"50%","50%")).add(n(t,"r",!1,!1,g,"50%"),0),m=r(t,"fx","fy",!0,g)):(f=r(t,"x1","y1",!1,g,"0%","0%"),p=r(t,"x2","y2",!1,g,"100%","0%")),_(new W(a,f,p,m),t)._scaleToBounds=g,null}var p={"#document":function(t,e,n,r){for(var i=t.childNodes,a=0,o=i.length;a<o;a++){var s=i[a];if(1===s.nodeType)return M(s,n,r)}},g:h,svg:h,clippath:h,polygon:d,polyline:d,path:function(t){return B.create(t.getAttribute("d"))},lineargradient:f,radialgradient:f,image:function(t){var e=new O(n(t,"href",!0));return e.on("load",(function(){var e=i(t);this.setSize(e);var n=r(t).add(e.divide(2));this._matrix.append((new E).translate(n))})),e},symbol:function(t,e,n,r){return new R(h(t,e,n,r),!0)},defs:h,use:function(t){var i=(n(t,"href",!0)||"").substring(1),a=e[i],o=r(t);return a?a instanceof R?a.place(o):a.clone().translate(o):null},circle:function(t){return new A.Circle(r(t,"cx","cy"),n(t,"r"))},ellipse:function(t){return new A.Ellipse({center:r(t,"cx","cy"),radius:i(t,"rx","ry")})},rect:function(t){return new A.Rectangle(new w(r(t),i(t)),i(t,"rx","ry"))},line:function(t){return new V.Line(r(t,"x1","y1"),r(t,"x2","y2"))},text:function(t){var e=new q(r(t).add(r(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:h};function m(t,e,n,r){if(t.transform){for(var i=(r.getAttribute(n)||"").split(/\)\s*/g),a=new E,o=0,s=i.length;o<s;o++){var l=i[o];if(!l)break;for(var u=l.split(/\(\s*/),c=u[0],h=u[1].split(/[\s,]+/g),d=0,f=h.length;d<f;d++)h[d]=parseFloat(h[d]);switch(c){case"matrix":a.append(new E(h[0],h[1],h[2],h[3],h[4],h[5]));break;case"rotate":a.rotate(h[0],h[1]||0,h[2]||0);break;case"translate":a.translate(h[0],h[1]||0);break;case"scale":a.scale(h);break;case"skewX":a.skew(h[0],0);break;case"skewY":a.skew(0,h[0])}}t.transform(a)}}function g(t,e,n){var r="fill-opacity"===n?"getFillColor":"getStrokeColor",i=t[r]&&t[r]();i&&i.setAlpha(parseFloat(e))}var v=c.set(c.each(ht,(function(t){this[t.attribute]=function(e,n){if(e[t.set]&&(e[t.set](a(n,t.type,t.fromSVG)),"color"===t.type)){var r=e[t.get]();if(r&&r._scaleToBounds){var i=e.getBounds();r.transform((new E).translate(i.getPoint()).scale(i.getSize()))}}}}),{}),{id:function(t,n){e[n]=t,t.setName&&t.setName(n)},"clip-path":function(t,e){var n=S(e);if(n){if((n=n.clone()).setClipMask(!0),!(t instanceof k))return new k(n,t);t.insertChild(0,n)}},gradientTransform:m,transform:m,"fill-opacity":g,"stroke-opacity":g,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var n=e.match(/(.*)%$/);t.setOffset(n?n[1]/100:parseFloat(e))}},viewBox:function(t,e,n,r,o){var s,l=new w(a(e,"array")),u=i(r,null,null,!0);if(t instanceof k){var c=u?u.divide(l.getSize()):1,h=(new E).scale(c).translate(l.getPoint().negate());s=t}else t instanceof R&&(u&&l.setSize(u),s=t._item);if(s){if("visible"!==b(r,"overflow",o)){var d=new A.Rectangle(l);d.setClipMask(!0),s.addChild(d)}h&&s.transform(h)}}});function b(t,e,n){var r=t.attributes[e],i=r&&r.value;if(!i&&t.style){var a=c.camelize(e);(i=t.style[a])||n.node[a]===n.parent[a]||(i=n.node[a])}return i?"none"===i?null:i:s}function _(t,e,n){var r=e.parentNode,i={node:X.getStyles(e)||{},parent:!n&&!/^defs$/i.test(r.tagName)&&X.getStyles(r)||{}};return c.each(v,(function(n,r){var a=b(e,r,i);t=a!==s&&n(t,a,r,e,i)||t})),t}function S(t){var n=t&&t.match(/\((?:["'#]*)([^"')]+)/),r=n&&n[1],i=r&&e[l?r.replace(l.location.href.split("#")[0]+"#",""):r];return i&&i._scaleToBounds&&((i=i.clone())._scaleToBounds=!0),i}function M(n,r,a){var o,s,l,h=n.nodeName.toLowerCase(),d="#document"!==h,f=u.body;a&&d&&(t=dt.getView().getSize(),t=i(n,null,null,!0)||t,o=ct.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),s=n.parentNode,l=n.nextSibling,o.appendChild(n),f.appendChild(o));var m=dt.settings,g=m.applyMatrix,v=m.insertItems;m.applyMatrix=!1,m.insertItems=!1;var y=p[h],b=y&&y(n,h,r,a)||null;if(m.insertItems=v,m.applyMatrix=g,b){!d||b instanceof k||(b=_(b,n,a));var x=r.onImport,w=d&&n.getAttribute("data-paper-data");x&&(b=x(n,b,r)||b),r.expandShapes&&b instanceof A&&(b.remove(),b=b.toPath()),w&&(b._data=JSON.parse(w))}return o&&(f.removeChild(o),s&&(l?s.insertBefore(n,l):s.appendChild(n))),a&&(e={},b&&c.pick(r.applyMatrix,g)&&b.matrix.apply(!0,!0)),b}function P(t,e,n){if(!t)return null;e="function"==typeof e?{onLoad:e}:e||{};var r=dt,i=null;function a(a){try{var u="object"==typeof a?a:(new o.DOMParser).parseFromString(a.trim(),"image/svg+xml");if(!u.nodeName)throw u=null,new Error("Unsupported SVG source: "+t);dt=r,i=M(u,e,!0),e&&!1===e.insert||n._insertItem(s,i);var c=e.onLoad;c&&c(i,a)}catch(t){l(t)}}function l(t,n){var r=e.onError;if(!r)throw new Error(t);r(t,n)}if("string"!=typeof t||/^[\s\S]*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var c=new FileReader;return c.onload=function(){a(c.result)},c.onerror=function(){l(c.error)},c.readAsText(t)}a(t)}else{var h=u.getElementById(t);h?a(h):st({url:t,async:!0,onLoad:a,onError:l})}return i}T.inject({importSVG:function(t,e){return P(t,e,this)}}),C.inject({importSVG:function(t,e){return this.activate(),P(t,e,this)}})},c.exports.PaperScript=function(){var t,e,h,f=this,p=f.acorn;if(!p)try{p=n(369)}catch(t){}p||(p=t=e={},h=function(t){"use strict";var e,n,r,i;t.version="0.5.0",t.parse=function(t,i){return n=String(t),r=n.length,o(i),Wt(),function(t){v=y=s,e.locations&&(b=new qt),x=w=null,_=[],Jt();var n=t||ce(),r=!0;for(t||(n.body=[]);d!==A;){var i=we();n.body.push(i),r&&fe(i)&&se(!0),r=!1}return de(n,"Program")}(e.program)};var a=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function o(t){for(var n in e=t||{},a)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=a[n]);i=e.sourceFile||null}var s,l,u,c,h,d,f,p,m,g,v,y,b,x,_,w,S=t.getLineInfo=function(t,e){for(var n=1,r=0;;){Ht.lastIndex=r;var i=Ht.exec(t);if(!(i&&i.index<e))break;++n,r=i.index+i[0].length}return{line:n,column:e-r}};function E(t,e){var r=S(n,t);e+=" ("+r.line+":"+r.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=r,i.raisedAt=s,i}t.tokenize=function(t,i){n=String(t),r=n.length,o(i),Wt();var a={};function v(t){return y=u,Jt(t),a.start=l,a.end=u,a.startLoc=c,a.endLoc=h,a.type=d,a.value=f,a}return v.jumpTo=function(t,r){var i;if(s=t,e.locations)for(m=1,g=Ht.lastIndex=0;(i=Ht.exec(n))&&i.index<t;)++m,g=i.index+i[0].length;p=r,Xt()},v};var M=[],C={type:"num"},T={type:"regexp"},k={type:"string"},P={type:"name"},A={type:"eof"},O={keyword:"break"},N={keyword:"case",beforeExpr:!0},R={keyword:"catch"},L={keyword:"continue"},I={keyword:"debugger"},D={keyword:"default"},z={keyword:"do",isLoop:!0},F={keyword:"else",beforeExpr:!0},B={keyword:"finally"},V={keyword:"for",isLoop:!0},j={keyword:"function"},H={keyword:"if"},U={keyword:"return",beforeExpr:!0},G={keyword:"switch"},q={keyword:"throw",beforeExpr:!0},W={keyword:"try"},$={keyword:"var"},Y={keyword:"while",isLoop:!0},Q={keyword:"with"},X={keyword:"new",beforeExpr:!0},Z={keyword:"this"},J={keyword:"null",atomValue:null},K={keyword:"true",atomValue:!0},tt={keyword:"false",atomValue:!1},et={keyword:"in",binop:7,beforeExpr:!0},nt={break:O,case:N,catch:R,continue:L,debugger:I,default:D,do:z,else:F,finally:B,for:V,function:j,if:H,return:U,switch:G,throw:q,try:W,var:$,while:Y,with:Q,null:J,true:K,false:tt,new:X,in:et,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Z,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},rt={type:"[",beforeExpr:!0},it={type:"]"},at={type:"{",beforeExpr:!0},ot={type:"}"},st={type:"(",beforeExpr:!0},lt={type:")"},ut={type:",",beforeExpr:!0},ct={type:";",beforeExpr:!0},ht={type:":",beforeExpr:!0},dt={type:"."},ft={type:"?",beforeExpr:!0},pt={binop:10,beforeExpr:!0},mt={isAssign:!0,beforeExpr:!0},gt={isAssign:!0,beforeExpr:!0},vt={postfix:!0,prefix:!0,isUpdate:!0},yt={prefix:!0,beforeExpr:!0},bt={binop:1,beforeExpr:!0},xt={binop:2,beforeExpr:!0},_t={binop:3,beforeExpr:!0},wt={binop:4,beforeExpr:!0},St={binop:5,beforeExpr:!0},Et={binop:6,beforeExpr:!0},Mt={binop:7,beforeExpr:!0},Ct={binop:8,beforeExpr:!0},Tt={binop:9,prefix:!0,beforeExpr:!0},kt={binop:10,beforeExpr:!0};for(var Pt in t.tokTypes={bracketL:rt,bracketR:it,braceL:at,braceR:ot,parenL:st,parenR:lt,comma:ut,semi:ct,colon:ht,dot:dt,question:ft,slash:pt,eq:mt,name:P,eof:A,num:C,regexp:T,string:k},nt)t.tokTypes["_"+Pt]=nt[Pt];function At(t){t=t.split(" ");var e="",n=[];t:for(var r=0;r<t.length;++r){for(var i=0;i<n.length;++i)if(n[i][0].length==t[r].length){n[i].push(t[r]);continue t}n.push([t[r]])}function a(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var n=0;n<t.length;++n)e+="case "+JSON.stringify(t[n])+":";e+="return true}return false;"}if(n.length>3){for(n.sort((function(t,e){return e.length-t.length})),e+="switch(str.length){",r=0;r<n.length;++r){var o=n[r];e+="case "+o[0].length+":",a(o)}e+="}"}else a(t);return new Function("str",e)}var Ot,Nt=At("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Rt=At("class enum extends super const export import"),Lt=At("implements interface let package private protected public static yield"),It=At("eval arguments"),Dt=At("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),zt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ft="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Bt=new RegExp("["+Ft+"]"),Vt=new RegExp("["+Ft+"------------------------------------------------------------------------------------------------------------------------------------------]"),jt=/[\n\r\u2028\u2029]/,Ht=/\r\n|[\n\r\u2028\u2029]/g,Ut=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&Bt.test(String.fromCharCode(t)))},Gt=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&Vt.test(String.fromCharCode(t))))};function qt(){this.line=m,this.column=s-g}function Wt(){m=1,s=g=0,p=!0,Xt()}function $t(t,n){u=s,e.locations&&(h=new qt),d=t,Xt(),f=n,p=t.beforeExpr}function Yt(){var t,r=e.onComment&&e.locations&&new qt,i=s,a=n.indexOf("*/",s+=2);if(-1===a&&E(s-2,"Unterminated comment"),s=a+2,e.locations)for(Ht.lastIndex=i;(t=Ht.exec(n))&&t.index<s;)++m,g=t.index+t[0].length;e.onComment&&e.onComment(!0,n.slice(i+2,a),i,s,r,e.locations&&new qt)}function Qt(){for(var t=s,i=e.onComment&&e.locations&&new qt,a=n.charCodeAt(s+=2);s<r&&10!==a&&13!==a&&8232!==a&&8233!==a;)++s,a=n.charCodeAt(s);e.onComment&&e.onComment(!1,n.slice(t+2,s),t,s,i,e.locations&&new qt)}function Xt(){for(;s<r;){var t=n.charCodeAt(s);if(32===t)++s;else if(13===t)++s,10===(i=n.charCodeAt(s))&&++s,e.locations&&(++m,g=s);else if(10===t||8232===t||8233===t)++s,e.locations&&(++m,g=s);else if(t>8&&t<14)++s;else if(47===t){var i;if(42===(i=n.charCodeAt(s+1)))Yt();else{if(47!==i)break;Qt()}}else if(160===t)++s;else{if(!(t>=5760&&zt.test(String.fromCharCode(t))))break;++s}}}function Zt(t){switch(t){case 46:return function(){var t=n.charCodeAt(s+1);return t>=48&&t<=57?ne(!0):(++s,$t(dt))}();case 40:return++s,$t(st);case 41:return++s,$t(lt);case 59:return++s,$t(ct);case 44:return++s,$t(ut);case 91:return++s,$t(rt);case 93:return++s,$t(it);case 123:return++s,$t(at);case 125:return++s,$t(ot);case 58:return++s,$t(ht);case 63:return++s,$t(ft);case 48:var i=n.charCodeAt(s+1);if(120===i||88===i)return function(){s+=2;var t=ee(16);return null==t&&E(l+2,"Expected hexadecimal number"),Ut(n.charCodeAt(s))&&E(s,"Identifier directly after number"),$t(C,t)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ne(!1);case 34:case 39:return function(t){s++;for(var i="";;){s>=r&&E(l,"Unterminated string constant");var a=n.charCodeAt(s);if(a===t)return++s,$t(k,i);if(92===a){a=n.charCodeAt(++s);var o=/^[0-7]+/.exec(n.slice(s,s+3));for(o&&(o=o[0]);o&&parseInt(o,8)>255;)o=o.slice(0,-1);if("0"===o&&(o=null),++s,o)w&&E(s-2,"Octal literal in strict mode"),i+=String.fromCharCode(parseInt(o,8)),s+=o.length-1;else switch(a){case 110:i+="\n";break;case 114:i+="\r";break;case 120:i+=String.fromCharCode(re(2));break;case 117:i+=String.fromCharCode(re(4));break;case 85:i+=String.fromCharCode(re(8));break;case 116:i+="\t";break;case 98:i+="\b";break;case 118:i+="\v";break;case 102:i+="\f";break;case 48:i+="\0";break;case 13:10===n.charCodeAt(s)&&++s;case 10:e.locations&&(g=s,++m);break;default:i+=String.fromCharCode(a)}}else 13!==a&&10!==a&&8232!==a&&8233!==a||E(l,"Unterminated string constant"),i+=String.fromCharCode(a),++s}}(t);case 47:return function(){var t=n.charCodeAt(s+1);return p?(++s,te()):61===t?Kt(gt,2):Kt(pt,1)}();case 37:case 42:return 61===n.charCodeAt(s+1)?Kt(gt,2):Kt(kt,1);case 124:case 38:return function(t){var e=n.charCodeAt(s+1);return e===t?Kt(124===t?bt:xt,2):61===e?Kt(gt,2):Kt(124===t?_t:St,1)}(t);case 94:return 61===n.charCodeAt(s+1)?Kt(gt,2):Kt(wt,1);case 43:case 45:return function(t){var e=n.charCodeAt(s+1);return e===t?45==e&&62==n.charCodeAt(s+2)&&jt.test(n.slice(y,s))?(s+=3,Qt(),Xt(),Jt()):Kt(vt,2):61===e?Kt(gt,2):Kt(Tt,1)}(t);case 60:case 62:return function(t){var e=n.charCodeAt(s+1),r=1;return e===t?(r=62===t&&62===n.charCodeAt(s+2)?3:2,61===n.charCodeAt(s+r)?Kt(gt,r+1):Kt(Ct,r)):33==e&&60==t&&45==n.charCodeAt(s+2)&&45==n.charCodeAt(s+3)?(s+=4,Qt(),Xt(),Jt()):(61===e&&(r=61===n.charCodeAt(s+2)?3:2),Kt(Mt,r))}(t);case 61:case 33:return function(t){return 61===n.charCodeAt(s+1)?Kt(Et,61===n.charCodeAt(s+2)?3:2):Kt(61===t?mt:yt,1)}(t);case 126:return Kt(yt,1)}return!1}function Jt(t){if(t?s=l+1:l=s,e.locations&&(c=new qt),t)return te();if(s>=r)return $t(A);var i=n.charCodeAt(s);if(Ut(i)||92===i)return ae();var a=Zt(i);if(!1===a){var o=String.fromCharCode(i);if("\\"===o||Bt.test(o))return ae();E(s,"Unexpected character '"+o+"'")}return a}function Kt(t,e){var r=n.slice(s,s+e);s+=e,$t(t,r)}function te(){for(var t,e,i=s;;){s>=r&&E(i,"Unterminated regular expression");var a=n.charAt(s);if(jt.test(a)&&E(i,"Unterminated regular expression"),t)t=!1;else{if("["===a)e=!0;else if("]"===a&&e)e=!1;else if("/"===a&&!e)break;t="\\"===a}++s}var o=n.slice(i,s);++s;var l=ie();l&&!/^[gmsiy]*$/.test(l)&&E(i,"Invalid regexp flag");try{var u=new RegExp(o,l)}catch(t){t instanceof SyntaxError&&E(i,t.message),E(t)}return $t(T,u)}function ee(t,e){for(var r=s,i=0,a=0,o=null==e?1/0:e;a<o;++a){var l,u=n.charCodeAt(s);if((l=u>=97?u-97+10:u>=65?u-65+10:u>=48&&u<=57?u-48:1/0)>=t)break;++s,i=i*t+l}return s===r||null!=e&&s-r!==e?null:i}function ne(t){var e=s,r=!1,i=48===n.charCodeAt(s);t||null!==ee(10)||E(e,"Invalid number"),46===n.charCodeAt(s)&&(++s,ee(10),r=!0);var a=n.charCodeAt(s);69!==a&&101!==a||(43!==(a=n.charCodeAt(++s))&&45!==a||++s,null===ee(10)&&E(e,"Invalid number"),r=!0),Ut(n.charCodeAt(s))&&E(s,"Identifier directly after number");var o,l=n.slice(e,s);return r?o=parseFloat(l):i&&1!==l.length?/[89]/.test(l)||w?E(e,"Invalid number"):o=parseInt(l,8):o=parseInt(l,10),$t(C,o)}function re(t){var e=ee(16,t);return null===e&&E(l,"Bad character escape sequence"),e}function ie(){Ot=!1;for(var t,e=!0,r=s;;){var i=n.charCodeAt(s);if(Gt(i))Ot&&(t+=n.charAt(s)),++s;else{if(92!==i)break;Ot||(t=n.slice(r,s)),Ot=!0,117!=n.charCodeAt(++s)&&E(s,"Expecting Unicode escape sequence \\uXXXX"),++s;var a=re(4),o=String.fromCharCode(a);o||E(s-1,"Invalid Unicode escape"),(e?Ut(a):Gt(a))||E(s-4,"Invalid Unicode escape"),t+=o}e=!1}return Ot?t:n.slice(r,s)}function ae(){var t=ie(),e=P;return!Ot&&Dt(t)&&(e=nt[t]),$t(e,t)}function oe(){v=l,y=u,b=h,Jt()}function se(t){if(w=t,s=l,e.locations)for(;s<g;)g=n.lastIndexOf("\n",g-2)+1,--m;Xt(),Jt()}function le(){this.type=null,this.start=l,this.end=null}function ue(){this.start=c,this.end=null,null!==i&&(this.source=i)}function ce(){var t=new le;return e.locations&&(t.loc=new ue),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[l,0]),t}function he(t){var n=new le;return n.start=t.start,e.locations&&(n.loc=new ue,n.loc.start=t.loc.start),e.ranges&&(n.range=[t.range[0],0]),n}function de(t,n){return t.type=n,t.end=y,e.locations&&(t.loc.end=b),e.ranges&&(t.range[1]=y),t}function fe(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function pe(t){if(d===t)return oe(),!0}function me(){return!e.strictSemicolons&&(d===A||d===ot||jt.test(n.slice(y,l)))}function ge(){pe(ct)||me()||ye()}function ve(t){d===t?oe():ye()}function ye(){E(l,"Unexpected token")}function be(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&E(t.start,"Assigning to rvalue"),w&&"Identifier"===t.type&&It(t.name)&&E(t.start,"Assigning to "+t.name+" in strict mode")}var xe={kind:"loop"},_e={kind:"switch"};function we(){(d===pt||d===gt&&"/="==f)&&Jt(!0);var t=d,r=ce();switch(t){case O:case L:oe();var i=t===O;pe(ct)||me()?r.label=null:d!==P?ye():(r.label=De(),ge());for(var a=0;a<_.length;++a){var o=_[a];if(null==r.label||o.name===r.label.name){if(null!=o.kind&&(i||"loop"===o.kind))break;if(r.label&&i)break}}return a===_.length&&E(r.start,"Unsyntactic "+t.keyword),de(r,i?"BreakStatement":"ContinueStatement");case I:return oe(),ge(),de(r,"DebuggerStatement");case z:return oe(),_.push(xe),r.body=we(),_.pop(),ve(Y),r.test=Se(),ge(),de(r,"DoWhileStatement");case V:if(oe(),_.push(xe),ve(st),d===ct)return Me(r,null);if(d===$){var s=ce();return oe(),Te(s,!0),de(s,"VariableDeclaration"),1===s.declarations.length&&pe(et)?Ce(r,s):Me(r,s)}return s=ke(!1,!0),pe(et)?(be(s),Ce(r,s)):Me(r,s);case j:return oe(),Le(r,!0);case H:return oe(),r.test=Se(),r.consequent=we(),r.alternate=pe(F)?we():null,de(r,"IfStatement");case U:return x||e.allowReturnOutsideFunction||E(l,"'return' outside of function"),oe(),pe(ct)||me()?r.argument=null:(r.argument=ke(),ge()),de(r,"ReturnStatement");case G:oe(),r.discriminant=Se(),r.cases=[],ve(at),_.push(_e);for(var u,c;d!=ot;)if(d===N||d===D){var h=d===N;u&&de(u,"SwitchCase"),r.cases.push(u=ce()),u.consequent=[],oe(),h?u.test=ke():(c&&E(v,"Multiple default clauses"),c=!0,u.test=null),ve(ht)}else u||ye(),u.consequent.push(we());return u&&de(u,"SwitchCase"),oe(),_.pop(),de(r,"SwitchStatement");case q:return oe(),jt.test(n.slice(y,l))&&E(y,"Illegal newline after throw"),r.argument=ke(),ge(),de(r,"ThrowStatement");case W:if(oe(),r.block=Ee(),r.handler=null,d===R){var p=ce();oe(),ve(st),p.param=De(),w&&It(p.param.name)&&E(p.param.start,"Binding "+p.param.name+" in strict mode"),ve(lt),p.guard=null,p.body=Ee(),r.handler=de(p,"CatchClause")}return r.guardedHandlers=M,r.finalizer=pe(B)?Ee():null,r.handler||r.finalizer||E(r.start,"Missing catch or finally clause"),de(r,"TryStatement");case $:return oe(),Te(r),ge(),de(r,"VariableDeclaration");case Y:return oe(),r.test=Se(),_.push(xe),r.body=we(),_.pop(),de(r,"WhileStatement");case Q:return w&&E(l,"'with' in strict mode"),oe(),r.object=Se(),r.body=we(),de(r,"WithStatement");case at:return Ee();case ct:return oe(),de(r,"EmptyStatement");default:var m=f,g=ke();if(t===P&&"Identifier"===g.type&&pe(ht)){for(a=0;a<_.length;++a)_[a].name===m&&E(g.start,"Label '"+m+"' is already declared");var b=d.isLoop?"loop":d===G?"switch":null;return _.push({name:m,kind:b}),r.body=we(),_.pop(),r.label=g,de(r,"LabeledStatement")}return r.expression=g,ge(),de(r,"ExpressionStatement")}}function Se(){ve(st);var t=ke();return ve(lt),t}function Ee(t){var e,n=ce(),r=!0,i=!1;for(n.body=[],ve(at);!pe(ot);){var a=we();n.body.push(a),r&&t&&fe(a)&&(e=i,se(i=!0)),r=!1}return i&&!e&&se(!1),de(n,"BlockStatement")}function Me(t,e){return t.init=e,ve(ct),t.test=d===ct?null:ke(),ve(ct),t.update=d===lt?null:ke(),ve(lt),t.body=we(),_.pop(),de(t,"ForStatement")}function Ce(t,e){return t.left=e,t.right=ke(),ve(lt),t.body=we(),_.pop(),de(t,"ForInStatement")}function Te(t,e){for(t.declarations=[],t.kind="var";;){var n=ce();if(n.id=De(),w&&It(n.id.name)&&E(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=pe(mt)?ke(!0,e):null,t.declarations.push(de(n,"VariableDeclarator")),!pe(ut))break}return t}function ke(t,e){var n=Pe(e);if(!t&&d===ut){var r=he(n);for(r.expressions=[n];pe(ut);)r.expressions.push(Pe(e));return de(r,"SequenceExpression")}return n}function Pe(t){var e=function(t){var e=function(t){return function t(e,n,r){var i=d.binop;if(null!=i&&(!r||d!==et)&&i>n){var a=he(e);a.left=e,a.operator=f;var o=d;oe(),a.right=t(Ae(),i,r);var s=de(a,o===bt||o===xt?"LogicalExpression":"BinaryExpression");return t(s,n,r)}return e}(Ae(),-1,t)}(t);if(pe(ft)){var n=he(e);return n.test=e,n.consequent=ke(!0),ve(ht),n.alternate=ke(!0,t),de(n,"ConditionalExpression")}return e}(t);if(d.isAssign){var n=he(e);return n.operator=f,n.left=e,oe(),n.right=Pe(t),be(e),de(n,"AssignmentExpression")}return e}function Ae(){if(d.prefix){var t=ce(),e=d.isUpdate;return t.operator=f,t.prefix=!0,p=!0,oe(),t.argument=Ae(),e?be(t.argument):w&&"delete"===t.operator&&"Identifier"===t.argument.type&&E(t.start,"Deleting local variable in strict mode"),de(t,e?"UpdateExpression":"UnaryExpression")}for(var n=Oe(Ne());d.postfix&&!me();)(t=he(n)).operator=f,t.prefix=!1,t.argument=n,be(n),oe(),n=de(t,"UpdateExpression");return n}function Oe(t,e){var n;return pe(dt)?((n=he(t)).object=t,n.property=De(!0),n.computed=!1,Oe(de(n,"MemberExpression"),e)):pe(rt)?((n=he(t)).object=t,n.property=ke(),n.computed=!0,ve(it),Oe(de(n,"MemberExpression"),e)):!e&&pe(st)?((n=he(t)).callee=t,n.arguments=Ie(lt,!1),Oe(de(n,"CallExpression"),e)):t}function Ne(){switch(d){case Z:var t=ce();return oe(),de(t,"ThisExpression");case P:return De();case C:case k:case T:return(t=ce()).value=f,t.raw=n.slice(l,u),oe(),de(t,"Literal");case J:case K:case tt:return(t=ce()).value=d.atomValue,t.raw=d.keyword,oe(),de(t,"Literal");case st:var r=c,i=l;oe();var a=ke();return a.start=i,a.end=u,e.locations&&(a.loc.start=r,a.loc.end=h),e.ranges&&(a.range=[i,u]),ve(lt),a;case rt:return t=ce(),oe(),t.elements=Ie(it,!0,!0),de(t,"ArrayExpression");case at:return function(){var t=ce(),n=!0,r=!1;for(t.properties=[],oe();!pe(ot);){if(n)n=!1;else if(ve(ut),e.allowTrailingCommas&&pe(ot))break;var i,a={key:Re()},o=!1;if(pe(ht)?(a.value=ke(!0),i=a.kind="init"):e.ecmaVersion>=5&&"Identifier"===a.key.type&&("get"===a.key.name||"set"===a.key.name)?(o=r=!0,i=a.kind=a.key.name,a.key=Re(),d!==st&&ye(),a.value=Le(ce(),!1)):ye(),"Identifier"===a.key.type&&(w||r))for(var s=0;s<t.properties.length;++s){var l=t.properties[s];if(l.key.name===a.key.name){var u=i==l.kind||o&&"init"===l.kind||"init"===i&&("get"===l.kind||"set"===l.kind);u&&!w&&"init"===i&&"init"===l.kind&&(u=!1),u&&E(a.key.start,"Redefinition of property")}}t.properties.push(a)}return de(t,"ObjectExpression")}();case j:return t=ce(),oe(),Le(t,!1);case X:return function(){var t=ce();return oe(),t.callee=Oe(Ne(),!0),pe(st)?t.arguments=Ie(lt,!1):t.arguments=M,de(t,"NewExpression")}();default:ye()}}function Re(){return d===C||d===k?Ne():De(!0)}function Le(t,e){d===P?t.id=De():e?ye():t.id=null,t.params=[];var n=!0;for(ve(st);!pe(lt);)n?n=!1:ve(ut),t.params.push(De());var r=x,i=_;if(x=!0,_=[],t.body=Ee(!0),x=r,_=i,w||t.body.body.length&&fe(t.body.body[0]))for(var a=t.id?-1:0;a<t.params.length;++a){var o=a<0?t.id:t.params[a];if((Lt(o.name)||It(o.name))&&E(o.start,"Defining '"+o.name+"' in strict mode"),a>=0)for(var s=0;s<a;++s)o.name===t.params[s].name&&E(o.start,"Argument name clash in strict mode")}return de(t,e?"FunctionDeclaration":"FunctionExpression")}function Ie(t,n,r){for(var i=[],a=!0;!pe(t);){if(a)a=!1;else if(ve(ut),n&&e.allowTrailingCommas&&pe(t))break;r&&d===ut?i.push(null):i.push(ke(!0))}return i}function De(t){var r=ce();return t&&"everywhere"==e.forbidReserved&&(t=!1),d===P?(!t&&(e.forbidReserved&&(3===e.ecmaVersion?Nt:Rt)(f)||w&&Lt(f))&&-1==n.slice(l,u).indexOf("\\")&&E(l,"The keyword '"+f+"' is reserved"),r.name=f):t&&d.keyword?r.name=d.keyword:ye(),p=!1,oe(),de(r,"Identifier")}},"object"==typeof t&&"object"==typeof e?h(t):(r=[t],(a="function"==typeof(i=h)?i.apply(t,r):i)===s||(e.exports=a)),p.version||(p=null));function m(t,e){return(f.acorn||p).parse(t,e)}var g={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},v={"-":"__negate","+":"__self"},b=c.each(["add","subtract","multiply","divide","modulo","equals","negate"],(function(t){this["__"+t]="#"+t}),{__self:function(){return this}});function _(t,e,n){var r=g[e];if(t&&t[r]){var i=t[r](n);return"!="===e?!i:i}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"==":return t==n;case"!=":return t!=n}}function w(t,e){var n=v[t];if(e&&e[n])return e[n]();switch(t){case"+":return+e;case"-":return-e}}function S(t,e){if(!t)return"";var n=[];function r(t){for(var e=0,r=n.length;e<r;e++){var i=n[e];if(i[0]>=t)break;t+=i[1]}return t}function i(e){return t.substring(r(e.range[0]),r(e.range[1]))}function a(e,i){for(var a=r(e.range[0]),o=r(e.range[1]),s=0,l=n.length-1;l>=0;l--)if(a>n[l][0]){s=l+1;break}n.splice(s,0,[a,i.length-o+a]),t=t.substring(0,a)+i+t.substring(o)}function s(e,n){switch(e.type){case"UnaryExpression":if(e.operator in v&&"Literal"!==e.argument.type){var o=i(e.argument);a(e,'$__("'+e.operator+'", '+o+")")}break;case"BinaryExpression":if(e.operator in g&&"Literal"!==e.left.type){var s=i(e.left),l=i(e.right),u=function(e,n){return t.substring(r(e.range[1]),r(n.range[0]))}(e.left,e.right),c=e.operator;a(e,"__$__("+s+","+u.replace(new RegExp("\\"+c),'"'+c+'"')+", "+l+")")}break;case"UpdateExpression":case"AssignmentExpression":var h=n&&n.type;if(!("ForStatement"===h||"BinaryExpression"===h&&/^[=!<>]/.test(n.operator)||"MemberExpression"===h&&n.computed))if("UpdateExpression"===e.type){var d=(o=i(e.argument))+" = "+(f="__$__("+o+', "'+e.operator[0]+'", 1)');e.prefix?d="("+d+")":"AssignmentExpression"!==h&&"VariableDeclarator"!==h&&"BinaryExpression"!==h||(i(n.left||n.id)===o&&(d=f),d=o+"; "+d),a(e,d)}else if(/^.=$/.test(e.operator)&&"Literal"!==e.left.type){s=i(e.left),l=i(e.right);var f=s+" = __$__("+s+', "'+e.operator[0]+'", '+l+")";a(e,/^\(.*\)$/.test(i(e))?"("+f+")":f)}}}var c,h=(e=e||{}).url||"",d=e.sourceMaps,f=e.paperFeatures||{},p=e.source||t,y=e.offset||0,b=dt.agent,x=b.versionNumber,_=!1,w=/\r\n|\n|\r/gm;if(d&&(b.chrome&&x>=30||b.webkit&&x>=537.76||b.firefox&&x>=23||b.node)){if(b.node)y-=2;else if(l&&h&&!l.location.href.indexOf(h)){var S=u.getElementsByTagName("html")[0].innerHTML;y=S.substr(0,S.indexOf(t)+1).match(w).length+1}var E=["AA"+function(t){var e="";for(t=(Math.abs(t)<<1)+(t<0?1:0);t||!e;){var n=31&t;(t>>=5)&&(n|=32),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n]}return e}((_=y>0&&!(b.chrome&&x>=36||b.safari&&x>=600||b.firefox&&x>=40||b.node))?0:y)+"A"];E.length=(t.match(w)||[]).length+1+(_?y:0),c={version:3,file:h,names:[],mappings:E.join(";AACA"),sourceRoot:"",sources:[h],sourcesContent:[p]}}return!1===f.operatorOverloading&&!1===f.moduleExports||function t(e,n,r){if(e){for(var o in e)if("range"!==o&&"loc"!==o){var l=e[o];if(Array.isArray(l))for(var u=0,c=l.length;u<c;u++)t(l[u],e,r);else l&&"object"==typeof l&&t(l,e,r)}!1!==r.operatorOverloading&&s(e,n),!1!==r.moduleExports&&function(t){switch(t.type){case"ExportDefaultDeclaration":a({range:[t.start,t.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var e=t.declaration,n=t.specifiers;if(e){var r=e.declarations;r&&(r.forEach((function(t){a(t,"module.exports."+i(t))})),a({range:[t.start,e.start+e.kind.length]},""))}else if(n){var o=n.map((function(t){var e=i(t);return"module.exports."+e+" = "+e+"; "})).join("");o&&a(t,o)}}}(e)}}(m(t,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,f),c&&(_&&(t=new Array(y+1).join("\n")+t),/^(inline|both)$/.test(d)&&(t+="\n//# sourceMappingURL=data:application/json;base64,"+o.btoa(unescape(encodeURIComponent(JSON.stringify(c))))),t+="\n//# sourceURL="+(h||"paperscript")),{url:h,source:p,code:t,map:c}}function E(t,e,n){dt=e;var r,i=e.getView(),a=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)&&!/\bnew\s+Tool\b/.test(t)?new at:null,o=a?a._events:[],s=["onFrame","onResize"].concat(o),l=[],h=[],d="object"==typeof t?t:S(t,n);function f(e,n){for(var r in e)!n&&/^_/.test(r)||!new RegExp("([\\b\\s\\W]|^)"+r.replace(/\$/g,"\\$")+"\\b").test(t)||(l.push(r),h.push(e[r]))}t=d.code,f({__$__:_,$__:w,paper:e,tool:a},!0),f(e),t="var module = { exports: {} }; "+t,(v=c.each(s,(function(e){new RegExp("\\s+"+e+"\\b").test(t)&&(l.push(e),this.push("module.exports."+e+" = "+e+";"))}),[]).join("\n"))&&(t+="\n"+v),t+="\nreturn module.exports;";var p=dt.agent;if(u&&(p.chrome||p.firefox&&p.versionNumber<40)){var m=u.createElement("script"),g=u.head||u.getElementsByTagName("head")[0];p.firefox&&(t="\n"+t),m.appendChild(u.createTextNode("document.__paperscript__ = function("+l+") {"+t+"\n}")),g.appendChild(m),r=u.__paperscript__,delete u.__paperscript__,g.removeChild(m)}else r=Function(l,t);var v,b=(v=r&&r.apply(e,h))||{};return c.each(o,(function(t){var e=b[t];e&&(a[t]=e)})),i&&(b.onResize&&i.setOnResize(b.onResize),i.emit("resize",{size:i.size,delta:new y}),b.onFrame&&i.setOnFrame(b.onFrame),i.requestUpdate()),v}function M(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==d.getAttribute(t,"ignore")){var e=d.getAttribute(t,"canvas"),n=u.getElementById(e),r=t.src||t.getAttribute("data-src"),i=d.hasAttribute(t,"async");if(!n)throw new Error('Unable to find canvas with id "'+e+'"');var a=d.get(n.getAttribute("data-paper-scope"))||(new d).setup(n);return n.setAttribute("data-paper-scope",a._id),r?st({url:r,async:i,mimeType:"text/plain",onLoad:function(t){E(t,a,r)}}):E(t.innerHTML,a,t.baseURI),t.setAttribute("data-paper-ignore","true"),a}}function C(){c.each(u&&u.getElementsByTagName("script"),M)}return y.inject(b),x.inject(b),W.inject(b),l&&("complete"===u.readyState?setTimeout(C):Z.add(l,{load:C})),{compile:S,execute:E,load:function(t){return t?M(t):C()},parse:m,calculateBinary:_,calculateUnary:w}}.call(this);var dt=new(d.inject(c.exports,{Base:c,Numerical:g,Key:nt,DomEvent:Z,DomElement:X,document:u,window:l,Symbol:R,PlacedSymbol:N}));return dt.agent.node&&n(370)(dt),(a="function"==typeof(i=dt)?i.call(e,n,e,t):i)===s||(t.exports=a),dt}).call(this,"object"==typeof self?self:null)},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReactCSS=e.loop=e.handleActive=e.handleHover=e.hover=void 0;var r=u(n(203)),i=u(n(274)),a=u(n(294)),o=u(n(295)),s=u(n(296)),l=u(n(297));function u(t){return t&&t.__esModule?t:{default:t}}e.hover=o.default,e.handleHover=o.default,e.handleActive=s.default,e.loop=l.default;var c=e.ReactCSS=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var s=(0,r.default)(n),l=(0,i.default)(t,s);return(0,a.default)(l)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(298);Object.defineProperty(e,"Alpha",{enumerable:!0,get:function(){return h(r).default}});var i=n(72);Object.defineProperty(e,"Checkboard",{enumerable:!0,get:function(){return h(i).default}});var a=n(301);Object.defineProperty(e,"EditableInput",{enumerable:!0,get:function(){return h(a).default}});var o=n(302);Object.defineProperty(e,"Hue",{enumerable:!0,get:function(){return h(o).default}});var s=n(304);Object.defineProperty(e,"Raised",{enumerable:!0,get:function(){return h(s).default}});var l=n(320);Object.defineProperty(e,"Saturation",{enumerable:!0,get:function(){return h(l).default}});var u=n(141);Object.defineProperty(e,"ColorWrap",{enumerable:!0,get:function(){return h(u).default}});var c=n(328);function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Swatch",{enumerable:!0,get:function(){return h(c).default}})},function(t,e,n){(function(t,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var a="Expected a function",o="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],l="[object Arguments]",u="[object Array]",c="[object Boolean]",h="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",m="[object Map]",g="[object Number]",v="[object Object]",y="[object RegExp]",b="[object Set]",x="[object String]",_="[object Symbol]",w="[object WeakMap]",S="[object ArrayBuffer]",E="[object DataView]",M="[object Float32Array]",C="[object Float64Array]",T="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",A="[object Uint8Array]",O="[object Uint16Array]",N="[object Uint32Array]",R=/\b__p \+= '';/g,L=/\b(__p \+=) '' \+/g,I=/(__e\(.*?\)|\b__t\)) \+\n'';/g,D=/&(?:amp|lt|gt|quot|#39);/g,z=/[&<>"']/g,F=RegExp(D.source),B=RegExp(z.source),V=/<%-([\s\S]+?)%>/g,j=/<%([\s\S]+?)%>/g,H=/<%=([\s\S]+?)%>/g,U=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W=/[\\^$.*+?()[\]{}|]/g,$=RegExp(W.source),Y=/^\s+|\s+$/g,Q=/^\s+/,X=/\s+$/,Z=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,J=/\{\n\/\* \[wrapped with (.+)\] \*/,K=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,it=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,ot=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,lt=/^(?:0|[1-9]\d*)$/,ut=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ct=/($^)/,ht=/['\n\r\u2028\u2029\\]/g,dt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ft="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",mt="["+ft+"]",gt="["+dt+"]",vt="\\d+",yt="[\\u2700-\\u27bf]",bt="[a-z\\xdf-\\xf6\\xf8-\\xff]",xt="[^\\ud800-\\udfff"+ft+vt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_t="\\ud83c[\\udffb-\\udfff]",wt="[^\\ud800-\\udfff]",St="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",Mt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ct="(?:"+bt+"|"+xt+")",Tt="(?:"+Mt+"|"+xt+")",kt="(?:"+gt+"|"+_t+")"+"?",Pt="[\\ufe0e\\ufe0f]?"+kt+("(?:\\u200d(?:"+[wt,St,Et].join("|")+")[\\ufe0e\\ufe0f]?"+kt+")*"),At="(?:"+[yt,St,Et].join("|")+")"+Pt,Ot="(?:"+[wt+gt+"?",gt,St,Et,pt].join("|")+")",Nt=RegExp("[']","g"),Rt=RegExp(gt,"g"),Lt=RegExp(_t+"(?="+_t+")|"+Ot+Pt,"g"),It=RegExp([Mt+"?"+bt+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[mt,Mt,"$"].join("|")+")",Tt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[mt,Mt+Ct,"$"].join("|")+")",Mt+"?"+Ct+"+(?:['](?:d|ll|m|re|s|t|ve))?",Mt+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vt,At].join("|"),"g"),Dt=RegExp("[\\u200d\\ud800-\\udfff"+dt+"\\ufe0e\\ufe0f]"),zt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ft=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bt=-1,Vt={};Vt[M]=Vt[C]=Vt[T]=Vt[k]=Vt[P]=Vt[A]=Vt["[object Uint8ClampedArray]"]=Vt[O]=Vt[N]=!0,Vt[l]=Vt[u]=Vt[S]=Vt[c]=Vt[E]=Vt[h]=Vt[d]=Vt[f]=Vt[m]=Vt[g]=Vt[v]=Vt[y]=Vt[b]=Vt[x]=Vt[w]=!1;var jt={};jt[l]=jt[u]=jt[S]=jt[E]=jt[c]=jt[h]=jt[M]=jt[C]=jt[T]=jt[k]=jt[P]=jt[m]=jt[g]=jt[v]=jt[y]=jt[b]=jt[x]=jt[_]=jt[A]=jt["[object Uint8ClampedArray]"]=jt[O]=jt[N]=!0,jt[d]=jt[f]=jt[w]=!1;var Ht={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ut=parseFloat,Gt=parseInt,qt="object"==typeof t&&t&&t.Object===Object&&t,Wt="object"==typeof self&&self&&self.Object===Object&&self,$t=qt||Wt||Function("return this")(),Yt=e&&!e.nodeType&&e,Qt=Yt&&"object"==typeof r&&r&&!r.nodeType&&r,Xt=Qt&&Qt.exports===Yt,Zt=Xt&&qt.process,Jt=function(){try{var t=Qt&&Qt.require&&Qt.require("util").types;return t||Zt&&Zt.binding&&Zt.binding("util")}catch(t){}}(),Kt=Jt&&Jt.isArrayBuffer,te=Jt&&Jt.isDate,ee=Jt&&Jt.isMap,ne=Jt&&Jt.isRegExp,re=Jt&&Jt.isSet,ie=Jt&&Jt.isTypedArray;function ae(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function oe(t,e,n,r){for(var i=-1,a=null==t?0:t.length;++i<a;){var o=t[i];e(r,o,n(o),t)}return r}function se(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function le(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function ce(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a}function he(t,e){return!!(null==t?0:t.length)&&_e(t,e,0)>-1}function de(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function fe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function me(t,e,n,r){var i=-1,a=null==t?0:t.length;for(r&&a&&(n=t[++i]);++i<a;)n=e(n,t[i],i,t);return n}function ge(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function ve(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ye=Me("length");function be(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function xe(t,e,n,r){for(var i=t.length,a=n+(r?1:-1);r?a--:++a<i;)if(e(t[a],a,t))return a;return-1}function _e(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):xe(t,Se,n)}function we(t,e,n,r){for(var i=n-1,a=t.length;++i<a;)if(r(t[i],e))return i;return-1}function Se(t){return t!=t}function Ee(t,e){var n=null==t?0:t.length;return n?ke(t,e)/n:NaN}function Me(t){return function(e){return null==e?void 0:e[t]}}function Ce(t){return function(e){return null==t?void 0:t[e]}}function Te(t,e,n,r,i){return i(t,(function(t,i,a){n=r?(r=!1,t):e(n,t,i,a)})),n}function ke(t,e){for(var n,r=-1,i=t.length;++r<i;){var a=e(t[r]);void 0!==a&&(n=void 0===n?a:n+a)}return n}function Pe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ae(t){return function(e){return t(e)}}function Oe(t,e){return fe(e,(function(e){return t[e]}))}function Ne(t,e){return t.has(e)}function Re(t,e){for(var n=-1,r=t.length;++n<r&&_e(e,t[n],0)>-1;);return n}function Le(t,e){for(var n=t.length;n--&&_e(e,t[n],0)>-1;);return n}function Ie(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var De=Ce({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),ze=Ce({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Fe(t){return"\\"+Ht[t]}function Be(t){return Dt.test(t)}function Ve(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function je(t,e){return function(n){return t(e(n))}}function He(t,e){for(var n=-1,r=t.length,i=0,a=[];++n<r;){var s=t[n];s!==e&&s!==o||(t[n]=o,a[i++]=n)}return a}function Ue(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Ge(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function qe(t){return Be(t)?function(t){var e=Lt.lastIndex=0;for(;Lt.test(t);)++e;return e}(t):ye(t)}function We(t){return Be(t)?function(t){return t.match(Lt)||[]}(t):function(t){return t.split("")}(t)}var $e=Ce({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ye=function t(e){var n,r=(e=null==e?$t:Ye.defaults($t.Object(),e,Ye.pick($t,Ft))).Array,i=e.Date,dt=e.Error,ft=e.Function,pt=e.Math,mt=e.Object,gt=e.RegExp,vt=e.String,yt=e.TypeError,bt=r.prototype,xt=ft.prototype,_t=mt.prototype,wt=e["__core-js_shared__"],St=xt.toString,Et=_t.hasOwnProperty,Mt=0,Ct=(n=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Tt=_t.toString,kt=St.call(mt),Pt=$t._,At=gt("^"+St.call(Et).replace(W,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=Xt?e.Buffer:void 0,Lt=e.Symbol,Dt=e.Uint8Array,Ht=Ot?Ot.allocUnsafe:void 0,qt=je(mt.getPrototypeOf,mt),Wt=mt.create,Yt=_t.propertyIsEnumerable,Qt=bt.splice,Zt=Lt?Lt.isConcatSpreadable:void 0,Jt=Lt?Lt.iterator:void 0,ye=Lt?Lt.toStringTag:void 0,Ce=function(){try{var t=Ki(mt,"defineProperty");return t({},"",{}),t}catch(t){}}(),Qe=e.clearTimeout!==$t.clearTimeout&&e.clearTimeout,Xe=i&&i.now!==$t.Date.now&&i.now,Ze=e.setTimeout!==$t.setTimeout&&e.setTimeout,Je=pt.ceil,Ke=pt.floor,tn=mt.getOwnPropertySymbols,en=Ot?Ot.isBuffer:void 0,nn=e.isFinite,rn=bt.join,an=je(mt.keys,mt),on=pt.max,sn=pt.min,ln=i.now,un=e.parseInt,cn=pt.random,hn=bt.reverse,dn=Ki(e,"DataView"),fn=Ki(e,"Map"),pn=Ki(e,"Promise"),mn=Ki(e,"Set"),gn=Ki(e,"WeakMap"),vn=Ki(mt,"create"),yn=gn&&new gn,bn={},xn=Ca(dn),_n=Ca(fn),wn=Ca(pn),Sn=Ca(mn),En=Ca(gn),Mn=Lt?Lt.prototype:void 0,Cn=Mn?Mn.valueOf:void 0,Tn=Mn?Mn.toString:void 0;function kn(t){if(Go(t)&&!Ro(t)&&!(t instanceof Nn)){if(t instanceof On)return t;if(Et.call(t,"__wrapped__"))return Ta(t)}return new On(t)}var Pn=function(){function t(){}return function(e){if(!Uo(e))return{};if(Wt)return Wt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function An(){}function On(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Nn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Rn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ln(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function In(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Dn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new In;++e<n;)this.add(t[e])}function zn(t){var e=this.__data__=new Ln(t);this.size=e.size}function Fn(t,e){var n=Ro(t),r=!n&&No(t),i=!n&&!r&&zo(t),a=!n&&!r&&!i&&Jo(t),o=n||r||i||a,s=o?Pe(t.length,vt):[],l=s.length;for(var u in t)!e&&!Et.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||oa(u,l))||s.push(u);return s}function Bn(t){var e=t.length;return e?t[Dr(0,e-1)]:void 0}function Vn(t,e){return Sa(vi(t),Qn(e,0,t.length))}function jn(t){return Sa(vi(t))}function Hn(t,e,n){(void 0!==n&&!Po(t[e],n)||void 0===n&&!(e in t))&&$n(t,e,n)}function Un(t,e,n){var r=t[e];Et.call(t,e)&&Po(r,n)&&(void 0!==n||e in t)||$n(t,e,n)}function Gn(t,e){for(var n=t.length;n--;)if(Po(t[n][0],e))return n;return-1}function qn(t,e,n,r){return tr(t,(function(t,i,a){e(r,t,n(t),a)})),r}function Wn(t,e){return t&&yi(e,xs(e),t)}function $n(t,e,n){"__proto__"==e&&Ce?Ce(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Yn(t,e){for(var n=-1,i=e.length,a=r(i),o=null==t;++n<i;)a[n]=o?void 0:ms(t,e[n]);return a}function Qn(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Xn(t,e,n,r,i,a){var o,s=1&e,u=2&e,d=4&e;if(n&&(o=i?n(t,r,i,a):n(t)),void 0!==o)return o;if(!Uo(t))return t;var w=Ro(t);if(w){if(o=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Et.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!s)return vi(t,o)}else{var R=na(t),L=R==f||R==p;if(zo(t))return hi(t,s);if(R==v||R==l||L&&!i){if(o=u||L?{}:ia(t),!s)return u?function(t,e){return yi(t,ea(t),e)}(t,function(t,e){return t&&yi(e,_s(e),t)}(o,t)):function(t,e){return yi(t,ta(t),e)}(t,Wn(o,t))}else{if(!jt[R])return i?t:{};o=function(t,e,n){var r=t.constructor;switch(e){case S:return di(t);case c:case h:return new r(+t);case E:return function(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case M:case C:case T:case k:case P:case A:case"[object Uint8ClampedArray]":case O:case N:return fi(t,n);case m:return new r;case g:case x:return new r(t);case y:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case b:return new r;case _:return i=t,Cn?mt(Cn.call(i)):{}}var i}(t,R,s)}}a||(a=new zn);var I=a.get(t);if(I)return I;a.set(t,o),Qo(t)?t.forEach((function(r){o.add(Xn(r,e,n,r,t,a))})):qo(t)&&t.forEach((function(r,i){o.set(i,Xn(r,e,n,i,t,a))}));var D=w?void 0:(d?u?Wi:qi:u?_s:xs)(t);return se(D||t,(function(r,i){D&&(r=t[i=r]),Un(o,i,Xn(r,e,n,i,t,a))})),o}function Zn(t,e,n){var r=n.length;if(null==t)return!r;for(t=mt(t);r--;){var i=n[r],a=e[i],o=t[i];if(void 0===o&&!(i in t)||!a(o))return!1}return!0}function Jn(t,e,n){if("function"!=typeof t)throw new yt(a);return ba((function(){t.apply(void 0,n)}),e)}function Kn(t,e,n,r){var i=-1,a=he,o=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=fe(e,Ae(n))),r?(a=de,o=!1):e.length>=200&&(a=Ne,o=!1,e=new Dn(e));t:for(;++i<s;){var c=t[i],h=null==n?c:n(c);if(c=r||0!==c?c:0,o&&h==h){for(var d=u;d--;)if(e[d]===h)continue t;l.push(c)}else a(e,h,r)||l.push(c)}return l}kn.templateSettings={escape:V,evaluate:j,interpolate:H,variable:"",imports:{_:kn}},kn.prototype=An.prototype,kn.prototype.constructor=kn,On.prototype=Pn(An.prototype),On.prototype.constructor=On,Nn.prototype=Pn(An.prototype),Nn.prototype.constructor=Nn,Rn.prototype.clear=function(){this.__data__=vn?vn(null):{},this.size=0},Rn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Rn.prototype.get=function(t){var e=this.__data__;if(vn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Et.call(e,t)?e[t]:void 0},Rn.prototype.has=function(t){var e=this.__data__;return vn?void 0!==e[t]:Et.call(e,t)},Rn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=vn&&void 0===e?"__lodash_hash_undefined__":e,this},Ln.prototype.clear=function(){this.__data__=[],this.size=0},Ln.prototype.delete=function(t){var e=this.__data__,n=Gn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Qt.call(e,n,1),--this.size,!0)},Ln.prototype.get=function(t){var e=this.__data__,n=Gn(e,t);return n<0?void 0:e[n][1]},Ln.prototype.has=function(t){return Gn(this.__data__,t)>-1},Ln.prototype.set=function(t,e){var n=this.__data__,r=Gn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},In.prototype.clear=function(){this.size=0,this.__data__={hash:new Rn,map:new(fn||Ln),string:new Rn}},In.prototype.delete=function(t){var e=Zi(this,t).delete(t);return this.size-=e?1:0,e},In.prototype.get=function(t){return Zi(this,t).get(t)},In.prototype.has=function(t){return Zi(this,t).has(t)},In.prototype.set=function(t,e){var n=Zi(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Dn.prototype.add=Dn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Dn.prototype.has=function(t){return this.__data__.has(t)},zn.prototype.clear=function(){this.__data__=new Ln,this.size=0},zn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},zn.prototype.get=function(t){return this.__data__.get(t)},zn.prototype.has=function(t){return this.__data__.has(t)},zn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ln){var r=n.__data__;if(!fn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new In(r)}return n.set(t,e),this.size=n.size,this};var tr=_i(lr),er=_i(ur,!0);function nr(t,e){var n=!0;return tr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function rr(t,e,n){for(var r=-1,i=t.length;++r<i;){var a=t[r],o=e(a);if(null!=o&&(void 0===s?o==o&&!Zo(o):n(o,s)))var s=o,l=a}return l}function ir(t,e){var n=[];return tr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function ar(t,e,n,r,i){var a=-1,o=t.length;for(n||(n=aa),i||(i=[]);++a<o;){var s=t[a];e>0&&n(s)?e>1?ar(s,e-1,n,r,i):pe(i,s):r||(i[i.length]=s)}return i}var or=wi(),sr=wi(!0);function lr(t,e){return t&&or(t,e,xs)}function ur(t,e){return t&&sr(t,e,xs)}function cr(t,e){return ce(e,(function(e){return Vo(t[e])}))}function hr(t,e){for(var n=0,r=(e=si(e,t)).length;null!=t&&n<r;)t=t[Ma(e[n++])];return n&&n==r?t:void 0}function dr(t,e,n){var r=e(t);return Ro(t)?r:pe(r,n(t))}function fr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ye&&ye in mt(t)?function(t){var e=Et.call(t,ye),n=t[ye];try{t[ye]=void 0;var r=!0}catch(t){}var i=Tt.call(t);r&&(e?t[ye]=n:delete t[ye]);return i}(t):function(t){return Tt.call(t)}(t)}function pr(t,e){return t>e}function mr(t,e){return null!=t&&Et.call(t,e)}function gr(t,e){return null!=t&&e in mt(t)}function vr(t,e,n){for(var i=n?de:he,a=t[0].length,o=t.length,s=o,l=r(o),u=1/0,c=[];s--;){var h=t[s];s&&e&&(h=fe(h,Ae(e))),u=sn(h.length,u),l[s]=!n&&(e||a>=120&&h.length>=120)?new Dn(s&&h):void 0}h=t[0];var d=-1,f=l[0];t:for(;++d<a&&c.length<u;){var p=h[d],m=e?e(p):p;if(p=n||0!==p?p:0,!(f?Ne(f,m):i(c,m,n))){for(s=o;--s;){var g=l[s];if(!(g?Ne(g,m):i(t[s],m,n)))continue t}f&&f.push(m),c.push(p)}}return c}function yr(t,e,n){var r=null==(t=ma(t,e=si(e,t)))?t:t[Ma(Fa(e))];return null==r?void 0:ae(r,t,n)}function br(t){return Go(t)&&fr(t)==l}function xr(t,e,n,r,i){return t===e||(null==t||null==e||!Go(t)&&!Go(e)?t!=t&&e!=e:function(t,e,n,r,i,a){var o=Ro(t),s=Ro(e),f=o?u:na(t),p=s?u:na(e),w=(f=f==l?v:f)==v,M=(p=p==l?v:p)==v,C=f==p;if(C&&zo(t)){if(!zo(e))return!1;o=!0,w=!1}if(C&&!w)return a||(a=new zn),o||Jo(t)?Ui(t,e,n,r,i,a):function(t,e,n,r,i,a,o){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case S:return!(t.byteLength!=e.byteLength||!a(new Dt(t),new Dt(e)));case c:case h:case g:return Po(+t,+e);case d:return t.name==e.name&&t.message==e.message;case y:case x:return t==e+"";case m:var s=Ve;case b:var l=1&r;if(s||(s=Ue),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;r|=2,o.set(t,e);var f=Ui(s(t),s(e),r,i,a,o);return o.delete(t),f;case _:if(Cn)return Cn.call(t)==Cn.call(e)}return!1}(t,e,f,n,r,i,a);if(!(1&n)){var T=w&&Et.call(t,"__wrapped__"),k=M&&Et.call(e,"__wrapped__");if(T||k){var P=T?t.value():t,A=k?e.value():e;return a||(a=new zn),i(P,A,n,r,a)}}if(!C)return!1;return a||(a=new zn),function(t,e,n,r,i,a){var o=1&n,s=qi(t),l=s.length,u=qi(e).length;if(l!=u&&!o)return!1;var c=l;for(;c--;){var h=s[c];if(!(o?h in e:Et.call(e,h)))return!1}var d=a.get(t),f=a.get(e);if(d&&f)return d==e&&f==t;var p=!0;a.set(t,e),a.set(e,t);var m=o;for(;++c<l;){h=s[c];var g=t[h],v=e[h];if(r)var y=o?r(v,g,h,e,t,a):r(g,v,h,t,e,a);if(!(void 0===y?g===v||i(g,v,n,r,a):y)){p=!1;break}m||(m="constructor"==h)}if(p&&!m){var b=t.constructor,x=e.constructor;b==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(p=!1)}return a.delete(t),a.delete(e),p}(t,e,n,r,i,a)}(t,e,n,r,xr,i))}function _r(t,e,n,r){var i=n.length,a=i,o=!r;if(null==t)return!a;for(t=mt(t);i--;){var s=n[i];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){var l=(s=n[i])[0],u=t[l],c=s[1];if(o&&s[2]){if(void 0===u&&!(l in t))return!1}else{var h=new zn;if(r)var d=r(u,c,l,t,e,h);if(!(void 0===d?xr(c,u,3,r,h):d))return!1}}return!0}function wr(t){return!(!Uo(t)||(e=t,Ct&&Ct in e))&&(Vo(t)?At:ot).test(Ca(t));var e}function Sr(t){return"function"==typeof t?t:null==t?Ws:"object"==typeof t?Ro(t)?Pr(t[0],t[1]):kr(t):el(t)}function Er(t){if(!ha(t))return an(t);var e=[];for(var n in mt(t))Et.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Mr(t){if(!Uo(t))return function(t){var e=[];if(null!=t)for(var n in mt(t))e.push(n);return e}(t);var e=ha(t),n=[];for(var r in t)("constructor"!=r||!e&&Et.call(t,r))&&n.push(r);return n}function Cr(t,e){return t<e}function Tr(t,e){var n=-1,i=Io(t)?r(t.length):[];return tr(t,(function(t,r,a){i[++n]=e(t,r,a)})),i}function kr(t){var e=Ji(t);return 1==e.length&&e[0][2]?fa(e[0][0],e[0][1]):function(n){return n===t||_r(n,t,e)}}function Pr(t,e){return la(t)&&da(e)?fa(Ma(t),e):function(n){var r=ms(n,t);return void 0===r&&r===e?gs(n,t):xr(e,r,3)}}function Ar(t,e,n,r,i){t!==e&&or(e,(function(a,o){if(i||(i=new zn),Uo(a))!function(t,e,n,r,i,a,o){var s=va(t,n),l=va(e,n),u=o.get(l);if(u)return void Hn(t,n,u);var c=a?a(s,l,n+"",t,e,o):void 0,h=void 0===c;if(h){var d=Ro(l),f=!d&&zo(l),p=!d&&!f&&Jo(l);c=l,d||f||p?Ro(s)?c=s:Do(s)?c=vi(s):f?(h=!1,c=hi(l,!0)):p?(h=!1,c=fi(l,!0)):c=[]:$o(l)||No(l)?(c=s,No(s)?c=os(s):Uo(s)&&!Vo(s)||(c=ia(l))):h=!1}h&&(o.set(l,c),i(c,l,r,a,o),o.delete(l));Hn(t,n,c)}(t,e,o,n,Ar,r,i);else{var s=r?r(va(t,o),a,o+"",t,e,i):void 0;void 0===s&&(s=a),Hn(t,o,s)}}),_s)}function Or(t,e){var n=t.length;if(n)return oa(e+=e<0?n:0,n)?t[e]:void 0}function Nr(t,e,n){e=e.length?fe(e,(function(t){return Ro(t)?function(e){return hr(e,1===t.length?t[0]:t)}:t})):[Ws];var r=-1;return e=fe(e,Ae(Xi())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Tr(t,(function(t,n,i){return{criteria:fe(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,a=e.criteria,o=i.length,s=n.length;for(;++r<o;){var l=pi(i[r],a[r]);if(l){if(r>=s)return l;var u=n[r];return l*("desc"==u?-1:1)}}return t.index-e.index}(t,e,n)}))}function Rr(t,e,n){for(var r=-1,i=e.length,a={};++r<i;){var o=e[r],s=hr(t,o);n(s,o)&&jr(a,si(o,t),s)}return a}function Lr(t,e,n,r){var i=r?we:_e,a=-1,o=e.length,s=t;for(t===e&&(e=vi(e)),n&&(s=fe(t,Ae(n)));++a<o;)for(var l=0,u=e[a],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==t&&Qt.call(s,l,1),Qt.call(t,l,1);return t}function Ir(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==a){var a=i;oa(i)?Qt.call(t,i,1):Kr(t,i)}}return t}function Dr(t,e){return t+Ke(cn()*(e-t+1))}function zr(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=Ke(e/2))&&(t+=t)}while(e);return n}function Fr(t,e){return xa(pa(t,e,Ws),t+"")}function Br(t){return Bn(Ps(t))}function Vr(t,e){var n=Ps(t);return Sa(n,Qn(e,0,n.length))}function jr(t,e,n,r){if(!Uo(t))return t;for(var i=-1,a=(e=si(e,t)).length,o=a-1,s=t;null!=s&&++i<a;){var l=Ma(e[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=o){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=Uo(c)?c:oa(e[i+1])?[]:{})}Un(s,l,u),s=s[l]}return t}var Hr=yn?function(t,e){return yn.set(t,e),t}:Ws,Ur=Ce?function(t,e){return Ce(t,"toString",{configurable:!0,enumerable:!1,value:Us(e),writable:!0})}:Ws;function Gr(t){return Sa(Ps(t))}function qr(t,e,n){var i=-1,a=t.length;e<0&&(e=-e>a?0:a+e),(n=n>a?a:n)<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var o=r(a);++i<a;)o[i]=t[i+e];return o}function Wr(t,e){var n;return tr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function $r(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var a=r+i>>>1,o=t[a];null!==o&&!Zo(o)&&(n?o<=e:o<e)?r=a+1:i=a}return i}return Yr(t,e,Ws,n)}function Yr(t,e,n,r){var i=0,a=null==t?0:t.length;if(0===a)return 0;for(var o=(e=n(e))!=e,s=null===e,l=Zo(e),u=void 0===e;i<a;){var c=Ke((i+a)/2),h=n(t[c]),d=void 0!==h,f=null===h,p=h==h,m=Zo(h);if(o)var g=r||p;else g=u?p&&(r||d):s?p&&d&&(r||!f):l?p&&d&&!f&&(r||!m):!f&&!m&&(r?h<=e:h<e);g?i=c+1:a=c}return sn(a,4294967294)}function Qr(t,e){for(var n=-1,r=t.length,i=0,a=[];++n<r;){var o=t[n],s=e?e(o):o;if(!n||!Po(s,l)){var l=s;a[i++]=0===o?0:o}}return a}function Xr(t){return"number"==typeof t?t:Zo(t)?NaN:+t}function Zr(t){if("string"==typeof t)return t;if(Ro(t))return fe(t,Zr)+"";if(Zo(t))return Tn?Tn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Jr(t,e,n){var r=-1,i=he,a=t.length,o=!0,s=[],l=s;if(n)o=!1,i=de;else if(a>=200){var u=e?null:zi(t);if(u)return Ue(u);o=!1,i=Ne,l=new Dn}else l=e?[]:s;t:for(;++r<a;){var c=t[r],h=e?e(c):c;if(c=n||0!==c?c:0,o&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),s.push(c)}else i(l,h,n)||(l!==s&&l.push(h),s.push(c))}return s}function Kr(t,e){return null==(t=ma(t,e=si(e,t)))||delete t[Ma(Fa(e))]}function ti(t,e,n,r){return jr(t,e,n(hr(t,e)),r)}function ei(t,e,n,r){for(var i=t.length,a=r?i:-1;(r?a--:++a<i)&&e(t[a],a,t););return n?qr(t,r?0:a,r?a+1:i):qr(t,r?a+1:0,r?i:a)}function ni(t,e){var n=t;return n instanceof Nn&&(n=n.value()),me(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ri(t,e,n){var i=t.length;if(i<2)return i?Jr(t[0]):[];for(var a=-1,o=r(i);++a<i;)for(var s=t[a],l=-1;++l<i;)l!=a&&(o[a]=Kn(o[a]||s,t[l],e,n));return Jr(ar(o,1),e,n)}function ii(t,e,n){for(var r=-1,i=t.length,a=e.length,o={};++r<i;){var s=r<a?e[r]:void 0;n(o,t[r],s)}return o}function ai(t){return Do(t)?t:[]}function oi(t){return"function"==typeof t?t:Ws}function si(t,e){return Ro(t)?t:la(t,e)?[t]:Ea(ss(t))}var li=Fr;function ui(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:qr(t,e,n)}var ci=Qe||function(t){return $t.clearTimeout(t)};function hi(t,e){if(e)return t.slice();var n=t.length,r=Ht?Ht(n):new t.constructor(n);return t.copy(r),r}function di(t){var e=new t.constructor(t.byteLength);return new Dt(e).set(new Dt(t)),e}function fi(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function pi(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,a=Zo(t),o=void 0!==e,s=null===e,l=e==e,u=Zo(e);if(!s&&!u&&!a&&t>e||a&&o&&l&&!s&&!u||r&&o&&l||!n&&l||!i)return 1;if(!r&&!a&&!u&&t<e||u&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!l)return-1}return 0}function mi(t,e,n,i){for(var a=-1,o=t.length,s=n.length,l=-1,u=e.length,c=on(o-s,0),h=r(u+c),d=!i;++l<u;)h[l]=e[l];for(;++a<s;)(d||a<o)&&(h[n[a]]=t[a]);for(;c--;)h[l++]=t[a++];return h}function gi(t,e,n,i){for(var a=-1,o=t.length,s=-1,l=n.length,u=-1,c=e.length,h=on(o-l,0),d=r(h+c),f=!i;++a<h;)d[a]=t[a];for(var p=a;++u<c;)d[p+u]=e[u];for(;++s<l;)(f||a<o)&&(d[p+n[s]]=t[a++]);return d}function vi(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function yi(t,e,n,r){var i=!n;n||(n={});for(var a=-1,o=e.length;++a<o;){var s=e[a],l=r?r(n[s],t[s],s,n,t):void 0;void 0===l&&(l=t[s]),i?$n(n,s,l):Un(n,s,l)}return n}function bi(t,e){return function(n,r){var i=Ro(n)?oe:qn,a=e?e():{};return i(n,t,Xi(r,2),a)}}function xi(t){return Fr((function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(i--,a):void 0,o&&sa(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),e=mt(e);++r<i;){var s=n[r];s&&t(e,s,r,a)}return e}))}function _i(t,e){return function(n,r){if(null==n)return n;if(!Io(n))return t(n,r);for(var i=n.length,a=e?i:-1,o=mt(n);(e?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function wi(t){return function(e,n,r){for(var i=-1,a=mt(e),o=r(e),s=o.length;s--;){var l=o[t?s:++i];if(!1===n(a[l],l,a))break}return e}}function Si(t){return function(e){var n=Be(e=ss(e))?We(e):void 0,r=n?n[0]:e.charAt(0),i=n?ui(n,1).join(""):e.slice(1);return r[t]()+i}}function Ei(t){return function(e){return me(Vs(Ns(e).replace(Nt,"")),t,"")}}function Mi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Pn(t.prototype),r=t.apply(n,e);return Uo(r)?r:n}}function Ci(t){return function(e,n,r){var i=mt(e);if(!Io(e)){var a=Xi(n,3);e=xs(e),n=function(t){return a(i[t],t,i)}}var o=t(e,n,r);return o>-1?i[a?e[o]:o]:void 0}}function Ti(t){return Gi((function(e){var n=e.length,r=n,i=On.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new yt(a);if(i&&!s&&"wrapper"==Yi(o))var s=new On([],!0)}for(r=s?r:n;++r<n;){var l=Yi(o=e[r]),u="wrapper"==l?$i(o):void 0;s=u&&ua(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[Yi(u[0])].apply(s,u[3]):1==o.length&&ua(o)?s[l]():s.thru(o)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&Ro(r))return s.plant(r).value();for(var i=0,a=n?e[i].apply(this,t):r;++i<n;)a=e[i].call(this,a);return a}}))}function ki(t,e,n,i,a,o,s,l,u,c){var h=128&e,d=1&e,f=2&e,p=24&e,m=512&e,g=f?void 0:Mi(t);return function v(){for(var y=arguments.length,b=r(y),x=y;x--;)b[x]=arguments[x];if(p)var _=Qi(v),w=Ie(b,_);if(i&&(b=mi(b,i,a,p)),o&&(b=gi(b,o,s,p)),y-=w,p&&y<c){var S=He(b,_);return Ii(t,e,ki,v.placeholder,n,b,S,l,u,c-y)}var E=d?n:this,M=f?E[t]:t;return y=b.length,l?b=ga(b,l):m&&y>1&&b.reverse(),h&&u<y&&(b.length=u),this&&this!==$t&&this instanceof v&&(M=g||Mi(M)),M.apply(E,b)}}function Pi(t,e){return function(n,r){return function(t,e,n,r){return lr(t,(function(t,i,a){e(r,n(t),i,a)})),r}(n,t,e(r),{})}}function Ai(t,e){return function(n,r){var i;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Zr(n),r=Zr(r)):(n=Xr(n),r=Xr(r)),i=t(n,r)}return i}}function Oi(t){return Gi((function(e){return e=fe(e,Ae(Xi())),Fr((function(n){var r=this;return t(e,(function(t){return ae(t,r,n)}))}))}))}function Ni(t,e){var n=(e=void 0===e?" ":Zr(e)).length;if(n<2)return n?zr(e,t):e;var r=zr(e,Je(t/qe(e)));return Be(e)?ui(We(r),0,t).join(""):r.slice(0,t)}function Ri(t){return function(e,n,i){return i&&"number"!=typeof i&&sa(e,n,i)&&(n=i=void 0),e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n,i){for(var a=-1,o=on(Je((e-t)/(n||1)),0),s=r(o);o--;)s[i?o:++a]=t,t+=n;return s}(e,n,i=void 0===i?e<n?1:-1:ns(i),t)}}function Li(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=as(e),n=as(n)),t(e,n)}}function Ii(t,e,n,r,i,a,o,s,l,u){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var h=[t,e,i,c?a:void 0,c?o:void 0,c?void 0:a,c?void 0:o,s,l,u],d=n.apply(void 0,h);return ua(t)&&ya(d,h),d.placeholder=r,_a(d,t,e)}function Di(t){var e=pt[t];return function(t,n){if(t=as(t),(n=null==n?0:sn(rs(n),292))&&nn(t)){var r=(ss(t)+"e").split("e");return+((r=(ss(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var zi=mn&&1/Ue(new mn([,-0]))[1]==1/0?function(t){return new mn(t)}:Zs;function Fi(t){return function(e){var n=na(e);return n==m?Ve(e):n==b?Ge(e):function(t,e){return fe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Bi(t,e,n,i,s,l,u,c){var h=2&e;if(!h&&"function"!=typeof t)throw new yt(a);var d=i?i.length:0;if(d||(e&=-97,i=s=void 0),u=void 0===u?u:on(rs(u),0),c=void 0===c?c:rs(c),d-=s?s.length:0,64&e){var f=i,p=s;i=s=void 0}var m=h?void 0:$i(t),g=[t,e,n,i,s,f,p,l,u,c];if(m&&function(t,e){var n=t[1],r=e[1],i=n|r,a=i<131,s=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!a&&!s)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?mi(u,l,e[4]):l,t[4]=u?He(t[3],o):e[4]}(l=e[5])&&(u=t[5],t[5]=u?gi(u,l,e[6]):l,t[6]=u?He(t[5],o):e[6]);(l=e[7])&&(t[7]=l);128&r&&(t[8]=null==t[8]?e[8]:sn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(g,m),t=g[0],e=g[1],n=g[2],i=g[3],s=g[4],!(c=g[9]=void 0===g[9]?h?0:t.length:on(g[9]-d,0))&&24&e&&(e&=-25),e&&1!=e)v=8==e||16==e?function(t,e,n){var i=Mi(t);return function a(){for(var o=arguments.length,s=r(o),l=o,u=Qi(a);l--;)s[l]=arguments[l];var c=o<3&&s[0]!==u&&s[o-1]!==u?[]:He(s,u);if((o-=c.length)<n)return Ii(t,e,ki,a.placeholder,void 0,s,c,void 0,void 0,n-o);var h=this&&this!==$t&&this instanceof a?i:t;return ae(h,this,s)}}(t,e,c):32!=e&&33!=e||s.length?ki.apply(void 0,g):function(t,e,n,i){var a=1&e,o=Mi(t);return function e(){for(var s=-1,l=arguments.length,u=-1,c=i.length,h=r(c+l),d=this&&this!==$t&&this instanceof e?o:t;++u<c;)h[u]=i[u];for(;l--;)h[u++]=arguments[++s];return ae(d,a?n:this,h)}}(t,e,n,i);else var v=function(t,e,n){var r=1&e,i=Mi(t);return function e(){var a=this&&this!==$t&&this instanceof e?i:t;return a.apply(r?n:this,arguments)}}(t,e,n);return _a((m?Hr:ya)(v,g),t,e)}function Vi(t,e,n,r){return void 0===t||Po(t,_t[n])&&!Et.call(r,n)?e:t}function ji(t,e,n,r,i,a){return Uo(t)&&Uo(e)&&(a.set(e,t),Ar(t,e,void 0,ji,a),a.delete(e)),t}function Hi(t){return $o(t)?void 0:t}function Ui(t,e,n,r,i,a){var o=1&n,s=t.length,l=e.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(t),c=a.get(e);if(u&&c)return u==e&&c==t;var h=-1,d=!0,f=2&n?new Dn:void 0;for(a.set(t,e),a.set(e,t);++h<s;){var p=t[h],m=e[h];if(r)var g=o?r(m,p,h,e,t,a):r(p,m,h,t,e,a);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!ve(e,(function(t,e){if(!Ne(f,e)&&(p===t||i(p,t,n,r,a)))return f.push(e)}))){d=!1;break}}else if(p!==m&&!i(p,m,n,r,a)){d=!1;break}}return a.delete(t),a.delete(e),d}function Gi(t){return xa(pa(t,void 0,Ra),t+"")}function qi(t){return dr(t,xs,ta)}function Wi(t){return dr(t,_s,ea)}var $i=yn?function(t){return yn.get(t)}:Zs;function Yi(t){for(var e=t.name+"",n=bn[e],r=Et.call(bn,e)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==t)return i.name}return e}function Qi(t){return(Et.call(kn,"placeholder")?kn:t).placeholder}function Xi(){var t=kn.iteratee||$s;return t=t===$s?Sr:t,arguments.length?t(arguments[0],arguments[1]):t}function Zi(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Ji(t){for(var e=xs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,da(i)]}return e}function Ki(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return wr(n)?n:void 0}var ta=tn?function(t){return null==t?[]:(t=mt(t),ce(tn(t),(function(e){return Yt.call(t,e)})))}:il,ea=tn?function(t){for(var e=[];t;)pe(e,ta(t)),t=qt(t);return e}:il,na=fr;function ra(t,e,n){for(var r=-1,i=(e=si(e,t)).length,a=!1;++r<i;){var o=Ma(e[r]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++r!=i?a:!!(i=null==t?0:t.length)&&Ho(i)&&oa(o,i)&&(Ro(t)||No(t))}function ia(t){return"function"!=typeof t.constructor||ha(t)?{}:Pn(qt(t))}function aa(t){return Ro(t)||No(t)||!!(Zt&&t&&t[Zt])}function oa(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&lt.test(t))&&t>-1&&t%1==0&&t<e}function sa(t,e,n){if(!Uo(n))return!1;var r=typeof e;return!!("number"==r?Io(n)&&oa(e,n.length):"string"==r&&e in n)&&Po(n[e],t)}function la(t,e){if(Ro(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Zo(t))||(G.test(t)||!U.test(t)||null!=e&&t in mt(e))}function ua(t){var e=Yi(t),n=kn[e];if("function"!=typeof n||!(e in Nn.prototype))return!1;if(t===n)return!0;var r=$i(n);return!!r&&t===r[0]}(dn&&na(new dn(new ArrayBuffer(1)))!=E||fn&&na(new fn)!=m||pn&&"[object Promise]"!=na(pn.resolve())||mn&&na(new mn)!=b||gn&&na(new gn)!=w)&&(na=function(t){var e=fr(t),n=e==v?t.constructor:void 0,r=n?Ca(n):"";if(r)switch(r){case xn:return E;case _n:return m;case wn:return"[object Promise]";case Sn:return b;case En:return w}return e});var ca=wt?Vo:al;function ha(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_t)}function da(t){return t==t&&!Uo(t)}function fa(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in mt(n)))}}function pa(t,e,n){return e=on(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,o=on(i.length-e,0),s=r(o);++a<o;)s[a]=i[e+a];a=-1;for(var l=r(e+1);++a<e;)l[a]=i[a];return l[e]=n(s),ae(t,this,l)}}function ma(t,e){return e.length<2?t:hr(t,qr(e,0,-1))}function ga(t,e){for(var n=t.length,r=sn(e.length,n),i=vi(t);r--;){var a=e[r];t[r]=oa(a,n)?i[a]:void 0}return t}function va(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ya=wa(Hr),ba=Ze||function(t,e){return $t.setTimeout(t,e)},xa=wa(Ur);function _a(t,e,n){var r=e+"";return xa(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Z,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return se(s,(function(n){var r="_."+n[0];e&n[1]&&!he(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(J);return e?e[1].split(K):[]}(r),n)))}function wa(t){var e=0,n=0;return function(){var r=ln(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Sa(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var a=Dr(n,i),o=t[a];t[a]=t[n],t[n]=o}return t.length=e,t}var Ea=function(t){var e=So(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(q,(function(t,n,r,i){e.push(r?i.replace(et,"$1"):n||t)})),e}));function Ma(t){if("string"==typeof t||Zo(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ca(t){if(null!=t){try{return St.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ta(t){if(t instanceof Nn)return t.clone();var e=new On(t.__wrapped__,t.__chain__);return e.__actions__=vi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var ka=Fr((function(t,e){return Do(t)?Kn(t,ar(e,1,Do,!0)):[]})),Pa=Fr((function(t,e){var n=Fa(e);return Do(n)&&(n=void 0),Do(t)?Kn(t,ar(e,1,Do,!0),Xi(n,2)):[]})),Aa=Fr((function(t,e){var n=Fa(e);return Do(n)&&(n=void 0),Do(t)?Kn(t,ar(e,1,Do,!0),void 0,n):[]}));function Oa(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=on(r+i,0)),xe(t,Xi(e,3),i)}function Na(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=rs(n),i=n<0?on(r+i,0):sn(i,r-1)),xe(t,Xi(e,3),i,!0)}function Ra(t){return(null==t?0:t.length)?ar(t,1):[]}function La(t){return t&&t.length?t[0]:void 0}var Ia=Fr((function(t){var e=fe(t,ai);return e.length&&e[0]===t[0]?vr(e):[]})),Da=Fr((function(t){var e=Fa(t),n=fe(t,ai);return e===Fa(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?vr(n,Xi(e,2)):[]})),za=Fr((function(t){var e=Fa(t),n=fe(t,ai);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?vr(n,void 0,e):[]}));function Fa(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Ba=Fr(Va);function Va(t,e){return t&&t.length&&e&&e.length?Lr(t,e):t}var ja=Gi((function(t,e){var n=null==t?0:t.length,r=Yn(t,e);return Ir(t,fe(e,(function(t){return oa(t,n)?+t:t})).sort(pi)),r}));function Ha(t){return null==t?t:hn.call(t)}var Ua=Fr((function(t){return Jr(ar(t,1,Do,!0))})),Ga=Fr((function(t){var e=Fa(t);return Do(e)&&(e=void 0),Jr(ar(t,1,Do,!0),Xi(e,2))})),qa=Fr((function(t){var e=Fa(t);return e="function"==typeof e?e:void 0,Jr(ar(t,1,Do,!0),void 0,e)}));function Wa(t){if(!t||!t.length)return[];var e=0;return t=ce(t,(function(t){if(Do(t))return e=on(t.length,e),!0})),Pe(e,(function(e){return fe(t,Me(e))}))}function $a(t,e){if(!t||!t.length)return[];var n=Wa(t);return null==e?n:fe(n,(function(t){return ae(e,void 0,t)}))}var Ya=Fr((function(t,e){return Do(t)?Kn(t,e):[]})),Qa=Fr((function(t){return ri(ce(t,Do))})),Xa=Fr((function(t){var e=Fa(t);return Do(e)&&(e=void 0),ri(ce(t,Do),Xi(e,2))})),Za=Fr((function(t){var e=Fa(t);return e="function"==typeof e?e:void 0,ri(ce(t,Do),void 0,e)})),Ja=Fr(Wa);var Ka=Fr((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,$a(t,n)}));function to(t){var e=kn(t);return e.__chain__=!0,e}function eo(t,e){return e(t)}var no=Gi((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Yn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Nn&&oa(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:eo,args:[i],thisArg:void 0}),new On(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(i)}));var ro=bi((function(t,e,n){Et.call(t,n)?++t[n]:$n(t,n,1)}));var io=Ci(Oa),ao=Ci(Na);function oo(t,e){return(Ro(t)?se:tr)(t,Xi(e,3))}function so(t,e){return(Ro(t)?le:er)(t,Xi(e,3))}var lo=bi((function(t,e,n){Et.call(t,n)?t[n].push(e):$n(t,n,[e])}));var uo=Fr((function(t,e,n){var i=-1,a="function"==typeof e,o=Io(t)?r(t.length):[];return tr(t,(function(t){o[++i]=a?ae(e,t,n):yr(t,e,n)})),o})),co=bi((function(t,e,n){$n(t,n,e)}));function ho(t,e){return(Ro(t)?fe:Tr)(t,Xi(e,3))}var fo=bi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var po=Fr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&sa(t,e[0],e[1])?e=[]:n>2&&sa(e[0],e[1],e[2])&&(e=[e[0]]),Nr(t,ar(e,1),[])})),mo=Xe||function(){return $t.Date.now()};function go(t,e,n){return e=n?void 0:e,Bi(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function vo(t,e){var n;if("function"!=typeof e)throw new yt(a);return t=rs(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var yo=Fr((function(t,e,n){var r=1;if(n.length){var i=He(n,Qi(yo));r|=32}return Bi(t,r,e,n,i)})),bo=Fr((function(t,e,n){var r=3;if(n.length){var i=He(n,Qi(bo));r|=32}return Bi(e,r,t,n,i)}));function xo(t,e,n){var r,i,o,s,l,u,c=0,h=!1,d=!1,f=!0;if("function"!=typeof t)throw new yt(a);function p(e){var n=r,a=i;return r=i=void 0,c=e,s=t.apply(a,n)}function m(t){return c=t,l=ba(v,e),h?p(t):s}function g(t){var n=t-u;return void 0===u||n>=e||n<0||d&&t-c>=o}function v(){var t=mo();if(g(t))return y(t);l=ba(v,function(t){var n=e-(t-u);return d?sn(n,o-(t-c)):n}(t))}function y(t){return l=void 0,f&&r?p(t):(r=i=void 0,s)}function b(){var t=mo(),n=g(t);if(r=arguments,i=this,u=t,n){if(void 0===l)return m(u);if(d)return ci(l),l=ba(v,e),p(u)}return void 0===l&&(l=ba(v,e)),s}return e=as(e)||0,Uo(n)&&(h=!!n.leading,o=(d="maxWait"in n)?on(as(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),b.cancel=function(){void 0!==l&&ci(l),c=0,r=u=i=l=void 0},b.flush=function(){return void 0===l?s:y(mo())},b}var _o=Fr((function(t,e){return Jn(t,1,e)})),wo=Fr((function(t,e,n){return Jn(t,as(e)||0,n)}));function So(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new yt(a);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(So.Cache||In),n}function Eo(t){if("function"!=typeof t)throw new yt(a);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}So.Cache=In;var Mo=li((function(t,e){var n=(e=1==e.length&&Ro(e[0])?fe(e[0],Ae(Xi())):fe(ar(e,1),Ae(Xi()))).length;return Fr((function(r){for(var i=-1,a=sn(r.length,n);++i<a;)r[i]=e[i].call(this,r[i]);return ae(t,this,r)}))})),Co=Fr((function(t,e){return Bi(t,32,void 0,e,He(e,Qi(Co)))})),To=Fr((function(t,e){return Bi(t,64,void 0,e,He(e,Qi(To)))})),ko=Gi((function(t,e){return Bi(t,256,void 0,void 0,void 0,e)}));function Po(t,e){return t===e||t!=t&&e!=e}var Ao=Li(pr),Oo=Li((function(t,e){return t>=e})),No=br(function(){return arguments}())?br:function(t){return Go(t)&&Et.call(t,"callee")&&!Yt.call(t,"callee")},Ro=r.isArray,Lo=Kt?Ae(Kt):function(t){return Go(t)&&fr(t)==S};function Io(t){return null!=t&&Ho(t.length)&&!Vo(t)}function Do(t){return Go(t)&&Io(t)}var zo=en||al,Fo=te?Ae(te):function(t){return Go(t)&&fr(t)==h};function Bo(t){if(!Go(t))return!1;var e=fr(t);return e==d||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!$o(t)}function Vo(t){if(!Uo(t))return!1;var e=fr(t);return e==f||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function jo(t){return"number"==typeof t&&t==rs(t)}function Ho(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Uo(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Go(t){return null!=t&&"object"==typeof t}var qo=ee?Ae(ee):function(t){return Go(t)&&na(t)==m};function Wo(t){return"number"==typeof t||Go(t)&&fr(t)==g}function $o(t){if(!Go(t)||fr(t)!=v)return!1;var e=qt(t);if(null===e)return!0;var n=Et.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&St.call(n)==kt}var Yo=ne?Ae(ne):function(t){return Go(t)&&fr(t)==y};var Qo=re?Ae(re):function(t){return Go(t)&&na(t)==b};function Xo(t){return"string"==typeof t||!Ro(t)&&Go(t)&&fr(t)==x}function Zo(t){return"symbol"==typeof t||Go(t)&&fr(t)==_}var Jo=ie?Ae(ie):function(t){return Go(t)&&Ho(t.length)&&!!Vt[fr(t)]};var Ko=Li(Cr),ts=Li((function(t,e){return t<=e}));function es(t){if(!t)return[];if(Io(t))return Xo(t)?We(t):vi(t);if(Jt&&t[Jt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Jt]());var e=na(t);return(e==m?Ve:e==b?Ue:Ps)(t)}function ns(t){return t?(t=as(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function rs(t){var e=ns(t),n=e%1;return e==e?n?e-n:e:0}function is(t){return t?Qn(rs(t),0,4294967295):0}function as(t){if("number"==typeof t)return t;if(Zo(t))return NaN;if(Uo(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Uo(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Y,"");var n=at.test(t);return n||st.test(t)?Gt(t.slice(2),n?2:8):it.test(t)?NaN:+t}function os(t){return yi(t,_s(t))}function ss(t){return null==t?"":Zr(t)}var ls=xi((function(t,e){if(ha(e)||Io(e))yi(e,xs(e),t);else for(var n in e)Et.call(e,n)&&Un(t,n,e[n])})),us=xi((function(t,e){yi(e,_s(e),t)})),cs=xi((function(t,e,n,r){yi(e,_s(e),t,r)})),hs=xi((function(t,e,n,r){yi(e,xs(e),t,r)})),ds=Gi(Yn);var fs=Fr((function(t,e){t=mt(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&sa(e[0],e[1],i)&&(r=1);++n<r;)for(var a=e[n],o=_s(a),s=-1,l=o.length;++s<l;){var u=o[s],c=t[u];(void 0===c||Po(c,_t[u])&&!Et.call(t,u))&&(t[u]=a[u])}return t})),ps=Fr((function(t){return t.push(void 0,ji),ae(Ss,void 0,t)}));function ms(t,e,n){var r=null==t?void 0:hr(t,e);return void 0===r?n:r}function gs(t,e){return null!=t&&ra(t,e,gr)}var vs=Pi((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Tt.call(e)),t[e]=n}),Us(Ws)),ys=Pi((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Tt.call(e)),Et.call(t,e)?t[e].push(n):t[e]=[n]}),Xi),bs=Fr(yr);function xs(t){return Io(t)?Fn(t):Er(t)}function _s(t){return Io(t)?Fn(t,!0):Mr(t)}var ws=xi((function(t,e,n){Ar(t,e,n)})),Ss=xi((function(t,e,n,r){Ar(t,e,n,r)})),Es=Gi((function(t,e){var n={};if(null==t)return n;var r=!1;e=fe(e,(function(e){return e=si(e,t),r||(r=e.length>1),e})),yi(t,Wi(t),n),r&&(n=Xn(n,7,Hi));for(var i=e.length;i--;)Kr(n,e[i]);return n}));var Ms=Gi((function(t,e){return null==t?{}:function(t,e){return Rr(t,e,(function(e,n){return gs(t,n)}))}(t,e)}));function Cs(t,e){if(null==t)return{};var n=fe(Wi(t),(function(t){return[t]}));return e=Xi(e),Rr(t,n,(function(t,n){return e(t,n[0])}))}var Ts=Fi(xs),ks=Fi(_s);function Ps(t){return null==t?[]:Oe(t,xs(t))}var As=Ei((function(t,e,n){return e=e.toLowerCase(),t+(n?Os(e):e)}));function Os(t){return Bs(ss(t).toLowerCase())}function Ns(t){return(t=ss(t))&&t.replace(ut,De).replace(Rt,"")}var Rs=Ei((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ls=Ei((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Is=Si("toLowerCase");var Ds=Ei((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var zs=Ei((function(t,e,n){return t+(n?" ":"")+Bs(e)}));var Fs=Ei((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Bs=Si("toUpperCase");function Vs(t,e,n){return t=ss(t),void 0===(e=n?void 0:e)?function(t){return zt.test(t)}(t)?function(t){return t.match(It)||[]}(t):function(t){return t.match(tt)||[]}(t):t.match(e)||[]}var js=Fr((function(t,e){try{return ae(t,void 0,e)}catch(t){return Bo(t)?t:new dt(t)}})),Hs=Gi((function(t,e){return se(e,(function(e){e=Ma(e),$n(t,e,yo(t[e],t))})),t}));function Us(t){return function(){return t}}var Gs=Ti(),qs=Ti(!0);function Ws(t){return t}function $s(t){return Sr("function"==typeof t?t:Xn(t,1))}var Ys=Fr((function(t,e){return function(n){return yr(n,t,e)}})),Qs=Fr((function(t,e){return function(n){return yr(t,n,e)}}));function Xs(t,e,n){var r=xs(e),i=cr(e,r);null!=n||Uo(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=cr(e,xs(e)));var a=!(Uo(n)&&"chain"in n&&!n.chain),o=Vo(t);return se(i,(function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__),i=n.__actions__=vi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,pe([this.value()],arguments))})})),t}function Zs(){}var Js=Oi(fe),Ks=Oi(ue),tl=Oi(ve);function el(t){return la(t)?Me(Ma(t)):function(t){return function(e){return hr(e,t)}}(t)}var nl=Ri(),rl=Ri(!0);function il(){return[]}function al(){return!1}var ol=Ai((function(t,e){return t+e}),0),sl=Di("ceil"),ll=Ai((function(t,e){return t/e}),1),ul=Di("floor");var cl,hl=Ai((function(t,e){return t*e}),1),dl=Di("round"),fl=Ai((function(t,e){return t-e}),0);return kn.after=function(t,e){if("function"!=typeof e)throw new yt(a);return t=rs(t),function(){if(--t<1)return e.apply(this,arguments)}},kn.ary=go,kn.assign=ls,kn.assignIn=us,kn.assignInWith=cs,kn.assignWith=hs,kn.at=ds,kn.before=vo,kn.bind=yo,kn.bindAll=Hs,kn.bindKey=bo,kn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ro(t)?t:[t]},kn.chain=to,kn.chunk=function(t,e,n){e=(n?sa(t,e,n):void 0===e)?1:on(rs(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var a=0,o=0,s=r(Je(i/e));a<i;)s[o++]=qr(t,a,a+=e);return s},kn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var a=t[e];a&&(i[r++]=a)}return i},kn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return pe(Ro(n)?vi(n):[n],ar(e,1))},kn.cond=function(t){var e=null==t?0:t.length,n=Xi();return t=e?fe(t,(function(t){if("function"!=typeof t[1])throw new yt(a);return[n(t[0]),t[1]]})):[],Fr((function(n){for(var r=-1;++r<e;){var i=t[r];if(ae(i[0],this,n))return ae(i[1],this,n)}}))},kn.conforms=function(t){return function(t){var e=xs(t);return function(n){return Zn(n,t,e)}}(Xn(t,1))},kn.constant=Us,kn.countBy=ro,kn.create=function(t,e){var n=Pn(t);return null==e?n:Wn(n,e)},kn.curry=function t(e,n,r){var i=Bi(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},kn.curryRight=function t(e,n,r){var i=Bi(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},kn.debounce=xo,kn.defaults=fs,kn.defaultsDeep=ps,kn.defer=_o,kn.delay=wo,kn.difference=ka,kn.differenceBy=Pa,kn.differenceWith=Aa,kn.drop=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=n||void 0===e?1:rs(e))<0?0:e,r):[]},kn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,0,(e=r-(e=n||void 0===e?1:rs(e)))<0?0:e):[]},kn.dropRightWhile=function(t,e){return t&&t.length?ei(t,Xi(e,3),!0,!0):[]},kn.dropWhile=function(t,e){return t&&t.length?ei(t,Xi(e,3),!0):[]},kn.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&sa(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=rs(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:rs(r))<0&&(r+=i),r=n>r?0:is(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},kn.filter=function(t,e){return(Ro(t)?ce:ir)(t,Xi(e,3))},kn.flatMap=function(t,e){return ar(ho(t,e),1)},kn.flatMapDeep=function(t,e){return ar(ho(t,e),1/0)},kn.flatMapDepth=function(t,e,n){return n=void 0===n?1:rs(n),ar(ho(t,e),n)},kn.flatten=Ra,kn.flattenDeep=function(t){return(null==t?0:t.length)?ar(t,1/0):[]},kn.flattenDepth=function(t,e){return(null==t?0:t.length)?ar(t,e=void 0===e?1:rs(e)):[]},kn.flip=function(t){return Bi(t,512)},kn.flow=Gs,kn.flowRight=qs,kn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},kn.functions=function(t){return null==t?[]:cr(t,xs(t))},kn.functionsIn=function(t){return null==t?[]:cr(t,_s(t))},kn.groupBy=lo,kn.initial=function(t){return(null==t?0:t.length)?qr(t,0,-1):[]},kn.intersection=Ia,kn.intersectionBy=Da,kn.intersectionWith=za,kn.invert=vs,kn.invertBy=ys,kn.invokeMap=uo,kn.iteratee=$s,kn.keyBy=co,kn.keys=xs,kn.keysIn=_s,kn.map=ho,kn.mapKeys=function(t,e){var n={};return e=Xi(e,3),lr(t,(function(t,r,i){$n(n,e(t,r,i),t)})),n},kn.mapValues=function(t,e){var n={};return e=Xi(e,3),lr(t,(function(t,r,i){$n(n,r,e(t,r,i))})),n},kn.matches=function(t){return kr(Xn(t,1))},kn.matchesProperty=function(t,e){return Pr(t,Xn(e,1))},kn.memoize=So,kn.merge=ws,kn.mergeWith=Ss,kn.method=Ys,kn.methodOf=Qs,kn.mixin=Xs,kn.negate=Eo,kn.nthArg=function(t){return t=rs(t),Fr((function(e){return Or(e,t)}))},kn.omit=Es,kn.omitBy=function(t,e){return Cs(t,Eo(Xi(e)))},kn.once=function(t){return vo(2,t)},kn.orderBy=function(t,e,n,r){return null==t?[]:(Ro(e)||(e=null==e?[]:[e]),Ro(n=r?void 0:n)||(n=null==n?[]:[n]),Nr(t,e,n))},kn.over=Js,kn.overArgs=Mo,kn.overEvery=Ks,kn.overSome=tl,kn.partial=Co,kn.partialRight=To,kn.partition=fo,kn.pick=Ms,kn.pickBy=Cs,kn.property=el,kn.propertyOf=function(t){return function(e){return null==t?void 0:hr(t,e)}},kn.pull=Ba,kn.pullAll=Va,kn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Lr(t,e,Xi(n,2)):t},kn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Lr(t,e,void 0,n):t},kn.pullAt=ja,kn.range=nl,kn.rangeRight=rl,kn.rearg=ko,kn.reject=function(t,e){return(Ro(t)?ce:ir)(t,Eo(Xi(e,3)))},kn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],a=t.length;for(e=Xi(e,3);++r<a;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return Ir(t,i),n},kn.rest=function(t,e){if("function"!=typeof t)throw new yt(a);return Fr(t,e=void 0===e?e:rs(e))},kn.reverse=Ha,kn.sampleSize=function(t,e,n){return e=(n?sa(t,e,n):void 0===e)?1:rs(e),(Ro(t)?Vn:Vr)(t,e)},kn.set=function(t,e,n){return null==t?t:jr(t,e,n)},kn.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:jr(t,e,n,r)},kn.shuffle=function(t){return(Ro(t)?jn:Gr)(t)},kn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&sa(t,e,n)?(e=0,n=r):(e=null==e?0:rs(e),n=void 0===n?r:rs(n)),qr(t,e,n)):[]},kn.sortBy=po,kn.sortedUniq=function(t){return t&&t.length?Qr(t):[]},kn.sortedUniqBy=function(t,e){return t&&t.length?Qr(t,Xi(e,2)):[]},kn.split=function(t,e,n){return n&&"number"!=typeof n&&sa(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=ss(t))&&("string"==typeof e||null!=e&&!Yo(e))&&!(e=Zr(e))&&Be(t)?ui(We(t),0,n):t.split(e,n):[]},kn.spread=function(t,e){if("function"!=typeof t)throw new yt(a);return e=null==e?0:on(rs(e),0),Fr((function(n){var r=n[e],i=ui(n,0,e);return r&&pe(i,r),ae(t,this,i)}))},kn.tail=function(t){var e=null==t?0:t.length;return e?qr(t,1,e):[]},kn.take=function(t,e,n){return t&&t.length?qr(t,0,(e=n||void 0===e?1:rs(e))<0?0:e):[]},kn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=r-(e=n||void 0===e?1:rs(e)))<0?0:e,r):[]},kn.takeRightWhile=function(t,e){return t&&t.length?ei(t,Xi(e,3),!1,!0):[]},kn.takeWhile=function(t,e){return t&&t.length?ei(t,Xi(e,3)):[]},kn.tap=function(t,e){return e(t),t},kn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new yt(a);return Uo(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),xo(t,e,{leading:r,maxWait:e,trailing:i})},kn.thru=eo,kn.toArray=es,kn.toPairs=Ts,kn.toPairsIn=ks,kn.toPath=function(t){return Ro(t)?fe(t,Ma):Zo(t)?[t]:vi(Ea(ss(t)))},kn.toPlainObject=os,kn.transform=function(t,e,n){var r=Ro(t),i=r||zo(t)||Jo(t);if(e=Xi(e,4),null==n){var a=t&&t.constructor;n=i?r?new a:[]:Uo(t)&&Vo(a)?Pn(qt(t)):{}}return(i?se:lr)(t,(function(t,r,i){return e(n,t,r,i)})),n},kn.unary=function(t){return go(t,1)},kn.union=Ua,kn.unionBy=Ga,kn.unionWith=qa,kn.uniq=function(t){return t&&t.length?Jr(t):[]},kn.uniqBy=function(t,e){return t&&t.length?Jr(t,Xi(e,2)):[]},kn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Jr(t,void 0,e):[]},kn.unset=function(t,e){return null==t||Kr(t,e)},kn.unzip=Wa,kn.unzipWith=$a,kn.update=function(t,e,n){return null==t?t:ti(t,e,oi(n))},kn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:ti(t,e,oi(n),r)},kn.values=Ps,kn.valuesIn=function(t){return null==t?[]:Oe(t,_s(t))},kn.without=Ya,kn.words=Vs,kn.wrap=function(t,e){return Co(oi(e),t)},kn.xor=Qa,kn.xorBy=Xa,kn.xorWith=Za,kn.zip=Ja,kn.zipObject=function(t,e){return ii(t||[],e||[],Un)},kn.zipObjectDeep=function(t,e){return ii(t||[],e||[],jr)},kn.zipWith=Ka,kn.entries=Ts,kn.entriesIn=ks,kn.extend=us,kn.extendWith=cs,Xs(kn,kn),kn.add=ol,kn.attempt=js,kn.camelCase=As,kn.capitalize=Os,kn.ceil=sl,kn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=as(n))==n?n:0),void 0!==e&&(e=(e=as(e))==e?e:0),Qn(as(t),e,n)},kn.clone=function(t){return Xn(t,4)},kn.cloneDeep=function(t){return Xn(t,5)},kn.cloneDeepWith=function(t,e){return Xn(t,5,e="function"==typeof e?e:void 0)},kn.cloneWith=function(t,e){return Xn(t,4,e="function"==typeof e?e:void 0)},kn.conformsTo=function(t,e){return null==e||Zn(t,e,xs(e))},kn.deburr=Ns,kn.defaultTo=function(t,e){return null==t||t!=t?e:t},kn.divide=ll,kn.endsWith=function(t,e,n){t=ss(t),e=Zr(e);var r=t.length,i=n=void 0===n?r:Qn(rs(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},kn.eq=Po,kn.escape=function(t){return(t=ss(t))&&B.test(t)?t.replace(z,ze):t},kn.escapeRegExp=function(t){return(t=ss(t))&&$.test(t)?t.replace(W,"\\$&"):t},kn.every=function(t,e,n){var r=Ro(t)?ue:nr;return n&&sa(t,e,n)&&(e=void 0),r(t,Xi(e,3))},kn.find=io,kn.findIndex=Oa,kn.findKey=function(t,e){return be(t,Xi(e,3),lr)},kn.findLast=ao,kn.findLastIndex=Na,kn.findLastKey=function(t,e){return be(t,Xi(e,3),ur)},kn.floor=ul,kn.forEach=oo,kn.forEachRight=so,kn.forIn=function(t,e){return null==t?t:or(t,Xi(e,3),_s)},kn.forInRight=function(t,e){return null==t?t:sr(t,Xi(e,3),_s)},kn.forOwn=function(t,e){return t&&lr(t,Xi(e,3))},kn.forOwnRight=function(t,e){return t&&ur(t,Xi(e,3))},kn.get=ms,kn.gt=Ao,kn.gte=Oo,kn.has=function(t,e){return null!=t&&ra(t,e,mr)},kn.hasIn=gs,kn.head=La,kn.identity=Ws,kn.includes=function(t,e,n,r){t=Io(t)?t:Ps(t),n=n&&!r?rs(n):0;var i=t.length;return n<0&&(n=on(i+n,0)),Xo(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&_e(t,e,n)>-1},kn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=on(r+i,0)),_e(t,e,i)},kn.inRange=function(t,e,n){return e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n){return t>=sn(e,n)&&t<on(e,n)}(t=as(t),e,n)},kn.invoke=bs,kn.isArguments=No,kn.isArray=Ro,kn.isArrayBuffer=Lo,kn.isArrayLike=Io,kn.isArrayLikeObject=Do,kn.isBoolean=function(t){return!0===t||!1===t||Go(t)&&fr(t)==c},kn.isBuffer=zo,kn.isDate=Fo,kn.isElement=function(t){return Go(t)&&1===t.nodeType&&!$o(t)},kn.isEmpty=function(t){if(null==t)return!0;if(Io(t)&&(Ro(t)||"string"==typeof t||"function"==typeof t.splice||zo(t)||Jo(t)||No(t)))return!t.length;var e=na(t);if(e==m||e==b)return!t.size;if(ha(t))return!Er(t).length;for(var n in t)if(Et.call(t,n))return!1;return!0},kn.isEqual=function(t,e){return xr(t,e)},kn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?xr(t,e,void 0,n):!!r},kn.isError=Bo,kn.isFinite=function(t){return"number"==typeof t&&nn(t)},kn.isFunction=Vo,kn.isInteger=jo,kn.isLength=Ho,kn.isMap=qo,kn.isMatch=function(t,e){return t===e||_r(t,e,Ji(e))},kn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,_r(t,e,Ji(e),n)},kn.isNaN=function(t){return Wo(t)&&t!=+t},kn.isNative=function(t){if(ca(t))throw new dt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return wr(t)},kn.isNil=function(t){return null==t},kn.isNull=function(t){return null===t},kn.isNumber=Wo,kn.isObject=Uo,kn.isObjectLike=Go,kn.isPlainObject=$o,kn.isRegExp=Yo,kn.isSafeInteger=function(t){return jo(t)&&t>=-9007199254740991&&t<=9007199254740991},kn.isSet=Qo,kn.isString=Xo,kn.isSymbol=Zo,kn.isTypedArray=Jo,kn.isUndefined=function(t){return void 0===t},kn.isWeakMap=function(t){return Go(t)&&na(t)==w},kn.isWeakSet=function(t){return Go(t)&&"[object WeakSet]"==fr(t)},kn.join=function(t,e){return null==t?"":rn.call(t,e)},kn.kebabCase=Rs,kn.last=Fa,kn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=rs(n))<0?on(r+i,0):sn(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):xe(t,Se,i,!0)},kn.lowerCase=Ls,kn.lowerFirst=Is,kn.lt=Ko,kn.lte=ts,kn.max=function(t){return t&&t.length?rr(t,Ws,pr):void 0},kn.maxBy=function(t,e){return t&&t.length?rr(t,Xi(e,2),pr):void 0},kn.mean=function(t){return Ee(t,Ws)},kn.meanBy=function(t,e){return Ee(t,Xi(e,2))},kn.min=function(t){return t&&t.length?rr(t,Ws,Cr):void 0},kn.minBy=function(t,e){return t&&t.length?rr(t,Xi(e,2),Cr):void 0},kn.stubArray=il,kn.stubFalse=al,kn.stubObject=function(){return{}},kn.stubString=function(){return""},kn.stubTrue=function(){return!0},kn.multiply=hl,kn.nth=function(t,e){return t&&t.length?Or(t,rs(e)):void 0},kn.noConflict=function(){return $t._===this&&($t._=Pt),this},kn.noop=Zs,kn.now=mo,kn.pad=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ni(Ke(i),n)+t+Ni(Je(i),n)},kn.padEnd=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;return e&&r<e?t+Ni(e-r,n):t},kn.padStart=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;return e&&r<e?Ni(e-r,n)+t:t},kn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),un(ss(t).replace(Q,""),e||0)},kn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&sa(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ns(t),void 0===e?(e=t,t=0):e=ns(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=cn();return sn(t+i*(e-t+Ut("1e-"+((i+"").length-1))),e)}return Dr(t,e)},kn.reduce=function(t,e,n){var r=Ro(t)?me:Te,i=arguments.length<3;return r(t,Xi(e,4),n,i,tr)},kn.reduceRight=function(t,e,n){var r=Ro(t)?ge:Te,i=arguments.length<3;return r(t,Xi(e,4),n,i,er)},kn.repeat=function(t,e,n){return e=(n?sa(t,e,n):void 0===e)?1:rs(e),zr(ss(t),e)},kn.replace=function(){var t=arguments,e=ss(t[0]);return t.length<3?e:e.replace(t[1],t[2])},kn.result=function(t,e,n){var r=-1,i=(e=si(e,t)).length;for(i||(i=1,t=void 0);++r<i;){var a=null==t?void 0:t[Ma(e[r])];void 0===a&&(r=i,a=n),t=Vo(a)?a.call(t):a}return t},kn.round=dl,kn.runInContext=t,kn.sample=function(t){return(Ro(t)?Bn:Br)(t)},kn.size=function(t){if(null==t)return 0;if(Io(t))return Xo(t)?qe(t):t.length;var e=na(t);return e==m||e==b?t.size:Er(t).length},kn.snakeCase=Ds,kn.some=function(t,e,n){var r=Ro(t)?ve:Wr;return n&&sa(t,e,n)&&(e=void 0),r(t,Xi(e,3))},kn.sortedIndex=function(t,e){return $r(t,e)},kn.sortedIndexBy=function(t,e,n){return Yr(t,e,Xi(n,2))},kn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=$r(t,e);if(r<n&&Po(t[r],e))return r}return-1},kn.sortedLastIndex=function(t,e){return $r(t,e,!0)},kn.sortedLastIndexBy=function(t,e,n){return Yr(t,e,Xi(n,2),!0)},kn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=$r(t,e,!0)-1;if(Po(t[n],e))return n}return-1},kn.startCase=zs,kn.startsWith=function(t,e,n){return t=ss(t),n=null==n?0:Qn(rs(n),0,t.length),e=Zr(e),t.slice(n,n+e.length)==e},kn.subtract=fl,kn.sum=function(t){return t&&t.length?ke(t,Ws):0},kn.sumBy=function(t,e){return t&&t.length?ke(t,Xi(e,2)):0},kn.template=function(t,e,n){var r=kn.templateSettings;n&&sa(t,e,n)&&(e=void 0),t=ss(t),e=cs({},e,r,Vi);var i,a,o=cs({},e.imports,r.imports,Vi),s=xs(o),l=Oe(o,s),u=0,c=e.interpolate||ct,h="__p += '",d=gt((e.escape||ct).source+"|"+c.source+"|"+(c===H?nt:ct).source+"|"+(e.evaluate||ct).source+"|$","g"),f="//# sourceURL="+(Et.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Bt+"]")+"\n";t.replace(d,(function(e,n,r,o,s,l){return r||(r=o),h+=t.slice(u,l).replace(ht,Fe),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),s&&(a=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),h+="';\n";var p=Et.call(e,"variable")&&e.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(a?h.replace(R,""):h).replace(L,"$1").replace(I,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=js((function(){return ft(s,f+"return "+h).apply(void 0,l)}));if(m.source=h,Bo(m))throw m;return m},kn.times=function(t,e){if((t=rs(t))<1||t>9007199254740991)return[];var n=4294967295,r=sn(t,4294967295);t-=4294967295;for(var i=Pe(r,e=Xi(e));++n<t;)e(n);return i},kn.toFinite=ns,kn.toInteger=rs,kn.toLength=is,kn.toLower=function(t){return ss(t).toLowerCase()},kn.toNumber=as,kn.toSafeInteger=function(t){return t?Qn(rs(t),-9007199254740991,9007199254740991):0===t?t:0},kn.toString=ss,kn.toUpper=function(t){return ss(t).toUpperCase()},kn.trim=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Y,"");if(!t||!(e=Zr(e)))return t;var r=We(t),i=We(e);return ui(r,Re(r,i),Le(r,i)+1).join("")},kn.trimEnd=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(X,"");if(!t||!(e=Zr(e)))return t;var r=We(t);return ui(r,0,Le(r,We(e))+1).join("")},kn.trimStart=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Q,"");if(!t||!(e=Zr(e)))return t;var r=We(t);return ui(r,Re(r,We(e))).join("")},kn.truncate=function(t,e){var n=30,r="...";if(Uo(e)){var i="separator"in e?e.separator:i;n="length"in e?rs(e.length):n,r="omission"in e?Zr(e.omission):r}var a=(t=ss(t)).length;if(Be(t)){var o=We(t);a=o.length}if(n>=a)return t;var s=n-qe(r);if(s<1)return r;var l=o?ui(o,0,s).join(""):t.slice(0,s);if(void 0===i)return l+r;if(o&&(s+=l.length-s),Yo(i)){if(t.slice(s).search(i)){var u,c=l;for(i.global||(i=gt(i.source,ss(rt.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var h=u.index;l=l.slice(0,void 0===h?s:h)}}else if(t.indexOf(Zr(i),s)!=s){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r},kn.unescape=function(t){return(t=ss(t))&&F.test(t)?t.replace(D,$e):t},kn.uniqueId=function(t){var e=++Mt;return ss(t)+e},kn.upperCase=Fs,kn.upperFirst=Bs,kn.each=oo,kn.eachRight=so,kn.first=La,Xs(kn,(cl={},lr(kn,(function(t,e){Et.call(kn.prototype,e)||(cl[e]=t)})),cl),{chain:!1}),kn.VERSION="4.17.20",se(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){kn[t].placeholder=kn})),se(["drop","take"],(function(t,e){Nn.prototype[t]=function(n){n=void 0===n?1:on(rs(n),0);var r=this.__filtered__&&!e?new Nn(this):this.clone();return r.__filtered__?r.__takeCount__=sn(n,r.__takeCount__):r.__views__.push({size:sn(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},Nn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),se(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Nn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Xi(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),se(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Nn.prototype[t]=function(){return this[n](1).value()[0]}})),se(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Nn.prototype[t]=function(){return this.__filtered__?new Nn(this):this[n](1)}})),Nn.prototype.compact=function(){return this.filter(Ws)},Nn.prototype.find=function(t){return this.filter(t).head()},Nn.prototype.findLast=function(t){return this.reverse().find(t)},Nn.prototype.invokeMap=Fr((function(t,e){return"function"==typeof t?new Nn(this):this.map((function(n){return yr(n,t,e)}))})),Nn.prototype.reject=function(t){return this.filter(Eo(Xi(t)))},Nn.prototype.slice=function(t,e){t=rs(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Nn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=rs(e))<0?n.dropRight(-e):n.take(e-t)),n)},Nn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Nn.prototype.toArray=function(){return this.take(4294967295)},lr(Nn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=kn[r?"take"+("last"==e?"Right":""):e],a=r||/^find/.test(e);i&&(kn.prototype[e]=function(){var e=this.__wrapped__,o=r?[1]:arguments,s=e instanceof Nn,l=o[0],u=s||Ro(e),c=function(t){var e=i.apply(kn,pe([t],o));return r&&h?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var h=this.__chain__,d=!!this.__actions__.length,f=a&&!h,p=s&&!d;if(!a&&u){e=p?e:new Nn(this);var m=t.apply(e,o);return m.__actions__.push({func:eo,args:[c],thisArg:void 0}),new On(m,h)}return f&&p?t.apply(this,o):(m=this.thru(c),f?r?m.value()[0]:m.value():m)})})),se(["pop","push","shift","sort","splice","unshift"],(function(t){var e=bt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);kn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ro(i)?i:[],t)}return this[n]((function(n){return e.apply(Ro(n)?n:[],t)}))}})),lr(Nn.prototype,(function(t,e){var n=kn[e];if(n){var r=n.name+"";Et.call(bn,r)||(bn[r]=[]),bn[r].push({name:e,func:n})}})),bn[ki(void 0,2).name]=[{name:"wrapper",func:void 0}],Nn.prototype.clone=function(){var t=new Nn(this.__wrapped__);return t.__actions__=vi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=vi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=vi(this.__views__),t},Nn.prototype.reverse=function(){if(this.__filtered__){var t=new Nn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Nn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ro(t),r=e<0,i=n?t.length:0,a=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=sn(e,t+o);break;case"takeRight":t=on(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=a.start,s=a.end,l=s-o,u=r?s:o-1,c=this.__iteratees__,h=c.length,d=0,f=sn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return ni(t,this.__actions__);var p=[];t:for(;l--&&d<f;){for(var m=-1,g=t[u+=e];++m<h;){var v=c[m],y=v.iteratee,b=v.type,x=y(g);if(2==b)g=x;else if(!x){if(1==b)continue t;break t}}p[d++]=g}return p},kn.prototype.at=no,kn.prototype.chain=function(){return to(this)},kn.prototype.commit=function(){return new On(this.value(),this.__chain__)},kn.prototype.next=function(){void 0===this.__values__&&(this.__values__=es(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},kn.prototype.plant=function(t){for(var e,n=this;n instanceof An;){var r=Ta(n);r.__index__=0,r.__values__=void 0,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},kn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Nn){var e=t;return this.__actions__.length&&(e=new Nn(this)),(e=e.reverse()).__actions__.push({func:eo,args:[Ha],thisArg:void 0}),new On(e,this.__chain__)}return this.thru(Ha)},kn.prototype.toJSON=kn.prototype.valueOf=kn.prototype.value=function(){return ni(this.__wrapped__,this.__actions__)},kn.prototype.first=kn.prototype.head,Jt&&(kn.prototype[Jt]=function(){return this}),kn}();$t._=Ye,void 0===(i=function(){return Ye}.call(e,n,e,r))||(r.exports=i)}).call(this)}).call(this,n(109),n(16)(t))},function(t,e,n){var r;
/**
 * @license Complex.js v2.0.11 11/02/2016
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(n){"use strict";var i=function(t){return.5*(Math.exp(t)+Math.exp(-t))},a=function(t){return.5*(Math.exp(t)-Math.exp(-t))},o=function(){throw SyntaxError("Invalid Param")};function s(t,e){var n=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(n):n<3e3&&r<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function l(t,e){if(!(this instanceof l))return new l(t,e);var n=function(t,e){var n={re:0,im:0};if(null==t)n.re=n.im=0;else if(void 0!==e)n.re=t,n.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)n.re=t.re,n.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return l.INFINITY;n.re=t.abs*Math.cos(t.arg),n.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return l.INFINITY;n.re=t.r*Math.cos(t.phi),n.im=t.r*Math.sin(t.phi)}else 2===t.length?(n.re=t[0],n.im=t[1]):o();break;case"string":n.im=n.re=0;var r=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,a=0;null===r&&o();for(var s=0;s<r.length;s++){var u=r[s];" "===u||"\t"===u||"\n"===u||("+"===u?i++:"-"===u?a++:"i"===u||"I"===u?(i+a===0&&o()," "===r[s+1]||isNaN(r[s+1])?n.im+=parseFloat((a%2?"-":"")+"1"):(n.im+=parseFloat((a%2?"-":"")+r[s+1]),s++),i=a=0):((i+a===0||isNaN(u))&&o(),"i"===r[s+1]||"I"===r[s+1]?(n.im+=parseFloat((a%2?"-":"")+u),s++):n.re+=parseFloat((a%2?"-":"")+u),i=a=0))}i+a>0&&o();break;case"number":n.im=0,n.re=t;break;default:o()}return isNaN(n.re)||isNaN(n.im),n}(t,e);this.re=n.re,this.im=n.im}l.prototype={re:0,im:0,sign:function(){var t=this.abs();return new l(this.re/t,this.im/t)},add:function(t,e){var n=new l(t,e);return this.isInfinite()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:new l(this.re+n.re,this.im+n.im)},sub:function(t,e){var n=new l(t,e);return this.isInfinite()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:new l(this.re-n.re,this.im-n.im)},mul:function(t,e){var n=new l(t,e);return this.isInfinite()&&n.isZero()||this.isZero()&&n.isInfinite()?l.NAN:this.isInfinite()||n.isInfinite()?l.INFINITY:0===n.im&&0===this.im?new l(this.re*n.re,0):new l(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(t,e){var n=new l(t,e);if(this.isZero()&&n.isZero()||this.isInfinite()&&n.isInfinite())return l.NAN;if(this.isInfinite()||n.isZero())return l.INFINITY;if(this.isZero()||n.isInfinite())return l.ZERO;t=this.re,e=this.im;var r,i,a=n.re,o=n.im;return 0===o?new l(t/a,e/a):Math.abs(a)<Math.abs(o)?new l((t*(i=a/o)+e)/(r=a*i+o),(e*i-t)/r):new l((t+e*(i=o/a))/(r=o*i+a),(e-t*i)/r)},pow:function(t,e){var n=new l(t,e);if(t=this.re,e=this.im,n.isZero())return l.ONE;if(0===n.im){if(0===e&&t>=0)return new l(Math.pow(t,n.re),0);if(0===t)switch((n.re%4+4)%4){case 0:return new l(Math.pow(e,n.re),0);case 1:return new l(0,Math.pow(e,n.re));case 2:return new l(-Math.pow(e,n.re),0);case 3:return new l(0,-Math.pow(e,n.re))}}if(0===t&&0===e&&n.re>0&&n.im>=0)return l.ZERO;var r=Math.atan2(e,t),i=s(t,e);return t=Math.exp(n.re*i-n.im*r),e=n.im*i+n.re*r,new l(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,n=this.re,r=this.im,i=this.abs();if(n>=0){if(0===r)return new l(Math.sqrt(n),0);t=.5*Math.sqrt(2*(i+n))}else t=Math.abs(r)/Math.sqrt(2*(i-n));return e=n<=0?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new l(t,r<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new l(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new l(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(t<-e||t>e)return Math.cos(t)-1;var n=t*t;return n*(n*(1/24+n*(-1/720+n*(1/40320+n*(-1/3628800+n*(1/4790014600+n*(-1/87178291200+n*(1/20922789888e3)))))))-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new l(s(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,n=Math.abs(t),r=Math.abs(e),n<3e3&&r<3e3?Math.sqrt(n*n+r*r):(n<r?(n=r,r=t/e):r=e/t,n*Math.sqrt(1+r*r));var t,e,n,r},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new l(Math.sin(t)*i(e),Math.cos(t)*a(e))},cos:function(){var t=this.re,e=this.im;return new l(Math.cos(t)*i(e),-Math.sin(t)*a(e))},tan:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)+i(e);return new l(Math.sin(t)/n,a(e)/n)},cot:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)-i(e);return new l(-Math.sin(t)/n,a(e)/n)},sec:function(){var t=this.re,e=this.im,n=.5*i(2*e)+.5*Math.cos(2*t);return new l(Math.cos(t)*i(e)/n,Math.sin(t)*a(e)/n)},csc:function(){var t=this.re,e=this.im,n=.5*i(2*e)-.5*Math.cos(2*t);return new l(Math.sin(t)*i(e)/n,-Math.cos(t)*a(e)/n)},asin:function(){var t=this.re,e=this.im,n=new l(e*e-t*t+1,-2*t*e).sqrt(),r=new l(n.re-e,n.im+t).log();return new l(r.im,-r.re)},acos:function(){var t=this.re,e=this.im,n=new l(e*e-t*t+1,-2*t*e).sqrt(),r=new l(n.re-e,n.im+t).log();return new l(Math.PI/2-r.im,r.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new l(0,1/0);if(-1===e)return new l(0,-1/0)}var n=t*t+(1-e)*(1-e),r=new l((1-e*e-t*t)/n,-2*t/n).log();return new l(-.5*r.im,.5*r.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new l(Math.atan2(1,t),0);var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).atan():new l(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(0,1/0);var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).acos():new l(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(Math.PI/2,1/0);var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).asin():new l(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new l(a(t)*Math.cos(e),i(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new l(i(t)*Math.cos(e),a(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,n=i(t)+Math.cos(e);return new l(a(t)/n,Math.sin(e)/n)},coth:function(){var t=2*this.re,e=2*this.im,n=i(t)-Math.cos(e);return new l(a(t)/n,-Math.sin(e)/n)},csch:function(){var t=this.re,e=this.im,n=Math.cos(2*e)-i(2*t);return new l(-2*a(t)*Math.cos(e)/n,2*i(t)*Math.sin(e)/n)},sech:function(){var t=this.re,e=this.im,n=Math.cos(2*e)+i(2*t);return new l(2*i(t)*Math.cos(e)/n,-2*a(t)*Math.sin(e)/n)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else{e=t.im;t.im=-t.re,t.re=e}return t},atanh:function(){var t=this.re,e=this.im,n=t>1&&0===e,r=1-t,i=1+t,a=r*r+e*e,o=0!==a?new l((i*r-e*e)/a,(e*r+i*e)/a):new l(-1!==t?t/0:0,0!==e?e/0:0),u=o.re;return o.re=s(o.re,o.im)/2,o.im=Math.atan2(o.im,u)/2,n&&(o.im=-o.im),o},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new l(0,Math.PI/2);var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).atanh():new l(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new l(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).asinh():new l(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return l.INFINITY;var n=t*t+e*e;return 0!==n?new l(t/n,-e/n).acosh():new l(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return l.INFINITY;if(this.isInfinite())return l.ZERO;var t=this.re,e=this.im,n=t*t+e*e;return new l(t/n,-e/n)},conjugate:function(){return new l(this.re,-this.im)},neg:function(){return new l(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new l(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new l(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new l(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var n=new l(t,e);return Math.abs(n.re-this.re)<=l.EPSILON&&Math.abs(n.im-this.im)<=l.EPSILON},clone:function(){return new l(this.re,this.im)},toString:function(){var t=this.re,e=this.im,n="";return this.isNaN()?"NaN":this.isZero()?"0":this.isInfinite()?"Infinity":(0!==t&&(n+=t),0!==e&&(0!==t?n+=e<0?" - ":" + ":e<0&&(n+="-"),1!==(e=Math.abs(e))&&(n+=e),n+="i"),n||"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return!(0!==this.re&&-0!==this.re||0!==this.im&&-0!==this.im)},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},l.ZERO=new l(0,0),l.ONE=new l(1,0),l.I=new l(0,1),l.PI=new l(Math.PI,0),l.E=new l(Math.E,0),l.INFINITY=new l(1/0,1/0),l.NAN=new l(NaN,NaN),l.EPSILON=1e-16,void 0===(r=function(){return l}.apply(e,[]))||(t.exports=r)}()},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){t.exports=n(305)()},function(t,e,n){var r=n(307),i=n(311)((function(t,e,n){r(t,e,n)}));t.exports=i},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(n,r){function i(){void 0!==a&&t.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==e&&(a=function(n){t.removeListener(e,i),r(n)},t.once("error",a)),t.once(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,a,o,s;if(u(n),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),o=a[e]),void 0===o)o=a[e]=n,++t._eventsCount;else if("function"==typeof o?o=a[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=c(t))>0&&o.length>i&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,s=l,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):g(i,i.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)a(l,this,e);else{var u=l.length,c=g(l,u);for(n=0;n<u;++n)a(c[n],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,f(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,f(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,i,a,o;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){var r=n(108),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();t.exports=a},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.red=e.getContrastingColor=e.isValidHex=e.toState=e.simpleCheckForValidColor=void 0;var r=a(n(325)),i=a(n(327));function a(t){return t&&t.__esModule?t:{default:t}}e.simpleCheckForValidColor=function(t){var e=0,n=0;return(0,r.default)(["r","g","b","a","h","s","l","v"],(function(r){if(t[r]&&(e+=1,isNaN(t[r])||(n+=1),"s"===r||"l"===r)){/^\d+%$/.test(t[r])&&(n+=1)}})),e===n&&t};var o=e.toState=function(t,e){var n=t.hex?(0,i.default)(t.hex):(0,i.default)(t),r=n.toHsl(),a=n.toHsv(),o=n.toRgb(),s=n.toHex();return 0===r.s&&(r.h=e||0,a.h=e||0),{hsl:r,hex:"000000"===s&&0===o.a?"transparent":"#"+s,rgb:o,hsv:a,oldHue:t.h||e||r.h,source:t.source}};e.isValidHex=function(t){var e="#"===String(t).charAt(0)?1:0;return t.length!==4+e&&t.length<7+e&&(0,i.default)(t).isValid()},e.getContrastingColor=function(t){if(!t)return"#fff";var e=o(t);return"transparent"===e.hex?"rgba(0,0,0,0.4)":(299*e.rgb.r+587*e.rgb.g+114*e.rgb.b)/1e3>=128?"#000":"#fff"},e.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}};e.default=e},function(t,e,n){var r=n(116),i=n(214),a=n(272),o=n(8);t.exports=function(t,e){return(o(t)?r:a)(t,i(e,3))}},function(t,e,n){var r=n(1);r.OrbitControls=function(t,e){var n,i,a,o,s;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new r.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),f=d.NONE},this.update=(n=new r.Vector3,i=(new r.Quaternion).setFromUnitVectors(t.up,new r.Vector3(0,1,0)),a=i.clone().inverse(),o=new r.Vector3,s=new r.Quaternion,function(){var t=l.object.position;return n.copy(t).sub(l.target),n.applyQuaternion(i),m.setFromVector3(n),l.autoRotate&&f===d.NONE&&A(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(m.theta+=g.theta*l.dampingFactor,m.phi+=g.phi*l.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi),m.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=v,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),!0===l.enableDamping?l.target.addScaledVector(y,l.dampingFactor):l.target.add(y),n.setFromSpherical(m),n.applyQuaternion(a),t.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(g.theta*=1-l.dampingFactor,g.phi*=1-l.dampingFactor,y.multiplyScalar(1-l.dampingFactor)):(g.set(0,0,0),y.set(0,0,0)),v=1,!!(b||o.distanceToSquared(l.object.position)>p||8*(1-s.dot(l.object.quaternion))>p)&&(l.dispatchEvent(u),o.copy(l.object.position),s.copy(l.object.quaternion),b=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",tt,!1),l.domElement.removeEventListener("mousedown",W,!1),l.domElement.removeEventListener("wheel",Q,!1),l.domElement.removeEventListener("touchstart",Z,!1),l.domElement.removeEventListener("touchend",K,!1),l.domElement.removeEventListener("touchmove",J,!1),document.removeEventListener("mousemove",$,!1),document.removeEventListener("mouseup",Y,!1),l.domElement.removeEventListener("keydown",X,!1)};var l=this,u={type:"change"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=d.NONE,p=1e-6,m=new r.Spherical,g=new r.Spherical,v=1,y=new r.Vector3,b=!1,x=new r.Vector2,_=new r.Vector2,w=new r.Vector2,S=new r.Vector2,E=new r.Vector2,M=new r.Vector2,C=new r.Vector2,T=new r.Vector2,k=new r.Vector2;function P(){return Math.pow(.95,l.zoomSpeed)}function A(t){g.theta-=t}function O(t){g.phi-=t}var N,R=(N=new r.Vector3,function(t,e){N.setFromMatrixColumn(e,0),N.multiplyScalar(-t),y.add(N)}),L=function(){var t=new r.Vector3;return function(e,n){!0===l.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),y.add(t)}}(),I=function(){var t=new r.Vector3;return function(e,n){var r=l.domElement;if(l.object.isPerspectiveCamera){var i=l.object.position;t.copy(i).sub(l.target);var a=t.length();a*=Math.tan(l.object.fov/2*Math.PI/180),R(2*e*a/r.clientHeight,l.object.matrix),L(2*n*a/r.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(R(e*(l.object.right-l.object.left)/l.object.zoom/r.clientWidth,l.object.matrix),L(n*(l.object.top-l.object.bottom)/l.object.zoom/r.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function D(t){l.object.isPerspectiveCamera?v/=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*t)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function z(t){l.object.isPerspectiveCamera?v*=t:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/t)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function F(t){x.set(t.clientX,t.clientY)}function B(t){S.set(t.clientX,t.clientY)}function V(t){if(1==t.touches.length)x.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);x.set(e,n)}}function j(t){if(1==t.touches.length)S.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);S.set(e,n)}}function H(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);C.set(0,r)}function U(t){if(1==t.touches.length)_.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);_.set(e,n)}w.subVectors(_,x).multiplyScalar(l.rotateSpeed);var r=l.domElement;A(2*Math.PI*w.x/r.clientHeight),O(2*Math.PI*w.y/r.clientHeight),x.copy(_)}function G(t){if(1==t.touches.length)E.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);E.set(e,n)}M.subVectors(E,S).multiplyScalar(l.panSpeed),I(M.x,M.y),S.copy(E)}function q(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);T.set(0,r),k.set(0,Math.pow(T.y/C.y,l.zoomSpeed)),D(k.y),C.copy(T)}function W(t){if(!1!==l.enabled){switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),t.button){case 0:switch(l.mouseButtons.LEFT){case r.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;B(t),f=d.PAN}else{if(!1===l.enableRotate)return;F(t),f=d.ROTATE}break;case r.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;F(t),f=d.ROTATE}else{if(!1===l.enablePan)return;B(t),f=d.PAN}break;default:f=d.NONE}break;case 1:switch(l.mouseButtons.MIDDLE){case r.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(t){C.set(t.clientX,t.clientY)}(t),f=d.DOLLY;break;default:f=d.NONE}break;case 2:switch(l.mouseButtons.RIGHT){case r.MOUSE.ROTATE:if(!1===l.enableRotate)return;F(t),f=d.ROTATE;break;case r.MOUSE.PAN:if(!1===l.enablePan)return;B(t),f=d.PAN;break;default:f=d.NONE}}f!==d.NONE&&(document.addEventListener("mousemove",$,!1),document.addEventListener("mouseup",Y,!1),l.dispatchEvent(c))}}function $(t){if(!1!==l.enabled)switch(t.preventDefault(),f){case d.ROTATE:if(!1===l.enableRotate)return;!function(t){_.set(t.clientX,t.clientY),w.subVectors(_,x).multiplyScalar(l.rotateSpeed);var e=l.domElement;A(2*Math.PI*w.x/e.clientHeight),O(2*Math.PI*w.y/e.clientHeight),x.copy(_),l.update()}(t);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(t){T.set(t.clientX,t.clientY),k.subVectors(T,C),k.y>0?D(P()):k.y<0&&z(P()),C.copy(T),l.update()}(t);break;case d.PAN:if(!1===l.enablePan)return;!function(t){E.set(t.clientX,t.clientY),M.subVectors(E,S).multiplyScalar(l.panSpeed),I(M.x,M.y),S.copy(E),l.update()}(t)}}function Y(t){!1!==l.enabled&&(document.removeEventListener("mousemove",$,!1),document.removeEventListener("mouseup",Y,!1),l.dispatchEvent(h),f=d.NONE)}function Q(t){!1===l.enabled||!1===l.enableZoom||f!==d.NONE&&f!==d.ROTATE||(t.preventDefault(),t.stopPropagation(),l.dispatchEvent(c),function(t){t.deltaY<0?z(P()):t.deltaY>0&&D(P()),l.update()}(t),l.dispatchEvent(h))}function X(t){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(t){var e=!1;switch(t.keyCode){case l.keys.UP:I(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:I(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:I(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:I(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}(t)}function Z(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case r.TOUCH.ROTATE:if(!1===l.enableRotate)return;V(t),f=d.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===l.enablePan)return;j(t),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(l.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&H(t),l.enablePan&&j(t)}(t),f=d.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&H(t),l.enableRotate&&V(t)}(t),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&l.dispatchEvent(c)}}function J(t){if(!1!==l.enabled)switch(t.preventDefault(),t.stopPropagation(),f){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;U(t),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;G(t),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(t){l.enableZoom&&q(t),l.enablePan&&G(t)}(t),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(t){l.enableZoom&&q(t),l.enableRotate&&U(t)}(t),l.update();break;default:f=d.NONE}}function K(t){!1!==l.enabled&&(l.dispatchEvent(h),f=d.NONE)}function tt(t){!1!==l.enabled&&t.preventDefault()}l.domElement.addEventListener("contextmenu",tt,!1),l.domElement.addEventListener("mousedown",W,!1),l.domElement.addEventListener("wheel",Q,!1),l.domElement.addEventListener("touchstart",Z,!1),l.domElement.addEventListener("touchend",K,!1),l.domElement.addEventListener("touchmove",J,!1),l.domElement.addEventListener("keydown",X,!1),-1===l.domElement.tabIndex&&(l.domElement.tabIndex=0),this.update()},r.OrbitControls.prototype=Object.create(r.EventDispatcher.prototype),r.OrbitControls.prototype.constructor=r.OrbitControls,r.MapControls=function(t,e){r.OrbitControls.call(this,t,e),this.mouseButtons.LEFT=r.MOUSE.PAN,this.mouseButtons.RIGHT=r.MOUSE.ROTATE,this.touches.ONE=r.TOUCH.PAN,this.touches.TWO=r.TOUCH.DOLLY_ROTATE},r.MapControls.prototype=Object.create(r.EventDispatcher.prototype),r.MapControls.prototype.constructor=r.MapControls,t.exports=e.default=r.OrbitControls},,function(t,e,n){var r=n(32),i=n(205),a=n(206),o=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?i(t):a(t)}},function(t,e,n){var r=n(227),i=n(230);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e,n){t.exports=function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var n=new t.Vector3,r=new t.Vector3,i=new t.Vector3;return function(a){function o(n){void 0===n&&(n={});var r=n.material;void 0===r&&(r={});var i=n.maxFontSize;void 0===i&&(i=1/0);var o=n.minFontSize;void 0===o&&(o=0);var s=n.redrawInterval;void 0===s&&(s=1);var l=n.textSize;void 0===l&&(l=1);var u=n.texture;void 0===u&&(u={}),a.call(this,new t.SpriteMaterial(Object.assign({},r,{map:new e(u)}))),this.lastRedraw=0,this.maxFontSize=i,this.minFontSize=o,this.redrawInterval=s,this.textSize=l}a&&(o.__proto__=a),o.prototype=Object.create(a&&a.prototype),o.prototype.constructor=o;var s={isTextSprite:{configurable:!0}};return s.isTextSprite.get=function(){return!0},o.prototype.onBeforeRender=function(t,e,n){this.redraw(t,n)},o.prototype.updateScale=function(){this.scale.set(this.material.map.image.width/this.material.map.image.height,1,1).multiplyScalar(this.textSize*this.material.map.height)},o.prototype.updateMatrix=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.updateScale(),a.prototype.updateMatrix.apply(this,t)},o.prototype.redraw=function(t,e){var n=this;this.lastRedraw+this.redrawInterval<Date.now()&&(this.redrawInterval?setTimeout((function(){n.redrawNow(t,e)}),1):this.redrawNow(t,e))},o.prototype.redrawNow=function(e,a){this.updateScale(),this.material.map.fontSize=t.Math.clamp(t.Math.ceilPowerOfTwo(function(e,a,o){if(a.domElement.width&&a.domElement.height&&e.material.map.height){e.getWorldPosition(r),o.getWorldPosition(n);var s=r.distanceTo(n),l=2*Math.tan(t.Math.degToRad(o.fov)/2)*s;if(l){e.getWorldScale(i);var u=i.y*a.domElement.height/l;if(u)return Math.round(u/e.material.map.height)}}return 0}(this,e,a)),this.minFontSize,this.maxFontSize),this.lastRedraw=Date.now()},o.prototype.dispose=function(){this.material.map.dispose(),this.material.dispose()},Object.defineProperties(o.prototype,s),o}(t.Sprite)}(n(1),n(367))},function(t,e,n){var r;
/**
 * @license Fraction.js v4.0.12 09/09/2015
 * http://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(n){"use strict";var i={s:1,n:0,d:1};function a(t){function e(){var e=Error.apply(this,arguments);e.name=this.name=t,this.stack=e.stack,this.message=e.message}function n(){}return n.prototype=Error.prototype,e.prototype=new n,e}var o=d.DivisionByZero=a("DivisionByZero"),s=d.InvalidParameter=a("InvalidParameter");function l(t,e){return isNaN(t=parseInt(t,10))&&u(),t*e}function u(){throw new s}var c=function(t,e){var n,r=0,a=1,s=1,c=0,h=0,d=0,f=1,p=1,m=0,g=1,v=1,y=1,b=1e7;if(null==t);else if(void 0!==e)s=(r=t)*(a=e);else switch(typeof t){case"object":"d"in t&&"n"in t?(r=t.n,a=t.d,"s"in t&&(r*=t.s)):0 in t?(r=t[0],1 in t&&(a=t[1])):u(),s=r*a;break;case"number":if(t<0&&(s=t,t=-t),t%1==0)r=t;else if(t>0){for(t>=1&&(t/=p=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));g<=b&&y<=b;){if(t===(n=(m+v)/(g+y))){g+y<=b?(r=m+v,a=g+y):y>g?(r=v,a=y):(r=m,a=g);break}t>n?(m+=v,g+=y):(v+=m,y+=g),g>b?(r=v,a=y):(r=m,a=g)}r*=p}else(isNaN(t)||isNaN(e))&&(a=r=NaN);break;case"string":if(null===(g=t.match(/\d+|./g))&&u(),"-"===g[m]?(s=-1,m++):"+"===g[m]&&m++,g.length===m+1?h=l(g[m++],s):"."===g[m+1]||"."===g[m]?("."!==g[m]&&(c=l(g[m++],s)),(++m+1===g.length||"("===g[m+1]&&")"===g[m+3]||"'"===g[m+1]&&"'"===g[m+3])&&(h=l(g[m],s),f=Math.pow(10,g[m].length),m++),("("===g[m]&&")"===g[m+2]||"'"===g[m]&&"'"===g[m+2])&&(d=l(g[m+1],s),p=Math.pow(10,g[m+1].length)-1,m+=3)):"/"===g[m+1]||":"===g[m+1]?(h=l(g[m],s),f=l(g[m+2],1),m+=3):"/"===g[m+3]&&" "===g[m+1]&&(c=l(g[m],s),h=l(g[m+2],s),f=l(g[m+4],1),m+=5),g.length<=m){s=r=d+(a=f*p)*c+p*h;break}default:u()}if(0===a)throw new o;i.s=s<0?-1:1,i.n=Math.abs(r),i.d=Math.abs(a)};function h(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function d(t,e){if(!(this instanceof d))return new d(t,e);c(t,e),t=d.REDUCE?h(i.d,i.n):1,this.s=i.s,this.n=i.n/t,this.d=i.d/t}d.REDUCE=1,d.prototype={s:1,n:0,d:1,abs:function(){return new d(this.n,this.d)},neg:function(){return new d(-this.s*this.n,this.d)},add:function(t,e){return c(t,e),new d(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(t,e){return c(t,e),new d(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(t,e){return c(t,e),new d(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(t,e){return c(t,e),new d(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return new d(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new d(NaN):void 0===t?new d(this.s*this.n%this.d,1):(c(t,e),0===i.n&&0===this.d&&d(0,0),new d(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d))},gcd:function(t,e){return c(t,e),new d(h(i.n,this.n)*h(i.d,this.d),i.d*this.d)},lcm:function(t,e){return c(t,e),0===i.n&&0===this.n?new d:new d(i.n*this.n,h(i.n,this.n)*h(i.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):new d(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):new d(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):new d(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new d(this.s*this.d,this.n)},pow:function(t){return t<0?new d(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new d(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return c(t,e),this.s*this.n*i.d==i.s*i.n*this.d},compare:function(t,e){c(t,e);var n=this.s*this.n*i.d-i.s*i.n*this.d;return(0<n)-(n<0)},simplify:function(t){if(isNaN(this.n)||isNaN(this.d))return this;var e=this.abs().toContinued();function n(t){return 1===t.length?new d(t[0]):n(t.slice(1)).inverse().add(t[0])}t=t||.001;for(var r=0;r<e.length;r++){var i=n(e.slice(0,r+1));if(i.sub(this.abs()).abs().valueOf()<t)return i.mul(this.s)}return this},divisible:function(t,e){return c(t,e),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,n+=" ",r%=i),n+=r,n+="/",n+=i),n},toLatex:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,r%=i),n+="\\frac{",n+=r,n+="}{",n+=i,n+="}"),n},toContinued:function(){var t,e=this.n,n=this.d,r=[];if(isNaN(e)||isNaN(n))return r;do{r.push(Math.floor(e/n)),t=e%n,e=n,n=t}while(1!==e);return r},toString:function(t){var e,n=this.n,r=this.d;if(isNaN(n)||isNaN(r))return"NaN";d.REDUCE||(n/=e=h(n,r),r/=e),t=t||15;var i=function(t,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var n=10%e,r=1;1!==n;r++)if(n=10*n%e,r>2e3)return 0;return r}(0,r),a=function(t,e,n){for(var r=1,i=function(t,e,n){for(var r=1;e>0;t=t*t%n,e>>=1)1&e&&(r=r*t%n);return r}(10,n,e),a=0;a<300;a++){if(r===i)return a;r=10*r%e,i=10*i%e}return 0}(0,r,i),o=-1===this.s?"-":"";if(o+=n/r|0,n%=r,(n*=10)&&(o+="."),i){for(var s=a;s--;)o+=n/r|0,n%=r,n*=10;o+="(";for(s=i;s--;)o+=n/r|0,n%=r,n*=10;o+=")"}else for(s=t;n&&s--;)o+=n/r|0,n%=r,n*=10;return o}},void 0===(r=function(){return d}.apply(e,[]))||(t.exports=r)}()},function(t,e){t.exports=function t(e,n){"use strict";var r,i,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,u=/^0/,c=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},h=c(e).replace(o,"")||"",d=c(n).replace(o,"")||"",f=h.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=d.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(h.match(l),16)||1!==f.length&&h.match(s)&&Date.parse(h),g=parseInt(d.match(l),16)||m&&d.match(s)&&Date.parse(d)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var v=0,y=Math.max(f.length,p.length);v<y;v++){if(r=!(f[v]||"").match(u)&&parseFloat(f[v])||f[v]||0,i=!(p[v]||"").match(u)&&parseFloat(p[v])||p[v]||0,isNaN(r)!==isNaN(i))return isNaN(r)?1:-1;if(typeof r!=typeof i&&(r+="",i+=""),r<i)return-1;if(r>i)return 1}return 0}},,function(t,e,n){var r=n(64),i=n(60);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}}(),t.exports=n(197)},function(t,e,n){var r;!function(i){"use strict";var a,o,s,l=9e15,u="0123456789abcdef",c="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",h="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",d={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-l,maxE:l,crypto:!1},f=!0,p="[DecimalError] Invalid argument: ",m=Math.floor,g=Math.pow,v=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,y=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,b=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,x=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_=1e7,w=c.length-1,S=h.length-1,E={name:"[object Decimal]"};function M(t){var e,n,r,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)(n=7-(r=t[e]+"").length)&&(a+=D(n)),a+=r;(n=7-(r=(o=t[e])+"").length)&&(a+=D(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}function C(t,e,n){if(t!==~~t||t<e||t>n)throw Error(p+t)}function T(t,e,n,r){var i,a,o,s;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),a=g(10,7-e),s=t[i]%a|0,null==r?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),o=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):o=(n<4&&s+1==a||n>3&&s+1==a/2)&&(t[i+1]/a/100|0)==g(10,e-2)-1||(s==a/2||0==s)&&0==(t[i+1]/a/100|0):e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),o=(r||n<4)&&9999==s||!r&&n>3&&4999==s):o=((r||n<4)&&s+1==a||!r&&n>3&&s+1==a/2)&&(t[i+1]/a/1e3|0)==g(10,e-3)-1,o}function k(t,e,n){for(var r,i,a=[0],o=0,s=t.length;o<s;){for(i=a.length;i--;)a[i]*=e;for(a[0]+=u.indexOf(t.charAt(o++)),r=0;r<a.length;r++)a[r]>n-1&&(void 0===a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}E.absoluteValue=E.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),A(t)},E.ceil=function(){return A(new this.constructor(this),this.e+1,2)},E.comparedTo=E.cmp=function(t){var e,n,r,i,a=this,o=a.d,s=(t=new a.constructor(t)).d,l=a.s,u=t.s;if(!o||!s)return l&&u?l!==u?l:o===s?0:!o^l<0?1:-1:NaN;if(!o[0]||!s[0])return o[0]?l:s[0]?-u:0;if(l!==u)return l;if(a.e!==t.e)return a.e>t.e^l<0?1:-1;for(e=0,n=(r=o.length)<(i=s.length)?r:i;e<n;++e)if(o[e]!==s[e])return o[e]>s[e]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1},E.cosine=E.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r,i=e.d.length;i<32?(n=Math.ceil(i/3),r=(1/W(4,n)).toString()):(n=16,r="2.3283064365386962890625e-10");t.precision+=n,e=q(t,1,e.times(r),new t(1));for(var a=n;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return t.precision-=n,e}(r,$(r,n)),r.precision=t,r.rounding=e,A(2==s||3==s?n.neg():n,t,e,!0)):new r(1):new r(NaN)},E.cubeRoot=E.cbrt=function(){var t,e,n,r,i,a,o,s,l,u,c=this,h=c.constructor;if(!c.isFinite()||c.isZero())return new h(c);for(f=!1,(a=c.s*g(c.s*c,1/3))&&Math.abs(a)!=1/0?r=new h(a.toString()):(n=M(c.d),(a=((t=c.e)-n.length+1)%3)&&(n+=1==a||-2==a?"0":"00"),a=g(n,1/3),t=m((t+1)/3)-(t%3==(t<0?-1:2)),(r=new h(n=a==1/0?"5e"+t:(n=a.toExponential()).slice(0,n.indexOf("e")+1)+t)).s=c.s),o=(t=h.precision)+3;;)if(u=(l=(s=r).times(s).times(s)).plus(c),r=P(u.plus(c).times(s),u.plus(l),o+2,1),M(s.d).slice(0,o)===(n=M(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(A(r,t+1,1),e=!r.times(r).times(r).eq(c));break}if(!i&&(A(s,t+1,0),s.times(s).times(s).eq(c))){r=s;break}o+=4,i=1}return f=!0,A(r,t,h.rounding,e)},E.decimalPlaces=E.dp=function(){var t,e=this.d,n=NaN;if(e){if(n=7*((t=e.length-1)-m(this.e/7)),t=e[t])for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n},E.dividedBy=E.div=function(t){return P(this,new this.constructor(t))},E.dividedToIntegerBy=E.divToInt=function(t){var e=this.constructor;return A(P(this,new e(t),0,1,1),e.precision,e.rounding)},E.equals=E.eq=function(t){return 0===this.cmp(t)},E.floor=function(){return A(new this.constructor(this),this.e+1,3)},E.greaterThan=E.gt=function(t){return this.cmp(t)>0},E.greaterThanOrEqualTo=E.gte=function(t){var e=this.cmp(t);return 1==e||0===e},E.hyperbolicCosine=E.cosh=function(){var t,e,n,r,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,(i=a.d.length)<32?e=(1/W(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),a=q(o,1,a.times(e),new o(1),!0);for(var l,u=t,c=new o(8);u--;)l=a.times(a),a=s.minus(l.times(c.minus(l.times(c))));return A(a,o.precision=n,o.rounding=r,!0)},E.hyperbolicSine=E.sinh=function(){var t,e,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,n=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,(r=i.d.length)<3)i=q(a,2,i,i,!0);else{t=(t=1.4*Math.sqrt(r))>16?16:0|t,i=q(a,2,i=i.times(1/W(5,t)),i,!0);for(var o,s=new a(5),l=new a(16),u=new a(20);t--;)o=i.times(i),i=i.times(s.plus(o.times(l.times(o).plus(u))))}return a.precision=e,a.rounding=n,A(i,e,n,!0)},E.hyperbolicTangent=E.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,P(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)},E.inverseCosine=E.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,a=n.rounding;return-1!==r?0===r?e.isNeg()?L(n,i,a):new n(0):new n(NaN):e.isZero()?L(n,i+4,a).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=L(n,i+4,a).times(.5),n.precision=i,n.rounding=a,t.minus(e))},E.inverseHyperbolicCosine=E.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,f=!1,n=n.times(n).minus(1).sqrt().plus(n),f=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)},E.inverseHyperbolicSine=E.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,f=!1,n=n.times(n).plus(1).sqrt().plus(n),f=!0,r.precision=t,r.rounding=e,n.ln())},E.inverseHyperbolicTangent=E.atanh=function(){var t,e,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?A(new a(i),t,e,!0):(a.precision=n=r-i.e,i=P(i.plus(1),new a(1).minus(i),n+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5))):new a(NaN)},E.inverseSine=E.asin=function(){var t,e,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),n=a.precision,r=a.rounding,-1!==e?0===e?((t=L(a,n+4,r).times(.5)).s=i.s,t):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))},E.inverseTangent=E.atan=function(){var t,e,n,r,i,a,o,s,l,u=this,c=u.constructor,h=c.precision,d=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&h+4<=S)return(o=L(c,h+4,d).times(.25)).s=u.s,o}else{if(!u.s)return new c(NaN);if(h+4<=S)return(o=L(c,h+4,d).times(.5)).s=u.s,o}for(c.precision=s=h+10,c.rounding=1,t=n=Math.min(28,s/7+2|0);t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(f=!1,e=Math.ceil(s/7),r=1,l=u.times(u),o=new c(u),i=u;-1!==t;)if(i=i.times(l),a=o.minus(i.div(r+=2)),i=i.times(l),void 0!==(o=a.plus(i.div(r+=2))).d[e])for(t=e;o.d[t]===a.d[t]&&t--;);return n&&(o=o.times(2<<n-1)),f=!0,A(o,c.precision=h,c.rounding=d,!0)},E.isFinite=function(){return!!this.d},E.isInteger=E.isInt=function(){return!!this.d&&m(this.e/7)>this.d.length-2},E.isNaN=function(){return!this.s},E.isNegative=E.isNeg=function(){return this.s<0},E.isPositive=E.isPos=function(){return this.s>0},E.isZero=function(){return!!this.d&&0===this.d[0]},E.lessThan=E.lt=function(t){return this.cmp(t)<0},E.lessThanOrEqualTo=E.lte=function(t){return this.cmp(t)<1},E.logarithm=E.log=function(t){var e,n,r,i,a,o,s,l,u=this.constructor,c=u.precision,h=u.rounding;if(null==t)t=new u(10),e=!0;else{if(n=(t=new u(t)).d,t.s<0||!n||!n[0]||t.eq(1))return new u(NaN);e=t.eq(10)}if(n=this.d,this.s<0||!n||!n[0]||this.eq(1))return new u(n&&!n[0]?-1/0:1!=this.s?NaN:n?0:1/0);if(e)if(n.length>1)a=!0;else{for(i=n[0];i%10==0;)i/=10;a=1!==i}if(f=!1,o=j(this,s=c+5),r=e?R(u,s+10):j(t,s),T((l=P(o,r,s,1)).d,i=c,h))do{if(o=j(this,s+=10),r=e?R(u,s+10):j(t,s),l=P(o,r,s,1),!a){+M(l.d).slice(i+1,i+15)+1==1e14&&(l=A(l,c+1,0));break}}while(T(l.d,i+=10,h));return f=!0,A(l,c,h)},E.minus=E.sub=function(t){var e,n,r,i,a,o,s,l,u,c,h,d,p=this,g=p.constructor;if(t=new g(t),!p.d||!t.d)return p.s&&t.s?p.d?t.s=-t.s:t=new g(t.d||p.s!==t.s?p:NaN):t=new g(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(u=p.d,d=t.d,s=g.precision,l=g.rounding,!u[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!u[0])return new g(3===l?-0:0);t=new g(p)}return f?A(t,s,l):t}if(n=m(t.e/7),c=m(p.e/7),u=u.slice(),a=c-n){for((h=a<0)?(e=u,a=-a,o=d.length):(e=d,n=c,o=u.length),a>(r=Math.max(Math.ceil(s/7),o)+2)&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for((h=(r=u.length)<(o=d.length))&&(o=r),r=0;r<o;r++)if(u[r]!=d[r]){h=u[r]<d[r];break}a=0}for(h&&(e=u,u=d,d=e,t.s=-t.s),o=u.length,r=d.length-o;r>0;--r)u[o++]=0;for(r=d.length;r>a;){if(u[--r]<d[r]){for(i=r;i&&0===u[--i];)u[i]=_-1;--u[i],u[r]+=_}u[r]-=d[r]}for(;0===u[--o];)u.pop();for(;0===u[0];u.shift())--n;return u[0]?(t.d=u,t.e=N(u,n),f?A(t,s,l):t):new g(3===l?-0:0)},E.modulo=E.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?A(new r(n),r.precision,r.rounding):(f=!1,9==r.modulo?(e=P(n,t.abs(),0,3,1)).s*=t.s:e=P(n,t,0,r.modulo,1),e=e.times(t),f=!0,n.minus(e))},E.naturalExponential=E.exp=function(){return V(this)},E.naturalLogarithm=E.ln=function(){return j(this)},E.negated=E.neg=function(){var t=new this.constructor(this);return t.s=-t.s,A(t)},E.plus=E.add=function(t){var e,n,r,i,a,o,s,l,u,c,h=this,d=h.constructor;if(t=new d(t),!h.d||!t.d)return h.s&&t.s?h.d||(t=new d(t.d||h.s===t.s?h:NaN)):t=new d(NaN),t;if(h.s!=t.s)return t.s=-t.s,h.minus(t);if(u=h.d,c=t.d,s=d.precision,l=d.rounding,!u[0]||!c[0])return c[0]||(t=new d(h)),f?A(t,s,l):t;if(a=m(h.e/7),r=m(t.e/7),u=u.slice(),i=a-r){for(i<0?(n=u,i=-i,o=c.length):(n=c,r=a,o=u.length),i>(o=(a=Math.ceil(s/7))>o?a+1:o+1)&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((o=u.length)-(i=c.length)<0&&(i=o,n=c,c=u,u=n),e=0;i;)e=(u[--i]=u[i]+c[i]+e)/_|0,u[i]%=_;for(e&&(u.unshift(e),++r),o=u.length;0==u[--o];)u.pop();return t.d=u,t.e=N(u,r),f?A(t,s,l):t},E.precision=E.sd=function(t){var e,n=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(p+t);return n.d?(e=I(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e},E.round=function(){var t=this,e=t.constructor;return A(new e(t),t.e+1,e.rounding)},E.sine=E.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r=e.d.length;if(r<3)return q(t,2,e,e);n=(n=1.4*Math.sqrt(r))>16?16:0|n,e=e.times(1/W(5,n)),e=q(t,2,e,e);for(var i,a=new t(5),o=new t(16),s=new t(20);n--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(s))));return e}(r,$(r,n)),r.precision=t,r.rounding=e,A(s>2?n.neg():n,t,e,!0)):new r(NaN)},E.squareRoot=E.sqrt=function(){var t,e,n,r,i,a,o=this,s=o.d,l=o.e,u=o.s,c=o.constructor;if(1!==u||!s||!s[0])return new c(!u||u<0&&(!s||s[0])?NaN:s?o:1/0);for(f=!1,0==(u=Math.sqrt(+o))||u==1/0?(((e=M(s)).length+l)%2==0&&(e+="0"),u=Math.sqrt(e),l=m((l+1)/2)-(l<0||l%2),r=new c(e=u==1/0?"5e"+l:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+l)):r=new c(u.toString()),n=(l=c.precision)+3;;)if(r=(a=r).plus(P(o,a,n+2,1)).times(.5),M(a.d).slice(0,n)===(e=M(r.d)).slice(0,n)){if("9999"!=(e=e.slice(n-3,n+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(A(r,l+1,1),t=!r.times(r).eq(o));break}if(!i&&(A(a,l+1,0),a.times(a).eq(o))){r=a;break}n+=4,i=1}return f=!0,A(r,l,c.rounding,t)},E.tangent=E.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,(n=n.sin()).s=1,n=P(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,A(2==s||4==s?n.neg():n,t,e,!0)):new r(NaN)},E.times=E.mul=function(t){var e,n,r,i,a,o,s,l,u,c=this,h=c.constructor,d=c.d,p=(t=new h(t)).d;if(t.s*=c.s,!(d&&d[0]&&p&&p[0]))return new h(!t.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:d&&p?0*t.s:t.s/0);for(n=m(c.e/7)+m(t.e/7),(l=d.length)<(u=p.length)&&(a=d,d=p,p=a,o=l,l=u,u=o),a=[],r=o=l+u;r--;)a.push(0);for(r=u;--r>=0;){for(e=0,i=l+r;i>r;)s=a[i]+p[r]*d[i-r-1]+e,a[i--]=s%_|0,e=s/_|0;a[i]=(a[i]+e)%_|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),t.d=a,t.e=N(a,n),f?A(t,h.precision,h.rounding):t},E.toBinary=function(t,e){return Y(this,2,t,e)},E.toDecimalPlaces=E.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),void 0===t?n:(C(t,0,1e9),void 0===e?e=r.rounding:C(e,0,8),A(n,t+n.e+1,e))},E.toExponential=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=O(r,!0):(C(t,0,1e9),void 0===e?e=i.rounding:C(e,0,8),n=O(r=A(new i(r),t+1,e),!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n},E.toFixed=function(t,e){var n,r,i=this,a=i.constructor;return void 0===t?n=O(i):(C(t,0,1e9),void 0===e?e=a.rounding:C(e,0,8),n=O(r=A(new a(i),t+i.e+1,e),!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},E.toFraction=function(t){var e,n,r,i,a,o,s,l,u,c,h,d,m=this,v=m.d,y=m.constructor;if(!v)return new y(m);if(u=n=new y(1),r=l=new y(0),o=(a=(e=new y(r)).e=I(v)-m.e-1)%7,e.d[0]=g(10,o<0?7+o:o),null==t)t=a>0?e:u;else{if(!(s=new y(t)).isInt()||s.lt(u))throw Error(p+s);t=s.gt(e)?a>0?e:u:s}for(f=!1,s=new y(M(v)),c=y.precision,y.precision=a=7*v.length*2;h=P(s,e,0,1,1),1!=(i=n.plus(h.times(r))).cmp(t);)n=r,r=i,i=u,u=l.plus(h.times(i)),l=i,i=e,e=s.minus(h.times(i)),s=i;return i=P(t.minus(n),r,0,1,1),l=l.plus(i.times(u)),n=n.plus(i.times(r)),l.s=u.s=m.s,d=P(u,r,a,1).minus(m).abs().cmp(P(l,n,a,1).minus(m).abs())<1?[u,r]:[l,n],y.precision=c,f=!0,d},E.toHexadecimal=E.toHex=function(t,e){return Y(this,16,t,e)},E.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),null==t){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),void 0===e?e=r.rounding:C(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(f=!1,n=P(n,t,0,e,1).times(t),f=!0,A(n)):(t.s=n.s,n=t),n},E.toNumber=function(){return+this},E.toOctal=function(t,e){return Y(this,8,t,e)},E.toPower=E.pow=function(t){var e,n,r,i,a,o,s=this,l=s.constructor,u=+(t=new l(t));if(!(s.d&&t.d&&s.d[0]&&t.d[0]))return new l(g(+s,u));if((s=new l(s)).eq(1))return s;if(r=l.precision,a=l.rounding,t.eq(1))return A(s,r,a);if((e=m(t.e/7))>=t.d.length-1&&(n=u<0?-u:u)<=9007199254740991)return i=z(l,s,n,r),t.s<0?new l(1).div(i):A(i,r,a);if((o=s.s)<0){if(e<t.d.length-1)return new l(NaN);if(0==(1&t.d[e])&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(e=0!=(n=g(+s,u))&&isFinite(n)?new l(n+"").e:m(u*(Math.log("0."+M(s.d))/Math.LN10+s.e+1)))>l.maxE+1||e<l.minE-1?new l(e>0?o/0:0):(f=!1,l.rounding=s.s=1,n=Math.min(12,(e+"").length),(i=V(t.times(j(s,r+n)),r)).d&&T((i=A(i,r+5,1)).d,r,a)&&(e=r+10,+M((i=A(V(t.times(j(s,e+n)),e),e+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=A(i,r+1,0))),i.s=o,f=!0,l.rounding=a,A(i,r,a))},E.toPrecision=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=O(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(C(t,1,1e9),void 0===e?e=i.rounding:C(e,0,8),n=O(r=A(new i(r),t,e),t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n},E.toSignificantDigits=E.toSD=function(t,e){var n=this.constructor;return void 0===t?(t=n.precision,e=n.rounding):(C(t,1,1e9),void 0===e?e=n.rounding:C(e,0,8)),A(new n(this),t,e)},E.toString=function(){var t=this,e=t.constructor,n=O(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n},E.truncated=E.trunc=function(){return A(new this.constructor(this),this.e+1,1)},E.valueOf=E.toJSON=function(){var t=this,e=t.constructor,n=O(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};var P=function(){function t(t,e,n){var r,i=0,a=t.length;for(t=t.slice();a--;)r=t[a]*e+i,t[a]=r%n|0,i=r/n|0;return i&&t.unshift(i),t}function e(t,e,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(t[i]!=e[i]){a=t[i]>e[i]?1:-1;break}return a}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(r,i,a,s,l,u){var c,h,d,f,p,g,v,y,b,x,w,S,E,M,C,T,k,P,O,N,R=r.constructor,L=r.s==i.s?1:-1,I=r.d,D=i.d;if(!(I&&I[0]&&D&&D[0]))return new R(r.s&&i.s&&(I?!D||I[0]!=D[0]:D)?I&&0==I[0]||!D?0*L:L/0:NaN);for(u?(p=1,h=r.e-i.e):(u=_,p=7,h=m(r.e/p)-m(i.e/p)),O=D.length,k=I.length,x=(b=new R(L)).d=[],d=0;D[d]==(I[d]||0);d++);if(D[d]>(I[d]||0)&&h--,null==a?(M=a=R.precision,s=R.rounding):M=l?a+(r.e-i.e)+1:a,M<0)x.push(1),g=!0;else{if(M=M/p+2|0,d=0,1==O){for(f=0,D=D[0],M++;(d<k||f)&&M--;d++)C=f*u+(I[d]||0),x[d]=C/D|0,f=C%D|0;g=f||d<k}else{for((f=u/(D[0]+1)|0)>1&&(D=t(D,f,u),I=t(I,f,u),O=D.length,k=I.length),T=O,S=(w=I.slice(0,O)).length;S<O;)w[S++]=0;(N=D.slice()).unshift(0),P=D[0],D[1]>=u/2&&++P;do{f=0,(c=e(D,w,O,S))<0?(E=w[0],O!=S&&(E=E*u+(w[1]||0)),(f=E/P|0)>1?(f>=u&&(f=u-1),1==(c=e(v=t(D,f,u),w,y=v.length,S=w.length))&&(f--,n(v,O<y?N:D,y,u))):(0==f&&(c=f=1),v=D.slice()),(y=v.length)<S&&v.unshift(0),n(w,v,S,u),-1==c&&(c=e(D,w,O,S=w.length))<1&&(f++,n(w,O<S?N:D,S,u)),S=w.length):0===c&&(f++,w=[0]),x[d++]=f,c&&w[0]?w[S++]=I[T]||0:(w=[I[T]],S=1)}while((T++<k||void 0!==w[0])&&M--);g=void 0!==w[0]}x[0]||x.shift()}if(1==p)b.e=h,o=g;else{for(d=1,f=x[0];f>=10;f/=10)d++;b.e=d+h*p-1,A(b,l?a+b.e+1:a,s,g)}return b}}();function A(t,e,n,r){var i,a,o,s,l,u,c,h,d,p=t.constructor;t:if(null!=e){if(!(h=t.d))return t;for(i=1,s=h[0];s>=10;s/=10)i++;if((a=e-i)<0)a+=7,o=e,l=(c=h[d=0])/g(10,i-o-1)%10|0;else if((d=Math.ceil((a+1)/7))>=(s=h.length)){if(!r)break t;for(;s++<=d;)h.push(0);c=l=0,i=1,o=(a%=7)-7+1}else{for(c=s=h[d],i=1;s>=10;s/=10)i++;l=(o=(a%=7)-7+i)<0?0:c/g(10,i-o-1)%10|0}if(r=r||e<0||void 0!==h[d+1]||(o<0?c:c%g(10,i-o-1)),u=n<4?(l||r)&&(0==n||n==(t.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(a>0?o>0?c/g(10,i-o):0:h[d-1])%10&1||n==(t.s<0?8:7)),e<1||!h[0])return h.length=0,u?(e-=t.e+1,h[0]=g(10,(7-e%7)%7),t.e=-e||0):h[0]=t.e=0,t;if(0==a?(h.length=d,s=1,d--):(h.length=d+1,s=g(10,7-a),h[d]=o>0?(c/g(10,i-o)%g(10,o)|0)*s:0),u)for(;;){if(0==d){for(a=1,o=h[0];o>=10;o/=10)a++;for(o=h[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(t.e++,h[0]==_&&(h[0]=1));break}if(h[d]+=s,h[d]!=_)break;h[d--]=0,s=1}for(a=h.length;0===h[--a];)h.pop()}return f&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function O(t,e,n){if(!t.isFinite())return H(t);var r,i=t.e,a=M(t.d),o=a.length;return e?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+D(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+D(-i-1)+a,n&&(r=n-o)>0&&(a+=D(r))):i>=o?(a+=D(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+D(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=D(r))),a}function N(t,e){var n=t[0];for(e*=7;n>=10;n/=10)e++;return e}function R(t,e,n){if(e>w)throw f=!0,n&&(t.precision=n),Error("[DecimalError] Precision limit exceeded");return A(new t(c),e,1,!0)}function L(t,e,n){if(e>S)throw Error("[DecimalError] Precision limit exceeded");return A(new t(h),e,n,!0)}function I(t){var e=t.length-1,n=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function D(t){for(var e="";t--;)e+="0";return e}function z(t,e,n,r){var i,a=new t(1),o=Math.ceil(r/7+4);for(f=!1;;){if(n%2&&Q((a=a.times(e)).d,o)&&(i=!0),0===(n=m(n/2))){n=a.d.length-1,i&&0===a.d[n]&&++a.d[n];break}Q((e=e.times(e)).d,o)}return f=!0,a}function F(t){return 1&t.d[t.d.length-1]}function B(t,e,n){for(var r,i=new t(e[0]),a=0;++a<e.length;){if(!(r=new t(e[a])).s){i=r;break}i[n](r)&&(i=r)}return i}function V(t,e){var n,r,i,a,o,s,l,u=0,c=0,h=0,d=t.constructor,p=d.rounding,m=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(f=!1,l=m):l=e,s=new d(.03125);t.e>-2;)t=t.times(s),h+=5;for(l+=r=Math.log(g(2,h))/Math.LN10*2+5|0,n=a=o=new d(1),d.precision=l;;){if(a=A(a.times(t),l,1),n=n.times(++c),M((s=o.plus(P(a,n,l,1))).d).slice(0,l)===M(o.d).slice(0,l)){for(i=h;i--;)o=A(o.times(o),l,1);if(null!=e)return d.precision=m,o;if(!(u<3&&T(o.d,l-r,p,u)))return A(o,d.precision=m,p,f=!0);d.precision=l+=10,n=a=s=new d(1),c=0,u++}o=s}}function j(t,e){var n,r,i,a,o,s,l,u,c,h,d,p=1,m=t,g=m.d,v=m.constructor,y=v.rounding,b=v.precision;if(m.s<0||!g||!g[0]||!m.e&&1==g[0]&&1==g.length)return new v(g&&!g[0]?-1/0:1!=m.s?NaN:g?0:m);if(null==e?(f=!1,c=b):c=e,v.precision=c+=10,r=(n=M(g)).charAt(0),!(Math.abs(a=m.e)<15e14))return u=R(v,c+2,b).times(a+""),m=j(new v(r+"."+n.slice(1)),c-10).plus(u),v.precision=b,null==e?A(m,b,y,f=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=M((m=m.times(t)).d)).charAt(0),p++;for(a=m.e,r>1?(m=new v("0."+n),a++):m=new v(r+"."+n.slice(1)),h=m,l=o=m=P(m.minus(1),m.plus(1),c,1),d=A(m.times(m),c,1),i=3;;){if(o=A(o.times(d),c,1),M((u=l.plus(P(o,new v(i),c,1))).d).slice(0,c)===M(l.d).slice(0,c)){if(l=l.times(2),0!==a&&(l=l.plus(R(v,c+2,b).times(a+""))),l=P(l,new v(p),c,1),null!=e)return v.precision=b,l;if(!T(l.d,c-10,y,s))return A(l,v.precision=b,y,f=!0);v.precision=c+=10,u=o=m=P(h.minus(1),h.plus(1),c,1),d=A(m.times(m),c,1),i=s=1}l=u,i+=2}}function H(t){return String(t.s*t.s/0)}function U(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;48===e.charCodeAt(r);r++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(r,i)){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=7;r<i;)t.d.push(+e.slice(r,r+=7));r=7-(e=e.slice(r)).length}else r-=i;for(;r--;)e+="0";t.d.push(+e),f&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function G(t,e){var n,r,i,o,s,l,u,c,h;if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(y.test(e))n=16,e=e.toLowerCase();else if(v.test(e))n=2;else{if(!b.test(e))throw Error(p+e);n=8}for((o=e.search(/p/i))>0?(u=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),s=(o=e.indexOf("."))>=0,r=t.constructor,s&&(o=(l=(e=e.replace(".","")).length)-o,i=z(r,new r(n),o,2*o)),o=h=(c=k(e,n,_)).length-1;0===c[o];--o)c.pop();return o<0?new r(0*t.s):(t.e=N(c,h),t.d=c,f=!1,s&&(t=P(t,i,4*l)),u&&(t=t.times(Math.abs(u)<54?g(2,u):a.pow(2,u))),f=!0,t)}function q(t,e,n,r,i){var a,o,s,l,u=t.precision,c=Math.ceil(u/7);for(f=!1,l=n.times(n),s=new t(r);;){if(o=P(s.times(l),new t(e++*e++),u,1),s=i?r.plus(o):r.minus(o),r=P(o.times(l),new t(e++*e++),u,1),void 0!==(o=s.plus(r)).d[c]){for(a=c;o.d[a]===s.d[a]&&a--;);if(-1==a)break}a=s,s=r,r=o,o=a}return f=!0,o.d.length=c+1,o}function W(t,e){for(var n=t;--e;)n*=t;return n}function $(t,e){var n,r=e.s<0,i=L(t,t.precision,1),a=i.times(.5);if((e=e.abs()).lte(a))return s=r?4:1,e;if((n=e.divToInt(i)).isZero())s=r?3:2;else{if((e=e.minus(n.times(i))).lte(a))return s=F(n)?r?2:3:r?4:1,e;s=F(n)?r?1:4:r?3:2}return e.minus(i).abs()}function Y(t,e,n,r){var i,a,s,l,c,h,d,f,p,m=t.constructor,g=void 0!==n;if(g?(C(n,1,1e9),void 0===r?r=m.rounding:C(r,0,8)):(n=m.precision,r=m.rounding),t.isFinite()){for(g?(i=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):i=e,(s=(d=O(t)).indexOf("."))>=0&&(d=d.replace(".",""),(p=new m(1)).e=d.length-s,p.d=k(O(p),10,i),p.e=p.d.length),a=c=(f=k(d,10,i)).length;0==f[--c];)f.pop();if(f[0]){if(s<0?a--:((t=new m(t)).d=f,t.e=a,f=(t=P(t,p,n,r,0,i)).d,a=t.e,h=o),s=f[n],l=i/2,h=h||void 0!==f[n+1],h=r<4?(void 0!==s||h)&&(0===r||r===(t.s<0?3:2)):s>l||s===l&&(4===r||h||6===r&&1&f[n-1]||r===(t.s<0?8:7)),f.length=n,h)for(;++f[--n]>i-1;)f[n]=0,n||(++a,f.unshift(1));for(c=f.length;!f[c-1];--c);for(s=0,d="";s<c;s++)d+=u.charAt(f[s]);if(g){if(c>1)if(16==e||8==e){for(s=16==e?4:3,--c;c%s;c++)d+="0";for(c=(f=k(d,i,e)).length;!f[c-1];--c);for(s=1,d="1.";s<c;s++)d+=u.charAt(f[s])}else d=d.charAt(0)+"."+d.slice(1);d=d+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)d="0"+d;d="0."+d}else if(++a>c)for(a-=c;a--;)d+="0";else a<c&&(d=d.slice(0,a)+"."+d.slice(a))}else d=g?"0p+0":"0";d=(16==e?"0x":2==e?"0b":8==e?"0o":"")+d}else d=H(t);return t.s<0?"-"+d:d}function Q(t,e){if(t.length>e)return t.length=e,!0}function X(t){return new this(t).abs()}function Z(t){return new this(t).acos()}function J(t){return new this(t).acosh()}function K(t,e){return new this(t).plus(e)}function tt(t){return new this(t).asin()}function et(t){return new this(t).asinh()}function nt(t){return new this(t).atan()}function rt(t){return new this(t).atanh()}function it(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,a=r+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(n=e.s<0?L(this,r,i):new this(0)).s=t.s:!t.d||e.isZero()?(n=L(this,a,1).times(.5)).s=t.s:e.s<0?(this.precision=a,this.rounding=1,n=this.atan(P(t,e,a,1)),e=L(this,a,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(P(t,e,a,1)):(n=L(this,a,1).times(e.s>0?.25:.75)).s=t.s:n=new this(NaN),n}function at(t){return new this(t).cbrt()}function ot(t){return A(t=new this(t),t.e+1,2)}function st(t){if(!t||"object"!=typeof t)throw Error("[DecimalError] Object expected");var e,n,r,i=!0===t.defaults,a=["precision",1,1e9,"rounding",0,8,"toExpNeg",-l,0,"toExpPos",0,l,"maxE",0,l,"minE",-l,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(n=a[e],i&&(this[n]=d[n]),void 0!==(r=t[n])){if(!(m(r)===r&&r>=a[e+1]&&r<=a[e+2]))throw Error(p+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=d[n]),void 0!==(r=t[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(p+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error("[DecimalError] crypto unavailable");this[n]=!0}else this[n]=!1}return this}function lt(t){return new this(t).cos()}function ut(t){return new this(t).cosh()}function ct(t,e){return new this(t).div(e)}function ht(t){return new this(t).exp()}function dt(t){return A(t=new this(t),t.e+1,3)}function ft(){var t,e,n=new this(0);for(f=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return f=!0,new this(1/0);n=e}return f=!0,n.sqrt()}function pt(t){return t instanceof a||t&&"[object Decimal]"===t.name||!1}function mt(t){return new this(t).ln()}function gt(t,e){return new this(t).log(e)}function vt(t){return new this(t).log(2)}function yt(t){return new this(t).log(10)}function bt(){return B(this,arguments,"lt")}function xt(){return B(this,arguments,"gt")}function _t(t,e){return new this(t).mod(e)}function wt(t,e){return new this(t).mul(e)}function St(t,e){return new this(t).pow(e)}function Et(t){var e,n,r,i,a=0,o=new this(1),s=[];if(void 0===t?t=this.precision:C(t,1,1e9),r=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)(i=e[a])>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else{if(!crypto.randomBytes)throw Error("[DecimalError] crypto unavailable");for(e=crypto.randomBytes(r*=4);a<r;)(i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((127&e[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,a):(s.push(i%1e7),a+=4);a=r/4}else for(;a<r;)s[a++]=1e7*Math.random()|0;for(t%=7,(r=s[--a])&&t&&(i=g(10,7-t),s[a]=(r/i|0)*i);0===s[a];a--)s.pop();if(a<0)n=0,s=[0];else{for(n=-1;0===s[0];n-=7)s.shift();for(r=1,i=s[0];i>=10;i/=10)r++;r<7&&(n-=7-r)}return o.e=n,o.d=s,o}function Mt(t){return A(t=new this(t),t.e+1,this.rounding)}function Ct(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function Tt(t){return new this(t).sin()}function kt(t){return new this(t).sinh()}function Pt(t){return new this(t).sqrt()}function At(t,e){return new this(t).sub(e)}function Ot(t){return new this(t).tan()}function Nt(t){return new this(t).tanh()}function Rt(t){return A(t=new this(t),t.e+1,1)}(a=function t(e){var n,r,i;function a(t){var e,n,r,i=this;if(!(i instanceof a))return new a(t);if(i.constructor=a,t instanceof a)return i.s=t.s,void(f?!t.d||t.e>a.maxE?(i.e=NaN,i.d=null):t.e<a.minE?(i.e=0,i.d=[0]):(i.e=t.e,i.d=t.d.slice()):(i.e=t.e,i.d=t.d?t.d.slice():t.d));if("number"===(r=typeof t)){if(0===t)return i.s=1/t<0?-1:1,i.e=0,void(i.d=[0]);if(t<0?(t=-t,i.s=-1):i.s=1,t===~~t&&t<1e7){for(e=0,n=t;n>=10;n/=10)e++;return void(f?e>a.maxE?(i.e=NaN,i.d=null):e<a.minE?(i.e=0,i.d=[0]):(i.e=e,i.d=[t]):(i.e=e,i.d=[t]))}return 0*t!=0?(t||(i.s=NaN),i.e=NaN,void(i.d=null)):U(i,t.toString())}if("string"!==r)throw Error(p+t);return 45===(n=t.charCodeAt(0))?(t=t.slice(1),i.s=-1):(43===n&&(t=t.slice(1)),i.s=1),x.test(t)?U(i,t):G(i,t)}if(a.prototype=E,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=st,a.clone=t,a.isDecimal=pt,a.abs=X,a.acos=Z,a.acosh=J,a.add=K,a.asin=tt,a.asinh=et,a.atan=nt,a.atanh=rt,a.atan2=it,a.cbrt=at,a.ceil=ot,a.cos=lt,a.cosh=ut,a.div=ct,a.exp=ht,a.floor=dt,a.hypot=ft,a.ln=mt,a.log=gt,a.log10=yt,a.log2=vt,a.max=bt,a.min=xt,a.mod=_t,a.mul=wt,a.pow=St,a.random=Et,a.round=Mt,a.sign=Ct,a.sin=Tt,a.sinh=kt,a.sqrt=Pt,a.sub=At,a.tan=Ot,a.tanh=Nt,a.trunc=Rt,void 0===e&&(e={}),e&&!0!==e.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)e.hasOwnProperty(r=i[n++])||(e[r]=this[r]);return a.config(e),a}(d)).default=a.Decimal=a,c=new a(c),h=new a(h),void 0===(r=function(){return a}.call(e,n,e,t))||(t.exports=r)}()},,function(t,e,n){var r=n(14).Symbol;t.exports=r},function(t,e,n){var r=n(112),i=n(212),a=n(27);t.exports=function(t){return a(t)?r(t):i(t)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(131),i=n(70);t.exports=function(t,e,n,a){var o=!n;n||(n={});for(var s=-1,l=e.length;++s<l;){var u=e[s],c=a?a(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),o?i(n,u,c):r(n,u,c)}return n}},function(t,e,n){var r=n(112),i=n(279),a=n(27);t.exports=function(t){return a(t)?r(t,!0):i(t)}},,,,function(t,e,n){(function(t){var r=n(14),i=n(210),a=e&&!e.nodeType&&e,o=a&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===a?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;t.exports=l}).call(this,n(16)(t))},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(43),i=n(222),a=n(223),o=n(224),s=n(225),l=n(226);function u(t){var e=this.__data__=new r(t);this.size=e.size}u.prototype.clear=i,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,t.exports=u},function(t,e,n){var r=n(217),i=n(218),a=n(219),o=n(220),s=n(221);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(34);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(22)(Object,"create");t.exports=r},function(t,e,n){var r=n(239);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(254),i=n(66),a=n(255),o=n(256),s=n(257),l=n(21),u=n(117),c=u(r),h=u(i),d=u(a),f=u(o),p=u(s),m=l;(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||a&&"[object Promise]"!=m(a.resolve())||o&&"[object Set]"!=m(new o)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=l(t),n="[object Object]"==e?t.constructor:void 0,r=n?u(n):"";if(r)switch(r){case c:return"[object DataView]";case h:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=m},function(t,e,n){var r=n(21),i=n(15);t.exports=function(t){return"symbol"==typeof t||i(t)&&"[object Symbol]"==r(t)}},function(t,e,n){var r=n(48);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},,,,,,,function(t,e,n){var r=n(110),i=n(114);t.exports=function(t,e){return t&&r(t,i(e))}},function(t,e,n){var r=n(209),i=n(15),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(t){return i(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(211),i=n(61),a=n(62),o=a&&a.isTypedArray,s=o?i(o):r;t.exports=s},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(108),i=e&&!e.nodeType&&e,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===i&&r.process,s=function(){try{var t=a&&a.require&&a.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=s}).call(this,n(16)(t))},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(21),i=n(11);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var r=n(113)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){var r=n(22)(n(14),"Map");t.exports=r},function(t,e,n){var r=n(231),i=n(238),a=n(240),o=n(241),s=n(242);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(253),i=n(124),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),r(o(t),(function(e){return a.call(t,e)})))}:i;t.exports=s},function(t,e,n){var r=n(8),i=n(48),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||(o.test(t)||!a.test(t)||null!=e&&t in Object(e))}},function(t,e,n){var r=n(132);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(120);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Checkboard=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(0),a=l(i),o=l(n(4)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(300));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Checkboard=function(t){var e=t.white,n=t.grey,l=t.size,u=t.renderers,c=t.borderRadius,h=t.boxShadow,d=t.children,f=(0,o.default)({default:{grid:{borderRadius:c,boxShadow:h,absolute:"0px 0px 0px 0px",background:"url("+s.get(e,n,l,u.canvas)+") center left"}}});return(0,i.isValidElement)(d)?a.default.cloneElement(d,r({},d.props,{style:r({},d.props.style,f.grid)})):a.default.createElement("div",{style:f.grid})};u.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},e.default=u},function(t,e,n){"use strict";var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){function t(){return!0}function e(){return!1}function n(){}return function r(){var i=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t&&null!==t&&t.constructor===Object}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],a={name:"any",test:t},o=[],s=[],l={types:i,conversions:s,ignore:o};function u(t){var e=B(l.types,(function(e){return e.name===t}));if(e)return e;if("any"===t)return a;var n=B(l.types,(function(e){return e.name.toLowerCase()===t.toLowerCase()}));throw new TypeError('Unknown type "'+t+'"'+(n?'. Did you mean "'+n.name+'"?':""))}function c(t){return t===a?999:l.types.indexOf(t)}function h(t){var e=B(l.types,(function(e){return e.test(t)}));if(e)return e.name;throw new TypeError("Value has unknown type. Value: "+t)}function d(t){return t.map((function(t){var e=t.types.map(x);return(t.restParam?"...":"")+e.join("|")})).join(",")}function f(t,e){var n=0===t.indexOf("..."),r=(n?t.length>3?t.slice(3):"any":t).split("|").map(N).filter(R).filter(O),i=function(t,e){var n={};return t.forEach((function(t){-1!==e.indexOf(t.from)||-1===e.indexOf(t.to)||n[t.from]||(n[t.from]=t)})),Object.keys(n).map((function(t){return n[t]}))}(e,r),a=r.map((function(t){var e=u(t);return{name:t,typeIndex:c(e),test:e.test,conversion:null,conversionIndex:-1}})),o=i.map((function(t){var n=u(t.from);return{name:t.from,typeIndex:c(n),test:n.test,conversion:t,conversionIndex:e.indexOf(t)}}));return{types:a.concat(o),restParam:n}}function p(t){var e=D(t);return!!e&&e.restParam}function m(t){return t.types.some((function(t){return null!=t.conversion}))}function g(e){if(e&&0!==e.types.length){if(1===e.types.length)return u(e.types[0].name).test;if(2===e.types.length){var n=u(e.types[0].name).test,r=u(e.types[1].name).test;return function(t){return n(t)||r(t)}}var i=e.types.map((function(t){return u(t.name).test}));return function(t){for(var e=0;e<i.length;e++)if(i[e](t))return!0;return!1}}return t}function v(t){var e,n,r,i;if(p(t)){var a=(e=(i=t,i.slice(0,i.length-1)).map(g)).length,o=g(D(t));return function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return function(t){for(var e=a;e<t.length;e++)if(!o(t[e]))return!1;return!0}(t)&&t.length>=a+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(n=g(t[0]),function(t){return n(t[0])&&1===t.length}):2===t.length?(n=g(t[0]),r=g(t[1]),function(t){return n(t[0])&&r(t[1])&&2===t.length}):(e=t.map(g),function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return t.length===e.length})}function y(t,e){return e<t.params.length?t.params[e]:p(t.params)?D(t.params):null}function b(t,e,n){var r=y(t,e);return(r?n?r.types.filter(_):r.types:[]).map(x)}function x(t){return t.name}function _(t){return null===t.conversion||void 0===t.conversion}function w(t,e){var n=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)}(V(t,(function(t){return b(t,e,!1)})));return-1!==n.indexOf("any")?["any"]:n}function S(t,e,n){var r,i,a,o=t||"unnamed",s=n;for(a=0;a<e.length;a++){var l=s.filter((function(t){var n=g(y(t,a));return(a<t.params.length||p(t.params))&&n(e[a])}));if(0===l.length){if((i=w(s,a)).length>0){var u=h(e[a]);return(r=new TypeError("Unexpected type of argument in function "+o+" (expected: "+i.join(" or ")+", actual: "+u+", index: "+a+")")).data={category:"wrongType",fn:o,index:a,actual:u,expected:i},r}}else s=l}var c=s.map((function(t){return p(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,c))return i=w(s,a),(r=new TypeError("Too few arguments in function "+o+" (expected: "+i.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:o,index:e.length,expected:i},r;var d=Math.max.apply(null,c);return e.length>d?((r=new TypeError("Too many arguments in function "+o+" (expected: "+d+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:o,index:e.length,expectedLength:d},r):((r=new TypeError('Arguments of type "'+e.join(", ")+'" do not match any of the defined signatures of function '+o+".")).data={category:"mismatch",actual:e.map(h)},r)}function E(t){for(var e=999,n=0;n<t.types.length;n++)_(t.types[n])&&(e=Math.min(e,t.types[n].typeIndex));return e}function M(t){for(var e=999,n=0;n<t.types.length;n++)_(t.types[n])||(e=Math.min(e,t.types[n].conversionIndex));return e}function C(t,e){var n;return 0!=(n=t.restParam-e.restParam)||0!=(n=m(t)-m(e))||0!=(n=E(t)-E(e))?n:M(t)-M(e)}function T(t,e){var n,r,i=Math.min(t.params.length,e.params.length);if(0!=(r=t.params.some(m)-e.params.some(m)))return r;for(n=0;n<i;n++)if(0!=(r=m(t.params[n])-m(e.params[n])))return r;for(n=0;n<i;n++)if(0!==(r=C(t.params[n],e.params[n])))return r;return t.params.length-e.params.length}function k(t){var e,n,r,i,a=[],o=[];switch(t.types.forEach((function(t){t.conversion&&(a.push(u(t.conversion.from).test),o.push(t.conversion.convert))})),o.length){case 0:return function(t){return t};case 1:return e=a[0],r=o[0],function(t){return e(t)?r(t):t};case 2:return e=a[0],n=a[1],r=o[0],i=o[1],function(t){return e(t)?r(t):n(t)?i(t):t};default:return function(t){for(var e=0;e<o.length;e++)if(a[e](t))return o[e](t);return t}}}function P(t,e){return function t(n,r,i){if(r<n.length){var a,o=n[r],s=e?o.types.filter(_):o.types;if(o.restParam){var l=s.filter(_);a=l.length<s.length?[l,s]:[s]}else a=s.map((function(t){return[t]}));return V(a,(function(e){return t(n,r+1,i.concat([e]))}))}return[i.map((function(t,e){return{types:t,restParam:e===n.length-1&&p(n)}}))]}(t,0,[])}function A(t,r){if(0===Object.keys(r).length)throw new SyntaxError("No signatures provided");var i=[];Object.keys(r).map((function(t){return function(t,e,n){var r=[];return""!==t.trim()&&(r=t.split(",").map(N).map((function(t,e,r){var i=f(t,n);if(i.restParam&&e!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+t+'": only allowed for the last parameter');return i}))),r.some(I)?null:{params:r,fn:e}}(t,r[t],l.conversions)})).filter(L).forEach((function(t){var e=B(i,(function(e){return function(t,e){for(var n=Math.max(t.params.length,e.params.length),r=0;r<n;r++)if(!F(b(t,r,!0),b(e,r,!0)))return!1;var i=t.params.length,a=e.params.length,o=p(t.params),s=p(e.params);return o?s?i===a:a>=i:s?i>=a:i===a}(e,t)}));if(e)throw new TypeError('Conflicting signatures "'+d(e.params)+'" and "'+d(t.params)+'".');i.push(t)}));var a=V(i,(function(t){return(t?P(t.params,!1):[]).map((function(e){return{params:e,fn:t.fn}}))})).filter(L);a.sort(T);var o=a[0]&&a[0].params.length<=2&&!p(a[0].params),s=a[1]&&a[1].params.length<=2&&!p(a[1].params),u=a[2]&&a[2].params.length<=2&&!p(a[2].params),c=a[3]&&a[3].params.length<=2&&!p(a[3].params),h=a[4]&&a[4].params.length<=2&&!p(a[4].params),y=a[5]&&a[5].params.length<=2&&!p(a[5].params),x=o&&s&&u&&c&&h&&y,_=a.map((function(t){return v(t.params)})),w=o?g(a[0].params[0]):e,E=s?g(a[1].params[0]):e,M=u?g(a[2].params[0]):e,C=c?g(a[3].params[0]):e,A=h?g(a[4].params[0]):e,O=y?g(a[5].params[0]):e,R=o?g(a[0].params[1]):e,D=s?g(a[1].params[1]):e,j=u?g(a[2].params[1]):e,H=c?g(a[3].params[1]):e,U=h?g(a[4].params[1]):e,G=y?g(a[5].params[1]):e,q=a.map((function(t){return function(t,e){var n=e;if(t.some(m)){var r=p(t),i=t.map(k);n=function(){for(var t=[],n=r?arguments.length-1:arguments.length,a=0;a<n;a++)t[a]=i[a](arguments[a]);return r&&(t[n]=arguments[n].map(i[n])),e.apply(this,t)}}var a=n;if(p(t)){var o=t.length-1;a=function(){return n.apply(this,z(arguments,0,o).concat([z(arguments,o)]))}}return a}(t.params,t.fn)})),W=o?q[0]:n,$=s?q[1]:n,Y=u?q[2]:n,Q=c?q[3]:n,X=h?q[4]:n,Z=y?q[5]:n,J=o?a[0].params.length:-1,K=s?a[1].params.length:-1,tt=u?a[2].params.length:-1,et=c?a[3].params.length:-1,nt=h?a[4].params.length:-1,rt=y?a[5].params.length:-1,it=x?6:0,at=a.length,ot=function(){for(var e=it;e<at;e++)if(_[e](arguments))return q[e].apply(this,arguments);throw S(t,arguments,a)},st=function t(e,n){return arguments.length===J&&w(e)&&R(n)?W.apply(t,arguments):arguments.length===K&&E(e)&&D(n)?$.apply(t,arguments):arguments.length===tt&&M(e)&&j(n)?Y.apply(t,arguments):arguments.length===et&&C(e)&&H(n)?Q.apply(t,arguments):arguments.length===nt&&A(e)&&U(n)?X.apply(t,arguments):arguments.length===rt&&O(e)&&G(n)?Z.apply(t,arguments):ot.apply(t,arguments)};try{Object.defineProperty(st,"name",{value:t})}catch(t){}return st.signatures=function(t){var e={};return t.forEach((function(t){t.params.some(m)||P(t.params,!0).forEach((function(n){e[d(n)]=t.fn}))})),e}(a),st}function O(t){return-1===l.ignore.indexOf(t)}function N(t){return t.trim()}function R(t){return!!t}function L(t){return null!==t}function I(t){return 0===t.types.length}function D(t){return t[t.length-1]}function z(t,e,n){return Array.prototype.slice.call(t,e,n)}function F(t,e){for(var n=0;n<t.length;n++)if(r=e,i=t[n],-1!==r.indexOf(i))return!0;var r,i;return!1}function B(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function V(t,e){return Array.prototype.concat.apply([],t.map(e))}function j(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(("object"==typeof r.signatures||"string"==typeof r.signature)&&""!==r.name)if(""===e)e=r.name;else if(e!==r.name){var i=new Error("Function names do not match (expected: "+e+", actual: "+r.name+")");throw i.data={actual:r.name,expected:e},i}}return e}function H(t){var e,n={};function r(t,r){if(n.hasOwnProperty(t)&&r!==n[t])throw(e=new Error('Signature "'+t+'" is defined twice')).data={signature:t},e}for(var i=0;i<t.length;i++){var a=t[i];if("object"==typeof a.signatures)for(var o in a.signatures)a.signatures.hasOwnProperty(o)&&(r(o,a.signatures[o]),n[o]=a.signatures[o]);else{if("string"!=typeof a.signature)throw(e=new TypeError("Function is no typed-function (index: "+i+")")).data={index:i},e;r(a.signature,a),n[a.signature]=a}}return n}return(l=A("typed",{"string, Object":A,Object:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return A(j(e),t)},"...Function":function(t){return A(j(t),H(t))},"string, ...Function":function(t,e){return A(t,H(e))}})).create=r,l.types=i,l.conversions=s,l.ignore=o,l.convert=function(t,e){var n=h(t);if(e===n)return t;for(var r=0;r<l.conversions.length;r++){var i=l.conversions[r];if(i.from===n&&i.to===e)return i.convert(t)}throw new Error("Cannot convert from "+n+" to "+e)},l.find=function(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof e){n=e.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");n=e}var i=n.join(","),a=t.signatures[i];if(a)return a;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+n.join(", ")+"))")},l.addType=function(t,e){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==e)for(var n=0;n<l.types.length;n++)if("Object"===l.types[n].name)return void l.types.splice(n,0,t);l.types.push(t)},l.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");l.conversions.push(t)},l}()})?r.apply(e,i):r)||(t.exports=a)},function(t,e,n){var r=n(371),i=n(372),a=n(373),o=n(374),s=n(375),l=n(376),u=n(377);u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=o,u.xor4096=s,u.tychei=l,t.exports=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,l=o(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))i.call(n,c)&&(l[c]=n[c]);if(r){s=r(n);for(var h=0;h<s.length;h++)a.call(n,s[h])&&(l[s[h]]=n[s[h]])}}return l}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(109))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(111),i=n(33);t.exports=function(t,e){return t&&r(t,e,i)}},function(t,e,n){var r=n(207)();t.exports=r},function(t,e,n){var r=n(208),i=n(57),a=n(8),o=n(40),s=n(58),l=n(59),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=a(t),c=!n&&i(t),h=!n&&!c&&o(t),d=!n&&!c&&!h&&l(t),f=n||c||h||d,p=f?r(t.length,String):[],m=p.length;for(var g in t)!e&&!u.call(t,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||p.push(g);return p}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(41);t.exports=function(t){return"function"==typeof t?t:r}},function(t,e,n){var r=n(21),i=n(65),a=n(15),o=Function.prototype,s=Object.prototype,l=o.toString,u=s.hasOwnProperty,c=l.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=r(t))return!1;var e=i(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==c}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(243),i=n(15);t.exports=function t(e,n,a,o,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,a,o,t,s))}},function(t,e,n){var r=n(244),i=n(247),a=n(248);t.exports=function(t,e,n,o,s,l){var u=1&n,c=t.length,h=e.length;if(c!=h&&!(u&&h>c))return!1;var d=l.get(t),f=l.get(e);if(d&&f)return d==e&&f==t;var p=-1,m=!0,g=2&n?new r:void 0;for(l.set(t,e),l.set(e,t);++p<c;){var v=t[p],y=e[p];if(o)var b=u?o(y,v,p,e,t,l):o(v,y,p,t,e,l);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!i(e,(function(t,e){if(!a(g,e)&&(v===t||s(v,t,n,o,l)))return g.push(e)}))){m=!1;break}}else if(v!==y&&!s(v,y,n,o,l)){m=!1;break}}return l.delete(t),l.delete(e),m}},function(t,e,n){var r=n(14).Uint8Array;t.exports=r},function(t,e,n){var r=n(122),i=n(68),a=n(33);t.exports=function(t){return r(t,a,i)}},function(t,e,n){var r=n(123),i=n(8);t.exports=function(t,e,n){var a=e(t);return i(t)?a:r(a,n(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(11);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},function(t,e,n){var r=n(128),i=n(49);t.exports=function(t,e){for(var n=0,a=(e=r(e,t)).length;null!=t&&n<a;)t=t[i(e[n++])];return n&&n==a?t:void 0}},function(t,e,n){var r=n(8),i=n(69),a=n(261),o=n(264);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:a(o(t))}},function(t,e,n){var r=n(110),i=n(273)(r);t.exports=i},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(70),i=n(34),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var o=t[e];a.call(t,e)&&i(o,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(22),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){(function(t){var r=n(14),i=e&&!e.nodeType&&e,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===i?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(16)(t))},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(123),i=n(65),a=n(68),o=n(124),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,a(t)),t=i(t);return e}:o;t.exports=s},function(t,e,n){var r=n(71);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(289),i=n(65),a=n(63);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:r(i(t))}},function(t,e,n){var r=n(70),i=n(34);t.exports=function(t,e,n){(void 0!==n&&!i(t[e],n)||void 0===n&&!(e in t))&&r(t,e,n)}},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var r=n(11),i=n(322),a=n(323),o=Math.max,s=Math.min;t.exports=function(t,e,n){var l,u,c,h,d,f,p=0,m=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=l,r=u;return l=u=void 0,p=e,h=t.apply(r,n)}function b(t){return p=t,d=setTimeout(_,e),m?y(t):h}function x(t){var n=t-f;return void 0===f||n>=e||n<0||g&&t-p>=c}function _(){var t=i();if(x(t))return w(t);d=setTimeout(_,function(t){var n=e-(t-f);return g?s(n,c-(t-p)):n}(t))}function w(t){return d=void 0,v&&l?y(t):(l=u=void 0,h)}function S(){var t=i(),n=x(t);if(l=arguments,u=this,f=t,n){if(void 0===d)return b(f);if(g)return clearTimeout(d),d=setTimeout(_,e),y(f)}return void 0===d&&(d=setTimeout(_,e)),h}return e=a(e)||0,r(n)&&(m=!!n.leading,c=(g="maxWait"in n)?o(a(n.maxWait)||0,e):c,v="trailing"in n?!!n.trailing:v),S.cancel=function(){void 0!==d&&clearTimeout(d),p=0,l=f=u=d=void 0},S.flush=function(){return void 0===d?h:w(i())},S}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorWrap=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),o=u(a),s=u(n(140)),l=u(n(17));function u(t){return t&&t.__esModule?t:{default:t}}var c=e.ColorWrap=function(t){var e=function(e){function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.handleChange=function(t,n){if(l.default.simpleCheckForValidColor(t)){var r=l.default.toState(t,t.h||e.state.oldHue);e.setState(r),e.props.onChangeComplete&&e.debounce(e.props.onChangeComplete,r,n),e.props.onChange&&e.props.onChange(r,n)}},e.handleSwatchHover=function(t,n){if(l.default.simpleCheckForValidColor(t)){var r=l.default.toState(t,t.h||e.state.oldHue);e.props.onSwatchHover&&e.props.onSwatchHover(r,n)}},e.state=r({},l.default.toState(t.color,0)),e.debounce=(0,s.default)((function(t,e,n){t(e,n)}),100),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),i(n,[{key:"render",value:function(){var e={};return this.props.onSwatchHover&&(e.onSwatchHover=this.handleSwatchHover),o.default.createElement(t,r({},this.props,this.state,{onChange:this.handleChange},e))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return r({},l.default.toState(t.color,e.oldHue))}}]),n}(a.PureComponent||a.Component);return e.propTypes=r({},t.propTypes),e.defaultProps=r({},t.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),e};e.default=c},function(t,e,n){"use strict";n.r(e),n.d(e,"red",(function(){return r})),n.d(e,"pink",(function(){return i})),n.d(e,"purple",(function(){return a})),n.d(e,"deepPurple",(function(){return o})),n.d(e,"indigo",(function(){return s})),n.d(e,"blue",(function(){return l})),n.d(e,"lightBlue",(function(){return u})),n.d(e,"cyan",(function(){return c})),n.d(e,"teal",(function(){return h})),n.d(e,"green",(function(){return d})),n.d(e,"lightGreen",(function(){return f})),n.d(e,"lime",(function(){return p})),n.d(e,"yellow",(function(){return m})),n.d(e,"amber",(function(){return g})),n.d(e,"orange",(function(){return v})),n.d(e,"deepOrange",(function(){return y})),n.d(e,"brown",(function(){return b})),n.d(e,"grey",(function(){return x})),n.d(e,"blueGrey",(function(){return _})),n.d(e,"darkText",(function(){return w})),n.d(e,"lightText",(function(){return S})),n.d(e,"darkIcons",(function(){return E})),n.d(e,"lightIcons",(function(){return M})),n.d(e,"white",(function(){return C})),n.d(e,"black",(function(){return T}));var r={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},i={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},a={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},o={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},s={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},l={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},u={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},c={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},h={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},d={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},f={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},p={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},m={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},g={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},v={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},y={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},b={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},x={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},_={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},w={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},S={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},E={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},M={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},C="#ffffff",T="#000000";e.default={red:r,pink:i,purple:a,deepPurple:o,indigo:s,blue:l,lightBlue:u,cyan:c,teal:h,green:d,lightGreen:f,lime:p,yellow:m,amber:g,orange:v,deepOrange:y,brown:b,grey:x,blueGrey:_,darkText:w,lightText:S,darkIcons:E,lightIcons:M,white:C,black:T}},function(t,e,n){t.exports.Dispatcher=n(200)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CustomPicker=e.TwitterPicker=e.SwatchesPicker=e.SliderPicker=e.SketchPicker=e.PhotoshopPicker=e.MaterialPicker=e.HuePicker=e.GithubPicker=e.CompactPicker=e.ChromePicker=e.default=e.CirclePicker=e.BlockPicker=e.AlphaPicker=void 0;var r=n(202);Object.defineProperty(e,"AlphaPicker",{enumerable:!0,get:function(){return y(r).default}});var i=n(331);Object.defineProperty(e,"BlockPicker",{enumerable:!0,get:function(){return y(i).default}});var a=n(333);Object.defineProperty(e,"CirclePicker",{enumerable:!0,get:function(){return y(a).default}});var o=n(335);Object.defineProperty(e,"ChromePicker",{enumerable:!0,get:function(){return y(o).default}});var s=n(341);Object.defineProperty(e,"CompactPicker",{enumerable:!0,get:function(){return y(s).default}});var l=n(344);Object.defineProperty(e,"GithubPicker",{enumerable:!0,get:function(){return y(l).default}});var u=n(346);Object.defineProperty(e,"HuePicker",{enumerable:!0,get:function(){return y(u).default}});var c=n(348);Object.defineProperty(e,"MaterialPicker",{enumerable:!0,get:function(){return y(c).default}});var h=n(349);Object.defineProperty(e,"PhotoshopPicker",{enumerable:!0,get:function(){return y(h).default}});var d=n(355);Object.defineProperty(e,"SketchPicker",{enumerable:!0,get:function(){return y(d).default}});var f=n(358);Object.defineProperty(e,"SliderPicker",{enumerable:!0,get:function(){return y(f).default}});var p=n(362);Object.defineProperty(e,"SwatchesPicker",{enumerable:!0,get:function(){return y(p).default}});var m=n(366);Object.defineProperty(e,"TwitterPicker",{enumerable:!0,get:function(){return y(m).default}});var g=n(141);Object.defineProperty(e,"CustomPicker",{enumerable:!0,get:function(){return y(g).default}});var v=y(o);function y(t){return t&&t.__esModule?t:{default:t}}e.default=v.default},function(t,e,n){t.exports=function(t,e){"use strict";var n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e);let r=class extends t.Sprite{constructor({fontSize:e=1,...r}={},i=new t.SpriteMaterial({depthWrite:!1})){super(i);let a=new n.default({fontSize:e,...r});this.material.map=a}onBeforeRender(t,e,n){let{material:r}=this,{map:i}=r;if(i.checkFontFace()){let{scale:e}=this,{height:r,width:a}=i;a&&r?(e.setX(a).setY(r),i.setOptimalPixelRatio(this,t,n),i.redraw()):e.setScalar(1)}else i.loadFontFace()}dispose(){let{material:t}=this,{map:e}=t;e.dispose(),t.dispose()}};return["alignment","backgroundColor","color","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineGap","padding","strokeColor","strokeWidth","text"].forEach(t=>{Object.defineProperty(r.prototype,t,{get(){return this.material.map[t]},set(e){this.material.map[t]=e}})}),r.prototype.isTextSprite=!0,r}(n(1),n(380))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";
/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(107),i="function"==typeof Symbol&&Symbol.for,a=i?Symbol.for("react.element"):60103,o=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,u=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function x(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}function _(){}function w(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},_.prototype=x.prototype;var S=w.prototype=new _;S.constructor=w,r(S,x.prototype),S.isPureReactComponent=!0;var E={current:null},M=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,n){var r,i={},o=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)M.call(e,r)&&!C.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:a,type:t,key:o,ref:s,props:i,_owner:E.current}}function k(t){return"object"==typeof t&&null!==t&&t.$$typeof===a}var P=/\/+/g,A=[];function O(t,e,n,r){if(A.length){var i=A.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function N(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>A.length&&A.push(t)}function R(t,e,n){return null==t?0:function t(e,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case a:case o:l=!0}}if(l)return r(i,e,""===n?"."+L(e,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=n+L(s=e[u],u);l+=t(s,c,r,i)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=g&&e[g]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=t(s=s.value,c=n+L(s,u++),r,i);else if("object"===s)throw r=""+e,Error(v(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return l}(t,"",e,n)}function L(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function I(t,e){t.func.call(t.context,e,t.count++)}function D(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?z(t,r,n,(function(t){return t})):null!=t&&(k(t)&&(t=function(t,e){return{$$typeof:a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(P,"$&/")+"/")+n)),r.push(t))}function z(t,e,n,r,i){var a="";null!=n&&(a=(""+n).replace(P,"$&/")+"/"),R(t,D,e=O(e,a,r,i)),N(e)}var F={current:null};function B(){var t=F.current;if(null===t)throw Error(v(321));return t}var V={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:function(t,e,n){if(null==t)return t;var r=[];return z(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;R(t,I,e=O(null,null,e,n)),N(e)},count:function(t){return R(t,(function(){return null}),null)},toArray:function(t){var e=[];return z(t,e,null,(function(t){return t})),e},only:function(t){if(!k(t))throw Error(v(143));return t}},e.Component=x,e.Fragment=s,e.Profiler=u,e.PureComponent=w,e.StrictMode=l,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,e.cloneElement=function(t,e,n){if(null==t)throw Error(v(267,t));var i=r({},t.props),o=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=E.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)M.call(e,c)&&!C.hasOwnProperty(c)&&(i[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];i.children=u}return{$$typeof:a,type:t.type,key:o,ref:s,props:i,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:d,render:t}},e.isValidElement=k,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:p,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return B().useCallback(t,e)},e.useContext=function(t,e){return B().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return B().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return B().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return B().useLayoutEffect(t,e)},e.useMemo=function(t,e){return B().useMemo(t,e)},e.useReducer=function(t,e,n){return B().useReducer(t,e,n)},e.useRef=function(t){return B().useRef(t)},e.useState=function(t){return B().useState(t)},e.version="16.13.1"},function(t,e,n){"use strict";
/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(0),i=n(107),a=n(198);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(o(227));function s(t,e,n,r,i,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){this.onError(t)}}var l=!1,u=null,c=!1,h=null,d={onError:function(t){l=!0,u=t}};function f(t,e,n,r,i,a,o,c,h){l=!1,u=null,s.apply(d,arguments)}var p=null,m=null,g=null;function v(t,e,n){var r=t.type||"unknown-event";t.currentTarget=g(n),function(t,e,n,r,i,a,s,d,p){if(f.apply(this,arguments),l){if(!l)throw Error(o(198));var m=u;l=!1,u=null,c||(c=!0,h=m)}}(r,e,void 0,t),t.currentTarget=null}var y=null,b={};function x(){if(y)for(var t in b){var e=b[t],n=y.indexOf(t);if(!(-1<n))throw Error(o(96,t));if(!w[n]){if(!e.extractEvents)throw Error(o(97,t));for(var r in w[n]=e,n=e.eventTypes){var i=void 0,a=n[r],s=e,l=r;if(S.hasOwnProperty(l))throw Error(o(99,l));S[l]=a;var u=a.phasedRegistrationNames;if(u){for(i in u)u.hasOwnProperty(i)&&_(u[i],s,l);i=!0}else a.registrationName?(_(a.registrationName,s,l),i=!0):i=!1;if(!i)throw Error(o(98,r,t))}}}}function _(t,e,n){if(E[t])throw Error(o(100,t));E[t]=e,M[t]=e.eventTypes[n].dependencies}var w=[],S={},E={},M={};function C(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];if(!b.hasOwnProperty(e)||b[e]!==r){if(b[e])throw Error(o(102,e));b[e]=r,n=!0}}n&&x()}var T=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),k=null,P=null,A=null;function O(t){if(t=m(t)){if("function"!=typeof k)throw Error(o(280));var e=t.stateNode;e&&(e=p(e),k(t.stateNode,t.type,e))}}function N(t){P?A?A.push(t):A=[t]:P=t}function R(){if(P){var t=P,e=A;if(A=P=null,O(t),e)for(t=0;t<e.length;t++)O(e[t])}}function L(t,e){return t(e)}function I(t,e,n,r,i){return t(e,n,r,i)}function D(){}var z=L,F=!1,B=!1;function V(){null===P&&null===A||(D(),R())}function j(t,e,n){if(B)return t(e,n);B=!0;try{return z(t,e,n)}finally{B=!1,V()}}var H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,U=Object.prototype.hasOwnProperty,G={},q={};function W(t,e,n,r,i,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a}var $={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){$[t]=new W(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];$[e]=new W(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){$[t]=new W(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){$[t]=new W(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){$[t]=new W(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){$[t]=new W(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){$[t]=new W(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){$[t]=new W(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){$[t]=new W(t,5,!1,t.toLowerCase(),null,!1)}));var Y=/[\-:]([a-z])/g;function Q(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(Y,Q);$[e]=new W(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(Y,Q);$[e]=new W(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(Y,Q);$[e]=new W(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){$[t]=new W(t,1,!1,t.toLowerCase(),null,!1)})),$.xlinkHref=new W("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){$[t]=new W(t,1,!1,t.toLowerCase(),null,!0)}));var X=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Z(t,e,n,r){var i=$.hasOwnProperty(e)?$[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null==e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!U.call(q,t)||!U.call(G,t)&&(H.test(t)?q[t]=!0:(G[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}X.hasOwnProperty("ReactCurrentDispatcher")||(X.ReactCurrentDispatcher={current:null}),X.hasOwnProperty("ReactCurrentBatchConfig")||(X.ReactCurrentBatchConfig={suspense:null});var J=/^(.*)[\\\/]/,K="function"==typeof Symbol&&Symbol.for,tt=K?Symbol.for("react.element"):60103,et=K?Symbol.for("react.portal"):60106,nt=K?Symbol.for("react.fragment"):60107,rt=K?Symbol.for("react.strict_mode"):60108,it=K?Symbol.for("react.profiler"):60114,at=K?Symbol.for("react.provider"):60109,ot=K?Symbol.for("react.context"):60110,st=K?Symbol.for("react.concurrent_mode"):60111,lt=K?Symbol.for("react.forward_ref"):60112,ut=K?Symbol.for("react.suspense"):60113,ct=K?Symbol.for("react.suspense_list"):60120,ht=K?Symbol.for("react.memo"):60115,dt=K?Symbol.for("react.lazy"):60116,ft=K?Symbol.for("react.block"):60121,pt="function"==typeof Symbol&&Symbol.iterator;function mt(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=pt&&t[pt]||t["@@iterator"])?t:null}function gt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case it:return"Profiler";case rt:return"StrictMode";case ut:return"Suspense";case ct:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case ot:return"Context.Consumer";case at:return"Context.Provider";case lt:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case ht:return gt(t.type);case ft:return gt(t.render);case dt:if(t=1===t._status?t._result:null)return gt(t)}return null}function vt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,i=t._debugSource,a=gt(t.type);n=null,r&&(n=gt(r.type)),r=a,a="",i?a=" (at "+i.fileName.replace(J,"")+":"+i.lineNumber+")":n&&(a=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+a}e+=n,t=t.return}while(t);return e}function yt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function bt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function xt(t){t._valueTracker||(t._valueTracker=function(t){var e=bt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function _t(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=bt(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function wt(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function St(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=yt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Et(t,e){null!=(e=e.checked)&&Z(t,"checked",e,!1)}function Mt(t,e){Et(t,e);var n=yt(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Tt(t,e.type,yt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Ct(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Tt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function kt(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Pt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yt(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function At(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ot(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:yt(n)}}function Nt(t,e){var n=yt(e.value),r=yt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Rt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var Lt="http://www.w3.org/1999/xhtml",It="http://www.w3.org/2000/svg";function Dt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Dt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Ft,Bt=function(t){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction((function(){return t(e,n)}))}:t}((function(t,e){if(t.namespaceURI!==It||"innerHTML"in t)t.innerHTML=e;else{for((Ft=Ft||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ft.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function Vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function jt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ht={animationend:jt("Animation","AnimationEnd"),animationiteration:jt("Animation","AnimationIteration"),animationstart:jt("Animation","AnimationStart"),transitionend:jt("Transition","TransitionEnd")},Ut={},Gt={};function qt(t){if(Ut[t])return Ut[t];if(!Ht[t])return t;var e,n=Ht[t];for(e in n)if(n.hasOwnProperty(e)&&e in Gt)return Ut[t]=n[e];return t}T&&(Gt=document.createElement("div").style,"AnimationEvent"in window||(delete Ht.animationend.animation,delete Ht.animationiteration.animation,delete Ht.animationstart.animation),"TransitionEvent"in window||delete Ht.transitionend.transition);var Wt=qt("animationend"),$t=qt("animationiteration"),Yt=qt("animationstart"),Qt=qt("transitionend"),Xt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zt=new("function"==typeof WeakMap?WeakMap:Map);function Jt(t){var e=Zt.get(t);return void 0===e&&(e=new Map,Zt.set(t,e)),e}function Kt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function te(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ee(t){if(Kt(t)!==t)throw Error(o(188))}function ne(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=Kt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return ee(i),t;if(a===r)return ee(i),e;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function re(t,e){if(null==e)throw Error(o(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function ie(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var ae=null;function oe(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)v(t,e[r],n[r]);else e&&v(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function se(t){if(null!==t&&(ae=re(ae,t)),t=ae,ae=null,t){if(ie(t,oe),ae)throw Error(o(95));if(c)throw t=h,c=!1,h=null,t}}function le(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ue(t){if(!T)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"==typeof e[t]),e}var ce=[];function he(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>ce.length&&ce.push(t)}function de(t,e,n,r){if(ce.length){var i=ce.pop();return i.topLevelType=t,i.eventSystemFlags=r,i.nativeEvent=e,i.targetInst=n,i}return{topLevelType:t,eventSystemFlags:r,nativeEvent:e,targetInst:n,ancestors:[]}}function fe(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Tn(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=le(t.nativeEvent);r=t.topLevelType;var a=t.nativeEvent,o=t.eventSystemFlags;0===n&&(o|=64);for(var s=null,l=0;l<w.length;l++){var u=w[l];u&&(u=u.extractEvents(r,e,a,i,o))&&(s=re(s,u))}se(s)}}function pe(t,e,n){if(!n.has(t)){switch(t){case"scroll":Ye(e,"scroll",!0);break;case"focus":case"blur":Ye(e,"focus",!0),Ye(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ue(t)&&Ye(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Xt.indexOf(t)&&$e(t,e)}n.set(t,null)}}var me,ge,ve,ye=!1,be=[],xe=null,_e=null,we=null,Se=new Map,Ee=new Map,Me=[],Ce="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Te="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function ke(t,e,n,r,i){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Pe(t,e){switch(t){case"focus":case"blur":xe=null;break;case"dragenter":case"dragleave":_e=null;break;case"mouseover":case"mouseout":we=null;break;case"pointerover":case"pointerout":Se.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ee.delete(e.pointerId)}}function Ae(t,e,n,r,i,a){return null===t||t.nativeEvent!==a?(t=ke(e,n,r,i,a),null!==e&&(null!==(e=kn(e))&&ge(e)),t):(t.eventSystemFlags|=r,t)}function Oe(t){var e=Tn(t.target);if(null!==e){var n=Kt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=te(n)))return t.blockedOn=e,void a.unstable_runWithPriority(t.priority,(function(){ve(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ne(t){if(null!==t.blockedOn)return!1;var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=kn(e);return null!==n&&ge(n),t.blockedOn=e,!1}return!0}function Re(t,e,n){Ne(t)&&n.delete(e)}function Le(){for(ye=!1;0<be.length;){var t=be[0];if(null!==t.blockedOn){null!==(t=kn(t.blockedOn))&&me(t);break}var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:be.shift()}null!==xe&&Ne(xe)&&(xe=null),null!==_e&&Ne(_e)&&(_e=null),null!==we&&Ne(we)&&(we=null),Se.forEach(Re),Ee.forEach(Re)}function Ie(t,e){t.blockedOn===e&&(t.blockedOn=null,ye||(ye=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Le)))}function De(t){function e(e){return Ie(e,t)}if(0<be.length){Ie(be[0],t);for(var n=1;n<be.length;n++){var r=be[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==xe&&Ie(xe,t),null!==_e&&Ie(_e,t),null!==we&&Ie(we,t),Se.forEach(e),Ee.forEach(e),n=0;n<Me.length;n++)(r=Me[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Oe(n),null===n.blockedOn&&Me.shift()}var ze={},Fe=new Map,Be=new Map,Ve=["abort","abort",Wt,"animationEnd",$t,"animationIteration",Yt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Qt,"transitionEnd","waiting","waiting"];function je(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],i=t[n+1],a="on"+(i[0].toUpperCase()+i.slice(1));a={phasedRegistrationNames:{bubbled:a,captured:a+"Capture"},dependencies:[r],eventPriority:e},Be.set(r,e),Fe.set(r,a),ze[i]=a}}je("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),je("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),je(Ve,2);for(var He="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ue=0;Ue<He.length;Ue++)Be.set(He[Ue],0);var Ge=a.unstable_UserBlockingPriority,qe=a.unstable_runWithPriority,We=!0;function $e(t,e){Ye(e,t,!1)}function Ye(t,e,n){var r=Be.get(e);switch(void 0===r?2:r){case 0:r=Qe.bind(null,e,1,t);break;case 1:r=Xe.bind(null,e,1,t);break;default:r=Ze.bind(null,e,1,t)}n?t.addEventListener(e,r,!0):t.addEventListener(e,r,!1)}function Qe(t,e,n,r){F||D();var i=Ze,a=F;F=!0;try{I(i,t,e,n,r)}finally{(F=a)||V()}}function Xe(t,e,n,r){qe(Ge,Ze.bind(null,t,e,n,r))}function Ze(t,e,n,r){if(We)if(0<be.length&&-1<Ce.indexOf(t))t=ke(null,t,e,n,r),be.push(t);else{var i=Je(t,e,n,r);if(null===i)Pe(t,r);else if(-1<Ce.indexOf(t))t=ke(i,t,e,n,r),be.push(t);else if(!function(t,e,n,r,i){switch(e){case"focus":return xe=Ae(xe,t,e,n,r,i),!0;case"dragenter":return _e=Ae(_e,t,e,n,r,i),!0;case"mouseover":return we=Ae(we,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Se.set(a,Ae(Se.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ee.set(a,Ae(Ee.get(a)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r)){Pe(t,r),t=de(t,r,null,e);try{j(fe,t)}finally{he(t)}}}}function Je(t,e,n,r){if(null!==(n=Tn(n=le(r)))){var i=Kt(n);if(null===i)n=null;else{var a=i.tag;if(13===a){if(null!==(n=te(i)))return n;n=null}else if(3===a){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}t=de(t,r,n,e);try{j(fe,t)}finally{he(t)}return null}var Ke={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function en(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||Ke.hasOwnProperty(t)&&Ke[t]?(""+e).trim():e+"px"}function nn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=en(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(Ke).forEach((function(t){tn.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ke[e]=Ke[t]}))}));var rn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function an(t,e){if(e){if(rn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(o(62,""))}}function on(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=Lt;function ln(t,e){var n=Jt(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=M[e];for(var r=0;r<e.length;r++)pe(e[r],t,n)}function un(){}function cn(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dn(t,e){var n,r=hn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=hn(r)}}function fn(){for(var t=window,e=cn();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=cn((t=e.contentWindow).document)}return e}function pn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var mn=null,gn=null;function vn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function yn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var bn="function"==typeof setTimeout?setTimeout:void 0,xn="function"==typeof clearTimeout?clearTimeout:void 0;function _n(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function wn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Sn=Math.random().toString(36).slice(2),En="__reactInternalInstance$"+Sn,Mn="__reactEventHandlers$"+Sn,Cn="__reactContainere$"+Sn;function Tn(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Cn]||n[En]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=wn(t);null!==t;){if(n=t[En])return n;t=wn(t)}return e}n=(t=n).parentNode}return null}function kn(t){return!(t=t[En]||t[Cn])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Pn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function An(t){return t[Mn]||null}function On(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Nn(t,e){var n=t.stateNode;if(!n)return null;var r=p(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(o(231,e,typeof n));return n}function Rn(t,e,n){(e=Nn(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Ln(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=On(e);for(e=n.length;0<e--;)Rn(n[e],"captured",t);for(e=0;e<n.length;e++)Rn(n[e],"bubbled",t)}}function In(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Nn(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Dn(t){t&&t.dispatchConfig.registrationName&&In(t._targetInst,null,t)}function zn(t){ie(t,Ln)}var Fn=null,Bn=null,Vn=null;function jn(){if(Vn)return Vn;var t,e,n=Bn,r=n.length,i="value"in Fn?Fn.value:Fn.textContent,a=i.length;for(t=0;t<r&&n[t]===i[t];t++);var o=r-t;for(e=1;e<=o&&n[r-e]===i[a-e];e++);return Vn=i.slice(t,1<e?1-e:void 0)}function Hn(){return!0}function Un(){return!1}function Gn(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Hn:Un,this.isPropagationStopped=Un,this}function qn(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function Wn(t){if(!(t instanceof this))throw Error(o(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function $n(t){t.eventPool=[],t.getPooled=qn,t.release=Wn}i(Gn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Hn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Hn)},persist:function(){this.isPersistent=Hn},isPersistent:Un,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Un,this._dispatchInstances=this._dispatchListeners=null}}),Gn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Gn.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var a=new e;return i(a,n.prototype),n.prototype=a,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,$n(n),n},$n(Gn);var Yn=Gn.extend({data:null}),Qn=Gn.extend({data:null}),Xn=[9,13,27,32],Zn=T&&"CompositionEvent"in window,Jn=null;T&&"documentMode"in document&&(Jn=document.documentMode);var Kn=T&&"TextEvent"in window&&!Jn,tr=T&&(!Zn||Jn&&8<Jn&&11>=Jn),er=String.fromCharCode(32),nr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},rr=!1;function ir(t,e){switch(t){case"keyup":return-1!==Xn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function ar(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var or=!1;var sr={eventTypes:nr,extractEvents:function(t,e,n,r){var i;if(Zn)t:{switch(t){case"compositionstart":var a=nr.compositionStart;break t;case"compositionend":a=nr.compositionEnd;break t;case"compositionupdate":a=nr.compositionUpdate;break t}a=void 0}else or?ir(t,n)&&(a=nr.compositionEnd):"keydown"===t&&229===n.keyCode&&(a=nr.compositionStart);return a?(tr&&"ko"!==n.locale&&(or||a!==nr.compositionStart?a===nr.compositionEnd&&or&&(i=jn()):(Bn="value"in(Fn=r)?Fn.value:Fn.textContent,or=!0)),a=Yn.getPooled(a,e,n,r),i?a.data=i:null!==(i=ar(n))&&(a.data=i),zn(a),i=a):i=null,(t=Kn?function(t,e){switch(t){case"compositionend":return ar(e);case"keypress":return 32!==e.which?null:(rr=!0,er);case"textInput":return(t=e.data)===er&&rr?null:t;default:return null}}(t,n):function(t,e){if(or)return"compositionend"===t||!Zn&&ir(t,e)?(t=jn(),Vn=Bn=Fn=null,or=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tr&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=Qn.getPooled(nr.beforeInput,e,n,r)).data=t,zn(e)):e=null,null===i?e:null===e?i:[i,e]}},lr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ur(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!lr[t.type]:"textarea"===e}var cr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function hr(t,e,n){return(t=Gn.getPooled(cr.change,t,e,n)).type="change",N(n),zn(t),t}var dr=null,fr=null;function pr(t){se(t)}function mr(t){if(_t(Pn(t)))return t}function gr(t,e){if("change"===t)return e}var vr=!1;function yr(){dr&&(dr.detachEvent("onpropertychange",br),fr=dr=null)}function br(t){if("value"===t.propertyName&&mr(fr))if(t=hr(fr,t,le(t)),F)se(t);else{F=!0;try{L(pr,t)}finally{F=!1,V()}}}function xr(t,e,n){"focus"===t?(yr(),fr=n,(dr=e).attachEvent("onpropertychange",br)):"blur"===t&&yr()}function _r(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return mr(fr)}function wr(t,e){if("click"===t)return mr(e)}function Sr(t,e){if("input"===t||"change"===t)return mr(e)}T&&(vr=ue("input")&&(!document.documentMode||9<document.documentMode));var Er={eventTypes:cr,_isInputEventSupported:vr,extractEvents:function(t,e,n,r){var i=e?Pn(e):window,a=i.nodeName&&i.nodeName.toLowerCase();if("select"===a||"input"===a&&"file"===i.type)var o=gr;else if(ur(i))if(vr)o=Sr;else{o=_r;var s=xr}else(a=i.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=wr);if(o&&(o=o(t,e)))return hr(o,n,r);s&&s(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&Tt(i,"number",i.value)}},Mr=Gn.extend({view:null,detail:null}),Cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tr(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Cr[t])&&!!e[t]}function kr(){return Tr}var Pr=0,Ar=0,Or=!1,Nr=!1,Rr=Mr.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:kr,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Pr;return Pr=t.screenX,Or?"mousemove"===t.type?t.screenX-e:0:(Or=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ar;return Ar=t.screenY,Nr?"mousemove"===t.type?t.screenY-e:0:(Nr=!0,0)}}),Lr=Rr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Ir={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Dr={eventTypes:Ir,extractEvents:function(t,e,n,r,i){var a="mouseover"===t||"pointerover"===t,o="mouseout"===t||"pointerout"===t;if(a&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!o&&!a)return null;(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,o)?(o=e,null!==(e=(e=n.relatedTarget||n.toElement)?Tn(e):null)&&(e!==Kt(e)||5!==e.tag&&6!==e.tag)&&(e=null)):o=null;if(o===e)return null;if("mouseout"===t||"mouseover"===t)var s=Rr,l=Ir.mouseLeave,u=Ir.mouseEnter,c="mouse";else"pointerout"!==t&&"pointerover"!==t||(s=Lr,l=Ir.pointerLeave,u=Ir.pointerEnter,c="pointer");if(t=null==o?a:Pn(o),a=null==e?a:Pn(e),(l=s.getPooled(l,o,n,r)).type=c+"leave",l.target=t,l.relatedTarget=a,(n=s.getPooled(u,e,n,r)).type=c+"enter",n.target=a,n.relatedTarget=t,c=e,(r=o)&&c)t:{for(u=c,o=0,t=s=r;t;t=On(t))o++;for(t=0,e=u;e;e=On(e))t++;for(;0<o-t;)s=On(s),o--;for(;0<t-o;)u=On(u),t--;for(;o--;){if(s===u||s===u.alternate)break t;s=On(s),u=On(u)}s=null}else s=null;for(u=s,s=[];r&&r!==u&&(null===(o=r.alternate)||o!==u);)s.push(r),r=On(r);for(r=[];c&&c!==u&&(null===(o=c.alternate)||o!==u);)r.push(c),c=On(c);for(c=0;c<s.length;c++)In(s[c],"bubbled",l);for(c=r.length;0<c--;)In(r[c],"captured",n);return 0==(64&i)?[l]:[l,n]}};var zr="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},Fr=Object.prototype.hasOwnProperty;function Br(t,e){if(zr(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Fr.call(e,n[r])||!zr(t[n[r]],e[n[r]]))return!1;return!0}var Vr=T&&"documentMode"in document&&11>=document.documentMode,jr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Hr=null,Ur=null,Gr=null,qr=!1;function Wr(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return qr||null==Hr||Hr!==cn(n)?null:("selectionStart"in(n=Hr)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Gr&&Br(Gr,n)?null:(Gr=n,(t=Gn.getPooled(jr.select,Ur,t,e)).type="select",t.target=Hr,zn(t),t))}var $r={eventTypes:jr,extractEvents:function(t,e,n,r,i,a){if(!(a=!(i=a||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){t:{i=Jt(i),a=M.onSelect;for(var o=0;o<a.length;o++)if(!i.has(a[o])){i=!1;break t}i=!0}a=!i}if(a)return null;switch(i=e?Pn(e):window,t){case"focus":(ur(i)||"true"===i.contentEditable)&&(Hr=i,Ur=e,Gr=null);break;case"blur":Gr=Ur=Hr=null;break;case"mousedown":qr=!0;break;case"contextmenu":case"mouseup":case"dragend":return qr=!1,Wr(n,r);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return Wr(n,r)}return null}},Yr=Gn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Qr=Gn.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Xr=Mr.extend({relatedTarget:null});function Zr(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var Jr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ti=Mr.extend({key:function(t){if(t.key){var e=Jr[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Zr(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Kr[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:kr,charCode:function(t){return"keypress"===t.type?Zr(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Zr(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),ei=Rr.extend({dataTransfer:null}),ni=Mr.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:kr}),ri=Gn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ii=Rr.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),ai={eventTypes:ze,extractEvents:function(t,e,n,r){var i=Fe.get(t);if(!i)return null;switch(t){case"keypress":if(0===Zr(n))return null;case"keydown":case"keyup":t=ti;break;case"blur":case"focus":t=Xr;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Rr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=ei;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=ni;break;case Wt:case $t:case Yt:t=Yr;break;case Qt:t=ri;break;case"scroll":t=Mr;break;case"wheel":t=ii;break;case"copy":case"cut":case"paste":t=Qr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Lr;break;default:t=Gn}return zn(e=t.getPooled(i,e,n,r)),e}};if(y)throw Error(o(101));y=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),x(),p=An,m=kn,g=Pn,C({SimpleEventPlugin:ai,EnterLeaveEventPlugin:Dr,ChangeEventPlugin:Er,SelectEventPlugin:$r,BeforeInputEventPlugin:sr});var oi=[],si=-1;function li(t){0>si||(t.current=oi[si],oi[si]=null,si--)}function ui(t,e){si++,oi[si]=t.current,t.current=e}var ci={},hi={current:ci},di={current:!1},fi=ci;function pi(t,e){var n=t.type.contextTypes;if(!n)return ci;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function mi(t){return null!=(t=t.childContextTypes)}function gi(){li(di),li(hi)}function vi(t,e,n){if(hi.current!==ci)throw Error(o(168));ui(hi,e),ui(di,n)}function yi(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,gt(e)||"Unknown",a));return i({},n,{},r)}function bi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ci,fi=hi.current,ui(hi,t),ui(di,di.current),!0}function xi(t,e,n){var r=t.stateNode;if(!r)throw Error(o(169));n?(t=yi(t,e,fi),r.__reactInternalMemoizedMergedChildContext=t,li(di),li(hi),ui(hi,t)):li(di),ui(di,n)}var _i=a.unstable_runWithPriority,wi=a.unstable_scheduleCallback,Si=a.unstable_cancelCallback,Ei=a.unstable_requestPaint,Mi=a.unstable_now,Ci=a.unstable_getCurrentPriorityLevel,Ti=a.unstable_ImmediatePriority,ki=a.unstable_UserBlockingPriority,Pi=a.unstable_NormalPriority,Ai=a.unstable_LowPriority,Oi=a.unstable_IdlePriority,Ni={},Ri=a.unstable_shouldYield,Li=void 0!==Ei?Ei:function(){},Ii=null,Di=null,zi=!1,Fi=Mi(),Bi=1e4>Fi?Mi:function(){return Mi()-Fi};function Vi(){switch(Ci()){case Ti:return 99;case ki:return 98;case Pi:return 97;case Ai:return 96;case Oi:return 95;default:throw Error(o(332))}}function ji(t){switch(t){case 99:return Ti;case 98:return ki;case 97:return Pi;case 96:return Ai;case 95:return Oi;default:throw Error(o(332))}}function Hi(t,e){return t=ji(t),_i(t,e)}function Ui(t,e,n){return t=ji(t),wi(t,e,n)}function Gi(t){return null===Ii?(Ii=[t],Di=wi(Ti,Wi)):Ii.push(t),Ni}function qi(){if(null!==Di){var t=Di;Di=null,Si(t)}Wi()}function Wi(){if(!zi&&null!==Ii){zi=!0;var t=0;try{var e=Ii;Hi(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Ii=null}catch(e){throw null!==Ii&&(Ii=Ii.slice(t+1)),wi(Ti,qi),e}finally{zi=!1}}}function $i(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function Yi(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var Qi={current:null},Xi=null,Zi=null,Ji=null;function Ki(){Ji=Zi=Xi=null}function ta(t){var e=Qi.current;li(Qi),t.type._context._currentValue=e}function ea(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function na(t,e){Xi=t,Ji=Zi=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Ao=!0),t.firstContext=null)}function ra(t,e){if(Ji!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(Ji=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Zi){if(null===Xi)throw Error(o(308));Zi=e,Xi.dependencies={expirationTime:0,firstContext:e,responders:null}}else Zi=Zi.next=e;return t._currentValue}var ia=!1;function aa(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oa(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function sa(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function la(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function ua(t,e){var n=t.alternate;null!==n&&oa(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function ca(t,e,n,r){var a=t.updateQueue;ia=!1;var o=a.baseQueue,s=a.shared.pending;if(null!==s){if(null!==o){var l=o.next;o.next=s.next,s.next=l}o=s,a.shared.pending=null,null!==(l=t.alternate)&&(null!==(l=l.updateQueue)&&(l.baseQueue=s))}if(null!==o){l=o.next;var u=a.baseState,c=0,h=null,d=null,f=null;if(null!==l)for(var p=l;;){if((s=p.expirationTime)<r){var m={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===f?(d=f=m,h=u):f=f.next=m,s>c&&(c=s)}else{null!==f&&(f=f.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null}),al(s,p.suspenseConfig);t:{var g=t,v=p;switch(s=e,m=n,v.tag){case 1:if("function"==typeof(g=v.payload)){u=g.call(m,u,s);break t}u=g;break t;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null==(s="function"==typeof(g=v.payload)?g.call(m,u,s):g))break t;u=i({},u,s);break t;case 2:ia=!0}}null!==p.callback&&(t.effectTag|=32,null===(s=a.effects)?a.effects=[p]:s.push(p))}if(null===(p=p.next)||p===l){if(null===(s=a.shared.pending))break;p=o.next=s.next,s.next=l,a.baseQueue=o=s,a.shared.pending=null}}null===f?h=u:f.next=d,a.baseState=h,a.baseQueue=f,ol(c),t.expirationTime=c,t.memoizedState=u}}function ha(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!=typeof r)throw Error(o(191,r));r.call(i)}}}var da=X.ReactCurrentBatchConfig,fa=(new r.Component).refs;function pa(t,e,n,r){n=null==(n=n(r,e=t.memoizedState))?e:i({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var ma={isMounted:function(t){return!!(t=t._reactInternalFiber)&&Kt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=Ws(),i=da.suspense;(i=sa(r=$s(r,t,i),i)).payload=e,null!=n&&(i.callback=n),la(t,i),Ys(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=Ws(),i=da.suspense;(i=sa(r=$s(r,t,i),i)).tag=1,i.payload=e,null!=n&&(i.callback=n),la(t,i),Ys(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=Ws(),r=da.suspense;(r=sa(n=$s(n,t,r),r)).tag=2,null!=e&&(r.callback=e),la(t,r),Ys(t,n)}};function ga(t,e,n,r,i,a,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,a,o):!e.prototype||!e.prototype.isPureReactComponent||(!Br(n,r)||!Br(i,a))}function va(t,e,n){var r=!1,i=ci,a=e.contextType;return"object"==typeof a&&null!==a?a=ra(a):(i=mi(e)?fi:hi.current,a=(r=null!=(r=e.contextTypes))?pi(t,i):ci),e=new e(n,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ma,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function ya(t,e,n,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ma.enqueueReplaceState(e,e.state,null)}function ba(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=fa,aa(t);var a=e.contextType;"object"==typeof a&&null!==a?i.context=ra(a):(a=mi(e)?fi:hi.current,i.context=pi(t,a)),ca(t,n,i,r),i.state=t.memoizedState,"function"==typeof(a=e.getDerivedStateFromProps)&&(pa(t,e,a,n),i.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(e=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&ma.enqueueReplaceState(i,i.state,null),ca(t,n,i,r),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.effectTag|=4)}var xa=Array.isArray;function _a(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=r.refs;e===fa&&(e=r.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}if("string"!=typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function wa(t,e){if("textarea"!==t.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Sa(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Cl(t,e)).index=0,t.sibling=null,t}function a(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Pl(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function u(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=_a(t,e,n),r.return=t,r):((r=Tl(n.type,n.key,n.props,null,t.mode,r)).ref=_a(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Al(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,a){return null===e||7!==e.tag?((e=kl(n,t.mode,r,a)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Pl(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Tl(e.type,e.key,e.props,null,t.mode,n)).ref=_a(t,null,e),n.return=t,n;case et:return(e=Al(e,t.mode,n)).return=t,e}if(xa(e)||mt(e))return(e=kl(e,t.mode,n,null)).return=t,e;wa(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(t,e,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===i?n.type===nt?h(t,e,n.props.children,r,i):u(t,e,n,r):null;case et:return n.key===i?c(t,e,n,r):null}if(xa(n)||mt(n))return null!==i?null:h(t,e,n,r,null);wa(t,n)}return null}function p(t,e,n,r,i){if("string"==typeof r||"number"==typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case tt:return t=t.get(null===r.key?n:r.key)||null,r.type===nt?h(e,t,r.props.children,i,r.key):u(e,t,r,i);case et:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(xa(r)||mt(r))return h(e,t=t.get(n)||null,r,i,null);wa(e,r)}return null}function m(i,o,s,l){for(var u=null,c=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,s[m],l);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(i,h),o=a(v,o,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===s.length)return n(i,h),u;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===c?u=h:c.sibling=h,c=h);return u}for(h=r(i,h);m<s.length;m++)null!==(g=p(h,i,m,s[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(i,t)})),u}function g(i,s,l,u){var c=mt(l);if("function"!=typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var h=c=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,u);if(null===b){null===m&&(m=v);break}t&&m&&null===b.alternate&&e(i,m),s=a(b,s,g),null===h?c=b:h.sibling=b,h=b,m=v}if(y.done)return n(i,m),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,u))&&(s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,u))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?c=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(i,t)})),c}return function(t,r,a,l){var u="object"==typeof a&&null!==a&&a.type===nt&&null===a.key;u&&(a=a.props.children);var c="object"==typeof a&&null!==a;if(c)switch(a.$$typeof){case tt:t:{for(c=a.key,u=r;null!==u;){if(u.key===c){switch(u.tag){case 7:if(a.type===nt){n(t,u.sibling),(r=i(u,a.props.children)).return=t,t=r;break t}break;default:if(u.elementType===a.type){n(t,u.sibling),(r=i(u,a.props)).ref=_a(t,u,a),r.return=t,t=r;break t}}n(t,u);break}e(t,u),u=u.sibling}a.type===nt?((r=kl(a.props.children,t.mode,l,a.key)).return=t,t=r):((l=Tl(a.type,a.key,a.props,null,t.mode,l)).ref=_a(t,r,a),l.return=t,t=l)}return s(t);case et:t:{for(u=a.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(t,r.sibling),(r=i(r,a.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Al(a,t.mode,l)).return=t,t=r}return s(t)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,a)).return=t,t=r):(n(t,r),(r=Pl(a,t.mode,l)).return=t,t=r),s(t);if(xa(a))return m(t,r,a,l);if(mt(a))return g(t,r,a,l);if(c&&wa(t,a),void 0===a&&!u)switch(t.tag){case 1:case 0:throw t=t.type,Error(o(152,t.displayName||t.name||"Component"))}return n(t,r)}}var Ea=Sa(!0),Ma=Sa(!1),Ca={},Ta={current:Ca},ka={current:Ca},Pa={current:Ca};function Aa(t){if(t===Ca)throw Error(o(174));return t}function Oa(t,e){switch(ui(Pa,e),ui(ka,t),ui(Ta,Ca),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zt(null,"");break;default:e=zt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}li(Ta),ui(Ta,e)}function Na(){li(Ta),li(ka),li(Pa)}function Ra(t){Aa(Pa.current);var e=Aa(Ta.current),n=zt(e,t.type);e!==n&&(ui(ka,t),ui(Ta,n))}function La(t){ka.current===t&&(li(Ta),li(ka))}var Ia={current:0};function Da(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function za(t,e){return{responder:t,props:e}}var Fa=X.ReactCurrentDispatcher,Ba=X.ReactCurrentBatchConfig,Va=0,ja=null,Ha=null,Ua=null,Ga=!1;function qa(){throw Error(o(321))}function Wa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zr(t[n],e[n]))return!1;return!0}function $a(t,e,n,r,i,a){if(Va=a,ja=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Fa.current=null===t||null===t.memoizedState?vo:yo,t=n(r,i),e.expirationTime===Va){a=0;do{if(e.expirationTime=0,!(25>a))throw Error(o(301));a+=1,Ua=Ha=null,e.updateQueue=null,Fa.current=bo,t=n(r,i)}while(e.expirationTime===Va)}if(Fa.current=go,e=null!==Ha&&null!==Ha.next,Va=0,Ua=Ha=ja=null,Ga=!1,e)throw Error(o(300));return t}function Ya(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ua?ja.memoizedState=Ua=t:Ua=Ua.next=t,Ua}function Qa(){if(null===Ha){var t=ja.alternate;t=null!==t?t.memoizedState:null}else t=Ha.next;var e=null===Ua?ja.memoizedState:Ua.next;if(null!==e)Ua=e,Ha=t;else{if(null===t)throw Error(o(310));t={memoizedState:(Ha=t).memoizedState,baseState:Ha.baseState,baseQueue:Ha.baseQueue,queue:Ha.queue,next:null},null===Ua?ja.memoizedState=Ua=t:Ua=Ua.next=t}return Ua}function Xa(t,e){return"function"==typeof e?e(t):e}function Za(t){var e=Qa(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=Ha,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=s=a=null,u=i;do{var c=u.expirationTime;if(c<Va){var h={expirationTime:u.expirationTime,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(s=l=h,a=r):l=l.next=h,c>ja.expirationTime&&(ja.expirationTime=c,ol(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),al(c,u.suspenseConfig),r=u.eagerReducer===t?u.eagerState:t(r,u.action);u=u.next}while(null!==u&&u!==i);null===l?a=r:l.next=s,zr(r,e.memoizedState)||(Ao=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function Ja(t){var e=Qa(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=t(a,s.action),s=s.next}while(s!==i);zr(a,e.memoizedState)||(Ao=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Ka(t){var e=Ya();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:t}).dispatch=mo.bind(null,ja,t),[e.memoizedState,t]}function to(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=ja.updateQueue)?(e={lastEffect:null},ja.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function eo(){return Qa().memoizedState}function no(t,e,n,r){var i=Ya();ja.effectTag|=t,i.memoizedState=to(1|e,n,void 0,void 0===r?null:r)}function ro(t,e,n,r){var i=Qa();r=void 0===r?null:r;var a=void 0;if(null!==Ha){var o=Ha.memoizedState;if(a=o.destroy,null!==r&&Wa(r,o.deps))return void to(e,n,a,r)}ja.effectTag|=t,i.memoizedState=to(1|e,n,a,r)}function io(t,e){return no(516,4,t,e)}function ao(t,e){return ro(516,4,t,e)}function oo(t,e){return ro(4,2,t,e)}function so(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function lo(t,e,n){return n=null!=n?n.concat([t]):null,ro(4,2,so.bind(null,e,t),n)}function uo(){}function co(t,e){return Ya().memoizedState=[t,void 0===e?null:e],t}function ho(t,e){var n=Qa();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Wa(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fo(t,e){var n=Qa();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Wa(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function po(t,e,n){var r=Vi();Hi(98>r?98:r,(function(){t(!0)})),Hi(97<r?97:r,(function(){var r=Ba.suspense;Ba.suspense=void 0===e?null:e;try{t(!1),n()}finally{Ba.suspense=r}}))}function mo(t,e,n){var r=Ws(),i=da.suspense;i={expirationTime:r=$s(r,t,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var a=e.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),e.pending=i,a=t.alternate,t===ja||null!==a&&a===ja)Ga=!0,i.expirationTime=Va,ja.expirationTime=Va;else{if(0===t.expirationTime&&(null===a||0===a.expirationTime)&&null!==(a=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=a(o,n);if(i.eagerReducer=a,i.eagerState=s,zr(s,o))return}catch(t){}Ys(t,r)}}var go={readContext:ra,useCallback:qa,useContext:qa,useEffect:qa,useImperativeHandle:qa,useLayoutEffect:qa,useMemo:qa,useReducer:qa,useRef:qa,useState:qa,useDebugValue:qa,useResponder:qa,useDeferredValue:qa,useTransition:qa},vo={readContext:ra,useCallback:co,useContext:ra,useEffect:io,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,no(4,2,so.bind(null,e,t),n)},useLayoutEffect:function(t,e){return no(4,2,t,e)},useMemo:function(t,e){var n=Ya();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ya();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=mo.bind(null,ja,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Ya().memoizedState=t},useState:Ka,useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Ka(t),r=n[0],i=n[1];return io((function(){var n=Ba.suspense;Ba.suspense=void 0===e?null:e;try{i(t)}finally{Ba.suspense=n}}),[t,e]),r},useTransition:function(t){var e=Ka(!1),n=e[0];return e=e[1],[co(po.bind(null,e,t),[e,t]),n]}},yo={readContext:ra,useCallback:ho,useContext:ra,useEffect:ao,useImperativeHandle:lo,useLayoutEffect:oo,useMemo:fo,useReducer:Za,useRef:eo,useState:function(){return Za(Xa)},useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Za(Xa),r=n[0],i=n[1];return ao((function(){var n=Ba.suspense;Ba.suspense=void 0===e?null:e;try{i(t)}finally{Ba.suspense=n}}),[t,e]),r},useTransition:function(t){var e=Za(Xa),n=e[0];return e=e[1],[ho(po.bind(null,e,t),[e,t]),n]}},bo={readContext:ra,useCallback:ho,useContext:ra,useEffect:ao,useImperativeHandle:lo,useLayoutEffect:oo,useMemo:fo,useReducer:Ja,useRef:eo,useState:function(){return Ja(Xa)},useDebugValue:uo,useResponder:za,useDeferredValue:function(t,e){var n=Ja(Xa),r=n[0],i=n[1];return ao((function(){var n=Ba.suspense;Ba.suspense=void 0===e?null:e;try{i(t)}finally{Ba.suspense=n}}),[t,e]),r},useTransition:function(t){var e=Ja(Xa),n=e[0];return e=e[1],[ho(po.bind(null,e,t),[e,t]),n]}},xo=null,_o=null,wo=!1;function So(t,e){var n=El(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Eo(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Mo(t){if(wo){var e=_o;if(e){var n=e;if(!Eo(t,e)){if(!(e=_n(n.nextSibling))||!Eo(t,e))return t.effectTag=-1025&t.effectTag|2,wo=!1,void(xo=t);So(xo,n)}xo=t,_o=_n(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,wo=!1,xo=t}}function Co(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;xo=t}function To(t){if(t!==xo)return!1;if(!wo)return Co(t),wo=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!yn(e,t.memoizedProps))for(e=_o;e;)So(t,e),e=_n(e.nextSibling);if(Co(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){_o=_n(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}_o=null}}else _o=xo?_n(t.stateNode.nextSibling):null;return!0}function ko(){_o=xo=null,wo=!1}var Po=X.ReactCurrentOwner,Ao=!1;function Oo(t,e,n,r){e.child=null===t?Ma(e,null,n,r):Ea(e,t.child,n,r)}function No(t,e,n,r,i){n=n.render;var a=e.ref;return na(e,i),r=$a(t,e,n,r,a,i),null===t||Ao?(e.effectTag|=1,Oo(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),Yo(t,e,i))}function Ro(t,e,n,r,i,a){if(null===t){var o=n.type;return"function"!=typeof o||Ml(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Tl(n.type,null,r,null,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Lo(t,e,o,r,i,a))}return o=t.child,i<a&&(i=o.memoizedProps,(n=null!==(n=n.compare)?n:Br)(i,r)&&t.ref===e.ref)?Yo(t,e,a):(e.effectTag|=1,(t=Cl(o,r)).ref=e.ref,t.return=e,e.child=t)}function Lo(t,e,n,r,i,a){return null!==t&&Br(t.memoizedProps,r)&&t.ref===e.ref&&(Ao=!1,i<a)?(e.expirationTime=t.expirationTime,Yo(t,e,a)):Do(t,e,n,r,a)}function Io(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Do(t,e,n,r,i){var a=mi(n)?fi:hi.current;return a=pi(e,a),na(e,i),n=$a(t,e,n,r,a,i),null===t||Ao?(e.effectTag|=1,Oo(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),Yo(t,e,i))}function zo(t,e,n,r,i){if(mi(n)){var a=!0;bi(e)}else a=!1;if(na(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),va(e,n,r),ba(e,n,r,i),r=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=n.contextType;"object"==typeof u&&null!==u?u=ra(u):u=pi(e,u=mi(n)?fi:hi.current);var c=n.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==r||l!==u)&&ya(e,o,r,u),ia=!1;var d=e.memoizedState;o.state=d,ca(e,r,o,i),l=e.memoizedState,s!==r||d!==l||di.current||ia?("function"==typeof c&&(pa(e,n,c,r),l=e.memoizedState),(s=ia||ga(e,n,s,r,d,l,u))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.effectTag|=4)):("function"==typeof o.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):("function"==typeof o.componentDidMount&&(e.effectTag|=4),r=!1)}else o=e.stateNode,oa(t,e),s=e.memoizedProps,o.props=e.type===e.elementType?s:Yi(e.type,s),l=o.context,"object"==typeof(u=n.contextType)&&null!==u?u=ra(u):u=pi(e,u=mi(n)?fi:hi.current),(h="function"==typeof(c=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==r||l!==u)&&ya(e,o,r,u),ia=!1,l=e.memoizedState,o.state=l,ca(e,r,o,i),d=e.memoizedState,s!==r||l!==d||di.current||ia?("function"==typeof c&&(pa(e,n,c,r),d=e.memoizedState),(c=ia||ga(e,n,s,r,l,d,u))?(h||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"==typeof o.componentDidUpdate&&(e.effectTag|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),r=!1);return Fo(t,e,n,r,a,i)}function Fo(t,e,n,r,i,a){Io(t,e);var o=0!=(64&e.effectTag);if(!r&&!o)return i&&xi(e,n,!1),Yo(t,e,a);r=e.stateNode,Po.current=e;var s=o&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&o?(e.child=Ea(e,t.child,null,a),e.child=Ea(e,null,s,a)):Oo(t,e,s,a),e.memoizedState=r.state,i&&xi(e,n,!0),e.child}function Bo(t){var e=t.stateNode;e.pendingContext?vi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&vi(0,e.context,!1),Oa(t,e.containerInfo)}var Vo,jo,Ho,Uo={dehydrated:null,retryTime:0};function Go(t,e,n){var r,i=e.mode,a=e.pendingProps,o=Ia.current,s=!1;if((r=0!=(64&e.effectTag))||(r=0!=(2&o)&&(null===t||null!==t.memoizedState)),r?(s=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),ui(Ia,1&o),null===t){if(void 0!==a.fallback&&Mo(e),s){if(s=a.fallback,(a=kl(null,i,0,null)).return=e,0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(n=kl(s,i,n,null)).return=e,a.sibling=n,e.memoizedState=Uo,e.child=a,n}return i=a.children,e.memoizedState=null,e.child=Ma(e,null,i,n)}if(null!==t.memoizedState){if(i=(t=t.child).sibling,s){if(a=a.fallback,(n=Cl(t,t.pendingProps)).return=e,0==(2&e.mode)&&(s=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=Cl(i,a)).return=e,n.sibling=i,n.childExpirationTime=0,e.memoizedState=Uo,e.child=n,i}return n=Ea(e,t.child,a.children,n),e.memoizedState=null,e.child=n}if(t=t.child,s){if(s=a.fallback,(a=kl(null,i,0,null)).return=e,a.child=t,null!==t&&(t.return=a),0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(n=kl(s,i,n,null)).return=e,a.sibling=n,n.effectTag|=2,a.childExpirationTime=0,e.memoizedState=Uo,e.child=a,n}return e.memoizedState=null,e.child=Ea(e,t,a.children,n)}function qo(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),ea(t.return,e)}function Wo(t,e,n,r,i,a){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:a}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailExpiration=0,o.tailMode=i,o.lastEffect=a)}function $o(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(Oo(t,e,r.children,n),0!=(2&(r=Ia.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!=(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&qo(t,n);else if(19===t.tag)qo(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ui(Ia,r),0==(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===Da(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Wo(e,!1,i,n,a,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Da(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Wo(e,!0,n,null,a,e.lastEffect);break;case"together":Wo(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Yo(t,e,n){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&ol(r),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Cl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Cl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Qo(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xo(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return mi(e.type)&&gi(),null;case 3:return Na(),li(di),li(hi),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!To(e)||(e.effectTag|=4),null;case 5:La(e),n=Aa(Pa.current);var a=e.type;if(null!==t&&null!=e.stateNode)jo(t,e,a,r,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!r){if(null===e.stateNode)throw Error(o(166));return null}if(t=Aa(Ta.current),To(e)){r=e.stateNode,a=e.type;var s=e.memoizedProps;switch(r[En]=e,r[Mn]=s,a){case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(t=0;t<Xt.length;t++)$e(Xt[t],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"form":$e("reset",r),$e("submit",r);break;case"details":$e("toggle",r);break;case"input":St(r,s),$e("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!s.multiple},$e("invalid",r),ln(n,"onChange");break;case"textarea":Ot(r,s),$e("invalid",r),ln(n,"onChange")}for(var l in an(a,s),t=null,s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"==typeof u?r.textContent!==u&&(t=["children",u]):"number"==typeof u&&r.textContent!==""+u&&(t=["children",""+u]):E.hasOwnProperty(l)&&null!=u&&ln(n,l)}switch(a){case"input":xt(r),Ct(r,s,!0);break;case"textarea":xt(r),Rt(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=un)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,t===sn&&(t=Dt(a)),t===sn?"script"===a?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof r.is?t=l.createElement(a,{is:r.is}):(t=l.createElement(a),"select"===a&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,a),t[En]=e,t[Mn]=r,Vo(t,e),e.stateNode=t,l=on(a,r),a){case"iframe":case"object":case"embed":$e("load",t),u=r;break;case"video":case"audio":for(u=0;u<Xt.length;u++)$e(Xt[u],t);u=r;break;case"source":$e("error",t),u=r;break;case"img":case"image":case"link":$e("error",t),$e("load",t),u=r;break;case"form":$e("reset",t),$e("submit",t),u=r;break;case"details":$e("toggle",t),u=r;break;case"input":St(t,r),u=wt(t,r),$e("invalid",t),ln(n,"onChange");break;case"option":u=kt(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},u=i({},r,{value:void 0}),$e("invalid",t),ln(n,"onChange");break;case"textarea":Ot(t,r),u=At(t,r),$e("invalid",t),ln(n,"onChange");break;default:u=r}an(a,u);var c=u;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?nn(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&Bt(t,h):"children"===s?"string"==typeof h?("textarea"!==a||""!==h)&&Vt(t,h):"number"==typeof h&&Vt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?null!=h&&ln(n,s):null!=h&&Z(t,s,h,l))}switch(a){case"input":xt(t),Ct(t,r,!1);break;case"textarea":xt(t),Rt(t);break;case"option":null!=r.value&&t.setAttribute("value",""+yt(r.value));break;case"select":t.multiple=!!r.multiple,null!=(n=r.value)?Pt(t,!!r.multiple,n,!1):null!=r.defaultValue&&Pt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof u.onClick&&(t.onclick=un)}vn(a,r)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)Ho(0,e,t.memoizedProps,r);else{if("string"!=typeof r&&null===e.stateNode)throw Error(o(166));n=Aa(Pa.current),Aa(Ta.current),To(e)?(n=e.stateNode,r=e.memoizedProps,n[En]=e,n.nodeValue!==r&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[En]=e,e.stateNode=n)}return null;case 13:return li(Ia),r=e.memoizedState,0!=(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==r,r=!1,null===t?void 0!==e.memoizedProps.fallback&&To(e):(r=null!==(a=t.memoizedState),n||null===a||null!==(a=t.child.sibling)&&(null!==(s=e.firstEffect)?(e.firstEffect=a,a.nextEffect=s):(e.firstEffect=e.lastEffect=a,a.nextEffect=null),a.effectTag=8)),n&&!r&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Ia.current)?Ts===xs&&(Ts=_s):(Ts!==xs&&Ts!==_s||(Ts=ws),0!==Ns&&null!==Es&&(Rl(Es,Cs),Ll(Es,Ns)))),(n||r)&&(e.effectTag|=4),null);case 4:return Na(),null;case 10:return ta(e),null;case 17:return mi(e.type)&&gi(),null;case 19:if(li(Ia),null===(r=e.memoizedState))return null;if(a=0!=(64&e.effectTag),null===(s=r.rendering)){if(a)Qo(r,!1);else if(Ts!==xs||null!==t&&0!=(64&t.effectTag))for(s=e.child;null!==s;){if(null!==(t=Da(s))){for(e.effectTag|=64,Qo(r,!1),null!==(a=t.updateQueue)&&(e.updateQueue=a,e.effectTag|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=e.child;null!==r;)s=n,(a=r).effectTag&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(t=a.alternate)?(a.childExpirationTime=0,a.expirationTime=s,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null):(a.childExpirationTime=t.childExpirationTime,a.expirationTime=t.expirationTime,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;return ui(Ia,1&Ia.current|2),e.child}s=s.sibling}}else{if(!a)if(null!==(t=Da(s))){if(e.effectTag|=64,a=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),Qo(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Bi()-r.renderingStartTime>r.tailExpiration&&1<n&&(e.effectTag|=64,a=!0,Qo(r,!1),e.expirationTime=e.childExpirationTime=n-1);r.isBackwards?(s.sibling=e.child,e.child=s):(null!==(n=r.last)?n.sibling=s:e.child=s,r.last=s)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Bi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Bi(),n.sibling=null,e=Ia.current,ui(Ia,a?1&e|2:1&e),n):null}throw Error(o(156,e.tag))}function Zo(t){switch(t.tag){case 1:mi(t.type)&&gi();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Na(),li(di),li(hi),0!=(64&(e=t.effectTag)))throw Error(o(285));return t.effectTag=-4097&e|64,t;case 5:return La(t),null;case 13:return li(Ia),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return li(Ia),null;case 4:return Na(),null;case 10:return ta(t),null;default:return null}}function Jo(t,e){return{value:t,source:e,stack:vt(e)}}Vo=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},jo=function(t,e,n,r,a){var o=t.memoizedProps;if(o!==r){var s,l,u=e.stateNode;switch(Aa(Ta.current),t=null,n){case"input":o=wt(u,o),r=wt(u,r),t=[];break;case"option":o=kt(u,o),r=kt(u,r),t=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":o=At(u,o),r=At(u,r),t=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(u.onclick=un)}for(s in an(n,r),n=null,o)if(!r.hasOwnProperty(s)&&o.hasOwnProperty(s)&&null!=o[s])if("style"===s)for(l in u=o[s])u.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(E.hasOwnProperty(s)?t||(t=[]):(t=t||[]).push(s,null));for(s in r){var c=r[s];if(u=null!=o?o[s]:void 0,r.hasOwnProperty(s)&&c!==u&&(null!=c||null!=u))if("style"===s)if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(t||(t=[]),t.push(s,n)),n=c;else"dangerouslySetInnerHTML"===s?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(t=t||[]).push(s,c)):"children"===s?u===c||"string"!=typeof c&&"number"!=typeof c||(t=t||[]).push(s,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(E.hasOwnProperty(s)?(null!=c&&ln(a,s),t||u===c||(t=[])):(t=t||[]).push(s,c))}n&&(t=t||[]).push("style",n),a=t,(e.updateQueue=a)&&(e.effectTag|=4)}},Ho=function(t,e,n,r){n!==r&&(e.effectTag|=4)};var Ko="function"==typeof WeakSet?WeakSet:Set;function ts(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=vt(n)),null!==n&&gt(n.type),e=e.value,null!==t&&1===t.tag&&gt(t.type);try{console.error(e)}catch(t){setTimeout((function(){throw t}))}}function es(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){yl(t,e)}else e.current=null}function ns(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Yi(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(o(163))}function rs(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==e)}}function is(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function as(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void is(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var r=n.elementType===n.type?e.memoizedProps:Yi(n.type,e.memoizedProps);t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&ha(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}ha(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&vn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&De(n)))));case 19:case 17:case 20:case 21:return}throw Error(o(163))}function os(t,e,n){switch("function"==typeof wl&&wl(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;Hi(97<n?97:n,(function(){var t=r;do{var n=t.destroy;if(void 0!==n){var i=e;try{n()}catch(t){yl(i,t)}}t=t.next}while(t!==r)}))}break;case 1:es(e),"function"==typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){yl(t,e)}}(e,n);break;case 5:es(e);break;case 4:cs(t,e,n)}}function ss(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&ss(e)}function ls(t){return 5===t.tag||3===t.tag||4===t.tag}function us(t){t:{for(var e=t.return;null!==e;){if(ls(e)){var n=e;break t}e=e.return}throw Error(o(160))}switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(o(161))}16&n.effectTag&&(Vt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ls(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}r?function t(e,n,r){var i=e.tag,a=5===i||6===i;if(a)e=a?e.stateNode:e.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(e,n):r.insertBefore(e,n):(8===r.nodeType?(n=r.parentNode).insertBefore(e,r):(n=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=un));else if(4!==i&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e):function t(e,n,r){var i=e.tag,a=5===i||6===i;if(a)e=a?e.stateNode:e.stateNode.instance,n?r.insertBefore(e,n):r.appendChild(e);else if(4!==i&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e)}function cs(t,e,n){for(var r,i,a=e,s=!1;;){if(!s){s=a.return;t:for(;;){if(null===s)throw Error(o(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break t;case 3:case 4:r=r.containerInfo,i=!0;break t}s=s.return}s=!0}if(5===a.tag||6===a.tag){t:for(var l=t,u=a,c=n,h=u;;)if(os(l,h,c),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===u)break t;for(;null===h.sibling;){if(null===h.return||h.return===u)break t;h=h.return}h.sibling.return=h.return,h=h.sibling}i?(l=r,u=a.stateNode,8===l.nodeType?l.parentNode.removeChild(u):l.removeChild(u)):r.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){r=a.stateNode.containerInfo,i=!0,a.child.return=a,a=a.child;continue}}else if(os(t,a,n),null!==a.child){a.child.return=a,a=a.child;continue}if(a===e)break;for(;null===a.sibling;){if(null===a.return||a.return===e)return;4===(a=a.return).tag&&(s=!1)}a.sibling.return=a.return,a=a.sibling}}function hs(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void rs(3,e);case 1:return;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,i=null!==t?t.memoizedProps:r;t=e.type;var a=e.updateQueue;if(e.updateQueue=null,null!==a){for(n[Mn]=r,"input"===t&&"radio"===r.type&&null!=r.name&&Et(n,r),on(t,i),e=on(t,r),i=0;i<a.length;i+=2){var s=a[i],l=a[i+1];"style"===s?nn(n,l):"dangerouslySetInnerHTML"===s?Bt(n,l):"children"===s?Vt(n,l):Z(n,s,l,e)}switch(t){case"input":Mt(n,r);break;case"textarea":Nt(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(t=r.value)?Pt(n,!!r.multiple,t,!1):e!==!!r.multiple&&(null!=r.defaultValue?Pt(n,!!r.multiple,r.defaultValue,!0):Pt(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(o(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,De(e.containerInfo)));case 12:return;case 13:if(n=e,null===e.memoizedState?r=!1:(r=!0,n=e.child,Ls=Bi()),null!==n)t:for(t=n;;){if(5===t.tag)a=t.stateNode,r?"function"==typeof(a=a.style).setProperty?a.setProperty("display","none","important"):a.display="none":(a=t.stateNode,i=null!=(i=t.memoizedProps.style)&&i.hasOwnProperty("display")?i.display:null,a.style.display=en("display",i));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(a=t.child.sibling).return=t,t=a;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void ds(e);case 19:return void ds(e);case 17:return}throw Error(o(163))}function ds(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ko),e.forEach((function(e){var r=xl.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}var fs="function"==typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=sa(n,null)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ds||(Ds=!0,zs=r),ts(t,e)},n}function ms(t,e,n){(n=sa(n,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"==typeof r){var i=e.value;n.payload=function(){return ts(t,e),r(i)}}var a=t.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Fs?Fs=new Set([this]):Fs.add(this),ts(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var gs,vs=Math.ceil,ys=X.ReactCurrentDispatcher,bs=X.ReactCurrentOwner,xs=0,_s=3,ws=4,Ss=0,Es=null,Ms=null,Cs=0,Ts=xs,ks=null,Ps=1073741823,As=1073741823,Os=null,Ns=0,Rs=!1,Ls=0,Is=null,Ds=!1,zs=null,Fs=null,Bs=!1,Vs=null,js=90,Hs=null,Us=0,Gs=null,qs=0;function Ws(){return 0!=(48&Ss)?1073741821-(Bi()/10|0):0!==qs?qs:qs=1073741821-(Bi()/10|0)}function $s(t,e,n){if(0==(2&(e=e.mode)))return 1073741823;var r=Vi();if(0==(4&e))return 99===r?1073741823:1073741822;if(0!=(16&Ss))return Cs;if(null!==n)t=$i(t,0|n.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=$i(t,150,100);break;case 97:case 96:t=$i(t,5e3,250);break;case 95:t=2;break;default:throw Error(o(326))}return null!==Es&&t===Cs&&--t,t}function Ys(t,e){if(50<Us)throw Us=0,Gs=null,Error(o(185));if(null!==(t=Qs(t,e))){var n=Vi();1073741823===e?0!=(8&Ss)&&0==(48&Ss)?Ks(t):(Zs(t),0===Ss&&qi()):Zs(t),0==(4&Ss)||98!==n&&99!==n||(null===Hs?Hs=new Map([[t,e]]):(void 0===(n=Hs.get(t))||n>e)&&Hs.set(t,e))}}function Qs(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,i=null;if(null===r&&3===t.tag)i=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Es===i&&(ol(e),Ts===ws&&Rl(i,Cs)),Ll(i,e)),i}function Xs(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Nl(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function Zs(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Gi(Ks.bind(null,t));else{var e=Xs(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=Ws();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=t.callbackPriority;if(t.callbackExpirationTime===e&&i>=r)return;n!==Ni&&Si(n)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?Gi(Ks.bind(null,t)):Ui(r,Js.bind(null,t),{timeout:10*(1073741821-e)-Bi()}),t.callbackNode=e}}}function Js(t,e){if(qs=0,e)return Il(t,e=Ws()),Zs(t),null;var n=Xs(t);if(0!==n){if(e=t.callbackNode,0!=(48&Ss))throw Error(o(327));if(ml(),t===Es&&n===Cs||nl(t,n),null!==Ms){var r=Ss;Ss|=16;for(var i=il();;)try{ll();break}catch(e){rl(t,e)}if(Ki(),Ss=r,ys.current=i,1===Ts)throw e=ks,nl(t,n),Rl(t,n),Zs(t),e;if(null===Ms)switch(i=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,r=Ts,Es=null,r){case xs:case 1:throw Error(o(345));case 2:Il(t,2<n?2:n);break;case _s:if(Rl(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=hl(i)),1073741823===Ps&&10<(i=Ls+500-Bi())){if(Rs){var a=t.lastPingedTime;if(0===a||a>=n){t.lastPingedTime=n,nl(t,n);break}}if(0!==(a=Xs(t))&&a!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}t.timeoutHandle=bn(dl.bind(null,t),i);break}dl(t);break;case ws:if(Rl(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=hl(i)),Rs&&(0===(i=t.lastPingedTime)||i>=n)){t.lastPingedTime=n,nl(t,n);break}if(0!==(i=Xs(t))&&i!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}if(1073741823!==As?r=10*(1073741821-As)-Bi():1073741823===Ps?r=0:(r=10*(1073741821-Ps)-5e3,0>(r=(i=Bi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vs(r/1960))-r)&&(r=n)),10<r){t.timeoutHandle=bn(dl.bind(null,t),r);break}dl(t);break;case 5:if(1073741823!==Ps&&null!==Os){a=Ps;var s=Os;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(a=Bi()-(10*(1073741821-a)-(0|s.timeoutMs||5e3)))<=i?0:i+r-a),10<r){Rl(t,n),t.timeoutHandle=bn(dl.bind(null,t),r);break}}dl(t);break;default:throw Error(o(329))}if(Zs(t),t.callbackNode===e)return Js.bind(null,t)}}return null}function Ks(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,0!=(48&Ss))throw Error(o(327));if(ml(),t===Es&&e===Cs||nl(t,e),null!==Ms){var n=Ss;Ss|=16;for(var r=il();;)try{sl();break}catch(e){rl(t,e)}if(Ki(),Ss=n,ys.current=r,1===Ts)throw n=ks,nl(t,e),Rl(t,e),Zs(t),n;if(null!==Ms)throw Error(o(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Es=null,dl(t),Zs(t)}return null}function tl(t,e){var n=Ss;Ss|=1;try{return t(e)}finally{0===(Ss=n)&&qi()}}function el(t,e){var n=Ss;Ss&=-2,Ss|=8;try{return t(e)}finally{0===(Ss=n)&&qi()}}function nl(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,xn(n)),null!==Ms)for(n=Ms.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&gi();break;case 3:Na(),li(di),li(hi);break;case 5:La(r);break;case 4:Na();break;case 13:case 19:li(Ia);break;case 10:ta(r)}n=n.return}Es=t,Ms=Cl(t.current,null),Cs=e,Ts=xs,ks=null,As=Ps=1073741823,Os=null,Ns=0,Rs=!1}function rl(t,e){for(;;){try{if(Ki(),Fa.current=go,Ga)for(var n=ja.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Va=0,Ua=Ha=ja=null,Ga=!1,null===Ms||null===Ms.return)return Ts=1,ks=e,Ms=null;t:{var i=t,a=Ms.return,o=Ms,s=e;if(e=Cs,o.effectTag|=2048,o.firstEffect=o.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var l=s;if(0==(2&o.mode)){var u=o.alternate;u?(o.updateQueue=u.updateQueue,o.memoizedState=u.memoizedState,o.expirationTime=u.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var c=0!=(1&Ia.current),h=a;do{var d;if(d=13===h.tag){var f=h.memoizedState;if(null!==f)d=null!==f.dehydrated;else{var p=h.memoizedProps;d=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!c)}}if(d){var m=h.updateQueue;if(null===m){var g=new Set;g.add(l),h.updateQueue=g}else m.add(l);if(0==(2&h.mode)){if(h.effectTag|=64,o.effectTag&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var v=sa(1073741823,null);v.tag=2,la(o,v)}o.expirationTime=1073741823;break t}s=void 0,o=e;var y=i.pingCache;if(null===y?(y=i.pingCache=new fs,s=new Set,y.set(l,s)):void 0===(s=y.get(l))&&(s=new Set,y.set(l,s)),!s.has(o)){s.add(o);var b=bl.bind(null,i,l,o);l.then(b,b)}h.effectTag|=4096,h.expirationTime=e;break t}h=h.return}while(null!==h);s=Error((gt(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+vt(o))}5!==Ts&&(Ts=2),s=Jo(s,o),h=a;do{switch(h.tag){case 3:l=s,h.effectTag|=4096,h.expirationTime=e,ua(h,ps(h,l,e));break t;case 1:l=s;var x=h.type,_=h.stateNode;if(0==(64&h.effectTag)&&("function"==typeof x.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===Fs||!Fs.has(_)))){h.effectTag|=4096,h.expirationTime=e,ua(h,ms(h,l,e));break t}}h=h.return}while(null!==h)}Ms=cl(Ms)}catch(t){e=t;continue}break}}function il(){var t=ys.current;return ys.current=go,null===t?go:t}function al(t,e){t<Ps&&2<t&&(Ps=t),null!==e&&t<As&&2<t&&(As=t,Os=e)}function ol(t){t>Ns&&(Ns=t)}function sl(){for(;null!==Ms;)Ms=ul(Ms)}function ll(){for(;null!==Ms&&!Ri();)Ms=ul(Ms)}function ul(t){var e=gs(t.alternate,t,Cs);return t.memoizedProps=t.pendingProps,null===e&&(e=cl(t)),bs.current=null,e}function cl(t){Ms=t;do{var e=Ms.alternate;if(t=Ms.return,0==(2048&Ms.effectTag)){if(e=Xo(e,Ms,Cs),1===Cs||1!==Ms.childExpirationTime){for(var n=0,r=Ms.child;null!==r;){var i=r.expirationTime,a=r.childExpirationTime;i>n&&(n=i),a>n&&(n=a),r=r.sibling}Ms.childExpirationTime=n}if(null!==e)return e;null!==t&&0==(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Ms.firstEffect),null!==Ms.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Ms.firstEffect),t.lastEffect=Ms.lastEffect),1<Ms.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Ms:t.firstEffect=Ms,t.lastEffect=Ms))}else{if(null!==(e=Zo(Ms)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Ms.sibling))return e;Ms=t}while(null!==Ms);return Ts===xs&&(Ts=5),null}function hl(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function dl(t){var e=Vi();return Hi(99,fl.bind(null,t,e)),null}function fl(t,e){do{ml()}while(null!==Vs);if(0!=(48&Ss))throw Error(o(327));var n=t.finishedWork,r=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var i=hl(n);if(t.firstPendingTime=i,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Es&&(Ms=Es=null,Cs=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var a=Ss;Ss|=32,bs.current=null,mn=We;var s=fn();if(pn(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else t:{var u=(l=(l=s.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,h=u.focusNode;u=u.focusOffset;try{l.nodeType,h.nodeType}catch(t){l=null;break t}var d=0,f=-1,p=-1,m=0,g=0,v=s,y=null;e:for(;;){for(var b;v!==l||0!==c&&3!==v.nodeType||(f=d+c),v!==h||0!==u&&3!==v.nodeType||(p=d+u),3===v.nodeType&&(d+=v.nodeValue.length),null!==(b=v.firstChild);)y=v,v=b;for(;;){if(v===s)break e;if(y===l&&++m===c&&(f=d),y===h&&++g===u&&(p=d),null!==(b=v.nextSibling))break;y=(v=y).parentNode}v=b}l=-1===f||-1===p?null:{start:f,end:p}}else l=null}l=l||{start:0,end:0}}else l=null;gn={activeElementDetached:null,focusedElem:s,selectionRange:l},We=!1,Is=i;do{try{pl()}catch(t){if(null===Is)throw Error(o(330));yl(Is,t),Is=Is.nextEffect}}while(null!==Is);Is=i;do{try{for(s=t,l=e;null!==Is;){var x=Is.effectTag;if(16&x&&Vt(Is.stateNode,""),128&x){var _=Is.alternate;if(null!==_){var w=_.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&x){case 2:us(Is),Is.effectTag&=-3;break;case 6:us(Is),Is.effectTag&=-3,hs(Is.alternate,Is);break;case 1024:Is.effectTag&=-1025;break;case 1028:Is.effectTag&=-1025,hs(Is.alternate,Is);break;case 4:hs(Is.alternate,Is);break;case 8:cs(s,c=Is,l),ss(c)}Is=Is.nextEffect}}catch(t){if(null===Is)throw Error(o(330));yl(Is,t),Is=Is.nextEffect}}while(null!==Is);if(w=gn,_=fn(),x=w.focusedElem,l=w.selectionRange,_!==x&&x&&x.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(x.ownerDocument.documentElement,x)){null!==l&&pn(x)&&(_=l.start,void 0===(w=l.end)&&(w=_),"selectionStart"in x?(x.selectionStart=_,x.selectionEnd=Math.min(w,x.value.length)):(w=(_=x.ownerDocument||document)&&_.defaultView||window).getSelection&&(w=w.getSelection(),c=x.textContent.length,s=Math.min(l.start,c),l=void 0===l.end?s:Math.min(l.end,c),!w.extend&&s>l&&(c=l,l=s,s=c),c=dn(x,s),h=dn(x,l),c&&h&&(1!==w.rangeCount||w.anchorNode!==c.node||w.anchorOffset!==c.offset||w.focusNode!==h.node||w.focusOffset!==h.offset)&&((_=_.createRange()).setStart(c.node,c.offset),w.removeAllRanges(),s>l?(w.addRange(_),w.extend(h.node,h.offset)):(_.setEnd(h.node,h.offset),w.addRange(_))))),_=[];for(w=x;w=w.parentNode;)1===w.nodeType&&_.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof x.focus&&x.focus(),x=0;x<_.length;x++)(w=_[x]).element.scrollLeft=w.left,w.element.scrollTop=w.top}We=!!mn,gn=mn=null,t.current=n,Is=i;do{try{for(x=t;null!==Is;){var S=Is.effectTag;if(36&S&&as(x,Is.alternate,Is),128&S){_=void 0;var E=Is.ref;if(null!==E){var M=Is.stateNode;switch(Is.tag){case 5:_=M;break;default:_=M}"function"==typeof E?E(_):E.current=_}}Is=Is.nextEffect}}catch(t){if(null===Is)throw Error(o(330));yl(Is,t),Is=Is.nextEffect}}while(null!==Is);Is=null,Li(),Ss=a}else t.current=n;if(Bs)Bs=!1,Vs=t,js=e;else for(Is=i;null!==Is;)e=Is.nextEffect,Is.nextEffect=null,Is=e;if(0===(e=t.firstPendingTime)&&(Fs=null),1073741823===e?t===Gs?Us++:(Us=0,Gs=t):Us=0,"function"==typeof _l&&_l(n.stateNode,r),Zs(t),Ds)throw Ds=!1,t=zs,zs=null,t;return 0!=(8&Ss)||qi(),null}function pl(){for(;null!==Is;){var t=Is.effectTag;0!=(256&t)&&ns(Is.alternate,Is),0==(512&t)||Bs||(Bs=!0,Ui(97,(function(){return ml(),null}))),Is=Is.nextEffect}}function ml(){if(90!==js){var t=97<js?97:js;return js=90,Hi(t,gl)}}function gl(){if(null===Vs)return!1;var t=Vs;if(Vs=null,0!=(48&Ss))throw Error(o(331));var e=Ss;for(Ss|=32,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:rs(5,n),is(5,n)}}catch(e){if(null===t)throw Error(o(330));yl(t,e)}n=t.nextEffect,t.nextEffect=null,t=n}return Ss=e,qi(),!0}function vl(t,e,n){la(t,e=ps(t,e=Jo(n,e),1073741823)),null!==(t=Qs(t,1073741823))&&Zs(t)}function yl(t,e){if(3===t.tag)vl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){vl(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Fs||!Fs.has(r))){la(n,t=ms(n,t=Jo(e,t),1073741823)),null!==(n=Qs(n,1073741823))&&Zs(n);break}}n=n.return}}function bl(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),Es===t&&Cs===n?Ts===ws||Ts===_s&&1073741823===Ps&&Bi()-Ls<500?nl(t,Cs):Rs=!0:Nl(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,Zs(t)))}function xl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=$s(e=Ws(),t,null)),null!==(t=Qs(t,e))&&Zs(t)}gs=function(t,e,n){var r=e.expirationTime;if(null!==t){var i=e.pendingProps;if(t.memoizedProps!==i||di.current)Ao=!0;else{if(r<n){switch(Ao=!1,e.tag){case 3:Bo(e),ko();break;case 5:if(Ra(e),4&e.mode&&1!==n&&i.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:mi(e.type)&&bi(e);break;case 4:Oa(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value,i=e.type._context,ui(Qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?Go(t,e,n):(ui(Ia,1&Ia.current),null!==(e=Yo(t,e,n))?e.sibling:null);ui(Ia,1&Ia.current);break;case 19:if(r=e.childExpirationTime>=n,0!=(64&t.effectTag)){if(r)return $o(t,e,n);e.effectTag|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null),ui(Ia,Ia.current),!r)return null}return Yo(t,e,n)}Ao=!1}}else Ao=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,i=pi(e,hi.current),na(e,n),i=$a(null,e,r,t,i,n),e.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mi(r)){var a=!0;bi(e)}else a=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,aa(e);var s=r.getDerivedStateFromProps;"function"==typeof s&&pa(e,r,s,t),i.updater=ma,e.stateNode=i,i._reactInternalFiber=e,ba(e,r,t,n),e=Fo(null,e,r,!0,a,n)}else e.tag=0,Oo(null,e,i,n),e=e.child;return e;case 16:t:{if(i=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,e.type=i,a=e.tag=function(t){if("function"==typeof t)return Ml(t)?1:0;if(null!=t){if((t=t.$$typeof)===lt)return 11;if(t===ht)return 14}return 2}(i),t=Yi(i,t),a){case 0:e=Do(null,e,i,t,n);break t;case 1:e=zo(null,e,i,t,n);break t;case 11:e=No(null,e,i,t,n);break t;case 14:e=Ro(null,e,i,Yi(i.type,t),r,n);break t}throw Error(o(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,Do(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 1:return r=e.type,i=e.pendingProps,zo(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 3:if(Bo(e),r=e.updateQueue,null===t||null===r)throw Error(o(282));if(r=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,oa(t,e),ca(e,r,null,n),(r=e.memoizedState.element)===i)ko(),e=Yo(t,e,n);else{if((i=e.stateNode.hydrate)&&(_o=_n(e.stateNode.containerInfo.firstChild),xo=e,i=wo=!0),i)for(n=Ma(e,null,r,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Oo(t,e,r,n),ko();e=e.child}return e;case 5:return Ra(e),null===t&&Mo(e),r=e.type,i=e.pendingProps,a=null!==t?t.memoizedProps:null,s=i.children,yn(r,i)?s=null:null!==a&&yn(r,a)&&(e.effectTag|=16),Io(t,e),4&e.mode&&1!==n&&i.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Oo(t,e,s,n),e=e.child),e;case 6:return null===t&&Mo(e),null;case 13:return Go(t,e,n);case 4:return Oa(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Ea(e,null,r,n):Oo(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,No(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 7:return Oo(t,e,e.pendingProps,n),e.child;case 8:case 12:return Oo(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value;var l=e.type._context;if(ui(Qi,l._currentValue),l._currentValue=a,null!==s)if(l=s.value,0===(a=zr(l,a)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,a):1073741823))){if(s.children===i.children&&!di.current){e=Yo(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){s=l.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!=(c.observedBits&a)){1===l.tag&&((c=sa(n,null)).tag=2,la(l,c)),l.expirationTime<n&&(l.expirationTime=n),null!==(c=l.alternate)&&c.expirationTime<n&&(c.expirationTime=n),ea(l.return,n),u.expirationTime<n&&(u.expirationTime=n);break}c=c.next}}else s=10===l.tag&&l.type===e.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===e){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Oo(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(a=e.pendingProps).children,na(e,n),r=r(i=ra(i,a.unstable_observedBits)),e.effectTag|=1,Oo(t,e,r,n),e.child;case 14:return a=Yi(i=e.type,e.pendingProps),Ro(t,e,i,a=Yi(i.type,a),r,n);case 15:return Lo(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yi(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,mi(r)?(t=!0,bi(e)):t=!1,na(e,n),va(e,r,i),ba(e,r,i,n),Fo(null,e,r,!0,t,n);case 19:return $o(t,e,n)}throw Error(o(156,e.tag))};var _l=null,wl=null;function Sl(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function El(t,e,n,r){return new Sl(t,e,n,r)}function Ml(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Cl(t,e){var n=t.alternate;return null===n?((n=El(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tl(t,e,n,r,i,a){var s=2;if(r=t,"function"==typeof t)Ml(t)&&(s=1);else if("string"==typeof t)s=5;else t:switch(t){case nt:return kl(n.children,i,a,e);case st:s=8,i|=7;break;case rt:s=8,i|=1;break;case it:return(t=El(12,n,e,8|i)).elementType=it,t.type=it,t.expirationTime=a,t;case ut:return(t=El(13,n,e,i)).type=ut,t.elementType=ut,t.expirationTime=a,t;case ct:return(t=El(19,n,e,i)).elementType=ct,t.expirationTime=a,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case at:s=10;break t;case ot:s=9;break t;case lt:s=11;break t;case ht:s=14;break t;case dt:s=16,r=null;break t;case ft:s=22;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=El(s,n,e,i)).elementType=t,e.type=r,e.expirationTime=a,e}function kl(t,e,n,r){return(t=El(7,t,r,e)).expirationTime=n,t}function Pl(t,e,n){return(t=El(6,t,null,e)).expirationTime=n,t}function Al(t,e,n){return(e=El(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ol(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Nl(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Rl(t,e){var n=t.firstSuspendedTime,r=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(r>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Ll(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Il(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function Dl(t,e,n,r){var i=e.current,a=Ws(),s=da.suspense;a=$s(a,i,s);t:if(n){e:{if(Kt(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(o(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(mi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(o(171))}if(1===n.tag){var u=n.type;if(mi(u)){n=yi(n,u,l);break t}}n=l}else n=ci;return null===e.context?e.context=n:e.pendingContext=n,(e=sa(a,s)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),la(i,e),Ys(i,a),a}function zl(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Fl(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function Bl(t,e){Fl(t,e),(t=t.alternate)&&Fl(t,e)}function Vl(t,e,n){var r=new Ol(t,e,n=null!=n&&!0===n.hydrate),i=El(3,null,null,2===e?7:1===e?3:0);r.current=i,i.stateNode=r,aa(i),t[Cn]=r.current,n&&0!==e&&function(t,e){var n=Jt(e);Ce.forEach((function(t){pe(t,e,n)})),Te.forEach((function(t){pe(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=r}function jl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Hl(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"==typeof i){var s=i;i=function(){var t=zl(o);s.call(t)}}Dl(e,o,t,i)}else{if(a=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new Vl(t,0,e?{hydrate:!0}:void 0)}(n,r),o=a._internalRoot,"function"==typeof i){var l=i;i=function(){var t=zl(o);l.call(t)}}el((function(){Dl(e,o,t,i)}))}return zl(o)}function Ul(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Gl(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!jl(e))throw Error(o(200));return Ul(t,e,null,n)}Vl.prototype.render=function(t){Dl(t,this._internalRoot,null,null)},Vl.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Dl(null,t,null,(function(){e[Cn]=null}))},me=function(t){if(13===t.tag){var e=$i(Ws(),150,100);Ys(t,e),Bl(t,e)}},ge=function(t){13===t.tag&&(Ys(t,3),Bl(t,3))},ve=function(t){if(13===t.tag){var e=Ws();Ys(t,e=$s(e,t,null)),Bl(t,e)}},k=function(t,e,n){switch(e){case"input":if(Mt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=An(r);if(!i)throw Error(o(90));_t(r),Mt(r,i)}}}break;case"textarea":Nt(t,n);break;case"select":null!=(e=n.value)&&Pt(t,!!n.multiple,e,!1)}},L=tl,I=function(t,e,n,r,i){var a=Ss;Ss|=4;try{return Hi(98,t.bind(null,e,n,r,i))}finally{0===(Ss=a)&&qi()}},D=function(){0==(49&Ss)&&(function(){if(null!==Hs){var t=Hs;Hs=null,t.forEach((function(t,e){Il(e,t),Zs(e)})),qi()}}(),ml())},z=function(t,e){var n=Ss;Ss|=2;try{return t(e)}finally{0===(Ss=n)&&qi()}};var ql,Wl,$l={Events:[kn,Pn,An,C,S,zn,function(t){ie(t,Dn)},N,R,Ze,se,ml,{current:!1}]};Wl=(ql={findFiberByHostInstance:Tn,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"}).findFiberByHostInstance,function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);_l=function(t){try{e.onCommitFiberRoot(n,t,void 0,64==(64&t.current.effectTag))}catch(t){}},wl=function(t){try{e.onCommitFiberUnmount(n,t)}catch(t){}}}catch(t){}}(i({},ql,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=ne(t))?null:t.stateNode},findFiberByHostInstance:function(t){return Wl?Wl(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null})),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$l,e.createPortal=Gl,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"==typeof t.render)throw Error(o(188));throw Error(o(268,Object.keys(t)))}return t=null===(t=ne(e))?null:t.stateNode},e.flushSync=function(t,e){if(0!=(48&Ss))throw Error(o(187));var n=Ss;Ss|=1;try{return Hi(99,t.bind(null,e))}finally{Ss=n,qi()}},e.hydrate=function(t,e,n){if(!jl(e))throw Error(o(200));return Hl(null,t,e,!0,n)},e.render=function(t,e,n){if(!jl(e))throw Error(o(200));return Hl(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!jl(t))throw Error(o(40));return!!t._reactRootContainer&&(el((function(){Hl(null,null,t,!1,(function(){t._reactRootContainer=null,t[Cn]=null}))})),!0)},e.unstable_batchedUpdates=tl,e.unstable_createPortal=function(t,e){return Gl(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!jl(n))throw Error(o(200));if(null==t||void 0===t._reactInternalFiber)throw Error(o(38));return Hl(t,e,n,!1,r)},e.version="16.13.1"},function(t,e,n){"use strict";t.exports=n(199)},function(t,e,n){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r,i,a,o,s;if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,u=null,c=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(t){throw setTimeout(c,0),t}},h=Date.now();e.unstable_now=function(){return Date.now()-h},r=function(t){null!==l?setTimeout(r,0,t):(l=t,setTimeout(c,0))},i=function(t,e){u=setTimeout(t,e)},a=function(){clearTimeout(u)},o=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var d=window.performance,f=window.Date,p=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var g=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof d&&"function"==typeof d.now)e.unstable_now=function(){return d.now()};else{var v=f.now();e.unstable_now=function(){return f.now()-v}}var y=!1,b=null,x=-1,_=5,w=0;o=function(){return e.unstable_now()>=w},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):_=0<t?Math.floor(1e3/t):5};var S=new MessageChannel,E=S.port2;S.port1.onmessage=function(){if(null!==b){var t=e.unstable_now();w=t+_;try{b(!0,t)?E.postMessage(null):(y=!1,b=null)}catch(t){throw E.postMessage(null),t}}else y=!1},r=function(t){b=t,y||(y=!0,E.postMessage(null))},i=function(t,n){x=p((function(){t(e.unstable_now())}),n)},a=function(){m(x),x=-1}}function M(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,i=t[r];if(!(void 0!==i&&0<k(i,e)))break t;t[r]=e,t[n]=i,n=r}}function C(t){return void 0===(t=t[0])?null:t}function T(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var a=2*(r+1)-1,o=t[a],s=a+1,l=t[s];if(void 0!==o&&0>k(o,n))void 0!==l&&0>k(l,o)?(t[r]=l,t[s]=n,r=s):(t[r]=o,t[a]=n,r=a);else{if(!(void 0!==l&&0>k(l,n)))break t;t[r]=l,t[s]=n,r=s}}}return e}return null}function k(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var P=[],A=[],O=1,N=null,R=3,L=!1,I=!1,D=!1;function z(t){for(var e=C(A);null!==e;){if(null===e.callback)T(A);else{if(!(e.startTime<=t))break;T(A),e.sortIndex=e.expirationTime,M(P,e)}e=C(A)}}function F(t){if(D=!1,z(t),!I)if(null!==C(P))I=!0,r(B);else{var e=C(A);null!==e&&i(F,e.startTime-t)}}function B(t,n){I=!1,D&&(D=!1,a()),L=!0;var r=R;try{for(z(n),N=C(P);null!==N&&(!(N.expirationTime>n)||t&&!o());){var s=N.callback;if(null!==s){N.callback=null,R=N.priorityLevel;var l=s(N.expirationTime<=n);n=e.unstable_now(),"function"==typeof l?N.callback=l:N===C(P)&&T(P),z(n)}else T(P);N=C(P)}if(null!==N)var u=!0;else{var c=C(A);null!==c&&i(F,c.startTime-n),u=!1}return u}finally{N=null,R=r,L=!1}}function V(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var j=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){I||L||(I=!0,r(B))},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return C(P)},e.unstable_next=function(t){switch(R){case 1:case 2:case 3:var e=3;break;default:e=R}var n=R;R=e;try{return t()}finally{R=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=j,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=R;R=t;try{return e()}finally{R=n}},e.unstable_scheduleCallback=function(t,n,o){var s=e.unstable_now();if("object"==typeof o&&null!==o){var l=o.delay;l="number"==typeof l&&0<l?s+l:s,o="number"==typeof o.timeout?o.timeout:V(t)}else o=V(t),l=s;return t={id:O++,callback:n,priorityLevel:t,startTime:l,expirationTime:o=l+o,sortIndex:-1},l>s?(t.sortIndex=l,M(A,t),null===C(P)&&t===C(A)&&(D?a():D=!0,i(F,l-s))):(t.sortIndex=o,M(P,t),I||L||(I=!0,r(B))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();z(t);var n=C(P);return n!==N&&null!==N&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<N.expirationTime||o()},e.unstable_wrapCallback=function(t){var e=R;return function(){var n=R;R=e;try{return t.apply(this,arguments)}finally{R=n}}}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(201),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return t.prototype.register=function(t){var e="ID_"+this._lastID++;return this._callbacks[e]=t,e},t.prototype.unregister=function(t){this._callbacks[t]||r(!1),delete this._callbacks[t]},t.prototype.waitFor=function(t){this._isDispatching||r(!1);for(var e=0;e<t.length;e++){var n=t[e];this._isPending[n]?this._isHandled[n]||r(!1):(this._callbacks[n]||r(!1),this._invokeCallback(n))}},t.prototype.dispatch=function(t){this._isDispatching&&r(!1),this._startDispatching(t);try{for(var e in this._callbacks)this._isPending[e]||this._invokeCallback(e)}finally{this._stopDispatching()}},t.prototype.isDispatching=function(){return this._isDispatching},t.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},t.prototype._startDispatching=function(t){for(var e in this._callbacks)this._isPending[e]=!1,this._isHandled[e]=!1;this._pendingPayload=t,this._isDispatching=!0},t.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},t}();t.exports=i},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i,a,o,s){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,a,o,s],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlphaPicker=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(0)),a=l(n(4)),o=n(5),s=l(n(330));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.AlphaPicker=function(t){var e=t.rgb,n=t.hsl,s=t.width,l=t.height,u=t.onChange,c=t.direction,h=t.style,d=t.renderers,f=t.pointer,p=t.className,m=void 0===p?"":p,g=(0,a.default)({default:{picker:{position:"relative",width:s,height:l},alpha:{radius:"2px",style:h}}});return i.default.createElement("div",{style:g.picker,className:"alpha-picker "+m},i.default.createElement(o.Alpha,r({},g.alpha,{rgb:e,hsl:n,pointer:f,renderers:d,onChange:u,direction:c})))};u.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:s.default},e.default=(0,o.ColorWrap)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flattenNames=void 0;var r=s(n(204)),i=s(n(56)),a=s(n(115)),o=s(n(18));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.flattenNames=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return(0,o.default)(e,(function(e){Array.isArray(e)?t(e).map((function(t){return n.push(t)})):(0,a.default)(e)?(0,i.default)(e,(function(t,e){!0===t&&n.push(e),n.push(e+"-"+t)})):(0,r.default)(e)&&n.push(e)})),n};e.default=l},function(t,e,n){var r=n(21),i=n(8),a=n(15);t.exports=function(t){return"string"==typeof t||!i(t)&&a(t)&&"[object String]"==r(t)}},function(t,e,n){var r=n(32),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=o.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,a=Object(e),o=r(e),s=o.length;s--;){var l=o[t?s:++i];if(!1===n(a[l],l,a))break}return e}}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(21),i=n(15);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(21),i=n(60),a=n(15),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&i(t.length)&&!!o[r(t)]}},function(t,e,n){var r=n(63),i=n(213),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(113)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(215),i=n(259),a=n(41),o=n(8),s=n(269);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?o(t)?i(t[0],t[1]):r(t):s(t)}},function(t,e,n){var r=n(216),i=n(258),a=n(126);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(42),i=n(118);t.exports=function(t,e,n,a){var o=n.length,s=o,l=!a;if(null==t)return!s;for(t=Object(t);o--;){var u=n[o];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var c=(u=n[o])[0],h=t[c],d=u[1];if(l&&u[2]){if(void 0===h&&!(c in t))return!1}else{var f=new r;if(a)var p=a(h,d,c,t,e,f);if(!(void 0===p?i(d,h,3,a,f):p))return!1}}return!0}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(44),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},function(t,e,n){var r=n(44);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(44);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(44);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(43);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(43),i=n(66),a=n(67);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(64),i=n(228),a=n(11),o=n(117),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,d=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||i(t))&&(r(t)?d:s).test(o(t))}},function(t,e,n){var r,i=n(229),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!a&&a in t}},function(t,e,n){var r=n(14)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(232),i=n(43),a=n(66);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},function(t,e,n){var r=n(233),i=n(234),a=n(235),o=n(236),s=n(237);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(45);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(45),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(45),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(45);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(46);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(46);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(46);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(46);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e,n){var r=n(42),i=n(119),a=n(249),o=n(252),s=n(47),l=n(8),u=n(40),c=n(59),h="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,f,p,m){var g=l(t),v=l(e),y=g?"[object Array]":s(t),b=v?"[object Array]":s(e),x=(y="[object Arguments]"==y?h:y)==h,_=(b="[object Arguments]"==b?h:b)==h,w=y==b;if(w&&u(t)){if(!u(e))return!1;g=!0,x=!1}if(w&&!x)return m||(m=new r),g||c(t)?i(t,e,n,f,p,m):a(t,e,y,n,f,p,m);if(!(1&n)){var S=x&&d.call(t,"__wrapped__"),E=_&&d.call(e,"__wrapped__");if(S||E){var M=S?t.value():t,C=E?e.value():e;return m||(m=new r),p(M,C,n,f,m)}}return!!w&&(m||(m=new r),o(t,e,n,f,p,m))}},function(t,e,n){var r=n(67),i=n(245),a=n(246);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,t.exports=o},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){var r=n(32),i=n(120),a=n(34),o=n(119),s=n(250),l=n(251),u=r?r.prototype:void 0,c=u?u.valueOf:void 0;t.exports=function(t,e,n,r,u,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new i(t),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=s;case"[object Set]":var p=1&r;if(f||(f=l),t.size!=e.size&&!p)return!1;var m=d.get(t);if(m)return m==e;r|=2,d.set(t,e);var g=o(f(t),f(e),r,u,h,d);return d.delete(t),g;case"[object Symbol]":if(c)return c.call(t)==c.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},function(t,e,n){var r=n(121),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,o,s){var l=1&n,u=r(t),c=u.length;if(c!=r(e).length&&!l)return!1;for(var h=c;h--;){var d=u[h];if(!(l?d in e:i.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var g=l;++h<c;){var v=t[d=u[h]],y=e[d];if(a)var b=l?a(y,v,d,e,t,s):a(v,y,d,t,e,s);if(!(void 0===b?v===y||o(v,y,n,a,s):b)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var x=t.constructor,_=e.constructor;x==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof _&&_ instanceof _||(m=!1)}return s.delete(t),s.delete(e),m}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a}},function(t,e,n){var r=n(22)(n(14),"DataView");t.exports=r},function(t,e,n){var r=n(22)(n(14),"Promise");t.exports=r},function(t,e,n){var r=n(22)(n(14),"Set");t.exports=r},function(t,e,n){var r=n(22)(n(14),"WeakMap");t.exports=r},function(t,e,n){var r=n(125),i=n(33);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var a=e[n],o=t[a];e[n]=[a,o,r(o)]}return e}},function(t,e,n){var r=n(118),i=n(260),a=n(266),o=n(69),s=n(125),l=n(126),u=n(49);t.exports=function(t,e){return o(t)&&s(e)?l(u(t),e):function(n){var o=i(n,t);return void 0===o&&o===e?a(n,t):r(e,o,3)}}},function(t,e,n){var r=n(127);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},function(t,e,n){var r=n(262),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(a,"$1"):n||t)})),e}));t.exports=o},function(t,e,n){var r=n(263);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(67);function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},function(t,e,n){var r=n(265);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(32),i=n(116),a=n(8),o=n(48),s=r?r.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return i(e,t)+"";if(o(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e,n){var r=n(267),i=n(268);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(128),i=n(57),a=n(8),o=n(58),s=n(60),l=n(49);t.exports=function(t,e,n){for(var u=-1,c=(e=r(e,t)).length,h=!1;++u<c;){var d=l(e[u]);if(!(h=null!=t&&n(t,d)))break;t=t[d]}return h||++u!=c?h:!!(c=null==t?0:t.length)&&s(c)&&o(d,c)&&(a(t)||i(t))}},function(t,e,n){var r=n(270),i=n(271),a=n(69),o=n(49);t.exports=function(t){return a(t)?r(o(t)):i(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var r=n(127);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e,n){var r=n(129),i=n(27);t.exports=function(t,e){var n=-1,a=i(t)?Array(t.length):[];return r(t,(function(t,r,i){a[++n]=e(t,r,i)})),a}},function(t,e,n){var r=n(27);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var a=n.length,o=e?a:-1,s=Object(n);(e?o--:++o<a)&&!1!==i(s[o],o,s););return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeClasses=void 0;var r=o(n(56)),i=o(n(275)),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function o(t){return t&&t.__esModule?t:{default:t}}var s=e.mergeClasses=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.default&&(0,i.default)(t.default)||{};return e.map((function(e){var i=t[e];return i&&(0,r.default)(i,(function(t,e){n[e]||(n[e]={}),n[e]=a({},n[e],i[e])})),e})),n};e.default=s},function(t,e,n){var r=n(276);t.exports=function(t){return r(t,5)}},function(t,e,n){var r=n(42),i=n(130),a=n(131),o=n(277),s=n(278),l=n(133),u=n(134),c=n(281),h=n(282),d=n(121),f=n(283),p=n(47),m=n(284),g=n(285),v=n(137),y=n(8),b=n(40),x=n(290),_=n(11),w=n(292),S=n(33),E=n(36),M={};M["[object Arguments]"]=M["[object Array]"]=M["[object ArrayBuffer]"]=M["[object DataView]"]=M["[object Boolean]"]=M["[object Date]"]=M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Map]"]=M["[object Number]"]=M["[object Object]"]=M["[object RegExp]"]=M["[object Set]"]=M["[object String]"]=M["[object Symbol]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M["[object Error]"]=M["[object Function]"]=M["[object WeakMap]"]=!1,t.exports=function t(e,n,C,T,k,P){var A,O=1&n,N=2&n,R=4&n;if(C&&(A=k?C(e,T,k,P):C(e)),void 0!==A)return A;if(!_(e))return e;var L=y(e);if(L){if(A=m(e),!O)return u(e,A)}else{var I=p(e),D="[object Function]"==I||"[object GeneratorFunction]"==I;if(b(e))return l(e,O);if("[object Object]"==I||"[object Arguments]"==I||D&&!k){if(A=N||D?{}:v(e),!O)return N?h(e,s(A,e)):c(e,o(A,e))}else{if(!M[I])return k?e:{};A=g(e,I,O)}}P||(P=new r);var z=P.get(e);if(z)return z;P.set(e,A),w(e)?e.forEach((function(r){A.add(t(r,n,C,r,e,P))})):x(e)&&e.forEach((function(r,i){A.set(i,t(r,n,C,i,e,P))}));var F=L?void 0:(R?N?f:d:N?E:S)(e);return i(F||e,(function(r,i){F&&(r=e[i=r]),a(A,i,t(r,n,C,i,e,P))})),A}},function(t,e,n){var r=n(35),i=n(33);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(35),i=n(36);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(11),i=n(63),a=n(280),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return a(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(35),i=n(68);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(35),i=n(135);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(122),i=n(135),a=n(36);t.exports=function(t){return r(t,a,i)}},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(71),i=n(286),a=n(287),o=n(288),s=n(136);t.exports=function(t,e,n){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return a(t);case"[object Set]":return new l;case"[object Symbol]":return o(t)}}},function(t,e,n){var r=n(71);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(32),i=r?r.prototype:void 0,a=i?i.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},function(t,e,n){var r=n(11),i=Object.create,a=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=a},function(t,e,n){var r=n(291),i=n(61),a=n(62),o=a&&a.isMap,s=o?i(o):r;t.exports=s},function(t,e,n){var r=n(47),i=n(15);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},function(t,e,n){var r=n(293),i=n(61),a=n(62),o=a&&a.isSet,s=o?i(o):r;t.exports=s},function(t,e,n){var r=n(47),i=n(15);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.autoprefix=void 0;var r,i=n(56),a=(r=i)&&r.__esModule?r:{default:r},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var s={borderRadius:function(t){return{msBorderRadius:t,MozBorderRadius:t,OBorderRadius:t,WebkitBorderRadius:t,borderRadius:t}},boxShadow:function(t){return{msBoxShadow:t,MozBoxShadow:t,OBoxShadow:t,WebkitBoxShadow:t,boxShadow:t}},userSelect:function(t){return{WebkitTouchCallout:t,KhtmlUserSelect:t,MozUserSelect:t,msUserSelect:t,WebkitUserSelect:t,userSelect:t}},flex:function(t){return{WebkitBoxFlex:t,MozBoxFlex:t,WebkitFlex:t,msFlex:t,flex:t}},flexBasis:function(t){return{WebkitFlexBasis:t,flexBasis:t}},justifyContent:function(t){return{WebkitJustifyContent:t,justifyContent:t}},transition:function(t){return{msTransition:t,MozTransition:t,OTransition:t,WebkitTransition:t,transition:t}},transform:function(t){return{msTransform:t,MozTransform:t,OTransform:t,WebkitTransform:t,transform:t}},absolute:function(t){var e=t&&t.split(" ");return{position:"absolute",top:e&&e[0],right:e&&e[1],bottom:e&&e[2],left:e&&e[3]}},extend:function(t,e){var n=e[t];return n||{extend:t}}},l=e.autoprefix=function(t){var e={};return(0,a.default)(t,(function(t,n){var r={};(0,a.default)(t,(function(t,e){var n=s[e];n?r=o({},r,n(t)):r[e]=t})),e[n]=r})),e};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hover=void 0;var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(0),o=(r=a)&&r.__esModule?r:{default:r};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=e.hover=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var n,a,u;s(this,r);for(var c=arguments.length,h=Array(c),d=0;d<c;d++)h[d]=arguments[d];return a=u=l(this,(n=r.__proto__||Object.getPrototypeOf(r)).call.apply(n,[this].concat(h))),u.state={hover:!1},u.handleMouseOver=function(){return u.setState({hover:!0})},u.handleMouseOut=function(){return u.setState({hover:!1})},u.render=function(){return o.default.createElement(e,{onMouseOver:u.handleMouseOver,onMouseOut:u.handleMouseOut},o.default.createElement(t,i({},u.props,u.state)))},l(u,a)}return u(r,n),r}(o.default.Component)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.active=void 0;var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(0),o=(r=a)&&r.__esModule?r:{default:r};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=e.active=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var n,a,u;s(this,r);for(var c=arguments.length,h=Array(c),d=0;d<c;d++)h[d]=arguments[d];return a=u=l(this,(n=r.__proto__||Object.getPrototypeOf(r)).call.apply(n,[this].concat(h))),u.state={active:!1},u.handleMouseDown=function(){return u.setState({active:!0})},u.handleMouseUp=function(){return u.setState({active:!1})},u.render=function(){return o.default.createElement(e,{onMouseDown:u.handleMouseDown,onMouseUp:u.handleMouseUp},o.default.createElement(t,i({},u.props,u.state)))},l(u,a)}return u(r,n),r}(o.default.Component)};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){var n={},r=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n[t]=e};return 0===t&&r("first-child"),t===e-1&&r("last-child"),(0===t||t%2==0)&&r("even"),1===Math.abs(t%2)&&r("odd"),r("nth-child",t),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Alpha=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),o=c(a),s=c(n(4)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(299)),u=c(n(72));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var f=e.Alpha=function(t){function e(){var t,n,r;h(this,e);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=d(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),r.handleChange=function(t){var e=l.calculateChange(t,r.props.hsl,r.props.direction,r.props.a,r.container);e&&"function"==typeof r.props.onChange&&r.props.onChange(e,t)},r.handleMouseDown=function(t){r.handleChange(t),window.addEventListener("mousemove",r.handleChange),window.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},r.unbindEventListeners=function(){window.removeEventListener("mousemove",r.handleChange),window.removeEventListener("mouseup",r.handleMouseUp)},d(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var t=this,e=this.props.rgb,n=(0,s.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+e.r+","+e.g+","+e.b+", 0) 0%,\n           rgba("+e.r+","+e.g+","+e.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:100*e.a+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+e.r+","+e.g+","+e.b+", 0) 0%,\n           rgba("+e.r+","+e.g+","+e.b+", 1) 100%)"},pointer:{left:0,top:100*e.a+"%"}},overwrite:r({},this.props.style)},{vertical:"vertical"===this.props.direction,overwrite:!0});return o.default.createElement("div",{style:n.alpha},o.default.createElement("div",{style:n.checkboard},o.default.createElement(u.default,{renderers:this.props.renderers})),o.default.createElement("div",{style:n.gradient}),o.default.createElement("div",{style:n.container,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},o.default.createElement("div",{style:n.pointer},this.props.pointer?o.default.createElement(this.props.pointer,this.props):o.default.createElement("div",{style:n.slider}))))}}]),e}(a.PureComponent||a.Component);e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n,r,i){var a=i.clientWidth,o=i.clientHeight,s="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,l="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,u=s-(i.getBoundingClientRect().left+window.pageXOffset),c=l-(i.getBoundingClientRect().top+window.pageYOffset);if("vertical"===n){var h=void 0;if(h=c<0?0:c>o?1:Math.round(100*c/o)/100,e.a!==h)return{h:e.h,s:e.s,l:e.l,a:h,source:"rgb"}}else{var d=void 0;if(r!==(d=u<0?0:u>a?1:Math.round(100*u/a)/100))return{h:e.h,s:e.s,l:e.l,a:d,source:"rgb"}}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={},i=e.render=function(t,e,n,r){if("undefined"==typeof document&&!r)return null;var i=r?new r:document.createElement("canvas");i.width=2*n,i.height=2*n;var a=i.getContext("2d");return a?(a.fillStyle=t,a.fillRect(0,0,i.width,i.height),a.fillStyle=e,a.fillRect(0,0,n,n),a.translate(n,n),a.fillRect(0,0,n,n),i.toDataURL()):null};e.get=function(t,e,n,a){var o=t+"-"+e+"-"+n+(a?"-server":"");if(r[o])return r[o];var s=i(t,e,n,a);return r[o]=s,s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditableInput=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=s(i),o=s(n(4));function s(t){return t&&t.__esModule?t:{default:t}}var l=[38,40],u=e.EditableInput=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(t){n.setUpdatedValue(t.target.value,t)},n.handleKeyDown=function(t){var e,r=function(t){return Number(String(t).replace(/%/g,""))}(t.target.value);if(!isNaN(r)&&(e=t.keyCode,l.indexOf(e)>-1)){var i=n.getArrowOffset(),a=38===t.keyCode?r+i:r-i;n.setUpdatedValue(a,t)}},n.handleDrag=function(t){if(n.props.dragLabel){var e=Math.round(n.props.value+t.movementX);e>=0&&e<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(e),t)}},n.handleMouseDown=function(t){n.props.dragLabel&&(t.preventDefault(),n.handleDrag(t),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(t.value).toUpperCase(),blurValue:String(t.value).toUpperCase()},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentDidUpdate",value:function(t,e){this.props.value===this.state.value||t.value===this.props.value&&e.value===this.state.value||(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(t){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},this.props.label,t)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||1}},{key:"setUpdatedValue",value:function(t,e){var n=this.props.label?this.getValueObjectWithLabel(t):t;this.props.onChange&&this.props.onChange(n,e),this.setState({value:t})}},{key:"render",value:function(){var t=this,e=(0,o.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return a.default.createElement("div",{style:e.wrap},a.default.createElement("input",{style:e.input,ref:function(e){return t.input=e},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?a.default.createElement("span",{style:e.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e}(i.PureComponent||i.Component);e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Hue=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=l(i),o=l(n(4)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(303));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var h=e.Hue=function(t){function e(){var t,n,r;u(this,e);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),r.handleChange=function(t){var e=s.calculateChange(t,r.props.direction,r.props.hsl,r.container);e&&"function"==typeof r.props.onChange&&r.props.onChange(e,t)},r.handleMouseDown=function(t){r.handleChange(t),window.addEventListener("mousemove",r.handleChange),window.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var t=this,e=this.props.direction,n=void 0===e?"horizontal":e,r=(0,o.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:100*this.props.hsl.h/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-100*this.props.hsl.h/360+100+"%"}}},{vertical:"vertical"===n});return a.default.createElement("div",{style:r.hue},a.default.createElement("div",{className:"hue-"+n,style:r.container,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},a.default.createElement("style",null,"\n            .hue-horizontal {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n\n            .hue-vertical {\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          "),a.default.createElement("div",{style:r.pointer},this.props.pointer?a.default.createElement(this.props.pointer,this.props):a.default.createElement("div",{style:r.slider}))))}}]),e}(i.PureComponent||i.Component);e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n,r){var i=r.clientWidth,a=r.clientHeight,o="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,s="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,l=o-(r.getBoundingClientRect().left+window.pageXOffset),u=s-(r.getBoundingClientRect().top+window.pageYOffset);if("vertical"===e){var c=void 0;if(u<0)c=359;else if(u>a)c=0;else{c=360*(-100*u/a+100)/100}if(n.h!==c)return{h:c,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var h=void 0;if(l<0)h=0;else if(l>i)h=359;else{h=360*(100*l/i)/100}if(n.h!==h)return{h:h,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Raised=void 0;var r=s(n(0)),i=s(n(9)),a=s(n(4)),o=s(n(10));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.Raised=function(t){var e=t.zDepth,n=t.radius,i=t.background,s=t.children,l=t.styles,u=void 0===l?{}:l,c=(0,a.default)((0,o.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+e+"px "+4*e+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},u),{"zDepth-1":1===e});return r.default.createElement("div",{style:c.wrap},r.default.createElement("div",{style:c.bg}),r.default.createElement("div",{style:c.content},s))};l.propTypes={background:i.default.string,zDepth:i.default.oneOf([0,1,2,3,4,5]),radius:i.default.number,styles:i.default.object},l.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}},e.default=l},function(t,e,n){"use strict";var r=n(306);function i(){}function a(){}a.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){var r=n(42),i=n(138),a=n(111),o=n(308),s=n(11),l=n(36),u=n(139);t.exports=function t(e,n,c,h,d){e!==n&&a(n,(function(a,l){if(d||(d=new r),s(a))o(e,n,l,c,t,h,d);else{var f=h?h(u(e,l),a,l+"",e,n,d):void 0;void 0===f&&(f=a),i(e,l,f)}}),l)}},function(t,e,n){var r=n(138),i=n(133),a=n(136),o=n(134),s=n(137),l=n(57),u=n(8),c=n(309),h=n(40),d=n(64),f=n(11),p=n(115),m=n(59),g=n(139),v=n(310);t.exports=function(t,e,n,y,b,x,_){var w=g(t,n),S=g(e,n),E=_.get(S);if(E)r(t,n,E);else{var M=x?x(w,S,n+"",t,e,_):void 0,C=void 0===M;if(C){var T=u(S),k=!T&&h(S),P=!T&&!k&&m(S);M=S,T||k||P?u(w)?M=w:c(w)?M=o(w):k?(C=!1,M=i(S,!0)):P?(C=!1,M=a(S,!0)):M=[]:p(S)||l(S)?(M=w,l(w)?M=v(w):f(w)&&!d(w)||(M=s(S))):C=!1}C&&(_.set(S,M),b(M,S,y,x,_),_.delete(S)),r(t,n,M)}}},function(t,e,n){var r=n(27),i=n(15);t.exports=function(t){return i(t)&&r(t)}},function(t,e,n){var r=n(35),i=n(36);t.exports=function(t){return r(t,i(t))}},function(t,e,n){var r=n(312),i=n(319);t.exports=function(t){return r((function(e,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&i(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++r<a;){var l=n[r];l&&t(e,l,r,o)}return e}))}},function(t,e,n){var r=n(41),i=n(313),a=n(315);t.exports=function(t,e){return a(i(t,e,r),t+"")}},function(t,e,n){var r=n(314),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=i(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=a[o];return u[e]=n(l),r(t,this,u)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(316),i=n(318)(r);t.exports=i},function(t,e,n){var r=n(317),i=n(132),a=n(41),o=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:a;t.exports=o},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,r=0;return function(){var i=n(),a=16-(i-r);if(r=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(34),i=n(27),a=n(58),o=n(11);t.exports=function(t,e,n){if(!o(n))return!1;var s=typeof e;return!!("number"==s?i(n)&&a(e,n.length):"string"==s&&e in n)&&r(n[e],t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Saturation=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=u(i),o=u(n(4)),s=u(n(321)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(324));function u(t){return t&&t.__esModule?t:{default:t}}var c=e.Saturation=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.handleChange=function(t){"function"==typeof n.props.onChange&&n.throttle(n.props.onChange,l.calculateChange(t,n.props.hsl,n.container),t)},n.handleMouseDown=function(t){n.handleChange(t),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=(0,s.default)((function(t,e,n){t(e,n)}),50),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var t=this,e=this.props.style||{},n=e.color,r=e.white,i=e.black,s=e.pointer,l=e.circle,u=(0,o.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-100*this.props.hsv.v+100+"%",left:100*this.props.hsv.s+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:"0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\n            0 0 1px 2px rgba(0,0,0,.4)",borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:n,white:r,black:i,pointer:s,circle:l}},{custom:!!this.props.style});return a.default.createElement("div",{style:u.color,ref:function(e){return t.container=e},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},a.default.createElement("style",null,"\n          .saturation-white {\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n          }\n          .saturation-black {\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\n          }\n        "),a.default.createElement("div",{style:u.white,className:"saturation-white"},a.default.createElement("div",{style:u.black,className:"saturation-black"}),a.default.createElement("div",{style:u.pointer},this.props.pointer?a.default.createElement(this.props.pointer,this.props):a.default.createElement("div",{style:u.circle}))))}}]),e}(i.PureComponent||i.Component);e.default=c},function(t,e,n){var r=n(140),i=n(11);t.exports=function(t,e,n){var a=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return i(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),r(t,e,{leading:a,maxWait:e,trailing:o})}},function(t,e,n){var r=n(14);t.exports=function(){return r.Date.now()}},function(t,e,n){var r=n(11),i=n(48),a=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return NaN;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=s.test(t);return n||l.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.calculateChange=function(t,e,n){var r=n.getBoundingClientRect(),i=r.width,a=r.height,o="number"==typeof t.pageX?t.pageX:t.touches[0].pageX,s="number"==typeof t.pageY?t.pageY:t.touches[0].pageY,l=o-(n.getBoundingClientRect().left+window.pageXOffset),u=s-(n.getBoundingClientRect().top+window.pageYOffset);l<0?l=0:l>i&&(l=i),u<0?u=0:u>a&&(u=a);var c=l/i,h=1-u/a;return{h:e.h,s:c,v:h,a:e.a,source:"hsv"}}},function(t,e,n){t.exports=n(326)},function(t,e,n){var r=n(130),i=n(129),a=n(114),o=n(8);t.exports=function(t,e){return(o(t)?r:i)(t,a(e))}},function(t,e,n){var r;!function(i){var a=/^\s+/,o=/\s+$/,s=0,l=i.round,u=i.min,c=i.max,h=i.random;function d(t,e){if(e=e||{},(t=t||"")instanceof d)return t;if(!(this instanceof d))return new d(t,e);var n=function(t){var e={r:0,g:0,b:0},n=1,r=null,s=null,l=null,h=!1,d=!1;"string"==typeof t&&(t=function(t){t=t.replace(a,"").replace(o,"").toLowerCase();var e,n=!1;if(A[t])t=A[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=U.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=U.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=U.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=U.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=U.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=U.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=U.hex8.exec(t))return{r:I(e[1]),g:I(e[2]),b:I(e[3]),a:B(e[4]),format:n?"name":"hex8"};if(e=U.hex6.exec(t))return{r:I(e[1]),g:I(e[2]),b:I(e[3]),format:n?"name":"hex"};if(e=U.hex4.exec(t))return{r:I(e[1]+""+e[1]),g:I(e[2]+""+e[2]),b:I(e[3]+""+e[3]),a:B(e[4]+""+e[4]),format:n?"name":"hex8"};if(e=U.hex3.exec(t))return{r:I(e[1]+""+e[1]),g:I(e[2]+""+e[2]),b:I(e[3]+""+e[3]),format:n?"name":"hex"};return!1}(t));"object"==typeof t&&(G(t.r)&&G(t.g)&&G(t.b)?(f=t.r,p=t.g,m=t.b,e={r:255*R(f,255),g:255*R(p,255),b:255*R(m,255)},h=!0,d="%"===String(t.r).substr(-1)?"prgb":"rgb"):G(t.h)&&G(t.s)&&G(t.v)?(r=z(t.s),s=z(t.v),e=function(t,e,n){t=6*R(t,360),e=R(e,100),n=R(n,100);var r=i.floor(t),a=t-r,o=n*(1-e),s=n*(1-a*e),l=n*(1-(1-a)*e),u=r%6;return{r:255*[n,s,o,o,l,n][u],g:255*[l,n,n,s,o,o][u],b:255*[o,o,l,n,n,s][u]}}(t.h,r,s),h=!0,d="hsv"):G(t.h)&&G(t.s)&&G(t.l)&&(r=z(t.s),l=z(t.l),e=function(t,e,n){var r,i,a;function o(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=R(t,360),e=R(e,100),n=R(n,100),0===e)r=i=a=n;else{var s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;r=o(l,s,t+1/3),i=o(l,s,t),a=o(l,s,t-1/3)}return{r:255*r,g:255*i,b:255*a}}(t.h,r,l),h=!0,d="hsl"),t.hasOwnProperty("a")&&(n=t.a));var f,p,m;return n=N(n),{ok:h,format:t.format||d,r:u(255,c(e.r,0)),g:u(255,c(e.g,0)),b:u(255,c(e.b,0)),a:n}}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=l(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=l(this._r)),this._g<1&&(this._g=l(this._g)),this._b<1&&(this._b=l(this._b)),this._ok=n.ok,this._tc_id=s++}function f(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var r,i,a=c(t,e,n),o=u(t,e,n),s=(a+o)/2;if(a==o)r=i=0;else{var l=a-o;switch(i=s>.5?l/(2-a-o):l/(a+o),a){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,l:s}}function p(t,e,n){t=R(t,255),e=R(e,255),n=R(n,255);var r,i,a=c(t,e,n),o=u(t,e,n),s=a,l=a-o;if(i=0===a?0:l/a,a==o)r=0;else{switch(a){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,v:s}}function m(t,e,n,r){var i=[D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function g(t,e,n,r){return[D(F(r)),D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16))].join("")}function v(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s-=e/100,n.s=L(n.s),d(n)}function y(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s+=e/100,n.s=L(n.s),d(n)}function b(t){return d(t).desaturate(100)}function x(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l+=e/100,n.l=L(n.l),d(n)}function _(t,e){e=0===e?0:e||10;var n=d(t).toRgb();return n.r=c(0,u(255,n.r-l(-e/100*255))),n.g=c(0,u(255,n.g-l(-e/100*255))),n.b=c(0,u(255,n.b-l(-e/100*255))),d(n)}function w(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l-=e/100,n.l=L(n.l),d(n)}function S(t,e){var n=d(t).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,d(n)}function E(t){var e=d(t).toHsl();return e.h=(e.h+180)%360,d(e)}function M(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+120)%360,s:e.s,l:e.l}),d({h:(n+240)%360,s:e.s,l:e.l})]}function C(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+90)%360,s:e.s,l:e.l}),d({h:(n+180)%360,s:e.s,l:e.l}),d({h:(n+270)%360,s:e.s,l:e.l})]}function T(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+72)%360,s:e.s,l:e.l}),d({h:(n+216)%360,s:e.s,l:e.l})]}function k(t,e,n){e=e||6,n=n||30;var r=d(t).toHsl(),i=360/n,a=[d(t)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(d(r));return a}function P(t,e){e=e||6;for(var n=d(t).toHsv(),r=n.h,i=n.s,a=n.v,o=[],s=1/e;e--;)o.push(d({h:r,s:i,v:a})),a=(a+s)%1;return o}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,r=this.toRgb();return t=r.r/255,e=r.g/255,n=r.b/255,.2126*(t<=.03928?t/12.92:i.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:i.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:i.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=N(t),this._roundA=l(100*this._a)/100,this},toHsv:function(){var t=p(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=p(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),r=l(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+r+"%)":"hsva("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=f(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=f(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),r=l(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+r+"%)":"hsla("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return m(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,n,r,i){var a=[D(l(t).toString(16)),D(l(e).toString(16)),D(l(n).toString(16)),D(F(r))];if(i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1))return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0);return a.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:l(this._r),g:l(this._g),b:l(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+l(this._r)+", "+l(this._g)+", "+l(this._b)+")":"rgba("+l(this._r)+", "+l(this._g)+", "+l(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:l(100*R(this._r,255))+"%",g:l(100*R(this._g,255))+"%",b:l(100*R(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+l(100*R(this._r,255))+"%, "+l(100*R(this._g,255))+"%, "+l(100*R(this._b,255))+"%)":"rgba("+l(100*R(this._r,255))+"%, "+l(100*R(this._g,255))+"%, "+l(100*R(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(O[m(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+g(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=d(t);n="#"+g(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&this._a>=0;return e||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(x,arguments)},brighten:function(){return this._applyModification(_,arguments)},darken:function(){return this._applyModification(w,arguments)},desaturate:function(){return this._applyModification(v,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification(S,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(k,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(P,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(M,arguments)},tetrad:function(){return this._applyCombination(C,arguments)}},d.fromRatio=function(t,e){if("object"==typeof t){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]="a"===r?t[r]:z(t[r]));t=n}return d(t,e)},d.equals=function(t,e){return!(!t||!e)&&d(t).toRgbString()==d(e).toRgbString()},d.random=function(){return d.fromRatio({r:h(),g:h(),b:h()})},d.mix=function(t,e,n){n=0===n?0:n||50;var r=d(t).toRgb(),i=d(e).toRgb(),a=n/100;return d({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},d.readability=function(t,e){var n=d(t),r=d(e);return(i.max(n.getLuminance(),r.getLuminance())+.05)/(i.min(n.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(t,e,n){var r,i,a=d.readability(t,e);switch(i=!1,(r=function(t){var e,n;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==n&&"large"!==n&&(n="small");return{level:e,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=a>=4.5;break;case"AAlarge":i=a>=3;break;case"AAAsmall":i=a>=7}return i},d.mostReadable=function(t,e,n){var r,i,a,o,s=null,l=0;i=(n=n||{}).includeFallbackColors,a=n.level,o=n.size;for(var u=0;u<e.length;u++)(r=d.readability(t,e[u]))>l&&(l=r,s=d(e[u]));return d.isReadable(t,s,{level:a,size:o})||!i?s:(n.includeFallbackColors=!1,d.mostReadable(t,["#fff","#000"],n))};var A=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},O=d.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(A);function N(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function R(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=u(e,c(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),i.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function L(t){return u(1,c(0,t))}function I(t){return parseInt(t,16)}function D(t){return 1==t.length?"0"+t:""+t}function z(t){return t<=1&&(t=100*t+"%"),t}function F(t){return i.round(255*parseFloat(t)).toString(16)}function B(t){return I(t)/255}var V,j,H,U=(j="[\\s|\\(]+("+(V="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",H="[\\s|\\(]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",{CSS_UNIT:new RegExp(V),rgb:new RegExp("rgb"+j),rgba:new RegExp("rgba"+H),hsl:new RegExp("hsl"+j),hsla:new RegExp("hsla"+H),hsv:new RegExp("hsv"+j),hsva:new RegExp("hsva"+H),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function G(t){return!!U.CSS_UNIT.exec(t)}t.exports?t.exports=d:void 0===(r=function(){return d}.call(e,n,e,t))||(t.exports=r)}(Math)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Swatch=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(0)),a=l(n(4)),o=n(329),s=l(n(72));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Swatch=function(t){var e=t.color,n=t.style,o=t.onClick,l=void 0===o?function(){}:o,u=t.onHover,c=t.title,h=void 0===c?e:c,d=t.children,f=t.focus,p=t.focusStyle,m=void 0===p?{}:p,g="transparent"===e,v=(0,a.default)({default:{swatch:r({background:e,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,f?m:{})}}),y={};return u&&(y.onMouseOver=function(t){return u(e,t)}),i.default.createElement("div",r({style:v.swatch,onClick:function(t){return l(e,t)},title:h,tabIndex:0,onKeyDown:function(t){return 13===t.keyCode&&l(e,t)}},y),d,g&&i.default.createElement(s.default,{borderRadius:v.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};e.default=(0,o.handleFocus)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleFocus=void 0;var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),s=(r=o)&&r.__esModule?r:{default:r};function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.handleFocus=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var t,e,n;l(this,r);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n=u(this,(t=r.__proto__||Object.getPrototypeOf(r)).call.apply(t,[this].concat(a))),n.state={focus:!1},n.handleFocus=function(){return n.setState({focus:!0})},n.handleBlur=function(){return n.setState({focus:!1})},u(n,e)}return c(r,n),a(r,[{key:"render",value:function(){return s.default.createElement(e,{onFocus:this.handleFocus,onBlur:this.handleBlur},s.default.createElement(t,i({},this.props,this.state)))}}]),r}(s.default.Component)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlphaPointer=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.AlphaPointer=function(t){var e=t.direction,n=(0,i.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===e});return r.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Block=void 0;var r=c(n(0)),i=c(n(9)),a=c(n(4)),o=c(n(10)),s=c(n(17)),l=n(5),u=c(n(332));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Block=function(t){var e=t.onChange,n=t.onSwatchHover,i=t.hex,c=t.colors,h=t.width,d=t.triangle,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v="transparent"===i,y=function(t,n){s.default.isValidHex(t)&&e({hex:t,source:"hex"},n)},b=(0,a.default)((0,o.default)({default:{card:{width:h,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:s.default.getContrastingColor(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},p),{"hide-triangle":"hide"===d});return r.default.createElement("div",{style:b.card,className:"block-picker "+g},r.default.createElement("div",{style:b.triangle}),r.default.createElement("div",{style:b.head},v&&r.default.createElement(l.Checkboard,{borderRadius:"6px 6px 0 0"}),r.default.createElement("div",{style:b.label},i)),r.default.createElement("div",{style:b.body},r.default.createElement(u.default,{colors:c,onClick:y,onSwatchHover:n}),r.default.createElement(l.EditableInput,{style:{input:b.input},value:i,onChange:y})))};h.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),colors:i.default.arrayOf(i.default.string),triangle:i.default.oneOf(["top","hide"]),styles:i.default.object},h.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlockSwatches=void 0;var r=s(n(0)),i=s(n(4)),a=s(n(18)),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.BlockSwatches=function(t){var e=t.colors,n=t.onClick,s=t.onSwatchHover,l=(0,i.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return r.default.createElement("div",{style:l.swatches},(0,a.default)(e,(function(t){return r.default.createElement(o.Swatch,{key:t,color:t,style:l.swatch,onClick:n,onHover:s,focusStyle:{boxShadow:"0 0 4px "+t}})})),r.default.createElement("div",{style:l.clear}))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=void 0;var r=h(n(0)),i=h(n(9)),a=h(n(4)),o=h(n(18)),s=h(n(10)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(142)),u=n(5),c=h(n(334));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Circle=function(t){var e=t.width,n=t.onChange,i=t.onSwatchHover,l=t.colors,u=t.hex,h=t.circleSize,d=t.styles,f=void 0===d?{}:d,p=t.circleSpacing,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{card:{width:e,display:"flex",flexWrap:"wrap",marginRight:-p,marginBottom:-p}}},f)),y=function(t,e){return n({hex:t,source:"hex"},e)};return r.default.createElement("div",{style:v.card,className:"circle-picker "+g},(0,o.default)(l,(function(t){return r.default.createElement(c.default,{key:t,color:t,onClick:y,onSwatchHover:i,active:u===t.toLowerCase(),circleSize:h,circleSpacing:p})})))};d.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),circleSize:i.default.number,circleSpacing:i.default.number,styles:i.default.object},d.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[l.red[500],l.pink[500],l.purple[500],l.deepPurple[500],l.indigo[500],l.blue[500],l.lightBlue[500],l.cyan[500],l.teal[500],l.green[500],l.lightGreen[500],l.lime[500],l.yellow[500],l.amber[500],l.orange[500],l.deepOrange[500],l.brown[500],l.blueGrey[500]],styles:{}},e.default=(0,u.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CircleSwatch=void 0;var r=s(n(0)),i=n(4),a=s(i),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.CircleSwatch=function(t){var e=t.color,n=t.onClick,i=t.onSwatchHover,s=t.hover,l=t.active,u=t.circleSize,c=t.circleSpacing,h=(0,a.default)({default:{swatch:{width:u,height:u,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(u/2+1)+"px "+e,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+e}}},{hover:s,active:l});return r.default.createElement("div",{style:h.swatch},r.default.createElement(o.Swatch,{style:h.Swatch,color:e,onClick:n,onHover:i,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+e}}))};l.defaultProps={circleSize:28,circleSpacing:14},e.default=(0,i.handleHover)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome=void 0;var r=h(n(0)),i=h(n(9)),a=h(n(4)),o=h(n(10)),s=n(5),l=h(n(336)),u=h(n(339)),c=h(n(340));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Chrome=function(t){var e=t.width,n=t.onChange,i=t.disableAlpha,h=t.rgb,d=t.hsl,f=t.hsv,p=t.hex,m=t.renderers,g=t.styles,v=void 0===g?{}:g,y=t.className,b=void 0===y?"":y,x=t.defaultView,_=(0,a.default)((0,o.default)({default:{picker:{width:e,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+h.r+", "+h.g+", "+h.b+", "+h.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},v),{disableAlpha:i});return r.default.createElement("div",{style:_.picker,className:"chrome-picker "+b},r.default.createElement("div",{style:_.saturation},r.default.createElement(s.Saturation,{style:_.Saturation,hsl:d,hsv:f,pointer:c.default,onChange:n})),r.default.createElement("div",{style:_.body},r.default.createElement("div",{style:_.controls,className:"flexbox-fix"},r.default.createElement("div",{style:_.color},r.default.createElement("div",{style:_.swatch},r.default.createElement("div",{style:_.active}),r.default.createElement(s.Checkboard,{renderers:m}))),r.default.createElement("div",{style:_.toggles},r.default.createElement("div",{style:_.hue},r.default.createElement(s.Hue,{style:_.Hue,hsl:d,pointer:u.default,onChange:n})),r.default.createElement("div",{style:_.alpha},r.default.createElement(s.Alpha,{style:_.Alpha,rgb:h,hsl:d,pointer:u.default,renderers:m,onChange:n})))),r.default.createElement(l.default,{rgb:h,hsl:d,hex:p,view:x,onChange:n,disableAlpha:i})))};d.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),disableAlpha:i.default.bool,styles:i.default.object,defaultView:i.default.oneOf(["hex","rgb","hsl"])},d.defaultProps={width:225,disableAlpha:!1,styles:{}},e.default=(0,s.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromeFields=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=c(n(0)),a=c(n(4)),o=c(n(17)),s=c(n(337)),l=n(5),u=c(n(338));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.ChromeFields=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){"hex"===n.state.view?n.setState({view:"rgb"}):"rgb"===n.state.view?n.setState({view:"hsl"}):"hsl"===n.state.view&&(1===n.props.hsl.a?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(t,e){t.hex?o.default.isValidHex(t.hex)&&n.props.onChange({hex:t.hex,source:"hex"},e):t.r||t.g||t.b?n.props.onChange({r:t.r||n.props.rgb.r,g:t.g||n.props.rgb.g,b:t.b||n.props.rgb.b,source:"rgb"},e):t.a?(t.a<0?t.a=0:t.a>1&&(t.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(100*t.a)/100,source:"rgb"},e)):(t.h||t.s||t.l)&&("string"==typeof t.s&&t.s.includes("%")&&(t.s=t.s.replace("%","")),"string"==typeof t.l&&t.l.includes("%")&&(t.l=t.l.replace("%","")),1==t.s?t.s=.01:1==t.l&&(t.l=.01),n.props.onChange({h:t.h||n.props.hsl.h,s:Number((0,s.default)(t.s)?n.props.hsl.s:t.s),l:Number((0,s.default)(t.l)?n.props.hsl.l:t.l),source:"hsl"},e))},n.showHighlight=function(t){t.currentTarget.style.background="#eee"},n.hideHighlight=function(t){t.currentTarget.style.background="transparent"},1!==t.hsl.a&&"hex"===t.view?n.state={view:"rgb"}:n.state={view:t.view},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"render",value:function(){var t=this,e=(0,a.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),n=void 0;return"hex"===this.state.view?n=i.default.createElement("div",{style:e.fields,className:"flexbox-fix"},i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):"rgb"===this.state.view?n=i.default.createElement("div",{style:e.fields,className:"flexbox-fix"},i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),i.default.createElement("div",{style:e.alpha},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):"hsl"===this.state.view&&(n=i.default.createElement("div",{style:e.fields,className:"flexbox-fix"},i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"s",value:Math.round(100*this.props.hsl.s)+"%",onChange:this.handleChange})),i.default.createElement("div",{style:e.field},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"l",value:Math.round(100*this.props.hsl.l)+"%",onChange:this.handleChange})),i.default.createElement("div",{style:e.alpha},i.default.createElement(l.EditableInput,{style:{input:e.input,label:e.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),i.default.createElement("div",{style:e.wrap,className:"flexbox-fix"},n,i.default.createElement("div",{style:e.toggle},i.default.createElement("div",{style:e.icon,onClick:this.toggleViews,ref:function(e){return t.icon=e}},i.default.createElement(u.default,{style:e.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return 1!==t.hsl.a&&"hex"===e.view?{view:"rgb"}:null}}]),e}(i.default.Component);h.defaultProps={view:"hex"},e.default=h},function(t,e){t.exports=function(t){return void 0===t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(0),o=(r=a)&&r.__esModule?r:{default:r};e.default=function(t){var e=t.fill,n=void 0===e?"currentColor":e,r=t.width,a=void 0===r?24:r,s=t.height,l=void 0===s?24:s,u=t.style,c=void 0===u?{}:u,h=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["fill","width","height","style"]);return o.default.createElement("svg",i({viewBox:"0 0 24 24",style:i({fill:n,width:a,height:l},c)},h),o.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromePointer=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.ChromePointer=function(){var t=(0,i.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return r.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChromePointerCircle=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.ChromePointerCircle=function(){var t=(0,i.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return r.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Compact=void 0;var r=d(n(0)),i=d(n(9)),a=d(n(4)),o=d(n(18)),s=d(n(10)),l=d(n(17)),u=n(5),c=d(n(342)),h=d(n(343));function d(t){return t&&t.__esModule?t:{default:t}}var f=e.Compact=function(t){var e=t.onChange,n=t.onSwatchHover,i=t.colors,d=t.hex,f=t.rgb,p=t.styles,m=void 0===p?{}:p,g=t.className,v=void 0===g?"":g,y=(0,a.default)((0,s.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},m)),b=function(t,n){t.hex?l.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},n):e(t,n)};return r.default.createElement(u.Raised,{style:y.Compact,styles:m},r.default.createElement("div",{style:y.compact,className:"compact-picker "+v},r.default.createElement("div",null,(0,o.default)(i,(function(t){return r.default.createElement(c.default,{key:t,color:t,active:t.toLowerCase()===d,onClick:b,onSwatchHover:n})})),r.default.createElement("div",{style:y.clear})),r.default.createElement(h.default,{hex:d,rgb:f,onChange:b})))};f.propTypes={colors:i.default.arrayOf(i.default.string),styles:i.default.object},f.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}},e.default=(0,u.ColorWrap)(f)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompactColor=void 0;var r=s(n(0)),i=s(n(4)),a=s(n(17)),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.CompactColor=function(t){var e=t.color,n=t.onClick,s=void 0===n?function(){}:n,l=t.onSwatchHover,u=t.active,c=(0,i.default)({default:{color:{background:e,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:a.default.getContrastingColor(e),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:u,"color-#FFFFFF":"#FFFFFF"===e,transparent:"transparent"===e});return r.default.createElement(o.Swatch,{style:c.color,color:e,onClick:s,onHover:l,focusStyle:{boxShadow:"0 0 4px "+e}},r.default.createElement("div",{style:c.dot}))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CompactFields=void 0;var r=o(n(0)),i=o(n(4)),a=n(5);function o(t){return t&&t.__esModule?t:{default:t}}var s=e.CompactFields=function(t){var e=t.hex,n=t.rgb,o=t.onChange,s=(0,i.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:e},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),l=function(t,e){t.r||t.g||t.b?o({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,source:"rgb"},e):o({hex:t.hex,source:"hex"},e)};return r.default.createElement("div",{style:s.fields,className:"flexbox-fix"},r.default.createElement("div",{style:s.active}),r.default.createElement(a.EditableInput,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"hex",value:e,onChange:l}),r.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:l}),r.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:l}),r.default.createElement(a.EditableInput,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:l}))};e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Github=void 0;var r=c(n(0)),i=c(n(9)),a=c(n(4)),o=c(n(18)),s=c(n(10)),l=n(5),u=c(n(345));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Github=function(t){var e=t.width,n=t.colors,i=t.onChange,l=t.onSwatchHover,c=t.triangle,h=t.styles,d=void 0===h?{}:h,f=t.className,p=void 0===f?"":f,m=(0,a.default)((0,s.default)({default:{card:{width:e,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},d),{"hide-triangle":"hide"===c,"top-left-triangle":"top-left"===c,"top-right-triangle":"top-right"===c,"bottom-left-triangle":"bottom-left"===c,"bottom-right-triangle":"bottom-right"===c}),g=function(t,e){return i({hex:t,source:"hex"},e)};return r.default.createElement("div",{style:m.card,className:"github-picker "+p},r.default.createElement("div",{style:m.triangleShadow}),r.default.createElement("div",{style:m.triangle}),(0,o.default)(n,(function(t){return r.default.createElement(u.default,{color:t,key:t,onClick:g,onSwatchHover:l})})))};h.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),colors:i.default.arrayOf(i.default.string),triangle:i.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:i.default.object},h.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GithubSwatch=void 0;var r=s(n(0)),i=n(4),a=s(i),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.GithubSwatch=function(t){var e=t.hover,n=t.color,i=t.onClick,s=t.onSwatchHover,l={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},u=(0,a.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:l}},{hover:e});return r.default.createElement("div",{style:u.swatch},r.default.createElement(o.Swatch,{color:n,onClick:i,onHover:s,focusStyle:l}))};e.default=(0,i.handleHover)(l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HuePicker=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=c(n(0)),a=c(n(9)),o=c(n(4)),s=c(n(10)),l=n(5),u=c(n(347));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.HuePicker=function(t){var e=t.width,n=t.height,a=t.onChange,u=t.hsl,c=t.direction,h=t.pointer,d=t.styles,f=void 0===d?{}:d,p=t.className,m=void 0===p?"":p,g=(0,o.default)((0,s.default)({default:{picker:{position:"relative",width:e,height:n},hue:{radius:"2px"}}},f));return i.default.createElement("div",{style:g.picker,className:"hue-picker "+m},i.default.createElement(l.Hue,r({},g.hue,{hsl:u,pointer:h,onChange:function(t){return a({a:1,h:t.h,l:.5,s:1})},direction:c})))};h.propTypes={styles:a.default.object},h.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:u.default,styles:{}},e.default=(0,l.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderPointer=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderPointer=function(t){var e=t.direction,n=(0,i.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===e});return r.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;var r=l(n(0)),i=l(n(4)),a=l(n(10)),o=l(n(17)),s=n(5);function l(t){return t&&t.__esModule?t:{default:t}}var u=e.Material=function(t){var e=t.onChange,n=t.hex,l=t.rgb,u=t.styles,c=void 0===u?{}:u,h=t.className,d=void 0===h?"":h,f=(0,i.default)((0,a.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},c)),p=function(t,n){t.hex?o.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},n):(t.r||t.g||t.b)&&e({r:t.r||l.r,g:t.g||l.g,b:t.b||l.b,source:"rgb"},n)};return r.default.createElement(s.Raised,{styles:c},r.default.createElement("div",{style:f.material,className:"material-picker "+d},r.default.createElement(s.EditableInput,{style:{wrap:f.HEXwrap,input:f.HEXinput,label:f.HEXlabel},label:"hex",value:n,onChange:p}),r.default.createElement("div",{style:f.split,className:"flexbox-fix"},r.default.createElement("div",{style:f.third},r.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"r",value:l.r,onChange:p})),r.default.createElement("div",{style:f.third},r.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"g",value:l.g,onChange:p})),r.default.createElement("div",{style:f.third},r.default.createElement(s.EditableInput,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"b",value:l.b,onChange:p})))))};e.default=(0,s.ColorWrap)(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Photoshop=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=p(n(0)),a=p(n(9)),o=p(n(4)),s=p(n(10)),l=n(5),u=p(n(350)),c=p(n(351)),h=p(n(352)),d=p(n(353)),f=p(n(354));function p(t){return t&&t.__esModule?t:{default:t}}var m=e.Photoshop=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:t.hex},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"render",value:function(){var t=this.props,e=t.styles,n=void 0===e?{}:e,r=t.className,a=void 0===r?"":r,p=(0,o.default)((0,s.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},n));return i.default.createElement("div",{style:p.picker,className:"photoshop-picker "+a},i.default.createElement("div",{style:p.head},this.props.header),i.default.createElement("div",{style:p.body,className:"flexbox-fix"},i.default.createElement("div",{style:p.saturation},i.default.createElement(l.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:c.default,onChange:this.props.onChange})),i.default.createElement("div",{style:p.hue},i.default.createElement(l.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:h.default,onChange:this.props.onChange})),i.default.createElement("div",{style:p.controls},i.default.createElement("div",{style:p.top,className:"flexbox-fix"},i.default.createElement("div",{style:p.previews},i.default.createElement(f.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),i.default.createElement("div",{style:p.actions},i.default.createElement(d.default,{label:"OK",onClick:this.props.onAccept,active:!0}),i.default.createElement(d.default,{label:"Cancel",onClick:this.props.onCancel}),i.default.createElement(u.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e}(i.default.Component);m.propTypes={header:a.default.string,styles:a.default.object},m.defaultProps={header:"Color Picker",styles:{}},e.default=(0,l.ColorWrap)(m)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPicker=void 0;var r=s(n(0)),i=s(n(4)),a=s(n(17)),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.PhotoshopPicker=function(t){var e=t.onChange,n=t.rgb,s=t.hsv,l=t.hex,u=(0,i.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),c=function(t,r){t["#"]?a.default.isValidHex(t["#"])&&e({hex:t["#"],source:"hex"},r):t.r||t.g||t.b?e({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,source:"rgb"},r):(t.h||t.s||t.v)&&e({h:t.h||s.h,s:t.s||s.s,v:t.v||s.v,source:"hsv"},r)};return r.default.createElement("div",{style:u.fields},r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"h",value:Math.round(s.h),onChange:c}),r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"s",value:Math.round(100*s.s),onChange:c}),r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"v",value:Math.round(100*s.v),onChange:c}),r.default.createElement("div",{style:u.divider}),r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"r",value:n.r,onChange:c}),r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"g",value:n.g,onChange:c}),r.default.createElement(o.EditableInput,{style:{wrap:u.RGBwrap,input:u.RGBinput,label:u.RGBlabel},label:"b",value:n.b,onChange:c}),r.default.createElement("div",{style:u.divider}),r.default.createElement(o.EditableInput,{style:{wrap:u.HEXwrap,input:u.HEXinput,label:u.HEXlabel},label:"#",value:l.replace("#",""),onChange:c}),r.default.createElement("div",{style:u.fieldSymbols},r.default.createElement("div",{style:u.symbol},""),r.default.createElement("div",{style:u.symbol},"%"),r.default.createElement("div",{style:u.symbol},"%")))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPointerCircle=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPointerCircle=function(t){var e=t.hsl,n=(0,i.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":e.l>.5});return r.default.createElement("div",{style:n.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPointerCircle=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPointerCircle=function(){var t=(0,i.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return r.default.createElement("div",{style:t.pointer},r.default.createElement("div",{style:t.left},r.default.createElement("div",{style:t.leftInside})),r.default.createElement("div",{style:t.right},r.default.createElement("div",{style:t.rightInside})))};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopButton=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopButton=function(t){var e=t.onClick,n=t.label,a=t.children,o=t.active,s=(0,i.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:o});return r.default.createElement("div",{style:s.button,onClick:e},n||a)};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhotoshopPreviews=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.PhotoshopPreviews=function(t){var e=t.rgb,n=t.currentColor,a=(0,i.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+e.r+","+e.g+", "+e.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return r.default.createElement("div",null,r.default.createElement("div",{style:a.label},"new"),r.default.createElement("div",{style:a.swatches},r.default.createElement("div",{style:a.new}),r.default.createElement("div",{style:a.current})),r.default.createElement("div",{style:a.label},"current"))};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sketch=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=h(n(0)),a=h(n(9)),o=h(n(4)),s=h(n(10)),l=n(5),u=h(n(356)),c=h(n(357));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Sketch=function(t){var e=t.width,n=t.rgb,a=t.hex,h=t.hsv,d=t.hsl,f=t.onChange,p=t.onSwatchHover,m=t.disableAlpha,g=t.presetColors,v=t.renderers,y=t.styles,b=void 0===y?{}:y,x=t.className,_=void 0===x?"":x,w=(0,o.default)((0,s.default)({default:r({picker:{width:e,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},b),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},b),{disableAlpha:m});return i.default.createElement("div",{style:w.picker,className:"sketch-picker "+_},i.default.createElement("div",{style:w.saturation},i.default.createElement(l.Saturation,{style:w.Saturation,hsl:d,hsv:h,onChange:f})),i.default.createElement("div",{style:w.controls,className:"flexbox-fix"},i.default.createElement("div",{style:w.sliders},i.default.createElement("div",{style:w.hue},i.default.createElement(l.Hue,{style:w.Hue,hsl:d,onChange:f})),i.default.createElement("div",{style:w.alpha},i.default.createElement(l.Alpha,{style:w.Alpha,rgb:n,hsl:d,renderers:v,onChange:f}))),i.default.createElement("div",{style:w.color},i.default.createElement(l.Checkboard,null),i.default.createElement("div",{style:w.activeColor}))),i.default.createElement(u.default,{rgb:n,hsl:d,hex:a,onChange:f,disableAlpha:m}),i.default.createElement(c.default,{colors:g,onClick:f,onSwatchHover:p}))};d.propTypes={disableAlpha:a.default.bool,width:a.default.oneOfType([a.default.string,a.default.number]),styles:a.default.object},d.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},e.default=(0,l.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SketchFields=void 0;var r=s(n(0)),i=s(n(4)),a=s(n(17)),o=n(5);function s(t){return t&&t.__esModule?t:{default:t}}var l=e.SketchFields=function(t){var e=t.onChange,n=t.rgb,s=t.hsl,l=t.hex,u=t.disableAlpha,c=(0,i.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:u}),h=function(t,r){t.hex?a.default.isValidHex(t.hex)&&e({hex:t.hex,source:"hex"},r):t.r||t.g||t.b?e({r:t.r||n.r,g:t.g||n.g,b:t.b||n.b,a:n.a,source:"rgb"},r):t.a&&(t.a<0?t.a=0:t.a>100&&(t.a=100),t.a/=100,e({h:s.h,s:s.s,l:s.l,a:t.a,source:"rgb"},r))};return r.default.createElement("div",{style:c.fields,className:"flexbox-fix"},r.default.createElement("div",{style:c.double},r.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"hex",value:l.replace("#",""),onChange:h})),r.default.createElement("div",{style:c.single},r.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"r",value:n.r,onChange:h,dragLabel:"true",dragMax:"255"})),r.default.createElement("div",{style:c.single},r.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"g",value:n.g,onChange:h,dragLabel:"true",dragMax:"255"})),r.default.createElement("div",{style:c.single},r.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"b",value:n.b,onChange:h,dragLabel:"true",dragMax:"255"})),r.default.createElement("div",{style:c.alpha},r.default.createElement(o.EditableInput,{style:{input:c.input,label:c.label},label:"a",value:Math.round(100*n.a),onChange:h,dragLabel:"true",dragMax:"100"})))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SketchPresetColors=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(0)),a=l(n(9)),o=l(n(4)),s=n(5);function l(t){return t&&t.__esModule?t:{default:t}}var u=e.SketchPresetColors=function(t){var e=t.colors,n=t.onClick,a=void 0===n?function(){}:n,l=t.onSwatchHover,u=(0,o.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!e||!e.length}),c=function(t,e){a({hex:t,source:"hex"},e)};return i.default.createElement("div",{style:u.colors,className:"flexbox-fix"},e.map((function(t){var e="string"==typeof t?{color:t}:t,n=""+e.color+(e.title||"");return i.default.createElement("div",{key:n,style:u.swatchWrap},i.default.createElement(s.Swatch,r({},e,{style:u.swatch,onClick:c,onHover:l,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+e.color}})))})))};u.propTypes={colors:a.default.arrayOf(a.default.oneOfType([a.default.string,a.default.shape({color:a.default.string,title:a.default.string})])).isRequired},e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Slider=void 0;var r=c(n(0)),i=c(n(9)),a=c(n(4)),o=c(n(10)),s=n(5),l=c(n(359)),u=c(n(361));function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Slider=function(t){var e=t.hsl,n=t.onChange,i=t.pointer,u=t.styles,c=void 0===u?{}:u,h=t.className,d=void 0===h?"":h,f=(0,a.default)((0,o.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},c));return r.default.createElement("div",{style:f.wrap||{},className:"slider-picker "+d},r.default.createElement("div",{style:f.hue},r.default.createElement(s.Hue,{style:f.Hue,hsl:e,pointer:i,onChange:n})),r.default.createElement("div",{style:f.swatches},r.default.createElement(l.default,{hsl:e,onClick:n})))};h.propTypes={styles:i.default.object},h.defaultProps={pointer:u.default,styles:{}},e.default=(0,s.ColorWrap)(h)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderSwatches=void 0;var r=o(n(0)),i=o(n(4)),a=o(n(360));function o(t){return t&&t.__esModule?t:{default:t}}var s=e.SliderSwatches=function(t){var e=t.onClick,n=t.hsl,o=(0,i.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}});return r.default.createElement("div",{style:o.swatches},r.default.createElement("div",{style:o.swatch},r.default.createElement(a.default,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<.1&&Math.abs(n.s-.5)<.1,onClick:e,first:!0})),r.default.createElement("div",{style:o.swatch},r.default.createElement(a.default,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),r.default.createElement("div",{style:o.swatch},r.default.createElement(a.default,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),r.default.createElement("div",{style:o.swatch},r.default.createElement(a.default,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<.1&&Math.abs(n.s-.5)<.1,onClick:e})),r.default.createElement("div",{style:o.swatch},r.default.createElement(a.default,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<.1&&Math.abs(n.s-.5)<.1,onClick:e,last:!0})),r.default.createElement("div",{style:o.clear}))};e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderSwatch=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderSwatch=function(t){var e=t.hsl,n=t.offset,a=t.onClick,o=void 0===a?function(){}:a,s=t.active,l=t.first,u=t.last,c=(0,i.default)({default:{swatch:{height:"12px",background:"hsl("+e.h+", 50%, "+100*n+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:l,last:u});return r.default.createElement("div",{style:c.swatch,onClick:function(t){return o({h:e.h,s:.5,l:n,source:"hsl"},t)}})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliderPointer=void 0;var r=a(n(0)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=e.SliderPointer=function(){var t=(0,i.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return r.default.createElement("div",{style:t.picker})};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Swatches=void 0;var r=h(n(0)),i=h(n(9)),a=h(n(4)),o=h(n(18)),s=h(n(10)),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(142)),u=n(5),c=h(n(363));function h(t){return t&&t.__esModule?t:{default:t}}var d=e.Swatches=function(t){var e=t.width,n=t.height,i=t.onChange,l=t.onSwatchHover,h=t.colors,d=t.hex,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{picker:{width:e,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},p)),y=function(t,e){return i({hex:t,source:"hex"},e)};return r.default.createElement("div",{style:v.picker,className:"swatches-picker "+g},r.default.createElement(u.Raised,null,r.default.createElement("div",{style:v.overflow},r.default.createElement("div",{style:v.body},(0,o.default)(h,(function(t){return r.default.createElement(c.default,{key:t.toString(),group:t,active:d,onClick:y,onSwatchHover:l})})),r.default.createElement("div",{style:v.clear})))))};d.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),height:i.default.oneOfType([i.default.string,i.default.number]),colors:i.default.arrayOf(i.default.arrayOf(i.default.string)),styles:i.default.object},d.defaultProps={width:320,height:240,colors:[[l.red[900],l.red[700],l.red[500],l.red[300],l.red[100]],[l.pink[900],l.pink[700],l.pink[500],l.pink[300],l.pink[100]],[l.purple[900],l.purple[700],l.purple[500],l.purple[300],l.purple[100]],[l.deepPurple[900],l.deepPurple[700],l.deepPurple[500],l.deepPurple[300],l.deepPurple[100]],[l.indigo[900],l.indigo[700],l.indigo[500],l.indigo[300],l.indigo[100]],[l.blue[900],l.blue[700],l.blue[500],l.blue[300],l.blue[100]],[l.lightBlue[900],l.lightBlue[700],l.lightBlue[500],l.lightBlue[300],l.lightBlue[100]],[l.cyan[900],l.cyan[700],l.cyan[500],l.cyan[300],l.cyan[100]],[l.teal[900],l.teal[700],l.teal[500],l.teal[300],l.teal[100]],["#194D33",l.green[700],l.green[500],l.green[300],l.green[100]],[l.lightGreen[900],l.lightGreen[700],l.lightGreen[500],l.lightGreen[300],l.lightGreen[100]],[l.lime[900],l.lime[700],l.lime[500],l.lime[300],l.lime[100]],[l.yellow[900],l.yellow[700],l.yellow[500],l.yellow[300],l.yellow[100]],[l.amber[900],l.amber[700],l.amber[500],l.amber[300],l.amber[100]],[l.orange[900],l.orange[700],l.orange[500],l.orange[300],l.orange[100]],[l.deepOrange[900],l.deepOrange[700],l.deepOrange[500],l.deepOrange[300],l.deepOrange[100]],[l.brown[900],l.brown[700],l.brown[500],l.brown[300],l.brown[100]],[l.blueGrey[900],l.blueGrey[700],l.blueGrey[500],l.blueGrey[300],l.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}},e.default=(0,u.ColorWrap)(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwatchesGroup=void 0;var r=s(n(0)),i=s(n(4)),a=s(n(18)),o=s(n(364));function s(t){return t&&t.__esModule?t:{default:t}}var l=e.SwatchesGroup=function(t){var e=t.onClick,n=t.onSwatchHover,s=t.group,l=t.active,u=(0,i.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return r.default.createElement("div",{style:u.group},(0,a.default)(s,(function(t,i){return r.default.createElement(o.default,{key:t,color:t,active:t.toLowerCase()===l,first:0===i,last:i===s.length-1,onClick:e,onSwatchHover:n})})))};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwatchesColor=void 0;var r=l(n(0)),i=l(n(4)),a=l(n(17)),o=n(5),s=l(n(365));function l(t){return t&&t.__esModule?t:{default:t}}var u=e.SwatchesColor=function(t){var e=t.color,n=t.onClick,l=void 0===n?function(){}:n,u=t.onSwatchHover,c=t.first,h=t.last,d=t.active,f=(0,i.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:e,marginBottom:"1px"},check:{color:a.default.getContrastingColor(e),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:c,last:h,active:d,"color-#FFFFFF":"#FFFFFF"===e,transparent:"transparent"===e});return r.default.createElement(o.Swatch,{color:e,style:f.color,onClick:l,onHover:u,focusStyle:{boxShadow:"0 0 4px "+e}},r.default.createElement("div",{style:f.check},r.default.createElement(s.default,null)))};e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(0),o=(r=a)&&r.__esModule?r:{default:r};e.default=function(t){var e=t.fill,n=void 0===e?"currentColor":e,r=t.width,a=void 0===r?24:r,s=t.height,l=void 0===s?24:s,u=t.style,c=void 0===u?{}:u,h=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["fill","width","height","style"]);return o.default.createElement("svg",i({viewBox:"0 0 24 24",style:i({fill:n,width:a,height:l},c)},h),o.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Twitter=void 0;var r=c(n(0)),i=c(n(9)),a=c(n(4)),o=c(n(18)),s=c(n(10)),l=c(n(17)),u=n(5);function c(t){return t&&t.__esModule?t:{default:t}}var h=e.Twitter=function(t){var e=t.onChange,n=t.onSwatchHover,i=t.hex,c=t.colors,h=t.width,d=t.triangle,f=t.styles,p=void 0===f?{}:f,m=t.className,g=void 0===m?"":m,v=(0,a.default)((0,s.default)({default:{card:{width:h,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},p),{"hide-triangle":"hide"===d,"top-left-triangle":"top-left"===d,"top-right-triangle":"top-right"===d}),y=function(t,n){l.default.isValidHex(t)&&e({hex:t,source:"hex"},n)};return r.default.createElement("div",{style:v.card,className:"twitter-picker "+g},r.default.createElement("div",{style:v.triangleShadow}),r.default.createElement("div",{style:v.triangle}),r.default.createElement("div",{style:v.body},(0,o.default)(c,(function(t,e){return r.default.createElement(u.Swatch,{key:e,color:t,hex:t,style:v.swatch,onClick:y,onHover:n,focusStyle:{boxShadow:"0 0 4px "+t}})})),r.default.createElement("div",{style:v.hash},"#"),r.default.createElement(u.EditableInput,{label:null,style:{input:v.input},value:i.replace("#",""),onChange:y}),r.default.createElement("div",{style:v.clear})))};h.propTypes={width:i.default.oneOfType([i.default.string,i.default.number]),triangle:i.default.oneOf(["hide","top-left","top-right"]),colors:i.default.arrayOf(i.default.string),styles:i.default.object},h.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}},e.default=(0,u.ColorWrap)(h)},function(t,e,n){t.exports=function(t){"use strict";function e(t,e,n,r,i){return[t,e,n,r+"px",i].join(" ")}function n(t){return void 0===t}return function(r){function i(n){void 0===n&&(n={});var i=n.align;void 0===i&&(i="center");var a=n.anisotropy,o=n.createCanvas;void 0===o&&(o=function(){return document.createElement("canvas")});var s=n.fillStyle;void 0===s&&(s="#fff");var l=n.fontFamily;void 0===l&&(l="sans-serif");var u=n.fontSize;void 0===u&&(u=16);var c=n.fontStyle;void 0===c&&(c="normal");var h=n.fontVariant;void 0===h&&(h="normal");var d=n.fontWeight;void 0===d&&(d="normal");var f=n.format,p=n.lineGap;void 0===p&&(p=.15);var m=n.loadFontFace;void 0===m&&(m=function(t,n,r,i){var a=e(n,r,i,1,t);return document.fonts.load(a)});var g=n.magFilter;void 0===g&&(g=t.LinearFilter);var v=n.mapping,y=n.minFilter;void 0===y&&(y=t.LinearFilter);var b=n.padding;void 0===b&&(b=.25);var x=n.strokeStyle;void 0===x&&(x="#000");var _=n.strokeWidth;void 0===_&&(_=0);var w=n.text;void 0===w&&(w="");var S,E,M=n.type,C=n.wrapS,T=n.wrapT;r.call(this,o(),v,C,T,g,y,f,M,a),this._align=i,this._fillStyle=s,this._fontFamily=l,this._fontSize=u,this._fontStyle=c,this._fontVariant=h,this._fontWeight=d,this._lineGap=p,this._padding=b,this._strokeStyle=x,this._strokeWidth=_,this._text=w,this.createCanvas=o,this.loadFontFace=m,this.redraw=(S=this.redrawNow,function(){for(var t=this,e=[],n=arguments.length;n--;)e[n]=arguments[n];return E||(E=new Promise((function(t){setTimeout(t,0)})).then((function(){return S.apply(t,e)})).finally((function(){E=void 0}))),E}),this.redrawNow()}r&&(i.__proto__=r),i.prototype=Object.create(r&&r.prototype),i.prototype.constructor=i;var a={text:{configurable:!0},lines:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontWeight:{configurable:!0},fontVariant:{configurable:!0},fontStyle:{configurable:!0},font:{configurable:!0},fillStyle:{configurable:!0},strokeWidth:{configurable:!0},strokeWidthInPixels:{configurable:!0},strokeStyle:{configurable:!0},align:{configurable:!0},lineGap:{configurable:!0},lineGapInPixels:{configurable:!0},padding:{configurable:!0},paddingInPixels:{configurable:!0},textWidthInPixels:{configurable:!0},textHeight:{configurable:!0},textHeightInPixels:{configurable:!0},widthInPixels:{configurable:!0},height:{configurable:!0},heightInPixels:{configurable:!0}};return a.text.get=function(){return this._text},a.text.set=function(t){this._text!==t&&(this._text=t,this._lines=void 0,this._textWidthInPixels=void 0,this.redraw())},a.lines.get=function(){return n(this._lines)&&(this._lines=this.computeLines()),this._lines},i.prototype.computeLines=function(){var t=this.text;return t?t.split("\n"):[]},a.fontFamily.get=function(){return this._fontFamily},a.fontFamily.set=function(t){this._fontFamily!==t&&(this._fontFamily=t,this._textWidthInPixels=void 0,this.redraw())},a.fontSize.get=function(){return this._fontSize},a.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this._textWidthInPixels=void 0,this.redraw())},a.fontWeight.get=function(){return this._fontWeight},a.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this._textWidthInPixels=void 0,this.redraw())},a.fontVariant.get=function(){return this._fontVariant},a.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this._textWidthInPixels=void 0,this.redraw())},a.fontStyle.get=function(){return this._fontStyle},a.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this._textWidthInPixels=void 0,this.redraw())},a.font.get=function(){return e(this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily)},a.fillStyle.get=function(){return this._fillStyle},a.fillStyle.set=function(t){this._fillStyle!==t&&(this._fillStyle=t,this.redraw())},a.strokeWidth.get=function(){return this._strokeWidth},a.strokeWidth.set=function(t){this._strokeWidth!==t&&(this._strokeWidth=t,this.redraw())},a.strokeWidthInPixels.get=function(){return this._strokeWidth*this.fontSize},a.strokeStyle.get=function(){return this._strokeStyle},a.strokeStyle.set=function(t){this._strokeStyle!==t&&(this._strokeStyle=t,this.redraw())},a.align.get=function(){return this._align},a.align.set=function(t){this._align!==t&&(this._align=t,this.redraw())},a.lineGap.get=function(){return this._lineGap},a.lineGap.set=function(t){this._lineGap!==t&&(this._lineGap=t,this.redraw())},a.lineGapInPixels.get=function(){return this.fontSize*this.lineGap},a.padding.get=function(){return this._padding},a.padding.set=function(t){this._padding!==t&&(this._padding=t,this.redraw())},a.paddingInPixels.get=function(){return this.padding*this.fontSize},a.textWidthInPixels.get=function(){return n(this._textWidthInPixels)&&(this._textWidthInPixels=this.computeTextWidthInPixels()),this._textWidthInPixels},i.prototype.computeTextWidthInPixels=function(){var t=this.createCanvas,e=this.font,n=this.lines;if(n.length){var r=t().getContext("2d");return r.font=e,n.map((function(t){return r.measureText(t).width})).reduce((function(t,e){return Math.max(t,e)}))}return 0},a.textHeight.get=function(){var t=this.lineGap,e=this.lines;return e.length?e.length+t*(e.length-1):0},a.textHeightInPixels.get=function(){return this.textHeight*this.fontSize},a.widthInPixels.get=function(){return this.textWidthInPixels+this.strokeWidthInPixels+2*this.paddingInPixels},a.height.get=function(){return this.textHeight+this.strokeWidth+2*this.padding},a.heightInPixels.get=function(){return this.height*this.fontSize},i.prototype.redrawNow=function(){var t=this;return Promise.resolve().then((function(){return t.loadFontFace(t.fontFamily,t.fontStyle,t.fontVariant,t.fontWeight)})).then((function(){var e=t.image,n=e.getContext("2d");if(n.clearRect(0,0,e.width,e.height),t.widthInPixels&&t.heightInPixels){var r;switch(e.width=t.widthInPixels,e.height=t.heightInPixels,n.font=t.font,n.textBaseline="middle",t.align){case"left":n.textAlign="left",r=t.paddingInPixels+t.strokeWidthInPixels/2;break;case"right":n.textAlign="right",r=t.paddingInPixels+t.strokeWidthInPixels/2+t.textWidthInPixels;break;case"center":n.textAlign="center",r=t.paddingInPixels+t.strokeWidthInPixels/2+t.textWidthInPixels/2}var i=t.paddingInPixels+t.strokeWidthInPixels/2+t.fontSize/2;n.fillStyle=t.fillStyle,n.miterLimit=1,n.lineWidth=t.strokeWidthInPixels,n.strokeStyle=t.strokeStyle,t.lines.forEach((function(e){t.strokeWidthInPixels&&n.strokeText(e,r,i),n.fillText(e,r,i),i+=t.fontSize+t.lineGapInPixels}))}else e.width=e.height=1;t.needsUpdate=!0}))},Object.defineProperties(i.prototype,a),i}(t.Texture)}(n(1))},function(t,e){},function(t,e,n){"use strict";n.r(e),n.d(e,"Node",(function(){return rt})),n.d(e,"Parser",(function(){return V})),n.d(e,"Position",(function(){return L})),n.d(e,"SourceLocation",(function(){return I})),n.d(e,"TokContext",(function(){return ot})),n.d(e,"Token",(function(){return Pt})),n.d(e,"TokenType",(function(){return g})),n.d(e,"defaultOptions",(function(){return z})),n.d(e,"getLineInfo",(function(){return D})),n.d(e,"isIdentifierChar",(function(){return m})),n.d(e,"isIdentifierStart",(function(){return p})),n.d(e,"isNewLine",(function(){return M})),n.d(e,"keywordTypes",(function(){return x})),n.d(e,"lineBreak",(function(){return S})),n.d(e,"lineBreakG",(function(){return E})),n.d(e,"nonASCIIwhitespace",(function(){return C})),n.d(e,"parse",(function(){return Lt})),n.d(e,"parseExpressionAt",(function(){return It})),n.d(e,"tokContexts",(function(){return st})),n.d(e,"tokTypes",(function(){return w})),n.d(e,"tokenizer",(function(){return Dt})),n.d(e,"version",(function(){return Rt}));var r={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},i="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",a={5:i,"5module":i+" export import",6:i+" const class extends export import super"},o=/^in(stanceof)?$/,s="---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",l="--------------------------------------------------------------------------------------------------------------------------------------------------",u=new RegExp("["+s+"]"),c=new RegExp("["+s+l+"]");s=l=null;var h=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,155,22,13,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,0,33,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,0,161,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,754,9486,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],d=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,232,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,792487,239];function f(t,e){for(var n=65536,r=0;r<e.length;r+=2){if((n+=e[r])>t)return!1;if((n+=e[r+1])>=t)return!0}}function p(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&u.test(String.fromCharCode(t)):!1!==e&&f(t,h)))}function m(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):!1!==e&&(f(t,h)||f(t,d)))))}var g=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function v(t,e){return new g(t,{beforeExpr:!0,binop:e})}var y={beforeExpr:!0},b={startsExpr:!0},x={};function _(t,e){return void 0===e&&(e={}),e.keyword=t,x[t]=new g(t,e)}var w={num:new g("num",b),regexp:new g("regexp",b),string:new g("string",b),name:new g("name",b),eof:new g("eof"),bracketL:new g("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new g("]"),braceL:new g("{",{beforeExpr:!0,startsExpr:!0}),braceR:new g("}"),parenL:new g("(",{beforeExpr:!0,startsExpr:!0}),parenR:new g(")"),comma:new g(",",y),semi:new g(";",y),colon:new g(":",y),dot:new g("."),question:new g("?",y),arrow:new g("=>",y),template:new g("template"),invalidTemplate:new g("invalidTemplate"),ellipsis:new g("...",y),backQuote:new g("`",b),dollarBraceL:new g("${",{beforeExpr:!0,startsExpr:!0}),eq:new g("=",{beforeExpr:!0,isAssign:!0}),assign:new g("_=",{beforeExpr:!0,isAssign:!0}),incDec:new g("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new g("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:v("||",1),logicalAND:v("&&",2),bitwiseOR:v("|",3),bitwiseXOR:v("^",4),bitwiseAND:v("&",5),equality:v("==/!=/===/!==",6),relational:v("</>/<=/>=",7),bitShift:v("<</>>/>>>",8),plusMin:new g("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:v("%",10),star:v("*",10),slash:v("/",10),starstar:new g("**",{beforeExpr:!0}),_break:_("break"),_case:_("case",y),_catch:_("catch"),_continue:_("continue"),_debugger:_("debugger"),_default:_("default",y),_do:_("do",{isLoop:!0,beforeExpr:!0}),_else:_("else",y),_finally:_("finally"),_for:_("for",{isLoop:!0}),_function:_("function",b),_if:_("if"),_return:_("return",y),_switch:_("switch"),_throw:_("throw",y),_try:_("try"),_var:_("var"),_const:_("const"),_while:_("while",{isLoop:!0}),_with:_("with"),_new:_("new",{beforeExpr:!0,startsExpr:!0}),_this:_("this",b),_super:_("super",b),_class:_("class",b),_extends:_("extends",y),_export:_("export"),_import:_("import",b),_null:_("null",b),_true:_("true",b),_false:_("false",b),_in:_("in",{beforeExpr:!0,binop:7}),_instanceof:_("instanceof",{beforeExpr:!0,binop:7}),_typeof:_("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:_("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:_("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},S=/\r\n?|\n|\u2028|\u2029/,E=new RegExp(S.source,"g");function M(t,e){return 10===t||13===t||!e&&(8232===t||8233===t)}var C=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,T=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,k=Object.prototype,P=k.hasOwnProperty,A=k.toString;function O(t,e){return P.call(t,e)}var N=Array.isArray||function(t){return"[object Array]"===A.call(t)};function R(t){return new RegExp("^(?:"+t.replace(/ /g,"|")+")$")}var L=function(t,e){this.line=t,this.column=e};L.prototype.offset=function(t){return new L(this.line,this.column+t)};var I=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function D(t,e){for(var n=1,r=0;;){E.lastIndex=r;var i=E.exec(t);if(!(i&&i.index<e))return new L(n,e-r);++n,r=i.index+i[0].length}}var z={ecmaVersion:9,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function F(t){var e={};for(var n in z)e[n]=t&&O(t,n)?t[n]:z[n];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),N(e.onToken)){var r=e.onToken;e.onToken=function(t){return r.push(t)}}return N(e.onComment)&&(e.onComment=function(t,e){return function(n,r,i,a,o,s){var l={type:n?"Block":"Line",value:r,start:i,end:a};t.locations&&(l.loc=new I(this,o,s)),t.ranges&&(l.range=[i,a]),e.push(l)}}(e,e.onComment)),e}function B(t,e){return 2|(t?4:0)|(e?8:0)}var V=function(t,e,n){this.options=t=F(t),this.sourceFile=t.sourceFile,this.keywords=R(a[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var i="";if(!0!==t.allowReserved){for(var o=t.ecmaVersion;!(i=r[o]);o--);"module"===t.sourceType&&(i+=" await")}this.reservedWords=R(i);var s=(i?i+" ":"")+r.strict;this.reservedWordsStrict=R(s),this.reservedWordsStrictBind=R(s+" "+r.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(S).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=w.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},j={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};V.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},j.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},j.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},j.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},j.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},j.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},j.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},V.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},V.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,r=0;r<t.length;r++)n=t[r](n);return n},V.parse=function(t,e){return new this(e,t).parse()},V.parseExpressionAt=function(t,e,n){var r=new this(n,t,e);return r.nextToken(),r.parseExpression()},V.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(V.prototype,j);var H=V.prototype,U=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function G(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}H.strictDirective=function(t){for(;;){T.lastIndex=t,t+=T.exec(this.input)[0].length;var e=U.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2]))return!0;t+=e[0].length,T.lastIndex=t,t+=T.exec(this.input)[0].length,";"===this.input[t]&&t++}},H.eat=function(t){return this.type===t&&(this.next(),!0)},H.isContextual=function(t){return this.type===w.name&&this.value===t&&!this.containsEsc},H.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},H.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},H.canInsertSemicolon=function(){return this.type===w.eof||this.type===w.braceR||S.test(this.input.slice(this.lastTokEnd,this.start))},H.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},H.semicolon=function(){this.eat(w.semi)||this.insertSemicolon()||this.unexpected()},H.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},H.expect=function(t){this.eat(t)||this.unexpected()},H.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},H.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},H.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},H.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},H.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var q=V.prototype;q.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==w.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var a=i[r];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var W={kind:"loop"},$={kind:"switch"};q.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;T.lastIndex=this.pos;var e=T.exec(this.input),n=this.pos+e[0].length,r=this.input.charCodeAt(n);if(91===r)return!0;if(t)return!1;if(123===r)return!0;if(p(r,!0)){for(var i=n+1;m(this.input.charCodeAt(i),!0);)++i;var a=this.input.slice(n,i);if(!o.test(a))return!0}return!1},q.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;T.lastIndex=this.pos;var t=T.exec(this.input),e=this.pos+t[0].length;return!(S.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!==this.input.length&&m(this.input.charAt(e+8)))},q.parseStatement=function(t,e,n){var r,i=this.type,a=this.startNode();switch(this.isLet(t)&&(i=w._var,r="let"),i){case w._break:case w._continue:return this.parseBreakContinueStatement(a,i.keyword);case w._debugger:return this.parseDebuggerStatement(a);case w._do:return this.parseDoStatement(a);case w._for:return this.parseForStatement(a);case w._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!t);case w._class:return t&&this.unexpected(),this.parseClass(a,!0);case w._if:return this.parseIfStatement(a);case w._return:return this.parseReturnStatement(a);case w._switch:return this.parseSwitchStatement(a);case w._throw:return this.parseThrowStatement(a);case w._try:return this.parseTryStatement(a);case w._const:case w._var:return r=r||this.value,t&&"var"!==r&&this.unexpected(),this.parseVarStatement(a,r);case w._while:return this.parseWhileStatement(a);case w._with:return this.parseWithStatement(a);case w.braceL:return this.parseBlock(!0,a);case w.semi:return this.parseEmptyStatement(a);case w._export:case w._import:if(this.options.ecmaVersion>10&&i===w._import){T.lastIndex=this.pos;var o=T.exec(this.input),s=this.pos+o[0].length;if(40===this.input.charCodeAt(s))return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===w._import?this.parseImport(a):this.parseExport(a,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!t);var l=this.value,u=this.parseExpression();return i===w.name&&"Identifier"===u.type&&this.eat(w.colon)?this.parseLabeledStatement(a,l,u,t):this.parseExpressionStatement(a,u)}},q.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(w.semi)||this.insertSemicolon()?t.label=null:this.type!==w.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},q.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},q.parseDoStatement=function(t){return this.next(),this.labels.push(W),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(w._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(w.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},q.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(W),this.enterScope(0),this.expect(w.parenL),this.type===w.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===w._var||this.type===w._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,r)):(e>-1&&this.unexpected(e),this.parseFor(t,r))}var a=new G,o=this.parseExpression(!0,a);return this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):t.await=e>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(t,o)):(this.checkExpressionErrors(a,!0),e>-1&&this.unexpected(e),this.parseFor(t,o))},q.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,Q|(n?0:X),!1,e)},q.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(w._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},q.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(w.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},q.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(w.braceL),this.labels.push($),this.enterScope(0);for(var n=!1;this.type!==w.braceR;)if(this.type===w._case||this.type===w._default){var r=this.type===w._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(w.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},q.parseThrowStatement=function(t){return this.next(),S.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var Y=[];q.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===w._catch){var e=this.startNode();if(this.next(),this.eat(w.parenL)){e.param=this.parseBindingAtom();var n="Identifier"===e.param.type;this.enterScope(n?32:0),this.checkLVal(e.param,n?4:2),this.expect(w.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0);e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(w._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},q.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},q.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(W),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},q.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},q.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},q.parseLabeledStatement=function(t,e,n,r){for(var i=0,a=this.labels;i<a.length;i+=1){a[i].name===e&&this.raise(n.start,"Label '"+e+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===w._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var l=this.labels[s];if(l.statementStart!==t.start)break;l.statementStart=this.start,l.kind=o}return this.labels.push({name:e,kind:o,statementStart:this.start}),t.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},q.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},q.parseBlock=function(t,e){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(w.braceL),t&&this.enterScope(0);!this.eat(w.braceR);){var n=this.parseStatement(null);e.body.push(n)}return t&&this.exitScope(),this.finishNode(e,"BlockStatement")},q.parseFor=function(t,e){return t.init=e,this.expect(w.semi),t.test=this.type===w.semi?null:this.parseExpression(),this.expect(w.semi),t.update=this.type===w.parenR?null:this.parseExpression(),this.expect(w.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},q.parseForIn=function(t,e){var n=this.type===w._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)?this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===e.type&&this.raise(e.start,"Invalid left-hand side in for-loop"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(w.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},q.parseVar=function(t,e,n){for(t.declarations=[],t.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(w.eq)?r.init=this.parseMaybeAssign(e):"const"!==n||this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===r.id.type||e&&(this.type===w._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(w.comma))break}return t},q.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLVal(t.id,"var"===e?1:2,!1)};var Q=1,X=2;q.parseFunction=function(t,e,n,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===w.star&&e&X&&this.unexpected(),t.generator=this.eat(w.star)),this.options.ecmaVersion>=8&&(t.async=!!r),e&Q&&(t.id=4&e&&this.type!==w.name?null:this.parseIdent(),!t.id||e&X||this.checkLVal(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(B(t.async,t.generator)),e&Q||(t.id=this.type===w.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,e&Q?"FunctionDeclaration":"FunctionExpression")},q.parseFunctionParams=function(t){this.expect(w.parenL),t.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},q.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var r=this.startNode(),i=!1;for(r.body=[],this.expect(w.braceL);!this.eat(w.braceR);){var a=this.parseClassElement(null!==t.superClass);a&&(r.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind&&(i&&this.raise(a.start,"Duplicate constructor in the same class"),i=!0))}return t.body=this.finishNode(r,"ClassBody"),this.strict=n,this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},q.parseClassElement=function(t){var e=this;if(this.eat(w.semi))return null;var n=this.startNode(),r=function(t,r){void 0===r&&(r=!1);var i=e.start,a=e.startLoc;return!!e.eatContextual(t)&&(!(e.type===w.parenL||r&&e.canInsertSemicolon())||(n.key&&e.unexpected(),n.computed=!1,n.key=e.startNodeAt(i,a),n.key.name=t,e.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=r("static");var i=this.eat(w.star),a=!1;i||(this.options.ecmaVersion>=8&&r("async",!0)?(a=!0,i=this.options.ecmaVersion>=9&&this.eat(w.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var o=n.key,s=!1;return n.computed||n.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?n.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),n.kind="constructor",s=t),this.parseClassMethod(n,i,a,s),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},q.parseClassMethod=function(t,e,n,r){return t.value=this.parseMethod(e,n,r),this.finishNode(t,"MethodDefinition")},q.parseClassId=function(t,e){this.type===w.name?(t.id=this.parseIdent(),e&&this.checkLVal(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},q.parseClassSuper=function(t){t.superClass=this.eat(w._extends)?this.parseExprSubscripts():null},q.parseExport=function(t,e){if(this.next(),this.eat(w.star))return this.expectContextual("from"),this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(w._default)){var n;if(this.checkExport(e,"default",this.lastTokStart),this.type===w._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),t.declaration=this.parseFunction(r,4|Q,!1,n)}else if(this.type===w._class){var i=this.startNode();t.declaration=this.parseClass(i,"nullableID")}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(null),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var a=0,o=t.specifiers;a<o.length;a+=1){var s=o[a];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},q.checkExport=function(t,e,n){t&&(O(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},q.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e.name,e.start);else if("ObjectPattern"===n)for(var r=0,i=e.properties;r<i.length;r+=1){var a=i[r];this.checkPatternExport(t,a)}else if("ArrayPattern"===n)for(var o=0,s=e.elements;o<s.length;o+=1){var l=s[o];l&&this.checkPatternExport(t,l)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(t,e.expression)},q.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.checkPatternExport(t,i.id)}},q.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},q.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(w.braceL);!this.eat(w.braceR);){if(n)n=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(t,r.exported.name,r.exported.start),e.push(this.finishNode(r,"ExportSpecifier"))}return e},q.parseImport=function(t){return this.next(),this.type===w.string?(t.specifiers=Y,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===w.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},q.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===w.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),t.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(w.comma))return t}if(this.type===w.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,2),t.push(this.finishNode(r,"ImportNamespaceSpecifier")),t}for(this.expect(w.braceL);!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),t.push(this.finishNode(i,"ImportSpecifier"))}return t},q.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},q.isDirectiveCandidate=function(t){return"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var Z=V.prototype;Z.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=t.properties;r<i.length;r+=1){var a=i[r];this.toAssignable(a,e),"RestElement"!==a.type||"ArrayPattern"!==a.argument.type&&"ObjectPattern"!==a.argument.type||this.raise(a.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},Z.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var i=t[r];i&&this.toAssignable(i,e)}if(n){var a=t[n-1];6===this.options.ecmaVersion&&e&&a&&"RestElement"===a.type&&"Identifier"!==a.argument.type&&this.unexpected(a.argument.start)}return t},Z.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},Z.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==w.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},Z.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case w.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(w.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case w.braceL:return this.parseObj(!0)}return this.parseIdent()},Z.parseBindingList=function(t,e,n){for(var r=[],i=!0;!this.eat(t);)if(i?i=!1:this.expect(w.comma),e&&this.type===w.comma)r.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===w.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),r.push(o)}return r},Z.parseBindingListItem=function(t){return t},Z.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(w.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},Z.checkLVal=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"Identifier":2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(O(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),0!==e&&5!==e&&this.declareName(t.name,e,t.start);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=t.properties;r<i.length;r+=1){var a=i[r];this.checkLVal(a,e,n)}break;case"Property":this.checkLVal(t.value,e,n);break;case"ArrayPattern":for(var o=0,s=t.elements;o<s.length;o+=1){var l=s[o];l&&this.checkLVal(l,e,n)}break;case"AssignmentPattern":this.checkLVal(t.left,e,n);break;case"RestElement":this.checkLVal(t.argument,e,n);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,n);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var J=V.prototype;J.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var a=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===a&&(e.proto&&(n&&n.doubleProto<0?n.doubleProto=i.start:this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);else{var o=e[r="$"+r];if(o)("init"===a?this.strict&&o.init||o.get||o.set:o.init||o[a])&&this.raiseRecoverable(i.start,"Redefinition of property");else o=e[r]={init:!1,get:!1,set:!1};o[a]=!0}}},J.parseExpression=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type===w.comma){var a=this.startNodeAt(n,r);for(a.expressions=[i];this.eat(w.comma);)a.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(a,"SequenceExpression")}return i},J.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var r=!1,i=-1,a=-1,o=-1;e?(i=e.parenthesizedAssign,a=e.trailingComma,o=e.shorthandAssign,e.parenthesizedAssign=e.trailingComma=e.shorthandAssign=-1):(e=new G,r=!0);var s=this.start,l=this.startLoc;this.type!==w.parenL&&this.type!==w.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(t,e);if(n&&(u=n.call(this,u,s,l)),this.type.isAssign){var c=this.startNodeAt(s,l);return c.operator=this.value,c.left=this.type===w.eq?this.toAssignable(u,!1,e):u,r||G.call(e),e.shorthandAssign=-1,this.checkLVal(u),this.next(),c.right=this.parseMaybeAssign(t),this.finishNode(c,"AssignmentExpression")}return r&&this.checkExpressionErrors(e,!0),i>-1&&(e.parenthesizedAssign=i),a>-1&&(e.trailingComma=a),o>-1&&(e.shorthandAssign=o),u},J.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return i;if(this.eat(w.question)){var a=this.startNodeAt(n,r);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(w.colon),a.alternate=this.parseMaybeAssign(t),this.finishNode(a,"ConditionalExpression")}return i},J.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,t)},J.parseExprOp=function(t,e,n,r,i){var a=this.type.binop;if(null!=a&&(!i||this.type!==w._in)&&a>r){var o=this.type===w.logicalOR||this.type===w.logicalAND,s=this.value;this.next();var l=this.start,u=this.startLoc,c=this.parseExprOp(this.parseMaybeUnary(null,!1),l,u,a,i),h=this.buildBinary(e,n,t,c,s,o);return this.parseExprOp(h,e,n,r,i)}return t},J.buildBinary=function(t,e,n,r,i,a){var o=this.startNodeAt(t,e);return o.left=n,o.operator=i,o.right=r,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")},J.parseMaybeUnary=function(t,e){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),e=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===w.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),o?this.checkLVal(a.argument):this.strict&&"delete"===a.operator&&"Identifier"===a.argument.type?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):e=!0,n=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(r,i);s.operator=this.value,s.prefix=!1,s.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(s,"UpdateExpression")}}return!e&&this.eat(w.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},J.parseExprSubscripts=function(t){var e=this.start,n=this.startLoc,r=this.parseExprAtom(t),i="ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||i)return r;var a=this.parseSubscripts(r,e,n);return t&&"MemberExpression"===a.type&&(t.parenthesizedAssign>=a.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=a.start&&(t.parenthesizedBind=-1)),a},J.parseSubscripts=function(t,e,n,r){for(var i=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&"async"===this.input.slice(t.start,t.end);;){var a=this.parseSubscript(t,e,n,r,i);if(a===t||"ArrowFunctionExpression"===a.type)return a;t=a}},J.parseSubscript=function(t,e,n,r,i){var a=this.eat(w.bracketL);if(a||this.eat(w.dot)){var o=this.startNodeAt(e,n);o.object=t,o.property=a?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),o.computed=!!a,a&&this.expect(w.bracketR),t=this.finishNode(o,"MemberExpression")}else if(!r&&this.eat(w.parenL)){var s=new G,l=this.yieldPos,u=this.awaitPos,c=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var h=this.parseExprList(w.parenR,this.options.ecmaVersion>=8&&"Import"!==t.type,!1,s);if(i&&!this.canInsertSemicolon()&&this.eat(w.arrow))return this.checkPatternErrors(s,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=l,this.awaitPos=u,this.awaitIdentPos=c,this.parseArrowExpression(this.startNodeAt(e,n),h,!0);this.checkExpressionErrors(s,!0),this.yieldPos=l||this.yieldPos,this.awaitPos=u||this.awaitPos,this.awaitIdentPos=c||this.awaitIdentPos;var d=this.startNodeAt(e,n);if(d.callee=t,d.arguments=h,"Import"===d.callee.type){1!==d.arguments.length&&this.raise(d.start,"import() requires exactly one argument");var f=d.arguments[0];f&&"SpreadElement"===f.type&&this.raise(f.start,"... is not allowed in import()")}t=this.finishNode(d,"CallExpression")}else if(this.type===w.backQuote){var p=this.startNodeAt(e,n);p.tag=t,p.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(p,"TaggedTemplateExpression")}return t},J.parseExprAtom=function(t){this.type===w.slash&&this.readRegexp();var e,n=this.potentialArrowAt===this.start;switch(this.type){case w._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),e=this.startNode(),this.next(),this.type!==w.parenL||this.allowDirectSuper||this.raise(e.start,"super() call outside constructor of a subclass"),this.type!==w.dot&&this.type!==w.bracketL&&this.type!==w.parenL&&this.unexpected(),this.finishNode(e,"Super");case w._this:return e=this.startNode(),this.next(),this.finishNode(e,"ThisExpression");case w.name:var r=this.start,i=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(w._function))return this.parseFunction(this.startNodeAt(r,i),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(w.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===w.name&&!a)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(w.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[o],!0)}return o;case w.regexp:var s=this.value;return(e=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},e;case w.num:case w.string:return this.parseLiteral(this.value);case w._null:case w._true:case w._false:return(e=this.startNode()).value=this.type===w._null?null:this.type===w._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case w.parenL:var l=this.start,u=this.parseParenAndDistinguishExpression(n);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(t.parenthesizedAssign=l),t.parenthesizedBind<0&&(t.parenthesizedBind=l)),u;case w.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(w.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case w.braceL:return this.parseObj(!1,t);case w._function:return e=this.startNode(),this.next(),this.parseFunction(e,0);case w._class:return this.parseClass(this.startNode(),!1);case w._new:return this.parseNew();case w.backQuote:return this.parseTemplate();case w._import:return this.options.ecmaVersion>10?this.parseDynamicImport():this.unexpected();default:this.unexpected()}},J.parseDynamicImport=function(){var t=this.startNode();return this.next(),this.type!==w.parenL&&this.unexpected(),this.finishNode(t,"Import")},J.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1)),this.next(),this.finishNode(e,"Literal")},J.parseParenExpression=function(){this.expect(w.parenL);var t=this.parseExpression();return this.expect(w.parenR),t},J.parseParenAndDistinguishExpression=function(t){var e,n=this.start,r=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,s=this.startLoc,l=[],u=!0,c=!1,h=new G,d=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==w.parenR;){if(u?u=!1:this.expect(w.comma),i&&this.afterTrailingComma(w.parenR,!0)){c=!0;break}if(this.type===w.ellipsis){a=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}l.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var p=this.start,m=this.startLoc;if(this.expect(w.parenR),t&&!this.canInsertSemicolon()&&this.eat(w.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=f,this.parseParenArrowList(n,r,l);l.length&&!c||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=f||this.awaitPos,l.length>1?((e=this.startNodeAt(o,s)).expressions=l,this.finishNodeAt(e,"SequenceExpression",p,m)):e=l[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var g=this.startNodeAt(n,r);return g.expression=e,this.finishNode(g,"ParenthesizedExpression")}return e},J.parseParenItem=function(t){return t},J.parseParenArrowList=function(t,e,n){return this.parseArrowExpression(this.startNodeAt(t,e),n)};var K=[];J.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(w.dot)){t.meta=e;var n=this.containsEsc;return t.property=this.parseIdent(!0),("target"!==t.property.name||n)&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inNonArrowFunction()||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty")}var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),this.options.ecmaVersion>10&&"Import"===t.callee.type&&this.raise(t.callee.start,"Cannot use new with import(...)"),this.eat(w.parenL)?t.arguments=this.parseExprList(w.parenR,this.options.ecmaVersion>=8&&"Import"!==t.callee.type,!1):t.arguments=K,this.finishNode(t,"NewExpression")},J.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===w.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===w.backQuote,this.finishNode(n,"TemplateElement")},J.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===w.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(w.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(w.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},J.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===w.name||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===w.star)&&!S.test(this.input.slice(this.lastTokEnd,this.start))},J.parseObj=function(t,e){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(w.braceR);){if(r)r=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var a=this.parseProperty(t,e);t||this.checkPropClash(a,i,e),n.properties.push(a)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},J.parseProperty=function(t,e){var n,r,i,a,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(w.ellipsis))return t?(o.argument=this.parseIdent(!1),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===w.parenL&&e&&(e.parenthesizedAssign<0&&(e.parenthesizedAssign=this.start),e.parenthesizedBind<0&&(e.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,e),this.type===w.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(t||e)&&(i=this.start,a=this.startLoc),t||(n=this.eat(w.star)));var s=this.containsEsc;return this.parsePropertyName(o),!t&&!s&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(w.star),this.parsePropertyName(o,e)):r=!1,this.parsePropertyValue(o,t,n,r,i,a,e,s),this.finishNode(o,"Property")},J.parsePropertyValue=function(t,e,n,r,i,a,o,s){if((n||r)&&this.type===w.colon&&this.unexpected(),this.eat(w.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===w.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r);else if(e||s||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===w.comma||this.type===w.braceR)this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),t.kind="init",e?t.value=this.parseMaybeDefault(i,a,t.key):this.type===w.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,a,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected();else{(n||r)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var l="get"===t.kind?0:1;if(t.value.params.length!==l){var u=t.value.start;"get"===t.kind?this.raiseRecoverable(u,"getter should have no params"):this.raiseRecoverable(u,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}},J.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(w.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(w.bracketR),t.key;t.computed=!1}return t.key=this.type===w.num||this.type===w.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},J.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},J.parseMethod=function(t,e,n){var r=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|B(e,r.generator)|(n?128:0)),this.expect(w.parenL),r.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(r,"FunctionExpression")},J.parseArrowExpression=function(t,e,n){var r=this.yieldPos,i=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(16|B(n,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1),this.yieldPos=r,this.awaitPos=i,this.awaitIdentPos=a,this.finishNode(t,"ArrowFunctionExpression")},J.parseFunctionBody=function(t,e,n){var r=e&&this.type!==w.braceL,i=this.strict,a=!1;if(r)t.body=this.parseMaybeAssign(),t.expression=!0,this.checkParams(t,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);i&&!o||(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(t,!i&&!a&&!e&&!n&&this.isSimpleParamList(t.params)),t.body=this.parseBlock(!1),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=s}this.exitScope(),this.strict&&t.id&&this.checkLVal(t.id,5),this.strict=i},J.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1){if("Identifier"!==n[e].type)return!1}return!0},J.checkParams=function(t,e){for(var n={},r=0,i=t.params;r<i.length;r+=1){var a=i[r];this.checkLVal(a,1,e?null:n)}},J.parseExprList=function(t,e,n,r){for(var i=[],a=!0;!this.eat(t);){if(a)a=!1;else if(this.expect(w.comma),e&&this.afterTrailingComma(t))break;var o=void 0;n&&this.type===w.comma?o=null:this.type===w.ellipsis?(o=this.parseSpread(r),r&&this.type===w.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):o=this.parseMaybeAssign(!1,r),i.push(o)}return i},J.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;(this.inGenerator&&"yield"===r&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))},J.parseIdent=function(t,e){var n=this.startNode();return this.type===w.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(),this.finishNode(n,"Identifier"),t||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},J.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===w.semi||this.canInsertSemicolon()||this.type!==w.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(w.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},J.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var tt=V.prototype;tt.raise=function(t,e){var n=D(this.input,t);e+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r},tt.raiseRecoverable=tt.raise,tt.curPosition=function(){if(this.options.locations)return new L(this.curLine,this.pos-this.lineStart)};var et=V.prototype,nt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};et.enterScope=function(t){this.scopeStack.push(new nt(t))},et.exitScope=function(){this.scopeStack.pop()},et.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},et.declareName=function(t,e,n){var r=!1;if(2===e){var i=this.currentScope();r=i.lexical.indexOf(t)>-1||i.functions.indexOf(t)>-1||i.var.indexOf(t)>-1,i.lexical.push(t),this.inModule&&1&i.flags&&delete this.undefinedExports[t]}else if(4===e){this.currentScope().lexical.push(t)}else if(3===e){var a=this.currentScope();r=this.treatFunctionsAsVar?a.lexical.indexOf(t)>-1:a.lexical.indexOf(t)>-1||a.var.indexOf(t)>-1,a.functions.push(t)}else for(var o=this.scopeStack.length-1;o>=0;--o){var s=this.scopeStack[o];if(s.lexical.indexOf(t)>-1&&!(32&s.flags&&s.lexical[0]===t)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(t)>-1){r=!0;break}if(s.var.push(t),this.inModule&&1&s.flags&&delete this.undefinedExports[t],3&s.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},et.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},et.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},et.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags)return e}},et.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags&&!(16&e.flags))return e}};var rt=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new I(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},it=V.prototype;function at(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}it.startNode=function(){return new rt(this,this.start,this.startLoc)},it.startNodeAt=function(t,e){return new rt(this,t,e)},it.finishNode=function(t,e){return at.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},it.finishNodeAt=function(t,e,n,r){return at.call(this,t,e,n,r)};var ot=function(t,e,n,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=r,this.generator=!!i},st={b_stat:new ot("{",!1),b_expr:new ot("{",!0),b_tmpl:new ot("${",!1),p_stat:new ot("(",!1),p_expr:new ot("(",!0),q_tmpl:new ot("`",!0,!0,(function(t){return t.tryReadTemplateToken()})),f_stat:new ot("function",!1),f_expr:new ot("function",!0),f_expr_gen:new ot("function",!0,!1,null,!0),f_gen:new ot("function",!1,!1,null,!0)},lt=V.prototype;lt.initialContext=function(){return[st.b_stat]},lt.braceIsBlock=function(t){var e=this.curContext();return e===st.f_expr||e===st.f_stat||(t!==w.colon||e!==st.b_stat&&e!==st.b_expr?t===w._return||t===w.name&&this.exprAllowed?S.test(this.input.slice(this.lastTokEnd,this.start)):t===w._else||t===w.semi||t===w.eof||t===w.parenR||t===w.arrow||(t===w.braceL?e===st.b_stat:t!==w._var&&t!==w._const&&t!==w.name&&!this.exprAllowed):!e.isExpr)},lt.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},lt.updateContext=function(t){var e,n=this.type;n.keyword&&t===w.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},w.parenR.updateContext=w.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===st.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},w.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?st.b_stat:st.b_expr),this.exprAllowed=!0},w.dollarBraceL.updateContext=function(){this.context.push(st.b_tmpl),this.exprAllowed=!0},w.parenL.updateContext=function(t){var e=t===w._if||t===w._for||t===w._with||t===w._while;this.context.push(e?st.p_stat:st.p_expr),this.exprAllowed=!0},w.incDec.updateContext=function(){},w._function.updateContext=w._class.updateContext=function(t){!t.beforeExpr||t===w.semi||t===w._else||t===w._return&&S.test(this.input.slice(this.lastTokEnd,this.start))||(t===w.colon||t===w.braceL)&&this.curContext()===st.b_stat?this.context.push(st.f_stat):this.context.push(st.f_expr),this.exprAllowed=!1},w.backQuote.updateContext=function(){this.curContext()===st.q_tmpl?this.context.pop():this.context.push(st.q_tmpl),this.exprAllowed=!1},w.star.updateContext=function(t){if(t===w._function){var e=this.context.length-1;this.context[e]===st.f_expr?this.context[e]=st.f_expr_gen:this.context[e]=st.f_gen}this.exprAllowed=!0},w.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==w.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var ut="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ct=ut+" Extended_Pictographic",ht={9:ut,10:ct,11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},dt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ft="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",pt=ft+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",mt={9:ft,10:pt,11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},gt={};function vt(t){var e=gt[t]={binary:R(ht[t]+" "+dt),nonBinary:{General_Category:R(dt),Script:R(mt[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}vt(9),vt(10),vt(11);var yt=V.prototype,bt=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":""),this.unicodeProperties=gt[t.options.ecmaVersion>=11?11:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function xt(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function _t(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function wt(t){return t>=65&&t<=90||t>=97&&t<=122}function St(t){return wt(t)||95===t}function Et(t){return St(t)||Mt(t)}function Mt(t){return t>=48&&t<=57}function Ct(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function Tt(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function kt(t){return t>=48&&t<=55}bt.prototype.reset=function(t,e,n){var r=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchN=r&&this.parser.options.ecmaVersion>=9},bt.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},bt.prototype.at=function(t){var e=this.source,n=e.length;if(t>=n)return-1;var r=e.charCodeAt(t);if(!this.switchU||r<=55295||r>=57344||t+1>=n)return r;var i=e.charCodeAt(t+1);return i>=56320&&i<=57343?(r<<10)+i-56613888:r},bt.prototype.nextIndex=function(t){var e=this.source,n=e.length;if(t>=n)return n;var r,i=e.charCodeAt(t);return!this.switchU||i<=55295||i>=57344||t+1>=n||(r=e.charCodeAt(t+1))<56320||r>57343?t+1:t+2},bt.prototype.current=function(){return this.at(this.pos)},bt.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},bt.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},bt.prototype.eat=function(t){return this.current()===t&&(this.advance(),!0)},yt.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===e.indexOf(i)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(i,r+1)>-1&&this.raise(t.start,"Duplicate regular expression flag")}},yt.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},yt.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var r=n[e];-1===t.groupNames.indexOf(r)&&t.raise("Invalid named capture referenced")}},yt.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},yt.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},yt.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},yt.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},yt.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},yt.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},yt.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue),t.eat(125)))return-1!==i&&i<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},yt.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},yt.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},yt.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},yt.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},yt.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},yt.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},yt.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!_t(e)&&(t.lastIntValue=e,t.advance(),!0)},yt.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!_t(n);)t.advance();return t.pos!==e},yt.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e)&&(t.advance(),!0)},yt.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},yt.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},yt.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=xt(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=xt(t.lastIntValue);return!0}return!1},yt.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return p(t,!0)||36===t||95===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},yt.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return m(t,!0)||36===t||95===t||8204===t||8205===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},yt.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},yt.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},yt.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},yt.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},yt.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},yt.regexp_eatZero=function(t){return 48===t.current()&&!Mt(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},yt.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},yt.regexp_eatControlLetter=function(t){var e=t.current();return!!wt(e)&&(t.lastIntValue=e%32,t.advance(),!0)},yt.regexp_eatRegExpUnicodeEscapeSequence=function(t){var e,n=t.pos;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r=t.lastIntValue;if(t.switchU&&r>=55296&&r<=56319){var i=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var a=t.lastIntValue;if(a>=56320&&a<=57343)return t.lastIntValue=1024*(r-55296)+(a-56320)+65536,!0}t.pos=i,t.lastIntValue=r}return!0}if(t.switchU&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&((e=t.lastIntValue)>=0&&e<=1114111))return!0;t.switchU&&t.raise("Invalid unicode escape"),t.pos=n}return!1},yt.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e)&&(t.lastIntValue=e,t.advance(),!0)},yt.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1},yt.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(function(t){return 100===t||68===t||115===t||83===t||119===t||87===t}(e))return t.lastIntValue=-1,t.advance(),!0;if(t.switchU&&this.options.ecmaVersion>=9&&(80===e||112===e)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(t)&&t.eat(125))return!0;t.raise("Invalid property name")}return!1},yt.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,r),!0}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,i),!0}return!1},yt.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){O(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},yt.regexp_validateUnicodePropertyNameOrValue=function(t,e){t.unicodeProperties.binary.test(e)||t.raise("Invalid property name")},yt.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";St(e=t.current());)t.lastStringValue+=xt(e),t.advance();return""!==t.lastStringValue},yt.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";Et(e=t.current());)t.lastStringValue+=xt(e),t.advance();return""!==t.lastStringValue},yt.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},yt.regexp_eatCharacterClass=function(t){if(t.eat(91)){if(t.eat(94),this.regexp_classRanges(t),t.eat(93))return!0;t.raise("Unterminated character class")}return!1},yt.regexp_classRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},yt.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||kt(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return 93!==r&&(t.lastIntValue=r,t.advance(),!0)},yt.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},yt.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!Mt(e)&&95!==e)&&(t.lastIntValue=e%32,t.advance(),!0)},yt.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},yt.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Mt(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},yt.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Ct(n=t.current());)t.lastIntValue=16*t.lastIntValue+Tt(n),t.advance();return t.pos!==e},yt.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},yt.regexp_eatOctalDigit=function(t){var e=t.current();return kt(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},yt.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var r=0;r<e;++r){var i=t.current();if(!Ct(i))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+Tt(i),t.advance()}return!0};var Pt=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new I(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},At=V.prototype;function Ot(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}At.next=function(){this.options.onToken&&this.options.onToken(new Pt(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},At.getToken=function(){return this.next(),new Pt(this)},"undefined"!=typeof Symbol&&(At[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===w.eof,value:e}}}}),At.curContext=function(){return this.context[this.context.length-1]},At.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(w.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},At.readToken=function(t){return p(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},At.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||t>=57344?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},At.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(E.lastIndex=n;(t=E.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,e,this.curPosition())},At.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!M(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},At.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&C.test(String.fromCharCode(t))))break t;++this.pos}}},At.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},At.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(w.ellipsis)):(++this.pos,this.finishToken(w.dot))},At.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(w.assign,2):this.finishOp(w.slash,1)},At.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=42===t?w.star:w.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,r=w.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(w.assign,n+1):this.finishOp(r,n)},At.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?w.logicalOR:w.logicalAND,2):61===e?this.finishOp(w.assign,2):this.finishOp(124===t?w.bitwiseOR:w.bitwiseAND,1)},At.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(w.assign,2):this.finishOp(w.bitwiseXOR,1)},At.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!S.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(w.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(w.assign,2):this.finishOp(w.plusMin,1)},At.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(w.assign,n+1):this.finishOp(w.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(w.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},At.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(w.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(w.arrow)):this.finishOp(61===t?w.eq:w.prefix,1)},At.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(w.parenL);case 41:return++this.pos,this.finishToken(w.parenR);case 59:return++this.pos,this.finishToken(w.semi);case 44:return++this.pos,this.finishToken(w.comma);case 91:return++this.pos,this.finishToken(w.bracketL);case 93:return++this.pos,this.finishToken(w.bracketR);case 123:return++this.pos,this.finishToken(w.braceL);case 125:return++this.pos,this.finishToken(w.braceR);case 58:return++this.pos,this.finishToken(w.colon);case 63:return++this.pos,this.finishToken(w.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(w.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(w.prefix,1)}this.raise(this.pos,"Unexpected character '"+Ot(t)+"'")},At.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},At.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(S.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var s=this.regexpState||(this.regexpState=new bt(this));s.reset(n,i,o),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var l=null;try{l=new RegExp(i,o)}catch(t){}return this.finishToken(w.regexp,{pattern:i,flags:o,value:l})},At.readInt=function(t,e){for(var n=this.pos,r=0,i=0,a=null==e?1/0:e;i<a;++i){var o=this.input.charCodeAt(this.pos),s=void 0;if((s=o>=97?o-97+10:o>=65?o-65+10:o>=48&&o<=57?o-48:1/0)>=t)break;++this.pos,r=r*t+s}return this.pos===n||null!=e&&this.pos-n!==e?null:r},At.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n="undefined"!=typeof BigInt?BigInt(this.input.slice(e,this.pos)):null,++this.pos):p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,n)},At.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number"),n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1);var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===r){var i=this.input.slice(e,this.pos),a="undefined"!=typeof BigInt?BigInt(i):null;return++this.pos,p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,a)}46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o=this.input.slice(e,this.pos),s=n?parseInt(o,8):parseFloat(o);return this.finishToken(w.num,s)},At.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},At.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===t)break;92===r?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):(M(r,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(w.string,e)};var Nt={};At.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==Nt)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},At.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Nt;this.raise(t,e)},At.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==w.template&&this.type!==w.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(w.template,t)):36===n?(this.pos+=2,this.finishToken(w.dollarBraceL)):(++this.pos,this.finishToken(w.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(M(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},At.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(w.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},At.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Ot(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(n,8);return r>255&&(n=n.slice(0,-1),r=parseInt(n,8)),this.pos+=n.length-1,e=this.input.charCodeAt(this.pos),"0"===n&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-n.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return M(e)?"":String.fromCharCode(e)}},At.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},At.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(m(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var a=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?p:m)(o,r)||this.invalidStringToken(a,"Invalid Unicode escape"),t+=Ot(o),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},At.readWord=function(){var t=this.readWord1(),e=w.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=x[t]),this.finishToken(e,t)};var Rt="6.4.2";function Lt(t,e){return V.parse(t,e)}function It(t,e,n){return V.parseExpressionAt(t,e,n)}function Dt(t,e){return V.tokenizer(t,e)}V.acorn={Parser:V,version:Rt,defaultOptions:z,Position:L,SourceLocation:I,getLineInfo:D,Node:rt,TokenType:g,tokTypes:w,keywordTypes:x,TokContext:ot,tokContexts:st,isIdentifierChar:m,isIdentifierStart:p,Token:Pt,isNewLine:M,lineBreak:S,lineBreakG:E,nonASCIIwhitespace:C}},function(t,e){},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new o(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.alea=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor128=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorwow=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorshift7=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor4096=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n(12)&&n(28)?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.tychei=l}(0,t,n(12))}).call(this,n(16)(t))},function(t,e,n){var r;!function(i,a,o){var s,l=o.pow(256,6),u=o.pow(2,52),c=2*u;function h(t,e,n){var r=[],h=p(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(a)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(256):(t=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,m(a)]}}():t,3),r),g=new d(r),v=function(){for(var t=g.g(6),e=l,n=0;t<u;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,p(m(g.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&f(r,g),t.state=function(){return f(g,{})}),n?(o.random=t,e):t})(v,h,"global"in e?e.global:this==o,e.state)}function d(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+t[i%n]+(e=o[i])],o[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,o=r.S;t--;)e=o[i=255&i+1],n=256*n+o[255&(o[i]=o[a=255&a+e])+(o[a]=e)];return r.i=i,r.j=a,n})(256)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(p(o.random(),a),t.exports){t.exports=h;try{s=n(378)}catch(t){}}else void 0===(r=function(){return h}.call(e,n,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},function(t,e){},function(t,e){!function(){"use strict";var e=function(t){if(!t)throw new Error("a null element specified.");var e=new n;return r(e,t),e};try{t.exports={element:e}}catch(t){Function("return this;")().svgz_element=e}var n=function(){this._element=null};n.prototype.toTop=function(){try{return i(this._element).insertBefore(this._element,null),this}catch(t){throw t}},n.prototype.toBottom=function(){try{var t=i(this._element),e=s(t);return t.insertBefore(this._element,e[0]),this}catch(t){throw t}},n.prototype.moveUp=function(t){try{if(null==t)t=1;else if("number"!=typeof t){if((t=o(this._element,t))<=0)return}else if(t<=0)throw new Error("Invalid number for n that must be positive.");return this.moveRelative(t)}catch(t){throw t}},n.prototype.moveDown=function(t){try{if(null==t)t=-1;else if("number"!=typeof t){if((t=o(this._element,t))>=0)return}else{if(t<=0)throw new Error("Invalid number for n that must be positive.");t=-t}return this.moveRelative(t)}catch(t){throw t}},n.prototype.moveRelative=function(t){try{if(null==t)throw new Error("Invalid number for n of null.");if("number"!=typeof t)throw new Error("Invalid number for n.");var e=i(this._element),n=a(this._element,t);return e.insertBefore(this._element,n),this}catch(t){throw t}},n.prototype.moveTo=function(t){try{var e=i(this._element),n=s(e),r=n.indexOf(this._element);if(null==t)throw new Error("A position must be specified.");if("number"==typeof t){if(t<0||n.length<t)throw new Error("Invalid position specified.")}else{if(i(t)!==e)throw new Error("The target node not found.");t=n.indexOf(t)}var a=t-r;return this.moveRelative(a)}catch(t){throw t}};var r=function(t,e){t._element=e},i=function(t){if(!("parentNode"in t))throw new Error("There is not parentNode");var e=t.parentNode;if(!e)throw new Error("parentNode is undefined");return e},a=function(t,e){var n=i(t),r=s(n),a=r.length,o=r.indexOf(t),l=o+e;l>o&&(l+=1),l<0?l=0:l>=a&&(l=a);var u=l<a?r[l]:null;if(u&&i(u)!==n)throw new Error("parentNode is different for target.");return u},o=function(t,e){var n=i(t),r=s(n),a=r.indexOf(t),o=r.indexOf(e);if(o<0)throw new Error("parentNode is different for target.");return o-a},s=function(t){var e=[];return Array.from(t.childNodes).map((function(t){1==t.nodeType&&e.push(t)})),e}}()},function(t,e,n){t.exports=function(t){"use strict";let e=class extends t.Texture{constructor(){super(document.createElement("canvas"));let e=null,n=()=>e||(e=this.createDrawable()),r=()=>n().width,i=()=>n().height,a=!0,o=1,s=()=>t.MathUtils.ceilPowerOfTwo(r()*o),l=()=>t.MathUtils.ceilPowerOfTwo(i()*o),u=t=>{if(o!==t){let e=s(),n=l();o=t;let r=s(),i=l();r===e&&i===n||(a=!0)}},c=(()=>{let e=new t.Vector3,n=new t.Vector2,a=new t.Vector3,o=new t.Vector3,s=new t.Vector2;return(l,u,c)=>{if(s.set(r(),i()),s.x&&s.y){l.getWorldPosition(a),c.getWorldPosition(e);let r=a.distanceTo(e);if(c.isPerspectiveCamera&&(r*=2*Math.tan(t.MathUtils.degToRad(c.fov)/2)),(c.isPerspectiveCamera||c.isOrthographicCamera)&&(r/=c.zoom),r){var h,d;l.getWorldScale(o);let t=null!==(h=null===(d=u.capabilities)||void 0===d?void 0:d.maxTextureSize)&&void 0!==h?h:1/0;return u.getDrawingBufferSize(n),Math.min(Math.max(o.x/r*(n.x/s.x),o.y/r*(n.y/s.y)),t/s.x,t/s.y)}}return 0}})();Object.defineProperties(this,{width:{get:r},height:{get:i},pixelRatio:{get:()=>o,set:u},needsRedraw:{set(t){t&&(a=!0,e=null)}}}),Object.assign(this,{redraw(){if(a){let t=this.image,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),t.width=s(),t.height=l(),t.width&&t.height?(e.save(),e.scale(t.width/r(),t.height/i()),((...t)=>{n().draw(...t)})(e),e.restore()):t.width=t.height=1,a=!1,this.needsUpdate=!0}},setOptimalPixelRatio(...t){u(c(...t))}})}};e.prototype.isDynamicTexture=!0;let n=class extends e{constructor({alignment:t="center",backgroundColor:e="rgba(0,0,0,0)",color:n="#fff",fontFamily:r="sans-serif",fontSize:i=16,fontStyle:a="normal",fontVariant:o="normal",fontWeight:s="normal",lineGap:l=1/4,padding:u=.5,strokeColor:c="#fff",strokeWidth:h=0,text:d=""}={}){super(),Object.entries({alignment:t,backgroundColor:e,color:n,fontFamily:r,fontSize:i,fontStyle:a,fontVariant:o,fontWeight:s,lineGap:l,padding:u,strokeColor:c,strokeWidth:h,text:d}).forEach(([t,e])=>{Object.defineProperty(this,t,{get:()=>e,set(t){e!==t&&(e=t,this.needsRedraw=!0)}})})}get lines(){let{text:t}=this;return t?t.split("\n"):[]}get font(){return function(t,e,n,r,i){let a=document.createElement("span");return a.style.font="1px serif",a.style.fontFamily=t,a.style.fontSize="".concat(e,"px"),a.style.fontStyle=n,a.style.fontVariant=r,a.style.fontWeight=i,a.style.font}(this.fontFamily,this.fontSize,this.fontStyle,this.fontVariant,this.fontWeight)}checkFontFace(){try{let{font:t}=this;return document.fonts.check(t)}catch{}return!0}async loadFontFace(){try{let{font:t}=this;await document.fonts.load(t)}catch{}}createDrawable(){let{alignment:t,backgroundColor:e,color:n,font:r,fontSize:i,lineGap:a,lines:o,padding:s,strokeColor:l,strokeWidth:u}=this;s*=i,a*=i,u*=i;let c=o.length,h=i+a,d=c?(()=>{let t=document.createElement("canvas").getContext("2d");return t.font=r,Math.max(...o.map(e=>t.measureText(e).width))})():0,f=s+u/2,p=d+2*f;return{width:p,height:(c?i+h*(c-1):0)+2*f,draw(a){let s;a.fillStyle=e,a.fillRect(0,0,a.canvas.width,a.canvas.height);let c=f+i/2;Object.assign(a,{fillStyle:n,font:r,lineWidth:u,miterLimit:1,strokeStyle:l,textAlign:(()=>{switch(t){case"left":return s=f,"left";case"right":return s=p-f,"right"}return s=p/2,"center"})(),textBaseline:"middle"}),o.forEach(t=>{a.fillText(t,s,c),u&&a.strokeText(t,s,c),c+=h})}}}};return n.prototype.isTextTexture=!0,n}(n(1))},function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),a=n(29),o=n.n(a),s=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},l=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return s(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}};var u=l(s),c=u.right,h=(u.left,c);var d=function(t){return null===t?NaN:+t},f=function(t,e){var n=function(t,e){var n,r,i=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<i;)isNaN(n=d(t[o]))||(l+=(r=n-s)*(n-(s+=r/++a)));else for(;++o<i;)isNaN(n=d(e(t[o],o,t)))||(l+=(r=n-s)*(n-(s+=r/++a)));if(a>1)return l/(a-1)}(t,e);return n?Math.sqrt(n):n},p=function(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},m=Array.prototype,g=m.slice,v=(m.map,function(t){return function(){return t}}),y=function(t){return t},b=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},x=Math.sqrt(50),_=Math.sqrt(10),w=Math.sqrt(2),S=function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=E(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a};function E(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=x?10:a>=_?5:a>=w?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=x?10:a>=_?5:a>=w?2:1)}function M(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=x?i*=10:a>=_?i*=5:a>=w&&(i*=2),e<t?-i:i}var C=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},T=function(){var t=y,e=p,n=C;function r(r){var i,a,o=r.length,s=new Array(o);for(i=0;i<o;++i)s[i]=t(r[i],i,r);var l=e(s),u=l[0],c=l[1],d=n(s,u,c);Array.isArray(d)||(d=M(u,c,d),d=b(Math.ceil(u/d)*d,c,d));for(var f=d.length;d[0]<=u;)d.shift(),--f;for(;d[f-1]>c;)d.pop(),--f;var p,m=new Array(f+1);for(i=0;i<=f;++i)(p=m[i]=[]).x0=i>0?d[i-1]:u,p.x1=i<f?d[i]:c;for(i=0;i<o;++i)u<=(a=s[i])&&a<=c&&m[h(d,a,0,f)].push(r[i]);return m}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:v(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:v([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?v(g.call(t)):v(t),r):n},r},k=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r},P=function(t,e){var n,r=t.length,i=r,a=-1,o=0;if(null==e)for(;++a<r;)isNaN(n=d(t[a]))?--i:o+=n;else for(;++a<r;)isNaN(n=d(e(t[a],a,t)))?--i:o+=n;if(i)return o/i},A=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r};var O=Array.prototype.slice,N=function(t){return t};function R(t){return"translate("+(t+.5)+",0)"}function L(t){return"translate(0,"+(t+.5)+")"}function I(t){return function(e){return+t(e)}}function D(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function F(){return!this.__axis}function B(t,e){var n=[],r=null,i=null,a=6,o=6,s=3,l=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?R:L;function h(h){var d=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,f=null==i?e.tickFormat?e.tickFormat.apply(e,n):N:i,p=Math.max(a,0)+s,m=e.range(),g=+m[0]+.5,v=+m[m.length-1]+.5,y=(e.bandwidth?D:I)(e.copy()),b=h.selection?h.selection():h,x=b.selectAll(".domain").data([null]),_=b.selectAll(".tick").data(d,e).order(),w=_.exit(),S=_.enter().append("g").attr("class","tick"),E=_.select("line"),M=_.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(S),E=E.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",l*a)),M=M.merge(S.append("text").attr("fill","currentColor").attr(u,l*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==b&&(x=x.transition(h),_=_.transition(h),E=E.transition(h),M=M.transition(h),w=w.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=y(t))?c(t):this.getAttribute("transform")})),S.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:y(t))}))),w.remove(),x.attr("d",4===t||2==t?o?"M"+l*o+","+g+"H0.5V"+v+"H"+l*o:"M0.5,"+g+"V"+v:o?"M"+g+","+l*o+"V0.5H"+v+"V"+l*o:"M"+g+",0.5H"+v),_.attr("opacity",1).attr("transform",(function(t){return c(y(t))})),E.attr(u+"2",l*a),M.attr(u,l*p).text(f),b.filter(F).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=y}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=O.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:O.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:O.call(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(i=t,h):i},h.tickSize=function(t){return arguments.length?(a=o=+t,h):a},h.tickSizeInner=function(t){return arguments.length?(a=+t,h):a},h.tickSizeOuter=function(t){return arguments.length?(o=+t,h):o},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function V(t){return B(3,t)}function j(t){return B(4,t)}var H={value:function(){}};function U(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new G(r)}function G(t){this._=t}function q(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function W(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Y(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=H,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}G.prototype=U.prototype={constructor:G,on:function(t,e){var n,r=this._,i=q(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=Y(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Y(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=W(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new G(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var Q=U;function X(){}var Z=function(t){return null==t?X:function(){return this.querySelector(t)}};function J(){return[]}var K=function(t){return null==t?J:function(){return this.querySelectorAll(t)}},tt=function(t){return function(){return this.matches(t)}},et=function(t){return new Array(t.length)};function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function rt(t,e,n,r,i,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new nt(t,a[s]);for(;s<l;++s)(o=e[s])&&(i[s]=o)}function it(t,e,n,r,i,a,o){var s,l,u,c={},h=e.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(f[s]=u="$"+o.call(l,l.__data__,s,e),u in c?i[s]=l:c[u]=l);for(s=0;s<d;++s)(l=c[u="$"+o.call(t,a[s],s,a)])?(r[s]=l,l.__data__=a[s],c[u]=null):n[s]=new nt(t,a[s]);for(s=0;s<h;++s)(l=e[s])&&c[f[s]]===l&&(i[s]=l)}function at(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ot="http://www.w3.org/1999/xhtml",st={svg:"http://www.w3.org/2000/svg",xhtml:ot,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},lt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),st.hasOwnProperty(e)?{space:st[e],local:t}:t};function ut(t){return function(){this.removeAttribute(t)}}function ct(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ht(t,e){return function(){this.setAttribute(t,e)}}function dt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ft(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function pt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var mt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function gt(t){return function(){this.style.removeProperty(t)}}function vt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function yt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function bt(t,e){return t.style.getPropertyValue(e)||mt(t).getComputedStyle(t,null).getPropertyValue(e)}function xt(t){return function(){delete this[t]}}function _t(t,e){return function(){this[t]=e}}function wt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function St(t){return t.trim().split(/^|\s+/)}function Et(t){return t.classList||new Mt(t)}function Mt(t){this._node=t,this._names=St(t.getAttribute("class")||"")}function Ct(t,e){for(var n=Et(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Tt(t,e){for(var n=Et(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function kt(t){return function(){Ct(this,t)}}function Pt(t){return function(){Tt(this,t)}}function At(t,e){return function(){(e.apply(this,arguments)?Ct:Tt)(this,t)}}Mt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ot(){this.textContent=""}function Nt(t){return function(){this.textContent=t}}function Rt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Lt(){this.innerHTML=""}function It(t){return function(){this.innerHTML=t}}function Dt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function zt(){this.nextSibling&&this.parentNode.appendChild(this)}function Ft(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ot&&e.documentElement.namespaceURI===ot?e.createElement(t):e.createElementNS(n,t)}}function Vt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var jt=function(t){var e=lt(t);return(e.local?Vt:Bt)(e)};function Ht(){return null}function Ut(){var t=this.parentNode;t&&t.removeChild(this)}function Gt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var Wt={},$t=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Wt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Yt(t,e,n){return t=Qt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Qt(t,e,n){return function(r){var i=$t;$t=r;try{t.call(this,this.__data__,e,n)}finally{$t=i}}}function Xt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Zt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function Jt(t,e,n){var r=Wt.hasOwnProperty(t.type)?Yt:Qt;return function(i,a,o){var s,l=this.__on,u=r(e,a,o);if(l)for(var c=0,h=l.length;c<h;++c)if((s=l[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function Kt(t,e,n,r){var i=$t;t.sourceEvent=$t,$t=t;try{return e.apply(n,r)}finally{$t=i}}function te(t,e,n){var r=mt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ee(t,e){return function(){return te(this,t,e)}}function ne(t,e){return function(){return te(this,t,e.apply(this,arguments))}}var re=[null];function ie(t,e){this._groups=t,this._parents=e}function ae(){return new ie([[document.documentElement]],re)}ie.prototype=ae.prototype={constructor:ie,select:function(t){"function"!=typeof t&&(t=Z(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new ie(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new ie(r,i)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new ie(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n,r=e?it:rt,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),l=new Array(o),u=new Array(o),c=0;c<o;++c){var h=i[c],d=a[c],f=d.length,p=t.call(h,h&&h.__data__,c,i),m=p.length,g=l[c]=new Array(m),v=s[c]=new Array(m);r(h,d,g,v,u[c]=new Array(f),p,e);for(var y,b,x=0,_=0;x<m;++x)if(y=g[x]){for(x>=_&&(_=x+1);!(b=v[_])&&++_<m;);y._next=b||null}}return(s=new ie(s,i))._enter=l,s._exit=u,s},enter:function(){return new ie(this._enter||this._groups.map(et),this._parents)},exit:function(){return new ie(this._exit||this._groups.map(et),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(d[f]=l);for(;s<r;++s)o[s]=e[s];return new ie(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=at);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(e)}return new ie(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=lt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?ct:ut:"function"==typeof e?n.local?pt:ft:n.local?dt:ht)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?gt:"function"==typeof e?yt:vt)(t,e,null==n?"":n)):bt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?xt:"function"==typeof e?wt:_t)(t,e)):this.node()[t]},classed:function(t,e){var n=St(t+"");if(arguments.length<2){for(var r=Et(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?At:e?kt:Pt)(n,e))},text:function(t){return arguments.length?this.each(null==t?Ot:("function"==typeof t?Rt:Nt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Lt:("function"==typeof t?Dt:It)(t)):this.node().innerHTML},raise:function(){return this.each(zt)},lower:function(){return this.each(Ft)},append:function(t){var e="function"==typeof t?t:jt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:jt(t),r=null==e?Ht:"function"==typeof e?e:Z(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ut)},clone:function(t){return this.select(t?qt:Gt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=Xt(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?Jt:Zt,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ne:ee)(t,e))}};var oe=ae,se=function(t){return"string"==typeof t?new ie([[document.querySelector(t)]],[document.documentElement]):new ie([[t]],re)};function le(){$t.stopImmediatePropagation()}var ue=function(){$t.preventDefault(),$t.stopImmediatePropagation()},ce=function(t){var e=t.document.documentElement,n=se(t).on("dragstart.drag",ue,!0);"onselectstart"in e?n.on("selectstart.drag",ue,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function he(t,e){var n=t.document.documentElement,r=se(t).on("dragstart.drag",null);e&&(r.on("click.drag",ue,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var de=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function fe(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function pe(){}var me="\\s*([+-]?\\d+)\\s*",ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ve="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ye=/^#([0-9a-f]{3,8})$/,be=new RegExp("^rgb\\("+[me,me,me]+"\\)$"),xe=new RegExp("^rgb\\("+[ve,ve,ve]+"\\)$"),_e=new RegExp("^rgba\\("+[me,me,me,ge]+"\\)$"),we=new RegExp("^rgba\\("+[ve,ve,ve,ge]+"\\)$"),Se=new RegExp("^hsl\\("+[ge,ve,ve]+"\\)$"),Ee=new RegExp("^hsla\\("+[ge,ve,ve,ge]+"\\)$"),Me={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ce(){return this.rgb().formatHex()}function Te(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ye.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Pe(e):3===n?new Re(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ae(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ae(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=be.exec(t))?new Re(e[1],e[2],e[3],1):(e=xe.exec(t))?new Re(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=_e.exec(t))?Ae(e[1],e[2],e[3],e[4]):(e=we.exec(t))?Ae(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Se.exec(t))?ze(e[1],e[2]/100,e[3]/100,1):(e=Ee.exec(t))?ze(e[1],e[2]/100,e[3]/100,e[4]):Me.hasOwnProperty(t)?Pe(Me[t]):"transparent"===t?new Re(NaN,NaN,NaN,0):null}function Pe(t){return new Re(t>>16&255,t>>8&255,255&t,1)}function Ae(t,e,n,r){return r<=0&&(t=e=n=NaN),new Re(t,e,n,r)}function Oe(t){return t instanceof pe||(t=ke(t)),t?new Re((t=t.rgb()).r,t.g,t.b,t.opacity):new Re}function Ne(t,e,n,r){return 1===arguments.length?Oe(t):new Re(t,e,n,null==r?1:r)}function Re(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Le(){return"#"+De(this.r)+De(this.g)+De(this.b)}function Ie(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function De(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ze(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ve(t,e,n,r)}function Fe(t){if(t instanceof Ve)return new Ve(t.h,t.s,t.l,t.opacity);if(t instanceof pe||(t=ke(t)),!t)return new Ve;if(t instanceof Ve)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Ve(o,s,l,t.opacity)}function Be(t,e,n,r){return 1===arguments.length?Fe(t):new Ve(t,e,n,null==r?1:r)}function Ve(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function je(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function He(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}de(pe,ke,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHsl:function(){return Fe(this).formatHsl()},formatRgb:Te,toString:Te}),de(Re,Ne,fe(pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Re(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Le,formatHex:Le,formatRgb:Ie,toString:Ie})),de(Ve,Be,fe(pe,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ve(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ve(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Re(je(t>=240?t-240:t+120,i,r),je(t,i,r),je(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ue=function(t){return function(){return t}};function Ge(t,e){return function(n){return t+n*e}}function qe(t){return 1==(t=+t)?We:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ue(isNaN(e)?n:e)}}function We(t,e){var n=e-t;return n?Ge(t,n):Ue(isNaN(t)?e:t)}var $e=function t(e){var n=qe(e);function r(t,e){var r=n((t=Ne(t)).r,(e=Ne(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=We(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Ye(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ne(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Qe=Ye((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return He((n-r/e)*e,o,i,a,s)}})),Xe=(Ye((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return He((n-r/e)*e,i,a,o,s)}})),function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}});function Ze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Je(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=ln(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}var Ke=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},tn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},en=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=ln(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},nn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rn=new RegExp(nn.source,"g");var an,on,sn=function(t,e){var n,r,i,a=nn.lastIndex=rn.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=nn.exec(t))&&(r=rn.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:tn(n,r)})),a=rn.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})},ln=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Ue(e):("number"===r?tn:"string"===r?(n=ke(e))?(e=n,$e):sn:e instanceof ke?$e:e instanceof Date?Ke:Ze(e)?Xe:Array.isArray(e)?Je:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?en:tn)(t,e)},un=function(){for(var t,e=$t;t=e.sourceEvent;)e=t;return e},cn=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},hn=function(t,e,n){arguments.length<3&&(n=e,e=un().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return cn(t,r);return null},dn=function(t){var e=un();return e.changedTouches&&(e=e.changedTouches[0]),cn(t,e)},fn=0,pn=0,mn=0,gn=0,vn=0,yn=0,bn="object"==typeof performance&&performance.now?performance:Date,xn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function _n(){return vn||(xn(wn),vn=bn.now()+yn)}function wn(){vn=0}function Sn(){this._call=this._time=this._next=null}function En(t,e,n){var r=new Sn;return r.restart(t,e,n),r}function Mn(){vn=(gn=bn.now())+yn,fn=pn=0;try{!function(){_n(),++fn;for(var t,e=an;e;)(t=vn-e._time)>=0&&e._call.call(null,t),e=e._next;--fn}()}finally{fn=0,function(){var t,e,n=an,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:an=e);on=t,Tn(r)}(),vn=0}}function Cn(){var t=bn.now(),e=t-gn;e>1e3&&(yn-=e,gn=t)}function Tn(t){fn||(pn&&(pn=clearTimeout(pn)),t-vn>24?(t<1/0&&(pn=setTimeout(Mn,t-bn.now()-yn)),mn&&(mn=clearInterval(mn))):(mn||(gn=bn.now(),mn=setInterval(Cn,1e3)),fn=1,xn(Mn)))}Sn.prototype=En.prototype={constructor:Sn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?_n():+n)+(null==e?0:+e),this._next||on===this||(on?on._next=this:an=this,on=this),this._call=t,this._time=n,Tn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tn())}};var kn=function(t,e,n){var r=new Sn;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Pn=Q("start","end","cancel","interrupt"),An=[],On=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(l){var u,c,h,d;if(1!==n.state)return s();for(u in i)if((d=i[u]).name===n.name){if(3===d.state)return kn(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(kn((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=En((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Pn,tween:An,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function Nn(t,e){var n=Ln(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Rn(t,e){var n=Ln(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Ln(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var In,Dn,zn,Fn,Bn=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}},Vn=180/Math.PI,jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Hn=function(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Vn,skewX:Math.atan(l)*Vn,scaleX:o,scaleY:s}};function Un(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],l=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:tn(t,i)},{i:l-2,x:tn(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:tn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,l),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:tn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,l),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:tn(t,n)},{i:s-2,x:tn(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var Gn=Un((function(t){return"none"===t?jn:(In||(In=document.createElement("DIV"),Dn=document.documentElement,zn=document.defaultView),In.style.transform=t,t=zn.getComputedStyle(Dn.appendChild(In),null).getPropertyValue("transform"),Dn.removeChild(In),t=t.slice(7,-1).split(","),Hn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),qn=Un((function(t){return null==t?jn:(Fn||(Fn=document.createElementNS("http://www.w3.org/2000/svg","g")),Fn.setAttribute("transform",t),(t=Fn.transform.baseVal.consolidate())?(t=t.matrix,Hn(t.a,t.b,t.c,t.d,t.e,t.f)):jn)}),", ",")",")");function Wn(t,e){var n,r;return function(){var i=Rn(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function $n(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Rn(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function Yn(t,e,n){var r=t._id;return t.each((function(){var t=Rn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Ln(t,r).value[e]}}var Qn=function(t,e){var n;return("number"==typeof e?tn:e instanceof ke?$e:(n=ke(e))?(e=n,$e):sn)(t,e)};function Xn(t){return function(){this.removeAttribute(t)}}function Zn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Jn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function Kn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function tr(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttribute(t)}}function er(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttributeNS(t.space,t.local)}}function nr(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function rr(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ir(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&rr(t,i)),n}return i._value=e,i}function ar(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&nr(t,i)),n}return i._value=e,i}function or(t,e){return function(){Nn(this,t).delay=+e.apply(this,arguments)}}function sr(t,e){return e=+e,function(){Nn(this,t).delay=e}}function lr(t,e){return function(){Rn(this,t).duration=+e.apply(this,arguments)}}function ur(t,e){return e=+e,function(){Rn(this,t).duration=e}}function cr(t,e){if("function"!=typeof e)throw new Error;return function(){Rn(this,t).ease=e}}function hr(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Nn:Rn;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var dr=oe.prototype.constructor;function fr(t){return function(){this.style.removeProperty(t)}}function pr(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function mr(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&pr(t,a,n)),r}return a._value=e,a}function gr(t){return function(e){this.textContent=t.call(this,e)}}function vr(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&gr(r)),e}return r._value=t,r}var yr=0;function br(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function xr(){return++yr}var _r=oe.prototype;br.prototype=function(t){return oe().transition(t)}.prototype={constructor:br,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Z(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,l,u=r[o],c=u.length,h=a[o]=new Array(c),d=0;d<c;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,On(h[d],e,n,d,h,Ln(s,n)));return new br(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=K(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var d,f=t.call(l,l.__data__,h,u),p=Ln(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&On(d,e,n,m,f,p);a.push(f),o.push(l)}return new br(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new br(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=u[f]||c[f])&&(d[f]=l);for(;s<r;++s)o[s]=e[s];return new br(o,this._parents,this._name,this._id)},selection:function(){return new dr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=xr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=Ln(o,e);On(o,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new br(r,this._parents,t,n)},call:_r.call,nodes:_r.nodes,node:_r.node,size:_r.size,empty:_r.empty,each:_r.each,on:function(t,e){var n=this._id;return arguments.length<2?Ln(this.node(),n).on.on(t):this.each(hr(n,t,e))},attr:function(t,e){var n=lt(t),r="transform"===n?qn:Qn;return this.attrTween(t,"function"==typeof e?(n.local?er:tr)(n,r,Yn(this,"attr."+t,e)):null==e?(n.local?Zn:Xn)(n):(n.local?Kn:Jn)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=lt(t);return this.tween(n,(r.local?ir:ar)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Gn:Qn;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=bt(this,t),o=(this.style.removeProperty(t),bt(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,fr(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=bt(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=bt(this,t)),o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s))}}(t,r,Yn(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var l=Rn(this,t),u=l.on,c=null==l.value[o]?a||(a=fr(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=bt(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,mr(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Yn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,vr(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Ln(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?Wn:$n)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?or:sr)(e,t)):Ln(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?lr:ur)(e,t)):Ln(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(cr(e,t)):Ln(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--i&&a()}};n.each((function(){var n=Rn(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))}};var wr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Sr(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return wr.time=_n(),wr;return n}oe.prototype.interrupt=function(t){return this.each((function(){Bn(this,t)}))},oe.prototype.transition=function(t){var e,n;t instanceof br?(e=t._id,t=t._name):(e=xr(),(n=wr).time=_n(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)(o=s[u])&&On(o,t,e,u,s,n||Sr(o,e));return new br(r,this._parents,t,e)};var Er=function(t){return function(){return t}},Mr=function(t,e,n){this.target=t,this.type=e,this.selection=n};function Cr(){$t.stopImmediatePropagation()}var Tr=function(){$t.preventDefault(),$t.stopImmediatePropagation()},kr={name:"drag"},Pr={name:"space"},Ar={name:"handle"},Or={name:"center"};function Nr(t){return[+t[0],+t[1]]}function Rr(t){return[Nr(t[0]),Nr(t[1])]}function Lr(t){return function(e){return hn(e,$t.touches,t)}}var Ir={name:"x",handles:["w","e"].map(Hr),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Dr={name:"y",handles:["n","s"].map(Hr),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},zr=(["n","w","e","s","nw","ne","sw","se"].map(Hr),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),Fr={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Br={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Vr={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},jr={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Hr(t){return{type:t}}function Ur(){return!$t.ctrlKey&&!$t.button}function Gr(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function qr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wr(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function $r(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Yr(){return Qr(Ir)}function Qr(t){var e,n=Gr,r=Ur,i=qr,a=!0,o=Q("start","brush","end"),s=6;function l(e){var n=e.property("__brush",m).selectAll(".overlay").data([Hr("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",zr.overlay).merge(n).each((function(){var t=Wr(this).extent;se(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([Hr("selection")]).enter().append("rect").attr("class","selection").attr("cursor",zr.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return zr[t.type]})),e.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(i).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=se(this),e=Wr(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(){if((!e||$t.touches)&&r.apply(this,arguments)){var n,i,o,s,l,h,d,f,p,m,g,v=this,y=$t.target.__data__.type,b="selection"===(a&&$t.metaKey?y="overlay":y)?kr:a&&$t.altKey?Or:Ar,x=t===Dr?null:Vr[y],_=t===Ir?null:jr[y],w=Wr(v),S=w.extent,E=w.selection,M=S[0][0],C=S[0][1],T=S[1][0],k=S[1][1],P=0,A=0,O=x&&_&&a&&$t.shiftKey,N=$t.touches?Lr($t.changedTouches[0].identifier):dn,R=N(v),L=R,I=c(v,arguments,!0).beforestart();"overlay"===y?(E&&(p=!0),w.selection=E=[[n=t===Dr?M:R[0],o=t===Ir?C:R[1]],[l=t===Dr?T:n,d=t===Ir?k:o]]):(n=E[0][0],o=E[0][1],l=E[1][0],d=E[1][1]),i=n,s=o,h=l,f=d;var D=se(v).attr("pointer-events","none"),z=D.selectAll(".overlay").attr("cursor",zr[y]);if($t.touches)I.moved=B,I.ended=j;else{var F=se($t.view).on("mousemove.brush",B,!0).on("mouseup.brush",j,!0);a&&F.on("keydown.brush",H,!0).on("keyup.brush",U,!0),ce($t.view)}Cr(),Bn(v),u.call(v),I.start()}function B(){var t=N(v);!O||m||g||(Math.abs(t[0]-L[0])>Math.abs(t[1]-L[1])?g=!0:m=!0),L=t,p=!0,Tr(),V()}function V(){var t;switch(P=L[0]-R[0],A=L[1]-R[1],b){case Pr:case kr:x&&(P=Math.max(M-n,Math.min(T-l,P)),i=n+P,h=l+P),_&&(A=Math.max(C-o,Math.min(k-d,A)),s=o+A,f=d+A);break;case Ar:x<0?(P=Math.max(M-n,Math.min(T-n,P)),i=n+P,h=l):x>0&&(P=Math.max(M-l,Math.min(T-l,P)),i=n,h=l+P),_<0?(A=Math.max(C-o,Math.min(k-o,A)),s=o+A,f=d):_>0&&(A=Math.max(C-d,Math.min(k-d,A)),s=o,f=d+A);break;case Or:x&&(i=Math.max(M,Math.min(T,n-P*x)),h=Math.max(M,Math.min(T,l+P*x))),_&&(s=Math.max(C,Math.min(k,o-A*_)),f=Math.max(C,Math.min(k,d+A*_)))}h<i&&(x*=-1,t=n,n=l,l=t,t=i,i=h,h=t,y in Fr&&z.attr("cursor",zr[y=Fr[y]])),f<s&&(_*=-1,t=o,o=d,d=t,t=s,s=f,f=t,y in Br&&z.attr("cursor",zr[y=Br[y]])),w.selection&&(E=w.selection),m&&(i=E[0][0],h=E[1][0]),g&&(s=E[0][1],f=E[1][1]),E[0][0]===i&&E[0][1]===s&&E[1][0]===h&&E[1][1]===f||(w.selection=[[i,s],[h,f]],u.call(v),I.brush())}function j(){if(Cr(),$t.touches){if($t.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else he($t.view,p),F.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),z.attr("cursor",zr.overlay),w.selection&&(E=w.selection),$r(E)&&(w.selection=null,u.call(v)),I.end()}function H(){switch($t.keyCode){case 16:O=x&&_;break;case 18:b===Ar&&(x&&(l=h-P*x,n=i+P*x),_&&(d=f-A*_,o=s+A*_),b=Or,V());break;case 32:b!==Ar&&b!==Or||(x<0?l=h-P:x>0&&(n=i-P),_<0?d=f-A:_>0&&(o=s-A),b=Pr,z.attr("cursor",zr.selection),V());break;default:return}Tr()}function U(){switch($t.keyCode){case 16:O&&(m=g=O=!1,V());break;case 18:b===Or&&(x<0?l=h:x>0&&(n=i),_<0?d=f:_>0&&(o=s),b=Ar,V());break;case 32:b===Pr&&($t.altKey?(x&&(l=h-P*x,n=i+P*x),_&&(d=f-A*_,o=s+A*_),b=Or):(x<0?l=h:x>0&&(n=i),_<0?d=f:_>0&&(o=s),b=Ar),z.attr("cursor",zr[y]),V());break;default:return}Tr()}}function f(){c(this,arguments).moved()}function p(){c(this,arguments).ended()}function m(){var e=this.__brush||{selection:null};return e.extent=Rr(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){c(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){c(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,i=c(e,arguments),a=r.selection,o=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=ln(a,o);function l(t){r.selection=1===t&&null===o?null:s(t),u.call(e),i.brush()}return null!==a&&null!==o?l:l(1)})):e.each((function(){var e=this,r=arguments,i=e.__brush,a=t.input("function"==typeof n?n.apply(e,r):n,i.extent),o=c(e,r).beforestart();Bn(e),i.selection=null===a?null:a,u.call(e),o.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Kt(new Mr(l,e,t.output(this.state.selection)),o.apply,o,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:Er(Rr(t)),l):n},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:Er(!!t),l):r},l.touchable=function(t){return arguments.length?(i="function"==typeof t?t:Er(!!t),l):i},l.handleSize=function(t){return arguments.length?(s=+t,l):s},l.keyModifiers=function(t){return arguments.length?(a=!!t,l):a},l.on=function(){var t=o.on.apply(o,arguments);return t===o?l:t},l}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Xr=Math.PI,Zr=2*Xr,Jr=Zr-1e-6;function Kr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ti(){return new Kr}Kr.prototype=ti.prototype={constructor:Kr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,l=r-e,u=a-t,c=o-e,h=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*s-l*u)>1e-6&&i){var d=n-a,f=r-o,p=s*s+l*l,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((Xr-Math.acos((p+h-m)/(2*g*v)))/2),b=y/v,x=y/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*u)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>u*f)+","+(this._x1=t+x*s)+","+(this._y1=e+x*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),l=t+o,u=e+s,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+l+","+u),n&&(h<0&&(h=h%Zr+Zr),h>Jr?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Xr)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var ei=ti;function ni(){}function ri(t,e){var n=new ni;if(t instanceof ni)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}ni.prototype=ri.prototype={constructor:ni,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var ii=ri;function ai(){}var oi=ii.prototype;function si(t,e){var n=new ai;if(t instanceof ai)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}ai.prototype=si.prototype={constructor:ai,has:oi.has,add:function(t){return this["$"+(t+="")]=t,this},remove:oi.remove,clear:oi.clear,values:oi.keys,size:oi.size,empty:oi.empty,each:oi.each};Array.prototype.slice;var li=function(t){return function(){return t}};function ui(t,e,n,r,i,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function ci(){return!$t.ctrlKey&&!$t.button}function hi(){return this.parentNode}function di(t){return null==t?{x:$t.x,y:$t.y}:t}function fi(){return navigator.maxTouchPoints||"ontouchstart"in this}ui.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var pi=function(){var t,e,n,r,i=ci,a=hi,o=di,s=fi,l={},u=Q("start","drag","end"),c=0,h=0;function d(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!r&&i.apply(this,arguments)){var o=b("mouse",a.apply(this,arguments),dn,this,arguments);o&&(se($t.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),ce($t.view),le(),n=!1,t=$t.clientX,e=$t.clientY,o("start"))}}function p(){if(ue(),!n){var r=$t.clientX-t,i=$t.clientY-e;n=r*r+i*i>h}l.mouse("drag")}function m(){se($t.view).on("mousemove.drag mouseup.drag",null),he($t.view,n),ue(),l.mouse("end")}function g(){if(i.apply(this,arguments)){var t,e,n=$t.changedTouches,r=a.apply(this,arguments),o=n.length;for(t=0;t<o;++t)(e=b(n[t].identifier,r,hn,this,arguments))&&(le(),e("start"))}}function v(){var t,e,n=$t.changedTouches,r=n.length;for(t=0;t<r;++t)(e=l[n[t].identifier])&&(ue(),e("drag"))}function y(){var t,e,n=$t.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(e=l[n[t].identifier])&&(le(),e("end"))}function b(t,e,n,r,i){var a,s,h,f=n(e,t),p=u.copy();if(Kt(new ui(d,"beforestart",a,t,c,f[0],f[1],0,0,p),(function(){return null!=($t.subject=a=o.apply(r,i))&&(s=a.x-f[0]||0,h=a.y-f[1]||0,!0)})))return function o(u){var m,g=f;switch(u){case"start":l[t]=o,m=c++;break;case"end":delete l[t],--c;case"drag":f=n(e,t),m=c}Kt(new ui(d,u,a,t,m,f[0]+s,f[1]+h,f[0]-g[0],f[1]-g[1],p),p.apply,p,[u,r,i])}}return d.filter=function(t){return arguments.length?(i="function"==typeof t?t:li(!!t),d):i},d.container=function(t){return arguments.length?(a="function"==typeof t?t:li(t),d):a},d.subject=function(t){return arguments.length?(o="function"==typeof t?t:li(t),d):o},d.touchable=function(t){return arguments.length?(s="function"==typeof t?t:li(!!t),d):s},d.on=function(){var t=u.on.apply(u,arguments);return t===u?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d},mi={},gi={};function vi(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function yi(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function bi(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function xi(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+bi(-e,6):e>9999?"+"+bi(e,6):bi(e,4))+"-"+bi(t.getUTCMonth()+1,2)+"-"+bi(t.getUTCDate(),2)+(a?"T"+bi(n,2)+":"+bi(r,2)+":"+bi(i,2)+"."+bi(a,3)+"Z":i?"T"+bi(n,2)+":"+bi(r,2)+":"+bi(i,2)+"Z":r||n?"T"+bi(n,2)+":"+bi(r,2)+"Z":"")}var _i=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,l=a<=0,u=!1;function c(){if(l)return gi;if(u)return u=!1,mi;var e,r,i=o;if(34===t.charCodeAt(i)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?l=!0:10===(r=t.charCodeAt(o++))?u=!0:13===r&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=t.charCodeAt(e=o++)))u=!0;else if(13===r)u=!0,10===t.charCodeAt(o)&&++o;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(r=c())!==gi;){for(var h=[];r!==mi&&r!==gi;)h.push(r),r=c();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?xi(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=vi(t);return function(r,i){return e(n(r),i,t)}}(t,e):vi(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=yi(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=yi(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}(","),wi=_i.parse;_i.parseRows,_i.format,_i.formatBody,_i.formatRows,_i.formatRow,_i.formatValue;function Si(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,l,u,c,h,d,f=t._root,p={data:r},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o,i=f,!(f=f[h=c<<1|u]))return i[h]=p,t;if(s=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===s&&n===l)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(m+v)/2))?m=a:v=a,(c=n>=(o=(g+y)/2))?g=o:y=o}while((h=c<<1|u)==(d=(l>=o)<<1|s>=a));return i[d]=f,i[h]=p,t}var Ei=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function Mi(t){return t[0]}function Ci(t){return t[1]}function Ti(t,e,n){var r=new ki(null==e?Mi:e,null==n?Ci:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function ki(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Pi(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Ai=Ti.prototype=ki.prototype;Ai.copy=function(){var t,e,n=new ki(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Pi(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Pi(e));return n},Ai.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return Si(this.cover(e,n),e,n,t)},Ai.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>h&&(h=i));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<a;++n)Si(this,o[n],s[n],t[n]);return this},Ai.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,l=i-n,u=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=u,u=o,l*=2,s){case 0:i=n+l,a=r+l;break;case 1:n=i-l,a=r+l;break;case 2:i=n+l,r=a-l;break;case 3:n=i-l,r=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},Ai.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ai.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ai.find=function(t,e,n){var r,i,a,o,s,l,u,c=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new Ei(m,c,h,d,f)),null==n?n=1/0:(c=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(a=l.y0)>f||(o=l.x1)<c||(s=l.y1)<h))if(m.length){var g=(i+o)/2,v=(a+s)/2;p.push(new Ei(m[3],g,v,o,s),new Ei(m[2],i,v,g,s),new Ei(m[1],g,a,o,v),new Ei(m[0],i,a,g,v)),(u=(e>=v)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var y=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=y*y+b*b;if(x<n){var _=Math.sqrt(n=x);c=t-_,h=e-_,d=t+_,f=e+_,r=m.data}}return r},Ai.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,l,u,c,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+g)/2))?p=s:g=s,(c=o>=(l=(m+v)/2))?m=l:v=l,e=f,!(f=f[h=c<<1|u]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},Ai.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Ai.root=function(){return this._root},Ai.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ai.visit=function(t){var e,n,r,i,a,o,s=[],l=this._root;for(l&&s.push(new Ei(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&l.length){var u=(r+a)/2,c=(i+o)/2;(n=l[3])&&s.push(new Ei(n,u,c,a,o)),(n=l[2])&&s.push(new Ei(n,r,c,u,o)),(n=l[1])&&s.push(new Ei(n,u,i,a,c)),(n=l[0])&&s.push(new Ei(n,r,i,u,c))}return this},Ai.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Ei(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(o+l)/2,h=(s+u)/2;(a=i[0])&&n.push(new Ei(a,o,s,c,h)),(a=i[1])&&n.push(new Ei(a,c,s,l,h)),(a=i[2])&&n.push(new Ei(a,o,h,c,u)),(a=i[3])&&n.push(new Ei(a,c,h,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Ai.x=function(t){return arguments.length?(this._x=t,this):this._x},Ai.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);var Oi=Math.PI/180,Ni=180/Math.PI;function Ri(t){if(t instanceof Ii)return new Ii(t.l,t.a,t.b,t.opacity);if(t instanceof ji)return Hi(t);t instanceof Re||(t=Oe(t));var e,n,r=Bi(t.r),i=Bi(t.g),a=Bi(t.b),o=Di((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?e=n=o:(e=Di((.4360747*r+.3850649*i+.1430804*a)/.96422),n=Di((.0139322*r+.0971045*i+.7141733*a)/.82521)),new Ii(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Li(t,e,n,r){return 1===arguments.length?Ri(t):new Ii(t,e,n,null==r?1:r)}function Ii(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Di(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function zi(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function Fi(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Bi(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Vi(t){if(t instanceof ji)return new ji(t.h,t.c,t.l,t.opacity);if(t instanceof Ii||(t=Ri(t)),0===t.a&&0===t.b)return new ji(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Ni;return new ji(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function ji(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Hi(t){if(isNaN(t.h))return new Ii(t.l,0,0,t.opacity);var e=t.h*Oi;return new Ii(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Ui(t,e){var n=We((t=Li(t)).l,(e=Li(e)).l),r=We(t.a,e.a),i=We(t.b,e.b),a=We(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Gi(t,e){for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}de(Ii,Li,fe(pe,{brighter:function(t){return new Ii(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Ii(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Re(Fi(3.1338561*(e=.96422*zi(e))-1.6168667*(t=1*zi(t))-.4906146*(n=.82521*zi(n))),Fi(-.9787684*e+1.9161415*t+.033454*n),Fi(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),de(ji,(function(t,e,n,r){return 1===arguments.length?Vi(t):new ji(t,e,n,null==r?1:r)}),fe(pe,{brighter:function(t){return new ji(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ji(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Hi(this).rgb()}}));function qi(t,e){return t[0]-e[0]||t[1]-e[1]}function Wi(t){for(var e,n,r,i=t.length,a=[0,1],o=2,s=2;s<i;++s){for(;o>1&&(e=t[a[o-2]],n=t[a[o-1]],r=t[s],(n[0]-e[0])*(r[1]-e[1])-(n[1]-e[1])*(r[0]-e[0])<=0);)--o;a[o++]=s}return a.slice(0,o)}var $i=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(qi),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var a=Wi(r),o=Wi(i),s=o[0]===a[0],l=o[o.length-1]===a[a.length-1],u=[];for(e=a.length-1;e>=0;--e)u.push(t[r[a[e]][2]]);for(e=+s;e<o.length-l;++e)u.push(t[r[o[e]][2]]);return u},Yi=function(){return Math.random()},Qi=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Yi),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var a;if(null!=r)a=r,r=null;else do{r=2*e()-1,a=2*e()-1,i=r*r+a*a}while(!i||i>1);return t+n*a*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Yi)),Xi=(function t(e){function n(){var t=Qi.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Yi),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(Yi));(function t(e){function n(t){var n=Xi.source(e)(t);return function(){return n()/t}}return n.source=t,n})(Yi),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Yi);function Zi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Ji(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var Ki=Array.prototype,ta=Ki.map,ea=Ki.slice,na={name:"implicit"};function ra(){var t=ii(),e=[],n=[],r=na;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==na)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=ii();for(var r,a,o=-1,s=n.length;++o<s;)t.has(a=(r=n[o])+"")||t.set(a,e.push(r));return i},i.range=function(t){return arguments.length?(n=ea.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return ra(e,n).unknown(r)},Zi.apply(i,arguments),i}function ia(){var t,e,n=ra().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,l=0,u=.5;function c(){var n=r().length,c=a[1]<a[0],h=a[c-0],d=a[1-c];t=(d-h)/Math.max(1,n-s+2*l),o&&(t=Math.floor(t)),h+=(d-h-t*(n-s))*u,e=t*(1-s),o&&(h=Math.round(h),e=Math.round(e));var f=b(n).map((function(e){return h+t*e}));return i(c?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],c()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,c()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,l=+t),c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),c()):s},n.paddingOuter=function(t){return arguments.length?(l=+t,c()):l},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.copy=function(){return ia(r(),a).round(o).paddingInner(s).paddingOuter(l).align(u)},Zi.apply(c(),arguments)}var aa=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},oa=function(t){return+t},sa=[0,1];function la(t){return t}function ua(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ca(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function ha(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=ua(i,r),a=n(o,a)):(r=ua(r,i),a=n(a,o)),function(t){return a(r(t))}}function da(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=ua(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=h(t,e,1,r)-1;return a[n](i[n](e))}}function fa(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function pa(){var t,e,n,r,i,a,o=sa,s=sa,l=ln,u=la;function c(){return r=Math.min(o.length,s.length)>2?da:ha,i=a=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,l)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),tn)))(n)))},h.domain=function(t){return arguments.length?(o=ta.call(t,oa),u===la||(u=ca(o)),c()):o.slice()},h.range=function(t){return arguments.length?(s=ea.call(t),c()):s.slice()},h.rangeRound=function(t){return s=ea.call(t),l=aa,c()},h.clamp=function(t){return arguments.length?(u=t?ca(o):la,h):u!==la},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}function ma(t,e){return pa()(t,e)}var ga=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function va(t){if(!(e=ga.exec(t)))throw new Error("invalid format: "+t);var e;return new ya({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ya(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}va.prototype=ya.prototype,ya.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function ba(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var xa,_a,wa,Sa,Ea=function(t){return(t=ba(Math.abs(t)))?t[1]:NaN},Ma=function(t,e){var n=ba(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Ca={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Ma(100*t,e)},r:Ma,s:function(t,e){var n=ba(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(xa=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ba(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Ta=function(t){return t},ka=Array.prototype.map,Pa=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];_a=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Ta:(e=ka.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Ta:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ka.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=va(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;"n"===y?(m=!0,y="g"):Ca[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?l:"",_=Ca[y],w=/[defgprs%]/.test(y);function S(t){var i,a,l,d=b,S=x;if("c"===y)S=_(t)+S,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==h&&(E=!1),d=(E?"("===h?h:u:"-"===h||"("===h?"":h)+d,S=("s"===y?Pa[8+xa/3]:"")+S+(E&&"("===h?")":""),w)for(i=-1,a=t.length;++i<a;)if(48>(l=t.charCodeAt(i))||l>57){S=(46===l?o+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!f&&(t=r(t,1/0));var M=d.length+t.length+S.length,C=M<p?new Array(p-M+1).join(e):"";switch(m&&f&&(t=r(C+t,C.length?p-S.length:1/0),C=""),n){case"<":t=d+t+S+C;break;case"=":t=d+C+t+S;break;case"^":t=C.slice(0,M=C.length>>1)+d+t+S+C.slice(M);break;default:t=C+d+t+S}return s(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=va(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Ea(e)/3))),i=Math.pow(10,-r),a=Pa[8+r/3];return function(t){return n(i*t)+a}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),wa=_a.format,Sa=_a.formatPrefix;var Aa=function(t,e,n,r){var i,a=M(t,e,n);switch((r=va(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ea(e)/3)))-Ea(Math.abs(t)))}(a,o))||(r.precision=i),Sa(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ea(e)-Ea(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Ea(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return wa(r)};function Oa(t){var e=t.domain;return t.ticks=function(t){var n=e();return S(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Aa(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,s=i[a],l=i[o];return l<s&&(r=s,s=l,l=r,r=a,a=o,o=r),(r=E(s,l,n))>0?r=E(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=E(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(l/r)*r,e(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(l*r)/r,e(i)),t},t}function Na(){var t=ma(la,la);return t.copy=function(){return fa(t,Na())},Zi.apply(t,arguments),Oa(t)}var Ra=new Date,La=new Date;function Ia(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return Ia((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Ra.setTime(+e),La.setTime(+r),t(Ra),t(La),Math.floor(n(Ra,La))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Da=Ia((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Da.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ia((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var za=Da,Fa=(Da.range,Ia((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));Fa.range;function Ba(t){return Ia((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Va=Ba(0),ja=Ba(1),Ha=Ba(2),Ua=Ba(3),Ga=Ba(4),qa=Ba(5),Wa=Ba(6),$a=(Va.range,ja.range,Ha.range,Ua.range,Ga.range,qa.range,Wa.range,Ia((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),Ya=$a,Qa=($a.range,Ia((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),Xa=(Qa.range,Ia((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),Za=(Xa.range,Ia((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),Ja=(Za.range,Ia((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));Ja.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Ia((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Ja:null};Ja.range;function Ka(t){return Ia((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var to=Ka(0),eo=Ka(1),no=Ka(2),ro=Ka(3),io=Ka(4),ao=Ka(5),oo=Ka(6),so=(to.range,eo.range,no.range,ro.range,io.range,ao.range,oo.range,Ia((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),lo=so,uo=(so.range,Ia((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));uo.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ia((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var co=uo;uo.range;function ho(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function fo(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function po(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var mo,go={"-":"",_:" ",0:"0"},vo=/^\s*\d+/,yo=/^%/,bo=/[\\^$*+?|[\]().{}]/g;function xo(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function _o(t){return t.replace(bo,"\\$&")}function wo(t){return new RegExp("^(?:"+t.map(_o).join("|")+")","i")}function So(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Eo(t,e,n){var r=vo.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Mo(t,e,n){var r=vo.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Co(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function To(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ko(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Po(t,e,n){var r=vo.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ao(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Oo(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function No(t,e,n){var r=vo.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Ro(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Lo(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Io(t,e,n){var r=vo.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Do(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function zo(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Fo(t,e,n){var r=vo.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Bo(t,e,n){var r=vo.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Vo(t,e,n){var r=vo.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function jo(t,e,n){var r=yo.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Ho(t,e,n){var r=vo.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Uo(t,e,n){var r=vo.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Go(t,e){return xo(t.getDate(),e,2)}function qo(t,e){return xo(t.getHours(),e,2)}function Wo(t,e){return xo(t.getHours()%12||12,e,2)}function $o(t,e){return xo(1+Ya.count(za(t),t),e,3)}function Yo(t,e){return xo(t.getMilliseconds(),e,3)}function Qo(t,e){return Yo(t,e)+"000"}function Xo(t,e){return xo(t.getMonth()+1,e,2)}function Zo(t,e){return xo(t.getMinutes(),e,2)}function Jo(t,e){return xo(t.getSeconds(),e,2)}function Ko(t){var e=t.getDay();return 0===e?7:e}function ts(t,e){return xo(Va.count(za(t)-1,t),e,2)}function es(t){var e=t.getDay();return e>=4||0===e?Ga(t):Ga.ceil(t)}function ns(t,e){return t=es(t),xo(Ga.count(za(t),t)+(4===za(t).getDay()),e,2)}function rs(t){return t.getDay()}function is(t,e){return xo(ja.count(za(t)-1,t),e,2)}function as(t,e){return xo(t.getFullYear()%100,e,2)}function os(t,e){return xo((t=es(t)).getFullYear()%100,e,2)}function ss(t,e){return xo(t.getFullYear()%1e4,e,4)}function ls(t,e){var n=t.getDay();return xo((t=n>=4||0===n?Ga(t):Ga.ceil(t)).getFullYear()%1e4,e,4)}function us(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+xo(e/60|0,"0",2)+xo(e%60,"0",2)}function cs(t,e){return xo(t.getUTCDate(),e,2)}function hs(t,e){return xo(t.getUTCHours(),e,2)}function ds(t,e){return xo(t.getUTCHours()%12||12,e,2)}function fs(t,e){return xo(1+lo.count(co(t),t),e,3)}function ps(t,e){return xo(t.getUTCMilliseconds(),e,3)}function ms(t,e){return ps(t,e)+"000"}function gs(t,e){return xo(t.getUTCMonth()+1,e,2)}function vs(t,e){return xo(t.getUTCMinutes(),e,2)}function ys(t,e){return xo(t.getUTCSeconds(),e,2)}function bs(t){var e=t.getUTCDay();return 0===e?7:e}function xs(t,e){return xo(to.count(co(t)-1,t),e,2)}function _s(t){var e=t.getUTCDay();return e>=4||0===e?io(t):io.ceil(t)}function ws(t,e){return t=_s(t),xo(io.count(co(t),t)+(4===co(t).getUTCDay()),e,2)}function Ss(t){return t.getUTCDay()}function Es(t,e){return xo(eo.count(co(t)-1,t),e,2)}function Ms(t,e){return xo(t.getUTCFullYear()%100,e,2)}function Cs(t,e){return xo((t=_s(t)).getUTCFullYear()%100,e,2)}function Ts(t,e){return xo(t.getUTCFullYear()%1e4,e,4)}function ks(t,e){var n=t.getUTCDay();return xo((t=n>=4||0===n?io(t):io.ceil(t)).getUTCFullYear()%1e4,e,4)}function Ps(){return"+0000"}function As(){return"%"}function Os(t){return+t}function Ns(t){return Math.floor(+t/1e3)}!function(t){mo=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,u=wo(i),c=So(i),h=wo(a),d=So(a),f=wo(o),p=So(o),m=wo(s),g=So(s),v=wo(l),y=So(l),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Go,e:Go,f:Qo,g:os,G:ls,H:qo,I:Wo,j:$o,L:Yo,m:Xo,M:Zo,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Os,s:Ns,S:Jo,u:Ko,U:ts,V:ns,w:rs,W:is,x:null,X:null,y:as,Y:ss,Z:us,"%":As},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:cs,e:cs,f:ms,g:Cs,G:ks,H:hs,I:ds,j:fs,L:ps,m:gs,M:vs,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Os,s:Ns,S:ys,u:bs,U:xs,V:ws,w:Ss,W:Es,x:null,X:null,y:Ms,Y:Ts,Z:Ps,"%":As},_={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return E(t,e,n,r)},d:Lo,e:Lo,f:Vo,g:Ao,G:Po,H:Do,I:Do,j:Io,L:Bo,m:Ro,M:zo,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:No,Q:Ho,s:Uo,S:Fo,u:Mo,U:Co,V:To,w:Eo,W:ko,x:function(t,e,r){return E(t,n,e,r)},X:function(t,e,n){return E(t,r,e,n)},y:Ao,Y:Po,Z:Oo,"%":jo};function w(t,e){return function(n){var r,i,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),null!=(i=go[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}}function S(t,e){return function(n){var r,i,a=po(1900,void 0,1);if(E(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=fo(po(a.y,0,1))).getUTCDay(),r=i>4||0===i?eo.ceil(r):eo(r),r=lo.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=ho(po(a.y,0,1))).getDay(),r=i>4||0===i?ja.ceil(r):ja(r),r=Ya.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?fo(po(a.y,0,1)).getUTCDay():ho(po(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,fo(a)):ho(a)}}function E(t,e,n,r){for(var i,a,o=0,s=e.length,l=n.length;o<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=_[i in go?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}(t),mo.format,mo.parse,mo.utcFormat,mo.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Rs=Ia((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Ls=(Rs.range,Ia((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),Is=(Ls.range,Ia((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));Is.range;function Ds(){var t,e,n,r,i,a=0,o=1,s=la,l=!1;function u(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return u.domain=function(i){return arguments.length?(t=r(a=+i[0]),e=r(o=+i[1]),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),u}}function zs(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Fs(){var t=Oa(Ds()(la));return t.copy=function(){return zs(t,Fs())},Ji.apply(t,arguments)}var Bs=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},Vs=function(t){return Qe(t[t.length-1])},js=Vs(new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Bs)),Hs=Vs(new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Bs)),Us=function(t){return"string"==typeof t?new ie([document.querySelectorAll(t)],[document.documentElement]):new ie([null==t?[]:t],re)},Gs=function(t){return function(){return t}};function qs(t){this._context=t}qs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Ws=function(t){return new qs(t)};function $s(t){return t[0]}function Ys(t){return t[1]}var Qs=function(){var t=$s,e=Ys,n=Gs(!0),r=null,i=Ws,a=null;function o(o){var s,l,u,c=o.length,h=!1;for(null==r&&(a=i(u=ei())),s=0;s<=c;++s)!(s<c&&n(l=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(l,s,o),+e(l,s,o));if(u)return a=null,u+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:Gs(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Gs(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Gs(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},Xs=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,Math.PI),Zs=2*Xs;var Js={draw:function(t,e){var n=Math.sqrt(e/Xs);t.moveTo(n,0),t.arc(0,0,n,0,Zs)}},Ks=(Math.sqrt(1/3),Math.sin(Xs/10)/Math.sin(7*Xs/10)),tl=(Math.sin(Zs/10),Math.cos(Zs/10),Math.sqrt(3)),el={draw:function(t,e){var n=-Math.sqrt(e/(3*tl));t.moveTo(0,2*n),t.lineTo(-tl*n,-n),t.lineTo(tl*n,-n),t.closePath()}},nl=(Math.sqrt(3),Math.sqrt(12),function(){var t=Gs(Js),e=Gs(64),n=null;function r(){var r;if(n||(n=r=ei()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:Gs(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:Gs(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r});function rl(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function il(t){this._context=t}il.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rl(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var al=function(t){return new il(t)};function ol(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function sl(t,e){this._context=t,this._k=(1-e)/6}sl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ol(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:ol(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return new sl(t,e)}return n.tension=function(e){return t(+e)},n})(0);function ll(t,e){this._context=t,this._alpha=e}ll.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>1e-12){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ul=function t(e){function n(t){return e?new ll(t,e):new sl(t,0)}return n.alpha=function(e){return t(+e)},n}(.5),cl=Array.prototype.slice,hl=function(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],s=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},dl=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function fl(t,e){return t[e]}function pl(){this._=null}function ml(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function gl(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function vl(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function yl(t){for(;t.L;)t=t.L;return t}pl.prototype={constructor:pl,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=yl(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(gl(this,n),n=(t=n).U),n.C=!1,r.C=!0,vl(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(vl(this,n),n=(t=n).U),n.C=!1,r.C=!0,gl(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,a=t.L,o=t.R;if(n=a?o?yl(o):a:o,i?i.L===t?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=o,o.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,gl(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,vl(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,gl(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,vl(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,gl(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,vl(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var bl=pl;function xl(t,e,n,r){var i=[null,null],a=Gl.push(i)-1;return i.left=t,i.right=e,n&&wl(i,t,e,n),r&&wl(i,e,t,r),Hl[t.index].halfedges.push(a),Hl[e.index].halfedges.push(a),i}function _l(t,e,n){var r=[e,n];return r.left=t,r}function wl(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Sl(t,e,n,r,i){var a,o=t[0],s=t[1],l=o[0],u=o[1],c=0,h=1,d=s[0]-l,f=s[1]-u;if(a=e-l,d||!(a>0)){if(a/=d,d<0){if(a<c)return;a<h&&(h=a)}else if(d>0){if(a>h)return;a>c&&(c=a)}if(a=r-l,d||!(a<0)){if(a/=d,d<0){if(a>h)return;a>c&&(c=a)}else if(d>0){if(a<c)return;a<h&&(h=a)}if(a=n-u,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<h&&(h=a)}else if(f>0){if(a>h)return;a>c&&(c=a)}if(a=i-u,f||!(a<0)){if(a/=f,f<0){if(a>h)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<h&&(h=a)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*d,u+c*f]),h<1&&(t[1]=[l+h*d,u+h*f]),!0)}}}}}function El(t,e,n,r,i){var a=t[1];if(a)return!0;var o,s,l=t[0],u=t.left,c=t.right,h=u[0],d=u[1],f=c[0],p=c[1],m=(h+f)/2,g=(d+p)/2;if(p===d){if(m<e||m>=r)return;if(h>f){if(l){if(l[1]>=i)return}else l=[m,n];a=[m,i]}else{if(l){if(l[1]<n)return}else l=[m,i];a=[m,n]}}else if(s=g-(o=(h-f)/(p-d))*m,o<-1||o>1)if(h>f){if(l){if(l[1]>=i)return}else l=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/o,i];a=[(n-s)/o,n]}else if(d<p){if(l){if(l[0]>=r)return}else l=[e,o*e+s];a=[r,o*r+s]}else{if(l){if(l[0]<e)return}else l=[r,o*r+s];a=[e,o*e+s]}return t[0]=l,t[1]=a,!0}function Ml(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Cl(t,e){return e[+(e.left!==t.site)]}function Tl(t,e){return e[+(e.left===t.site)]}var kl,Pl=[];function Al(){ml(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ol(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,a=n.site;if(r!==a){var o=i[0],s=i[1],l=r[0]-o,u=r[1]-s,c=a[0]-o,h=a[1]-s,d=2*(l*h-u*c);if(!(d>=-Wl)){var f=l*l+u*u,p=c*c+h*h,m=(h*f-u*p)/d,g=(l*p-c*f)/d,v=Pl.pop()||new Al;v.arc=t,v.site=i,v.x=m+o,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,b=Ul._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}Ul.insert(y,v),y||(kl=v)}}}}function Nl(t){var e=t.circle;e&&(e.P||(kl=e.N),Ul.remove(e),Pl.push(e),ml(e),t.circle=null)}var Rl=[];function Ll(){ml(this),this.edge=this.site=this.circle=null}function Il(t){var e=Rl.pop()||new Ll;return e.site=t,e}function Dl(t){Nl(t),jl.remove(t),Rl.push(t),ml(t)}function zl(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],a=t.P,o=t.N,s=[t];Dl(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<ql&&Math.abs(r-l.circle.cy)<ql;)a=l.P,s.unshift(l),Dl(l),l=a;s.unshift(l),Nl(l);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<ql&&Math.abs(r-u.circle.cy)<ql;)o=u.N,s.push(u),Dl(u),u=o;s.push(u),Nl(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],wl(u.edge,l.site,u.site,i);l=s[0],(u=s[h-1]).edge=xl(l.site,u.site,null,i),Ol(l),Ol(u)}function Fl(t){for(var e,n,r,i,a=t[0],o=t[1],s=jl._;s;)if((r=Bl(s,o)-a)>ql)s=s.L;else{if(!((i=a-Vl(s,o))>ql)){r>-ql?(e=s.P,n=s):i>-ql?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){Hl[t.index]={site:t,halfedges:[]}}(t);var l=Il(t);if(jl.insert(e,l),e||n){if(e===n)return Nl(e),n=Il(e.site),jl.insert(l,n),l.edge=n.edge=xl(e.site,l.site),Ol(e),void Ol(n);if(n){Nl(e),Nl(n);var u=e.site,c=u[0],h=u[1],d=t[0]-c,f=t[1]-h,p=n.site,m=p[0]-c,g=p[1]-h,v=2*(d*g-f*m),y=d*d+f*f,b=m*m+g*g,x=[(g*y-f*b)/v+c,(d*b-m*y)/v+h];wl(n.edge,u,p,x),l.edge=xl(u,t,null,x),n.edge=xl(t,p,null,x),Ol(e),Ol(n)}else l.edge=xl(e.site,l.site)}}function Bl(t,e){var n=t.site,r=n[0],i=n[1],a=i-e;if(!a)return r;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],l=n[1],u=l-e;if(!u)return s;var c=s-r,h=1/a-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+i-a/2)))/h+r:(r+s)/2}function Vl(t,e){var n=t.N;if(n)return Bl(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var jl,Hl,Ul,Gl,ql=1e-6,Wl=1e-12;function $l(t,e){return e[1]-t[1]||e[0]-t[0]}function Yl(t,e){var n,r,i,a=t.sort($l).pop();for(Gl=[],Hl=new Array(t.length),jl=new bl,Ul=new bl;;)if(i=kl,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(Fl(a),n=a[0],r=a[1]),a=t.pop();else{if(!i)break;zl(i.arc)}if(function(){for(var t,e,n,r,i=0,a=Hl.length;i<a;++i)if((t=Hl[i])&&(r=(e=t.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=Ml(t,Gl[e[n]]);for(o.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[o[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,a=Gl.length;a--;)El(i=Gl[a],t,e,n,r)&&Sl(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>ql||Math.abs(i[0][1]-i[1][1])>ql)||delete Gl[a]}(o,s,l,u),function(t,e,n,r){var i,a,o,s,l,u,c,h,d,f,p,m,g=Hl.length,v=!0;for(i=0;i<g;++i)if(a=Hl[i]){for(o=a.site,s=(l=a.halfedges).length;s--;)Gl[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)p=(f=Tl(a,Gl[l[s]]))[0],m=f[1],h=(c=Cl(a,Gl[l[++s%u]]))[0],d=c[1],(Math.abs(p-h)>ql||Math.abs(m-d)>ql)&&(l.splice(s,0,Gl.push(_l(o,f,Math.abs(p-t)<ql&&r-m>ql?[t,Math.abs(h-t)<ql?d:r]:Math.abs(m-r)<ql&&n-p>ql?[Math.abs(d-r)<ql?h:n,r]:Math.abs(p-n)<ql&&m-e>ql?[n,Math.abs(h-n)<ql?d:e]:Math.abs(m-e)<ql&&p-t>ql?[Math.abs(d-e)<ql?h:t,e]:null))-1),++u);u&&(v=!1)}if(v){var y,b,x,_=1/0;for(i=0,v=null;i<g;++i)(a=Hl[i])&&(x=(y=(o=a.site)[0]-t)*y+(b=o[1]-e)*b)<_&&(_=x,v=a);if(v){var w=[t,e],S=[t,r],E=[n,r],M=[n,e];v.halfedges.push(Gl.push(_l(o=v.site,w,S))-1,Gl.push(_l(o,S,E))-1,Gl.push(_l(o,E,M))-1,Gl.push(_l(o,M,w))-1)}}for(i=0;i<g;++i)(a=Hl[i])&&(a.halfedges.length||delete Hl[i])}(o,s,l,u)}this.edges=Gl,this.cells=Hl,jl=Ul=Gl=Hl=null}Yl.prototype={constructor:Yl,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Cl(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(a=(i=n.halfedges).length)for(var i,a,o,s,l,u,c=n.site,h=-1,d=e[i[a-1]],f=d.left===c?d.right:d.left;++h<a;)o=f,f=(d=e[i[h]]).left===c?d.right:d.left,o&&f&&r<o.index&&r<f.index&&(l=o,u=f,((s=c)[0]-u[0])*(l[1]-s[1])-(s[0]-l[0])*(u[1]-s[1])<0)&&t.push([c.data,o.data,f.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=a.cells[r=o],o=null,i.halfedges.forEach((function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,o=s.index)}}))}while(null!==o);return a._found=r,null==n||c<=n*n?i.site:null}};var Ql=Math.SQRT2;function Xl(t){return((t=Math.exp(t))+1/t)/2}var Zl=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],l=e[1],u=e[2],c=s-i,h=l-a,d=c*c+h*h;if(d<1e-12)r=Math.log(u/o)/Ql,n=function(t){return[i+t*c,a+t*h,o*Math.exp(Ql*t*r)]};else{var f=Math.sqrt(d),p=(u*u-o*o+4*d)/(2*o*2*f),m=(u*u-o*o-4*d)/(2*u*2*f),g=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(m*m+1)-m);r=(v-g)/Ql,n=function(t){var e,n=t*r,s=Xl(g),l=o/(2*f)*(s*(e=Ql*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+l*c,a+l*h,o*s/Xl(Ql*n+g)]}}return n.duration=1e3*r,n},Jl=function(t){return function(){return t}};function Kl(t,e,n){this.target=t,this.type=e,this.transform=n}function tu(t,e,n){this.k=t,this.x=e,this.y=n}tu.prototype={constructor:tu,scale:function(t){return 1===t?this:new tu(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new tu(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var eu=new tu(1,0,0);function nu(){$t.stopImmediatePropagation()}tu.prototype;var ru=function(){$t.preventDefault(),$t.stopImmediatePropagation()};function iu(){return!$t.ctrlKey&&!$t.button}function au(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function ou(){return this.__zoom||eu}function su(){return-$t.deltaY*(1===$t.deltaMode?.05:$t.deltaMode?1:.002)}function lu(){return navigator.maxTouchPoints||"ontouchstart"in this}function uu(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var cu=function(){var t,e,n=iu,r=au,i=uu,a=su,o=lu,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,c=Zl,h=Q("start","zoom","end"),d=0;function f(t){t.property("__zoom",ou).on("wheel.zoom",x).on("mousedown.zoom",_).on("dblclick.zoom",w).filter(o).on("touchstart.zoom",S).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new tu(e,t.x,t.y)}function m(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new tu(t.k,r,i)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function v(t,e,n){t.on("start.zoom",(function(){y(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){y(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,a=y(t,i),o=r.apply(t,i),s=null==n?g(o):"function"==typeof n?n.apply(t,i):n,l=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=t.__zoom,h="function"==typeof e?e.apply(t,i):e,d=c(u.invert(s).concat(l/u.k),h.invert(s).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=l/e[2];t=new tu(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function y(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function x(){if(n.apply(this,arguments)){var t=y(this,arguments),e=this.__zoom,r=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,a.apply(this,arguments)))),o=dn(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=e.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[o,e.invert(o)],Bn(this),t.start()}ru(),t.wheel=setTimeout(u,150),t.zoom("mouse",i(m(p(e,r),t.mouse[0],t.mouse[1]),t.extent,l))}function u(){t.wheel=null,t.end()}}function _(){if(!e&&n.apply(this,arguments)){var t=y(this,arguments,!0),r=se($t.view).on("mousemove.zoom",u,!0).on("mouseup.zoom",c,!0),a=dn(this),o=$t.clientX,s=$t.clientY;ce($t.view),nu(),t.mouse=[a,this.__zoom.invert(a)],Bn(this),t.start()}function u(){if(ru(),!t.moved){var e=$t.clientX-o,n=$t.clientY-s;t.moved=e*e+n*n>d}t.zoom("mouse",i(m(t.that.__zoom,t.mouse[0]=dn(t.that),t.mouse[1]),t.extent,l))}function c(){r.on("mousemove.zoom mouseup.zoom",null),he($t.view,t.moved),ru(),t.end()}}function w(){if(n.apply(this,arguments)){var t=this.__zoom,e=dn(this),a=t.invert(e),o=t.k*($t.shiftKey?.5:2),s=i(m(p(t,o),e,a),r.apply(this,arguments),l);ru(),u>0?se(this).transition().duration(u).call(v,s,e):se(this).call(f.transform,s)}}function S(){if(n.apply(this,arguments)){var e,r,i,a,o=$t.touches,s=o.length,l=y(this,arguments,$t.changedTouches.length===s);for(nu(),r=0;r<s;++r)i=o[r],a=[a=hn(this,o,i.identifier),this.__zoom.invert(a),i.identifier],l.touch0?l.touch1||l.touch0[2]===a[2]||(l.touch1=a,l.taps=0):(l.touch0=a,e=!0,l.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(l.taps<2&&(t=setTimeout((function(){t=null}),500)),Bn(this),l.start())}}function E(){if(this.__zooming){var e,n,r,a,o=y(this,arguments),s=$t.changedTouches,u=s.length;for(ru(),t&&(t=clearTimeout(t)),o.taps=0,e=0;e<u;++e)n=s[e],r=hn(this,s,n.identifier),o.touch0&&o.touch0[2]===n.identifier?o.touch0[0]=r:o.touch1&&o.touch1[2]===n.identifier&&(o.touch1[0]=r);if(n=o.that.__zoom,o.touch1){var c=o.touch0[0],h=o.touch0[1],d=o.touch1[0],f=o.touch1[1],g=(g=d[0]-c[0])*g+(g=d[1]-c[1])*g,v=(v=f[0]-h[0])*v+(v=f[1]-h[1])*v;n=p(n,Math.sqrt(g/v)),r=[(c[0]+d[0])/2,(c[1]+d[1])/2],a=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!o.touch0)return;r=o.touch0[0],a=o.touch0[1]}o.zoom("touch",i(m(n,r,a),o.extent,l))}}function M(){if(this.__zooming){var t,n,r=y(this,arguments),i=$t.changedTouches,a=i.length;for(nu(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<a;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var o=se(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return f.transform=function(t,e,n){var r=t.selection?t.selection():t;r.property("__zoom",ou),t!==r?v(t,e,n):r.interrupt().each((function(){y(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},f.scaleBy=function(t,e,n){f.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},f.scaleTo=function(t,e,n){f.transform(t,(function(){var t=r.apply(this,arguments),a=this.__zoom,o=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=a.invert(o),u="function"==typeof e?e.apply(this,arguments):e;return i(m(p(a,u),o,s),t,l)}),n)},f.translateBy=function(t,e,n){f.transform(t,(function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),l)}))},f.translateTo=function(t,e,n,a){f.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,s=null==a?g(t):"function"==typeof a?a.apply(this,arguments):a;return i(eu.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),a)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Kt(new Kl(f,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},f.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Jl(+t),f):a},f.filter=function(t){return arguments.length?(n="function"==typeof t?t:Jl(!!t),f):n},f.touchable=function(t){return arguments.length?(o="function"==typeof t?t:Jl(!!t),f):o},f.extent=function(t){return arguments.length?(r="function"==typeof t?t:Jl([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),f):r},f.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],f):[s[0],s[1]]},f.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],f):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},f.constrain=function(t){return arguments.length?(i=t,f):i},f.duration=function(t){return arguments.length?(u=+t,f):u},f.interpolate=function(t){return arguments.length?(c=t,f):c},f.on=function(){var t=h.on.apply(h,arguments);return t===h?f:t},f.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,f):Math.sqrt(d)},f},hu=new(n(143).Dispatcher);function du(t){hu.dispatch({type:"SELECT_MENU",menu:t})}function fu(){hu.dispatch({type:"RESIZE_EXTRACTION_RESULTS_AREA"})}function pu(t){hu.dispatch({type:"SHOW_EXTRACTION_SOURCE_PANEL",id:t})}var mu=n(13);function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_u(t);if(e){var i=_u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xu(this,n)}}function xu(t,e){return!e||"object"!==gu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wu=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(a,t);var e,n,r,i=bu(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).previousMenu=void 0,t.menu="visualization",t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"SELECT_MENU":this.selectMenu(t.menu);break;case"RESIZE_EXTRACTION_RESULTS_AREA":this.emit("resizeExtractionResultsArea");break;case"SHOW_EXTRACTION_SOURCE_PANEL":this.emit("showExtractionSourcePanel",t.id);break;case"SHOW_RESULTS_PANEL":this.emit("showResultsPanel",t.resultsPanel)}}},{key:"getMenu",value:function(){return this.menu}},{key:"getPreviousMenu",value:function(){return this.previousMenu}},{key:"selectMenu",value:function(t){this.previousMenu=this.menu,this.menu=t,this.emit("selectMenu",t)}}])&&vu(e.prototype,n),r&&vu(e,r),a}(mu.EventEmitter));hu.register(wu.handleActions.bind(wu));var Su=wu;function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cu(t,e){return(Cu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pu(t);if(e){var i=Pu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ku(this,n)}}function ku(t,e){return!e||"object"!==Eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pu(t){return(Pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Au=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cu(t,e)}(o,t);var e,n,r,a=Tu(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).menu="Visualization",t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("ul[id*=mainMenuList] li").click((function(){Us(".mainMenu").classed("active",!1);var t=$(this).attr("value");se(this).classed("active",!0),du(t)})),Su.on("selectMenu",(function(e){t.menu=e}))}},{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",id:"appHeader"},i.a.createElement("a",{className:"navbar-brand"},"TimeTubesX"),i.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarColor01","aria-controls":"navbarColor01","aria-expanded":"false","aria-label":"Toggle navigation"},i.a.createElement("span",{className:"navbar-toggler-icon"})),i.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarMainMenu"},i.a.createElement("ul",{className:"navbar-nav mr-auto",id:"mainMenuList"},i.a.createElement("li",{className:"nav-item mainMenu",value:"about"},i.a.createElement("label",{className:"nav-link menuLabel"},"About")),i.a.createElement("li",{className:"nav-item mainMenu active",value:"visualization"},i.a.createElement("label",{className:"nav-link menuLabel"},"Visualization")),i.a.createElement("li",{className:"nav-item mainMenu",value:"feature"},i.a.createElement("label",{className:"nav-link menuLabel"},"Feature Extraction")),i.a.createElement("li",{className:"nav-item mainMenu",value:"comment"},i.a.createElement("label",{className:"nav-link menuLabel"},"Comment")))))}}])&&Mu(e.prototype,n),r&&Mu(e,r),o}(i.a.Component);function Ou(t,e){setTimeout((function(){hu.dispatch({type:"UPDATE_CAMERA",id:t,cameraProp:e})}),1)}function Nu(t){hu.dispatch({type:"RESET_CAMERA",id:t})}function Ru(t,e){hu.dispatch({type:"SEARCH_TIME",id:t,dst:e})}function Lu(t,e,n){hu.dispatch({type:"UPDATE_FOCUS",id:t,zpos:e,flag:n})}function Iu(t,e,n){hu.dispatch({type:"UPDATE_MINMAXV",id:t,min:e,max:n})}function Du(t,e,n){hu.dispatch({type:"UPDATE_MINMAXH",id:t,min:e,max:n})}function zu(t,e){hu.dispatch({type:"UPDATE_TEXTURE",id:t,texture:e})}function Fu(t,e,n,r){hu.dispatch({type:"SYNCHRONIZE_TUBES",id:t,zpos:e,pos:n,deg:r})}function Bu(t,e,n){hu.dispatch({type:"TAKE_SNAPSHOT",id:t,pos:e,far:n})}function Vu(t,e){hu.dispatch({type:"SHOW_TIMETUBES_OF_TIME_SLICE",id:t,period:e})}var ju=n(1);function Hu(t,e,n){for(var r,i=t[e],a=[],o=0,s=0;s<t.length;s++)Math.abs(t[s].value-i.value)<1e-5&&(a.push(s),o++);if(1===o)r=(i.value*n.value+i.rank*n.rank)/(n.value*n.value+n.rank*n.rank);else{r=0;for(var l=0;l<a.length;l++)r+=(t[a[l]].value*n.value+t[a[l]].rank*n.rank)/(n.value*n.value+n.rank*n.rank);r/=o}return r}function Uu(t){return(Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qu(t,e){return(qu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Yu(t);if(e){var i=Yu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $u(this,n)}}function $u(t,e){return!e||"object"!==Uu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yu(t){return(Yu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qu={HU:{x:"Q/I",y:"U/I",z:"JD",r_x:"E_Q/I",r_y:"E_U/I",H:"V-J",V:"Flx(V)",PA:"PA",PD:"PD"},AUPolar:{x:"< q >",y:"< u >",z:"JD",r_x:"rms(q)",r_y:"rms(u)",PA:"PA",PD:"PD"},AUPhoto:{z:"JD",V:"V"}},Xu=["x","y","z","r_x","r_y","H","V","PA","PD"],Zu=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qu(t,e)}(a,t);var e,n,r,i=Wu(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).data=[],t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData(t.data);break;case"UPDATE_DETAIL":this.emit("updateDetail",t.id,t.zpos);break;case"UPDATE_PRIVATE_COMMENT":this.updatePrivateComment()}}},{key:"uploadData",value:function(t){var e=this.data.length;this.data.push({id:e,name:t.name,data:t}),this.emit("upload",e),this.emit("showInitSP",e)}},{key:"getAllData",value:function(){return this.data}},{key:"getAllFileNames",value:function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].name);return t}},{key:"getAllIdsFileNames",value:function(){for(var t=[],e=0;e<this.data.length;e++)t.push({id:this.data[e].id,name:this.data[e].name});return t}},{key:"getData",value:function(t){return this.data[t]}},{key:"getDataArray",value:function(t,e){for(var n={},r=this.data[t].data.meta.min.z,i=Math.ceil(this.data[t].data.meta.min.z),a=Math.floor(this.data[t].data.meta.max.z),o=i;o<=a;o+=e){var s=this.getValues(t,o-r);for(var l in s)l in n||(n[l]=[]),n[l].push(s[l]);n.z[n.z.length-1]=o}return n.arrayLength=a-i+1,n}},{key:"getDataNum",value:function(){return this.data.length}},{key:"getTailID",value:function(){return this.data[this.data.length-1].id||0}},{key:"getFileName",value:function(t){return this.data[t].name||""}},{key:"getValues",value:function(t,e){if(t<0)return{};var n,r,i,a,o,s,l=e+this.data[t].data.meta.min.z;for(n=1;n<this.data[t].data.splines.position.points.length&&!(this.data[t].data.splines.position.points[n-1].z<=l&&l<this.data[t].data.splines.position.points[n].z);n++);if(r=l===this.data[t].data.meta.min.z||n<0?0:l===this.data[t].data.splines.position.points[this.data[t].data.splines.position.points.length-1].z||n>this.data[t].data.splines.position.points.length-1?1:(n-1+(l-this.data[t].data.splines.position.points[n-1].z)/(this.data[t].data.splines.position.points[n].z-this.data[t].data.splines.position.points[n-1].z))/(this.data[t].data.splines.position.points.length-1),this.data[t].data.splines.hue.points.length>0){for(a=1;a<this.data[t].data.splines.hue.points.length&&!(this.data[t].data.splines.hue.points[a-1].z<=l&&l<this.data[t].data.splines.hue.points[a].z);a++);i=a>=this.data[t].data.splines.hue.points.length-1?1:(a-1+(l-this.data[t].data.splines.hue.points[a-1].z)/(this.data[t].data.splines.hue.points[a].z-this.data[t].data.splines.hue.points[a-1].z))/(this.data[t].data.splines.hue.points.length-1)}for(o=1;o<this.data[t].data.splines.value.points.length&&!(this.data[t].data.splines.value.points[o-1].z<=l&&l<this.data[t].data.splines.value.points[o].z);o++);s=o>=this.data[t].data.splines.value.points.length-1?1:(o-1+(l-this.data[t].data.splines.value.points[o-1].z)/(this.data[t].data.splines.value.points[o].z-this.data[t].data.splines.value.points[o-1].z))/(this.data[t].data.splines.value.points.length-1);var u,c=this.data[t].data.splines.position.getPoint(r),h=this.data[t].data.splines.radius.getPoint(r);u=i?this.data[t].data.splines.hue.getPoint(i):new ju.Vector3(0,0,c.z);var d=this.data[t].data.splines.value.getPoint(s),f=this.data[t].data.splines.PDPA.getPoint(r);return{z:c.z,x:c.x,r_x:h.x,y:c.y,r_y:h.y,V:d.y,H:u.x,PD:f.x,PA:f.y}}},{key:"getProjectedHue",value:function(t,e){var n;if(t<0)return{};var r,i=e+this.data[t].data.meta.min.z;if(this.data[t].data.hueValRanks.hue.points.length>0){for(r=1;r<this.data[t].data.hueValRanks.hue.points.length&&!(this.data[t].data.hueValRanks.hue.points[r-1].z<=i&&i<this.data[t].data.hueValRanks.hue.points[r].z);r++);n=r>=this.data[t].data.hueValRanks.hue.points.length-1?1:(r-1+(i-this.data[t].data.hueValRanks.hue.points[r-1].z)/(this.data[t].data.hueValRanks.hue.points[r].z-this.data[t].data.hueValRanks.hue.points[r-1].z))/(this.data[t].data.hueValRanks.hue.points.length-1)}return(n?this.data[t].data.hueValRanks.hue.getPoint(n):new ju.Vector3(0,0,pos.z)).y}},{key:"getProjectedValue",value:function(t,e){var n;if(t<0)return{};var r,i=e+this.data[t].data.meta.min.z;if(this.data[t].data.hueValRanks.value.points.length>0){for(r=1;r<this.data[t].data.hueValRanks.value.points.length&&!(this.data[t].data.hueValRanks.value.points[r-1].z<=i&&i<this.data[t].data.hueValRanks.value.points[r].z);r++);n=r>=this.data[t].data.hueValRanks.value.points.length-1?1:(r-1+(i-this.data[t].data.hueValRanks.value.points[r-1].z)/(this.data[t].data.hueValRanks.value.points[r].z-this.data[t].data.hueValRanks.value.points[r-1].z))/(this.data[t].data.hueValRanks.value.points.length-1)}return(n?this.data[t].data.hueValRanks.value.getPoint(n):new ju.Vector3(0,0,pos.z)).y}},{key:"getIdFromName",value:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].name===t)return e;return-1}},{key:"getAverage",value:function(t,e,n){for(var r,i,a={x:0,y:0},o=0;o<n;o++)r=e+o,i=this.getValues(t,r),a.x+=i.x,a.y+=i.y;return a.x/=n,a.y/=n,a}},{key:"getDataHeaders",value:function(){return Qu}},{key:"getSpatialVar",value:function(){return Xu}},{key:"updatePrivateComment",value:function(){this.emit("updatePrivateComment")}}])&&Gu(e.prototype,n),r&&Gu(e,r),a}(mu.EventEmitter));hu.register(Zu.handleActions.bind(Zu));var Ju=Zu;function Ku(t){return(Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ec(t,e){return(ec=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ac(t);if(e){var i=ac(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return rc(this,n)}}function rc(t,e){return!e||"object"!==Ku(e)&&"function"!=typeof e?ic(t):e}function ic(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ac(t){return(ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oc={Default:[[0,1],[.05,.75],[.37,.5],[.62,.5],[.95,.25],[1,0]],Linear:[[0,1],[.25,.75],[.5,.5],[.75,.25],[1,0]],Flat:[[0,1],[.25,1],[.5,1],[.75,1],[1,1]],Valley:[[0,1],[.25,.75],[.5,.5],[.75,.75],[1,1]]},sc=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ec(t,e)}(a,t);var e,n,r,i=nc(a);function a(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).backgroundColor=0,t.initColorIdx=5,t.presetColors=["#DC143C","#FF6347","#FFA500","#FFFF00","#00FF00","#7FFFD4","#00FFFF","#00BFFF","#1E90FF","#7B68EE","#9932CC","#FF00FF","#FF69B4","#FFFFFF","#FFF8DC","#CD853F"],t.cameraProp=[{xpos:0,ypos:0,zpos:50,fov:45,far:2e3,depth:0,aspect:1,zoom:1,type:"Perspective"}],t.textureDefault;var e=new ju.TextureLoader;for(var n in e.load("img/1_256.png",function(t){this.textureDefault=t}.bind(ic(t))),t.texture=[],t.checked=[],t.focused=[],t.minmaxV=[],t.minmaxH=[],t.plotColor=[],t.gridSize=18,t.tubeNum=16,t.segment=16,t.division=5,t.visualQuery=!1,t.dragSelection=!0,t.activeId=-1,t.lock=[],t.opacityCurves={},oc){for(var r=[],o=0;o<oc[n].length;o++)r.push(new ju.Vector2(oc[n][o][0],oc[n][o][1]));t.opacityCurves[n]=new ju.SplineCurve(r)}return t.averagePeriod=0,t.wheelInterval=1,t.colorEncodingOption={hue:"default",value:"default"},t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData();break;case"UPDATE_CAMERA":this.updateCamera(t.id,t.cameraProp);break;case"SWITCH_CAMERA":this.switchCamera(t.id);break;case"RESET_CAMERA":this.resetCamera(t.id);break;case"SEARCH_TIME":this.searchTime(t.id,t.dst);break;case"UPDATE_CHECKED":this.updateChecked(t.id);break;case"SWITCH_GRID":this.switchGridDisplay(t.id,t.state);break;case"SWITCH_LABEL":this.switchLabelDisplay(t.id,t.state);break;case"SWITCH_AXIS":this.switchAxisDisplay(t.id,t.state);break;case"SWITCH_PLOT":this.switchPlotDisplay(t.id,t.state);break;case"CHANGE_BACKGROUND":this.changeBackground(t.id,t.color);break;case"CLIP_TUBE":this.clipTube(t.id,t.state);break;case"SWITCH_SHADE":this.switchShade(t.id,t.state);break;case"UPDATE_FOCUS":this.updateFocus(t.id,t.zpos,t.flag);break;case"CHANGE_FAR":this.changeFar(t.id,t.value);break;case"UPDATE_MINMAXH":this.updateMinMaxH(t.id,t.min,t.max);break;case"UPDATE_MINMAXV":this.updateMinMaxV(t.id,t.min,t.max);break;case"CHANGE_PLOTCOLOR":this.changePlotColor(t.id,t.color);break;case"SET_TEXTURE":this.setTexture(t.id,t.texture);break;case"UPDATE_TEXTURE":this.updateTexture(t.id,t.texture);break;case"ACTIVATE_VIEWPORT":this.activateViewport(t.id);break;case"TIME_FITTING":this.timeFitting(t.dst);break;case"LOCK_CONTROL":this.lockControl(t.ids,t.state);break;case"SYNCHRONIZE_TUBES":this.synchronizeTubes(t.id,t.zpos,t.pos,t.deg);break;case"ZOOM_OUT_TIMETUBE":this.zoomOutTimeTubes(t.id);break;case"RESET_ZOOM_TIMETUBES":this.resetZoomTimeTubes(t.id);break;case"ZOOM_IN_TIMETUBES":this.zoomInTimeTubes(t.id);break;case"UPDATE_OPACITY":this.updateOpacity(t.id,t.opt);break;case"TAKE_SNAPSHOT":this.takeSnapshot(t.id,t.pos,t.far);break;case"RECOVER_TUBE":this.recoverTube(t.id,t.cameraProp,t.tubePos);break;case"SHOW_TIMETUBES_OF_TIME_SLICE":this.showTimeTubesofTimeSlice(t.id,t.period);break;case"UPDATE_AVERAGE_PERIOD":this.updateAveragePeriod(t.value);break;case"SHOW_ROTATION_CENTER":this.showRotationCenter(t.id,t.period,t.center);break;case"SWITCH_COMMENT":this.switchComment(t.id,t.state);break;case"UPDATE_WHEEL_INTERVAL":this.updateWheelInterval(t.interval);break;case"UPDATE_COLOR_ENCODING_OPTION_HUE":this.updateColorEncodingOptionHue(t.id,t.option);break;case"UPDATE_COLOR_ENCODING_OPTION_VALUE":this.updateColorEncodingOptionValue(t.id,t.option)}}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"getCameraProp",value:function(t){return this.cameraProp[t]}},{key:"getDefaultCameraProp",value:function(){return{xpos:0,ypos:0,zpos:50,fov:45,far:2e3,depth:0,aspect:1,zoom:1,type:"Perspective"}}},{key:"getChecked",value:function(t){return this.checked[t]}},{key:"getCheckedList",value:function(){return this.checked}},{key:"getFocused",value:function(t){return this.focused[t]}},{key:"getMinMaxH",value:function(t){return this.minmaxH[t]}},{key:"getMinMaxV",value:function(t){return this.minmaxV[t]}},{key:"getActiveId",value:function(){return this.activeId}},{key:"getPresetColors",value:function(){return this.presetColors}},{key:"getPresetColor",value:function(t){return this.presetColors[t]}},{key:"getPresetNum",value:function(){return this.presetColors.length}},{key:"getPlotColor",value:function(t){return-1===t?void 0:this.plotColor[t]}},{key:"getInitColorIdx",value:function(){return this.initColorIdx}},{key:"getGridSize",value:function(){return this.gridSize}},{key:"getVisualQuery",value:function(){return this.visualQuery}},{key:"getTextureDefault",value:function(){return this.textureDefault}},{key:"getTexture",value:function(t){return this.texture[t]}},{key:"getTubeNum",value:function(){return this.tubeNum}},{key:"getDivision",value:function(){return this.division}},{key:"getSegment",value:function(){return this.segment}},{key:"getLock",value:function(t){return this.lock[t]}},{key:"getOpacityDistSet",value:function(){return oc}},{key:"getOpacityCurves",value:function(){return this.opacityCurves}},{key:"getOpacityCurve",value:function(t){return this.opacityCurves[t]}},{key:"getAveragePeriod",value:function(){return this.averagePeriod}},{key:"getWheelInterval",value:function(){return this.wheelInterval}},{key:"getColorEncodingOption",value:function(){return this.colorEncodingOption}},{key:"setPlotColor",value:function(t,e){this.plotColor[t]=e}},{key:"setPlotColorbyIdx",value:function(t,e){this.plotColor[t]=this.presetColors[e]}},{key:"setLock",value:function(t,e){this.lock[t]=e}},{key:"uploadData",value:function(){this.cameraProp.length,this.cameraProp.push({xpos:0,ypos:0,zpos:50,fov:45,depth:0,far:2e3,aspect:1,zoom:1,type:"Perspective"}),this.checked.push(!0),this.focused.push(0),this.minmaxV.push([0,0]),this.minmaxV.push([0,0]),this.lock.push(0),this.emit("upload")}},{key:"updateCamera",value:function(t,e){for(var n in e)this.cameraProp[t][n]=e[n];this.emit("updateCamera",t)}},{key:"resetCamera",value:function(t){this.cameraProp[t].xpos=0,this.cameraProp[t].ypos=0,this.cameraProp[t].zpos=50,this.emit("reset",t)}},{key:"switchCamera",value:function(t){"Perspective"===this.cameraProp[t].type?this.cameraProp[t].type="Orthographic":this.cameraProp[t].type="Perspective",this.emit("switch")}},{key:"searchTime",value:function(t,e){this.emit("searchTime",t,e)}},{key:"updateChecked",value:function(t){this.checked[t]=!this.checked[t],this.emit("updateChecked",t)}},{key:"switchGridDisplay",value:function(t,e){this.emit("switchGrid",t,e)}},{key:"switchLabelDisplay",value:function(t,e){this.emit("switchLabel",t,e)}},{key:"switchAxisDisplay",value:function(t,e){this.emit("switchAxis",t,e)}},{key:"switchPlotDisplay",value:function(t,e){this.emit("switchPlot",t,e)}},{key:"changeBackground",value:function(t,e){this.backgroundColor=e,this.emit("changeBackground")}},{key:"clipTube",value:function(t,e){this.emit("clipTube",t,e)}},{key:"switchShade",value:function(t,e){this.emit("switchShade",t,e)}},{key:"updateFocus",value:function(t,e,n){this.focused[t]=e,this.emit("updateFocus",t,e,n)}},{key:"changeFar",value:function(t,e){this.cameraProp[t].far=e,this.emit("changeFar",t,e)}},{key:"updateMinMaxH",value:function(t,e,n){this.minmaxH[t]=[e,n],this.emit("updateMinMaxH",t)}},{key:"updateMinMaxV",value:function(t,e,n){this.minmaxV[t]=[e,n],this.emit("updateMinMaxV",t)}},{key:"changePlotColor",value:function(t,e){this.plotColor[t]=e,this.emit("changePlotColor",t)}},{key:"setTexture",value:function(t,e){this.texture[t]=e}},{key:"updateTexture",value:function(t,e){this.texture[t]=e,this.emit("updateTexture",t,e)}},{key:"activateViewport",value:function(t){this.activeId=t}},{key:"timeFitting",value:function(t){this.emit("timeFitting",t)}},{key:"lockControl",value:function(t,e){if(e)for(var n=0;n<t.length;n++)this.lock[t[n]]=this.getFocused(t[n]);else for(var r=0;r<this.lock.length;r++)this.lock[r]=0;this.emit("lockControl",t,e)}},{key:"synchronizeTubes",value:function(t,e,n,r){this.emit("synchronizeTubes",t,e,n,r)}},{key:"zoomOutTimeTubes",value:function(t){this.cameraProp[t].zoom>=.2&&(this.cameraProp[t].zoom-=.1,this.emit("updateZoomTimeTubes",t))}},{key:"resetZoomTimeTubes",value:function(t){this.cameraProp[t].zoom=1,this.emit("updateZoomTimeTubes",t)}},{key:"zoomInTimeTubes",value:function(t){this.cameraProp[t].zoom+=.1,this.emit("updateZoomTimeTubes",t)}},{key:"updateOpacity",value:function(t,e){this.emit("updateOpacity",t,e)}},{key:"takeSnapshot",value:function(t,e,n){this.emit("takeSnapshot",t,e,n)}},{key:"recoverTube",value:function(t,e,n){for(var r in e)this.cameraProp[t][r]=e[r];this.focused[t]=n,this.emit("recoverTube",t,e,n)}},{key:"showTimeTubesofTimeSlice",value:function(t,e){this.focused[t]=e[0]-Ju.getData(t).data.meta.min.z,this.emit("showTimeTubesOfTimeSlice",t,e)}},{key:"updateAveragePeriod",value:function(t){this.averagePeriod=t,this.emit("updateAveragePeriod")}},{key:"showRotationCenter",value:function(t,e,n){this.focused[t]=e[0]-Ju.getData(t).data.meta.min.z,this.emit("showRotationCenter",t,e,n)}},{key:"switchComment",value:function(t,e){this.emit("switchComment",t,e)}},{key:"updateWheelInterval",value:function(t){this.wheelInterval=t,this.emit("updateWheelInterval")}},{key:"updateColorEncodingOptionHue",value:function(t,e){var n=Ju.getData(t).data;switch(e){case"default":this.minmaxH[t]=[n.meta.min.H,n.meta.max.H];break;case"histogramEqualization":this.minmaxH[t]=[n.hueValRanks.minmaxHue.min,n.hueValRanks.minmaxHue.max]}this.colorEncodingOption.hue=e,this.emit("updateColorEncodingOptionHue",t,e)}},{key:"updateColorEncodingOptionValue",value:function(t,e){var n=Ju.getData(t).data;switch(e){case"default":this.minmaxV=[n.meta.min.V,n.meta.max.V];break;case"histogramEqualization":this.minmaxV=[n.hueValRanks.minmaxValue.min,n.hueValRanks.minmaxValue.max]}this.colorEncodingOption.value=e,this.emit("updateColorEncodingOptionValue",t,e)}}])&&tc(e.prototype,n),r&&tc(e,r),a}(mu.EventEmitter));hu.register(sc.handleActions.bind(sc));var lc=sc;function uc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return cc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var hc=Ju.getDataHeaders(),dc=Ju.getSpatialVar();function fc(t,e){hu.dispatch({type:"UPDATE_DETAIL",id:t,zpos:e})}function pc(t,e){Ju.getDataNum();for(var n=e,r=[],i=[],a=[],o=function(e){r.push(t[e].name);var o=new FileReader;o.readAsText(t[e]),o.onload=function(){var s=o.result;console.log("csv file");var l=wi(s,(function(n){return Object.keys(n).forEach((function(t){isNaN(n[t])||(n[t]=Number(n[t]))}),n),n.source=t[e].name,n})).splice(n-1);if(i.push(l),e===t.length-1){for(var u=0;u<i.length;u++)a=a.concat(i[u]);a.sort((function(t,e){return t.JD<e.JD?-1:1}));var c=uc(mc(a),3),h=c[0],d=c[1],f=c[2],p=gc(dc,h),m=vc(h),g=yc(m.spline.hue.points,m.spline.value.points);hu.dispatch({type:"UPLOAD_DATA",data:{name:r.join("+"),data:a,spatial:h,meta:p,splines:m.spline,lookup:d,hueValRanks:g,merge:!1,polarPhotoSplit:f}})}}},s=0;s<t.length;s++)o(s)}function mc(t){for(var e=[],n={},r=!1,i=0;i<t.length;i++){e[i]={};var a="Q/I"in t[i]||"< q >"in t[i],o="Flx(V)"in t[i]||"V"in t[i];if(a&&o)for(var s in hc.HU){if(hc.HU[s]in t[i])e[i][s]=t[i][hc.HU[s]];else if("PA"===hc.HU[s]){var l=.5*Math.atan2(t[i]["U/I"],t[i]["Q/I"])*180/Math.PI;l<0&&(l+=180),e[i][s]=l}else"PD"===hc.HU[s]&&(e[i][s]=100*Math.sqrt(Math.pow(t[i]["Q/I"],2)+Math.pow(t[i]["U/I"],2)));(!n[s]||n[s].indexOf(hc.HU[s])<0)&&(n[s]||(n[s]=[]),n[s].push(hc.HU[s]))}else if(a)for(var u in r=!0,hc.AUPolar)if("z"==u)e[i][u]=t[i][hc.AUPolar[u]]-245e4,(!n[u]||n[u].indexOf(hc.AUPolar[u])<0)&&(n[u]||(n[u]=[]),n[u].push(hc.AUPolar[u]));else{if(hc.AUPolar[u]in t[i])e[i][u]=t[i][hc.AUPolar[u]]||0;else if("PA"===hc.AUPolar[u]){var c=.5*Math.atan2(t[i]["< u >"],t[i]["< q >"])*180/Math.PI;c<0&&(c+=180),e[i][u]=c}else"PD"===hc.AUPolar[u]&&(e[i][u]=100*Math.sqrt(Math.pow(t[i]["< q >"],2)+Math.pow(t[i]["< u >"],2)));(!n[u]||n[u].indexOf(hc.AUPolar[u])<0)&&(n[u]||(n[u]=[]),n[u].push(hc.AUPolar[u]))}else if(o)for(var h in r=!0,hc.AUPhoto)"z"==h?(e[i][h]=t[i][hc.AUPhoto[h]]-245e4,(!n[h]||n[h].indexOf(hc.AUPhoto[h])<0)&&(n[h]||(n[h]=[]),n[h].push(hc.AUPhoto[h]))):"V"===h?(e[i][h]=Math.pow(10,-1*(t[i][hc.AUPhoto[h]]+11.758)/2.5),(!n[h]||n[h].indexOf(hc.AUPhoto[h])<0)&&(n[h]||(n[h]=[]),n[h].push(hc.AUPhoto[h]))):(e[i][h]=t[i][hc.AUPhoto[h]]||0,(!n[h]||n[h].indexOf(hc.AUPhoto[h])<0)&&(n[h]||(n[h]=[]),n[h].push(hc.AUPhoto[h])));e[i].source=t[i].source}return[e,n,r]}function gc(t,e){for(var n={min:{},max:{},mean:{},std:{}},r=function(r){var i=t[r],a=uc(p(e,(function(t){return t[i]})),2);n.min[i]=a[0],n.max[i]=a[1],n.mean[i]=P(e,(function(t){return t[i]})),n.std[i]=f(e,(function(t){return t[i]}))},i=0;i<t.length;i++)r(i);var a=Math.max(Math.abs(n.mean.x-3*n.std.x),Math.abs(n.mean.x+3*n.std.x)),o=Math.max(Math.abs(n.mean.y-3*n.std.y),Math.abs(n.mean.y+3*n.std.y)),s=Math.max(a,o),l=Math.round(s*Math.pow(10,2-Math.ceil(Math.log10(s))));return n.range=lc.getGridSize()/(5*Math.ceil(l/5)*Math.pow(10,-(2-Math.ceil(Math.log10(s))))),n}function vc(t){var e=[],n=t[0].z,r=[],i=[],a=[],o=[],s=[];t.forEach((function(t){"x"in t&&(r.push(new ju.Vector3(t.x,t.y,t.z)),i.push(new ju.Vector3(t.r_x,t.r_y,t.z)),s.push(new ju.Vector3(t.PD,t.PA,t.z))),"H"in t&&a.push(new ju.Vector3(t.H,0,t.z)),"V"in t&&o.push(new ju.Vector3(0,t.V,t.z)),e.push(new ju.Vector3(0,0,t.z-n))}));var l={};return l.position=new ju.CatmullRomCurve3(r,!1,"catmullrom"),l.radius=new ju.CatmullRomCurve3(i,!1,"catmullrom"),l.hue=new ju.CatmullRomCurve3(a,!1,"catmullrom"),l.value=new ju.CatmullRomCurve3(o,!1,"catmullrom"),l.line=new ju.CatmullRomCurve3(e,!1,"catmullrom"),l.PDPA=new ju.CatmullRomCurve3(s,!1,"catmullrom"),{position:r,radius:i,hue:a,value:o,spline:l}}function yc(t,e){if(t.length>0&&e.length>0){var n=t.map((function(t,e){return{index:e,value:t.x,timeStamp:t.z}})),r=e.map((function(t,e){return{index:e,value:t.y,timeStamp:t.z}}));n.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0})),r.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}));var i=-1*Math.floor(Math.log10(n[0].value)),a=-1*Math.floor(Math.log10(r[0].value));if(n.length===r.length)for(var o=0;o<n.length;o++)n[o].rank=o,n[o].value*=Math.pow(10,i),r[o].rank=o,r[o].value*=Math.pow(10,a);else{for(var s=0;s<n.length;s++)n[s].rank=s,n[s].value*=Math.pow(10,i);for(var l=0;l<r.length;l++)r[l].rank=l,r[l].value*=Math.pow(10,a)}var u={rank:n.length-1,value:n[n.length-1].value-n[0].value},c={rank:r.length-1,value:r[r.length-1].value-r[0].value},h={min:n[0].index,max:n[n.length-1].index},d={min:r[0].index,max:r[r.length-1].index},f=n.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),p=r.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),m=[],g=[];if(f.length===r.length)for(var v=0;v<f.length;v++)m.push({rank:f[v].rank,value:f[v].value,timeStamp:f[v].timeStamp}),g.push({rank:p[v].rank,value:p[v].value,timeStamp:p[v].timeStamp});else{for(var y=0;y<f.length;y++)m.push({rank:f[y].rank,value:f[y].value,timeStamp:f[y].timeStamp});for(var b=0;b<p.length;b++)g.push({rank:p[b].rank,value:p[b].value,timeStamp:p[b].timeStamp})}var x,_=[],w=[];if(m.length===g.length)for(var S=0;S<m.length;S++)x=Hu(m,S,u),_.push(new ju.Vector3(m[S].value,x,m[S].timeStamp)),x=Hu(g,S,c),w.push(new ju.Vector3(g[S].value,x,g[S].timeStamp));else{for(var E=0;E<m.length;E++)x=Hu(m,E,u),_.push(new ju.Vector3(m[E].value,x,m[E].timeStamp));for(var M=0;M<g.length;M++)x=Hu(g,M,c),w.push(new ju.Vector3(g[M].value,x,g[M].timeStamp))}var C={min:Hu(m,h.min,u),max:Hu(m,h.max,u)},T={min:Hu(g,d.min,c),max:Hu(g,d.max,c)};return{hue:new ju.CatmullRomCurve3(_,!1,"catmullrom"),value:new ju.CatmullRomCurve3(w,!1,"catmullrom"),minmaxHue:C,minmaxValue:T}}if(0===t.length){var k=e.map((function(t,e){return{index:e,value:t.y,timeStamp:t.z}}));k.sort((function(t,e){return t.value<e.value?-1:t.value>e.value?1:0}));for(var P=-1*Math.floor(Math.log10(k[0].value)),A=0;A<k.length;A++)k[A].rank=A,k[A].value*=Math.pow(10,P);for(var O={rank:k.length-1,value:k[k.length-1].value-k[0].value},N={min:k[0].index,max:k[k.length-1].index},R=k.slice().sort((function(t,e){return t.index<e.index?-1:t.index>e.index?1:0})),L=[],I=0;I<R.length;I++)L.push({rank:R[I].rank,value:R[I].value,timeStamp:R[I].timeStamp});for(var D,z=[],F=0;F<L.length;F++)D=Hu(L,F,O),z.push(new ju.Vector3(L[F].value,D,L[F].timeStamp));var B={min:Hu(L,N.min,O),max:Hu(L,N.max,O)};return{hue:void 0,value:new ju.CatmullRomCurve3(z,!1,"catmullrom"),minmaxHue:void 0,minmaxValue:B}}}function bc(){hu.dispatch({type:"UPDATE_PRIVATE_COMMENT"})}function xc(t){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _c(t){var e=[];if(t>0)for(var n=-4;n<=4;n++){var r=Math.exp(-n*n/(2*t*t))/Math.sqrt(2*Math.PI*t*t);e.push({x:n,y:r})}else e.push({x:-1,y:1}),e.push({x:1,y:1});return e}function wc(t,e){return Math.exp(-t*t/(2*e*e))/Math.sqrt(2*Math.PI*e*e)}function Sc(t,e){var n={};if("object"==xc(t)&&"object"==xc(e))for(var r in t)"number"==typeof t[r]&&(n[r]=t[r]+e[r]);else if("number"==typeof t)for(var i in e)"number"==typeof e[i]&&(n[i]=t+e[i]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]+e);return n}function Ec(t,e){var n={};if("object"==xc(t)&&"object"==xc(e))for(var r in t)"number"==typeof t[r]&&(n[r]=t[r]-e[r]);else if("number"==typeof t)for(var i in e)"number"==typeof e[i]&&(n[i]=t-e[i]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]-e);return n}function Mc(t,e){var n={};if("object"==xc(t)&&"object"==xc(e))for(var r in t)"number"==typeof t[r]&&(n[r]=t[r]*e[r]);else if("number"==typeof t)for(var i in e)"number"==typeof e[i]&&(n[i]=t*e[i]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]*e);return n}function Cc(t,e){var n={};if("object"==xc(t)&&"object"==xc(e))for(var r in t)"number"==typeof t[r]&&(n[r]=t[r]/e[r]);else if("number"==typeof t)for(var i in e)"number"==typeof e[i]&&(n[i]=t/e[i]);else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=t[a]/e);return n}function Tc(t,e){var n={};if("object"==xc(t)&&"object"==xc(e))for(var r in t)"number"==typeof t[r]&&(n[r]=Math.abs(t[r]-e[r]));else if("number"==typeof t)for(var i in e)"number"==typeof e[i]&&(n[i]=Math.abs(t-e[i]));else if("number"==typeof e)for(var a in t)"number"==typeof t[a]&&(n[a]=Math.abs(t[a]-e));return n}var kc=n(144),Pc=n(6);function Ac(t){return(Ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nc(t,e){return(Nc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ic(t);if(e){var i=Ic(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lc(this,n)}}function Lc(t,e){return!e||"object"!==Ac(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ic(t){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dc=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nc(t,e)}(a,t);var e,n,r,i=Rc(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).viewportSize=18,t.gridSize=18,t.datasets=[],t.subsequences=[],t.ranges=[],t.clusterCenters=[],t.labels=[],t.clusterColors=[],t.clusteringParameters={},t.subsequenceParameters={},t.clusteringScores={},t.filteringProcess={},t.originalResults={},t.selectedSS={},t.updatedSS={},t.resultsCoordinates={},t.selectedCluster=-1,t.SSEClusters=[],t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"SHOW_CLUSTERING_RESULTS":this.showClusteringResults(t.datasets,t.subsequences,t.ranges,t.clusterCenters,t.labels,t.clusteringParameters,t.subsequenceParameters,t.clusteringScores,t.filteringProcess,t.resultsCoordinates,t.SSEClusters);break;case"SHOW_CLUSTER_DETAILS":this.showClusterDetails(t.cluster);break;case"SHOW_FILTERING_STEP":this.showFilteringStep(t.selectedProcess);break;case"UPDATE_CLUSTERING_RESULTS":this.updateClusteringResults(t.subsequences,t.clusterCenters,t.labels,t.clusteringScores,t.selectedSS,t.updatedSS,t.resultsCoordinates,t.SSEClusters);break;case"RESET_CLUSTERING_RESULTS":this.resetClusteringResults();break;case"UPDATE_SS_SELECTION":this.updateSSSelection(t.selectedSS,t.updatedSS);break;case"SHOW_TTVIEW_OF_SELECTED_SS_CLUSTERING":this.emit("showTTViewOfSelectedSSClustering",t.id,t.period);break;case"SHOW_SELECTED_SUBSEQUENCE_IN_COMPARISON_PANEL":this.showSelectedSubsequenceInComparisonPanel(t.id,t.period,t.SSId);break;case"REMOVE_SELECTED_SUBSEQUENCE_FROM_COMPARISON_PANEL":this.emit("removeSelectedSubsequenceFromComparisonPanel",t.SSId);break;case"RECOVER_CLUSTERING_SESSION":this.recoverClusteringSession(t.sessionInfo)}}},{key:"getViewportSize",value:function(){return this.viewportSize}},{key:"getGridSize",value:function(){return this.gridSize}},{key:"getDatasets",value:function(){return this.datasets}},{key:"getSubsequences",value:function(){return this.subsequences}},{key:"getRanges",value:function(){return this.ranges}},{key:"getClusterCenters",value:function(){return this.clusterCenters}},{key:"getLabels",value:function(){return this.labels}},{key:"getClusterColors",value:function(){return this.clusterColors}},{key:"getClusteringParameters",value:function(){return this.clusteringParameters}},{key:"getSubsequenceParameters",value:function(){return this.subsequenceParameters}},{key:"getClusteringScores",value:function(){return this.clusteringScores}},{key:"getFilteringProcess",value:function(){return this.filteringProcess}},{key:"getSelectedSS",value:function(){return this.selectedSS}},{key:"getUpdatedSS",value:function(){return this.updatedSS}},{key:"getSelectedCluster",value:function(){return this.selectedCluster}},{key:"getResultsCoordinates",value:function(){return this.resultsCoordinates}},{key:"getClusterOrder",value:function(){return this.clusterOrder}},{key:"getSSEClusters",value:function(){return this.SSEClusters}},{key:"showClusteringResults",value:function(t,e,n,r,i,a,o,s,l,u,c){this.datasets=t,this.subsequences=e,this.ranges=n,this.clusterCenters=r,this.labels=i;var h=this.viewportSize*Math.PI/this.clusterCenters.length;this.gridSize=.8*h,this.clusterColors=[];for(var d=0;d<this.clusterCenters.length;d++){var f=360*d/this.clusterCenters.length;this.clusterColors.push([f,.5,.5])}this.clusteringParameters=a,this.subsequenceParameters=o,this.clusteringScores=s,this.filteringProcess=l,this.originalResults={subsequences:e,clusterCenters:r,labels:i,clusteringScores:s,resultsCoordinates:u},this.selectedSS={};for(var p=0;p<t.length;p++)this.selectedSS[t[p]]=[],this.updatedSS[t[p]]=[];for(var m=0;m<t.length;m++)for(var g=0;g<e.length;g++)this.selectedSS[t[m]].push(e[g].idx);this.selectedCluster=-1,this.resultsCoordinates=u,this.SSEClusters=c,this.emit("showClusteringResults")}},{key:"showClusterDetails",value:function(t){this.selectedCluster=t,this.emit("showClusterDetails",t)}},{key:"showFilteringStep",value:function(t){this.emit("showFilteringStep",t)}},{key:"updateClusteringResults",value:function(t,e,n,r,i,a,o,s){this.subsequences=t,this.clusterCenters=e,this.labels=n,this.clusteringScores=r,this.selectedSS=i,this.updatedSS=a,this.resultsCoordinates=o,this.SSEClusters=s,this.emit("updateClusteringResults")}},{key:"resetClusteringResults",value:function(){this.subsequences=this.originalResults.subsequences,this.clusterCenters=this.originalResults.clusterCenters,this.labels=this.originalResults.labels,this.clusteringScores=this.originalResults.clusteringScores,this.resultsCoordinates=this.originalResults.resultsCoordinates,this.updatedSS=[],this.emit("resetClusteringResults")}},{key:"updateSSSelection",value:function(t,e){this.selectedSS=t,this.updatedSS=e,this.emit("updateSSSelection")}},{key:"showSelectedSubsequenceInComparisonPanel",value:function(t,e,n){this.emit("showSelectedSubsequenceInComparisonPanel",t,e,n)}},{key:"recoverClusteringSession",value:function(t){this.datasets=t.datasets,this.subsequences=t.subsequences,this.clusterCenters=t.clusterCenters,this.labels=t.labels,this.clusterColors=t.clusterColors,this.clusteringParameters=t.clusteringParameters,this.subsequenceParameters=t.subsequenceParameters,this.clusteringScores=t.clusteringScores,this.resultsCoordinates=t.resultsCoordinates,this.SSEClusters=t.SSEClusters;var e=this.viewportSize*Math.PI/this.clusterCenters.length;this.gridSize=.8*e,this.filteringProcess={},this.selectedSS={},this.updatedSS={},this.selectedCluster=-1,this.emit("recoverClusteringSession")}}])&&Oc(e.prototype,n),r&&Oc(e,r),a}(mu.EventEmitter));hu.register(Dc.handleActions.bind(Dc));var zc=Dc;function Fc(t){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vc(t,e){return(Vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Uc(t);if(e){var i=Uc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Hc(this,n)}}function Hc(t,e){return!e||"object"!==Fc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Uc(t){return(Uc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vc(t,e)}(o,t);var e,n,r,a=jc(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).id=Ju.getTailID(),t.data=Ju.getData(t.id),t.lookup=t.data.data.lookup,t.state={fileName:Ju.getFileName(t.id),currentVal:Ju.getValues(-1,0),checked:!0},t.tubeNum=lc.getTubeNum(),t.opacityDistSet=lc.getOpacityDistSet(),t.opacityCurves=lc.getOpacityCurves(),t.colormapSize=150,t.colorEncodingOption={hue:"default",value:"default"},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.setFarSlider(),this.setColormapValueSlider(),this.setColormapHueSlider(),this.setCurrentColotPlot(),this.setOpacityCurve(),this.setOpacityEllipse(),this.setCurrentColotPlot(),this.setColormapOptions(),Ju.on("upload",(function(e){-1===t.id&&(t.id=e,t.lookup=Ju.getData(e).data.lookup,t.setState({fileName:Ju.getFileName(e),currentVal:Ju.getValues(-1,0),checked:!1}))})),Ju.on("updateDetail",(function(e,n){if(t.id===e){var r,i,a,o,s=Ju.getValues(e,n);switch(t.setState({currentVal:s}),t.colorEncodingOption.hue){case"default":r=t.data.data.meta.min.H,i=t.data.data.meta.max.H;break;case"histogramEqualization":r=t.data.data.hueValRanks.minmaxHue.min,i=t.data.data.hueValRanks.minmaxHue.max}switch(t.colorEncodingOption.value){case"default":a=t.data.data.meta.min.V,o=t.data.data.meta.max.V;break;case"histogramEqualization":a=t.data.data.hueValRanks.minmaxValue.min,o=t.data.data.hueValRanks.minmaxValue.max}var l,u,c=$("#colorValue_"+t.id).slider("option","values"),h=$("#colorHue_"+t.id).slider("option","values"),d=a+(o-a)*c[0]/100,f=a+(o-a)*c[1]/100,p=r+(i-r)*h[0]/100,m=r+(i-r)*h[1]/100;"default"===t.colorEncodingOption.hue?l=(s.H-p)/(m-p):"histogramEqualization"===t.colorEncodingOption.hue&&(l=(Ju.getProjectedHue(e,n)-p)/(m-p)),l<0?l=0:1<l&&(l=1),"default"===t.colorEncodingOption.value?u=(s.V-d)/(f-d):"histogramEqualization"===t.colorEncodingOption.value&&(u=(Ju.getProjectedValue(e,n)-d)/(f-d)),u<0?u=0:1<u&&(u=1),$("#currentColorPlot_"+t.id).css("left",l*t.colormapSize+"px").css("bottom",u*t.colormapSize+"px")}})),lc.on("updateChecked",(function(e){t.id===e&&t.setState({checked:!t.state.checked})})),lc.on("updateColorEncodingOptionHue",(function(e,n){t.id===e&&(t.colorEncodingOption.hue=n,$("#colorHue_"+e).slider("option","values",[0,100]))})),lc.on("updateColorEncodingOptionValue",(function(e,n){t.id===e&&(t.colorEncodingOption.value=n,$("#colorValue_"+e).slider("option","values",[0,100]))}))}},{key:"setFarSlider",value:function(){var t=this.id,e=$("#farSliderVal_"+t);$("#farSlider_"+t).slider({range:"min",value:0,min:1,max:100,slide:function(n,r){e.css("display","initial"),e.val(r.value);var i=$("#farSlider_"+t).slider("option","min"),a=$("#farSlider_"+t).slider("option","max")-i,o=$("#farSlider_"+t).width()*(r.value-i)/a-10;e.css("left",o+"px"),function(t,e){hu.dispatch({type:"CHANGE_FAR",id:t,value:e})}(t,r.value)},stop:function(){e.css("display","none")}}),$("#farSliderVal_"+t).val($("#farSlider_"+t).slider("value"))}},{key:"setColormapValueSlider",value:function(){var t=this.id,e=$("#colorValue_"+t),n=$("#colorValueMin_"+t),r=$("#colorValueMax_"+t);e.slider({range:!0,min:0,max:100,values:[0,100],orientation:"vertical",slide:function(i,a){n.css("display","initial"),r.css("display","initial");var o,s,l=lc.getColorEncodingOption().value,u=Ju.getData(t);switch(l){case"default":o=u.data.meta.min.V,s=u.data.meta.max.V;break;case"histogramEqualization":o=u.data.hueValRanks.minmaxValue.min,s=u.data.hueValRanks.minmaxValue.max}var c=a.values[0]/100*(s-o)+o,h=a.values[1]/100*(s-o)+o;c=Math.log10(Math.abs(c))<-2&&0!==c?c.toExponential(1):c.toFixed(2),h=Math.log10(Math.abs(h))<-2&&0!==h?h.toExponential(1):h.toFixed(2),n.val(c),r.val(h);var d=e.slider("option","min"),f=e.slider("option","max")-d,p=150*(a.values[0]-d)/f-10,m=140-150*(a.values[1]-d)/f;n.css("bottom",p+"px"),r.css("top",m+"px");var g=s-o;Iu(t,a.values[0]/100*g+o,a.values[1]/100*g+o)},stop:function(){n.css("display","none"),r.css("display","none")}}),n.val(e.slider("values",0)),r.val(e.slider("values",1))}},{key:"setColormapHueSlider",value:function(){var t=this.id,e=$("#colorHue_"+t),n=$("#colorHueMin_"+t),r=$("#colorHueMax_"+t);e.slider({range:!0,min:0,max:100,values:[0,100],slide:function(e,i){n.css("display","initial"),r.css("display","initial");var a,o,s=lc.getColorEncodingOption().hue,l=Ju.getData(t);switch(s){case"default":a=l.data.meta.min.H,o=l.data.meta.max.H;break;case"histogramEqualization":a=l.data.hueValRanks.minmaxHue.min,o=l.data.hueValRanks.minmaxHue.max}var u=i.values[0]/100*(o-a)+a,c=i.values[1]/100*(o-a)+a;u=Math.log10(Math.abs(u))<-2&&0!==u?u.toExponential(1):u.toFixed(2),c=Math.log10(Math.abs(c))<-2&&0!==c?c.toExponential(1):c.toFixed(2),n.val(u),r.val(c);var h=150*i.values[0]/100-8,d=142-150*i.values[1]/100;n.css("left",h+"px"),r.css("right",d+"px");var f=o-a;Du(t,i.values[0]/100*f+a,i.values[1]/100*f+a)},stop:function(){n.css("display","none"),r.css("display","none")}}),n.val(e.slider("values",0)),r.val(e.slider("values",1))}},{key:"setCurrentColotPlot",value:function(){var t,e,n,r,i=Ju.getValues(this.id,0);switch(this.colorEncodingOption.hue){case"default":t=this.data.data.meta.min.H,e=this.data.data.meta.max.H;break;case"histogramEqualization":t=this.data.data.hueValRanks.minmaxHue.min,e=this.data.data.hueValRanks.minmaxHue.max}switch(this.colorEncodingOption.value){case"default":n=this.data.data.meta.min.V,r=this.data.data.meta.max.V;break;case"histogramEqualization":n=this.data.data.hueValRanks.minmaxValue.min,r=this.data.data.hueValRanks.minmaxValue.max}var a=(i.H-t)/(e-t);e===t||a<0?a=0:1<a&&(a=1);var o=(i.V-n)/(r-n);o<0?o=0:1<o&&(o=1),$("#currentColorPlot_"+this.id).css("left",a*this.colormapSize+"px").css("bottom",o*this.colormapSize+"px")}},{key:"setOpacityCurve",value:function(){var t=10,e=15,n=15,r=150-n-10,i=150-t-e,a=se("#opacityCurve_"+this.id).append("svg").attr("width",150).attr("height",150).attr("id","opacityCurveArea_"+this.id);a.append("rect").attr("width",r).attr("height",i).style("fill","none").style("stroke","lightgray").attr("transform","translate("+n+","+t+")");for(var o=r/(this.tubeNum-1),s=1;s<this.tubeNum;s++)a.append("line").attr("x1",o*s).attr("y1",0).attr("x2",o*s).attr("y2",r).style("stroke","lightgray").attr("transform","translate("+n+","+t+")"),a.append("line").attr("x1",0).attr("y1",o*s).attr("x2",i).attr("y2",o*s).style("stroke","lightgray").attr("transform","translate("+n+","+t+")");this.xScaleOpacity=Na().domain([0,1]).range([n,150-n]),this.yScaleOpacity=Na().domain([0,1]).range([150-t,e]),a.append("g").attr("class","axisLabel opacityCurveXAxis").append("text").attr("x",75).attr("y",150-e/2+5).style("fill","black").style("text-anchor","middle").style("font-size","xx-small").text("Radial size of the tube"),a.append("g").append("text").attr("class","axisLabel opacityCurveYAxis").attr("transform","rotate(-90)").attr("x",-75).attr("y",n/2+2).style("fill","black").style("font-size","xx-small").style("text-anchor","middle").text("Opacity"),a.append("path").datum(this.opacityDistSet.Default).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","opacityCurvePath_"+this.id).attr("d",Qs().x(function(t){return this.xScaleOpacity(t[0])}.bind(this)).y(function(t){return this.yScaleOpacity(t[1])}.bind(this)).curve(al))}},{key:"setOpacityEllipse",value:function(){var t=10,e=10,n=150-e-10,r=150-t-10,i=se("#opacityEllipse_"+this.id).append("svg").attr("width",150).attr("height",150).attr("id","opacityEllipseArea_"+this.id);i.append("rect").attr("width",n).attr("height",r).style("fill","none").style("stroke","lightgray").attr("transform","translate("+e+","+t+")");for(var a=Math.ceil(e+n/2),o=Math.ceil(t+r/2),s=this.opacityCurves.Default.getSpacedPoints(this.tubeNum),l=1;l<=this.tubeNum;l++){var u=1-(1-s[l-1].y)/(1-s[l].y);i.append("ellipse").attr("cx",a).attr("cy",o).attr("rx",50*l/this.tubeNum).attr("ry",30*l/this.tubeNum).attr("id","opacityEllipseEllipse_"+this.id+"-"+l).style("fill","orange").style("opacity",u)}}},{key:"setColormapOptions",value:function(){for(var t=Fs().domain([0,1]).interpolator(Gi(Ui,["#0000ff","#0084ff","#bb9db8","#ffb000","#ff0000"])),e=document.getElementById("colormapBCVOR_"+this.id),n=e.getContext("2d"),r=n.createLinearGradient(0,0,e.clientWidth,0),i=0;i<=10;i++)r.addColorStop(.1*i,t(.1*i));n.fillStyle=r,n.fillRect(0,0,n.canvas.width,n.canvas.height),(r=n.createLinearGradient(0,0,0,e.clientHeight)).addColorStop(0,"rgba(255, 255, 255, 0.7)"),r.addColorStop(.5,"rgba(255, 255, 255, 0)"),r.addColorStop(.5,"rgba(0, 0, 0, 0)"),r.addColorStop(1,"rgba(0, 0, 0, 0.7)"),n.fillStyle=r,n.fillRect(0,0,n.canvas.width,n.canvas.height)}},{key:"setColormapBCVOR",value:function(){for(var t=Fs().domain([0,1]).interpolator(Gi(Ui,["#0000ff","#0084ff","#bb9db8","#ffb000","#ff0000"])),e=document.getElementById("colormapCanvas_"+this.id),n=e.getContext("2d"),r=n.createLinearGradient(0,0,e.clientWidth,0),i=0;i<=50;i++)r.addColorStop(.02*i,t(.02*i));n.fillStyle=r,n.fillRect(0,0,n.canvas.width,n.canvas.height),(r=n.createLinearGradient(0,0,0,e.clientHeight)).addColorStop(0,"rgba(255, 255, 255, 0.7)"),r.addColorStop(.5,"rgba(255, 255, 255, 0)"),r.addColorStop(.5,"rgba(0, 0, 0, 0)"),r.addColorStop(1,"rgba(0, 0, 0, 0.7)"),n.fillStyle=r,n.fillRect(0,0,n.canvas.width,n.canvas.height)}},{key:"onChangeCheckbox",value:function(t){!function(t){hu.dispatch({type:"UPDATE_CHECKED",id:t})}(t)}},{key:"zoomOutTimeTubes",value:function(){var t;t=this.id,hu.dispatch({type:"ZOOM_OUT_TIMETUBE",id:t})}},{key:"resetZoomTimeTubes",value:function(){var t;t=this.id,hu.dispatch({type:"RESET_ZOOM_TIMETUBES",id:t})}},{key:"zoomInTimeTubes",value:function(){var t;t=this.id,hu.dispatch({type:"ZOOM_IN_TIMETUBES",id:t})}},{key:"showPopoverFar",value:function(){var t=$("#changeFar_"+this.id).css("visibility"),e=$("#farPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeFar_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeFar_"+this.id).css("left",e.left),$("#changeFar_"+this.id).css("visibility","visible"),$("#farSlider_"+this.id).slider("option","value",lc.getCameraProp(this.id).far)}}},{key:"showPopoverPlotColor",value:function(){var t=$("#changePlotColor_"+this.id).css("visibility"),e=$("#plotColorPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changePlotColor_"+this.id).css("visibility","hidden");break;case"hidden":$("#changePlotColor_"+this.id).css("left",e.left),$("#changePlotColor_"+this.id).css("visibility","visible")}}},{key:"showPopoverOpacity",value:function(){var t=$("#changeOpacity_"+this.id).css("visibility"),e=$("#opacityPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeOpacity_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeOpacity_"+this.id).css("left",e.left),$("#changeOpacity_"+this.id).css("visibility","visible")}}},{key:"showPopoverColormap",value:function(){var t=$("#changeColormap_"+this.id).css("visibility"),e=$("#colormapPopoverBtn_"+this.id).position();switch(t){case"visible":$("#changeColormap_"+this.id).css("visibility","hidden");break;case"hidden":$("#changeColormap_"+this.id).css("left",e.left),$("#changeColormap_"+this.id).css("visibility","visible")}}},{key:"showPopoverSearch",value:function(){var t=$("#searchTime_"+this.id).css("visibility"),e=$("#searchPopoverBtn_"+this.id).position();switch(t){case"visible":$("#searchTime_"+this.id).css("visibility","hidden");break;case"hidden":$("#searchTime_"+this.id).css("left",e.left),$("#searchTime_"+this.id).css("visibility","visible")}}},{key:"searchTime",value:function(){var t=this.id,e=$("#searchTimeInput_"+t).val();isNaN(e)||""==e||Ru(t,Number(e))}},{key:"changePlotColor",value:function(t,e){!function(t,e){hu.dispatch({type:"CHANGE_PLOTCOLOR",id:t,color:e})}(this.id,t.hex)}},{key:"changeColorMap",value:function(){$("#mask_uploadColormap_"+this.id).val($("#uploadColormap_"+this.id).val());var t=document.getElementById("uploadColormap_"+this.id).files,e=new FileReader;e.readAsDataURL(t[0]),e.onload=function(){var t=e.result;document.getElementById("colormap_"+this.id).style.backgroundImage="url("+t+")",(new ju.TextureLoader).load(t,function(t){zu(this.id,t)}.bind(this))}.bind(this)}},{key:"changeColorMapMask",value:function(){$("#uploadColormap_"+this.id).click()}},{key:"clickColormapOption",value:function(t){var e;e="string"==typeof t.target.className?t.target.className.split(" ")[1]:t.currentTarget.className.animVal.split(" ")[1];var n=new ju.TextureLoader;switch(e){case"colormapBR":$("#colormap_"+this.id).css("display","block"),$("#colormapCanvas_"+this.id).css("display","none"),document.getElementById("colormap_"+this.id).style.backgroundImage="url(../img/1_256.png)",new ju.TextureLoader,n.load("img/1_256.png",function(t){zu(this.id,t)}.bind(this));break;case"colormapRGB":$("#colormap_"+this.id).css("display","block"),$("#colormapCanvas_"+this.id).css("display","none"),document.getElementById("colormap_"+this.id).style.backgroundImage="url(../img/RGB.png)",n.load("img/RGB.png",function(t){zu(this.id,t)}.bind(this));break;case"colormapBCVOR":$("#colormap_"+this.id).css("display","none"),$("#colormapCanvas_"+this.id).css("display","block"),this.setColormapBCVOR();var r=document.getElementById("colormapCanvas_"+this.id).toDataURL();n.load(r,function(t){zu(this.id,t)}.bind(this))}}},{key:"changeOpacityDistribution",value:function(){var t,e,n=document.getElementById("opacityList_"+this.id),r=n.selectedIndex,i=n.options[r].value;this.drawOpacityCurve(i),this.drawOpacityEllipse(i),t=this.id,e=i,hu.dispatch({type:"UPDATE_OPACITY",id:t,opt:e})}},{key:"updateColorEncodingOptionHue",value:function(){var t,e,n=document.getElementById("colorEncodingOptionHue_"+this.id),r=n.selectedIndex,i=n.options[r].value;t=this.id,e=i,hu.dispatch({type:"UPDATE_COLOR_ENCODING_OPTION_HUE",id:t,option:e})}},{key:"updateColorEncodingOptionValue",value:function(){var t,e,n=document.getElementById("colorEncodingOptionValue_"+this.id),r=n.selectedIndex,i=n.options[r].value;t=this.id,e=i,hu.dispatch({type:"UPDATE_COLOR_ENCODING_OPTION_VALUE",id:t,option:e})}},{key:"drawOpacityCurve",value:function(t){se("#opacityCurvePath_"+this.id).remove(),se("#opacityCurveArea_"+this.id).append("path").datum(this.opacityDistSet[t]).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","opacityCurvePath_"+this.id).attr("d",Qs().x(function(t){return this.xScaleOpacity(t[0])}.bind(this)).y(function(t){return this.yScaleOpacity(t[1])}.bind(this)).curve(al))}},{key:"drawOpacityEllipse",value:function(t){var e=1;if("Flat"===t)for(var n=1;n<=this.tubeNum;n++)se("#opacityEllipseEllipse_"+this.id+"-"+n).style("opacity",e);else for(var r=this.opacityCurves[t].getSpacedPoints(this.tubeNum),i=1;i<=this.tubeNum;i++)e=1-(1-r[i-1].y)/(1-r[i].y),se("#opacityEllipseEllipse_"+this.id+"-"+i).style("opacity",e)}},{key:"render",value:function(){var t=this.state.currentVal,e=[];for(var n in t){var r=void 0;r="z"===n||"H"===n?t[n].toFixed(3):"V"===n?t[n].toExponential(2):t[n].toFixed(4),e.push(i.a.createElement("tr",{key:n+"_"+this.id,className:"detailTableRow"},i.a.createElement("td",{className:"detailTableData detailTableVari"},this.lookup[n]),i.a.createElement("td",{className:"detailTableData"},r)))}var a=[],o=zc.getSubsequences();if(o.length){for(var s=zc.getLabels(),l=zc.getClusterColors(),u=[],c=0;c<o.length;c++)if(Number(o[c].id)===this.id&&o[c][0].z<=t.z&&t.z<=o[c][o[c].length-1].z){var h="object"===Fc(s[c])?s[c].cluster:s[c];u.indexOf(h)<0&&u.push(h)}u.sort((function(t,e){return t-e}));for(var d=0;d<u.length;d++){var f=l[u[d]];a.push(i.a.createElement("span",{className:"clusterLabelOnView",key:u[d],style:{color:Be(f[0],f[1],f[2])}},"Cluster ",u[d]))}}return i.a.createElement("div",{id:"onViewportControllers_"+this.id},i.a.createElement("div",{id:"fileSelector_"+this.id,className:"controllersOnView",style:{position:"absolute",color:"white",top:"0px",left:"0px",zIndex:"10",fontSize:"0.8rem",marginLeft:"1.5rem"}},i.a.createElement("input",{type:"checkbox",id:"selectView_"+this.id,name:"selectView",key:this.id,value:this.id,checked:this.state.checked,onChange:this.onChangeCheckbox.bind(this,this.id)}),i.a.createElement("label",{id:"fileName_"+this.id,style:{paddingLeft:"0.5rem",paddingRight:"0.5rem"}},this.state.fileName)),i.a.createElement("div",{id:"zoomControllers_"+this.id,className:"controllersOnView",style:{position:"absolute",top:"0px",right:"0px",zIndex:"20",fontSize:"0.8rem"}},i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"zoomOutBtn_"+this.id,onClick:this.zoomOutTimeTubes.bind(this)},"-"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"resetZoomBtn_"+this.id,onClick:this.resetZoomTimeTubes.bind(this)},""),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"zoomInBtn_"+this.id,onClick:this.zoomInTimeTubes.bind(this)},"+")),i.a.createElement("div",{id:"eachTubeControllers_"+this.id,className:"controllersOnView",style:{position:"absolute",bottom:"0px",left:"0px",zIndex:"30",fontSize:"0.8rem"}},i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"colormapPopoverBtn_"+this.id,onClick:this.showPopoverColormap.bind(this)},"Colormap"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"farPopoverBtn_"+this.id,onClick:this.showPopoverFar.bind(this)},"Far"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"plotColorPopoverBtn_"+this.id,onClick:this.showPopoverPlotColor.bind(this)},"Plot Color"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"opacityPopoverBtn_"+this.id,onClick:this.showPopoverOpacity.bind(this)},"Opacity"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",id:"searchPopoverBtn_"+this.id,onClick:this.showPopoverSearch.bind(this)},"Search")),i.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeColormap_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"31"}},i.a.createElement("div",{id:"colorFilter_"+this.id},i.a.createElement("div",{className:"colormapController",style:{alignItems:"center",display:"flex"}},i.a.createElement("div",{id:"colorValue_"+this.id,style:{float:"left",height:this.colormapSize+"px"}},i.a.createElement("output",{id:"colorValueMax_"+this.id,style:{marginLeft:"1.3rem"}}),i.a.createElement("output",{id:"colorValueMin_"+this.id,style:{marginLeft:"1.3rem"}})),i.a.createElement("div",{id:"colorMapArea_"+this.id,className:"colormapArea",style:{float:"left",marginLeft:"10px"}},i.a.createElement("input",{type:"file",className:"custom-file-input colormapFile",id:"uploadColormap_"+this.id,onChange:this.changeColorMap.bind(this)}),i.a.createElement("label",{className:"fileMask"},i.a.createElement("span",{id:"colormap_"+this.id},i.a.createElement("input",{type:"text",id:"mask_uploadColormap_"+this.id,className:"colormapFile",onClick:this.changeColorMapMask.bind(this)})),i.a.createElement("canvas",{className:"colormapCanvas",id:"colormapCanvas_"+this.id,width:"150",height:"150"})),i.a.createElement("span",{className:"currentColor",id:"currentColorPlot_"+this.id})),i.a.createElement("div",{style:{clear:"both"}})),i.a.createElement("div",{id:"colorHue_"+this.id,style:{width:this.colormapSize+"px",marginTop:"5px",marginLeft:"20px"}},i.a.createElement("output",{id:"colorHueMax_"+this.id,style:{bottom:"1.3rem"}}),i.a.createElement("output",{id:"colorHueMin_"+this.id,style:{bottom:"1.3rem"}})),i.a.createElement("div",{id:"colormapOptions_"+this.id,className:"colormapOptions"},i.a.createElement("img",{src:"img/1_256.png",className:"colormapOption colormapBR",id:"colormapBR_"+this.id,style:{verticalAlign:"unset"},onClick:this.clickColormapOption.bind(this)}),i.a.createElement("img",{src:"img/RGB.png",className:"colormapOption colormapRGB",id:"colormapRGB_"+this.id,style:{verticalAlign:"unset"},onClick:this.clickColormapOption.bind(this)}),i.a.createElement("canvas",{className:"colormapOption colormapBCVOR",id:"colormapBCVOR_"+this.id,width:"30",height:"30",onClick:this.clickColormapOption.bind(this)})),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},"V-J"),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"custom-select",id:"colorEncodingOptionHue_"+this.id,style:{fontSize:"0.8rem",height:"1.5rem"},onChange:this.updateColorEncodingOptionHue.bind(this),disabled:!this.data.data.hueValRanks.minmaxHue},i.a.createElement("option",{value:"default"},"Default"),i.a.createElement("option",{value:"histogramEqualization"},"Histogram Equalization"))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},"Flx(V)"),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"custom-select",id:"colorEncodingOptionValue_"+this.id,style:{fontSize:"0.8rem",height:"1.5rem"},onChange:this.updateColorEncodingOptionValue.bind(this)},i.a.createElement("option",{value:"default"},"Default"),i.a.createElement("option",{value:"histogramEqualization"},"Histogram Equalization"))))))),i.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeFar_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"32"}},i.a.createElement("div",{id:"farSliderArea_"+this.id},i.a.createElement("label",{id:"idLabel_"+this.id,style:{float:"left",width:"2rem"}},"far"),i.a.createElement("div",{id:"farSlider_"+this.id,style:{float:"left",width:"8rem",marginBottom:".5rem",marginTop:".5rem"}},i.a.createElement("output",{id:"farSliderVal_"+this.id,style:{position:"absolute",display:"none",top:"-30px",backgroundColor:"#fff",opacity:"0.8",borderRadius:"3px",color:"#777",padding:"2px"}})))),i.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changePlotColor_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"33"}},i.a.createElement(kc.SketchPicker,{presetColors:lc.getPresetColors(),color:lc.getPlotColor(this.id),onChange:this.changePlotColor.bind(this)})),i.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"changeOpacity_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"auto",zIndex:"34",display:"block"}},i.a.createElement("select",{className:"form-control",id:"opacityList_"+this.id,onChange:this.changeOpacityDistribution.bind(this),style:{fontSize:"0.8rem",width:"150px"}},i.a.createElement("option",{value:"Default"},"Default"),i.a.createElement("option",{value:"Flat"},"Flat"),i.a.createElement("option",{value:"Linear"},"Linear"),i.a.createElement("option",{value:"Valley"},"Valley shaped")),i.a.createElement("div",{className:"currentOpacity",style:{display:"flex"}},i.a.createElement("div",{id:"opacityCurve_"+this.id}),i.a.createElement("div",{id:"opacityEllipse_"+this.id}))),i.a.createElement("div",{className:"input-group input-group-sm popover-controller",id:"searchTime_"+this.id,style:{visibility:"hidden",position:"absolute",bottom:"1.7rem",width:"10rem",zIndex:"35"}},i.a.createElement("input",{type:"text",className:"form-control custom-input",id:"searchTimeInput_"+this.id,placeholder:"Input JD"}),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"searchTimeBtn_"+this.id,onClick:this.searchTime.bind(this)},"Search")),i.a.createElement("div",{id:"clusterInfoArea_"+this.id,className:"controllersOnView",style:{position:"absolute",color:"white",textAnchor:"middle",bottom:"0px",left:"50%",transform:"translateX(-50%)"}},a),i.a.createElement("div",{id:"detailValueArea",className:"controllersOnView",style:{position:"absolute",color:"white",right:"0px",bottom:"0px",whiteSpace:"pre-line",zIndex:"11",fontSize:"0.8rem"}},i.a.createElement("table",{className:"detailTable"},i.a.createElement("tbody",{className:"detailTableBody"},e))))}}])&&Bc(e.prototype,n),r&&Bc(e,r),o}(i.a.Component);function qc(t){hu.dispatch({type:"UPDATE_SOURCE",id:t})}function Wc(t){hu.dispatch({type:"UPDATE_TARGET",ids:t})}function $c(t){hu.dispatch({type:"SWITCH_SELECTOR",selector:t})}function Yc(){hu.dispatch({type:"RESET_SELECTION"})}function Qc(t){hu.dispatch({type:"SELECT_TIMEINTERVAL",value:t})}function Xc(t){hu.dispatch({type:"UPDATE_SELECTED_PERIOD",period:t})}function Zc(t){hu.dispatch({type:"SWITCH_QUERY_MODE",mode:t})}function Jc(t){hu.dispatch({type:"SET_ACTIVE_VARIABLES",varList:t})}function Kc(t,e,n,r){hu.dispatch({type:"SET_EXTRACTION_RESULTS",parameters:t,results:e,query:n,activeVar:r})}function th(t,e,n){hu.dispatch({type:"CONVERT_RESULT_INTO_QUERY",id:t,period:e,activeVar:n})}function eh(t,e){hu.dispatch({type:"UPDATE_AE_OPTION",option:t,value:e})}function nh(t){hu.dispatch({type:"SWITCH_QBE_SELECTOR_SP",selector:t})}function rh(t){hu.dispatch({type:"UPDATE_K_VALUE",k:t})}function ih(t){hu.dispatch({type:"UPDATE_ORDER",order:t})}function ah(t){hu.dispatch({type:"RECOVER_QUERY",query:t})}function oh(t){hu.dispatch({type:"CONVERT_CLUSTER_CENTER_INTO_QUERY",clusterCenter:t})}function sh(t){hu.dispatch({type:"CHANGE_DTW_MODE",DTWMode:t})}var lh=JSON.parse(localStorage.getItem("privateComment")),uh=JSON.parse(localStorage.getItem("queryTable"));function ch(){for(var t={},e=0;e<lh.length;e++)t[lh[e].id]={timeStamp:lh[e].timeStamp,fileName:lh[e].fileName,userName:lh[e].userName,labelColor:"0x80b139",start:lh[e].start,period:void 0,comment:lh[e].comment,queryId:""};return lh=t,localStorage.setItem("privateComment",JSON.stringify(lh)),lh}function hh(){return(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16)}function dh(t){return JSON.parse(localStorage.getItem(t))}function fh(t){var e,n=!1;if(t in lh&&(e=lh[t].queryId,delete lh[t],n=!0),localStorage.setItem("privateComment",JSON.stringify(lh)),e){var r=!0;for(var i in lh)if(lh[i].queryId===e){r=!1;break}r&&(delete uh[e],localStorage.setItem("queryTable",JSON.stringify(uh)))}return n}function ph(t){return lh[t]}function mh(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),a=t.getMinutes(),o=t.getSeconds();return e+(n=n<10?"0"+n.toString():n.toString())+(r=r<10?"0"+r.toString():r.toString())+(i=i<10?"0"+i.toString():i.toString())+(a=a<10?"0"+a.toString():a.toString())+(o=o<10?"0"+o.toString():o.toString())}var gh=JSON.parse(sessionStorage.getItem("clusteringHistory"));function vh(t){return JSON.parse(sessionStorage.getItem(t))}function yh(t){var e=$("#extractionMainMenu").css("display");if("none"===t||"block"===e)$("#extractionMainMenu").css("display","none"),$("#extractionMenu").css("width","0%"),$("#extractionResults").length>0?$("#extractionResults").css("width","100%"):$("#clusteringResults").length>0&&($("#clusteringResults").css("width","100%"),$("#clusteringResultsLeftColumn").css("display","block"),$("#clusteringResultsOverview").css("width","60%"),$("#clusteringDetail").css("width","20%")),$("#collapseExtractionMenu").text("Open");else if("block"===t||"none"===e){$("#extractionMainMenu").css("display","block"),$("#extractionMenu").css("width","30%"),$("#extractionResults").length>0?$("#extractionResults").css("width","70%"):$("#clusteringResults").length>0&&($("#clusteringResults").css("width","70%"),$("#clusteringResultsLeftColumn").css("display","none"),$("#clusteringResultsOverview").css("width","70%"),$("#clusteringDetail").css("width","30%")),$("#collapseExtractionMenu").text("Close");var n=window.innerHeight-$("#appHeader").outerHeight(!0)-$("#targetDatasetsList").outerHeight(!0)-$("#extractionMenuNavTabs").outerHeight(!0);$("#extractionMenuTabs").height(n)}}function bh(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=$("#QBESourceMain").css("display");void 0!==t?t?($("#QBESourceMain").css("display","block"),$("#QBESource").css("width","30%"),$("#QBESource").css("padding","15px"),$("#extractionResults").css("width","40%"),$("#collapseSourcePanel").text("Close")):($("#QBESourceMain").css("display","none"),$("#QBESource").css("width","0%"),$("#QBESource").css("padding","0px"),$("#extractionResults").css("width","70%"),$("#collapseSourcePanel").text("Open")):"block"===e?($("#QBESourceMain").css("display","none"),$("#QBESource").css("width","0%"),$("#QBESource").css("padding","0px"),$("#extractionResults").css("width","70%"),$("#collapseSourcePanel").text("Open")):("none"===e||$("#QBESourceMain").length<=0)&&($("#QBESourceMain").css("display","block"),$("#QBESource").css("width","30%"),$("#QBESource").css("padding","15px"),$("#extractionResults").css("width","40%"),$("#collapseSourcePanel").text("Close"))}function xh(){var t=$("#resultDetailArea").css("display");"block"===t?($("#resultDetailArea").css("display","none"),$("#resultDetail").css("height","1.5rem"),$("#resultDetail").css("margin-bottom","0"),$("#collapseResultDetailPanel").text("Open")):"none"===t&&($("#resultDetailArea").css("display","block"),$("#resultDetail").css("height","auto"),$("#resultDetail").css("margin-bottom","1.5rem"),$("#collapseResultDetailPanel").text("Close"))}function _h(){for(var t=$("input[name=QBEActive]:checked"),e=[],n=0;n<t.length;n++)e.push(t[n].value);return e}function wh(t){var e=t.replace(/([A-Z])/g," $1");return e=e.charAt(0).toUpperCase()+e.slice(1)}function Sh(t){var e="",n=t.split(" ");e=n[0];for(var r=1;r<n.length;r++)e+=n[r].charAt(0).toUpperCase()+n[r].slice(1);return e=e.charAt(0).toLowerCase()+e.slice(1)}function Eh(t,e,n,r){se("#clusterLine_"+t+"_"+e).attr("stroke","black").attr("stroke-width",1.5).moveToFront(),$("#subsequenceDetailTr_"+t+"_"+e).length>0&&(Us(".clusterMemberLineChart_"+t+"_"+e).attr("stroke","#f26418"),se("#SSLengthBar_"+Math.floor(n[1]-n[0])).attr("stroke","black").attr("stroke-width",1.5),Us("tr.subsequenceDetailTr").classed("table-active",!1),se("#subsequenceDetailTr_"+t+"_"+e).classed("table-active",!0),void 0!==r[0]&&se("#clusterBeforeHistogramRects_"+r[0]).attr("stroke","black").attr("stroke-width",1.5),void 0!==r[1]&&se("#clusterAfterHistogramRects_"+r[1]).attr("stroke","black").attr("stroke-width",1.5)),$("#subsequenceTr_"+t+"_"+e).length&&(Us("tr.subsequenceTr").classed("table-active",!1),se("#subsequenceTr_"+t+"_"+e).classed("table-active",!0)),$("#updatedSubsequenceTr_"+t+"_"+e).length&&(Us("tr.updatedSubsequenceTr").classed("table-active",!1),se("#updatedSubsequenceTr_"+t+"_"+e).classed("table-active",!0)),se("#dataPointsMDS_"+t+"_"+e).attr("r",4).attr("stroke","black").attr("stroke-width",1).moveToFront()}function Mh(t,e){se("#clusterLine_"+t+"_"+e).attr("stroke-width",0),$("#subsequenceDetailTr_"+t+"_"+e).length>0&&(Us(".clusterMemberLineChart_"+t+"_"+e).attr("stroke","lightgray"),Us(".SSLengthBar").attr("stroke-width",0),se("#subsequenceDetailTr_"+t+"_"+e).classed("table-active",!1),Us("#clusterBeforeHistogramRects rect").attr("stroke-width",0),Us("#clusterAfterHistogramRects rect").attr("stroke-width",0)),$("#subsequenceTr_"+t+"_"+e).length&&se("#subsequenceTr_"+t+"_"+e).classed("table-active",!1),$("#updatedSubsequenceTr_"+t+"_"+e).length&&se("#updatedSubsequenceTr_"+t+"_"+e).classed("table-active",!1),se("#dataPointsMDS_"+t+"_"+e).attr("r",3).attr("stroke-width",0)}function Ch(t){return(Ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Th(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kh(t,e){return(kh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ph(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Oh(t);if(e){var i=Oh(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ah(this,n)}}function Ah(t,e){return!e||"object"!==Ch(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oh(t){return(Oh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Nh=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kh(t,e)}(a,t);var e,n,r,i=Ph(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).visualQuery=!1,t.mode="AE",t.AEOptions={flare:!1,rotation:!1,anomaly:!1},t.source=-1,t.target=[],t.selector=!0,t.dragSelection=!0,t.tubeAttributes=[],t.selectedPeriod=[-1,-1],t.extractionResults=[],t.query={},t.activeVar=["x","y","H","V"],t.parameters={},t.kValue=20,t.order="timeStamp",t.distanceThreshold="",t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPDATE_SOURCE":this.updateSource(t.id);break;case"UPDATE_TARGET":this.updateTarget(t.ids);break;case"SWITCH_SELECTOR":this.switchSelector(t.selector);break;case"SWITCH_DRAGSELECTION":this.switchDragSelection();break;case"RESET_SELECTION":this.resetSelection();break;case"SELECT_TIMEINTERVAL":this.selectTimeInterval(t.value);break;case"SWITCH_QUERY_MODE":this.switchQueryMode(t.mode);break;case"UPLOAD_TUBE_ATTRIBUTES":this.uploadTubeAttributes(t.id,t.position,t.color,t.indices);break;case"UPDATE_SELECTED_PERIOD":this.updateSelectedPeriod(t.period);break;case"SELECT_PERIOD_FROM_SP":this.selectPeriodfromSP(t.period);break;case"SET_ACTIVE_VARIABLES":this.setActiveVariables(t.varList);break;case"SET_EXTRACTION_RESULTS":this.setExtractionResults(t.parameters,t.results,t.query,t.activeVar);break;case"SHOW_LINE_CHARTS":this.showLineCharts(t.LC);break;case"UPDATE_SELECTED_RESULT":this.updateSelectedResult(t.result,t.width,t.height);break;case"CLEAR_RESULTS":this.emit("clearResults");break;case"SET_QUERY":this.setQuery(t.query);break;case"CONVERT_RESULT_INTO_QUERY":this.convertResultIntoQuery(t.id,t.period,t.activeVar);break;case"UPDATE_AE_OPTION":this.updateAEOption(t.option,t.value);break;case"UPDATE_SHOWN_RESULTS":this.updateShownResults(t.results);break;case"FOCUS_RESULT_FROM_TIMELINE":this.focusResultFromTimeline(t.result);break;case"SELECT_RESULT_FROM_TIMELINE":this.selectResultFromTimeline(t.result);break;case"SWITCH_QBE_SELECTOR_SP":this.switchQBESelectorSP(t.selector);break;case"UPDATE_K_VALUE":this.updateKValue(t.k);break;case"UPDATE_ORDER":this.updateOrder(t.order);break;case"UPDATE_DISTANCE_THRESHOLD":this.updateDistanceThreshold(t.threshold);break;case"RECOVER_QUERY":this.recoverQuery(t.query);break;case"IMPORT_RESULTS_FROM_FILE":this.importResultsFromFile(t.results);break;case"CONVERT_CLUSTER_CENTER_INTO_QUERY":this.convertClusterCenterIntoQuery(t.clusterCenter);break;case"CHANGE_DTW_MODE":this.emit("changeDTWMode",t.DTWMode)}}},{key:"getVisualQuery",value:function(){return this.visualQuery}},{key:"getSource",value:function(){return this.source}},{key:"getTarget",value:function(){return this.target}},{key:"getSelector",value:function(){return this.selector}},{key:"getDragSelection",value:function(){return this.dragSelection}},{key:"getSelectedPeriod",value:function(){return this.selectedPeriod}},{key:"getMode",value:function(){return this.mode}},{key:"getTubeAttributes",value:function(t){return this.tubeAttributes[t]}},{key:"getExtractionResults",value:function(){return this.extractionResults}},{key:"getActive",value:function(){return this.activeVar}},{key:"getQuery",value:function(){return this.query}},{key:"getAEOptions",value:function(){return this.AEOptions}},{key:"getAEOptionStatus",value:function(t){return this.AEOptions[t]}},{key:"getParameters",value:function(){return this.parameters}},{key:"getKValue",value:function(){return this.kValue}},{key:"getOrder",value:function(){return this.order}},{key:"getDistanceThreshold",value:function(){return this.distanceThreshold}},{key:"updateSource",value:function(t){this.source=t,this.emit("updateSource")}},{key:"updateTarget",value:function(t){this.target=t,this.emit("updateTarget")}},{key:"switchSelector",value:function(t){this.selector=t,this.emit("switchSelector")}},{key:"switchDragSelection",value:function(){this.dragSelection=!this.dragSelection,this.emit("switchDragSelection")}},{key:"resetSelection",value:function(){this.emit("resetSelection")}},{key:"resetAEOptions",value:function(){for(var t in this.AEOptions)this.AEOptions[t]=!1}},{key:"selectTimeInterval",value:function(t){var e=this.source,n=Number(t),r=lc.getFocused(Number(e))+Ju.getData(Number(e)).data.meta.min.z;this.selectedPeriod=[r,r+n],this.emit("selectTimeInterval",e,n)}},{key:"switchQueryMode",value:function(t){if(this.mode=t,"AE"!==t)for(var e in this.AEOptions)this.AEOptions[e]=!1;"QBE"!==t&&(this.source="default",this.activeVar=["x","y","H","V"],function(){for(var t=$("input[name=QBEActive]:checked"),e=0;e<t.length;e++)t[e].checked=!1}()),this.emit("switchQueryMode",t)}},{key:"uploadTubeAttributes",value:function(t,e,n,r){this.tubeAttributes[t]={position:e,color:n,indices:r},this.emit("uploadTubeAttributes")}},{key:"updateSelectedPeriod",value:function(t){this.selectedPeriod=t,this.emit("updateSelectedPeriod")}},{key:"selectPeriodfromSP",value:function(t){this.selectedPeriod=t,this.emit("updateSelectedPeriod")}},{key:"setActiveVariables",value:function(t){this.emit("setActiveVariables",t)}},{key:"setExtractionResults",value:function(t,e,n,r){this.parameters=void 0!==t?t:{},this.extractionResults=e,this.query=n,this.activeVar=void 0!==r?r:[],this.emit("setExtractionResults")}},{key:"setTexture",value:function(t){this.texture=t,this.emit("setTexture")}},{key:"showLineCharts",value:function(t){this.emit("showLineCharts",t)}},{key:"updateSelectedResult",value:function(t,e,n){this.emit("updateSelectedResult",t,e,n)}},{key:"setQuery",value:function(t){this.query=t,this.emit("setQuery")}},{key:"convertResultIntoQuery",value:function(t,e,n){"QBE"==this.mode&&(this.selectedPeriod=e,this.activeVar=n),this.emit("convertResultIntoQuery",t,e,n)}},{key:"updateAEOption",value:function(t,e){this.AEOptions[t]=e,this.emit("updateAEOption")}},{key:"updateShownResults",value:function(t){this.emit("updateShownResults",t)}},{key:"focusResultFromTimeline",value:function(t){this.emit("focusResultFromTimeline",t)}},{key:"selectResultFromTimeline",value:function(t){this.emit("selectResultFromTimeline",t)}},{key:"switchQBESelectorSP",value:function(t){this.emit("switchQBESelectorSP",t)}},{key:"updateKValue",value:function(t){this.kValue=t,this.emit("updateKValue")}},{key:"updateOrder",value:function(t){this.order=t,this.emit("updateOrder")}},{key:"updateDistanceThreshold",value:function(t){this.distanceThreshold=t,this.emit("updateDistanceThreshold")}},{key:"recoverQuery",value:function(t){if("automatic extraction"===t.mode){this.mode="AE",this.resetAEOptions();for(var e=0;e<t.option.length;e++)this.AEOptions[t.option[e]]=!0}else if("visual query"===t.mode)if("query-by-example"===t.option){this.mode="QBE",this.selectedPeriod=t.query.period,this.source=Ju.getIdFromName(t.query.source);var n=Ju.getData(this.source).data.lookup,r=[];if(t.query.inactiveVariables){for(var i=[],a=0;a<t.query.inactiveVariables.length;a++)for(var o in n)n[o].indexOf(t.query.inactiveVariables[a][0])>=0&&i.push(o);for(var s in n)i.indexOf(s)<0&&r.push(s)}else t.query.activeVariables&&(r=t.query.activeVariables);this.activeVar=r,this.parameters=t.parameters}else"query-by-sketch"===t.option&&(this.mode="QBS",this.parameters=t.parameters);for(var l=[],u=Ju.getAllData(),c=0;c<u.length;c++)l.push(u[c].id);this.target=l,this.emit("recoverQuery",t)}},{key:"importResultsFromFile",value:function(t){this.emit("importResultsFromFile",t)}},{key:"convertClusterCenterIntoQuery",value:function(t){this.emit("convertClusterCenterIntoQuery",t)}}])&&Th(e.prototype,n),r&&Th(e,r),a}(mu.EventEmitter));hu.register(Nh.handleActions.bind(Nh));var Rh=Nh,Lh=n(1);Lh.BufferGeometryUtils={computeTangents:function(t){var e=t.index,n=t.attributes;if(null!==e&&void 0!==n.position&&void 0!==n.normal&&void 0!==n.uv){var r=e.array,i=n.position.array,a=n.normal.array,o=n.uv.array,s=i.length/3;void 0===n.tangent&&t.setAttribute("tangent",new Lh.BufferAttribute(new Float32Array(4*s),4));for(var l=n.tangent.array,u=[],c=[],h=0;h<s;h++)u[h]=new Lh.Vector3,c[h]=new Lh.Vector3;var d=new Lh.Vector3,f=new Lh.Vector3,p=new Lh.Vector3,m=new Lh.Vector2,g=new Lh.Vector2,v=new Lh.Vector2,y=new Lh.Vector3,b=new Lh.Vector3,x=t.groups;0===x.length&&(x=[{start:0,count:r.length}]);h=0;for(var _=x.length;h<_;++h)for(var w=N=(O=x[h]).start,S=N+O.count;w<S;w+=3)R(r[w+0],r[w+1],r[w+2]);var E,M,C,T=new Lh.Vector3,k=new Lh.Vector3,P=new Lh.Vector3,A=new Lh.Vector3;for(h=0,_=x.length;h<_;++h){var O,N;for(w=N=(O=x[h]).start,S=N+O.count;w<S;w+=3)L(r[w+0]),L(r[w+1]),L(r[w+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function R(t,e,n){d.fromArray(i,3*t),f.fromArray(i,3*e),p.fromArray(i,3*n),m.fromArray(o,2*t),g.fromArray(o,2*e),v.fromArray(o,2*n);var r=f.x-d.x,a=p.x-d.x,s=f.y-d.y,l=p.y-d.y,h=f.z-d.z,x=p.z-d.z,_=g.x-m.x,w=v.x-m.x,S=g.y-m.y,E=v.y-m.y,M=1/(_*E-w*S);y.set((E*r-S*a)*M,(E*s-S*l)*M,(E*h-S*x)*M),b.set((_*a-w*r)*M,(_*l-w*s)*M,(_*x-w*h)*M),u[t].add(y),u[e].add(y),u[n].add(y),c[t].add(b),c[e].add(b),c[n].add(b)}function L(t){P.fromArray(a,3*t),A.copy(P),M=u[t],T.copy(M),T.sub(P.multiplyScalar(P.dot(M))).normalize(),k.crossVectors(A,M),C=k.dot(c[t]),E=C<0?-1:1,l[4*t]=T.x,l[4*t+1]=T.y,l[4*t+2]=T.z,l[4*t+3]=E}},mergeBufferGeometries:function(t,e){for(var n=null!==t[0].index,r=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),a={},o={},s=new Lh.BufferGeometry,l=0,u=0;u<t.length;++u){var c=t[u];if(n!==(null!==c.index))return null;for(var h in c.attributes){if(!r.has(h))return null;void 0===a[h]&&(a[h]=[]),a[h].push(c.attributes[h])}for(var h in c.morphAttributes){if(!i.has(h))return null;void 0===o[h]&&(o[h]=[]),o[h].push(c.morphAttributes[h])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(c.userData),e){var d;if(n)d=c.index.count;else{if(void 0===c.attributes.position)return null;d=c.attributes.position.count}s.addGroup(l,d,u),l+=d}}if(n){var f=0,p=[];for(u=0;u<t.length;++u){for(var m=t[u].index,g=0;g<m.count;++g)p.push(m.getX(g)+f);f+=t[u].attributes.position.count}s.setIndex(p)}for(var h in a){var v=this.mergeBufferAttributes(a[h]);if(!v)return null;s.setAttribute(h,v)}for(var h in o){var y=o[h][0].length;if(0===y)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[h]=[];for(u=0;u<y;++u){var b=[];for(g=0;g<o[h].length;++g)b.push(o[h][g][u]);var x=this.mergeBufferAttributes(b);if(!x)return null;s.morphAttributes[h].push(x)}}return s},mergeBufferAttributes:function(t){for(var e,n,r,i=0,a=0;a<t.length;++a){var o=t[a];if(o.isInterleavedBufferAttribute)return null;if(void 0===e&&(e=o.array.constructor),e!==o.array.constructor)return null;if(void 0===n&&(n=o.itemSize),n!==o.itemSize)return null;if(void 0===r&&(r=o.normalized),r!==o.normalized)return null;i+=o.array.length}var s=new e(i),l=0;for(a=0;a<t.length;++a)s.set(t[a].array,l),l+=t[a].array.length;return new Lh.BufferAttribute(s,n,r)},interleaveAttributes:function(t){for(var e,n=0,r=0,i=0,a=t.length;i<a;++i){var o=t[i];if(void 0===e&&(e=o.array.constructor),e!==o.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;n+=o.array.length,r+=o.itemSize}var s=new Lh.InterleavedBuffer(new e(n),r),l=0,u=[],c=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"],d=0;for(a=t.length;d<a;d++){var f=(o=t[d]).itemSize,p=o.count,m=new Lh.InterleavedBufferAttribute(s,f,l,o.normalized);u.push(m),l+=f;for(var g=0;g<p;g++)for(var v=0;v<f;v++)m[h[v]](g,o[c[v]](g))}return u},estimateBytesUsed:function(t){var e=0;for(var n in t.attributes){var r=t.getAttribute(n);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var i=t.getIndex();return e+=i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0},mergeVertices:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;e=Math.max(e,Number.EPSILON);for(var n={},r=t.getIndex(),i=t.getAttribute("position"),a=r?r.count:i.count,o=0,s=Object.keys(t.attributes),l={},u={},c=[],h=["getX","getY","getZ","getW"],d=0,f=s.length;d<f;d++){l[b=s[d]]=[],(S=t.morphAttributes[b])&&(u[b]=new Array(S.length).fill().map((function(){return[]})))}var p=Math.log10(1/e),m=Math.pow(10,p);for(d=0;d<a;d++){var g=r?r.getX(d):d,v="",y=0;for(f=s.length;y<f;y++)for(var b=s[y],x=(w=t.getAttribute(b)).itemSize,_=0;_<x;_++)v+="".concat(~~(w[h[_]](g)*m),",");if(v in n)c.push(n[v]);else{for(y=0,f=s.length;y<f;y++){b=s[y];var w=t.getAttribute(b),S=t.morphAttributes[b],E=(x=w.itemSize,l[b]),M=u[b];for(_=0;_<x;_++){var C=h[_];if(E.push(w[C](g)),S)for(var T=0,k=S.length;T<k;T++)M[T].push(S[T][C](g))}}n[v]=o,c.push(o),o++}}var P=t.clone();for(d=0,f=s.length;d<f;d++){b=s[d];var A=t.getAttribute(b),O=new A.array.constructor(l[b]);if(A.isInterleavedBufferAttribute?w=new Lh.BufferAttribute(O,A.itemSize,A.itemSize):(w=t.getAttribute(b).clone()).setArray(O),P.setAttribute(b,w),b in u)for(y=0;y<u[b].length;y++){var N=t.morphAttributes[b][y].clone();N.setArray(new N.array.constructor(u[b][y])),P.morphAttributes[b][y]=N}}var R=Uint8Array;c.length>=Math.pow(2,8)&&(R=Uint16Array),c.length>=Math.pow(2,16)&&(R=Uint32Array);var L=new R(c);c=null;return null===r?c=new Lh.BufferAttribute(L,1):(c=t.getIndex().clone()).setArray(L),P.setIndex(c),P}};var Ih=Lh.BufferGeometryUtils,Dh=n(19),zh=n.n(Dh),Fh=n(23),Bh=n.n(Fh);function Vh(t){return(Vh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hh(t,e){return(Hh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Uh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qh(t);if(e){var i=qh(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gh(this,n)}}function Gh(t,e){return!e||"object"!==Vh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qh(t){return(qh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hh(t,e)}(o,t);var e,n,r,a=Uh(o);function o(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.menu="visualization",e.canvas,e.cameraProp=lc.getCameraProp(t.id),e.tubeNum=16,e.segment=16,e.division=5,e.currentHighlightedPlot=0,e.drag=!1,e.visualQuery=!1,e.dragSelection=!1,e.selector=!0,e.averagePeriod=0,e.animationPara={flag:!1,dep:0,dst:0,speed:40,now:0},e.raycaster=new ju.Raycaster,e.vertex=document.getElementById("vertexShader_tube").textContent,e.fragment=document.getElementById("fragmentShader_tube").textContent,e.lock=!1,e.opacityCurve=lc.getOpacityCurve("Default"),e.rotationPeriod=null,e.wheelInterval=1,e.colorEncodingOption={hue:"default",value:"default"},e.renderClusteringResultView=!1,e.currentTubeStatus={position:void 0,grid:void 0,plot:void 0},e.subsequencesInComparisonPanel=[],e.data.merge){e.plotColor=[],e.idNameLookup={};for(var n=e.data.name.split(","),r=0;r<n.length;r++){var i=Ju.getIdFromName(n[r]);e.idNameLookup[n[r]]=r;var s=n[r].split("+");if(s.length>1)for(var l=0;l<s.length;l++)e.idNameLookup[s[l]]=r;e.plotColor.push(lc.getPlotColor(i))}lc.setPlotColorbyIdx(e.id,e.plotColor)}else lc.setPlotColorbyIdx(e.id,(lc.getInitColorIdx()+e.id)%lc.getPresetNum()),e.plotColor=lc.getPlotColor(e.id);return e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"render",value:function(){var t=this;return this.updateSize(this.props.width,this.props.height),i.a.createElement("div",{style:{position:"relative",float:"left"}},i.a.createElement("div",{className:"TimeTubes",style:{width:this.props.width+"px",height:this.props.height+"px"},ref:function(e){t.mount=e}}),i.a.createElement(Gc,null))}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"componentDidMount",value:function(){var t=this,e=this.mount.clientWidth,n=this.mount.clientHeight;this.scene=new ju.Scene,this.setCameras(e,n),this.renderer=new ju.WebGLRenderer({preserveDrawingBuffer:!0}),this.renderer.setClearColor(new ju.Color(Number(lc.getBackgroundColor()))),this.renderer.setSize(e,n),this.renderer.localClippingEnabled=!0,this.renderer.domElement.id="TimeTubes_viewport_"+this.id,this.renderer.domElement.className="TimeTubes_viewport",this.canvas=this.renderer.domElement,this.initQBEView(),this.initClusteringResultsView(),this.mount.appendChild(this.renderer.domElement),this.renderScene(),this.start(),this.clippingPlane=new ju.Plane(new ju.Vector3(0,0,-1),0),this.clippingPlane2=new ju.Plane(new ju.Vector3(0,0,1),0);var r=new ju.DirectionalLight(16777215,.7);r.position.set(-20,40,60),this.scene.add(r);var i=new ju.AmbientLight(2697513);this.scene.add(i),this.addControls();var a=document.querySelector("#TimeTubes_viewport_"+this.id),o=this.onMouseWheel(),s=this.onMouseDown(),l=this.onMouseMove(),u=this.onMouseUp(),c=this.onMouseClick();a.addEventListener("wheel",o.bind(this),!1),a.addEventListener("mousedown",s.bind(this),!1),a.addEventListener("mousemove",l.bind(this),!1),a.addEventListener("mouseup",u.bind(this),!1),a.addEventListener("click",c.bind(this),!1),this.tubeGroup=new ju.Group,this.scene.add(this.tubeGroup),(new ju.TextureLoader).load("img/1_256.png",function(t){!function(t,e){hu.dispatch({type:"SET_TEXTURE",id:t,texture:e})}(this.id,t),this.drawTube(t)}.bind(this)),this.drawGrid(2*lc.getGridSize(),10),this.drawLabel(lc.getGridSize()/this.data.meta.range),this.drawAxis(),this.drawPlot(),this.drawDisk(),this.drawDiskForRotationCenter(),this.drawComment(),this.drawPeriodMarker(),Su.on("selectMenu",(function(e){t.renderClusteringResultView=!1,t.menu="feature"===e?Rh.getMode():e,"visualization"===e&&"visualization"!==Su.getPreviousMenu()?(t.tubeGroup.position.z=t.currentTubeStatus.position,t.grid.visible=t.currentTubeStatus.grid,t.plot.visible=t.currentTubeStatus.plot,t.currentTubeStatus.far?(t.clippingPlane2.constant=t.currentTubeStatus.far,t.renderer.clippingPlanes=[t.clippingPlane2]):t.renderer.clippingPlanes=[],t.currentTubeStatus={position:void 0,grid:void 0,plot:void 0,far:void 0},t.renderer.localClippingEnabled=$("#checkboxClip").prop("checked")):"visualization"===Su.getPreviousMenu()&&"visualization"!==e&&(t.currentTubeStatus={position:t.tubeGroup.position.z,grid:t.grid.visible,plot:t.plot.visible,far:t.renderer.clippingPlanes.length>0?t.renderer.clippingPlanes[0].constant:void 0})})),Ju.on("updatePrivateComment",(function(){t.updateComment()})),lc.on("upload",(function(){t.cameraProp=lc.getCameraProp(t.id),t.updateCamera()})),lc.on("updateCamera",(function(e){e===t.id&&(t.cameraProp=lc.getCameraProp(t.id),t.updateCamera())})),lc.on("reset",(function(e){e===t.id&&(t.cameraProp=lc.getCameraProp(t.id),0===t.cameraProp.xpos&&0===t.cameraProp.ypos&&50===t.cameraProp.zpos&&t.resetCamera())})),lc.on("switch",(function(){t.cameraProp=lc.getCameraProp(t.id),t.switchCamera()})),lc.on("searchTime",(function(e,n){e===t.id&&t.searchTime(n)})),lc.on("switchGrid",(function(e,n){e===t.id&&(t.grid.visible=n)})),lc.on("switchLabel",(function(e,n){e===t.id&&(t.labelGroup.visible=n)})),lc.on("switchAxis",(function(e,n){e===t.id&&(t.axis.visible=n)})),lc.on("switchPlot",(function(e,n){e===t.id&&(t.plot.visible=n)})),lc.on("changeBackground",(function(){t.scene.background=new ju.Color(Number(lc.getBackgroundColor()))})),lc.on("clipTube",(function(e,n){e===t.id&&(t.renderer.localClippingEnabled=n)})),lc.on("switchShade",(function(e,n){e===t.id&&(t.tube.material.uniforms.shade.value=n)})),lc.on("changeFar",(function(e,n){e===t.id&&(t.cameraProp=lc.getCameraProp(t.id),t.clippingPlane2.constant=n,t.renderer.clippingPlanes=[t.clippingPlane2],t.renderer.render(t.scene,t.camera))})),lc.on("updateMinMaxH",(function(e){e===t.id&&t.setMinMaxH(lc.getMinMaxH(t.id))})),lc.on("updateMinMaxV",(function(e){e===t.id&&t.setMinMaxV(lc.getMinMaxV(t.id))})),lc.on("changePlotColor",(function(e){if(e===t.id)t.plotColor=lc.getPlotColor(t.id),t.drawPlot();else if(t.data.merge){var n=Ju.getFileName(e);t.data.name.indexOf(n)>=0&&(t.plotColor[t.idNameLookup[n]]=lc.getPlotColor(e),t.drawPlot())}})),lc.on("timeFitting",(function(e){if(lc.getChecked(t.id)){var n=lc.getFocused(t.id)+t.data.spatial[0].z,r=e;n<t.data.spatial[0].z?r=t.data.spatial[0].z:t.data.spatial[t.data.spatial.length-1].z<n&&(r=t.data.spatial[t.data.spatial.length-1].z),t.lock&&lc.setLock(t.id,r-t.data.spatial[0].z),t.searchTime(r)}})),lc.on("lockControl",(function(e,n){!n||e.indexOf(t.id)<0?t.lock=!1:(t.lock=!0,t.resetCamera())})),lc.on("synchronizeTubes",(function(e,n,r,i){if(t.lock&e!==t.id)if(0!==n){var a=t.data.meta.min.z,o=t.data.meta.max.z,s=n+lc.getLock(t.id)-lc.getLock(e)+a;a<=s&&s<=o||(s<a?s=a:o<s&&(s=o)),t.searchTime(s)}else r.equals(new ju.Vector3(0,0,0))||(t.controls.object.position.set(r.x,r.y,r.z),t.controls.object.rotation.set(i.x,i.y,i.z))})),lc.on("updateZoomTimeTubes",(function(e){e===t.id&&(t.cameraProp=lc.getCameraProp(t.id),t.updateCamera())})),lc.on("takeSnapshot",(function(e,n,r){e===t.id&&(t.deselectAll(),t.tubeGroup.position.z=n,void 0!==r&&(t.clippingPlane2.constant=r,t.renderer.clippingPlanes=[t.clippingPlane2]),t.renderer.render(t.scene,t.camera))})),lc.on("recoverTube",(function(e,n,r){e===t.id&&(t.cameraProp=lc.getCameraProp(t.id),t.tubeGroup.position.z=r,t.updateCamera(),t.renderer.clippingPlanes=[])})),lc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&(t.resetCamera(),t.tubeGroup.position.z=lc.getFocused(e),t.clippingPlane2.constant=n[1]-n[0],t.renderer.clippingPlanes=[t.clippingPlane2],t.showPeriod(n))})),lc.on("updateAveragePeriod",(function(){if(t.averagePeriod=lc.getAveragePeriod(),t.averagePeriod>0){var e=Ju.getAverage(t.id,t.tubeGroup.position.z,t.averagePeriod);t.disk.visible=!0,t.disk.position.x=e.x*t.data.meta.range,t.disk.position.y=e.y*t.data.meta.range}else t.disk.visible=!1})),lc.on("updateTexture",(function(e,n){e===t.id&&(t.tube.material.uniforms.texture.value=n)})),lc.on("showRotationCenter",(function(e,n,r){e===t.id?(t.resetCamera(),t.tubeGroup.position.z=lc.getFocused(e),t.diskRotation.visible=!0,t.diskRotation.position.x=r.x*t.data.meta.range,t.diskRotation.position.y=r.y*t.data.meta.range,t.rotationPeriod=n,t.clippingPlane2.constant=n[1]-n[0],t.renderer.clippingPlanes=[t.clippingPlane2],t.showPeriod(n)):t.rotationPeriod=null})),lc.on("switchComment",(function(e,n){e===t.id&&(n?t.comment.visible=!0:(t.comment.visible=!1,t.commentContents.visible=!1))})),lc.on("updateWheelInterval",(function(){t.wheelInterval=lc.getWheelInterval()})),lc.on("updateColorEncodingOptionHue",(function(e,n){e===t.id&&(t.colorEncodingOption.hue=n,t.updateColorEncodingOptionHue())})),lc.on("updateColorEncodingOptionValue",(function(e,n){e===t.id&&(t.colorEncodingOption.value=n,t.updateColorEncodingOptionValue())})),Rh.on("setExtractionResults",(function(){t.subsequencesInComparisonPanel=[]})),Rh.on("switchQueryMode",(function(e){t.renderClusteringResultView=!1;var n=Rh.getSource();t.menu=e,"QBE"===e&&"default"!==n?(t.visualQuery=Number(n)===t.id,t.setQBEView(),t.resetSelection()):t.deselectAll()})),Rh.on("updateSource",(function(){t.renderClusteringResultView=!1,t.subsequencesInComparisonPanel=[],t.menu=Rh.getMode();var e=Rh.getSource();"QBE"===t.menu&&"default"!==e&&(t.visualQuery=Number(e)===t.id,t.setQBEView(),t.resetSelection())})),Rh.on("switchDragSelection",(function(){t.dragSelection=Rh.getDragSelection(),t.updateControls()})),Rh.on("resetSelection",(function(){t.tube&&t.deselectAll()})),Rh.on("switchSelector",(function(){t.selector=Rh.getSelector()})),Rh.on("selectTimeInterval",(function(e,n){t.menu=Rh.getMode(),"QBE"===t.menu&&Number(e)===t.id&&t.paintSelectedPeriod()})),Rh.on("updateSelectedPeriod",(function(){var e=Rh.getSource();t.menu=Rh.getMode(),"QBE"===t.menu&&Number(e)===t.id&&t.paintSelectedPeriod()})),Rh.on("convertResultIntoQuery",(function(e,n,r){t.renderClusteringResultView=!1,t.subsequencesInComparisonPanel=[],t.menu=Rh.getMode(),"QBE"===t.menu&&Number(e)===t.id&&(t.visualQuery=Number(e)===t.id,t.setQBEView(),t.resetSelection(),t.paintSelectedPeriod(),t.searchTime(n[0]),t.grid.visible=t.currentTubeStatus.grid,t.plot.visible=t.currentTubeStatus.plot,t.currentTubeStatus.far?(t.clippingPlane2.constant=t.currentTubeStatus.far,t.renderer.clippingPlanes=[t.clippingPlane2]):t.renderer.clippingPlanes=[])})),Rh.on("recoverQuery",(function(e){t.renderClusteringResultView=!1,t.subsequencesInComparisonPanel=[],"QBE"===Rh.getMode()&&Number(Rh.getSource())===t.id&&(t.visualQuery=!0,setTimeout(function(){this.setQBEView(),this.resetSelection(),this.paintSelectedPeriod()}.bind(t),0))})),zc.on("showTTViewOfSelectedSSClustering",(function(e,n){e===t.id?(t.grid.visible=!1,t.plot.visible=!1,t.renderClusteringResultView=!0,t.showSelectedSSClusteringResultsView(n)):t.renderClusteringResultView=!1})),zc.on("showSelectedSubsequenceInComparisonPanel",(function(e,n,r){e===t.id&&(t.grid.visible=!1,t.plot.visible=!1,t.renderClusteringResultView=!1,setTimeout(function(){this.showSelectedSSInComparisonPanel(n,r)}.bind(t),0))}))}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.renderMainRenderer(),this.renderClusteringResultView&&this.renderClusteringRenderer(),"QBE"===this.menu&&this.renderQBERenderer(),"visualization"!==this.menu&&!this.renderClusteringResultView&&this.subsequencesInComparisonPanel.length>0&&this.renderSSComparisonPanel()}},{key:"renderMainRenderer",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"renderQBERenderer",value:function(){var t=document.getElementById("QBESourceTTCanvas");if(t){var e=this.renderer.domElement.width,n=this.renderer.domElement.height,r=t.getContext("2d");this.renderer.render(this.scene,this.QBECamera),r.drawImage(this.renderer.domElement,0,0,e,n,0,0,t.width,t.height)}}},{key:"renderSSComparisonPanel",value:function(){for(var t=0;t<this.subsequencesInComparisonPanel.length;t++){this.clippingPlane2.constant=this.subsequencesInComparisonPanel[t].period[1]-this.subsequencesInComparisonPanel[t].period[0],this.renderer.clippingPlanes=[this.clippingPlane2],this.tubeGroup.position.z=this.subsequencesInComparisonPanel[t].period[0]-this.data.spatial[0].z;var e=document.getElementById("subsequenceComparisonCanvas_"+this.subsequencesInComparisonPanel[t].SSId);if(e){var n=this.renderer.domElement.width,r=this.renderer.domElement.height,i=e.getContext("2d");this.renderer.render(this.scene,this.subsequencesInComparisonPanel[t].camera),this.subsequencesInComparisonPanel[t].controls.update(),i.drawImage(this.renderer.domElement,0,0,n,r,0,0,e.width,e.height)}}}},{key:"renderClusteringRenderer",value:function(){var t=document.getElementById("tooltipClusteringResultsSubsequencesTTView");if(t){var e=this.renderer.domElement.width,n=this.renderer.domElement.height,r=t.getContext("2d");this.renderer.render(this.scene,this.ClusteringCamera),r.drawImage(this.renderer.domElement,0,0,e,n,0,0,t.width,t.height)}}},{key:"addControls",value:function(){this.controls=new zh.a(this.camera,this.renderer.domElement),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"updateControls",value:function(){this.visualQuery&&this.dragSelection?this.QBEControls&&(this.QBEControls.enabled=!1):this.QBEControls&&(this.QBEControls.enabled=!0)}},{key:"onMouseWheel",value:function(){return function(t){t.preventDefault();var e,n,r,i,a=t.deltaY>0,o=!1,s=this.tubeGroup.position.z,l=this.tubeGroup.position.z;if((l+=a?this.wheelInterval:-1*this.wheelInterval)<0?l=0:l>this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z&&(l=this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z),a)for(e=0;e<this.data.spatial.length;e++){var u=this.data.spatial[e].z-this.data.spatial[0].z;if(Math.min(s,l)<u&&u<Math.max(s,l)){l=u,"x"in this.data.spatial[e]&&(o=!0);break}}else for(e=this.data.spatial.length-1;e>=0;e--){var c=this.data.spatial[e].z-this.data.spatial[0].z;if(Math.min(s,l)<c&&c<Math.max(s,l)){l=c,"x"in this.data.spatial[e]&&(o=!0);break}}if(l===this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z&&"x"in this.data.spatial[this.data.spatial.length-1]&&(o=!0),0===l&&"x"in this.data.spatial[0]&&(o=!0),n=this.data.merge?new ju.Color(Number("0x"+this.plotColor[this.idNameLookup[this.data.spatial[this.currentHighlightedPlot].source]].slice(1))):new ju.Color(Number("0x"+this.plotColor.slice(1))),this.changePlotColor(this.currentHighlightedPlot*this.segment,n),o)if(this.data.merge)for(var h=0,d=0;d<this.data.spatial.length;d++)"x"in this.data.spatial[d]&&(l===this.data.spatial[d].z-this.data.spatial[0].z&&(this.changePlotColor(h*this.segment,new ju.Color("red")),this.currentHighlightedPlot=h),h++);else for(var f=0;f<this.data.splines.position.points.length;f++)l===this.data.spatial[f].z-this.data.spatial[0].z&&(this.changePlotColor(f*this.segment,new ju.Color("red")),this.currentHighlightedPlot=f);if(this.periodStartMarker.visible&&(this.periodGroup.position.z=this.periodGroup.position.z+(l-this.tubeGroup.position.z)),this.tubeGroup.position.z=l,this.clusteringGroup&&(this.clusteringGroup.position.z=l),this.diskRotation.visible&&(l<this.rotationPeriod[0]-this.data.spatial[0].z||this.rotationPeriod[1]-this.data.spatial[0].z<l)&&(this.diskRotation.visible=!1,this.rotationPeriod=null),this.renderer.clippingPlanes.length>0&&(this.clippingPlane2.constant=this.cameraProp.far),Lu(this.id,l,o),this.lock&&Fu(this.id,l,new ju.Vector3(0,0,0),new ju.Vector3(0,0,0)),r=this.id,i=l+this.data.spatial[0].z,hu.dispatch({type:"MOVE_CURRENT_LINE_ON_TIMESELECTOR",id:r,zpos:i}),fc(this.id,l),this.averagePeriod>0){var p=Ju.getAverage(this.id,this.tubeGroup.position.z,this.averagePeriod);this.disk.position.x=p.x*this.data.meta.range,this.disk.position.y=p.y*this.data.meta.range}}.bind(this)}},{key:"onMouseDown",value:function(){return function(t){this.drag=!1}}},{key:"onMouseMove",value:function(){return function(t){if(this.drag=!0,this.drag){if(this.lock){var e=new ju.Vector3(this.controls.object.rotation._x,this.controls.object.rotation._y,this.controls.object.rotation._z),n=this.controls.object.position;Fu(this.id,0,n,e)}if(this.visualQuery&&this.dragSelection){var r=this.getIntersectedIndex(t);if(void 0!==r&&this.tube){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;var i,a=Math.floor(Math.min(r.a,r.b,r.c)/this.segment);i=this.selector?1:0;for(var o=0;o<this.segment;o++)this.tube.geometry.attributes.selected.array[a*this.segment+o]=i,this.tube.geometry.attributes.selected.array[(a+1)*this.segment+o]=i;for(var s=this.tube.geometry.attributes.selected.array.length/this.tubeNum,l=this.tube.geometry.attributes.selected.array.indexOf(1)%s,u=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%s,c=l;c<=u;c++)this.tube.geometry.attributes.selected.array[s*(this.tubeNum-1)+c]=1;var h=this.data.meta.min.z;Xc([Math.floor(l/this.segment)*(1/this.division)+h,(Math.floor(u/this.segment)+1)*(1/this.division)+h])}}}}}},{key:"onMouseUp",value:function(){return function(t){if(this.comment.visible&&!this.drag){var e,n=new ju.Vector2;n.x=t.offsetX/this.renderer.domElement.clientWidth*2-1,n.y=-t.offsetY/this.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(n,this.camera);var r=this.raycaster.intersectObject(this.comment);if(r.length>0&&(e=r[0].face),void 0!==e)if(this.commentContents.visible)this.commentContents.visible=!1;else{this.commentContents.visible=!0;var i=Math.floor(e.a/6),a=ph(this.commentList[i]),o=a.timeStamp+"\n"+a.userName+"\n";a.comment.length>30?o+=a.comment.substr(0,50):o+=a.comment,this.commentContents.material.map.text=o,this.commentContents.position.set(-lc.getGridSize()-10,0,0)}}else if(this.drag){var s=this.cameraProp;s.xpos=this.camera.position.x,s.ypos=this.camera.position.y,s.zpos=this.camera.position.z,this.cameraProp=s}}}},{key:"onMouseClick",value:function(){return function(t){if(this.drag||!this.visualQuery||this.dragSelection){if(!this.visualQuery){for(var e=document.getElementsByClassName("TimeTubes_viewport"),n=0;n<e.length;n++)e[n].style.border="none";var r=document.getElementById("TimeTubes_viewport_"+this.id);r.style.border="solid 3px red",r.style.boxSizing="border-box",f=this.id,hu.dispatch({type:"ACTIVATE_VIEWPORT",id:f})}}else{var i,a,o=this.getIntersectedIndex(t);if(void 0!==o&&this.tube){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;var s,l=Math.floor(Math.min(o.a,o.b,o.c)/this.segment);Math.floor(l/this.segment),this.division,this.data.meta.min.z,s=this.selector?1:0;for(var u=0;u<this.segment;u++)this.tube.geometry.attributes.selected.array[l*this.segment+u]=s,this.tube.geometry.attributes.selected.array[(l+1)*this.segment+u]=s;var c=this.tube.geometry.attributes.selected.array.length/this.tubeNum;i=this.tube.geometry.attributes.selected.array.indexOf(1)%c,a=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%c;for(var h=i;h<=a;h++)this.tube.geometry.attributes.selected.array[c*(this.tubeNum-1)+h]=1;if(i>=a)Xc([-1,-1]);else{var d=this.data.meta.min.z;Xc([Math.floor(i/this.segment)*(1/this.division)+d,(Math.floor(a/this.segment)+1)*(1/this.division)+d])}}}var f;this.drag=!1}}},{key:"getIntersectedIndex",value:function(t){var e,n=new ju.Vector2,r=document.getElementById("QBESourceTTCanvas"),i=r.getBoundingClientRect(),a=window.pageXOffset+i.left,o=window.pageYOffset+i.top,s=t.pageX-a,l=t.pageY-o;n.x=s/Number(r.style.width.slice(0,-2))*2-1,n.y=-l/Number(r.style.height.slice(0,-2))*2+1,this.raycaster.setFromCamera(n,this.QBECamera);var u=this.raycaster.intersectObject(this.tube);return u.length>0&&(e=u[0].face),e}},{key:"deselectAll",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var t=0;t<this.tube.geometry.attributes.selected.array.length;t++)this.tube.geometry.attributes.selected.array[t]=0}},{key:"resetSelection",value:function(){this.visualQuery||this.deselectAll()}},{key:"selectTimeInterval",value:function(t){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var e=this.tube.geometry.attributes.selected.array.length/this.tubeNum,n=this.tubeGroup.position.z,r=(Math.round(n)*this.division+1)*this.segment+e*(this.tubeNum-1),i=0;i<Math.floor(t)*this.division*this.segment;i++)this.tube.geometry.attributes.selected.array[r+i]=1;for(var a=this.tube.geometry.attributes.selected.array.indexOf(1)%e,o=this.tube.geometry.attributes.selected.array.lastIndexOf(1)%e,s=a;s<=o;s++)this.tube.geometry.attributes.selected.array[e*(this.tubeNum-1)+s]=1;var l=this.data.meta.min.z;Xc([Math.floor(a/this.segment)*(1/this.division)+l,(Math.floor(o/this.segment)+1)*(1/this.division)+l])}},{key:"paintSelectedPeriod",value:function(){this.deselectAll();var t=Rh.getSelectedPeriod(),e=this.data.meta.min.z,n=this.tube.geometry.attributes.selected.array.length/this.tubeNum,r=Math.ceil(t[0]-e)*this.division*this.segment,i=Math.ceil(t[1]-e)*this.division*this.segment;this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0;for(var a=r;a<i;a++)this.tube.geometry.attributes.selected.array[n*(this.tubeNum-1)+a]=1}},{key:"changePlotColor",value:function(t,e){for(var n=0;n<this.segment;n++)this.plot.geometry.attributes.color.needsUpdate=!0,this.plot.geometry.attributes.color.setXYZ(t+n,e.r,e.g,e.b)}},{key:"setCameras",value:function(t,e){var n=Math.ceil(this.data.spatial[this.data.spatial.length-1].z-this.data.spatial[0].z+50),r=2*Math.tan(22.5*Math.PI/180),i=t/e;this.cameraSet={},this.cameraSet.perspective=new ju.PerspectiveCamera(45,i,.1,n);var a=50*r,o=50*r*i;this.cameraSet.orthographic=new ju.OrthographicCamera(-o/2,o/2,a/2,-a/2,.1,n),Ou(this.id,{xpos:0,ypos:0,zpos:50,fov:45,far:n,depth:r,aspect:i,zoom:1,type:"Perspective"}),this.camera=this.cameraSet.perspective,this.camera.position.z=50,this.camera.lookAt(this.scene.position),$("#farSlider_"+this.id).slider({min:0,max:n,value:n})}},{key:"resetCamera",value:function(){this.cameraProp.xpos=0,this.cameraProp.ypos=0,this.cameraProp.zpos=50,Ou(this.id,this.cameraProp),this.camera.position.set(this.cameraProp.xpos,this.cameraProp.ypos,this.cameraProp.zpos),this.camera.zoom=this.cameraProp.zoom,this.controls.reset()}},{key:"updateCamera",value:function(){this.camera.position.set(this.cameraProp.xpos,this.cameraProp.ypos,this.cameraProp.zpos),this.camera.fov=this.cameraProp.fov,this.camera.depth=this.cameraProp.depth,this.camera.aspect=this.cameraProp.aspect,this.camera.zoom=this.cameraProp.zoom,this.camera.updateProjectionMatrix()}},{key:"updateSize",value:function(t,e){this.renderer&&(this.renderer.setSize(t,e),Ou(this.id,{aspect:t/e}))}},{key:"switchCamera",value:function(){var t=this.camera.position;"Perspective"===this.cameraProp.type?(this.camera=this.cameraSet.perspective,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)):"Orthographic"===this.cameraProp.type&&(this.camera=this.cameraSet.orthographic,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)),this.addControls()}},{key:"searchTime",value:function(t){var e=t-this.data.spatial[0].z;isNaN(e)?alert("Please input numbers."):(this.animationPara.flag=!0,this.animationPara.dep=this.tubeGroup.position.z,this.animationPara.dst=e,this.moveTube())}},{key:"moveTube",value:function(){if(this.animationPara.flag){if(this.animationPara.now<this.animationPara.speed){requestAnimationFrame(this.moveTube.bind(this)),this.renderer.render(this.scene,this.camera),this.animationPara.now+=1;var t=(1-Math.cos(Math.PI*this.animationPara.now/this.animationPara.speed))/2;if(this.tubeGroup.position.z=this.animationPara.dep+(this.animationPara.dst-this.animationPara.dep)*t,this.disk.visible){var e=Ju.getAverage(this.id,this.tubeGroup.position.z,this.averagePeriod);this.disk.position.x=e.x*this.data.meta.range,this.disk.position.y=e.y*this.data.meta.range}}this.animationPara.now===this.animationPara.speed&&(fc(this.id,this.animationPara.dst),Lu(this.id,this.animationPara.dst,!1),this.animationPara.flag=!1,this.animationPara.now=0,this.animationPara.dep=0,this.animationPara.dst=0)}else this.animationPara.flag=!1,this.animationPara.dst=0}},{key:"setMinMaxH",value:function(t){this.tube.material.uniforms.minmaxH.value=new ju.Vector2(t[0],t[1])}},{key:"setMinMaxV",value:function(t){this.tube.material.uniforms.minmaxV.value=new ju.Vector2(t[0],t[1])}},{key:"changePlotsColor",value:function(){if(this.data.merge){for(var t=[],e=[],n=0;n<this.plotColor.length;n++)e.push(new ju.Color(this.plotColor[n]));Array(this.data.splines.position.points.length*this.segment*2),Math.PI,this.segment,this.data.meta.range;for(var r=0;r<this.data.spatial.length;r++)if("x"in this.data.spatial[r])for(var i=this.data.spatial[r].source,a=e[this.idNameLookup[i]],o=0;o<this.segment;o++)t.push(a.r),t.push(a.g),t.push(a.b);this.plot.geometry.setAttribute("color",new ju.Float32BufferAttribute(t,3))}else this.plot.material.color=new ju.Color(Number("0x"+this.plotColor.slice(1)))}},{key:"updateOpacity",value:function(t){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var e=this.opacityCurve.getSpacedPoints(this.tubeNum),n=[];if("Flat"===t)for(var r=1;r<=this.tubeNum;r++)n.push(1);else for(var i=1;i<=this.tubeNum;i++)n.push(1-(1-e[i-1].y)/(1-e[i].y));for(var a=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum),o=0;o<this.tubeNum;o++)for(var s=0;s<a*this.segment;s++)this.tube.geometry.attributes.colorData.array[a*this.segment*3*o+3*s+2]=n[o];this.renderer.render(this.scene,this.camera)}},{key:"showPeriod",value:function(t){var e=lc.getGridSize();this.periodGroup.visible=!0,this.periodTube.geometry.attributes.position.needsUpdate=!0;for(var n=this.periodTube.geometry.attributes.position.array.length/2+2,r=t[1]-t[0],i=0;i<this.periodTube.geometry.attributes.position.array.length/3/2;i++)this.periodTube.geometry.attributes.position.array[n+3*i]=-r;this.periodEndMarker.position.set(e+1,e+1,-r),this.periodGroup.position.z=-(t[0]-this.data.spatial[0].z)+this.tubeGroup.position.z,this.periodStartMarker.material.map.text=String(t[0].toFixed(0)),this.periodEndMarker.material.map.text=String(t[1].toFixed(0)),this.renderer.render(this.scene,this.camera)}},{key:"drawTube",value:function(t){this.texture=t;var e,n,r,i=this.data.spatial[0].z,a=this.data.spatial[this.data.spatial.length-1].z,o=this.data.meta.range,s=(a-i)/(this.division*Math.ceil(a-i)),l=Math.ceil((this.data.splines.position.getPoint(1).z-this.data.splines.position.getPoint(0).z)/s),u=this.data.splines.position.getSpacedPoints(l),c=this.data.splines.radius.getSpacedPoints(l);this.data.splines.hue.points.length>0&&(e=Math.ceil((this.data.splines.hue.getPoint(1).z-this.data.splines.hue.getPoint(0).z)/s),n=this.data.splines.hue.getSpacedPoints(e),r=Math.ceil((this.data.splines.hue.getPoint(0).z-this.data.splines.position.getPoint(0).z)/s));for(var h=Math.ceil((this.data.splines.value.getPoint(1).z-this.data.splines.value.getPoint(0).z)/s),d=this.data.splines.value.getSpacedPoints(h),f=Math.ceil((this.data.splines.value.getPoint(0).z-this.data.splines.position.getPoint(0).z)/s),p=2*Math.PI/(this.segment-1),m=[],g=[],v=0;v<this.tubeNum;v++)m[v]=[],g[v]=[];for(var y,b=[],x=0,_=0,w=this.opacityCurve.getSpacedPoints(this.tubeNum),S=[],E=1;E<=this.tubeNum;E++)S.push(1-(1-w[E-1].y)/(1-w[E].y));for(var M=0;M<=l;M++){x=0,_=0,e&&r<M&&M-r<e&&(x=n[M-r].x),f<M&&M-f<h&&(_=d[M-f].y);for(var C=0;C<this.segment;C++){for(var T=0;T<this.tubeNum;T++){var k=1/this.tubeNum*(T+1),P=p*C;m[T].push(-1*(u[M].x*o+k*c[M].x*o*Math.cos(P))),m[T].push(u[M].y*o+k*c[M].y*o*Math.sin(P)),m[T].push(u[M].z-i),g[T].push(x),g[T].push(_),g[T].push(S[T])}C!==this.segment-1&&(b.push(C+M*this.segment),b.push(C+this.segment+M*this.segment),b.push(C+1+M*this.segment),b.push(C+this.segment+M*this.segment),b.push(C+1+this.segment+M*this.segment),b.push(C+1+M*this.segment))}}b=b.slice(0,-1*this.segment*3*2),y=new Float32Array(m[0].length/3);for(var A=new Float32Array(m[0].length),O=[],N=0;N<this.tubeNum;N++){var R=new ju.BufferGeometry;R.setAttribute("position",new ju.BufferAttribute(new Float32Array(m[N]),3)),R.setAttribute("normal",new ju.BufferAttribute(A,3)),R.setAttribute("colorData",new ju.BufferAttribute(new Float32Array(g[N]),3)),R.setAttribute("selected",new ju.BufferAttribute(new Float32Array(y),1)),R.setIndex(new ju.BufferAttribute(new Uint32Array(b),1)),R.computeVertexNormals(),O.push(R)}var L=Ih.mergeBufferGeometries(O),I=new ju.ShaderMaterial({vertexShader:this.vertex,fragmentShader:this.fragment,uniforms:{lightPosition:{value:new ju.Vector3(-20,40,60)},shade:{value:!0},texture:{value:this.texture},minmaxH:{value:new ju.Vector2(this.data.meta.min.H,this.data.meta.max.H)},minmaxV:{value:new ju.Vector2(this.data.meta.min.V,this.data.meta.max.V)},flagH:{value:!0},flagV:{value:!0}},side:ju.DoubleSide,transparent:!0,clipping:!0,clippingPlanes:[this.clippingPlane]});this.tube=new ju.Mesh(L,I),this.tubeGroup.add(this.tube),this.tube.rotateY(Math.PI),Du(this.id,this.data.meta.min.H,this.data.meta.max.H),Iu(this.id,this.data.meta.min.V,this.data.meta.max.V);var D=m[this.tubeNum-1],z=g[this.tubeNum-1],F=b;!function(t,e,n,r){hu.dispatch({type:"UPLOAD_TUBE_ATTRIBUTES",id:t,position:e,color:n,indices:r})}(this.id,D,z,F)}},{key:"drawGrid",value:function(t,e){this.grid=new ju.GridHelper(t,e,"white","limegreen"),this.grid.rotateX(Math.PI/2),this.scene.add(this.grid)}},{key:"drawLabel",value:function(t){var e=lc.getGridSize();this.labelGroup=new ju.Group,this.scene.add(this.labelGroup);for(var n=[[1,1],[-1,1],[-1,-1],[1,-1]],r=0;r<n.length;r++){var i=new Bh.a({material:{color:16777215},redrawInterval:250,textSize:.8,texture:{fontFamily:"Arial, Helvetica, sans-serif",text:"("+n[r][0]*t+", "+n[r][1]*t+")"}});this.labelGroup.add(i),i.position.set(n[r][0]*e,n[r][1]*e,0)}var a=new Bh.a({material:{color:25600},redrawInterval:250,textSize:1,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"Q/I"}}),o=new Bh.a({material:{color:25600},redrawInterval:250,textSize:1,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"U/I"}});this.labelGroup.add(a),this.labelGroup.add(o),a.position.set(e+1,0,0),o.position.set(0,e+1,0)}},{key:"drawAxis",value:function(){for(var t=new ju.BufferGeometry,e=new ju.LineBasicMaterial({color:"white",opacity:.5,clippingPlanes:[this.clippingPlane]}),n=[],r=[],i=0,a=0,o=0;o<this.data.spatial.length;o++)a=this.data.spatial[o].z-this.data.spatial[0].z,n.push(-10),n.push(0),n.push(a),n.push(10),n.push(0),n.push(a),n.push(0),n.push(10),n.push(a),n.push(0),n.push(-10),n.push(a),r.push(i+0),r.push(i+1),r.push(i+2),r.push(i+3),i+=4;t.setIndex(r),t.setAttribute("position",new ju.Float32BufferAttribute(n,3)),this.axis=new ju.LineSegments(t,e),this.tubeGroup.add(this.axis),this.axis.rotateY(Math.PI)}},{key:"drawPlot",value:function(){if(this.data.merge){for(var t=[],e=[],n=[],r=0;r<this.plotColor.length;r++)n.push(new ju.Color(this.plotColor[r]));for(var i=Array(this.data.splines.position.points.length*this.segment*2),a=0,o=2*Math.PI/this.segment,s=this.data.meta.range,l=0;l<this.data.spatial.length;l++)if("x"in this.data.spatial[l]){var u=this.data.spatial[l].z-this.data.spatial[0].z,c=-this.data.spatial[l].x*s,h=this.data.spatial[l].y*s,d=this.data.spatial[l].r_x*s,f=this.data.spatial[l].r_y*s,p=2*this.segment*a,m=this.data.spatial[l].source,g=n[this.idNameLookup[m]];i[p]=a*this.segment,i[p+2*this.segment-1]=a*this.segment;for(var v=0;v<this.segment;v++)t.push(c+d*Math.cos(o*v)),t.push(h+f*Math.sin(o*v)),t.push(u),e.push(g.r),e.push(g.g),e.push(g.b),0!==v&&(i[p+2*(v-1)+1]=a*this.segment+v,i[p+2*(v-1)+2]=a*this.segment+v);a++}var y=new ju.BufferGeometry;y.setIndex(i),y.setAttribute("position",new ju.Float32BufferAttribute(t,3)),y.setAttribute("color",new ju.Float32BufferAttribute(e,3));var b=new ju.LineBasicMaterial({vertexColors:ju.VertexColors,clippingPlanes:[this.clippingPlane]});this.plot=new ju.LineSegments(y,b)}else{for(var x=[],_=[],w=new ju.Color(this.plotColor),S=Array(this.data.splines.position.points.length*this.segment*2),E=2*Math.PI/this.segment,M=this.data.meta.range,C=0;C<this.data.splines.position.points.length;C++){var T=this.data.splines.position.points[C].z-this.data.splines.position.points[0].z,k=-this.data.splines.position.points[C].x*M,P=this.data.splines.position.points[C].y*M,A=this.data.splines.radius.points[C].x*M,O=this.data.splines.radius.points[C].y*M,N=2*this.segment*C;S[N]=C*this.segment,S[N+2*this.segment-1]=C*this.segment;for(var R=0;R<this.segment;R++)x.push(k+A*Math.cos(E*R)),x.push(P+O*Math.sin(E*R)),x.push(T),_.push(w.r),_.push(w.g),_.push(w.b),0!==R&&(S[N+2*(R-1)+1]=C*this.segment+R,S[N+2*(R-1)+2]=C*this.segment+R)}var L=new ju.BufferGeometry;L.setIndex(S),L.setAttribute("position",new ju.Float32BufferAttribute(x,3)),L.setAttribute("color",new ju.Float32BufferAttribute(_,3));var I=new ju.LineBasicMaterial({vertexColors:ju.VertexColors,clippingPlanes:[this.clippingPlane]});this.plot=new ju.LineSegments(L,I)}this.tubeGroup.add(this.plot),this.plot.rotateY(Math.PI)}},{key:"drawDisk",value:function(){var t=new ju.CircleGeometry(.5,16),e=new ju.MeshBasicMaterial({color:16711680,opacity:.8});this.disk=new ju.Mesh(t,e),this.scene.add(this.disk),this.disk.visible=!1}},{key:"drawDiskForRotationCenter",value:function(){var t=new ju.CircleGeometry(.5,16),e=new ju.MeshBasicMaterial({color:16776960,opacity:.8});this.diskRotation=new ju.Mesh(t,e),this.scene.add(this.diskRotation),this.diskRotation.visible=!1}},{key:"drawComment",value:function(){this.commentList=[];var t=Ju.getFileName(this.id),e=dh("privateComment"),n=lc.getGridSize(),r=[],i=[];for(var a in e)if(e[a].fileName===t){this.commentList.push(a);var o=new ju.Color(Number(e[a].labelColor));r.push(n+2+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+2+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+2+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b)}var s=new ju.BufferGeometry;s.setAttribute("position",new ju.Float32BufferAttribute(r,3)),s.setAttribute("color",new ju.Float32BufferAttribute(i,3));var l=new ju.MeshBasicMaterial({vertexColors:ju.VertexColors,side:ju.DoubleSide,clippingPlanes:[this.clippingPlane]});this.comment=new ju.Mesh(s,l),this.tubeGroup.add(this.comment),this.comment.rotateY(Math.PI),this.commentContents=new Bh.a({material:{color:16777215},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"",align:"left"}}),this.scene.add(this.commentContents),this.commentContents.position.set(-n,n,0)}},{key:"drawPeriodMarker",value:function(){var t=lc.getGridSize();this.periodStartMarker=new Bh.a({material:{color:65280,clippingPlanes:[this.clippingPlane]},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"start",align:"left"}}),this.periodStartMarker.position.set(t+1,t+1,0),this.periodEndMarker=new Bh.a({material:{color:16711680,clippingPlanes:[this.clippingPlane]},redrawInterval:250,textSize:1.3,texture:{fontFamily:"Arial, Helvetica, sans-serif",fontStyle:"italic",text:"end",align:"left"}}),this.periodEndMarker.position.set(t+1,t+1,0);var e=new ju.LineCurve3(new ju.Vector3(0,0,0),new ju.Vector3(0,0,-1)),n=new ju.TubeBufferGeometry(e,1,.5,16,!1),r=new ju.MeshBasicMaterial({color:255,clippingPlanes:[this.clippingPlane]});this.periodTube=new ju.Mesh(n,r),this.periodGroup=new ju.Group,this.periodGroup.add(this.periodStartMarker),this.periodGroup.add(this.periodEndMarker),this.periodGroup.add(this.periodTube),this.periodGroup.visible=!1,this.scene.add(this.periodGroup)}},{key:"updateComment",value:function(){this.commentList=[];var t=Ju.getFileName(this.id),e=dh("privateComment"),n=lc.getGridSize(),r=[],i=[];for(var a in e)if(e[a].fileName===t){this.commentList.push(a);var o=new ju.Color(Number(e[a].labelColor));r.push(n+2+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+2+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+2+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b),r.push(n+1),r.push(n-2),r.push(e[a].start-this.data.meta.min.z),i.push(o.r,o.g,o.b)}this.comment.geometry.attributes.position.needsUpdate=!0,this.comment.geometry.attributes.position=new ju.Float32BufferAttribute(r,3),this.comment.geometry.attributes.color.needsUpdate=!0,this.comment.geometry.attributes.color=new ju.Float32BufferAttribute(i,3),this.commentContents.visible=!1,this.renderer.render(this.scene,this.camera)}},{key:"initQBEView",value:function(){this.QBECamera=new ju.PerspectiveCamera(45,1,.1,2e3),this.QBECamera.position.z=50,this.QBERenderer=new ju.WebGLRenderer}},{key:"setQBEView",value:function(){var t=document.getElementById("QBESourceTTCanvas");if(this.visualQuery){if(this.QBECamera.lookAt(this.scene.position),this.QBECamera.far=this.camera.far,Number($("#QBESource").css("padding-left"))?Number($("#QBESource").css("padding-left").replace("px","")):Number($("#QBESource").css("padding"))&&Number($("#QBESource").css("padding").replace("px","")),null!=t){t.style.display="block";var e=this.onMouseWheel(),n=this.onMouseDown(),r=this.onMouseMove(),i=this.onMouseUp(),a=this.onMouseClick();t.addEventListener("wheel",e.bind(this),!1),t.addEventListener("mousedown",n.bind(this),!1),t.addEventListener("mousemove",r.bind(this),!1),t.addEventListener("mouseup",i.bind(this),!1),t.addEventListener("click",a.bind(this),!1),this.QBEControls=new zh.a(this.QBECamera,this.renderer.domElement),this.QBEControls.position0.set(0,0,50),this.QBEControls.screenSpacePanning=!1,this.QBEControls.enableZoom=!1}}else null!=t&&(t.style.display="none")}},{key:"updateColorEncodingOptionHue",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var t,e=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum);switch(this.colorEncodingOption.hue){case"default":t=this.data.splines.hue.getSpacedPoints(e);for(var n=0;n<this.tubeNum;n++)for(var r=0;r<e*this.segment;r++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*n+3*r]=t[Math.floor(r/this.segment)].x;this.tube.material.uniforms.minmaxH.value=new ju.Vector2(this.data.meta.min.H,this.data.meta.max.H);break;case"histogramEqualization":t=this.data.hueValRanks.hue.getSpacedPoints(e);for(var i=0;i<this.tubeNum;i++)for(var a=0;a<e*this.segment;a++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*i+3*a]=t[Math.floor(a/this.segment)].y;this.tube.material.uniforms.minmaxH.value=new ju.Vector2(this.data.hueValRanks.minmaxHue.min,this.data.hueValRanks.minmaxHue.max)}this.renderer.render(this.scene,this.camera)}},{key:"updateColorEncodingOptionValue",value:function(){this.tube.geometry.colorsNeedUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0;var t,e=this.tube.geometry.attributes.colorData.array.length/(3*this.segment*this.tubeNum);switch(this.colorEncodingOption.value){case"default":t=this.data.splines.value.getSpacedPoints(e);for(var n=0;n<this.tubeNum;n++)for(var r=0;r<e*this.segment;r++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*n+3*r+1]=t[Math.floor(r/this.segment)].y;this.tube.material.uniforms.minmaxV.value=new ju.Vector2(this.data.meta.min.V,this.data.meta.max.V);break;case"histogramEqualization":t=this.data.hueValRanks.value.getSpacedPoints(e);for(var i=0;i<this.tubeNum;i++)for(var a=0;a<e*this.segment;a++)this.tube.geometry.attributes.colorData.array[e*this.segment*3*i+3*a+1]=t[Math.floor(a/this.segment)].y;this.tube.material.uniforms.minmaxV.value=new ju.Vector2(this.data.hueValRanks.minmaxValue.min,this.data.hueValRanks.minmaxValue.max)}this.renderer.render(this.scene,this.camera)}},{key:"initClusteringResultsView",value:function(){var t=2*Math.tan(22.5*Math.PI/180),e=50*t,n=50*t*1;this.ClusteringCamera=new ju.OrthographicCamera(-n/2,n/2,e/2,-e/2,.1,2e3),this.ClusteringCamera.position.z=50,this.ClusteringCamera.lookAt(this.scene.position)}},{key:"showSelectedSSClusteringResultsView",value:function(t){this.clippingPlane2.constant=t[1]-t[0],this.renderer.clippingPlanes=[this.clippingPlane2],this.tubeGroup.position.z=t[0]-this.data.spatial[0].z}},{key:"showSelectedSSInComparisonPanel",value:function(t,e){var n={},r=2*Math.tan(22.5*Math.PI/180),i=50*r,a=50*r*1,o=new ju.OrthographicCamera(-a/2,a/2,i/2,-i/2,.1,2e3);o.position.z=50,o.lookAt(this.scene.position),n.period=t,n.SSId=e,n.camera=o,n.controls=new zh.a(o,document.getElementById("subsequenceComparisonCanvas_"+e)),n.controls.position0.set(0,0,50),n.controls.screenSpacePanning=!1,n.controls.enableZoom=!1,this.subsequencesInComparisonPanel.push(n)}}])&&jh(e.prototype,n),r&&jh(e,r),o}(i.a.Component);function $h(t){return($h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qh(t,e){return(Qh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jh(t);if(e){var i=Jh(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zh(this,n)}}function Zh(t,e){return!e||"object"!==$h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jh(t){return(Jh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qh(t,e)}(o,t);var e,n,r,a=Xh(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={fileType:"csv",headerNum:1,variableNameLine:1,grid:!0,label:!0,axis:!0,plot:!0,comment:!0,clip:!0,shade:!0,lock:!1,multiOptions:!1},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.setAverageSlider(),Ju.on("upload",(function(){Ju.getAllData().length>1&&t.setState({multiOptions:!0}),$("#fileInputPanel").css("visibility","hidden")}))}},{key:"setAverageSlider",value:function(){var t=$("#averageSliderVal");$("#averageSlider").slider({range:"min",value:0,min:0,max:200,slide:function(e,n){t.css("display","initial"),t.val(n.value+" days");var r,i=$("#averageSlider").slider("option","min"),a=$("#averageSlider").slider("option","max")-i,o=$("#averageSlider").width()*(n.value-i)/a-10;t.css("left",o+"px"),r=n.value,hu.dispatch({type:"UPDATE_AVERAGE_PERIOD",value:r})},stop:function(){t.css("display","none")}})}},{key:"changeFileType",value:function(){var t=$("input[name=fileType]:checked").val();this.setState({fileType:t})}},{key:"resetCamera",value:function(){this.getSelectedIDs().forEach((function(t){Nu(t)}))}},{key:"switchCamera",value:function(){this.getSelectedIDs().forEach((function(t){var e;e=t,hu.dispatch({type:"SWITCH_CAMERA",id:e})}))}},{key:"uploadFile",value:function(){pc(document.getElementById("uploadFileForm").files,this.state.headerNum,this.state.variableNameLine)}},{key:"searchTime",value:function(){var t=document.getElementById("searchTimeForm").value;this.getSelectedIDs().forEach((function(e){Ru(e,Number(t))}))}},{key:"switchGridDisplay",value:function(){var t=!this.state.grid;this.setState({grid:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_GRID",id:t,state:e})}(e,t)}))}},{key:"switchLabelDisplay",value:function(){var t=!this.state.label;this.setState({label:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_LABEL",id:t,state:e})}(e,t)}))}},{key:"switchAxisDisplay",value:function(){var t=!this.state.axis;this.setState({axis:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_AXIS",id:t,state:e})}(e,t)}))}},{key:"switchPlotDisplay",value:function(){var t=!this.state.plot;this.setState({plot:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_PLOT",id:t,state:e})}(e,t)}))}},{key:"switchCommentDisplay",value:function(){var t=!this.state.comment;this.setState({comment:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_COMMENT",id:t,state:e})}(e,t)}))}},{key:"changeBackground",value:function(){var t=document.getElementById("backgroundList"),e=t.selectedIndex,n=t.options[e].value;this.getSelectedIDs().forEach((function(t){var e,r;e=t,r=n,hu.dispatch({type:"CHANGE_BACKGROUND",id:e,color:r})}))}},{key:"clipTube",value:function(){var t=!this.state.clip;this.setState({clip:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"CLIP_TUBE",id:t,state:e})}(e,t)}))}},{key:"switchShade",value:function(){var t=!this.state.shade;this.setState({shade:t}),this.getSelectedIDs().forEach((function(e){!function(t,e){hu.dispatch({type:"SWITCH_SHADE",id:t,state:e})}(e,t)}))}},{key:"selectAllViews",value:function(){var t=$("#selectAllViews").text(),e=$("input[name=selectView]");"Select All"===t?(e.prop("checked",!0),$("#selectAllViews").text("Deselect All")):"Deselect All"===t&&(e.prop("checked",!1),$("#selectAllViews").text("Select All"))}},{key:"timeFitting",value:function(){if(this.state.multiOptions){var t=lc.getActiveId(),e=lc.getFocused(t),n=Ju.getData(t);r=e+n.data.spatial[0].z,hu.dispatch({type:"TIME_FITTING",dst:r})}var r}},{key:"mergeTubes",value:function(){if(this.state.multiOptions){var t=this.getSelectedIDs();e=t,n=Promise.resolve(),r=[],i=[],n.then((function(){for(var t=0;t<e.length;t++){var n=Ju.getData(e[t]);r=r.concat(n.data.data),i.push(n.name)}var a=i.join(",");r.sort((function(t,e){var n=t.JD,r=e.JD;return Math.log10(t.JD)>4&&(n-=245e4),Math.log10(e.JD)>4&&(r-=245e4),n<r?-1:1}));var o=uc(mc(r),3),s=o[0],l=o[1],u=o[2],c=gc(dc,s),h=vc(s),d=yc(h.spline.hue.points,h.spline.value.points);return{fileName:a,data:r,spatial:s,lookup:l,meta:c,hueValRanks:d,polarPhotoSplit:u,splines:h}})).then((function(t){hu.dispatch({type:"UPLOAD_DATA",data:{name:t.fileName,data:t.data,spatial:t.spatial,meta:t.meta,splines:t.splines.spline,lookup:t.lookup,hueValRanks:t.hueValRanks,polarPhotoSplit:t.polarPhotoSplit,merge:!0}})}))}var e,n,r,i}},{key:"lockControl",value:function(){if(this.state.multiOptions){var t=!this.state.lock;this.setState({lock:t}),function(t,e){hu.dispatch({type:"LOCK_CONTROL",ids:t,state:e})}(this.getSelectedIDs(),t)}}},{key:"clickClose",value:function(){var t=document.getElementById("closeFilePanel").innerText;$("#fileMainArea").slideToggle(),t.match("Close")?document.getElementById("closeFilePanel").innerText="Open the file input panel":document.getElementById("closeFilePanel").innerText="Close the file input panel"}},{key:"clickSub",value:function(){this.setState({headerNum:this.state.headerNum-1})}},{key:"clickAdd",value:function(){this.setState({headerNum:this.state.headerNum+1})}},{key:"clickVariableNameLineSub",value:function(){this.setState({variableNameLine:this.state.variableNameLine-1})}},{key:"clickVariableNameLineAdd",value:function(){this.setState({variableNameLine:this.state.variableNameLine+1})}},{key:"getSelectedIDs",value:function(){var t=lc.getCheckedList(),e=[];return t.forEach((function(t,n){t&&e.push(n)})),e}},{key:"basicMenu",value:function(){return i.a.createElement("ul",{className:"navbar-nav",id:"basicMenu"},i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("label",{className:"nav-link menuLabel",href:"#",id:"controllersFileDropdown",role:"button",onClick:this.showFileInputPanel.bind(this)},"File"),i.a.createElement("div",{className:"input-group input-group-sm dropdownonTubeMenu",style:{visibility:"hidden",position:"absolute",top:"2rem",width:"auto",zIndex:"100"},id:"fileInputPanel"},this.fileInputPanel())),i.a.createElement("li",{className:"nav-item"},i.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"controllersSettingDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",style:{fontSize:"1rem"}},""),i.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},i.a.createElement("h6",null,"Wheel interval"),i.a.createElement("select",{id:"wheelIntervalList",className:"form-control custom-select",onChange:this.updateWheelInterval.bind(this),style:{fontSize:"0.8rem",height:"1.5rem",width:"5rem"}},i.a.createElement("option",{value:"1"},"1 day"),i.a.createElement("option",{value:"3"},"3 days"),i.a.createElement("option",{value:"5"},"5 days"),i.a.createElement("option",{value:"7"},"7 days")))))}},{key:"showFileInputPanel",value:function(){var t=$("#fileInputPanel").css("visibility"),e=$("#controllersFileDropdown").position();switch(t){case"visible":$("#fileInputPanel").css("visibility","hidden");break;case"hidden":$("#fileInputPanel").css("left",e.left),$("#fileInputPanel").css("visibility","visible")}}},{key:"fileInputPanel",value:function(){return i.a.createElement("div",{id:"inputFile",className:"controllersElem"},i.a.createElement("h6",null,"File type"),i.a.createElement("form",{id:"fileType",className:"form-check-inline",style:{minWidth:"200px"},onChange:this.changeFileType.bind(this)},i.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},i.a.createElement("input",{type:"radio",name:"fileType",value:"csv",className:"custom-control-input",checked:"csv"===this.state.fileType,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"csv")),i.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},i.a.createElement("input",{type:"radio",name:"fileType",value:"tsv",className:"custom-control-input",disabled:!0,checked:"tsv"===this.state.fileType,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"tsv")),i.a.createElement("div",{className:"custom-control custom-radio",style:{marginRight:"0.5rem"}},i.a.createElement("input",{type:"radio",name:"fileType",value:"space",disabled:!0,className:"custom-control-input",checked:"space"===this.state.fileType,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"inlineCheckbox1"},"space"))),i.a.createElement("h6",null,"How many lines are included in the header?"),i.a.createElement("span",{className:"caution"},"Datasets must contain the variables names in the first line of the header."),i.a.createElement("div",{className:"form-row",id:"initialLineField",style:{display:"flex",justifyContent:"center"}},i.a.createElement("button",{type:"button",id:"sub",className:"sub btn btn-primary  btn-sm",style:{textAlign:"center"},onClick:this.clickSub.bind(this),disabled:this.state.headerNum<=1},"-"),i.a.createElement("label",{id:"initialLineVal",style:{textAlign:"center",width:"6rem"}},this.state.headerNum+(this.state.headerNum<=1?" line":" lines")),i.a.createElement("button",{type:"button",id:"add",className:"add btn btn-primary btn-sm",style:{textAlign:"center"},onClick:this.clickAdd.bind(this)},"+")),i.a.createElement("h6",null,"Select files"),i.a.createElement("div",{className:"custom-file"},i.a.createElement("input",{type:"file",className:"custom-file-input",id:"uploadFileForm",onChange:this.uploadFile.bind(this),multiple:!0}),i.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"})),i.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"0.5rem"}},i.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:this.openTestData.bind(this)},"Synthetic Data")))}},{key:"openTestData",value:function(){$.ajax({url:"data/synthesisData8.csv",success:function(t){!function(t,e){var n=[],r=[],i=wi(e,(function(e){return Object.keys(e).forEach((function(t){isNaN(e[t])||(e[t]=Number(e[t]))}),e),e.source=t,e})).splice(0);n.push(i);for(var a=0;a<n.length;a++)r=r.concat(n[a]);r.sort((function(t,e){return t.JD<e.JD?-1:1}));var o=uc(mc(r),3),s=o[0],l=o[1],u=o[2],c=gc(dc,s),h=vc(s),d=yc(h.spline.hue.points,h.spline.value.points);hu.dispatch({type:"UPLOAD_DATA",data:{name:t,data:r,spatial:s,meta:c,splines:h.spline,lookup:l,hueValRanks:d,merge:!1,polarPhotoSplit:u}})}("testdata4.csv",t)}})}},{key:"updateWheelInterval",value:function(t){var e,n=document.getElementById("wheelIntervalList"),r=n.selectedIndex,i=n.options[r].value;e=Number(i),hu.dispatch({type:"UPDATE_WHEEL_INTERVAL",interval:e})}},{key:"displayMenu",value:function(){return i.a.createElement("ul",{className:"navbar-nav",id:"displayMenu"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("label",{className:"nav-link menuLabel",id:"resetCameraBtn",onClick:this.resetCamera.bind(this)},"Reset")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("label",{className:"nav-link menuLabel",id:"switchCameraBtn",onClick:this.switchCamera.bind(this)},"Switch camera")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxGrid",checked:this.state.grid,onChange:this.switchGridDisplay.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchGridDisplay.bind(this)},"Grid")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxLabel",checked:this.state.label,onChange:this.switchLabelDisplay.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchLabelDisplay.bind(this)},"Label")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxAxis",checked:this.state.axis,onChange:this.switchAxisDisplay.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchAxisDisplay.bind(this)},"Axis")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxPlot",checked:this.state.plot,onChange:this.switchPlotDisplay.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchPlotDisplay.bind(this)},"Plot")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxComment",checked:this.state.comment,onChange:this.switchCommentDisplay.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",onClick:this.switchCommentDisplay.bind(this)},"Comment")),i.a.createElement("div",{className:"form-check form-check-inline menuItem"},i.a.createElement("select",{className:"form-control custom-select",id:"backgroundList",onChange:this.changeBackground.bind(this),style:{fontSize:"0.8rem",height:"1.5rem",width:"5rem"}},i.a.createElement("option",{value:"0x000000"},"Black"),i.a.createElement("option",{value:"0x3f3f3f"},"Gray 75"),i.a.createElement("option",{value:"0x7f7f7f"},"Gray 50"),i.a.createElement("option",{value:"0xbfbfbf"},"Gray 25"),i.a.createElement("option",{value:"0xffffff"},"White"),i.a.createElement("option",{value:"0x191970"},"Navy"))))}},{key:"tubeMenu",value:function(){return i.a.createElement("ul",{className:"navbar-nav",id:"tubeMenu"},i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxClip",value:"option1",checked:this.state.clip,onChange:this.clipTube.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.clipTube.bind(this)},"Clip")),i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxShade",value:"option1",checked:this.state.shade,onChange:this.switchShade.bind(this)}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.switchShade.bind(this)},"Shade")),i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Average"),i.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},i.a.createElement("div",{id:"averageSlider",style:{float:"left",width:"8rem",marginBottom:".5rem",marginTop:".5rem"}},i.a.createElement("output",{id:"averageSliderVal",style:{position:"absolute",display:"none",top:"-30px",backgroundColor:"#fff",opacity:"0.8",borderRadius:"3px",color:"#777",padding:"2px"}})))),i.a.createElement("li",{className:"nav-item"},i.a.createElement("label",{className:"nav-link menuLabel",id:"selectAllViews",onClick:this.selectAllViews.bind(this)},"Select All")))}},{key:"multiTubesMenu",value:function(){return i.a.createElement("ul",{className:"navbar-nav",id:"multiTubesMenu"},i.a.createElement("div",{className:"custom-control custom-checkbox menuItem"},i.a.createElement("input",{className:"custom-control-input menuCheck",type:"checkbox",id:"checkboxLock",value:"option1",checked:this.state.lock,onChange:this.lockControl.bind(this),disabled:!this.state.multiOptions}),i.a.createElement("label",{className:"custom-control-label nav-link menuLabel",htmlFor:"inlineCheckbox1",onClick:this.lockControl.bind(this)},"Lock")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("label",{className:"nav-link menuLabel",onClick:this.timeFitting.bind(this)},"Time Fitting")),i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("label",{className:"nav-link dropdown-toggle menuLabel",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Fusion"),i.a.createElement("div",{className:"dropdown-menu controllersElem","aria-labelledby":"navbarDropdown"},i.a.createElement("label",{className:"dropdown-item menuLabel",id:"mergeBtn",onClick:this.mergeTubes.bind(this)},"All"))))}},{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",id:"tubeControllers"},i.a.createElement("div",{className:"collapse navbar-collapse",id:"TimeTubesMenu"},this.basicMenu(),this.displayMenu(),this.tubeMenu(),this.multiTubesMenu()))}}])&&Yh(e.prototype,n),r&&Yh(e,r),o}(i.a.Component);function td(t){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ed(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nd(t,e){return(nd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ad(t);if(e){var i=ad(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return id(this,n)}}function id(t,e){return!e||"object"!==td(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ad(t){return(ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var od=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nd(t,e)}(a,t);var e,n,r,i=rd(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).timeRange=[],t}return e=a,(n=[{key:"handleActions",value:function(t){switch(t.type){case"UPLOAD_DATA":this.uploadData(t.data);break;case"RESET_SCATTERPLOTS":this.emit("resetScatterplots",t.id);break;case"MOVE_CURRENT_LINE_ON_TIMESELECTOR":this.emit("moveCurrentLineonTimeSelector",t.id,t.zpos);break;case"UPDATE_TIME_RANGE":this.updateTimeRange(t.id,t.range)}}},{key:"getTimeRange",value:function(t){return this.timeRange[t]}},{key:"uploadData",value:function(t){this.timeRange.push([t.meta.min.z,t.meta.max.z]),this.emit("upload")}},{key:"updateTimeRange",value:function(t,e){this.timeRange[t]=e,this.emit("updateTimeRange",t,e)}}])&&ed(e.prototype,n),r&&ed(e,r),a}(mu.EventEmitter));hu.register(od.handleActions.bind(od));var sd=od;function ld(t){return(ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ud(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cd(t,e){return(cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fd(t);if(e){var i=fd(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dd(this,n)}}function dd(t,e){return!e||"object"!==ld(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fd(t){return(fd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var pd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cd(t,e)}(o,t);var e,n,r,a=hd(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:10,left:10},e.id=t.id,e.divID=t.divID,e.data=Ju.getData(e.id),e.selectedRange=[e.data.data.meta.min.z,e.data.data.meta.max.z],e.SSRects=void 0,e.state={width:t.width,height:100},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initializeElements(),this.drawTimeSelector(),lc.on("updateFocus",(function(e,n,r){e===t.id&&t.moveCurrentLine(n+t.data.data.spatial[0].z)})),lc.on("showRotationCenter",(function(e,n,r){e===t.id&&t.moveCurrentLine(n[0])})),lc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&t.moveCurrentLine(n[0])})),lc.on("searchTime",(function(e,n){e===t.id&&t.moveCurrentLine(n)})),sd.on("moveCurrentLineonTimeSelector",(function(e,n){e===t.id&&t.moveCurrentLine(n)})),sd.on("updateTimeRange",(function(e,n){e===t.id&&(t.selectedRange=n)})),Rh.on("setExtractionResults",(function(){t.clearClusteringResults()})),Rh.on("clearResults",(function(){t.clearClusteringResults()})),Rh.on("convertResultIntoQuery",(function(e,n,r){t.clearClusteringResults()})),Rh.on("clearResults",(function(){t.clearClusteringResults()})),Rh.on("recoverQuery",(function(e){t.clearClusteringResults()})),zc.on("showClusteringResults",(function(){var e=zc.getSubsequences(),n=zc.getLabels(),r=zc.getClusterColors();t.clearClusteringResults(),t.showClusteringResults(e,n,r)})),zc.on("updateClusteringResults",(function(){var e=zc.getSubsequences(),n=zc.getLabels(),r=zc.getClusterColors();t.clearClusteringResults(),t.showClusteringResults(e,n,r)})),zc.on("resetClusteringResults",(function(){var e=zc.getSubsequences(),n=zc.getLabels(),r=zc.getClusterColors();t.clearClusteringResults(),t.showClusteringResults(e,n,r)})),zc.on("recoverClusteringSession",(function(){var e=zc.getSubsequences(),n=zc.getLabels(),r=zc.getClusterColors();t.clearClusteringResults(),t.showClusteringResults(e,n,r)}))}},{key:"initializeElements",value:function(){this.xScale=Na().domain([this.data.data.meta.min.z,this.data.data.meta.max.z]),this.brush=Yr(),this.yScale=Na().domain([this.data.data.meta.min.V,this.data.data.meta.max.V]),this.svg=se("#"+this.divID).append("svg").attr("class","timeSelector").attr("id","timeSelectorSVG_"+this.id),this.clip=this.svg.append("defs").append("clipPath").attr("id","clipTimeSelector_"+this.id).append("rect"),this.timeCurve=function(){var t=$s,e=null,n=Gs(0),r=Ys,i=Gs(!0),a=null,o=Ws,s=null;function l(l){var u,c,h,d,f,p=l.length,m=!1,g=new Array(p),v=new Array(p);for(null==a&&(s=o(f=ei())),u=0;u<=p;++u){if(!(u<p&&i(d=l[u],u,l))===m)if(m=!m)c=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=c;--h)s.point(g[h],v[h]);s.lineEnd(),s.areaEnd()}m&&(g[u]=+t(d,u,l),v[u]=+n(d,u,l),s.point(e?+e(d,u,l):g[u],r?+r(d,u,l):v[u]))}if(f)return s=null,f+""||null}function u(){return Qs().defined(i).curve(o).context(a)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:Gs(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:Gs(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:Gs(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:Gs(+t),r=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:Gs(+t),l):n},l.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Gs(+t),l):r},l.lineX0=l.lineY0=function(){return u().x(t).y(n)},l.lineY1=function(){return u().x(t).y(r)},l.lineX1=function(){return u().x(e).y(n)},l.defined=function(t){return arguments.length?(i="function"==typeof t?t:Gs(!!t),l):i},l.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),l):o},l.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),l):a},l}().curve(Ws),this.timeSelector=this.svg.append("g").attr("class","timeSelector").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.timeSelectorGraph=this.timeSelector.append("path").datum(this.data.data.splines.value.points).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("clip-path","url(#clipTimeSelector_"+this.id+")"),this.timeSelectorXAxis=this.timeSelector.append("g").attr("class","axis axis--x"),this.timeSelectorBrusher=this.timeSelector.append("g").attr("class","brush"),this.currentLine=this.svg.append("line").attr("stroke-width",3).attr("stroke","orange").attr("id","timeSelectorCurrent_"+this.id)}},{key:"drawTimeSelector",value:function(){this.id,this.divID;var t=this.props.width,e=this.state.height,n=t-this.margin.left-this.margin.right,r=e-this.margin.top-this.margin.bottom;this.selectedRange,this.svg.attr("width",this.props.width).attr("height",this.state.height),this.xScale.range([0,n]),this.xScale;var i=V(this.xScale);this.brush.extent([[0,0],[n,r]]).on("start brush",function(){var t=($t.selection||this.xScale.range).map(this.xScale.invert,this.xScale);Us(".scatterplots"+this.id).size()>0&&t.toString()!==this.selectedRange.toString()&&function(t,e){hu.dispatch({type:"UPDATE_TIME_RANGE",id:t,range:e})}(this.id,t)}.bind(this)),this.yScale.range([r,0]),this.clip.attr("width",n).attr("height",r),this.timeCurve.x(function(t){return this.xScale(t.z)}.bind(this)).y0(r).y1(function(t){return this.yScale(t.y)}.bind(this)),this.timeSelectorGraph.attr("d",this.timeCurve),this.timeSelectorXAxis.attr("transform","translate(0,"+r+")").call(i),this.timeSelectorBrusher.call(this.brush).call(this.brush.move,[this.invertScale(this.selectedRange[0]),this.invertScale(this.selectedRange[1])]);var a=pi().on("start",(function(){se(this).classed("selectedLine",!0)})).on("drag",function(){var t=se("#timeSelectorCurrent_"+this.id),e=$t.x;e<=this.margin.left?e=this.margin.left:this.margin.left+n<=e&&(e=this.margin.left+n),t.attr("x1",e).attr("x2",e);var r=this.xScale.invert(e-this.margin.left);Ru(this.id,r)}.bind(this)).on("end",(function(){se(this).classed("selectedLine",!1)}));this.currentLine.attr("x1",this.margin.left).attr("y1",this.margin.top).attr("x2",this.margin.left).attr("y2",r+this.margin.top).call(a)}},{key:"invertScale",value:function(t){var e=this.xScale.range(),n=this.xScale.domain();return(t-n[0])*(e[1]-e[0])/(n[1]-n[0])+e[0]}},{key:"updateTimeSelector",value:function(){this.id,this.divID;var t=this.props.width,e=this.state.height,n=t-this.margin.left-this.margin.right,r=e-this.margin.top-this.margin.bottom;this.selectedRange,this.svg.attr("width",this.props.width).attr("height",this.state.height),this.xScale.range([0,n]),this.xScale;var i=V(this.xScale);this.brush.extent([[0,0],[n,r]]),this.yScale.range([r,0]),this.clip.attr("width",n).attr("height",r),this.timeCurve.x(function(t){return this.xScale(t.z)}.bind(this)).y0(r).y1(function(t){return this.yScale(t.y)}.bind(this)),this.timeSelectorGraph.attr("d",this.timeCurve),this.timeSelectorXAxis.attr("transform","translate(0,"+r+")").call(i),this.timeSelectorBrusher.call(this.brush.move,[this.invertScale(this.selectedRange[0]),this.invertScale(this.selectedRange[1])]),this.currentLine.attr("y2",r+this.margin.top)}},{key:"moveCurrentLine",value:function(t){var e=se("#timeSelectorCurrent_"+this.id),n=this.xScale(t)+this.margin.left;e.attr("x1",n).attr("x2",n),this.SSRects&&(this.SSRects.each((function(e,n){var r=se(this);e[0].z<=t&&t<=e[e.length-1].z?r.attr("opacity",1):r.attr("opacity",.3)})),this.timeSelectorGraph.moveToFront())}},{key:"showClusteringResults",value:function(t,e,n){for(var r=(this.state.height-this.margin.top-this.margin.bottom)/n.length,i=[],a=[],o=0;o<t.length;o++)Number(t[o].id)===this.id&&(i.push(t[o]),a.push(e[o]));var s=this.svg.append("g").attr("class","SSRectGroup").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipTimeSelector_"+this.id+")");this.SSRects=s.selectAll("rect.SSRect").data(i).enter().append("rect").attr("class","SSRect").attr("x",function(t){return this.xScale(t[0].z)}.bind(this)).attr("width",function(t){return this.xScale(t[t.length-1].z)-this.xScale(t[0].z)}.bind(this)).attr("y",(function(t,e){var n="object"===ld(a[e])?a[e].cluster:a[e];return r*n})).attr("height",r).attr("fill",(function(t,e){var r=n["object"===ld(a[e])?a[e].cluster:a[e]];return Be(r[0],r[1],r[2])})).attr("opacity",.3),this.timeSelectorGraph.moveToFront()}},{key:"clearClusteringResults",value:function(){this.SSRects&&this.SSRects.remove(),this.SSRects=void 0}},{key:"render",value:function(){return Us("svg#timeSelectorSVG_"+this.id).size()>0&&this.updateTimeSelector(),i.a.createElement("div",{id:this.divID,className:"timeSelector outerContainer"})}}])&&ud(e.prototype,n),r&&ud(e,r),o}(i.a.Component);function md(t){return(md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vd(t,e){return(vd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=xd(t);if(e){var i=xd(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return bd(this,n)}}function bd(t,e){return!e||"object"!==md(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xd(t){return(xd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vd(t,e)}(o,t);var e,n,r,a=yd(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{className:"TimeTubesHolder",id:"TimeTubesHolder_"+this.id},i.a.createElement(Wh,{id:this.id,data:this.data,width:this.props.width,height:this.props.height-100}),i.a.createElement("div",{id:this.divID,className:"timeSelector"},i.a.createElement(pd,{id:this.id,divID:"timeSelector_"+this.id,width:this.props.width})))}}])&&gd(e.prototype,n),r&&gd(e,r),o}(i.a.Component);function wd(t){var e=t;return Math.log10(Math.abs(t))<-2&&0!==t&&(e=t.toExponential(1)),e}function Sd(t){return t=Number(t),Math.log10(Math.abs(t))<-2&&0!==t?t.toExponential(1):(Math.log10(t),t.toFixed(2))}function Ed(t){return(Ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Md(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cd(t,e){return(Cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Td(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pd(t);if(e){var i=Pd(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return kd(this,n)}}function kd(t,e){return!e||"object"!==Ed(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pd(t){return(Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Ad=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cd(t,e)}(o,t);var e,n,r,a=Td(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:30,left:60},e.id=t.id,e.divID=t.divID,e.SPID=t.id+"_"+t.divID.split("_")[1],e.data=Ju.getData(e.id);var n=sd.getTimeRange(e.id);e.timeRange=void 0===n?[e.data.data.meta.min.z,e.data.data.meta.max.z]:n,e.slicedData=e.data.data.spatial.filter((function(e){return t.xItem in e&&t.yItem in e})),e.xMinMax=[0,0],e.yMinMax=[0,0];var r=dh("privateComment");for(var i in e.commentsList=[],r)if(r[i].fileName===e.data.name){var s={};for(var l in s.id=i,r[i])s[l]=r[i][l];e.commentsList.push(s)}return e.state={xItem:t.xItem,yItem:t.yItem,xItemonPanel:t.xItem,yItemonPanel:t.yItem,width:t.width,height:Math.max(t.height,200)},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initalizeElements(),this.computeRange(this.state.xItem,this.state.yItem),this.drawScatterplots(),Ju.on("updatePrivateComment",(function(){var e=t.commentsList.length,n=dh("privateComment");for(var r in t.commentsList=[],n)if(n[r].fileName===t.data.name){var i={};for(var a in i.id=r,n[r])i[a]=n[r][a];t.commentsList.push(i)}if(t.commentsList.length<e)t.commentMarks=t.commentMarks_g.selectAll("path").data(t.commentsList),t.commentMarks.exit().remove();else{var o=t.commentMarks_g.selectAll("path").data(t.commentsList),s=o.enter().append("path").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(t));t.commentMarks=s.merge(o)}t.updateScatterplots()})),lc.on("updateFocus",(function(e,n,r){e===t.id&&(r?t.highlightCurrentPlot(n):t.updateCurrentPos(n))})),lc.on("changePlotColor",(function(e){e===t.id?t.changePlotColor(lc.getPlotColor(e)):t.data.data.merge&&t.data.data.name.indexOf(Ju.getData(e).data.name)>=0&&t.changePlotColorMerge(Ju.getData(e).data.name,lc.getPlotColor(e))})),lc.on("showRotationCenter",(function(e,n,r){e===t.id&&t.updateCurrentPos(n[0]-t.data.data.spatial[0].z)})),lc.on("showTimeTubesOfTimeSlice",(function(e,n){e===t.id&&t.updateCurrentPos(n[0]-t.data.data.spatial[0].z)})),lc.on("searchTime",(function(e,n){e===t.id&&t.highlightCurrentPlot(n-t.data.data.spatial[0].z)})),sd.on("resetScatterplots",(function(e){e===t.id&&t.reset()})),sd.on("updateTimeRange",(function(e,n){e===t.id&&(t.timeRange=n,t.computeRange(t.state.xItem,t.state.yItem),t.updateScatterplots(t.state.xItem,t.state.yItem))}))}},{key:"initalizeElements",value:function(){this.zoom=cu().scaleExtent([.5,20]),this.sp=se("#"+this.divID).append("svg").attr("id","scatterplotsSVG_"+this.SPID).attr("class","scatterplot scatterplots"+this.id+" "+this.divID),this.xScale=Na(),this.xScaleTmp=this.xScale,this.xAxis=this.sp.append("g").attr("class","x_axis "+this.divID),this.xAxisText=Us("g.x_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("text-anchor","middle"),this.yScale=Na(),this.yScaleTmp=this.yScale,this.yAxis=this.sp.append("g").attr("class","y_axis "+this.divID).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.yAxisText=Us("g.y_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle"),this.tooltip=se("#"+this.divID).append("div").attr("class","tooltip "+this.divID).attr("id","tooltip_"+this.SPID).style("opacity",.75).style("visibility","hidden"),this.line=Qs().x((function(t){return t[0]})).y((function(t){return t[1]})),this.lineH=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineH "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.lineV=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineV "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.clip=this.sp.append("defs").append("clipPath").attr("id","clipScatterplots_"+this.SPID).append("rect"),this.point_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("points_g",!0),this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id),this.commentMarks_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("comments_g",!0),this.symbolGenerator=nl().size(50),this.commentMarks=this.commentMarks_g.selectAll("path").data(this.commentsList).enter().append("path").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(this))}},{key:"drawScatterplots",value:function(){this.id;var t=this.SPID,e=(this.divID,this.margin),n=(this.data,this.props.width),r=Math.max(this.props.height,200),i=n-this.margin.left-this.margin.right,a=r-this.margin.top-this.margin.bottom,o=this.state.xItem,s=this.state.yItem;this.tooltip,this.zoom.extent([[0,0],[i,a]]).on("zoom",function(){var t=$t.transform.rescaleX(this.xScale),e=$t.transform.rescaleY(this.yScale);this.xScaleTmp=t,this.yScaleTmp=e,this.xMinMax=t.domain(),this.yMinMax=e.domain(),this.xAxis.call(this.xLabel.scale(t)),this.yAxis.call(this.yLabel.scale(e)),this.points.attr("cx",(function(e){return t(e[o])})).attr("cy",(function(t){return e(t[s])})),this.SSRects&&this.SSRects.attr("x",(function(e){return t(e[0].z)})).attr("width",(function(e){return t(e[e.length-1].z)-t(e[0].z)})),"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",(function(e){return"translate("+t(e.start)+", 6)"})).attr("fill",(function(t){return t.labelColor.replace("0x","#")}));var n=se("circle.current."+this.divID);if(n._groups[0][0]){var r=n.attr("cx"),l=n.attr("cy");l<=0||a<=l?this.lineH.attr("transform","translate("+this.margin.left+","+l+")").style("visibility","hidden"):this.lineH.transition().duration(0).attr("transform","translate("+this.margin.left+","+l+")").style("visibility","visible"),r<=0||i<=r?this.lineV.attr("transform","translate("+r+","+this.margin.top+")").style("visibility","hidden"):this.lineV.transition().duration(0).attr("transform","translate("+r+","+this.margin.top+")").style("visibility","visible")}}.bind(this)),this.sp.attr("width",n).attr("height",r).call(this.zoom).on("dblclick.zoom",null),this.xScale.domain(this.xMinMax).nice().range([0,i]),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-a).tickFormat(wd),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+a)+")").call(this.xLabel),this.xAxisText.attr("x",i/2).attr("y",this.margin.bottom/2+10).text(this.data.data.lookup[o]).on("click",function(){var n=se("#changeXAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var r=document.getElementById("changeXAxisPanel_"+t).clientHeight,o=document.getElementById("changeXAxisPanel_"+t).clientWidth;n.style("transform","translate("+(i/2+e.left-o/2)+"px,"+(a+e.top-r)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")})),this.yScale.domain(this.yMinMax).nice().range([a,0]),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-i).tickFormat(wd),this.yAxis.call(this.yLabel),this.yAxisText.attr("x",-a/2).attr("y",-this.margin.left/2-10).text(this.data.data.lookup[s]).on("click",function(){var n=se("#changeYAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({yItemonPanel:this.state.yItem});else{var r=document.getElementById("changeXAxisPanel_"+t).clientHeight;document.getElementById("changeXAxisPanel_"+t).clientWidth,n.style("transform","translate("+e.left+"px,"+(a/2+e.top-r/2)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")}));var l=[[0,this.margin.top],[i,this.margin.top]],u=[[this.margin.left,0],[this.margin.left,a]];if(this.lineH.attr("d",this.line(l)),this.lineV.attr("d",this.line(u)),this.clip.attr("width",i).attr("height",a),this.data.data.merge){for(var c={},h=this.data.name.split(","),d=[],f=0;f<h.length;f++){var p=Ju.getIdFromName(h[f]);c[h[f]]=f;var m=h[f].split("+");if(m.length>1)for(var g=0;g<m.length;g++)c[m[g]]=f;d.push(lc.getPlotColor(p))}this.points.attr("cx",function(t){return this.xScale(t[o])}.bind(this)).attr("cy",function(t){return this.yScale(t[s])}.bind(this)).attr("fill",(function(t){return d[c[t.source]]})).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var v=lc.getPlotColor(this.id);this.points.attr("cx",function(t){return this.xScale(t[o])}.bind(this)).attr("cy",function(t){return this.yScale(t[s])}.bind(this)).attr("fill",v).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",function(t){return"translate("+this.xScale(t.start)+", 6)"}.bind(this)).attr("fill",(function(t){return t.labelColor.replace("0x","#")})).on("mouseover",this.commentMarksMouseOver()).on("mouseout",this.commentMarksMouseOut()).on("dblclick",this.commentMarksDblClick())}},{key:"spMouseOver",value:function(){var t=this.tooltip,e=this.data,n=this.state.xItem,r=this.state.yItem;return function(i){se(this).attr("stroke-width",1).attr("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>"+e.data.lookup[n]+"</i>: "+i[n]+"<br/><i>"+e.data.lookup[r]+"</i>: "+i[r]).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"spMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);n.style("fill")!==ke("red").toString()&&(n.attr("stroke-width",.5).attr("stroke","dimgray"),n.attr("class").indexOf("current")<0?n.attr("stroke-width",.5).attr("stroke","dimgray"):n.attr("stroke","orange").attr("stroke-width",1)),t.transition().duration(150).style("visibility","hidden")}}},{key:"spDblClick",value:function(){var t=this.id;return function(e){Ru(t,e.z)}}},{key:"commentMarksMouseOver",value:function(){var t=this.tooltip;return function(e){se(this).style("stroke-width",1).style("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>Time stamp</i>: "+e.timeStamp+"<br/><i>User name</i>: "+e.userName+"<br/><i>Comment</i>: "+e.comment).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"commentMarksMouseOut",value:function(){var t=this.tooltip;return function(){se(this).style("stroke-width",0),t.transition().duration(150).style("visibility","hidden")}}},{key:"commentMarksDblClick",value:function(){var t=this.id;return function(e){Ru(t,e.start)}}},{key:"highlightCurrentPlot",value:function(t){var e=this.margin,n=this.divID,r=t+this.data.data.spatial[0].z,i=Us("svg."+n),a=this.state.xItem,o=this.state.yItem;function s(t){var r=se(this),i=(r.attr("class").split(" ")[1],se("svg."+n)),a=i.selectAll(".currentLineH"),o=i.selectAll(".currentLineV");a.transition().duration(0).style("visibility","visible").attr("transform","translate("+e.left+","+r.attr("cy")+")"),o.transition().duration(0).style("visibility","visible").attr("transform","translate("+r.attr("cx")+","+e.top+")")}i.each((function(t){var e=se(this),n=e.selectAll("circle"),i=e.attr("class").split(" ");n.attr("stroke-width",.5).attr("stroke","dimgray").attr("class",i[1]+" "+i[2]);var l=n.filter((function(t){return t.z===r&&a in t&&o in t}));l._groups.length>0&&l.attr("stroke","orange").attr("stroke-width",1).attr("class",i[1]+" "+i[2]+" current").moveToFront().each(s)}))}},{key:"updateCurrentPos",value:function(t){var e=this.sp.attr("height");if("z"===this.state.xItem){var n=Na().domain([this.xMinMax[0],this.xMinMax[1]]).range([0,this.props.width-this.margin.left-this.margin.right]),r=t+this.data.data.spatial[0].z;this.lineH.style("visibility","hidden"),this.lineV.transition().duration(0).style("visibility","visible").attr("transform","translate("+n(r)+","+this.margin.top+")")}else if("z"===this.state.yItem){var i=Na().domain([this.yMinMax[0],this.yMinMax[1]]).range([0,e-this.margin.top-this.margin.bottom]),a=t+this.data.data.spatial[0].z;this.lineV.style("visibility","hidden"),this.lineH.transition().duration(0).style("visibility","visible").attr("transform","translate("+this.margin.left+","+i(a)+")")}}},{key:"changePlotColor",value:function(t){se("#"+this.divID).selectAll("circle").attr("fill",(function(e){return t}))}},{key:"changePlotColorMerge",value:function(t,e){se("#"+this.divID).selectAll("circle").filter((function(e){return t.indexOf(e.source)>=0})).attr("fill",e)}},{key:"onSelectXItem",value:function(t){this.setState({xItemonPanel:t.target.value})}},{key:"onSelectYItem",value:function(t){this.setState({yItemonPanel:t.target.value})}},{key:"computeRange",value:function(t,e){this.slicedData=this.data.data.spatial.filter(function(n){return t in n&&e in n&&this.timeRange[0]<=n.z&&n.z<=this.timeRange[1]}.bind(this)),this.xMinMax=p(this.slicedData,(function(e){return e[t]})),this.yMinMax=p(this.slicedData,(function(t){return t[e]}))}},{key:"updateScatterplots",value:function(t,e){if(this.xScale.domain(this.xMinMax).nice(),this.yScale.domain(this.yMinMax).nice(),this.xMinMax=this.xScale.domain(),this.yMinMax=this.yScale.domain(),this.data.data.merge){for(var n={},r=this.data.name.split(","),i=[],a=0;a<r.length;a++){var o=Ju.getIdFromName(r[a]);n[r[a]]=a;var s=r[a].split("+");if(s.length>1)for(var l=0;l<s.length;l++)n[s[l]]=a;i.push(lc.getPlotColor(o))}this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).select((function(n){return t in n&&e in n?this:null})).attr("fill",(function(t){return i[n[t.source]]})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var u=lc.getPlotColor(this.id);if(this.points._groups[0].length<=this.slicedData.length){var c=this.point_g.selectAll("circle").data(this.slicedData),h=c.enter().append("circle");this.points=h.merge(c),this.points.attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).attr("fill",u).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else this.points=this.point_g.selectAll("circle").data(this.slicedData).attr("cx",function(e){return this.xScale(e[t])}.bind(this)).attr("cy",function(t){return this.yScale(t[e])}.bind(this)).attr("fill",u).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick()),this.points.exit().remove()}this.xAxis.call(this.xLabel.scale(this.xScale)),this.yAxis.call(this.yLabel.scale(this.yScale)),"z"!==this.state.xItem&&"z"!==this.state.yItem||this.commentMarks.attr("transform",function(t){return"translate("+this.xScale(t.start)+", 6)"}.bind(this)).attr("fill",(function(t){return t.labelColor.replace("0x","#")})).on("mouseover",this.commentMarksMouseOver()).on("mouseout",this.commentMarksMouseOut()).on("dblclick",this.commentMarksDblClick())}},{key:"onClickXAxisDone",value:function(t){this.setState({xItem:this.state.xItemonPanel}),this.computeRange(this.state.xItemonPanel,this.state.yItem),this.updateScatterplots(this.state.xItemonPanel,this.state.yItem),this.xAxisText.text(this.data.data.lookup[this.state.xItemonPanel]),se("#changeXAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"onClickYAxisDone",value:function(t){this.setState({yItem:this.state.yItemonPanel}),this.computeRange(this.state.xItem,this.state.yItemonPanel),this.updateScatterplots(this.state.xItem,this.state.yItemonPanel),this.yAxisText.text(this.data.data.lookup[this.state.yItemonPanel]),se("#changeYAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"reset",value:function(){this.sp.transition().duration(500).call(this.zoom.transform,eu)}},{key:"render",value:function(){Us("svg#scatterplotsSVG_"+this.SPID).size()>0&&this.drawScatterplots();var t=[],e=[],n=this.data.data.lookup;for(var r in n){var a="";(a=n[r].length>1?n[r].join(","):n[r]).indexOf("JD")<0?(t.push(i.a.createElement("div",{className:"form-check",key:a},i.a.createElement("input",{type:"radio",name:"selectXAxisForm_"+this.SPID,value:r,checked:this.state.xItemonPanel===r,onChange:this.onSelectXItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))),e.push(i.a.createElement("div",{className:"form-check",key:a},i.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:r,checked:this.state.yItemonPanel===r,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a)))):(t.unshift(i.a.createElement("div",{className:"form-check",key:a},i.a.createElement("input",{type:"radio",name:"selectXAxisForm_"+this.SPID,value:r,checked:this.state.xItemonPanel===r,onChange:this.onSelectXItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))),e.unshift(i.a.createElement("div",{className:"form-check",key:a},i.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:r,checked:this.state.yItemonPanel===r,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:a},a))))}return i.a.createElement("div",{id:"scatterplotsSelectors_"+this.SPID},i.a.createElement("div",{className:"overlayPanel",id:"changeXAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},i.a.createElement("h6",null,"Change x axis"),i.a.createElement("div",{id:"changeXAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},i.a.createElement("form",{id:"selectXAxisForm_"+this.SPID},t)),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_"+this.SPID,onClick:this.onClickXAxisDone.bind(this)},"Done")),i.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},i.a.createElement("h6",null,"Change y axis"),i.a.createElement("div",{id:"changeYAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},i.a.createElement("form",{id:"selectYAxisForm_"+this.SPID},e)),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeYAxisBtn_"+this.SPID,onClick:this.onClickYAxisDone.bind(this)},"Done")))}}])&&Md(e.prototype,n),r&&Md(e,r),o}(i.a.Component);function Od(t){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rd(t,e){return(Rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ld(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dd(t);if(e){var i=Dd(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Id(this,n)}}function Id(t,e){return!e||"object"!==Od(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dd(t){return(Dd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rd(t,e)}(o,t);var e,n,r,a=Ld(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.menuHeight=24,e.state={scatterplotsList:[],width:t.width,height:t.height},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Ju.on("showInitSP",(function(e){if(e===t.id){var n=t.state.scatterplotsList;n.push({x:"z",y:"V"}),t.setState({scatterplotsList:n})}}))}},{key:"addScatterplots",value:function(){var t=document.getElementById("scatterSelectXAxis_"+this.id),e=document.getElementById("scatterSelectYAxis_"+this.id),n=t.options[t.selectedIndex].value,r=e.options[e.selectedIndex].value;if("unselected"!==n&&"unselected"!==r){var i=this.state.scatterplotsList;i.push({x:n,y:r}),this.setState({scatterplotsList:i})}}},{key:"resetScatterplotsZoom",value:function(){var t;t=this.id,hu.dispatch({type:"RESET_SCATTERPLOTS",id:t})}},{key:"render",value:function(){var t=this,e=this.state.scatterplotsList.map((function(e,n){return i.a.createElement("div",{key:t.id+"_"+n,id:"scatterplots"+t.id+"_"+n,style:{display:"inline-block"}},i.a.createElement(Ad,{key:t.id+"_"+n,id:t.id,divID:"scatterplots"+t.id+"_"+n,xItem:e.x,yItem:e.y,width:t.props.width,height:t.props.height-t.menuHeight}))})),n=[];for(var r in this.data.lookup){var a="";a=this.data.lookup[r].length>1?this.data.lookup[r].join(","):this.data.lookup[r],n.push(i.a.createElement("option",{key:r,value:r},a))}return i.a.createElement("div",{className:"scatterplotsHolder",id:"scatterplotsHolder_"+this.id},i.a.createElement("div",{className:"scatterplotsMenu row"},this.fileName,i.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"scatterResetBtn_"+this.id,onClick:this.resetScatterplotsZoom.bind(this)},"Reset"),i.a.createElement("select",{className:"custom-select select_axis",id:"scatterSelectXAxis_"+this.id,defaultValue:"unselected",style:{width:"6rem",height:"1.5rem",float:"right"}},i.a.createElement("option",{value:"unselected"},"x axis"),n),i.a.createElement("select",{className:"custom-select select_axis",id:"scatterSelectYAxis_"+this.id,defaultValue:"unselected",style:{width:"6rem",height:"1.5rem",float:"right"}},i.a.createElement("option",{value:"unselected"},"y axis"),n),i.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"showScatter_"+this.id,style:{float:"right"},onClick:this.addScatterplots.bind(this)},"+")),i.a.createElement("div",{id:"scatterplots_"+this.id,className:"scatterplotsViewports",style:{height:this.props.height-this.menuHeight+"px",width:this.props.width+"px"}},e,i.a.createElement("div",{style:{clear:"both"}})))}}])&&Nd(e.prototype,n),r&&Nd(e,r),o}(i.a.Component);function Fd(t){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vd(t,e){return(Vd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ud(t);if(e){var i=Ud(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Hd(this,n)}}function Hd(t,e){return!e||"object"!==Fd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ud(t){return(Ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vd(t,e)}(o,t);var e,n,r,a=jd(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.data=t.data,e.fileName=e.data.name,e.state={width:t.width,heightTT:t.heightTT,heightSP:t.heightSP},e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{className:"dataColumn",id:"dataColumn_"+this.id,style:{padding:"unset",display:"table-cell"}},i.a.createElement(_d,{id:this.id,data:this.data,width:this.props.width,height:this.props.heightTT}),i.a.createElement(zd,{id:this.id,data:this.data,width:this.props.width,height:this.props.heightSP}))}}])&&Bd(e.prototype,n),r&&Bd(e,r),o}(i.a.Component);function qd(t){return(qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $d(t,e){return($d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xd(t);if(e){var i=Xd(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qd(this,n)}}function Qd(t,e){return!e||"object"!==qd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xd(t){return(Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$d(t,e)}(o,t);var e,n,r,a=Yd(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={data:Ju.getAllData(),width:$(window).width(),heightTT:$(window).height()/2,heightSP:$(window).height()/2},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Ju.on("upload",(function(){t.setState({data:Ju.getAllData(),width:$(window).width()/Ju.getDataNum()})}))}},{key:"collapseSidebar",value:function(){$("#Controllers").toggle("slow")}},{key:"collapseFeature",value:function(){$("#Feature").toggle("slow")}},{key:"render",value:function(){var t=this.state.data,e=this.state.width,n=this.state.heightTT,r=this.state.heightSP,a=Ju.getDataNum();if(a>0){e=a<=3?window.innerWidth/a:Math.ceil(window.innerWidth/3);var o=$(window).height()-$("#appHeader").outerHeight()-$("#tubeControllers").outerHeight();n=Math.ceil(.6*o)+100,r=o-n}var s=t.map((function(t){return i.a.createElement(Gd,{key:t.id,id:t.id,data:t.data,width:e,heightTT:n,heightSP:r})}));return i.a.createElement("div",{className:"contents",id:"mainVisArea"},i.a.createElement(Kh,null),i.a.createElement("div",{id:"dataColumns",className:"container",style:{display:"inline-block",maxWidth:"100%",width:"100vw",padding:"unset",overflowX:"scroll",overflowY:"hidden"}},i.a.createElement("div",{style:{margin:"unset"}},s)))}}])&&Wd(e.prototype,n),r&&Wd(e,r),o}(i.a.Component);function Jd(t){return(Jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tf(t,e){return(tf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ef(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=rf(t);if(e){var i=rf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nf(this,n)}}function nf(t,e){return!e||"object"!==Jd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var af=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tf(t,e)}(o,t);var e,n,r,a=ef(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).sourceId=t.sourceId,e.selectedPeriod=Rh.getSelectedPeriod(),e.data=Ju.getData(e.sourceId),e.texture=lc.getTexture(),e.segment=lc.getSegment(),e.division=lc.getDivision(),e.activeVar=Rh.getActive(),e.clusterCenter={},e.splinesClusterCenter={},e}return e=o,(n=[{key:"render",value:function(){var t=this;return $("#selectedIntervalViewArea").width(),i.a.createElement("div",{className:"TimeTubes",id:"selectedTimeSliceView",ref:function(e){t.mount=e}},i.a.createElement("div",{className:"overlayHidingPanel"}))}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"componentDidMount",value:function(){var t=this;this.initializeScene(),this.sourceId>=0&&this.selectedPeriod[0]>=0&&this.selectedPeriod[1]>=0&&(this.tube||this.setUpScene(),this.hideClusteringTube(),this.updateTimePeriod(),this.redrawTube()),lc.on("switch",(function(){t.camera&&t.switchCamera()})),Rh.on("switchQueryMode",(function(e){"QBE"!==e&&(t.sourceId=Rh.getSource(),t.activeVar=[],t.tube&&t.deselectAll())})),Rh.on("updateSource",(function(){t.sourceId=Rh.getSource(),t.data=Ju.getData(t.sourceId),t.setUpScene()})),Rh.on("resetSelection",(function(){t.tube&&t.deselectAll()})),Rh.on("updateSelectedPeriod",(function(){t.hideClusteringTube(),t.selectedPeriod=Rh.getSelectedPeriod(),t.updateTimePeriod()})),Rh.on("selectPeriodfromSP",(function(e){t.selectedPeriod=Rh.getSelectedPeriod(),t.hideClusteringTube(),t.selectedPeriod[1]-t.selectedPeriod[0]>0?t.updateTimePeriod():t.tube&&t.deselectAll()})),Rh.on("selectTimeInterval",(function(e,n){t.hideClusteringTube(),t.selectedPeriod=Rh.getSelectedPeriod(),t.updateTimePeriod()})),Rh.on("setActiveVariables",(function(e){t.activeVar=e,t.redrawTube()})),Rh.on("convertResultIntoQuery",(function(e,n,r){if("QBE"===Rh.getMode()){t.sourceId=e,t.selectedPeriod=n,t.activeVar=r,t.data=Ju.getData(t.sourceId),t.tube||t.setUpScene();for(var i=document.getElementById("sourceList"),a=0;a<i.options.length;a++)if(Number(i.options[a].value)===e){i.selectedIndex=a;break}$("#selectedInterval").text("JD: "+n[0].toFixed(3)+" - "+n[1].toFixed(3)),$("#targetLengthMin").val(Math.floor(n[1])-Math.ceil(n[0])),$("#targetLengthMax").val(Math.floor(n[1])-Math.ceil(n[0])),r&&$("input[name=QBEActive]").each((function(t,e){r.indexOf(e.value)<0?e.checked=!1:e.checked=!0})),t.hideClusteringTube(),t.updateTimePeriod(),t.redrawTube()}})),Rh.on("recoverQuery",(function(e){"QBE"===Rh.getMode()&&(t.sourceId=Rh.getSource(),t.selectedPeriod=Rh.getSelectedPeriod(),t.activeVar=Rh.getActive(),t.data=Ju.getData(t.sourceId),t.tube||t.setUpScene(),t.hideClusteringTube(),t.updateTimePeriod(),t.redrawTube())})),Rh.on("convertClusterCenterIntoQuery",(function(e){"QBE"===Rh.getMode()&&(t.clusterCenter=e,t.splinesClusterCenter={},t.computeSplines(e),(new ju.TextureLoader).load("img/1_256.png",function(t){this.textureCluster=t,this.drawClusterCenterTube(e)}.bind(t)))}))}},{key:"componentDidUpdate",value:function(){var t=$("#selectedIntervalViewArea").width(),e=t;this.renderer.setSize(t,e)}},{key:"hideClusteringTube",value:function(){this.tube&&(this.tube.visible=!0),this.tubeCluster&&(this.tubeCluster.visible=!1)}},{key:"initializeScene",value:function(){var t=$("#selectedIntervalViewArea").width(),e=t;this.scene=new ju.Scene,this.setCameras(),this.renderer=new ju.WebGLRenderer,this.renderer.setClearColor("#000000"),this.renderer.setSize(t,e),this.renderer.domElement.id="selectedTimeSliceView",this.mount.appendChild(this.renderer.domElement);var n=new ju.DirectionalLight(16777215,.7);n.position.set(-20,40,60),this.scene.add(n);var r=new ju.AmbientLight(2697513);this.scene.add(r);var i=new ju.AxesHelper(1e3);this.scene.add(i),this.renderScene(),this.start(),this.addControls(),this.sourceId>=0&&this.setPlaceHolder()}},{key:"setUpScene",value:function(){this.updateCameras(),this.setPlaceHolder(),this.renderScene(),this.start(),this.addControls()}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.renderer&&this.renderer.render(this.scene,this.camera)}},{key:"setCameras",value:function(){var t;t=this.sourceId>=0?lc.getCameraProp(this.sourceId):lc.getDefaultCameraProp(),this.cameraSet={},this.cameraSet.perspective=new ju.PerspectiveCamera(t.fov,1,.1,t.far);var e=50*t.depth,n=50*t.depth*1;this.cameraSet.orthographic=new ju.OrthographicCamera(-n/2,n/2,e/2,-e/2,.1,t.far),"Perspective"===t.type?this.camera=this.cameraSet.perspective:this.camera=this.cameraSet.orthographic,this.camera.position.z=50,this.camera.lookAt(-this.scene.position)}},{key:"updateCameras",value:function(){var t;t=this.sourceId>=0?lc.getCameraProp(this.sourceId):lc.getDefaultCameraProp(),this.cameraSet.perspective.fov=t.fov,this.cameraSet.perspective.far=t.far;var e=50*t.depth,n=50*t.depth*1;this.cameraSet.orthographic.left=-n/2,this.cameraSet.orthographic.right=n/2,this.cameraSet.orthographic.top=e/2,this.cameraSet.orthographic.bottom=-e/2,this.cameraSet.orthographic.far=t.far,"Perspective"===t.type?this.camera=this.cameraSet.perspective:this.camera=this.cameraSet.orthographic,this.camera.position.z=50,this.camera.lookAt(-this.scene.position)}},{key:"setPlaceHolder",value:function(){if(void 0===this.tube){var t=lc.getTexture(this.sourceId),e=new Float32Array(0),n=new Float32Array(0),r=new Float32Array(0),i=new Float32Array(0),a=new Uint32Array(0),o=new ju.BufferGeometry;o.setAttribute("position",new ju.BufferAttribute(new Float32Array(e),3)),o.setAttribute("normal",new ju.BufferAttribute(r,3)),o.setAttribute("colorData",new ju.BufferAttribute(new Float32Array(n),2)),o.setAttribute("selected",new ju.BufferAttribute(new Float32Array(i),1)),o.setIndex(new ju.BufferAttribute(new Uint32Array(a),1)),o.computeVertexNormals();var s=new ju.ShaderMaterial({vertexShader:document.getElementById("vertexShader_tube").textContent,fragmentShader:document.getElementById("fragmentShader_tube").textContent,uniforms:{lightPosition:{value:new ju.Vector3(-20,40,60)},tubeNum:{value:1},shade:{value:!1},texture:{value:t},minmaxH:{value:new ju.Vector2(this.data.data.meta.min.H,this.data.data.meta.max.H)},minmaxV:{value:new ju.Vector2(this.data.data.meta.min.V,this.data.data.meta.max.V)},flagH:{value:!0},flagV:{value:!0}},side:ju.DoubleSide,transparent:!0});this.tube=new ju.Mesh(o,s),this.tube.rotateY(Math.PI),this.scene.add(this.tube)}}},{key:"switchCamera",value:function(){var t=this.camera.position,e=lc.getCameraProp(this.sourceId);"Perspective"===e.type?(this.camera=this.cameraSet.perspective,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)):"Orthographic"===e.type&&(this.camera=this.cameraSet.orthographic,this.camera.position.x=t.x,this.camera.position.y=t.y,this.camera.position.z=t.z,this.camera.lookAt(this.scene.position)),this.addControls()}},{key:"addControls",value:function(){this.controls=new zh.a(this.camera,this.renderer.domElement),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"drawSelectedTube",value:function(t,e,n){this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.normal.needsUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0,this.tube.geometry.index.needsUpdate=!0,this.tube.geometry.attributes.position=new ju.BufferAttribute(new Float32Array(t),3),this.tube.geometry.attributes.colorData=new ju.BufferAttribute(new Float32Array(e),3),this.tube.geometry.attributes.selected=new ju.BufferAttribute(new Float32Array(t.length/3),1),this.tube.geometry.attributes.normal=new ju.BufferAttribute(new Float32Array(t.length),1),this.tube.geometry.index=new ju.BufferAttribute(new Uint32Array(n),1),this.tube.geometry.computeVertexNormals(),this.redrawTube(),this.renderer.render(this.scene,this.camera)}},{key:"deselectAll",value:function(){this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.normal.needsUpdate=!0,this.tube.geometry.attributes.colorData.needsUpdate=!0,this.tube.geometry.attributes.selected.needsUpdate=!0,this.tube.geometry.index.needsUpdate=!0,this.tube.geometry.attributes.position=new ju.BufferAttribute(new Float32Array(0),3),this.tube.geometry.attributes.colorData=new ju.BufferAttribute(new Float32Array(0),2),this.tube.geometry.attributes.selected=new ju.BufferAttribute(new Float32Array(0),1),this.tube.geometry.attributes.normal=new ju.BufferAttribute(new Float32Array(0),1),this.tube.geometry.index=new ju.BufferAttribute(new Uint32Array(0),1),this.tube.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}},{key:"extractTubeAttributes",value:function(){for(var t=Rh.getTubeAttributes(Number(this.sourceId)),e=Math.ceil(this.selectedPeriod[0]-this.data.data.meta.min.z)*this.division*this.segment,n=Math.ceil(this.selectedPeriod[1]-this.data.data.meta.min.z)*this.division*this.segment,r=t.position.slice(3*e,3*n),i=t.color.slice(3*e,3*n),a=r[2],o=0;o<r.length/3;o++)r[3*o+2]-=a,i[3*o+2]=1;return{pos:r,col:i,indices:t.indices.slice(0,((n-e)/this.segment-1)*(this.segment-1)*3*2)}}},{key:"updateTimePeriod",value:function(){var t=this.extractTubeAttributes();this.drawSelectedTube(t.pos,t.col,t.indices)}},{key:"redrawTube",value:function(){if(this.tube&&this.tube.visible){var t,e=this.activeVar.indexOf("x")>=0,n=this.activeVar.indexOf("y")>=0,r=this.activeVar.indexOf("r_x")>=0,i=this.activeVar.indexOf("r_y")>=0,a=this.activeVar.indexOf("H")>=0,o=this.activeVar.indexOf("V")>=0,s=this.data.data.meta.min.z,l=this.data.data.meta.max.z,u=this.data.data.meta.range,c=(l-s)/(this.division*Math.ceil(l-s)),h=Math.ceil((this.data.data.splines.position.getPoint(1).z-this.data.data.splines.position.getPoint(0).z)/c),d=this.data.data.splines.position.getSpacedPoints(h),f=this.data.data.splines.radius.getSpacedPoints(h);this.data.data.splines.hue.points.length>0&&(t=Math.ceil((this.data.data.splines.hue.getPoint(1).z-this.data.data.splines.hue.getPoint(0).z)/c),this.data.data.splines.hue.getSpacedPoints(t));for(var p,m,g,v,y,b=Math.ceil((this.data.data.splines.value.getPoint(1).z-this.data.data.splines.value.getPoint(0).z)/c),x=(this.data.data.splines.value.getSpacedPoints(b),2*Math.PI/(this.segment-1)),_=Math.ceil((this.selectedPeriod[0]-s)/c),w=this.tube.geometry.attributes.position.array.length/3/this.segment,S=(Math.ceil((this.selectedPeriod[1]-s)/c),[]),E=_;E<_+w;E++){m=e?d[E].x:0,g=n?d[E].y:0,v=r?f[E].x:1/u,y=i?f[E].y:1/u;for(var M=0;M<this.segment;M++)p=x*M,S.push(-1*(m*u+v*u*Math.cos(p))),S.push(g*u+y*u*Math.sin(p)),S.push(d[E].z-this.selectedPeriod[0])}this.tube.material.uniforms.flagH.value=a,this.tube.material.uniforms.flagV.value=o,this.tube.geometry.attributes.position.needsUpdate=!0,this.tube.geometry.attributes.position=new ju.BufferAttribute(new Float32Array(S),3),this.tube.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}else if(this.tubeCluster&&this.tubeCluster.visible){for(var C,T,k,P,A,O=this.activeVar.indexOf("x")>=0,N=this.activeVar.indexOf("y")>=0,R=this.activeVar.indexOf("r_x")>=0,L=this.activeVar.indexOf("r_y")>=0,I=this.activeVar.indexOf("H")>=0,D=this.activeVar.indexOf("V")>=0,z=this.clusterCenter.values[Object.keys(this.clusterCenter.values)[0]].length,F=this.division*z,B=2*Math.PI/(this.segment-1),V=this.splinesClusterCenter.position.getSpacedPoints(F),j=this.splinesClusterCenter.radius.getSpacedPoints(F),H=[],U=0;U<=F;U++){T=O?V[U].x:0,k=N?V[U].y:0,P=R?j[U].x:1/this.rangeClusterCenter,A=L?j[U].y:1/this.rangeClusterCenter;for(var G=0;G<this.segment;G++)C=B*G,H.push(-1*(T*this.rangeClusterCenter+P*this.rangeClusterCenter*Math.cos(C))),H.push(k*this.rangeClusterCenter+A*this.rangeClusterCenter*Math.sin(C)),H.push(V[U].z)}this.tubeCluster.material.uniforms.flagH.value=I,this.tubeCluster.material.uniforms.flagV.value=D,this.tubeCluster.geometry.attributes.position.needsUpdate=!0,this.tubeCluster.geometry.attributes.position=new ju.BufferAttribute(new Float32Array(H),3),this.tubeCluster.geometry.computeVertexNormals(),this.renderer.render(this.scene,this.camera)}}},{key:"computeSplines",value:function(t){this.minmax={},this.minmax.x=[1/0,-1/0],this.minmax.y=[1/0,-1/0],this.minmax.H=[1/0,-1/0],this.minmax.V=[1/0,-1/0];for(var e=[],n=[],r=[],i=0;i<t.values[Object.keys(t.values)[0]].length;i++){var a={x:"x"in t.values?t.values.x[i]:0,y:"y"in t.values?t.values.y[i]:0,r_x:"r_x"in t.values?t.values.r_x[i]:1,r_y:"r_y"in t.values?t.values.r_y[i]:1,H:"H"in t.values?t.values.H[i]:.5,V:"V"in t.values?t.values.V[i]:.5};for(var o in e.push(new ju.Vector3(a.x,a.y,i)),n.push(new ju.Vector3(a.r_x,a.r_y,i)),r.push(new ju.Vector3(a.H,a.V,i)),this.minmax)a[o]<this.minmax[o][0]&&(this.minmax[o][0]=a[o]),this.minmax[o][1]<a[o]&&(this.minmax[o][1]=a[o])}this.splinesClusterCenter.position=new ju.CatmullRomCurve3(e,!1,"catmullrom"),this.splinesClusterCenter.radius=new ju.CatmullRomCurve3(n,!1,"catmullrom"),this.splinesClusterCenter.color=new ju.CatmullRomCurve3(r,!1,"catmullrom");var s=this.minmax.x[1]-this.minmax.x[0],l=this.minmax.y[1]-this.minmax.y[0],u=Math.round(Math.max(s,l)*Math.pow(10,2-Math.ceil(Math.log10(Math.max(s,l)))));this.rangeClusterCenter=lc.getGridSize()/(5*Math.ceil(u/5)*Math.pow(10,-(2-Math.ceil(Math.log10(Math.max(s,l))))))}},{key:"drawClusterCenterTube",value:function(t){if(this.tube&&(this.tube.visible=!1),this.tubeCluster){var e=this.tubeCluster.geometry,n=this.tubeCluster.material;this.scene.remove(this.tubeCluster),e.dispose(),n.dispose(),this.tubeCluster=void 0}for(var r,i,a=lc.getTextureDefault(),o=Object.keys(t.values),s=t.values[Object.keys(t.values)[0]].length,l=this.division*s,u=2*Math.PI/(this.segment-1),c=[],h=[],d=[],f=this.splinesClusterCenter.position.getSpacedPoints(l),p=this.splinesClusterCenter.radius.getSpacedPoints(l),m=this.splinesClusterCenter.color.getSpacedPoints(l),g=o.indexOf("r_x")>=0,v=o.indexOf("r_y")>=0,y=0;y<=l;y++){r=g?p[y].x:1/this.rangeClusterCenter,i=v?p[y].y:1/this.rangeClusterCenter;for(var b=0;b<this.segment;b++){var x=u*b;c.push(-1*(f[y].x*this.rangeClusterCenter+r*this.rangeClusterCenter*Math.cos(x))),c.push(f[y].y*this.rangeClusterCenter+i*this.rangeClusterCenter*Math.sin(x)),c.push(f[y].z),h.push(m[y].x),h.push(m[y].y),h.push(1),b!==this.segment-1&&(d.push(b+y*this.segment),d.push(b+this.segment+y*this.segment),d.push(b+1+y*this.segment),d.push(b+this.segment+y*this.segment),d.push(b+1+this.segment+y*this.segment),d.push(b+1+y*this.segment))}}d=d.slice(0,-1*this.segment*3*2);var _=new Float32Array(c.length),w=new ju.BufferGeometry;w.setAttribute("position",new ju.BufferAttribute(new Float32Array(c),3)),w.setAttribute("normal",new ju.BufferAttribute(_,3)),w.setAttribute("colorData",new ju.BufferAttribute(new Float32Array(h),3)),w.setIndex(new ju.BufferAttribute(new Uint32Array(d),1)),w.computeVertexNormals();var S=new ju.ShaderMaterial({vertexShader:document.getElementById("vertexShader_tube").textContent,fragmentShader:document.getElementById("fragmentShader_tube").textContent,uniforms:{lightPosition:{value:new ju.Vector3(-20,40,60)},shade:{value:!0},texture:{value:a},minmaxH:{value:new ju.Vector2(this.minmax.H[0],this.minmax.H[1])},minmaxV:{value:new ju.Vector2(this.minmax.V[0],this.minmax.V[1])},flagH:{value:!0},flagV:{value:!0}},side:ju.DoubleSide,transparent:!0}),E=new ju.Mesh(w,S);E.rotateY(Math.PI),this.scene.add(E),this.tubeCluster=E,this.renderer.render(this.scene,this.camera)}}])&&Kd(e.prototype,n),r&&Kd(e,r),o}(i.a.Component);function of(t){return(of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lf(t,e){return(lf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=hf(t);if(e){var i=hf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return cf(this,n)}}function cf(t,e){return!e||"object"!==of(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hf(t){return(hf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var df=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lf(t,e)}(o,t);var e,n,r,a=uf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={dragSelection:!0,source:-1},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Rh.on("recoverQuery",(function(t){if("QBE"===Rh.getMode())for(var e=document.getElementById("sourceList"),n=0;n<e.options.length;n++)if(Number(e.options[n].value)===Number(Rh.getSource())){e.selectedIndex=n;break}})),Rh.on("updateSource",(function(){if(t.state.source!==Rh.getSource()){for(var e=Rh.getSource(),n=document.getElementById("sourceList"),r=0;r<n.options.length;r++)if(Number(n.options[r].value)===Number(e)){n.selectedIndex=r;break}t.setState({source:e})}}))}},{key:"extractionSource",value:function(){var t=Ju.getAllIdsFileNames().map((function(t){return i.a.createElement("option",{value:t.id,key:t.id},t.name)}));return t.unshift(i.a.createElement("option",{value:"default",key:"default"},"Select a source")),i.a.createElement("div",{className:"featureElem"},i.a.createElement("h5",null,"Source"),i.a.createElement("select",{className:"custom-select custom-select-sm",id:"sourceList",style:{width:"40%"},onChange:this.updateSource.bind(this)},t))}},{key:"updateSource",value:function(){var t=document.getElementById("sourceList"),e=t.selectedIndex,n=t.options[e].value;Promise.resolve().then((function(){pu(n)})).then((function(){qc(n)}))}},{key:"render",value:function(){return i.a.createElement("div",{id:"QBEQuerying"},this.extractionSource())}}])&&sf(e.prototype,n),r&&sf(e,r),o}(i.a.Component),ff=n(2),pf=n.n(ff);function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return vf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vf(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bf(t,e){return(bf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wf(t);if(e){var i=wf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _f(this,n)}}function _f(t,e){return!e||"object"!==mf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wf(t){return(wf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Sf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bf(t,e)}(o,t);var e,n,r,a=xf(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=(e=a.call(this)).updateLookup(),r=Rh.getTarget(),i={},s={},l=[],u=[];for(var c in n){l=[],u=[];for(var h=0;h<r.length;h++)l.push(Ju.getData(r[h]).data.meta.min[c]),u.push(Ju.getData(r[h]).data.meta.max[c]);i[c]=l,s[c]=u}return e.state={xItem:t.xItem,yItem:t.yItem,xItemonPanel:t.xItem,yItemonPanel:t.yItem,size:0,lookup:n,selector:"pen",targetList:r,minList:i,maxList:s,detectWidth:!0,assignVariables:!1},e.margin={bottom:20,left:20},e.curveSegment=10,e.sketching=!1,e.touch=!1,e.path=null,e.pathWidth=null,e.penSizeCircle=null,e.radiuses=null,e.segPoints=[],e.pathUpper=null,e.pathLower=null,e.highlightedPoint=null,e.highlightedPointIdx=-1,e.controlPoints=[],e.widthVar=null,e.widthRange=[],e.timeStamps=[],e.selectedIdx=-1,e.selectedHandle=null,e.selectedPoint=null,e.xMinMax=[],e.yMinMax=[],e.queryData={},e.updateQueryFlag=!1,e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;if(this.initCanvas(),this.state.targetList.length>0){var e=this.computeMinMaxValue(this.state.minList,this.state.maxList);this.xMinMax=e.xMinMax,this.yMinMax=e.yMinMax,this.updateAxis(),this.updateWidthVariable()}Rh.on("updateTarget",(function(){var e=Rh.getTarget(),n=t.updateLookup(),r=t.extractMinMaxList(n,e);t.setState({targetList:e,minList:r.minList,maxList:r.maxList,lookup:n})})),Rh.on("switchQueryMode",(function(e){if(t.initCanvas(),"QBS"===e){var n=Rh.getTarget(),r=t.updateLookup(),i=t.extractMinMaxList(r,n);t.setState({targetList:n,minList:i.minList,maxList:i.maxList,lookup:r});var a=t.computeMinMaxValue(i.minList,i.maxList);t.xMinMax=a.xMinMax,t.yMinMax=a.yMinMax,t.xAxisText.text(r[t.state.xItem]),t.yAxisText.text(r[t.state.yItem]),t.updateAxis(),t.updateWidthVariable()}})),Rh.on("convertResultIntoQuery",(function(e,n,r){if("QBS"===Rh.getMode()){t.clearCanvas();var i=Rh.getTarget(),a=t.updateLookup(),o=t.extractMinMaxList(a,i);if(t.queryData={id:e,period:[Math.ceil(n[0]),Math.floor(n[1])],targetData:Ju.getDataArray(e,1)},t.setState({targetList:i,minList:o.minList,maxList:o.maxList,lookup:a}),!t.widthVar){var s=document.getElementById("widthVariables"),l=s.selectedIndex,u=s.options[l].value;t.widthVar=u,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}t.transformDataIntoSketch(t.state.xItem,t.state.yItem)}})),Rh.on("recoverQuery",(function(e){setTimeout(function(){if("QBS"===Rh.getMode()){var t=this.updateLookup();this.initCanvas(),this.clearCanvas(),this.xMinMax=e.query.xRange,this.yMinMax=e.query.yRange,this.updateAxis();for(var n,r,i=Rh.getTarget(),a=this.extractMinMaxList(t,i),o=0;o<e.query.xItem.length;o++)for(var s in t)if(t[s].indexOf(e.query.xItem[o])>=0){n=s;break}for(var l=0;l<e.query.yItem.length;l++)for(var u in t)if(t[u].indexOf(e.query.yItem[l])>=0){r=u;break}if(e.query.widthVar){for(var c=0;c<e.query.widthVar.length;c++)for(var h in t)if(t[h].indexOf(e.query.widthVar[c])>=0){this.widthVar=h;break}this.widthRange=e.query.widthRange,this.changeWidthVariable(this.widthVar,this.widthRange),$("#sketchWidthSlider").slider("option","disabled",!this.state.detectWidth)}this.xAxisText&&this.xAxisText.text(t[n]),this.yAxisText&&this.yAxisText.text(t[r]),$("#periodOfSketchQuery").val(e.query.length),this.recoverQuery(e,t),this.setState({targetList:i,lookup:t,xItem:n,xItemonPanel:n,yItem:r,yItemonPanel:r,detectWidth:!!this.widthVar,minList:a.minList,maxList:a.maxList})}}.bind(t),0)})),Rh.on("convertClusterCenterIntoQuery",(function(e){setTimeout(function(){if("QBS"===Rh.getMode()){this.clearCanvas();var t=Rh.getTarget(),n=this.updateLookup();if(this.extractMinMaxList(n,t),this.queryData={id:"clustering",targetData:e.values,parameters:e.parameters,subsequenceParameters:e.subsequenceParameters},!this.widthVar){var r=document.getElementById("widthVariables"),i=r.selectedIndex,a=r.options[i].value;this.widthVar=a,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}this.transformDataIntoSketch(this.state.xItem,this.state.yItem),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}.bind(t))}))}},{key:"updateLookup",value:function(){var t=[];Ju.getAllData().forEach((function(e){t.push(e.data.lookup)}));var e={};return t.forEach((function(t){var n=function(n){e[n]?t[n].forEach((function(t){e[n].indexOf(t)<0&&e[n].push(t)})):e[n]=t[n]};for(var r in t)n(r)})),e}},{key:"extractMinMaxList",value:function(t,e){var n={},r={},i=[],a=[];for(var o in t){i=[],a=[];for(var s=0;s<e.length;s++)i.push(Ju.getData(e[s]).data.meta.min[o]),a.push(Ju.getData(e[s]).data.meta.max[o]);n[o]=i,r[o]=a}return{minList:n,maxList:r}}},{key:"computeMinMaxValue",value:function(t,e){var n=Math.min.apply(null,t[this.state.xItem]),r=Math.max.apply(null,e[this.state.xItem]),i=Math.min.apply(null,t[this.state.yItem]),a=Math.max.apply(null,e[this.state.yItem]);return"z"===this.state.xItem&&(r=Math.min(r-n,50),n=0),"z"===this.state.yItem&&(a=Math.min(a-i,50),i=0),{xMinMax:[n,r],yMinMax:[i,a]}}},{key:"initCanvas",value:function(){var t=Number($("#featureArea").css("padding-left").replace("px","")),e=Number($("#featureArea").css("padding-right").replace("px","")),n=Math.floor(.3*$("#mainFeatureArea").width()-t-e);this.setState({size:n});var r=se("#QBSCanvasArea").style("position","relative").style("padding-bottom",n+"px");se("#QBSSketchPadSVG").remove(),this.svg=r.append("svg").attr("id","QBSSketchPadSVG").attr("width",n).attr("height",n).style("position","absolute"),se("#QBSSketchPad").remove(),this.canvas=r.append("canvas").attr("width",n+"px !important").attr("height",n+"px !important").attr("id","QBSSketchPad").style("position","absolute").style("border","1px solid lightgray"),pf.a.setup(this.canvas.node()),this.svg.select("g.x_axis").remove(),this.xAxis=this.svg.append("g").attr("class","x_axis"),se("#sketchPadXLabel").remove(),this.xAxisText=r.append("text").attr("class","axisLabel").attr("id","sketchPadXLabel").attr("fill","black").attr("text-anchor","middle").style("font-size","0.7rem").style("position","absolute").style("background-color","white").style("left",n/2+"px").style("top",n-18+"px").text(this.state.lookup[this.state.xItem]).on("click",this.CanvasXLabelOnClick().bind(this)),this.xScale=Na(),this.svg.select("g.y_axis").remove(),this.yAxis=this.svg.append("g").attr("class","y_axis"),se("#sketchPadYLabel").remove(),this.yAxisText=r.append("text").attr("class","axisLabel").attr("id","sketchPadYLabel").attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle").style("font-size","0.7rem").style("position","absolute").style("background-color","white").style("left",this.margin.left/2+"px").style("top",n/2+"px").text(this.state.lookup[this.state.yItem]).on("click",this.CanvasYLabelOnClick().bind(this)),this.yScale=Na(),this.tool=new pf.a.Tool,this.tool.minDistance=15,this.tool.onMouseDown=this.CanvasOnMouseDown().bind(this),this.tool.onMouseDrag=this.CanvasOnMouseDrag().bind(this),this.tool.onMouseUp=this.CanvasOnMouseUp().bind(this),document.getElementById("QBSSketchPad").addEventListener("touchmove",this.CanvasOnTouchMove().bind(this)),pf.a.view.onFrame=this.CanvasOnFrame().bind(this),$("#periodOfSketchQuery").val(20)}},{key:"CanvasOnFrame",value:function(){return function(t){if(this.sketching&&!this.touch&&this.penSizeCircle){var e=this.penSizeCircle.position,n=Date.now()-this.timeStamps[this.timeStamps.length-1],r=Math.min(n/1e3*30+2.5,100);this.penSizeCircle.remove(),this.penSizeCircle=new pf.a.Path.Circle(e,r),this.penSizeCircle.strokeColor="#325D88"}}}},{key:"clearCanvas",value:function(){this.path&&(this.path.remove(),this.path=null),this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.penSizeCircle&&(this.penSizeCircle.remove(),this.penSizeCircle=null),this.highlightedPoint&&this.highlightedPoint.remove();for(var t=0;t<this.controlPoints.length;t++)this.controlPoints[t].label&&(this.controlPoints[t].label.remove(),this.controlPoints[t].label=null,this.controlPoints[t].labelRect.remove(),this.controlPoints[t].labelRect=null);this.controlPoints=[],this.timeStamps=[],this.radiuses=[],this.queryData={},this.pathUpper=null,this.pathLower=null,this.segPoints=[]}},{key:"CanvasOnTouchMove",value:function(){return function(t){if(this.sketching&&this.touch&&this.penSizeCircle){var e=this.penSizeCircle.position,n=97.5*t.touches[0].force+2.5;this.penSizeCircle.remove(),this.penSizeCircle=new pf.a.Path.Circle(e,n),this.penSizeCircle.strokeColor="#325D88"}}}},{key:"CanvasOnMouseDown",value:function(){return function(t){var e;if(this.state.assignVariables){if(e=null,e=this.path.hitTest(t.point,{segments:!0,tolerance:5})){this.highlightedPointIdx=e.segment.index,this.highlightedPoint&&this.highlightedPoint.remove(),this.highlightedPoint=new pf.a.Path.Circle({center:e.point,radius:5,fillColor:"#d23430"});var n=$("#controlPointPopover");n.css("display","block");var r,i=$("#controlPointPopoverArrow"),a=n.outerWidth()+8,o=n.outerHeight()+8,s=null,l={},u=this.state.size-e.point.x,c=e.point.x,h=e.point.y,d=this.state.size-e.point.y;for(var f in u>=a?(s="right",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),r={x:e.point.x,y:e.point.y-o/2},l={top:o/2-16+"px"}):c>=a?(s="left",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),r={x:e.point.x-a,y:e.point.y-o/2},l={top:o/2-16+"px"}):h>=o?(s="top",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),r={x:e.point.x-a/2,y:e.point.y-o},l={left:a/2-16+"px"}):d>=o&&(s="bottom",n.attr("class","popover bs-popover-"+s),a=n.outerWidth(!0),o=n.outerHeight(!0),r={x:e.point.x-a/2,y:e.point.y},l={left:a/2-16+"px"}),r.x<0?(r.x=0,l={left:e.point.x-16+"px"}):r.x>this.state.size-a&&(r.x=this.state.size-a,l={left:this.state.size-e.point.x-16+"px"}),r.y<0?(r.y=0,l={top:e.point.y-16+"px"}):r.y>this.state.size-o&&(r.y=this.state.size-o,l={top:o-(this.state.size-e.point.y)-16+"px"}),n.css({left:r.x+"px",top:r.y+"px"}),i.css({top:"",left:""}),i.css(l),this.controlPoints[this.highlightedPointIdx].assignedVariables)if(this.controlPoints[this.highlightedPointIdx].assignedVariables[f].length<=0)if(f===this.state.xItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd(this.xScale.invert(this.controlPoints[this.highlightedPointIdx].position.x)));else if(f===this.state.yItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd(this.yScale.invert(this.controlPoints[this.highlightedPointIdx].position.y)));else if(f!==this.widthVar)$("#valueAssignmentCheckbox_"+f).prop("checked",!1),$("#valueAssignmentCheckbox_"+f).prop("disabled",!1),$("#slider_"+f).css("display","block"),$("#slider_"+f).slider("option","values",[0,100]),$("#slider_"+f).slider("option","disabled",!0),$("#widthValue_"+f).css("display","none");else{$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none");var m=gf(p(this.controlPoints,(function(t){return t.radius})),2),g=m[0],v=m[1];Math.min.apply(null,this.state.minList[f]),Math.max.apply(null,this.state.maxList[f]),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd((this.widthRange[1]-this.widthRange[0])/(v-g)*(this.controlPoints[this.highlightedPointIdx].radius-g)+this.widthRange[0]))}else if(f===this.state.xItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd(this.xScale.invert(this.controlPoints[this.highlightedPointIdx].position.x)));else if(f===this.state.yItem)$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none"),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd(this.yScale.invert(this.controlPoints[this.highlightedPointIdx].position.y)));else if(f!==this.widthVar){$("#valueAssignmentCheckbox_"+f).prop("checked",!0),$("#valueAssignmentCheckbox_"+f).prop("disabled",!1);var y=Math.min.apply(null,this.state.minList[f]),b=Math.max.apply(null,this.state.maxList[f]);$("#slider_"+f).slider("option","values",[(this.controlPoints[this.highlightedPointIdx].assignedVariables[f][0]-y)/(b-y)*100,(this.controlPoints[this.highlightedPointIdx].assignedVariables[f][1]-y)/(b-y)*100]),$("#slider_"+f).slider("option","disabled",!1)}else{$("#valueAssignmentCheckbox_"+f).prop("disabled",!0),$("#slider_"+f).css("display","none");var x=gf(p(this.controlPoints,(function(t){return t.radius})),2),_=x[0],w=x[1];Math.min.apply(null,this.state.minList[f]),Math.max.apply(null,this.state.maxList[f]),$("#widthValue_"+f).css("display","block"),$("#widthValue_"+f).text(Sd((this.widthRange[1]-this.widthRange[0])/(w-_)*(this.controlPoints[this.highlightedPointIdx].radius-_)+this.widthRange[0]))}}}else{var S=t.event.type;switch(this.state.selector){case"pen":this.sketching=!0,"touchstart"===S&&(this.touch=!0),this.clearCanvas(),this.state.detectWidth&&(this.radiuses.push(0),this.pathWidth=new pf.a.Path({segments:[t.point],strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5}),this.penSizeCircle=new pf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88",this.timeStamps.push(Date.now())),this.path=new pf.a.Path({segments:[t.point],strokeColor:"black",strokeWidth:5});break;case"addPoint":if(e=null,e=this.path.hitTest(t.point,{fill:!0,stroke:!0,tolerance:5})){var E=e.location.curve,M=E.length;for(var C in this.path.insert(E.segment2.index,e.point),this.controlPoints.splice(E.segment2.index,0,{position:{x:e.point.x,y:e.point.x},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[E.segment2.index].assignedVariables[C]=[];this.path.getOffsetOf(e.point);for(var T=0;T<E.segment1.index;T++)this.path.curves[T].length;if(this.state.detectWidth){var k=this.controlPoints[E.segment1.index].radius,P=(this.controlPoints[E.segment2.index+1].radius-k)*E.length/M+k;this.controlPoints[E.segment2.index].radius=P,this.drawPathWidth()}}break;case"eraser":if(e=null,e=this.path.hitTest(t.point,{segments:!0,tolerance:5})){var A=e.segment.index;this.path.removeSegment(A),this.controlPoints.splice(A,1),this.state.detectWidth&&this.drawPathWidth()}break;case"controlPoint":this.tool.minDistance=1,this.selectedIdx=-1,this.selectedHandle=null,this.selectedPoint=null,e=null,(e=this.path.hitTest(t.point,{handles:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,"handle-in"===e.type?this.selectedHandle=e.segment.handleIn:"handle-out"===e.type&&(this.selectedHandle=e.segment.handleOut)),null==this.selectedHandle&&(e=this.path.hitTest(t.point,{segments:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,this.selectedPoint=e.segment);break;case"changeWidth":this.state.detectWidth&&(this.tool.minDistance=1,this.selectedIdx=-1,this.selectedPoint=null,e=null,(e=this.path.hitTest(t.point,{segments:!0,tolerance:5}))&&(this.selectedIdx=e.segment.index,this.selectedPoint=e.segment))}}}}},{key:"CanvasOnMouseDrag",value:function(){return function(t){var e=t.event.type;if(!this.state.assignVariables)switch(this.state.selector){case"pen":if(this.path.add(t.point),this.state.detectWidth)if("mousemove"===e){var n=Date.now(),r=n-this.timeStamps[this.timeStamps.length-1];this.timeStamps.push(n);var i=Math.min(r/1e3*30+2.5,100),a=t.delta.x,o=t.delta.y,s=Math.sqrt(a*a+o*o),l=t.delta;l.angle+=90;var u={x:t.middlePoint.x+i/s*l.x,y:t.middlePoint.y+i/s*l.y},c={x:t.middlePoint.x-i/s*l.x,y:t.middlePoint.y-i/s*l.y};this.pathWidth.add(u),this.pathWidth.insert(0,c),this.pathWidth.smooth(),this.radiuses.push(i),this.penSizeCircle.remove(),this.penSizeCircle=new pf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88"}else if("touchmove"===e&&t.event.touches.length>0){var h=97.5*t.event.touches[0].force+2.5,d=t.delta.x,f=t.delta.y,p=Math.sqrt(d*d+f*f),m=t.delta;m.angle+=90;var g={x:t.middlePoint.x+h/p*m.x,y:t.middlePoint.y+h/p*m.y},v={x:t.middlePoint.x-h/p*m.x,y:t.middlePoint.y-h/p*m.y};this.pathWidth.add(g),this.pathWidth.insert(0,v),this.pathWidth.smooth(),this.radiuses.push(h),this.penSizeCircle.remove(),this.penSizeCircle=new pf.a.Path.Circle(t.point,2.5),this.penSizeCircle.strokeColor="#325D88"}break;case"controlPoint":if(this.selectedIdx>=0&&(this.selectedHandle&&(this.selectedHandle.x+=t.delta.x,this.selectedHandle.y+=t.delta.y),this.selectedPoint&&(this.selectedPoint.point.x+=t.delta.x,this.selectedPoint.point.y+=t.delta.y,this.controlPoints[this.selectedIdx].position={x:this.selectedPoint.point.x+t.delta.x,y:this.selectedPoint.point.y+t.delta.y}),null!==this.controlPoints[this.selectedIdx].label&&(this.controlPoints[this.selectedIdx].label.position=new pf.a.Point(this.controlPoints[this.selectedIdx].position.x,this.controlPoints[this.selectedIdx].position.y-10),this.controlPoints[this.selectedIdx].labelRect.position=this.controlPoints[this.selectedIdx].label.bounds)),this.state.detectWidth){if(this.selectedIdx>0&&this.selectedIdx<this.path.segments.length-1){for(var y=0,b=0;b<this.selectedIdx-1;b++)y+=this.path.curves[b].length;for(var x=this.controlPoints[this.selectedIdx-1].radius,_=this.controlPoints[this.selectedIdx].radius,w=this.controlPoints[this.selectedIdx+1].radius,S=this.path.curves[this.selectedIdx-1].length,E=1;E<this.curveSegment;E++){var M=(_-x)*E/this.curveSegment+x,C=this.path.getPointAt(y+S/this.curveSegment*E),T=void 0,k=(this.selectedIdx-1)*this.curveSegment+E,P=this.segPoints[k-1];T=new pf.a.Point(C.x-P.x,C.y-P.y);var A=Math.sqrt(T.x*T.x+T.y*T.y);T.angle+=90,this.segPoints[k]=C,this.pathUpper[k]={x:C.x+M/A*T.x,y:C.y+M/A*T.y},this.pathLower[k]={x:C.x-M/A*T.x,y:C.y-M/A*T.y}}y+=S,S=this.path.curves[this.selectedIdx].length;for(var O=0;O<this.curveSegment;O++){var N=(w-_)*O/this.curveSegment+_,R=this.path.getPointAt(y+S/this.curveSegment*O),L=void 0,I=this.selectedIdx*this.curveSegment+O,D=this.segPoints[I-1];L=new pf.a.Point(R.x-D.x,R.y-D.y);var z=Math.sqrt(L.x*L.x+L.y*L.y);L.angle+=90,this.segPoints[I]=R,this.pathUpper[I]={x:R.x+N/z*L.x,y:R.y+N/z*L.y},this.pathLower[I]={x:R.x-N/z*L.x,y:R.y-N/z*L.y}}}else if(0===this.selectedIdx)for(var F=this.controlPoints[0].radius,B=this.controlPoints[1].radius,V=this.path.curves[0].length,j=0;j<this.curveSegment;j++){var H=(B-F)*j/this.curveSegment+F,U=this.path.getPointAt(V/this.curveSegment*j),G=void 0;if(0===j)G=new pf.a.Point(this.path.segments[0].handleOut.x,this.path.segments[0].handleOut.y);else{var q=this.segPoints[j-1];G=new pf.a.Point(U.x-q.x,U.y-q.y)}var W=Math.sqrt(G.x*G.x+G.y*G.y);G.angle+=90,this.segPoints[j]=U,this.pathUpper[j]={x:U.x+H/W*G.x,y:U.y+H/W*G.y},this.pathLower[j]={x:U.x-H/W*G.x,y:U.y-H/W*G.y}}else if(this.selectedIdx===this.path.segments.length-1){for(var $=0,Y=0;Y<this.selectedIdx-1;Y++)$+=this.path.curves[Y].length;for(var Q=this.controlPoints[this.selectedIdx-1].radius,X=this.controlPoints[this.selectedIdx].radius,Z=this.path.curves[this.selectedIdx-1].length,J=1;J<=this.curveSegment;J++){var K=(X-Q)*J/this.curveSegment+Q,tt=void 0;tt=J!==this.curveSegment?this.path.getPointAt($+Z/this.curveSegment*J):this.path.segments[this.path.segments.length-1].point;var et=void 0,nt=(this.selectedIdx-1)*this.curveSegment+J,rt=this.segPoints[nt-1];et=new pf.a.Point(tt.x-rt.x,tt.y-rt.y);var it=Math.sqrt(et.x*et.x+et.y*et.y);et.angle+=90,this.segPoints[nt]=tt,this.pathUpper[nt]={x:tt.x+K/it*et.x,y:tt.y+K/it*et.y},this.pathLower[nt]={x:tt.x-K/it*et.x,y:tt.y-K/it*et.y}}}var at=this.pathLower.slice().reverse(),ot=this.pathUpper.concat(at);this.pathWidth.remove(),this.pathWidth=null,this.pathWidth=new pf.a.Path({segments:ot,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5,closed:!0}),this.pathWidth.smooth(),this.pathWidth.sendToBack()}break;case"changeWidth":if(this.state.detectWidth&&this.selectedPoint){var st=t.point.x-this.selectedPoint.point.x,lt=t.point.y-this.selectedPoint.point.y,ut=Math.sqrt(st*st+lt*lt);this.penSizeCircle&&this.penSizeCircle.remove(),this.penSizeCircle=new pf.a.Path.Circle(this.selectedPoint.point,ut),this.penSizeCircle.strokeColor="#325D88"}}}}},{key:"CanvasOnMouseUp",value:function(){return function(t){var e=t.event.type;if(!this.state.assignVariables){switch(this.state.selector){case"pen":this.path.add(t.point);var n=this.path.segments.slice(0,this.path.segments.length);if(n[n.length-2].point.x,n[n.length-1].point.x,this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.state.detectWidth){var r=0;if("mouseup"===e){var i=Date.now(),a=i-this.timeStamps[this.timeStamps.length-1];this.timeStamps.push(i),r=Math.min(a/1e3*30+2.5,100)}else"touchend"===e&&t.event.touches.length>0&&(r=97.5*t.event.touches[0].force+2.5);this.radiuses.push(r);var o=n.length/this.path.segments.length;o=Math.floor(o)%2==1?Math.floor(o):Math.ceil(o);for(var s=0,l=0;s<n.length&&l<this.path.segments.length;)if(n[s].point.x!==this.path.segments[l].point.x||n[s].point.y!==this.path.segments[l].point.y)s++;else{var u=0,c=0,h=s-Math.floor(o/2),d=s+Math.floor(o/2);h=Math.max(0,h),d=Math.min(n.length-1,d);for(var f=h;f<=d;f++)u+=this.radiuses[f],c++;u/=c,this.controlPoints[l].radius=u,s++,l++}this.radiuses=[],this.drawPathWidth(),this.penSizeCircle.remove()}this.penSizeCircle=null,this.sketching=!1,this.touch=!1,this.touchPressure=0;break;case"controlPoint":this.selectedHandle=null,this.selectedPoint=null;break;case"changeWidth":if(this.state.detectWidth&&this.penSizeCircle&&this.selectedPoint){var p=this.penSizeCircle.segments[0].point.x-this.selectedPoint.point.x,m=this.penSizeCircle.segments[0].point.y-this.selectedPoint.point.y,g=Math.sqrt(p*p+m*m);this.controlPoints[this.selectedIdx].radius=g,this.selectedHandle=null,this.selectedPoint=null,this.selectedIdx=-1,this.drawPathWidth(),this.penSizeCircle.remove()}}this.tool.minDistance=15}this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"drawPathWidth",value:function(){if(this.path.curves.length>0){this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.segPoints=[];for(var t=[],e=[],n=0,r=0;r<this.path.curves.length;r++){for(var i=this.controlPoints[r].radius,a=this.controlPoints[r+1].radius,o=this.path.curves[r].length,s=0;s<this.curveSegment;s++){var l=(a-i)*s/this.curveSegment+i,u=this.path.getPointAt(n+o/this.curveSegment*s),c=void 0;if(0===s&&0!==this.path.segments[r].handleOut.x&&0!==this.path.segments[r].handleOut.y)c=new pf.a.Point(this.path.segments[r].handleOut.x,this.path.segments[r].handleOut.y);else{var h=this.segPoints[this.segPoints.length-1];c=new pf.a.Point(u.x-h.x,u.y-h.y)}var d=Math.sqrt(c.x*c.x+c.y*c.y);c.angle+=90,this.segPoints.push(u),t.push({x:u.x+l/d*c.x,y:u.y+l/d*c.y}),e.push({x:u.x-l/d*c.x,y:u.y-l/d*c.y})}n+=o}var f=this.controlPoints[this.controlPoints.length-1].radius,p=this.path.segments[this.path.segments.length-1].point,m=this.segPoints[this.segPoints.length-1],g=new pf.a.Point(p.x-m.x,p.y-m.y),v=Math.sqrt(g.x*g.x+g.y*g.y);g.angle+=90,this.segPoints.push(p),t.push({x:p.x+f/v*g.x,y:p.y+f/v*g.y}),e.push({x:p.x-f/v*g.x,y:p.y-f/v*g.y}),this.pathUpper=t,this.pathLower=e;var y=e.slice().reverse(),b=t.concat(y);this.pathWidth=new pf.a.Path({segments:b,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5,closed:!0}),this.pathWidth.smooth(),this.pathWidth.sendToBack()}}},{key:"convertSketchIntoQuery",value:function(t,e){if(this.state.targetList.length>0&&this.path&&this.path.curves.length>0){var n={};for(var r in this.state.lookup)"z"!==r&&(n[r]=[]);if("z"!==t&&"z"!==e){var i=this.path.length,a=$("#periodOfSketchQuery").val();if(""!==a){var o,s=i/(a=Number(a)),l=this.path.curves[0].length,u=0,c=0,h=[],d=[];if(this.widthVar){var f=gf(p(this.controlPoints,(function(t){return t.radius})),2);h=[f[0],f[1]],d=this.widthRange}for(var m in n)this.controlPoints[0].assignedVariables[m].length>0&&n[m].push(this.controlPoints[0].assignedVariables[m]);o=this.controlPoints[0].position;for(var g=0;g<=a;g++){var v=this.path.getPointAt(s*g);if(v){for(var y in n)if(y===t)n[y].push(this.xScale.invert(v.x));else if(y===e)n[y].push(this.yScale.invert(v.y));else if(y===this.widthVar){var b=(this.controlPoints[u+1].radius-this.controlPoints[u].radius)*(s*g-c)/l+this.controlPoints[u].radius;n[y].push((d[1]-d[0])/(h[1]-h[0])*(b-h[0])+d[0])}else n[y].push(null);if(c+l<=s*g){var x=this.controlPoints[u+1].position,_=this.controlPoints[u+1].assignedVariables;if(Math.sqrt(Math.pow(x.x-o.x,2)+Math.pow(x.y-o.y,2))<=Math.sqrt(Math.pow(x.x-v.x,2)+Math.pow(x.y-v.y,2)))for(var w in n)_[w].length>0&&(n[w][n[w].length-2]=_[w]);else for(var S in n)_[S].length>0&&(n[S][n[S].length-1]=_[S]);c+=l,(u+=1)<this.path.curves.length&&(l=this.path.curves[u].length)}o=v}}var E=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var M in E)E[M].length>0&&(n[M][n[M].length-1]=E[M])}}else if("z"===t){var C=this.controlPoints[0].position.x,T=this.controlPoints[this.controlPoints.length-1].position.x,k=this.xScale.invert(T-C);$("#periodOfSketchQuery").val(Sd(k)),$("#targetLengthMin").val(Math.floor(k)),$("#targetLengthMax").val(Math.ceil(k));var P,A=this.path.curves[0].length,O=0,N=0,R=[],L=[];if(this.widthVar){var I=gf(p(this.controlPoints,(function(t){return t.radius})),2),D=I[0],z=I[1];Math.min.apply(null,this.state.minList[this.widthVar]),Math.max.apply(null,this.state.maxList[this.widthVar]),R=[D,z],L=this.widthRange}var F=this.xScale(1),B=new pf.a.Path.Line(new pf.a.Point(C,0),new pf.a.Point(C,this.state.size)),V=C;for(P=this.controlPoints[0].position;V<=T;){var j=this.path.getIntersections(B);if(j.length>0){var H=this.path.getOffsetOf(j[0].point);for(var U in n)if(U===this.state.yItem)n[U].push(this.yScale.invert(j[0].point.y));else if(U===this.widthVar){var G=(this.controlPoints[O+1].radius-this.controlPoints[O].radius)*(H-N)/A+this.controlPoints[O].radius;n[U].push((L[1]-L[0])/(R[1]-R[0])*(G-R[0])+L[0])}else"z"!==U&&n[U].push(null);if(N+A<=H){var q=this.controlPoints[O+1].position,W=this.controlPoints[O+1].assignedVariables;if(Math.sqrt(Math.pow(q.x-P.x,2)+Math.pow(q.y-P.y,2))<=Math.sqrt(Math.pow(q.x-j[0].point.x,2)+Math.pow(q.y-j[0].point.y,2)))for(var Y in n)W[Y].length>0&&(n[Y][n[Y].length-2]=W[Y]);else for(var Q in n)W[Q].length>0&&(n[Q][n[Q].length-1]=W[Q]);N+=A,(O+=1)<this.path.curves.length&&(A=this.path.curves[O].length)}}V+=F,B.segments[0].point.x=V,B.segments[1].point.x=V}B.remove();var X=this.controlPoints[0].assignedVariables;for(var Z in n)X[Z].length>0&&(n[Z][0]=X[Z]);var J=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var K in J)J[K].length>0&&(n[K][n[K].length-1]=J[K])}else if("z"===e){var tt=this.controlPoints[0].position.y,et=this.controlPoints[this.controlPoints.length-1].position.y,nt=this.yScale.invert(et-tt);$("#periodOfSketchQuery").val(Sd(nt));var rt,it=this.path.curves[0].length,at=0,ot=0,st=[],lt=[];if(this.widthVar){var ut=gf(p(this.controlPoints,(function(t){return t.radius})),2),ct=ut[0],ht=ut[1];Math.min.apply(null,this.state.minList[this.widthVar]),Math.max.apply(null,this.state.maxList[this.widthVar]),st=[ct,ht],lt=this.widthRange}var dt=this.state.size-this.yScale(1),ft=new pf.a.Path.Line(new pf.a.Point(0,tt),new pf.a.Point(this.state.size,tt)),pt=tt;for(rt=this.controlPoints[0].position;pt>=et;){var mt=this.path.getIntersections(ft),gt=this.path.getOffsetOf(mt[0].point);for(var vt in n)if(vt===t)n[vt].push(this.xScale.invert(mt[0].point.x));else if(vt===this.widthVar){var yt=(this.controlPoints[at+1].radius-this.controlPoints[at].radius)*(gt-ot)/it+this.controlPoints[at].radius;n[vt].push((lt[1]-lt[0])/(st[1]-st[0])*(yt-st[0])+lt[0])}else"z"!==vt&&n[vt].push(null);if(ot+it<=gt){var bt=this.controlPoints[at+1].position,xt=this.controlPoints[at+1].assignedVariables;if(Math.sqrt(Math.pow(bt.x-rt.x,2)+Math.pow(bt.y-rt.y,2))<=Math.sqrt(Math.pow(bt.x-mt[0].point.x,2)+Math.pow(bt.y-mt[0].point.y,2)))for(var _t in n)xt[_t].length>0&&(n[_t][n[_t].length-2]=xt[_t]);else for(var wt in n)xt[wt].length>0&&(n[wt][n[wt].length-1]=xt[wt]);ot+=it,(at+=1)<this.path.curves.length&&(it=this.path.curves[at].length)}pt-=dt,ft.segments[0].point.y=pt,ft.segments[1].point.y=pt}ft.remove();var St=this.controlPoints[0].assignedVariables;for(var Et in n)St[Et].length>0&&(n[Et][0]=St[Et]);var Mt=this.controlPoints[this.controlPoints.length-1].assignedVariables;for(var Ct in Mt)Mt[Ct].length>0&&(n[Ct][n[Ct].length-1]=Mt[Ct])}n.arrayLength=n[Object.keys(n)[0]].length,function(t){hu.dispatch({type:"SET_QUERY",query:t})}({mode:"visual query",option:"query-by-sketch",query:{xItem:this.state.lookup[t],yItem:this.state.lookup[e],xRange:this.xScale.domain(),yRange:this.yScale.domain(),widthVar:this.state.lookup[this.widthVar],widthRange:this.widthRange,controlPoints:this.controlPoints,path:this.path.segments,size:this.state.size,length:n.arrayLength},values:n})}this.updateQueryFlag=!1}},{key:"transformDataIntoSketch",value:function(t,e){if(this.path&&(this.path.remove(),this.path=null),this.controlPoints=[],"clustering"!==this.queryData.id){var n=this.queryData.targetData,r=n.z.indexOf(this.queryData.period[0]),i=n.z.indexOf(this.queryData.period[1]);if("z"!==t&&"z"!==e){var a=n[t].slice(r,i+1),o=n[e].slice(r,i+1);this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var s=0;s<a.length;s++)this.path.add(new pf.a.Point(this.xScale(a[s]),this.yScale(o[s])))}else if("z"===t){var l=n[e].slice(r,i+1),u=Math.floor(this.xScale.domain()[1]/2)-Math.floor(l.length/2);this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var c=0;c<l.length;c++)this.path.add(new pf.a.Point(this.xScale(c+u),this.yScale(l[c])))}else if("z"===e){var h=n[t].slice(r,i+1),d=Math.floor(this.yScale.domain()[1]/2)-Math.floor(h.length/2);this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var f=0;f<h.length;f++)this.path.add(new pf.a.Point(this.xScale(h[f]),this.yScale(f+d)))}var m=this.path.segments.slice(0,this.path.segments.length);if(this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.widthVar){for(var g=n[this.widthVar].slice(r,i+1),v=Math.min.apply(null,g),y=Math.max.apply(null,g),b=0;b<g.length;b++)this.radiuses.push((g[b]-v)/(y-v)*22.5+2.5);var x=m.length/this.path.segments.length;x=Math.floor(x)%2==1?Math.floor(x):Math.ceil(x);for(var _=0,w=0;_<m.length&&w<this.path.segments.length;)if(m[_].point.x!==this.path.segments[w].point.x||m[_].point.y!==this.path.segments[w].point.y)_++;else{var S=0,E=0,M=_-Math.floor(x/2),C=_+Math.floor(x/2);M=Math.max(0,M),C=Math.min(m.length-1,C);for(var T=M;T<=C;T++)S+=this.radiuses[T],E++;S/=E,this.controlPoints[w].radius=S,_++,w++}this.radiuses=[],this.drawPathWidth()}}else{var k=this.queryData.targetData;if("z"!==t&&"z"!==e)if(this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var P=p(k[t]),A=p(k[e]);P[0]*=1.2,P[1]*=1.2,A[0]*=1.2,A[1]*=1.2;var O,N,R=this.xScale.domain(),L=this.yScale.domain();"x"!==t&&"y"!==t||(O=Math.abs(R[0])<Math.abs(R[1])?Math.abs(R[0]/P[0]):Math.abs(R[1]/P[1])),"x"!==e&&"y"!==e||(N=Math.abs(L[0])<Math.abs(L[1])?Math.abs(L[0]/A[0]):Math.abs(L[1]/A[1]));for(var I=0;I<k[t].length;I++){var D=void 0,z=void 0;D=void 0!==O?k[t][I]*O:(k[t][I]-P[0])/(P[1]-P[0])*(R[1]-R[0])+R[0],z=void 0!==N?k[e][I]*N:(k[e][I]-A[0])/(A[1]-A[0])*(L[1]-L[0])+L[0],this.path.add(new pf.a.Point(this.xScale(D),this.yScale(z)))}}else for(var F=0;F<k[t].length;F++)this.path.add(new pf.a.Point(this.xScale(k[t][F]),this.yScale(k[e][F])));else if("z"===t)if(this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var B=p(k[e]);B[0]*=1.2,B[1]*=1.2;for(var V=this.xScale.domain(),j=this.yScale.domain(),H=0;H<k[e].length;H++){var U=H/k[e].length*(V[1]-V[0])+V[0],G=(k[e][H]-B[0])/(B[1]-B[0])*(j[1]-j[0])+j[0];this.path.add(new pf.a.Point(this.xScale(U),this.yScale(G)))}}else for(var q=0;q<k[e].length;q++){var W=q/k[e].length*(currentXRange[1]-currentXRange[0])+currentXRange[0];this.path.add(new pf.a.Point(this.xScale(W),this.yScale(k[e][q])))}else if("z"===e)if(this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5,this.queryData.subsequenceParameters.normalize){var $=p(k[t]);$[0]*=1.2,$[1]*=1.2;for(var Y=this.xScale.domain(),Q=this.yScale.domain(),X=0;X<k[t].length;X++){var Z=(k[t][X]-$[0])/($[1]-$[0])*(Y[1]-Y[0])+Y[0],J=X/k[e].length*(Q[1]-Q[0])+Q[0];this.path.add(new pf.a.Point(this.xScale(Z),this.yScale(J)))}}else for(var K=0;K<k[e].length;K++){var tt=K/k[e].length*(currentYRange[1]-currentYRange[0])+currentYRange[0];this.path.add(new pf.a.Point(this.xScale(k[t][K]),this.yScale(tt)))}var et=this.path.segments.slice(0,this.path.segments.length);if(this.path.simplify(10),this.path.segments.forEach(function(t){for(var e in this.controlPoints.push({position:{x:t.point.x,y:t.point.y},assignedVariables:{},label:null,labelRect:null}),this.state.lookup)this.controlPoints[this.controlPoints.length-1].assignedVariables[e]=[]}.bind(this)),this.widthVar&&k[this.widthVar]){for(var nt=k[this.widthVar],rt=gf(p(nt),2),it=rt[0],at=rt[1],ot=0;ot<nt.length;ot++)this.radiuses.push((nt[ot]-it)/(at-it)*22.5+2.5);var st=et.length/this.path.segments.length;st=Math.floor(st)%2==1?Math.floor(st):Math.ceil(st);for(var lt=0,ut=0;lt<et.length&&ut<this.path.segments.length;)if(et[lt].point.x!==this.path.segments[ut].point.x||et[lt].point.y!==this.path.segments[ut].point.y)lt++;else{var ct=0,ht=0,dt=lt-Math.floor(st/2),ft=lt+Math.floor(st/2);dt=Math.max(0,dt),ft=Math.min(et.length-1,ft);for(var pt=dt;pt<=ft;pt++)ct+=this.radiuses[pt],ht++;ct/=ht,this.controlPoints[ut].radius=ct,lt++,ut++}this.radiuses=[],this.drawPathWidth()}}}},{key:"CanvasXLabelOnClick",value:function(){return function(){var t=this.state.xItemonPanel,e=Math.min.apply(null,this.state.minList[t]),n=Math.max.apply(null,this.state.maxList[t]);"z"===t&&(n=Math.min(n-e,50),e=0),this.setValueSlider("sketchPadXRangeSlider",e,n),$("#sketchPadXRangeSlider").slider("option","disabled",!1);var r=se("#changeXAxisPanel_SketchPad");if("visible"===r.style("visibility"))r.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var i=document.getElementById("changeXAxisPanel_SketchPad").clientHeight,a=document.getElementById("changeXAxisPanel_SketchPad").clientWidth;if(r.style("transform","translate("+(this.state.size/2-a/2)+"px,"+(this.state.size-i-this.margin.bottom)+"px)").style("visibility","visible"),this.state.xItem===t){var o=(this.xMinMax[0]-e)/(n-e)*100,s=(this.xMinMax[1]-e)/(n-e)*100;$("#sketchPadXRangeSlider").slider("option","values",[o,s])}}}}},{key:"CanvasYLabelOnClick",value:function(){return function(){var t=this.state.yItemonPanel,e=Math.min.apply(null,this.state.minList[t]),n=Math.max.apply(null,this.state.maxList[t]);"z"===t&&(n=Math.min(n-e,50),e=0),this.setValueSlider("sketchPadYRangeSlider",e,n),$("#sketchPadYRangeSlider").slider("option","disabled",!1);var r=se("#changeYAxisPanel_SketchPad");if("visible"===r.style("visibility"))r.transition().duration(50).style("visibility","hidden"),this.setState({xItemonPanel:this.state.xItem});else{var i=document.getElementById("changeYAxisPanel_SketchPad").clientHeight;document.getElementById("changeYAxisPanel_SketchPad").clientWidth,r.style("transform","translate("+(this.margin.left+10)+"px,"+(this.state.size/2-i/2)+"px)").style("visibility","visible")}if(this.state.yItem===t){var a=(this.yMinMax[0]-e)/(n-e)*100,o=(this.yMinMax[1]-e)/(n-e)*100;$("#sketchPadYRangeSlider").slider("option","values",[a,o])}}}},{key:"onSelectXItem",value:function(t){var e=t.target.value;this.setState({xItemonPanel:e});var n=Math.min.apply(null,this.state.minList[e]),r=Math.max.apply(null,this.state.maxList[e]);"z"===e&&(r=Math.min(r-n,50),n=0),this.setValueSlider("sketchPadXRangeSlider",n,r),$("#sketchPadXRangeSlider").slider("option","disabled",!1)}},{key:"onSelectYItem",value:function(t){var e=t.target.value;this.setState({yItemonPanel:e});var n=Math.min.apply(null,this.state.minList[e]),r=Math.max.apply(null,this.state.maxList[e]);"z"===e&&(r=Math.min(r-n,50),n=0),this.setValueSlider("sketchPadYRangeSlider",n,r),$("#sketchPadYRangeSlider").slider("option","disabled",!1)}},{key:"updateXAxisValue",value:function(t,e){this.xMinMax=[t,e],this.updateAxis()}},{key:"updateYAxisValue",value:function(t,e){this.yMinMax=[t,e],this.updateAxis()}},{key:"updateAxis",value:function(){var t,e=Number($("#featureArea").css("padding-left").replace("px","")),n=Number($("#featureArea").css("padding-right").replace("px","")),r=Math.floor(.3*$("#mainFeatureArea").width()-e-n);this.setState({size:r}),se("#QBSCanvasArea").style("padding-bottom",r+"px"),this.svg.attr("width",r).attr("height",r),this.canvas.attr("width",r+"px !important").attr("height",r+"px !important"),pf.a.setup(this.canvas.node()),this.xScale.domain(this.xMinMax).range([0,r]).nice(),this.xLabel=(t=this.xScale,B(1,t)).ticks(5).tickSize(-r).tickFormat(wd),this.xAxis.call(this.xLabel),this.xAxis.select(".domain").remove(),this.xAxis.selectAll(".tick text").attr("y",r-this.margin.bottom).style("color","#8c7b7b"),this.xAxisText.style("left",r/2+"px").style("top",r-18+"px"),this.yScale.domain(this.yMinMax).range([r,0]).nice(),this.yLabel=function(t){return B(2,t)}(this.yScale).ticks(5).tickSize(r).tickFormat(wd),this.yAxis.call(this.yLabel),this.yAxis.select(".domain").remove(),this.yAxis.selectAll(".tick text").attr("x",this.margin.left).attr("y","-0.5em").style("color","#79897b"),this.yAxisText.style("left",this.margin.left/2+"px").style("top",r/2+"px")}},{key:"changeXAxis",value:function(){this.setState({xItem:this.state.xItemonPanel}),this.xAxisText&&this.xAxisText.text(this.state.lookup[this.state.xItemonPanel]);var t=Math.min.apply(null,this.state.minList[this.state.xItemonPanel]),e=Math.max.apply(null,this.state.maxList[this.state.xItemonPanel]);"z"===this.state.xItemonPanel&&(e=Math.min(e-t,50),t=0);var n=$("#sketchPadXRangeSlider").slider("option","values"),r=n[0]/100*(e-t)+t,i=n[1]/100*(e-t)+t;this.updateXAxisValue(r,i),se("#changeXAxisPanel_SketchPad").transition().duration(50).style("visibility","hidden"),"z"!==this.state.xItemonPanel&&"z"!==this.state.yItem&&$("#periodOfSketchQuery").val(20),Object.keys(this.queryData).length<=0?this.recoverStroke(this.state.xItemonPanel,this.state.yItem):Object.keys(this.queryData.targetData).indexOf(this.state.xItemonPanel)>=0?this.transformDataIntoSketch(this.state.xItemonPanel,this.state.yItem):Object.keys(this.queryData.targetData).indexOf(this.state.xItemonPanel)<0&&this.clearCanvas(),this.convertSketchIntoQuery(this.state.xItemonPanel,this.state.yItem)}},{key:"changeYAxis",value:function(){this.setState({yItem:this.state.yItemonPanel}),this.yAxisText&&this.yAxisText.text(this.state.lookup[this.state.yItemonPanel]);var t=Math.min.apply(null,this.state.minList[this.state.yItemonPanel]),e=Math.max.apply(null,this.state.maxList[this.state.yItemonPanel]);"z"===this.state.yItemonPanel&&(e=Math.min(e-t,50),t=0);var n=$("#sketchPadYRangeSlider").slider("option","values"),r=n[0]/100*(e-t)+t,i=n[1]/100*(e-t)+t;this.updateYAxisValue(r,i),se("#changeYAxisPanel_SketchPad").transition().duration(50).style("visibility","hidden"),"z"!==this.state.xItem&&"z"!==this.state.yItemonPanel&&$("#periodOfSketchQuery").val(20),Object.keys(this.queryData).length<=0?this.recoverStroke(this.state.xItem,this.state.yItemonPanel):Object.keys(this.queryData.targetData).indexOf(this.state.yItemonPanel)>=0?this.transformDataIntoSketch(this.state.xItem,this.state.yItemonPanel):Object.keys(this.queryData.targetData).indexOf(this.state.yItemonPanel)<0&&this.clearCanvas(),this.convertSketchIntoQuery(this.state.xItem,this.state.yItemonPanel)}},{key:"recoverStroke",value:function(t,e){if(0===Object.keys(this.queryData).length){if(this.path){var n=this.path;this.path=new pf.a.Path({segments:n.segments,strokeColor:"black",strokeWidth:5})}if(this.pathWidth){var r=this.pathWidth;this.pathWidth=new pf.a.Path({segments:r.segments,strokeColor:"#325D88",strokeWidth:1,fillColor:"#29ABE0",opacity:.5}),this.pathWidth.sendToBack()}}else this.transformDataIntoSketch(t,e)}},{key:"selectPen",value:function(){this.setState({selector:"pen"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorPen").addClass("selected"),this.updateSelectedStatus("pen")}},{key:"selectEraser",value:function(){this.setState({selector:"eraser"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorEraser").addClass("selected"),this.updateSelectedStatus("eraser")}},{key:"selectAddPoint",value:function(){this.setState({selector:"addPoint"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorAddPoint").addClass("selected"),this.updateSelectedStatus("addPoint")}},{key:"selectControlPoint",value:function(){this.setState({selector:"controlPoint"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorControlPoint").addClass("selected"),this.updateSelectedStatus("controlPoint")}},{key:"selectChangeWidth",value:function(){this.setState({selector:"changeWidth"}),$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected")})),this.state.assignVariables||$("#selectorChangeWidth").addClass("selected"),this.updateSelectedStatus("changeWidth")}},{key:"switchVariableAssignment",value:function(){var t=!this.state.assignVariables;if(this.setState({assignVariables:t}),t)$("img[name=QBSSelector]").each((function(){$(this).removeClass("selected"),$(this).addClass("disabled")}));else{var e=this.state.selector;$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled"),$(this).attr("value")===e&&$(this).addClass("selected")}))}$("#variableAssignmentSwitch").prop("checked",t),t&&this.path?this.path.fullySelected=!0:t||(this.setState({popover:!1}),this.highlightedPoint&&this.highlightedPoint.remove(),this.updateSelectedStatus(this.state.selector))}},{key:"updateSelectedStatus",value:function(t){"addPoint"===t||"eraser"===t||"controlPoint"===t||"changeWidth"===t?this.path&&(this.path.fullySelected=!0):"pen"===t&&this.path&&(this.path.fullySelected=!1)}},{key:"removeAllAsignment",value:function(){for(var t=0;t<this.controlPoints.length;t++){for(var e in this.controlPoints[t].assignedVariables)this.controlPoints[t].assignedVariables[e]=[];this.controlPoints[t].label&&(this.controlPoints[t].label.remove(),this.controlPoints[t].label=null,this.controlPoints[t].labelRect.remove(),this.controlPoints[t].labelRect=null)}}},{key:"axisSelectionPanel",value:function(){var t=[],e=[];for(var n in this.state.lookup){var r="";(r=this.state.lookup[n].length>1?this.state.lookup[n].join(","):this.state.lookup[n]).indexOf("JD")<0?(t.push(i.a.createElement("div",{className:"form-check",key:r,style:{paddingLeft:"0px"}},i.a.createElement("input",{type:"radio",name:"selectXAxis_SketchPad",value:n,checked:this.state.xItemonPanel===n,onChange:this.onSelectXItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",key:r},r))),e.push(i.a.createElement("div",{className:"form-check",key:r,style:{paddingLeft:"0px"}},i.a.createElement("input",{type:"radio",name:"selectYAxis_SketchPad",value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",key:r},r)))):(t.unshift(i.a.createElement("div",{className:"form-check",key:r,style:{paddingLeft:"0px"}},i.a.createElement("input",{type:"radio",name:"selectXAxis_SketchPad",value:n,checked:this.state.xItemonPanel===n,onChange:this.onSelectXItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",key:r},r))),e.unshift(i.a.createElement("div",{className:"form-check",key:r,style:{paddingLeft:"0px"}},i.a.createElement("input",{type:"radio",name:"selectYAxis_SketchPad",value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",key:r},r))))}return{x:i.a.createElement("div",{className:"overlayPanel",id:"changeXAxisPanel_SketchPad",style:{visibility:"hidden",textAlign:"center",zIndex:"101"}},i.a.createElement("h6",null,"Change x axis"),i.a.createElement("div",{id:"changeXAxisItem_SketchPad",style:{textAlign:"left"}},i.a.createElement("form",{id:"changeXAxisForm_SketchPad"},t),i.a.createElement("div",{className:"featureElem",id:"sketchPadXRangeSlider",style:{width:"150px"}},i.a.createElement("output",{id:"sketchPadXRangeSliderMax",style:{bottom:"1.3rem",zIndex:200}}),i.a.createElement("output",{id:"sketchPadXRangeSliderMin",style:{bottom:"1.3rem",zIndex:201}})),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_SketchPad",style:{float:"right"},onClick:this.changeXAxis.bind(this)},"Done"))),y:i.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_SketchPad",style:{visibility:"hidden",textAlign:"center",zIndex:"102"}},i.a.createElement("h6",null,"Change y axis"),i.a.createElement("div",{id:"changeYAxisItem_SketchPad",style:{textAlign:"left"}},i.a.createElement("form",{id:"changeYAxisForm_SketchPad"},e)),i.a.createElement("div",{className:"featureElem",id:"sketchPadYRangeSlider",style:{width:"150px"}},i.a.createElement("output",{id:"sketchPadYRangeSliderMax",style:{bottom:"1.3rem",zIndex:200}}),i.a.createElement("output",{id:"sketchPadYRangeSliderMin",style:{bottom:"1.3rem",zIndex:201}})),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeXAxisBtn_SketchPad",style:{float:"right"},onClick:this.changeYAxis.bind(this)},"Done"))}}},{key:"sketchMenu",value:function(){return i.a.createElement("div",{id:"QBSSelectorMenu",className:"featureElem"},i.a.createElement("h5",null,"Selection"),i.a.createElement("form",{className:"selector featureRow"},i.a.createElement("div",{className:"form-check form-check-inline"},i.a.createElement("img",{id:"selectorPen",className:"selectorIcon selected",name:"QBSSelector",value:"pen",src:"img/icons/pen.png",alt:"pen",width:"30",height:"30",title:"draw a sketch",onClick:this.selectPen.bind(this),readOnly:!0}),i.a.createElement("img",{id:"selectorAddPoint",className:"selectorIcon",name:"QBSSelector",value:"addPoint",src:"img/icons/add.png",alt:"add point",width:"30",height:"30",title:"add a control point on the sketch",onClick:this.selectAddPoint.bind(this),readOnly:!0}),i.a.createElement("img",{id:"selectorEraser",className:"selectorIcon",name:"QBSSelector",value:"eraser",src:"img/icons/delete.png",alt:"delete point",width:"30",height:"30",title:"remove a control point from the sketch",onClick:this.selectEraser.bind(this),readOnly:!0}),i.a.createElement("img",{id:"selectorControlPoint",className:"selectorIcon",name:"QBSSelector",value:"controlPoint",src:"img/icons/control.png",alt:"control point",width:"30",height:"30",title:"move a control point on the sketch",onClick:this.selectControlPoint.bind(this),readOnly:!0}),i.a.createElement("img",{id:"selectorChangeWidth",className:"selectorIcon",name:"QBSSelector",value:"changeWidth",src:"img/icons/width.png",alt:"change width",width:"30",height:"30",title:"change the width of the sketch",onClick:this.selectChangeWidth.bind(this),readOnly:!0})),i.a.createElement("div",{id:"selectorExploration",className:"tooltip",style:{visibility:"hidden"}})))}},{key:"sketchOptions",value:function(){return i.a.createElement("div",{id:"QBSSketchOptions",className:"featureElem"},i.a.createElement("h5",{onClick:this.collapseQBSSketchOptions},"Options of Query-by-sketch"),i.a.createElement("div",{id:"QBSSketchOptionsMain"},this.sketchWidthControl(),this.assignVariablesArea(),this.definePeriodOfQuery()))}},{key:"sketchPadPreset",value:function(){return i.a.createElement("div",{className:"featureElem form-inline",style:{float:"left"}},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"sketchPadPreset",style:{width:"8rem"},onChange:this.changeSketchPadAxes.bind(this)},i.a.createElement("option",{value:"Stokes"},"Stokes plane"),i.a.createElement("option",{value:"lightCurve"},"Light curve")))}},{key:"changeSketchPadAxes",value:function(){var t=document.getElementById("sketchPadPreset");if(t&&t.options.length>0){var e,n,r,i,a=t.selectedIndex;switch(t.options[a].value){case"Stokes":this.xAxisText&&this.xAxisText.text(this.state.lookup.x),this.yAxisText&&this.yAxisText.text(this.state.lookup.y),e=Math.min.apply(null,this.state.minList.x),n=Math.max.apply(null,this.state.maxList.x),r=Math.min.apply(null,this.state.minList.y),i=Math.max.apply(null,this.state.maxList.y),this.setValueSlider("sketchPadXRangeSlider",e,n),this.updateXAxisValue(e,n),this.setValueSlider("sketchPadYRangeSlider",r,i),this.updateYAxisValue(r,i),Object.keys(this.queryData).length<=0?this.recoverStroke("x","y"):this.transformDataIntoSketch("x","y"),this.convertSketchIntoQuery("x","y"),this.setState({xItem:"x",xItemonPanel:"x",yItem:"y",yItemonPanel:"y"});break;case"lightCurve":this.xAxisText&&this.xAxisText.text(this.state.lookup.z),this.yAxisText&&this.yAxisText.text(this.state.lookup.V),e=Math.min.apply(null,this.state.minList.z),n=Math.max.apply(null,this.state.maxList.z),n=Math.min(n-e,50),e=0,r=Math.min.apply(null,this.state.minList.V),i=Math.max.apply(null,this.state.maxList.V),this.setValueSlider("sketchPadXRangeSlider",e,n),this.updateXAxisValue(e,n),this.setValueSlider("sketchPadYRangeSlider",r,i),this.updateYAxisValue(r,i),Object.keys(this.queryData).length<=0?this.recoverStroke("z","V"):this.transformDataIntoSketch("z","V"),this.convertSketchIntoQuery("z","V"),this.setState({xItem:"z",xItemonPanel:"z",yItem:"V",yItemonPanel:"V"})}}}},{key:"importExportQueryMenu",value:function(){return i.a.createElement("div",{id:"importExportQuery",className:"featureElem form-inline",style:{float:"right"}},i.a.createElement("div",{className:"custom-file",style:{width:"170px",marginRight:"0.5rem"}},i.a.createElement("input",{type:"file",id:"importQuery",className:"custom-file-input",onChange:this.importQuery.bind(this)}),i.a.createElement("label",{className:"custom-file-label",htmlFor:"importQuery",style:{justifyContent:"start"}},"Import")),i.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.exportQuery.bind(this)},"Export"))}},{key:"importQuery",value:function(){var t=document.getElementById("importQuery").files,e=new FileReader;e.readAsText(t[0]),e.onload=function(){var t=e.result,n=JSON.parse(t);if("query-by-sketch"===n.option){var r,i;this.clearCanvas();for(var a=0;a<n.query.xItem.length;a++)for(var o in this.state.lookup)if(this.state.lookup[o].indexOf(n.query.xItem[a])>=0){r=o;break}for(var s=0;s<n.query.yItem.length;s++)for(var l in this.state.lookup)if(this.state.lookup[l].indexOf(n.query.yItem[s])>=0){i=l;break}this.setState({xItem:r,xItemonPanel:r,yItem:i,yItemonPanel:i,detectWidth:!!n.query.widthVar}),this.xAxisText&&this.xAxisText.text(this.state.lookup[r]),this.yAxisText&&this.yAxisText.text(this.state.lookup[i]),this.xMinMax=n.query.xRange,this.yMinMax=n.query.yRange,this.updateAxis(),$("#periodOfSketchQuery").val(n.query.length);for(var u=this.state.size/n.query.size,c=0;c<n.query.controlPoints.length;c++)this.controlPoints.push(n.query.controlPoints[c]),this.controlPoints[this.controlPoints.length-1].position.x=this.controlPoints[this.controlPoints.length-1].position.x*u,this.controlPoints[this.controlPoints.length-1].position.y=this.controlPoints[this.controlPoints.length-1].position.y*u;this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var h=0;h<n.query.path.length;h++)this.path.add(new pf.a.Point(n.query.path[h][1][0]*u,n.query.path[h][1][1]*u)),this.path.segments[this.path.segments.length-1].handleIn.x=n.query.path[h][2][0]*u,this.path.segments[this.path.segments.length-1].handleIn.y=n.query.path[h][2][1]*u,this.path.segments[this.path.segments.length-1].handleOut.x=n.query.path[h][3][0]*u,this.path.segments[this.path.segments.length-1].handleOut.y=n.query.path[h][3][1]*u;if(n.query.widthVar){for(var d=0;d<n.query.widthVar.length;d++)for(var f in this.state.lookup)if(this.state.lookup[f].indexOf(n.query.widthVar[d])>=0){this.widthVar=f;break}this.widthRange=n.query.widthRange,this.changeWidthVariable(this.widthVar,this.widthRange);for(var p=0;p<this.controlPoints.length;p++)this.controlPoints[p].radius=n.query.controlPoints[p].radius;this.drawPathWidth()}for(var m=0;m<this.controlPoints.length;m++){var g="";for(var v in this.controlPoints[m].assignedVariables)this.controlPoints[m].assignedVariables[v].length>0&&(g+=this.state.lookup[v]+", ");""!==g&&(this.controlPoints[m].label=new pf.a.PointText({position:{x:this.controlPoints[m].position.x,y:this.controlPoints[m].position.y},fillColor:"#7b7971",justification:"center",fontSize:8}),g=g.slice(0,-2),this.controlPoints[m].label.content=g,this.controlPoints[m].labelRect=new pf.a.Path.Rectangle(this.controlPoints[m].label.bounds),this.controlPoints[m].labelRect.fillColor="white",this.controlPoints[m].labelRect.strokeColor="white",this.controlPoints[m].label.insertAbove(this.controlPoints[m].labelRect))}this.convertSketchIntoQuery(r,i)}else alert("This file is not for a query-by-sketch.")}.bind(this)}},{key:"exportQuery",value:function(){if(this.path){var t=Rh.getQuery();if("query-by-sketch"===t.option){t=JSON.stringify(t,null,"\t");var e="sketchQuery_"+mh()+".json",n=new Blob([t],{type:"application/json"}),r=(window.URL||window.webkitURL).createObjectURL(n),i=document.createElement("a");i.download=decodeURI(e),i.href=r,i.click()}else alert("You can export only a query-by-sketch.")}}},{key:"recoverQuery",value:function(t,e){for(var n=this.state.size/t.query.size,r=0;r<t.query.controlPoints.length;r++)this.controlPoints.push(t.query.controlPoints[r]),this.controlPoints[this.controlPoints.length-1].position.x*=n,this.controlPoints[this.controlPoints.length-1].position.y*=n;this.path=new pf.a.Path,this.path.strokeColor="black",this.path.strokeWidth=5;for(var i=0;i<t.query.path.length;i++)this.path.add(new pf.a.Point(t.query.path[i][1][0]*n,t.query.path[i][1][1]*n)),this.path.segments[this.path.segments.length-1].handleIn.x=t.query.path[i][2][0]*n,this.path.segments[this.path.segments.length-1].handleIn.y=t.query.path[i][2][1]*n,this.path.segments[this.path.segments.length-1].handleOut.x=t.query.path[i][3][0]*n,this.path.segments[this.path.segments.length-1].handleOut.y=t.query.path[i][3][1]*n;if(this.widthVar){for(var a=0;a<this.controlPoints.length;a++)this.controlPoints[a].radius=t.query.controlPoints[a].radius;this.drawPathWidth()}for(var o=0;o<this.controlPoints.length;o++){var s="";for(var l in this.controlPoints[o].assignedVariables)this.controlPoints[o].assignedVariables[l].length>0&&(s+=e[l]+", ");""!==s&&(this.controlPoints[o].label=new pf.a.PointText({position:{x:this.controlPoints[o].position.x,y:this.controlPoints[o].position.y},fillColor:"#7b7971",justification:"center",fontSize:8}),s=s.slice(0,-2),this.controlPoints[o].label.content=s,this.controlPoints[o].labelRect=new pf.a.Path.Rectangle(this.controlPoints[o].label.bounds),this.controlPoints[o].labelRect.fillColor="white",this.controlPoints[o].labelRect.strokeColor="white",this.controlPoints[o].label.insertAbove(this.controlPoints[o].labelRect))}this.updateQueryFlag=!0}},{key:"collapseQBSSketchOptions",value:function(){$("#QBSSketchOptionsMain").slideToggle()}},{key:"sketchWidthControl",value:function(){var t=[];for(var e in this.state.lookup)if(e!==this.state.xItem&&e!==this.state.yItem){var n="";n=this.state.lookup[e].length>1?this.state.lookup[e].join(","):this.state.lookup[e],"z"!==e&&(e===this.widthVar?t.push(i.a.createElement("option",{key:e,value:e,selected:!0},n)):t.push(i.a.createElement("option",{key:e,value:e},n)))}return i.a.createElement("div",{id:"sketchWidthControl",className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},i.a.createElement("h6",null,"Variable assigned to the sketch width"),i.a.createElement("div",{className:"row matchingOption",style:{paddingLeft:"15px",paddingRight:"15px"}},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"widthDetectionSwitch",checked:this.state.detectWidth,onChange:this.updateWidthDetection.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"widthDetectionSwitch"},"Detect width"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-5"},"Variable assigned to width"),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"widthVariables",style:{width:"40%"},disabled:!this.state.detectWidth,defaultValue:this.widthVar,onChange:this.updateWidthVariable.bind(this)},t))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-5"},"Value range"),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"featureElem",id:"sketchWidthSlider",style:{width:"150px"}},i.a.createElement("output",{id:"sketchWidthSliderMax",style:{bottom:"1.3rem",zIndex:200}}),i.a.createElement("output",{id:"sketchWidthSliderMin",style:{bottom:"1.3rem",zIndex:201}})))))}},{key:"updateWidthDetection",value:function(){var t=!this.state.detectWidth;if(this.setState({detectWidth:t}),t){var e=document.getElementById("widthVariables"),n=e.selectedIndex,r=e.options[n].value;this.widthVar=r,$("img[name=QBSSelector]").each((function(){$(this).removeClass("disabled")}))}else this.widthVar=null,this.pathWidth&&(this.pathWidth.remove(),this.pathWidth=null),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem),$("img[name=QBSSelector]").each((function(){"changeWidth"===$(this).attr("value")&&$(this).addClass("disabled")}))}},{key:"updateWidthVariable",value:function(){var t=document.getElementById("widthVariables");if(t&&t.options.length>0){var e=t.selectedIndex,n=t.options[e].value;this.widthRange=[Math.min.apply(null,this.state.minList[n]),Math.max.apply(null,this.state.maxList[n])],this.setValueSlider("sketchWidthSlider",this.widthRange[0],this.widthRange[1]),$("#sketchWidthSlider").on("slidestop",this.stopSlidingWidthSlider().bind(this)),$("#sketchWidthSlider").slider("option","disabled",!this.state.detectWidth),this.widthVar=n,Object.keys(this.queryData).length>0&&this.transformDataIntoSketch(this.state.xItem,this.state.yItem),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"changeWidthVariable",value:function(t,e){var n=document.getElementById("widthVariables"),r=-1;if(n&&n.options.length>0)for(r=0;r<n.options.length&&n.options[r].value!==t;r++);if(r<n.options.length&&(n.selectedIndex=r),void 0!==e){var i=Math.min.apply(null,this.state.minList[t]),a=Math.max.apply(null,this.state.maxList[t]),o=(e[0]-i)/(a-i)*100,s=(e[1]-i)/(a-i)*100;this.widthRange=e,this.setValueSlider("sketchWidthSlider",e[0],e[1]),(o||s)&&$("#sketchWidthSlider").slider("option","values",[o,s])}}},{key:"stopSlidingWidthSlider",value:function(){return function(t,e){this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"definePeriodOfQuery",value:function(){return i.a.createElement("div",{id:"timeLengthOfSketch"},i.a.createElement("h6",null,"The length of time of the sketch"),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Length of the sketched query"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"Length of time",id:"periodOfSketchQuery",style:{width:"40%",marginRight:"0.5rem"},onChange:this.updateTimeLength.bind(this),required:!0,disabled:"z"===this.state.xItem||"z"===this.state.yItem}),i.a.createElement("label",{className:"col-form-label col-form-label-sm",htmlFor:"periodOfSketchQuery"},"days"))))}},{key:"updateTimeLength",value:function(){var t=$("#periodOfSketchQuery").val();if(""!==t){t=Number(t);var e=$("#QBSSketchPad").width();if("z"===this.state.xItem){var n=this.controlPoints[0].position.x,r=this.controlPoints[this.controlPoints.length-1].position.x;this.updateXAxisValue(0,Sd(t/(r-n)*e))}else if("z"===this.state.yItem){var i=this.controlPoints[0].position.y,a=this.controlPoints[this.controlPoints.length-1].position.y;this.updateYAxisValue(0,Sd(t/(a-i)*e))}this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}}},{key:"assignVariablesArea",value:function(){return i.a.createElement("div",{id:"variableAssignment"},i.a.createElement("h6",null,"Assign variables to the sketch"),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"variableAssignmentSwitch",onChange:this.switchVariableAssignment.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"variableAssignmentSwitch"},"Assign variables"))),i.a.createElement("div",{className:"col"},i.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm",id:"removeAllAssignment",onClick:this.removeAllAsignment.bind(this)},"Remove all assignments"))))}},{key:"onClickValueAssignmentCheckbox",value:function(t){var e=t.target.value,n=t.target.checked;$("#slider_"+e).slider("option","disabled",!n)}},{key:"onClickValueAssignmentDone",value:function(){$("#controlPointPopover").css("display","none");for(var t=$("input[name=assignedVariableList]"),e="",n=(this.controlPoints[this.highlightedPointIdx].assignedVariables,0);n<t.length;n++)if(t[n].checked){var r=t[n].value,i=Math.min.apply(null,this.state.minList[r]),a=Math.max.apply(null,this.state.maxList[r]),o=$("#slider_"+t[n].value).slider("option","values");this.controlPoints[this.highlightedPointIdx].assignedVariables[r]=[i+(a-i)*o[0]/100,i+(a-i)*o[1]/100],e+=this.state.lookup[r]+", "}else{var s=t[n].value;this.controlPoints[this.highlightedPointIdx].assignedVariables[s]=[]}this.controlPoints[this.highlightedPointIdx].label&&(this.controlPoints[this.highlightedPointIdx].label.remove(),this.controlPoints[this.highlightedPointIdx].label=null,this.controlPoints[this.highlightedPointIdx].labelRect.remove(),this.controlPoints[this.highlightedPointIdx].labelRect=null),""!==e&&(this.controlPoints[this.highlightedPointIdx].label=new pf.a.PointText({position:{x:this.controlPoints[this.highlightedPointIdx].position.x,y:this.controlPoints[this.highlightedPointIdx].position.y-10},fillColor:"#7b7971",justification:"center",fontSize:8}),e=e.slice(0,-2),this.controlPoints[this.highlightedPointIdx].label.content=e,this.controlPoints[this.highlightedPointIdx].labelRect=new pf.a.Path.Rectangle(this.controlPoints[this.highlightedPointIdx].label.bounds),this.controlPoints[this.highlightedPointIdx].labelRect.fillColor="white",this.controlPoints[this.highlightedPointIdx].labelRect.strokeColor="white",this.controlPoints[this.highlightedPointIdx].label.insertAbove(this.controlPoints[this.highlightedPointIdx].labelRect)),this.convertSketchIntoQuery(this.state.xItem,this.state.yItem)}},{key:"setValueSlider",value:function(t,e,n){var r=$("#"+t),i=$("#"+t+"Min"),a=$("#"+t+"Max");t.slice("_")[1],r.slider({range:!0,disabled:!0,
//!$('#valueAssignmentCheckbox_' + key).prop('checked'),
min:0,max:100,values:[0,100],slide:function(r,o){var s=o.values[0]/100*(n-e)+e,l=o.values[1]/100*(n-e)+e;i.val(Sd(s)),a.val(Sd(l)),"sketchWidthSlider"===t&&(this.widthRange=[s,l]);var u=150*o.values[0]/100-8,c=142-150*o.values[1]/100;0===o.handleIndex?(i.css("display","initial"),i.css("left",u+"px")):1===o.handleIndex&&(a.css("display","initial"),a.css("right",c+"px"))}.bind(this),stop:function(){i.css("display","none"),a.css("display","none")}}),i.val(r.slider("values",0)),a.val(r.slider("values",1))}},{key:"controlPointPopover",value:function(){var t=0,e=[];for(var n in this.state.lookup){var r="";if((r=this.state.lookup[n].length>1?this.state.lookup[n].join(","):this.state.lookup[n][0]).indexOf("JD")<0){var a="slider_"+n;e.push(i.a.createElement("div",{id:"assignVariable_"+n,className:"row align-items-center",key:r},i.a.createElement("div",{className:"form-check col-4",style:{paddingLeft:"0px"},onChange:this.onClickValueAssignmentCheckbox.bind(this)},i.a.createElement("input",{type:"checkbox",id:"valueAssignmentCheckbox_"+n,name:"assignedVariableList",value:n}),i.a.createElement("label",{className:"form-check-label",key:r},r)),i.a.createElement("div",{className:"col",id:a,style:{width:"150px"}},i.a.createElement("output",{id:a+"Max",style:{bottom:"1.3rem",zIndex:100+t}}),i.a.createElement("output",{id:a+"Min",style:{bottom:"1.3rem",zIndex:150+t}})),i.a.createElement("div",{id:"widthValue_"+n,style:{display:"none"}}))),this.setValueSlider(a,Math.min.apply(null,this.state.minList[n]),Math.max.apply(null,this.state.maxList[n]))}t++}return i.a.createElement("div",{id:"controlPointPopover",className:"popover",style:{position:"absolute",opacity:"0.85",display:"none",padding:"0.5rem 0.8rem"}},i.a.createElement("div",{id:"controlPointPopoverArrow",className:"arrow"}),i.a.createElement("form",{className:"container",name:"assignVariablesForm",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},e),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"valueAssignmentDoneBtn",style:{float:"right"},onClick:this.onClickValueAssignmentDone.bind(this)},"Done"))}},{key:"render",value:function(){var t=this.axisSelectionPanel();return this.updateQueryFlag&&"feature"===Su.getMenu()&&this.convertSketchIntoQuery(this.state.xItem,this.state.yItem),i.a.createElement("div",{id:"QBSQuerying"},this.sketchMenu(),i.a.createElement("div",{id:"QBSCanvasArea"},t.x,t.y,this.controlPointPopover(),i.a.createElement("div",{className:"overlayHidingPanel"})),i.a.createElement("div",{id:"QBSSketchMenuArea"},this.sketchPadPreset(),this.importExportQueryMenu(),i.a.createElement("div",{style:{clear:"both"}}),this.sketchOptions()))}}])&&yf(e.prototype,n),r&&yf(e,r),o}(i.a.Component);function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cf(t,e){return(Cf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Af(t);if(e){var i=Af(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return kf(this,n)}}function kf(t,e){return!e||"object"!==Ef(e)&&"function"!=typeof e?Pf(t):e}function Pf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Af(t){return(Af=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Of=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cf(t,e)}(o,t);var e,n,r,a=Tf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).id=t.id,e.fileName=Ju.getFileName(e.id),e.thumbnail=t.thumbnail,e.result=t.result,e.rank=t.rank,e.activeVar=Rh.getActive(),e.lookup=Ju.getData(e.id).data.lookup,e.variables=[],e.clickedX=null,e.clickedY=null,e.moved=!1,e.onMouseMoveOnResultSummaryFnc=e.onMouseMoveOnResultSummary.bind(Pf(e)),e.onMouseUpFromResultSummaryFnc=e.onMouseUpFromResultSummary.bind(Pf(e)),e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=document.getElementById("resultSummaryCanvas_"+this.rank),n=e.getContext("2d"),r=Math.min(this.thumbnail.height,this.thumbnail.width),i=this.thumbnail.width/2-r/2,a=this.thumbnail.height/2-r/2;this.thumbnail.onload=function(){n.drawImage(this.thumbnail,i,a,r,r,0,0,e.width,e.height)}.bind(this),document.getElementById("resultSummary_"+this.rank).addEventListener("mousedown",this.onMouseDownOnResultSummary.bind(this),!1),Rh.on("focusResultFromTimeline",(function(e){var n=!1;if(void 0!==e.V&&t.result.flares){for(var r=0;r<t.result.flares.length;r++)if(Object(Pc.isEqual)(t.result.flares[r],e)){n=!0;break}}else Object(Pc.isEqual)(t.result,e)&&(n=!0);n&&se("#resultSummary_"+t.rank).transition().duration(300).style("border","1px solid #d23430").transition().duration(1e3).style("border","1px solid rgba(223, 215, 202, 0.75)")})),Rh.on("selectResultFromTimeline",(function(e){var n=!1;if(void 0!==e.V&&t.result.flares){for(var r=0;r<t.result.flares.length;r++)if(Object(Pc.isEqual)(t.result.flares[r],e)){n=!0;break}}else Object(Pc.isEqual)(t.result,e)&&(n=!0);n&&(se("#resultSummary_"+t.rank).transition().duration(300).style("border","1px solid #d23430").transition().duration(1e3).style("border","1px solid rgba(223, 215, 202, 0.75)"),t.showDetails())}))}},{key:"showFileName",value:function(){return i.a.createElement("div",{style:{wordWrap:"anywhere"}},i.a.createElement("label",null,this.fileName))}},{key:"showThumbnail",value:function(){return i.a.createElement("canvas",{id:"resultSummaryCanvas_"+this.rank,width:"150",height:"150",className:"resultSummaryCanvas"})}},{key:"showPeriod",value:function(){return this.result.period?i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col4"},i.a.createElement("label",null,"Period")),i.a.createElement("div",{className:"col"},Math.floor(this.result.start)," - ",Math.ceil(this.result.start+this.result.period))):i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col4"},i.a.createElement("label",null,"JD")),i.a.createElement("div",{className:"col"},Math.floor(this.result.start)))}},{key:"showDistance",value:function(){return isNaN(this.result.distance)?isNaN(this.result.V)?isNaN(this.result.angle)?void 0:i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col4"},i.a.createElement("label",null,"Angle")),i.a.createElement("div",{className:"col"},Sd(this.result.angle))):i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col4"},i.a.createElement("label",null,"Intensity")),i.a.createElement("div",{className:"col"},Sd(this.result.V))):i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col4"},i.a.createElement("label",null,"Distance")),i.a.createElement("div",{className:"col"},Sd(this.result.distance)))}},{key:"showDetails",value:function(){"none"===$("#resultDetailArea").css("display")&&xh();var t=document.getElementById("detailThumbnailCanvas"),e=$("#extractionDetailThumbnail").width();$("#detailThumbnailCanvas").width(e),$("#detailThumbnailCanvas").height(e);var n=t.getContext("2d");n.clearRect(0,0,e,e);var r=Math.min(this.thumbnail.height,this.thumbnail.width),i=this.thumbnail.width/2-r/2,a=this.thumbnail.height/2-r/2;n.drawImage(this.thumbnail,i,a,r,r,0,0,t.width,t.height),$("#extractionDetailLC").height(e)}},{key:"onMouseDownOnResultSummary",value:function(t){this.moved=!1;var e=document.getElementById("resultSummaryHolder_"+this.rank);e.classList.add("drag");var n=document.getElementById("resultSummary_"+this.rank);this.clickedX=t.pageX-n.offsetLeft,this.clickedY=t.pageY-n.offsetTop,document.body.addEventListener("mousemove",this.onMouseMoveOnResultSummaryFnc,!1),e.addEventListener("mouseup",this.onMouseUpFromResultSummaryFnc,!1)}},{key:"onMouseMoveOnResultSummary",value:function(t){this.moved=!0;var e=document.getElementsByClassName("drag")[0];if(e)switch(e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX+"px",Rh.getMode()){case"AE":break;case"QBE":var n=$("#selectedTimeSliceView"),r=n.offset(),i=n.width(),a=n.height();if(r.left<=t.pageX&&t.pageX<=r.left+i&&r.top<=t.pageY&&t.pageY<=r.top+a){var o=$("#selectedTimeSliceView > .overlayHidingPanel");o.css("display","block"),o.css("width",Math.min(i,a)),o.css("height",Math.min(i,a))}break;case"QBS":var s=$("#QBSSketchPad"),l=s.offset(),u=s.width(),c=s.innerHeight();if(l.left<=t.pageX&&t.pageX<=l.left+u&&l.top<=t.pageY&&t.pageY<=l.top+c){var h=$("#QBSCanvasArea > .overlayHidingPanel");h.css("display","block"),h.css("width",Math.min(u,c)),h.css("height",Math.min(u,c))}}}},{key:"onMouseUpFromResultSummary",value:function(t){document.body.removeEventListener("mousemove",this.onMouseMoveOnResultSummaryFnc,!1);var e=document.getElementsByClassName("drag")[0];if(e&&(e.removeEventListener("mouseup",this.onMouseUpFromResultSummaryFnc,!1),e.classList.remove("drag"),e.style.position="static"),this.moved){switch(Rh.getMode()){case"AE":break;case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var n=$("#selectedTimeSliceView"),r=n.offset(),i=n.width(),a=n.height();r&&r.left<=t.pageX&&t.pageX<=r.left+i&&r.top<=t.pageY&&t.pageY<=r.top+a&&(($("#QBESourceMain").length<=0||"none"===$("#QBESourceMain").css("display"))&&(bh(),fu()),th(this.result.id,[this.result.start,this.result.start+this.result.period],this.activeVar),"block"===$("#resultDetailArea").css("display")&&xh(),Rh.getSource()!==this.result.id&&qc(this.result.id));break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var o=$("#QBSSketchPad"),s=o.offset(),l=o.width(),u=o.innerHeight();s&&s.left<=t.pageX&&t.pageX<=s.left+l&&s.top<=t.pageY&&t.pageY<=s.top+u&&(th(this.result.id,[this.result.start,this.result.start+this.result.period],this.activeVar),"block"===$("#resultDetailArea").css("display")&&xh())}this.moveToOriginalPos(),this.moved=!1}else{this.showDetails();var c=$("#extractionDetailLC").width();!function(t,e,n){hu.dispatch({type:"UPDATE_SELECTED_RESULT",result:t,width:e,height:n})}(this.result,c,200)}}},{key:"moveToOriginalPos",value:function(){var t=$("#resultSummaryHolder_"+(this.rank+1));t?t.before($("#resultSummaryHolder_"+this.rank)):$("#resultSummaryHolder_"+(this.rank-1)).after($("#resultSummaryHolder_"+this.rank))}},{key:"render",value:function(){return i.a.createElement("div",{className:"resultSummary",id:"resultSummary_"+this.rank},this.showFileName(),this.showThumbnail(),i.a.createElement("div",{className:"container",style:{paddingLeft:"0px",paddingRight:"0px"}},this.showPeriod(),this.showDistance()))}}])&&Mf(e.prototype,n),r&&Mf(e,r),o}(i.a.Component);function Nf(t){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rf(t,e){var n,r;switch(t){case"minmax":if(Array.isArray(e)){n=[];var i=Math.min.apply(null,e),a=Math.max.apply(null,e);if(a-i!=0)for(var o=0;o<e.length;o++)n.push((e[o]-i)/(a-i));else for(var s=0;s<e.length;s++)n.push(0)}else if("object"===Nf(e))for(var l in n={},e)if(Array.isArray(e[l])&&e[l].indexOf(null)<0)if("theta"!==l){var u=Math.min.apply(null,e[l]),c=Math.max.apply(null,e[l]);if(n[l]=[],c-u!=0)for(var h=0;h<e[l].length;h++)n[l].push((e[l][h]-u)/(c-u));else for(var d=0;d<e[l].length;d++)n[l].push(0)}else n[l]=Lf(t,e[l]);else n[l]=e[l];break;case"centralize":if(Array.isArray(e)){n=[],r=P(e);for(var p=0;p<e.length;p++)n.push(e[p]-r)}else for(var m in n={},e)if(Array.isArray(e[m])&&e[m].indexOf(null)<0)if("theta"!==m){r=P(e[m]),n[m]=[];for(var g=0;g<e[m].length;g++)n[m].push(e[m][g]-r)}else n[m]=Lf(t,e[m]);else n[m]=e[m];break;case"zScore":if(Array.isArray(e)){n=[],r=P(e);for(var v=f(e),y=0;y<e.length;y++)n.push((e[y]-r)/v)}else if("object"===Nf(e))for(var b in n={},e)if(Array.isArray(e[b])&&e[b].indexOf(null)<0)if("theta"!==b){r=P(e[b]);var x=f(e[b]);n[b]=[];for(var _=0;_<e[b].length;_++)n[b].push((e[b][_]-r)/x)}else n[b]=Lf(t,e[b]);else n[b]=e[b]}return n}function Lf(t,e){for(var n,r=[],i=[],a=(e[0],Qf(e[0])),o=0,s=0;s<e.length;s++){var l=Qf(e[s]);1===a&&4===l?o-=360:4==a&&1===l&&(o+=360),i.push(e[s]+o),e[s]+o,a=l}switch(t){case"minmax":for(var u=Math.min.apply(null,i),c=Math.max.apply(null,i),h=0;h<i.length;h++)r.push((i[h]-u)/(c-u));break;case"centralize":n=P(i);for(var d=0;d<i.length;d++)r.push(i[d]-n);break;case"zScore":n=P(i);for(var p=f(i),m=0;m<i.length;m++)r.push((i[m]-n)/p)}return r}function If(t,e,n){for(var r=[],i=0;i<=t.length;i++){r[i]=[];for(var a=0;a<=e.length;a++)r[i][a]=1/0}r[0][0]=0;for(var o=1;o<=t.length;o++)for(var s=1;s<=e.length;s++)r[o][s]=n(t[o-1],e[s-1])+Math.min(r[o-1][s],r[o][s-1],r[o-1][s-1]);for(var l=[],u=1;u<r.length;u++)l.push(r[u].slice(1,r[u].length));return l}function Df(t,e,n,r){for(var i=[],a=0;a<=t.arrayLength;a++){i[a]=[];for(var o=0;o<=e.arrayLength;o++)i[a][o]=1/0}i[0][0]=0;for(var s=function(a){var o=[];n.forEach((function(e){o.push(t[e][a-1])}));for(var s=function(t){var s=[];n.forEach((function(n){s.push(e[n][t-1])})),i[a][t]=r(o,s)+Math.min(i[a-1][t],i[a][t-1],i[a-1][t-1])},l=1;l<=e.arrayLength;l++)s(l)},l=1;l<=t.arrayLength;l++)s(l);for(var u=[],c=1;c<i.length;c++)u.push(i[c].slice(1,i[c].length));return u}function zf(t,e,n,r){var i=[];n=Math.max(n,Math.abs(t.length-e.length));for(var a=0;a<=t.length;a++){i[a]=[];for(var o=0;o<=e.length;o++)i[a][o]=1/0}i[0][0]=0;for(var s=1;s<=t.length;s++)for(var l=Math.max(1,s-n),u=Math.min(e.length,s+n),c=l;c<=u;c++)i[s][c]=0;for(var h=1;h<=t.length;h++)for(var d=Math.max(1,h-n),f=Math.min(e.length,h+n),p=d;p<=f;p++)i[h][p]=r(t[h-1],e[p-1])+Math.min(i[h-1][p],i[h][p-1],i[h-1][p-1]);for(var m=[],g=1;g<i.length;g++)m.push(i[g].slice(1,i[g].length));return m}function Ff(t,e,n,r,i){var a=[];n=Math.max(n,Math.abs(t.arrayLength-e.arrayLength));for(var o=0;o<=t.arrayLength;o++){a[o]=[];for(var s=0;s<=e.arrayLength;s++)a[o][s]=1/0}a[0][0]=0;for(var l=1;l<=t.arrayLength;l++)for(var u=Math.max(1,l-n),c=Math.min(e.arrayLength,l+n),h=u;h<=c;h++)a[l][h]=0;for(var d=function(o){var s=Math.max(1,o-n),l=Math.min(e.arrayLength,o+n),u=[];r.forEach((function(e){u.push(t[e][o-1])}));for(var c=function(t){var n=[];r.forEach((function(r){n.push(e[r][t-1])})),a[o][t]=i(u,n)+Math.min(a[o-1][t],a[o][t-1],a[o-1][t-1])},h=s;h<=l;h++)c(h)},f=1;f<=t.arrayLength;f++)d(f);for(var p=[],m=1;m<a.length;m++)p.push(a[m].slice(1,a[m].length));return p}function Bf(t){if(Array.isArray(t)){var e,n=t.length-1,r=t[0].length-1;for(e=[[n,r]];n>0||r>0;)n>0?r>0?t[n-1][r]<t[n-1][r-1]?t[n-1][r]<t[n][r-1]?(e.push([n-1,r]),n--):(e.push([n,r-1]),r--):t[n-1][r-1]<t[n][r-1]?(e.push([n-1,r-1]),n--,r--):(e.push([n,r-1]),r--):(e.push([n-1,r]),n--):(e.push([n,r-1]),r--);return e}var i={};for(var a in t){var o=void 0,s=t[a].length-1,l=t[a][0].length-1;for(o=[[s,l]];s>0||l>0;)s>0?l>0?t[a][s-1][l]<t[a][s-1][l-1]?t[a][s-1][l]<t[a][s][l-1]?(o.push([s-1,l]),s--):(o.push([s,l-1]),l--):t[a][s-1][l-1]<t[a][s][l-1]?(o.push([s-1,l-1]),s--,l--):(o.push([s,l-1]),l--):(o.push([s-1,l]),s--):(o.push([s,l-1]),l--);i[a]=o}return i}function Vf(t,e){if(Array.isArray(t)){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return Math.sqrt(n)}return Math.abs(t-e)}function jf(t){var e;switch(t){case"distance":e=function(t,e){return t.distance-e.distance};break;case"timeStamp":e=function(t,e){var n=t.start-e.start;return 0===n&&(n=t.id-e.id),n};break;case"data":e=function(t,e){var n=t.id-e.id;return 0===n&&(n=t.distance-e.distance),n};break;case"significance":e=function(t,e){return t.significance-e.significance};break;case"intensity":e=function(t,e){return t.intensity-e.intensity};break;case"angle":e=function(t,e){return t.angle-e.angle};break;case"diameter":e=function(t,e){return t.diameter-e.diameter};break;case"period":e=function(t,e){return t.period-e.period};break;case"anomalyDegree":e=function(t,e){return e.anomalyDegree-t.anomalyDegree};break;case"fileName":e=function(t,e){return e=(t=t.toString().toLowerCase()).toString().toLowerCase(),t<e?-1:t>e?1:0}}return e}function Hf(){var t=Rh.getMode(),e=document.getElementById("resultOrderList").options,n=0;if("AE"===t){for(n=0;n<e.length;n++)if("timeStamp"===e[n].value){document.getElementById("resultOrderList").selectedIndex=n;break}}else if("QBE"===t||"QBS"===t)for(n=0;n<e.length;n++)if("distance"===e[n].value){document.getElementById("resultOrderList").selectedIndex=n;break}ih(e[n].value)}function Uf(){"none"!==$("#QBESourceMain").css("display")&&bh(!1);var t=Rh.getOrder(),e=Rh.getKValue(),n=Rh.getDistanceThreshold(),r=Rh.getExtractionResults();if($("#topKResults").prop("disabled"))r.sort(jf(t));else{var a=Rh.getMode();"QBE"===a||"QBS"===a?r.sort(jf("distance")):"AE"===a&&Rh.getAEOptionStatus("anomaly")&&r.sort(jf("anomalyDegree")),""!==e&&(r=r.slice(0,e)),r.sort(jf(t))}""!==n&&(r=r.filter((function(t){return t.distance<n}))),function(t){hu.dispatch({type:"UPDATE_SHOWN_RESULTS",results:t})}(r);for(var s=Rh.getTarget(),l={},u={},c={},h={},d=0;d<s.length;d++)l[String(s[d])]=lc.getCameraProp(s[d]),u[String(s[d])]=lc.getFocused(s[d]),c[String(s[d])]=Ju.getData(s[d]).data.meta.min.z,h[String(s[d])]=document.getElementById("TimeTubes_viewport_"+s[d]),Nu(s[d]);for(var f,p,m,g=document.getElementById("resultsArea");g.firstChild;)o.a.unmountComponentAtNode(g.firstChild),g.removeChild(g.firstChild);for(var v=0;v<r.length;v++){var y=document.createElement("div");y.id="resultSummaryHolder_"+v,g.appendChild(y);var b=r[v];Bu(b.id,b.start-c[String(b.id)],b.period);var x=h[String(b.id)].height,_=h[String(b.id)].width,w=new Image;w.src=h[String(b.id)].toDataURL(),w.height=x,w.width=_,o.a.render(i.a.createElement(Of,{key:v,id:b.id,thumbnail:w,result:b,period:[b.start,b.start+b.period],distance:b.distance,path:b.path,rank:v}),y)}for(var S=0;S<s.length;S++)f=s[S],p=l[String(s[S])],m=u[String(s[S])],hu.dispatch({type:"RECOVER_TUBE",id:f,cameraProp:p,tubePos:m});r.length>0?$("#matchingStatus").text(r.length+" results are found"):$("#matchingStatus").text("No results are found")}function Gf(t,e,n){for(var r=Ju.getData(t).data.splines.value.points,i=r[e].y,a=r.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=0;o<a.length;o++)a[o]=i-a[o];for(var s=r.slice(e+1,e+n<r.length?e+n+1:r.length-1).map((function(t){return t.y})),l=0;l<s.length;l++)s[l]=i-s[l];var u=k(a),c=k(s);return u?c?(u+c)/2:u:c}function qf(t,e,n){for(var r=Ju.getData(t).data.splines.value.points,i=r[e].y,a=r.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=0;o<a.length;o++)a[o]=i-a[o];for(var s=r.slice(e+1,e+n<r.length?e+n+1:r.length-1).map((function(t){return t.y})),l=0;l<s.length;l++)s[l]=i-s[l];var u=P(a),c=P(s);return u?c?(u+c)/2:u:c}function Wf(t,e,n){var r=Ju.getData(t).data.splines.value.points,i=r[e].y,a=r.slice(e-n>=0?e-n:0,e).map((function(t){return t.y})),o=r.slice(e+1,e+n<r.length?e+n+1:r.length-1).map((function(t){return t.y})),s=i-P(a),l=i-P(o);return s?l?(s+l)/2:s:l}function $f(t,e){var n=Math.atan2(t.y-e.y,t.x-e.x);return n>=0?180*n/Math.PI:180*(2*Math.PI+n)/Math.PI}function Yf(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Qf(t){return t>=0&&t<90?1:t>=90&&t<180?2:t>=180&&t<270?3:4}function Xf(t){return t>=0?180*t/Math.PI:180*(2*Math.PI+t)/Math.PI}function Zf(t){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kf(t,e){return(Kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=np(t);if(e){var i=np(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ep(this,n)}}function ep(t,e){return!e||"object"!==Zf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function np(t){return(np=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kf(t,e)}(o,t);var e,n,r,a=tp(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={dragSelection:!0,queryMode:Rh.getMode(),selector:!0,source:-1,selectedInterval:[-1,-1],coordinate:"rectangular",DTWMode:"DTWD"},t.clusterCenter={},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#stepSizeOfSlidingWindow").val(5),Su.on("showExtractionSourcePanel",(function(e){t.setState({queryMode:"QBE"})})),Rh.on("updateSource",(function(){t.clusterCenter={},t.setState({source:Rh.getSource()})})),Rh.on("switchQueryMode",(function(e){t.setState({queryMode:e}),"block"===$("#resultDetailArea").css("display")&&xh(),"QBS"===e&&t.setState({DTWMode:"DTWD"}),""===$("#stepSizeOfSlidingWindow").val()&&$("#stepSizeOfSlidingWindow").val(5),"QBE"!==e&&(document.getElementById("sourceList").selectedIndex=0,"block"===$("#QBESourceMain").css("display")&&bh())})),Rh.on("updateSelectedPeriod",(function(){var e=Rh.getSelectedPeriod();e[1]-e[0]>0&&(t.clusterCenter={},t.setState({selectedInterval:e}),t.cancelDisablementOfNormalizationOption(),t.updateSelectedInterval())})),Rh.on("selectTimeInterval",(function(e,n){Number(t.state.source)===e&&(t.clusterCenter={},t.setState({selectedInterval:Rh.getSelectedPeriod()}),t.cancelDisablementOfNormalizationOption(),t.updateSelectedInterval())})),Rh.on("convertResultIntoQuery",(function(e,n,r){t.clusterCenter={},t.setState({source:e,selectedInterval:n}),t.cancelDisablementOfNormalizationOption()})),Rh.on("recoverQuery",(function(e){var n=Rh.getMode();if("AE"!==n){if(t.clusterCenter={},"QBE"===n){var r=Rh.getSelectedPeriod();t.setState({source:Rh.getSource(),selectedInterval:r,coordinate:e.parameters.coordinate,DTWMode:e.parameters.DTWType,queryMode:n}),"none"===$("#QBESourceMain").css("display")&&bh()}else"QBS"===n&&t.setState({coordinate:e.parameters.coordinate,DTWMode:e.parameters.DTWType,queryMode:n});var i=Rh.getParameters();t.cancelDisablementOfNormalizationOption(),$("#NormalizeSwitch").prop("checked",i.normalize);var a=document.getElementById("normalizationOptions");if(i.normalizationOption){for(var o=0;o<a.options.length;o++)if(a.options[o].value===i.normalizationOption){a.selectedIndex=o;break}}else a.selectedIndex=0;for(var s=document.getElementById("distanceMetric"),l=0;l<s.options.length;l++)if(s.options[l].value===i.distanceMetric){s.selectedIndex=l;break}var u=document.getElementById("distanceNormalization");if(i.distanceNormalization){for(var c=0;c<u.options.length;c++)if(u.options[c].value===i.distanceNormalization){u.selectedIndex=c;break}}else u.selectedIndex=0;$("#warpingWindowSize").val(i.warpingWindowSize),$("#targetLengthMin").val(i.timeSliceLength[0]),$("#targetLengthMax").val(i.timeSliceLength[1]),$("#stepSizeOfSlidingWindow").val(i.slidingWindow)}else t.setState({queryMode:n})})),Rh.on("changeDTWMode",(function(e){t.setState({DTWMode:e})})),Rh.on("convertClusterCenterIntoQuery",(function(e){t.clusterCenter=e,t.setState({source:-1})}))}},{key:"switchSelector",value:function(){this.setState({selector:!this.state.selector}),$c()}},{key:"switchDragSelection",value:function(){this.setState({dragSelection:!this.state.dragSelection}),hu.dispatch({type:"SWITCH_DRAGSELECTION"})}},{key:"switchQueryMode",value:function(t){Zc($("input[name=queryMode]:checked").val())}},{key:"switchDTWMode",value:function(){var t=$("input[name=DTWType]:checked").val();this.setState({DTWMode:t})}},{key:"switchCoordinate",value:function(){var t=$("input[name=coordinate]:checked").val();this.setState({coordinate:t})}},{key:"resetSelection",value:function(){Yc()}},{key:"selectTimeInterval",value:function(){var t=$("#selectTimeIntervalInput").val();isNaN(t)||""==t||Qc(this.state.source)}},{key:"updateSelectedInterval",value:function(){$("#selectedInterval").text("JD: "+this.state.selectedInterval[0].toFixed(3)+" - "+this.state.selectedInterval[1].toFixed(3)),$("#targetLengthMin").val(Math.floor(this.state.selectedInterval[1])-Math.ceil(this.state.selectedInterval[0])),$("#targetLengthMax").val(Math.floor(this.state.selectedInterval[1])-Math.ceil(this.state.selectedInterval[0]))}},{key:"updateActiveVariables",value:function(){Jc(_h())}},{key:"queryModes",value:function(){return i.a.createElement("div",{className:"featureElem"},i.a.createElement("h5",null,"Query mode"),i.a.createElement("form",{className:"form-check form-check-inline",id:"queryMode",onChange:this.switchQueryMode.bind(this)},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"QBE",name:"queryMode",className:"custom-control-input",value:"QBE",checked:"QBE"===this.state.queryMode,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"QBE"},"Query-by-example")),i.a.createElement("div",{className:"custom-control custom-radio",style:{marginLeft:"0.5rem"}},i.a.createElement("input",{type:"radio",id:"QBS",name:"queryMode",className:"custom-control-input",value:"QBS",checked:"QBS"===this.state.queryMode,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"QBS"},"Query-by-sketch"))))}},{key:"QBESelection",value:function(){return i.a.createElement("div",{className:"featureElem",id:"QBEArea",style:{display:"QBE"===this.state.queryMode?"block":"none"}},i.a.createElement(df,null))}},{key:"QBSSelection",value:function(){var t=[];return Ju.getAllData().forEach((function(e){t.push(e.data.lookup)})),i.a.createElement("div",{className:"featureElem",id:"QBSArea",style:{display:"QBS"===this.state.queryMode?"block":"none"}},i.a.createElement(Sf,{xItem:"x",yItem:"y"}))}},{key:"selectionDetail",value:function(){var t,e;if("QBE"===this.state.queryMode&&(t=i.a.createElement(af,{sourceId:this.state.source})),"QBE"===this.state.queryMode){var n="";this.state.selectedInterval[0]>0&&this.state.selectedInterval[1]>0&&(n="JD: "+this.state.selectedInterval[0].toFixed(3)+" - "+this.state.selectedInterval[1].toFixed(3)),e=i.a.createElement("div",{className:"featureElem",style:{position:"relative"}},i.a.createElement("h5",null,"Selection Detail"),i.a.createElement("span",{id:"selectedInterval"},n),i.a.createElement("div",{id:"selectedIntervalViewArea"},t))}return e}},{key:"matchingControllers",value:function(){var t=[];if(this.state.source>=0){var e=Ju.getData(Number(this.state.source)).data.lookup,n=Rh.getActive();if(0===n.length)for(var r in e){var a="";"z"!==r&&"PA"!==r&&"PD"!==r&&(a=e[r].length>1?e[r].join(","):e[r],t.push(i.a.createElement("div",{className:"form-check form-check-inline",key:r},i.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:r,id:"QBEActive_"+r}),i.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+r},a))))}else if(n.length>0)for(var o in e){var s="";if(s=e[o].length>1?e[o].join(","):e[o],"z"!==o&&"PA"!==o&&"PD"!==o){var l=n.indexOf(o)>=0;t.push(i.a.createElement("div",{className:"form-check form-check-inline",key:o},i.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:o,defaultChecked:l,id:"QBEActive_"+o}),i.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+o},s)))}}}else if(this.state.source<0&&Object.keys(this.clusterCenter).length>0){for(var u={},c=Rh.getTarget(),h=Rh.getActive(),d=this.clusterCenter.parameters.variables,f=0;f<c.length;f++)for(var p=Ju.getData(c[f]).data.lookup,m=0;m<d.length;m++)if(u[d[m]])for(var g=0;g<p[d[m]].length;g++)u[d[m]].push(p[d[m]][g]);else{u[d[m]]=[];for(var v=0;v<p[d[m]].length;v++)u[d[m]].push(p[d[m]][v])}for(var y in u){var b="";if(b=u[y].length>1?u[y].join(","):u[y],"z"!==y&&"PA"!==y&&"PD"!==y){var x=h.indexOf(y)>=0;t.push(i.a.createElement("div",{className:"form-check form-check-inline",key:y},i.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"QBEActive",value:y,defaultChecked:x,id:"QBEActive_"+y}),i.a.createElement("label",{className:"form-check-label",htmlFor:"QBEActive_"+y},b)))}}}return i.a.createElement("div",{className:"featureElem",style:{position:"relative"}},i.a.createElement("h5",{onClick:this.collapseMatchingOptions},"Matching"),i.a.createElement("div",{id:"matchingOptionsMain"},i.a.createElement("div",{id:"activeVariablesArea",style:{display:"QBE"===this.state.queryMode?"block":"none"}},i.a.createElement("h6",null,"Active variables"),i.a.createElement("form",{id:"QBEActiveVariables",onChange:this.updateActiveVariables.bind(this)},t)),i.a.createElement("h6",null,"Computation"),i.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},i.a.createElement("div",{className:"row matchingOption",style:{paddingLeft:"15px",paddingRight:"15px"}},i.a.createElement("div",{className:"col-5",style:{paddingLeft:"0"}},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"NormalizeSwitch"}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"NormalizeSwitch"},"Normalize"))),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"normalizationOptions",style:{width:"60%"}},i.a.createElement("option",{value:"minmax"},"Min-max"),i.a.createElement("option",{value:"centralize"},"Centralize"),i.a.createElement("option",{value:"zScore"},"z-score")))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col"},i.a.createElement("form",{className:"form-check form-inline",id:"coordinate",onChange:this.switchCoordinate.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"rectangularCoordinate",name:"coordinate",value:"rectangular",checked:"rectangular"===this.state.coordinate,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"rectangularCoordinate"},"Rectangular coordinate")),i.a.createElement("div",{className:"custom-control custom-radio",style:{marginLeft:"1.5rem"}},i.a.createElement("input",{type:"radio",id:"polarCoordinate",name:"coordinate",value:"polar",checked:"polar"===this.state.coordinate,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"polarCoordinate"},"Polar coordinate")))))),i.a.createElement("h6",null,"Settings of DTW"),i.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Distance metric"),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"distanceMetric",style:{width:"60%"}},i.a.createElement("option",{value:"Euclidean"},"Euclidean")))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Distance normalization"),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"distanceNormalization",style:{width:"60%"}},i.a.createElement("option",{value:"none"},"None"),i.a.createElement("option",{value:"warpingPathLength"},"Warping path length"),i.a.createElement("option",{value:"minLength"},"Minimum length"),i.a.createElement("option",{value:"maxLength"},"Maximum length"),i.a.createElement("option",{value:"timeNormalization"},"Time normalization"),i.a.createElement("option",{value:"pathLengthRatio"},"Warping path ratio")))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Warping window size"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"window size",id:"warpingWindowSize",style:{width:"40%",marginRight:"0.5rem"}}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Length of the target time series"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"targetLengthMin",style:{width:"20%",marginRight:"0.5rem"},required:!0}),"~",i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"targetLengthMax",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Step size of sliding window"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"step size",id:"stepSizeOfSlidingWindow",style:{width:"40%",marginRight:"0.5rem"},required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Type of DTW"),i.a.createElement("div",{className:"col"},i.a.createElement("form",{className:"form-check",id:"DTWType",onChange:this.switchDTWMode.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"DTWI",name:"DTWType",value:"DTWI",checked:"DTWI"===this.state.DTWMode,disabled:"QBS"===this.state.queryMode,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWI"},"DTW",i.a.createElement("sub",null,"I"))),i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"DTWD",name:"DTWType",value:"DTWD",checked:"DTWD"===this.state.DTWMode,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWD"},"DTW",i.a.createElement("sub",null,"D"))))))),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runMatchingBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run")))}},{key:"cancelDisablementOfNormalizationOption",value:function(){$("#NormalizeSwitch").prop("disabled",!1),$("#normalizationOptions").prop("disabled",!1)}},{key:"collapseMatchingOptions",value:function(){$("#matchingOptionsMain").slideToggle()}},{key:"clickRunButton",value:function(){$("#topKLabelResults").text("Top "+Rh.getKValue()+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){this.runMatching()}.bind(this),0)}},{key:"runMatching",value:function(){var t=$("#NormalizeSwitch").prop("checked"),e=document.getElementById("normalizationOptions"),n=e.selectedIndex,r=e.options[n].value,i=document.getElementById("distanceMetric"),a=i.selectedIndex,o=i.options[a].value,s=document.getElementById("distanceNormalization"),l=s.selectedIndex,u=s.options[l].value,c=$("#warpingWindowSize").val();c=""===c?0:Number(c);var h=$("#targetLengthMin").val(),d=$("#targetLengthMax").val();h=""===h?0:Number(h),d=""===d?0:Number(d);var f=$("#stepSizeOfSlidingWindow").val();f=""===f?1:Number(f);var p=$("input[name=DTWType]:checked").val(),m=Rh.getTarget();switch(this.state.queryMode){case"QBE":var g=Number(this.state.source);if(m.length>0)if(0===Object.keys(this.clusterCenter).length){var v,y=Rh.getSelectedPeriod(),b=_h();if(v={normalize:t,normalizationOption:r,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p},NaN!==g){var x=function(t,e,n,r){var i=[Math.floor(e[0]),Math.ceil(e[1])],a=Ju.getData(t).data.meta.min.z,o=(Ju.getData(t).data.lookup,{}),s=[];if(s=n,"rectangular"===r){for(var l=0;l<s.length;l++)o[s[l]]=[];for(var u=i[0];u<=i[1];u++){var c=Ju.getValues(t,u-a);for(var h in o)"z"!==h?o[h].push(c[h]):"z"===h&&o[h].push(u)}o.minJD=i[0],o.arrayLength=i[1]-i[0]+1}else if("polar"===r){if(s.indexOf("x")<0||s.indexOf("y")<0)return alert("To use the polar coordinate for computing similarities, you cannot ignore the Stokes parameters (Q/I and U/I)."),!1;for(var d=0;d<s.length;d++)o[s[d]]=[];o.r=[],o.theta=[];for(var f=i[0];f<=i[1];f++){var p=Ju.getValues(t,f-a),m=Math.sqrt(Math.pow(p.x,2)+Math.pow(p.y,2)),g=Xf(Math.atan2(p.y,p.x));for(var v in o)"r"===v?o[v].push(m):"theta"===v?o[v].push(g):"z"!==v?o[v].push(p[v]):"z"===v&&o[v].push(f)}o.minJD=i[0],o.arrayLength=i[1]-i[0]+1}return{mode:"visual query",option:"query-by-example",query:{source:Ju.getData(Number(Rh.getSource())).name,period:i,activeVariables:n},values:o}}(g,y,b,this.state.coordinate);x&&(Kc(v,function(t,e,n){for(var r=[],i=e[1]-e[0],a=0;a<n.length;a++)if(t===n[a].id){var o=0;e[0]<=n[a].start&&n[a].start<=e[1]?o=e[1]-n[a].start:e[0]<=n[a].start+n[a].period&&n[a].start+n[a].period<=e[1]?o=n[a].start+n[a].period-e[0]:n[a].start<=e[0]&&e[1]<=n[a].start+n[a].period?o=i:e[0]<=n[a].start&&n[a].start+n[a].period<=e[1]&&(o=n[a].period),o/i<.3&&r.push(n[a])}else r.push(n[a]);return r}(g,y,function(t,e,n){var r,i=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":r=Vf}a&&(t=Rf(o,t));for(var f=function(n){var s=e[n],f=Ju.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Xf(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0],x=[];if(t.r)for(var _ in t)"x"!==_&&"y"!==_&&Array.isArray(t[_])&&"z"!==_&&x.push(_);else for(var w in t)Array.isArray(t[w])&&"z"!==w&&x.push(w);switch(i){case"DTWI":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],i=function(i){if(e+i>f.arrayLength-1)return"break";var s=0,u={};x.forEach((function(n){if(Array.isArray(f[n])&&"z"!==n){var c=f[n].slice(e,e+i);a&&(c="theta"!==n?Rf(o,c):Lf(o,c));var d=zf(t[n],c,l,r);switch(u[n]=Bf(d),h){case"none":s+=d[t[n].length-1][c.length-1];break;case"warpingPathLength":s+=d[t[n].length-1][c.length-1]/u[n].length;break;case"minLength":s+=d[t[n].length-1][c.length-1]/Math.min(t.arrayLength,i);break;case"maxLength":s+=d[t[n].length-1][c.length-1]/Math.max(t.arrayLength,i);break;case"timeNormalization":for(var p=0,m=0,g=0,v=0;v<u[n].length-1;v++)p+=(g=u[n][v][0]-u[n][v+1][0]+(u[n][v][1]-u[n][v+1][1]))*(d[u[n][v][1]][u[n][v][0]]-d[u[n][v+1][1]][u[n][v+1][0]]),m+=g;p+=(g=1)*d[0][0],s+=p/=m+=g;break;case"pathLengthRatio":s+=d[t[n].length-1][c.length-1]/(u[n].length/(t.arrayLength+i))}}})),n.push({dist:s,path:u})},p=c[0];p<=c[1]&&"break"!==i(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++)n[v].dist<g.dist&&(g=n[v],m=v);g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},i=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(s){if(Array.isArray(f[s])&&"z"!==s){var l=f[s].slice(e,e+i);a&&(l="theta"!==s?Rf(o,l):Lf(o,l));var u=If(t[s],l,r);n[s]=u}}));for(var l=i-c[0]+1,p=[],m=1;m<=l;m++){var g=0,v={};for(var y in n){for(var _=n[y][0].length-l+m,w=[],S=0;S<n[y].length;S++)w.push(n[y][S].slice(0,_));switch(v[y]=Bf(w),h){case"none":g+=w[t.arrayLength-1][_-1];break;case"warpingPathLength":g+=w[t.arrayLength-1][_-1]/v[y].length;break;case"minLength":g+=w[t.arrayLength-1][_-1]/Math.min(t.arrayLength,_);break;case"maxLength":g+=w[t.arrayLength-1][_-1]/Math.max(t.arrayLength,_);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<v[y].length-1;T++)E+=(C=v[y][T][0]-v[y][T+1][0]+(v[y][T][1]-v[y][T+1][1]))*(w[v[y][T][1]][v[y][T][0]]-w[v[y][T+1][1]][v[y][T+1][0]]),M+=C;E+=(C=1)*w[0][0],g+=E/=M+=C;break;case"pathLengthRatio":g+=w[t.arrayLength-1][_-1]/(v[y].length/(t.arrayLength+_))}}p.push({dist:g,paths:v})}for(var k=0,P={dist:1/0},A=0;A<p.length;A++)p[A].dist<P.dist&&(P=p[A],k=A);P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.paths}),e+=u};e<f.arrayLength-c[0];)n()}();break;case"DTWD":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],i=function(i){if(e+i>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+i)})),s.arrayLength=i,a&&(s=Rf(o,s)),n.push(Ff(t,s,l,x,r))},p=c[0];p<=c[1]&&"break"!==i(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Bf(n[v]),_=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":_/=y.length;break;case"minLength":_/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":_/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var w=0,S=0,E=0,M=0;M<y.length-1;M++)w+=(E=y[M][0]-y[M+1][0]+(y[M][1]-y[M+1][1]))*(n[v][y[M][1]][y[M][0]]-n[v][y[M+1][1]][y[M+1][0]]),S+=E;w+=(E=1)*n[v][0][0],_=w/=S+=E;break;case"pathLengthRatio":_/=y.length/(t.arrayLength+target.arrayLength)}_<g.dist&&(g={dist:_,path:y},m=v)}g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},i=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e-1;x.forEach((function(t){n[t]=f[t].slice(e,e+i)})),n.arrayLength=i,a&&(n=Rf(o,n));for(var l=Df(t,n,x,r),p=i-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var _=Bf(v),w=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":w/=_.length;break;case"minLength":w/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":w/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<_.length-1;C++)S+=(M=_[C][0]-_[C+1][0]+(_[C][1]-_[C+1][1]))*(v[_[C][1]][_[C][0]]-v[_[C+1][1]][_[C+1][0]]),E+=M;S+=(M=1)*v[0][0],M+=M,w=S/=E;break;case"pathLengthRatio":w/=_.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:w,path:_})}for(var T=0,k={dist:1/0},P=1;P<m.length;P++)m[P].dist<k.dist&&(k=m[P],T=P);k.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+T,distance:k.dist,path:k.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(x.values,m,v)),x,b),Hf())}Uf()}else Promise.resolve().then((function(){var t;t="featureExtraction",hu.dispatch({type:"SHOW_RESULTS_PANEL",resultsPanel:t})})).then(function(){var e;e={normalize:t,normalizationOption:r,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p};for(var n=_h(),i={},a=0;a<n.length;a++)i[n[a]]=this.clusterCenter.values[n[a]];i.arrayLength=this.clusterCenter.values.arrayLength;var s={mode:"visual query",option:"query-by-example",query:{source:"clustering",activeVariables:n},values:i};Kc(e,function(t,e,n){var r,i=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":r=Vf}for(var f=function(n){var s=e[n],f=Ju.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Xf(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0],x=[];if(t.r)for(var _ in t)"x"!==_&&"y"!==_&&Array.isArray(t[_])&&"z"!==_&&x.push(_);else for(var w in t)Array.isArray(t[w])&&"z"!==w&&x.push(w);switch(i){case"DTWI":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],i=function(i){if(e+i>f.arrayLength-1)return"break";var s=0,u={};x.forEach((function(n){if(Array.isArray(f[n])&&"z"!==n){var c=f[n].slice(e,e+i);a&&(c="theta"!==n?Rf(o,c):Lf(o,c));var d=zf(t[n],c,l,r);switch(u[n]=Bf(d),h){case"none":s+=d[t[n].length-1][c.length-1];break;case"warpingPathLength":s+=d[t[n].length-1][c.length-1]/u[n].length;break;case"minLength":s+=d[t[n].length-1][c.length-1]/Math.min(t.arrayLength,i);break;case"maxLength":s+=d[t[n].length-1][c.length-1]/Math.max(t.arrayLength,i);break;case"timeNormalization":for(var p=0,m=0,g=0,v=0;v<u[n].length-1;v++)p+=(g=u[n][v][0]-u[n][v+1][0]+(u[n][v][1]-u[n][v+1][1]))*(d[u[n][v][1]][u[n][v][0]]-d[u[n][v+1][1]][u[n][v+1][0]]),m+=g;p+=(g=1)*d[0][0],s+=p/=m+=g;break;case"pathLengthRatio":s+=d[t[n].length-1][c.length-1]/(u[n].length/(t.arrayLength+i))}}})),n.push({dist:s,path:u})},p=c[0];p<=c[1]&&"break"!==i(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++)n[v].dist<g.dist&&(g=n[v],m=v);g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},i=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(s){if(Array.isArray(f[s])&&"z"!==s){var l=f[s].slice(e,e+i);a&&(l="theta"!==s?Rf(o,l):Lf(o,l));var u=If(t[s],l,r);n[s]=u}}));for(var l=i-c[0]+1,p=[],m=1;m<=l;m++){var g=0,v={};for(var y in n){for(var _=n[y][0].length-l+m,w=[],S=0;S<n[y].length;S++)w.push(n[y][S].slice(0,_));switch(v[y]=Bf(w),h){case"none":g+=w[t.arrayLength-1][_-1];break;case"warpingPathLength":g+=w[t.arrayLength-1][_-1]/v[y].length;break;case"minLength":g+=w[t.arrayLength-1][_-1]/Math.min(t.arrayLength,_);break;case"maxLength":g+=w[t.arrayLength-1][_-1]/Math.max(t.arrayLength,_);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<v[y].length-1;T++)E+=(C=v[y][T][0]-v[y][T+1][0]+(v[y][T][1]-v[y][T+1][1]))*(w[v[y][T][1]][v[y][T][0]]-w[v[y][T+1][1]][v[y][T+1][0]]),M+=C;E+=(C=1)*w[0][0],g+=E/=M+=C;break;case"pathLengthRatio":g+=w[t.arrayLength-1][_-1]/(v[y].length/(t.arrayLength+_))}}p.push({dist:g,paths:v})}for(var k=0,P={dist:1/0},A=0;A<p.length;A++)p[A].dist<P.dist&&(P=p[A],k=A);P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.paths}),e+=u};e<f.arrayLength-c[0];)n()}();break;case"DTWD":l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],i=function(i){if(e+i>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+i)})),s.arrayLength=i,a&&(s=Rf(o,s)),n.push(Ff(t,s,l,x,r))},p=c[0];p<=c[1]&&"break"!==i(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Bf(n[v]),_=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":_/=y.length;break;case"minLength":_/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":_/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var w=0,S=0,E=0,M=0;M<y.length-1;M++)w+=(E=y[M][0]-y[M+1][0]+(y[M][1]-y[M+1][1]))*(n[v][y[M][1]][y[M][0]]-n[v][y[M+1][1]][y[M+1][0]]),S+=E;w+=(E=1)*n[v][0][0],_=w/=S+=E;break;case"pathLengthRatio":_/=y.length/(t.arrayLength+target.arrayLength)}_<g.dist&&(g={dist:_,path:y},m=v)}g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},i=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e-1;x.forEach((function(t){n[t]=f[t].slice(e,e+i)})),n.arrayLength=i,a&&(n=Rf(o,n));for(var l=Df(t,n,x,r),p=i-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var _=Bf(v),w=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":w/=_.length;break;case"minLength":w/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":w/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<_.length-1;C++)S+=(M=_[C][0]-_[C+1][0]+(_[C][1]-_[C+1][1]))*(v[_[C][1]][_[C][0]]-v[_[C+1][1]][_[C+1][0]]),E+=M;S+=(M=1)*v[0][0],M+=M,w=S/=E;break;case"pathLengthRatio":w/=_.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:w,path:_})}for(var T=0,k={dist:1/0},P=1;P<m.length;P++)m[P].dist<k.dist&&(k=m[P],T=P);k.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+T,distance:k.dist,path:k.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(i,m,e),s,n),Hf()}.bind(this)).then((function(){Uf()}));break;case"QBS":if(m.length>0){var _,w=Rh.getQuery(),S=[];for(var E in w.values)if(Array.isArray(w.values[E])){if(w.values[E].indexOf(null)<0){S.push(E);continue}for(var M=!0,C=0;C<w.values[E].length;C++)if(null!==w.values[E][C]){M=!1;break}M||S.push(E)}_={normalize:t,normalizationOption:r,coordinate:this.state.coordinate,distanceMetric:o,distanceNormalization:u,warpingWindowSize:c,timeSliceLength:[h,d],slidingWindow:f,DTWType:p},"polar"===this.state.coordinate&&(w.values=function(t){var e=Object.keys(t),n={};if(e.indexOf("x")<0||e.indexOf("y")<0)return alert("To use the polar coordinate for computing similarities, you cannot ignore the Stokes parameters (Q/I and U/I)."),!1;if(t.x.indexOf(null)>=0||t.y.indexOf(null)>=0)return alert("To use the polar coordinate for computing similarities, you have to assign Q/I and U/I to x axis, y axis, or width."),!1;for(var r=[],i=[],a=0;a<t.arrayLength;a++){var o=Math.sqrt(Math.pow(t.x[a],2)+Math.pow(t.y[a],2)),s=Xf(Math.atan2(t.y[a],t.x[a]));r.push(o),i.push(s)}for(var l in n.r=r,n.theta=i,t)n[l]=t[l];return n}(w.values)),w.values&&(Kc(_,function(t,e,n){var r,i=n.DTWType,a=n.normalize,o=n.normalizationOption,s=n.distanceMetric,l=n.warpingWindowSize,u=n.slidingWindow,c=n.timeSliceLength,h=n.distanceNormalization,d=[];switch(s){case"Euclidean":r=Vf}a&&(t=Rf(o,t));for(var f=function(n){var s=e[n],f=Ju.getDataArray(s,1);if(t.r){for(var p={},m=[],g=[],v=0;v<f.arrayLength;v++)m.push(Math.sqrt(Math.pow(f.x[v],2)+Math.pow(f.y[v],2))),g.push(Xf(Math.atan2(f.y[v],f.x[v])));for(var y in p.r=m,p.theta=g,f)p[y]=f[y];f=p}var b=f.z[0];switch(i){case"DTWD":var x=[],_=[];if(t.r)for(var w in t)"x"!==w&&"y"!==w&&(Array.isArray(t[w])&&t[w].indexOf(null)<0&&"z"!==w?x.push(w):Array.isArray(t[w])&&t[w].indexOf(null)>=0&&_.push(w));else for(var S in t)Array.isArray(t[S])&&t[S].indexOf(null)<0&&"z"!==S?x.push(S):Array.isArray(t[S])&&t[S].indexOf(null)>=0&&_.push(S);l>0?function(){for(var e=0;e<f.arrayLength-c[0];){for(var n=[],i=function(i){if(e+i>f.arrayLength-1)return"break";var s={};x.forEach((function(t){s[t]=f[t].slice(e,e+i)})),s.arrayLength=i,a&&(s=Rf(o,s)),n.push(Ff(t,s,l,x,r))},p=c[0];p<=c[1]&&"break"!==i(p);p++);for(var m=0,g={dist:1/0},v=0;v<n.length;v++){var y=Bf(n[v]),w=n[v][n[v].length-1][n[v][0].length-1];switch(h){case"none":break;case"warpingPathLength":w/=y.length;break;case"minLength":w/=Math.min(t.arrayLength,target.arrayLength);break;case"maxLength":w/=Math.max(t.arrayLength,target.arrayLength);break;case"timeNormalization":for(var S=0,E=0,M=0,C=0;C<y.length-1;C++)S+=(M=y[C][0]-y[C+1][0]+(y[C][1]-y[C+1][1]))*(n[v][y[C][1]][y[C][0]]-n[v][y[C+1][1]][y[C+1][0]]),E+=M;S+=(M=1)*n[v][0][0],w=S/=E+=M;break;case"pathLengthRatio":w/=y.length/(t.arrayLength+target.arrayLength)}w<g.dist&&(g={dist:w,path:y},m=v)}var T=!0;for(var k in _){for(var P=0;P<t[_[k]].length;P++){if(t[_[k]][P])for(var A=0;A<g.path.length&&!(g.path[A][1]<P);A++)if(g.path[A][1]===P){var O=f[_[k]][e+g.path[A][0]];if(O<t[_[k]][P][0]||t[_[k]][P][1]<O){T=!1;break}}if(!T)break}if(!T)break}T&&g.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+m,distance:g.dist,path:g.path}),e+=u}}():function(){for(var e=0,n=function(){var n={},i=e+c[1]<f.arrayLength-1?c[1]:f.arrayLength-e;x.forEach((function(t){n[t]=f[t].slice(e,e+i)})),n.arrayLength=i,a&&(n=Rf(o,n));for(var l=Df(t,n,x,r),p=i-c[0]+1,m=[],g=1;g<=p;g++){for(var v=[],y=0;y<l.length;y++)v.push(l[y].slice(0,n.arrayLength-1-p+g+1));var w=Bf(v),S=v[t.arrayLength-1][n.arrayLength-1-p+g];switch(h){case"none":break;case"warpingPathLength":S/=w.length;break;case"minLength":S/=Math.min(t.arrayLength,n.arrayLength-p+g);break;case"maxLength":S/=Math.max(t.arrayLength,n.arrayLength-p+g);break;case"timeNormalization":for(var E=0,M=0,C=0,T=0;T<w.length-1;T++)E+=(C=w[T][0]-w[T+1][0]+(w[T][1]-w[T+1][1]))*(v[w[T][1]][w[T][0]]-v[w[T+1][1]][w[T+1][0]]),M+=C;E+=(C=1)*v[0][0],C+=C,S=E/=M;break;case"pathLengthRatio":S/=w.length/(t.arrayLength+n.arrayLength-p+g)}m.push({dist:S,path:w})}for(var k=0,P={dist:1/0},A=0;A<m.length;A++)m[A].dist<P.dist&&(P=m[A],k=A);var O=!0;for(var N in _){for(var R=0;R<t[_[N]].length;R++){if(t[_[N]][R])for(var L=0;L<P.path.length&&!(P.path[L][1]<R);L++)if(P.path[L][1]===R){var I=f[_[N]][e+P.path[L][0]];if(I<t[_[N]][R][0]||t[_[N]][R][1]<I){O=!1;break}}if(!O)break}if(!O)break}O&&P.dist!==1/0&&d.push({id:s,start:e+b,period:c[0]+k,distance:P.dist,path:P.path}),e+=u};e<f.arrayLength-c[0];)n()}()}},p=0;p<e.length;p++)f(p);return d}(w.values,m,_),w,S),Hf())}Uf()}}},{key:"render",value:function(){return i.a.createElement("div",{id:"featureArea",className:"controllersElem featureArea"},this.queryModes(),i.a.createElement("div",{id:"queryModes"},this.QBESelection(),this.QBSSelection()),this.selectionDetail(),this.matchingControllers())}}])&&Jf(e.prototype,n),r&&Jf(e,r),o}(i.a.Component);function ip(t){return(ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ap(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function op(t,e){return(op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=up(t);if(e){var i=up(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lp(this,n)}}function lp(t,e){return!e||"object"!==ip(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function up(t){return(up=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&op(t,e)}(o,t);var e,n,r,a=sp(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).gaussMargin={top:10,bottom:10,left:10,right:10},e.state={flare:!1,flareOption:"automatic AveAve",rotation:!1,anomaly:!1},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;document.getElementById("weightForAverageList").selectedIndex="2",document.getElementById("stdConstraintsList").selectedIndex="1",this.setGaussCurve(),this.setDefaultValues(),Rh.on("recoverQuery",(function(e){if("AE"===Rh.getMode()){var n=!1,r=t.state.flareOption,i=!1,a=!1;if(e.option.indexOf("flare")>=0&&(n=!0,"threshold"in e.query?(r="manual",$("#flareThreshold").val(e.query.threshold)):(r="automatic "+e.query.peakFunction,$("#flareLookaround").val(e.query.lookaround),$("#flareSensitivity").val(e.query.sensitivity),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peak"+e.query.peakFunction).addClass("selected"))),e.option.indexOf("rotation")>=0){i=!0,$("#rotationPeriodMin").val(e.query.rotationPeriod[0]),$("#rotationPeriodMax").val(e.query.rotationPeriod[1]),$("#rotationDiameter").val(e.query.rotationDiameter),$("#rotationAngle").val(e.query.rotationAngle);for(var o=document.getElementById("stdConstraintsList"),s=o.options,l=0;l<s.length;l++)if(s[l].value===e.query.stdOfthePeriod){o.selectedIndex=l;break}for(var u=document.getElementById("weightForAverageList"),c=u.options,h=0;h<c.length;h++)if(c[h].value===e.query.weightForAverage){u.selectedIndex=h;break}}e.option.indexOf("anomaly")>=0&&(a=!0),t.setState({flare:n,flareOption:r,rotation:i,anomaly:a})}}))}},{key:"setDefaultValues",value:function(){$("#flareLookaround").val(3),$("#flareSensitivity").val(2),$("#rotationPeriodMin").val(20),$("#rotationPeriodMax").val(30),$("#rotationAngle").val(270),$("#alphaES").val(.5)}},{key:"setGaussCurve",value:function(){var t=150-this.gaussMargin.left-this.gaussMargin.right,e=150-this.gaussMargin.top-this.gaussMargin.bottom,n=se("#gaussCurveArea").append("svg").attr("width",150).attr("height",150).attr("id","gaussCurve");n.append("rect").attr("width",t).attr("height",e).style("fill","none").style("stroke","lightgray").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")"),this.xScaleGauss=Na().range([0,t]),this.yScaleGauss=Na().range([e,0]);var r=document.getElementById("weightForAverageList"),i=r.selectedIndex,a=r.options[i].value,o=_c(Number(a));this.xScaleGauss.domain([A(o,(function(t){return t.x})),k(o,(function(t){return t.x}))]),this.yScaleGauss.domain([A(o,(function(t){return t.y})),k(o,(function(t){return t.y}))]),this.gaussPath=n.append("path").datum(o).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","gaussCurvePath").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")").attr("d",Qs().x(function(t){return this.xScaleGauss(t.x)}.bind(this)).y(function(t){return this.yScaleGauss(t.y)}.bind(this)).curve(al))}},{key:"updateWeight",value:function(){se("#gaussCurvePath").remove();var t=document.getElementById("weightForAverageList"),e=t.selectedIndex,n=t.options[e].value,r=_c(Number(n));this.xScaleGauss.domain([A(r,(function(t){return t.x})),k(r,(function(t){return t.x}))]),this.yScaleGauss.domain([A(r,(function(t){return t.y})),k(r,(function(t){return t.y}))]),this.gaussPath=se("#gaussCurve").append("path").datum(r).style("fill","none").style("stroke","lightcoral").style("stroke-width",3).attr("id","gaussCurvePath").attr("transform","translate("+this.gaussMargin.left+","+this.gaussMargin.top+")").attr("d",Qs().x(function(t){return this.xScaleGauss(t.x)}.bind(this)).y(function(t){return this.yScaleGauss(t.y)}.bind(this)).curve(al))}},{key:"clickRunButton",value:function(){$("#topKLabelResults").text("Top "+Rh.getKValue()+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){this.runAutomaticExtraction()}.bind(this),0)}},{key:"runAutomaticExtraction",value:function(){var t,e,n,r=Rh.getTarget(),i={mode:"automatic extraction",option:[],query:{}};if(this.state.flare){i.option.push("flare");var a=this.state.flareOption.split(" ")[0];if("automatic"===a){var o=this.state.flareOption.split(" ")[1],s=$("#flareLookaround").val(),l=$("#flareSensitivity").val();""!==s&&""!==l&&(t=function(t,e,n,r){for(var i=[],a=0;a<t.length;a++){for(var o=t[a],s=Ju.getData(o),l=[],u=void 0,c=0;c<s.data.splines.value.points.length;c++){switch(e){case"AveMaximum":u=Gf(o,c,n);break;case"AveAve":u=qf(o,c,n);break;case"AveDist":u=Wf(o,c,n)}l.push({index:c,significance:u,V:s.data.splines.value.points[c].y})}for(var h=l.filter((function(t){return t.significance>0})),d=P(h,(function(t){return t.significance})),p=f(h,(function(t){return t.significance})),m=0;m<h.length;m++)h[m].significance-d>r*p&&i.push({id:o,start:s.data.splines.value.points[h[m].index].z,significance:h[m].significance,V:h[m].V})}return i}(r,o,s=Number(s),l=Number(l))),i.query.lookaround=s,i.query.sensitivity=l,i.query.peakFunction=o}else"manual"===a&&(t=function(t,e){for(var n=[],r=0;r<t.length;r++)for(var i=t[r],a=Ju.getData(i),o=0;o<a.data.splines.value.points.length;o++)a.data.splines.value.points[o].y>=e&&n.push({id:i,start:a.data.splines.value.points[o].z,V:a.data.splines.value.points[o].y});return n}(r,Number($("#flareThreshold").val())),i.query.threshold=Number($("#flareThreshold").val()))}if(this.state.rotation){i.option.push("rotation");var u=[Number($("#rotationPeriodMin").val()),Number($("#rotationPeriodMax").val())],c=$("#rotationDiameter").val(),h=$("#rotationAngle").val(),d=$("#alphaES").val();c=""===c?0:Number(c),h=""===h?0:Number(h),d=""===d?.1:Number(d);var p=document.getElementById("stdConstraintsList"),m=p.selectedIndex,g=p.options[m].value,v=document.getElementById("weightForAverageList");m=v.selectedIndex;var y=Number(v.options[m].value);e=function(t,e,n,r,i,a,o){for(var s=[],l=0;l<t.length;l++){for(var u=t[l],c=Ju.getData(u).data.splines.position.points,h=[],d=0;d<c.length;d++){for(var f=[],p=e[0];p<=e[1]&&!(c[d].z+p>c[c.length-1].z);p++){for(var m=!1,g=1;d+g<c.length&&c[d+g].z-c[d].z<p;g++)if(c[d+g].z-c[d+g-1].z>5){m=!0;break}var v={x:0,y:0},y=[];if(0===i){for(var b=0;b<p;b++){var x=Ju.getValues(u,c[d].z+b-c[0].z);y.push(x),v.x+=x.x,v.y+=x.y}v.x/=p,v.y/=p}else{for(var _=8/p,w=-4,S=0,E=0;E<p;E++){var M=Ju.getValues(u,c[d].z+E-c[0].z);y.push(M);var C=wc(w,i);v.x+=C*M.x,v.y+=C*M.y,S+=C,w+=_}v.x/=S,v.y/=S}for(var T={x:0,y:0},k={x:y[0].x,y:y[0].y},P={x:y[0].x,y:y[0].y},A=[],O=[],N=0;N<p;N++){var R={x:y[N].x,y:y[N].y},L=$f(R,v),I=Yf(R,v);A.push({z:y[N].z,angle:L}),O.push({z:y[N].z,degree:I}),T.x+=Math.pow(y[N].x-v.x,2),T.y+=Math.pow(y[N].y-v.y,2),y[N].x<k.x&&(k.x=y[N].x),P.x<y[N].x&&(P.x=y[N].x),y[N].y<k.y&&(k.y=y[N].y),P.y<y[N].y&&(P.y=y[N].y)}var D={x:Math.sqrt(T.x/p),y:Math.sqrt(T.y/p)};if(!m&&(P.x-k.x>n||P.y-k.y>n)){var z=Ju.getData(u).data.meta.std.x,F=Ju.getData(u).data.meta.std.y,B=!1;switch(a){case"no":B=!0;break;case"and":z<D.x&&F<D.y&&(B=!0);break;case"or":(z<D.x||F<D.y)&&(B=!0);break;case"x":z<D.x&&(B=!0);break;case"y":F<D.y&&(B=!0);break;default:B=!1}if(B){for(var V=0,j=A[0],H=o,U=A[0].angle,G=0;G<p;G++){var q=void 0,W=H*j.angle+(1-H)*U;Math.abs(A[G].angle-j.angle)>180?(q=W-U<0?j.angle>A[G].angle?-1*(j.angle-A[G].angle):-1*(j.angle+360-A[G].angle):j.angle>A[G].angle?A[G].angle+360-j.angle:A[G].angle-j.angle,U=1===Qf(A[G].angle)&&4===Qf(A[G-1].angle)||4===Qf(A[G].angle)&&1===Qf(A[G-1].angle)?A[G].angle:W):(q=A[G].angle-j.angle,U=W),V+=q,j=A[G]}Math.abs(V)>r&&f.push({id:u,start:c[d].z,angle:Math.abs(V),period:p,center:v,diameter:{x:P.x-k.x,y:P.y-k.y},direction:V<0?"clockwise":"counterclockwise"})}}}if(f.length>0){for(var $=Math.abs(f[0].angle),Y=0,Q=1;Q<f.length;Q++)$<Math.abs(f[Q].angle)&&($=Math.abs(f[Q].angle),Y=Q);h.push(f[Y])}}if(h.length>0){for(var X=0,Z=0,J=h[X].angle,K=1;K<h.length;)if(h[X].start<=h[K].start&&h[X].start+h[X].period<=h[K].start+h[K].period||h[X].start<=h[K].start&&h[K].start+h[K].period<=h[X].start+h[X].period){var tt=Math.max(h[X].start,h[K].start);Math.min(h[X].start+h[X].period,h[K].start+h[K].period)-tt>.5*h[X].period?(h[K].angle<J&&(J=h[K].angle,Z=K),K++):(s.push(h[Z]),X=Z=K,J=h[Z],K++)}s.push(h[Z])}}return s}(r,u,c,h,y,g,d),i.query.rotationPeriod=u,i.query.rotationDiameter=c,i.query.rotationAngle=h,i.query.stdOfthePeriod=g,i.query.alpha=d,i.query.weightForAverage=0===y?"flat":y}this.state.anomaly&&(i.option.push("anomaly"),n=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=t[n],i=Ju.getData(r),a=i.data.spatial,o=0;o<a.length-1;o++){var s=a[o].z,l=a[o+1].z,u=Ju.getValues(r,s-a[0].z),c=Ju.getValues(r,l-a[0].z),h=100*Math.sqrt(Math.pow((c.x-u.x)/(i.data.meta.max.x-i.data.meta.min.x),2)+Math.pow((c.y-u.y)/(i.data.meta.max.y-i.data.meta.min.y),2))/(l-s);(0===h||isNaN(h))&&(h=1);var d=Math.abs(c.V-u.V)/(i.data.meta.max.V-i.data.meta.min.V)*100/(l-s);(0===d||isNaN(d))&&(d=1);var f=Math.abs(c.H-u.H)/(i.data.meta.max.H-i.data.meta.min.H)*100/(l-s);(0===f||isNaN(f))&&(f=1),e.push({id:r,start:s,anomalyDegree:h*d*f})}return e}(r));var b=[];if(this.state.flare&&this.state.rotation){for(var x,_=0,w=0;_<t.length&&w<e.length;)e[w].id<t[_].id?w++:t[_].id<e[w].id?_++:e[w].start<=t[_].start&&t[_].start<=e[w].start+e[w].period?(void 0===(x=e[w]).flares&&(x.flares=[]),x.flares.push(t[_]),_++):t[_].start<e[w].start?_++:e[w].start+e[w].period<t[_].start&&(x&&(b.push(x),x=null),w++);x&&b.push(x)}else if(this.state.anomaly&&this.state.rotation){for(var S,E=0,M=0;E<n.length&&M<e.length;)e[M].id<n[E].id?M++:n[E].id<e[M].id?E++:e[M].start<=n[E].start&&n[E].start<=e[M].start+e[M].period?(void 0===(S=e[M]).anomalies&&(S.anomalies=[]),S.anomalies.push(n[E]),E++):n[E].start<e[M].start?E++:e[M].start+e[M].period<n[E].start&&(S&&(b.push(S),S=null),M++);S&&b.push(S)}else this.state.flare?b=t:this.state.rotation?b=e:this.state.anomaly&&(b=n);Kc(void 0,b,i),Hf(),Uf()}},{key:"flareOptions",value:function(){return i.a.createElement("form",{className:"form-check",id:"flareOptions",style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"flareAutomatic",name:"flareOptions",value:"automatic",checked:this.state.flareOption.indexOf("automatic")>=0,disabled:!this.state.flare,onChange:this.switchFlareOption.bind(this),className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"flareAutomatic"},"Automatic"),i.a.createElement("h6",null,"Parameters"),i.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}}),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Lookaround"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"k neightbors",id:"flareLookaround",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Sensitivity cutoff"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"h",id:"flareSensitivity",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}}))),i.a.createElement("h6",null,"Peak function"),i.a.createElement("div",{className:"form-check form-check-inline"},i.a.createElement("img",{id:"peakAveMaximum",className:"selectorIcon",name:"peakFunction",value:"AveMaximum",src:"img/icons/flare1.png",alt:"Average of the maximums among k left & right neightbors",width:"80",height:"80",title:"Average of the maximums among k left & right neightbors",onClick:this.selectFlareAveMaximum.bind(this),readOnly:!0}),i.a.createElement("img",{id:"peakAveAve",className:"selectorIcon selected",name:"peakFunction",value:"AveAve",src:"img/icons/flare2.png",alt:"Average of the averages of the signed distance from k left & right neightbors",width:"80",height:"80",title:"Average of the averages of the signed distance from k left & right neightbors",onClick:this.selectFlareAveAve.bind(this),readOnly:!0}),i.a.createElement("img",{id:"peakAveDist",className:"selectorIcon",name:"peakFunction",value:"AveDist",src:"img/icons/flare3.png",alt:"Average signed distance from the averages of k neightbors",width:"80",height:"80",title:"Average signed distance from the averages of k neightbors",onClick:this.selectFlareAveDist.bind(this),readOnly:!0}))),i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"flareManual",name:"flareOptions",value:"manual",checked:"manual"===this.state.flareOption,disabled:!this.state.flare,onChange:this.switchFlareOption.bind(this),className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"flareManual"},"Manual"),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Intensity Threshold"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"flareThreshold",disabled:!this.state.flare,style:{width:"7rem",marginRight:"0.5rem"}})))))}},{key:"rotationOptions",value:function(){return i.a.createElement("div",{className:"container",style:{paddingRight:"0px",paddingLeft:"0px",marginBottom:"0.2rem"}},i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Rotation period"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"rotationPeriodMin",disabled:!this.state.rotation,style:{width:"20%",marginRight:"0.5rem"}}),"~",i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"rotationPeriodMax",disabled:!this.state.rotation,style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"}}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Rotation diameter"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"diameter",id:"rotationDiameter",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Rotation angle"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"angle",id:"rotationAngle",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5",title:"X and Y are standard deviations of the entire data,  x and y are those of the time interval"},"Standard deviation of the period"),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"stdConstraintsList",style:{width:"60%"},disabled:!this.state.rotation},i.a.createElement("option",{value:"no"},"No constraints"),i.a.createElement("option",{value:"and"},"X < x  Y < y"),i.a.createElement("option",{value:"or"},"X < x  Y < y"),i.a.createElement("option",{value:"x"},"X < x"),i.a.createElement("option",{value:"y"},"Y < y")))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"}," of the exponential smoothing"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"alpha",id:"alphaES",disabled:!this.state.rotation,style:{width:"40%",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Weight for average"),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"weightForAverageList",style:{width:"60%"},disabled:!this.state.rotation,onChange:this.updateWeight.bind(this)},i.a.createElement("option",{value:"0"},"Flat (arithmetic mean)"),i.a.createElement("option",{value:"1"},"=1"),i.a.createElement("option",{value:"3"},"=3"),i.a.createElement("option",{value:"5"},"=5")))),i.a.createElement("div",{id:"gaussCurveArea",style:{textAlign:"center"}}))}},{key:"switchFlareOption",value:function(){var t=$("input[name=flareOptions]:checked").val();"automatic"===t&&$("img[name=peakFunction]").each((function(e,n){if($(this).attr("class").indexOf("selected")>=0){var r=$(n).attr("id");t+=" "+r.slice(4,r.length)}})),this.setState({flareOption:t})}},{key:"selectFlareAveMaximum",value:function(){this.setState({flareOption:"automatic AveMaximum"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveMaximum").addClass("selected")}},{key:"selectFlareAveAve",value:function(){this.setState({flareOption:"automatic AveAve"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveAve").addClass("selected")}},{key:"selectFlareAveDist",value:function(){this.setState({flareOption:"automatic AveDist"}),$("img[name=peakFunction]").each((function(){$(this).removeClass("selected")})),$("#peakAveDist").addClass("selected")}},{key:"clickFlare",value:function(){var t=!this.state.flare;this.setState({flare:t}),eh("flare",t)}},{key:"clickRotation",value:function(){var t=!this.state.rotation;this.setState({rotation:t}),eh("rotation",t)}},{key:"clickAnomaly",value:function(){var t=!this.state.anomaly;this.setState({anomaly:t}),eh("anomaly",t)}},{key:"render",value:function(){return i.a.createElement("div",{id:"AEQuerying",className:"featureArea",style:{padding:"15px"}},i.a.createElement("div",{className:"form-group",name:"AEModeForm"},i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"flareExtractionCheck",name:"AEMode",value:"flare",onChange:this.clickFlare.bind(this),checked:this.state.flare}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"flareExtractionCheck"},"Flare"),this.flareOptions()),i.a.createElement("div",{id:"rotationExtraction"},i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"rotationExtractionCheck",name:"AEMode",value:"rotation",onChange:this.clickRotation.bind(this),checked:this.state.rotation}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"rotationExtractionCheck"},"Rotation")),this.rotationOptions()),i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",name:"AEMode",value:"anomaly",id:"anomalyExtractionCheck",onChange:this.clickAnomaly.bind(this),checked:this.state.anomaly}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"anomalyExtractionCheck"},"Anomaly"))),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runAutomaticExtractionBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run"))}}])&&ap(e.prototype,n),r&&ap(e,r),o}(i.a.Component),hp={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function dp(t){return"number"==typeof t}function fp(t){return t&&!0===t.constructor.prototype.isBigNumber||!1}function pp(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function mp(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function gp(t){return t&&!0===t.constructor.prototype.isUnit||!1}function vp(t){return"string"==typeof t}var yp=Array.isArray;function bp(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function xp(t){return Array.isArray(t)||bp(t)}function _p(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function wp(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function Sp(t){return t&&!0===t.constructor.prototype.isRange||!1}function Ep(t){return t&&!0===t.constructor.prototype.isIndex||!1}function Mp(t){return"boolean"==typeof t}function Cp(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function Tp(t){return t&&!0===t.constructor.prototype.isHelp||!1}function kp(t){return"function"==typeof t}function Pp(t){return t instanceof Date}function Ap(t){return t instanceof RegExp}function Op(t){return!(!t||"object"!=typeof t||t.constructor!==Object||pp(t)||mp(t))}function Np(t){return null===t}function Rp(t){return void 0===t}function Lp(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function Ip(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function Dp(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function zp(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function Fp(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function Bp(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function Vp(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function jp(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function Hp(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function Up(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function Gp(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function qp(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function Wp(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function $p(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function Yp(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function Qp(t){return t&&!0===t.constructor.prototype.isChain||!1}function Xp(t){var e=typeof t;return"object"===e?null===t?"null":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":fp(t)?"BigNumber":pp(t)?"Complex":mp(t)?"Fraction":bp(t)?"Matrix":gp(t)?"Unit":Ep(t)?"Index":Sp(t)?"Range":Cp(t)?"ResultSet":Up(t)?t.type:Qp(t)?"Chain":Tp(t)?"Help":"Object":"function"===e?"Function":e}function Zp(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return Zp(t)}));if(t instanceof Date)return new Date(t.valueOf());if(fp(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return Jp(t,Zp)}function Jp(t,e){var n={};for(var r in t)em(t,r)&&(n[r]=e(t[r]));return n}function Kp(t,e){for(var n in e)em(e,n)&&(t[n]=e[n]);return t}function tm(t,e){var n,r,i;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(r=0,i=t.length;r<i;r++)if(!tm(t[r],e[r]))return!1;return!0}if("function"==typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(n in t)if(!(n in e)||!tm(t[n],e[n]))return!1;for(n in e)if(!(n in t)||!tm(t[n],e[n]))return!1;return!0}return t===e}function em(t,e){return t&&Object.hasOwnProperty.call(t,e)}var nm=["Matrix","Array"],rm=["number","BigNumber","Fraction"];function im(){return(im=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var am=function(t){if(t)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(hp)};function om(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}im(am,hp,{MATRIX_OPTIONS:nm,NUMBER_OPTIONS:rm});var sm=Math.sign||function(t){return t>0?1:t<0?-1:0},lm=Math.log2||function(t){return Math.log(t)/Math.LN2},um=Math.log10||function(t){return Math.log(t)/Math.LN10},cm=(Math.log1p,Math.cbrt||function(t){if(0===t)return t;var e,n=t<0;return n&&(t=-t),e=isFinite(t)?(t/((e=Math.exp(Math.log(t)/3))*e)+2*e)/3:t,n?-e:e}),hm=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function dm(t,e,n){var r={2:"0b",8:"0o",16:"0x"}[e],i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!om(n))throw new Error("size must be an integer");if(t>2**(n-1)-1||t<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!om(t))throw new Error("Value must be an integer");t<0&&(t+=2**n),i="i".concat(n)}var a="";return t<0&&(t=-t,a="-"),"".concat(a).concat(r).concat(t.toString(e)).concat(i)}function fm(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var n,r,i="auto";if(e&&(e.notation&&(i=e.notation),dp(e)?n=e:dp(e.precision)&&(n=e.precision),e.wordSize&&"number"!=typeof(r=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return mm(t,n);case"exponential":return gm(t,n);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=vm(pm(t),e),r=n.exponent,i=n.coefficients,a=r%3==0?r:r<0?r-3-r%3:r-r%3;if(dp(e))for(;e>i.length||r-a+1>i.length;)i.push(0);else for(var o=Math.abs(r-a)-(i.length-1),s=0;s<o;s++)i.push(0);var l=Math.abs(r-a),u=1;for(;l>0;)u++,l--;var c=i.slice(u).join(""),h=dp(e)&&c.length||c.match(/[1-9]/)?"."+c:"",d=i.slice(0,u).join("")+h+"e"+(r>=0?"+":"")+a.toString();return n.sign+d}(t,n);case"bin":return dm(t,2,r);case"oct":return dm(t,8,r);case"hex":return dm(t,16,r);case"auto":return function(t,e,n){if(isNaN(t)||!isFinite(t))return String(t);var r=n&&void 0!==n.lowerExp?n.lowerExp:-3,i=n&&void 0!==n.upperExp?n.upperExp:5,a=pm(t),o=e?vm(a,e):a;if(o.exponent<r||o.exponent>=i)return gm(t,e);var s=o.coefficients,l=o.exponent;s.length<e&&(s=s.concat(ym(e-s.length))),s=s.concat(ym(l-s.length+1+(s.length<e?e-s.length:0))),s=ym(-l).concat(s);var u=l>0?l:0;return u<s.length-1&&s.splice(u+1,0,"."),o.sign+s.join("")}(t,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function pm(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var n=e[1],r=e[2],i=parseFloat(e[4]||"0"),a=r.indexOf(".");i+=-1!==a?a-1:r.length-1;var o=r.replace(".","").replace(/^0*/,(function(t){return i-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===o.length&&(o.push(0),i++),{sign:n,coefficients:o,exponent:i}}function mm(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=pm(t),r="number"==typeof e?vm(n,n.exponent+1+e):n,i=r.coefficients,a=r.exponent+1,o=a+(e||0);return i.length<o&&(i=i.concat(ym(o-i.length))),a<0&&(i=ym(1-a).concat(i),a=1),a<i.length&&i.splice(a,0,0===a?"0.":"."),r.sign+i.join("")}function gm(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=pm(t),r=e?vm(n,e):n,i=r.coefficients,a=r.exponent;i.length<e&&(i=i.concat(ym(e-i.length)));var o=i.shift();return r.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function vm(t,e){for(var n={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},r=n.coefficients;e<=0;)r.unshift(0),n.exponent++,e++;if(r.length>e&&r.splice(e,r.length-e)[0]>=5){var i=e-1;for(r[i]++;10===r[i];)r.pop(),0===i&&(r.unshift(0),n.exponent++,i++),r[--i]++}return n}function ym(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}var bm=Number.EPSILON||2220446049250313e-31;function xm(t,e,n){if(null==n)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var r=Math.abs(t-e);return r<bm||r<=Math.max(Math.abs(t),Math.abs(e))*n}return!1}var _m=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)},wm=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},Sm=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},Em=(Math.cosh,Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2});Math.tanh;function Mm(t,e,n){var r=new(0,t.constructor)(2),i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!om(n))throw new Error("size must be an integer");if(t.greaterThan(r.pow(n-1).sub(1))||t.lessThan(r.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(r.pow(n))),i="i".concat(n)}switch(e){case 2:return"".concat(t.toBinary()).concat(i);case 8:return"".concat(t.toOctal()).concat(i);case 16:return"".concat(t.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(e," not supported "))}}function Cm(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var n,r,i="auto";if(void 0!==e&&(e.notation&&(i=e.notation),"number"==typeof e?n=e:e.precision&&(n=e.precision),e.wordSize&&"number"!=typeof(r=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(t,e){return t.toFixed(e)}(t,n);case"exponential":return Tm(t,n);case"engineering":return function(t,e){var n=t.e,r=n%3==0?n:n<0?n-3-n%3:n-n%3,i=t.mul(Math.pow(10,-r)),a=i.toPrecision(e);-1!==a.indexOf("e")&&(a=i.toString());return a+"e"+(n>=0?"+":"")+r.toString()}(t,n);case"bin":return Mm(t,2,r);case"oct":return Mm(t,8,r);case"hex":return Mm(t,16,r);case"auto":var a=e&&void 0!==e.lowerExp?e.lowerExp:-3,o=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var s=t.toSignificantDigits(n),l=s.e;return(l>=a&&l<o?s.toFixed():Tm(t,n)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Tm(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function km(t,e){return"number"==typeof t?fm(t,e):fp(t)?Cm(t,e):function(t){return t&&"object"==typeof t&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t)?e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d:Array.isArray(t)?function t(e,n){if(Array.isArray(e)){for(var r="[",i=e.length,a=0;a<i;a++)0!==a&&(r+=", "),r+=t(e[a],n);return r+="]"}return km(e,n)}(t,e):vp(t)?'"'+t+'"':"function"==typeof t?t.syntax?String(t.syntax):"function":t&&"object"==typeof t?"function"==typeof t.format?t.format(e):t&&t.toString(e)!=={}.toString()?t.toString(e):"{"+Object.keys(t).map(n=>'"'+n+'": '+km(t[n],e)).join(", ")+"}":String(t)}function Pm(t,e,n){if(!(this instanceof Pm))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function Am(t,e,n){if(!(this instanceof Am))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function Om(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function Nm(t,e){if(0===e.length){if(Array.isArray(t))throw new Pm(t.length,0)}else!function t(e,n,r){var i,a=e.length;if(a!==n[r])throw new Pm(a,n[r]);if(r<n.length-1){var o=r+1;for(i=0;i<a;i++){var s=e[i];if(!Array.isArray(s))throw new Pm(n.length-1,n.length,"<");t(e[i],n,o)}}else for(i=0;i<a;i++)if(Array.isArray(e[i]))throw new Pm(n.length+1,n.length,">")}(t,e,0)}function Rm(t,e){if(!dp(t)||!om(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new Am(t,e)}function Lm(t,e,n){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(t){if(!dp(t)||!om(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+km(e)+")")})),function t(e,n,r,i){var a,o,s=e.length,l=n[r],u=Math.min(s,l);if(e.length=l,r<n.length-1){var c=r+1;for(a=0;a<u;a++)o=e[a],Array.isArray(o)||(o=[o],e[a]=o),t(o,n,c,i);for(a=u;a<l;a++)o=[],e[a]=o,t(o,n,c,i)}else{for(a=0;a<u;a++)for(;Array.isArray(e[a]);)e[a]=e[a][0];for(a=u;a<l;a++)e[a]=i}}(t,e,0,void 0!==n?n:0),t}function Im(t,e){var n=Bm(t),r=n.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Pm(0,r,"!=");var i=zm(e=Dm(e,r));if(r!==i)throw new Pm(i,r,"!=");try{return function(t,e){for(var n,r=t,i=e.length-1;i>0;i--){var a=e[i];n=[];for(var o=r.length/a,s=0;s<o;s++)n.push(r.slice(s*a,(s+1)*a));r=n}return r}(n,e)}catch(t){if(t instanceof Pm)throw new Pm(i,r,"!=");throw t}}function Dm(t,e){var n=zm(t),r=t.slice(),i=t.indexOf(-1);if(t.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(e%n==0))throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-n);r[i]=-e/n}return r}function zm(t){return t.reduce((t,e)=>t*e,1)}function Fm(t,e,n,r){var i=r||Om(t);if(n)for(var a=0;a<n;a++)t=[t],i.unshift(1);for(t=function t(e,n,r){var i,a;if(Array.isArray(e)){var o=r+1;for(i=0,a=e.length;i<a;i++)e[i]=t(e[i],n,o)}else for(var s=r;s<n;s++)e=[e];return e}(t,e,0);i.length<e;)i.push(1);return t}function Bm(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(n){Array.isArray(n)?n.forEach(t):e.push(n)})),e}function Vm(t,e){for(var n,r=0,i=0;i<t.length;i++){var a=t[i],o=Array.isArray(a);if(0===i&&o&&(r=a.length),o&&a.length!==r)return;var s=o?Vm(a,e):e(a);if(void 0===n)n=s;else if(n!==s)return"mixed"}return n}function jm(t,e,n,r){function i(r){var i=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r],a=t[i];void 0!==a&&(n[i]=a)}return n}(r,e.map(Hm));return function(t,e,n){if(!e.filter(t=>!function(t){return t&&"?"===t[0]}(t)).every(t=>void 0!==n[t])){var r=e.filter(t=>void 0===n[t]);throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(r.map(t=>'"'.concat(t,'"')).join(", "),"."))}}(t,e,r),n(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),r&&(i.meta=r),i}function Hm(t){return t&&"?"===t[0]?t.slice(1):t}Pm.prototype=new RangeError,Pm.prototype.constructor=RangeError,Pm.prototype.name="DimensionError",Pm.prototype.isDimensionError=!0,Am.prototype=new RangeError,Am.prototype.constructor=RangeError,Am.prototype.name="IndexError",Am.prototype.isIndexError=!0;var Um=n(7),Gm=n.n(Um),qm=jm("Complex",[],()=>(Gm.a.prototype.type="Complex",Gm.a.prototype.isComplex=!0,Gm.a.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Gm.a.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Gm.a.prototype.format=function(t){var e=this.im,n=this.re,r=fm(this.re,t),i=fm(this.im,t),a=dp(t)?t:t?t.precision:null;if(null!==a){var o=Math.pow(10,-a);Math.abs(n/e)<o&&(n=0),Math.abs(e/n)<o&&(e=0)}return 0===e?r:0===n?1===e?"i":-1===e?"-i":i+"i":e<0?-1===e?r+" - i":r+" - "+i.substring(1)+"i":1===e?r+" + i":r+" + "+i+"i"},Gm.a.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return Gm()(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(dp(n)){if(gp(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),dp(r))return new Gm.a({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Gm.a.prototype.valueOf=Gm.a.prototype.toString,Gm.a.fromJSON=function(t){return new Gm.a(t)},Gm.a.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},Gm.a),{isClass:!0});function Wm(t){var e=0,n=1,r=Object.create(null),i=Object.create(null),a=0,o=function(t){var o=i[t];if(o&&(delete r[o],delete i[t],--e,n===o)){if(!e)return a=0,void(n=1);for(;!hasOwnProperty.call(r,++n););}};return t=Math.abs(t),{hit:function(s){var l=i[s],u=++a;if(r[u]=s,i[s]=u,!l){if(++e<=t)return;return s=r[n],o(s),s}if(delete r[l],n===l)for(;!hasOwnProperty.call(r,++n););},delete:o,clear:function(){e=a=0,n=1,r=Object.create(null),i=Object.create(null)}}}function $m(t){var{hasher:e,limit:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=null==n?Number.POSITIVE_INFINITY:n,e=null==e?JSON.stringify:e,function r(){"object"!=typeof r.cache&&(r.cache={values:new Map,lru:Wm(n||Number.POSITIVE_INFINITY)});for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e(i);if(r.cache.values.has(o))return r.cache.lru.hit(o),r.cache.values.get(o);var s=t.apply(t,i);return r.cache.values.set(o,s),r.cache.values.delete(r.cache.lru.hit(o)),s}}$m((function(t){return new t(1).exp()}),{hasher:Qm}),$m((function(t){return new t(1).plus(new t(5).sqrt()).div(2)}),{hasher:Qm});var Ym=$m((function(t){return t.acos(-1)}),{hasher:Qm});$m((function(t){return Ym(t).times(2)}),{hasher:Qm});function Qm(t){return t[0].precision}Math.PI,Math.PI,Math.E;var Xm=n(30),Zm=n.n(Xm),Jm=jm("BigNumber",["?on","config"],t=>{var{on:e,config:n}=t,r=Zm.a.clone({precision:n.precision,modulo:9});return r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(t){return new r(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&r.config({precision:t.precision})})),r},{isClass:!0}),Km=jm("Matrix",[],()=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,n){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,n){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t},{isClass:!0});tg("fineStructure",.0072973525693),tg("weakMixingAngle",.2229),tg("efimovFactor",22.7),tg("sackurTetrode",-1.16487052358);function tg(t,e){return jm(t,["config","BigNumber"],t=>{var{config:n,BigNumber:r}=t;return"BigNumber"===n.number?new r(e):e})}var eg=n(24),ng=n.n(eg),rg=jm("Fraction",[],()=>(ng.a.prototype.type="Fraction",ng.a.prototype.isFraction=!0,ng.a.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},ng.a.fromJSON=function(t){return new ng.a(t)},ng.a),{isClass:!0}),ig=jm("DenseMatrix",["Matrix"],t=>{var{Matrix:e}=t;function n(t,e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!vp(e))throw new Error("Invalid datatype: "+e);if(bp(t))"DenseMatrix"===t.type?(this._data=Zp(t._data),this._size=Zp(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&yp(t.data)&&yp(t.size))this._data=t.data,this._size=t.size,Nm(this._data,this._size),this._datatype=e||t.datatype;else if(yp(t))this._data=function t(e){for(var n=0,r=e.length;n<r;n++){var i=e[n];yp(i)?e[n]=t(i):i&&!0===i.isMatrix&&(e[n]=t(i.valueOf()))}return e}(t),this._size=Om(this._data),Nm(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+Xp(t)+")");this._data=[],this._size=[0],this._datatype=e}}function r(t,e){if(!Ep(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r=e.size();if(r.length!==t._size.length)throw new Pm(r.length,t._size.length);for(var i=e.min(),a=e.max(),o=0,s=t._size.length;o<s;o++)Rm(i[o],t._size[o]),Rm(a[o],t._size[o]);return new n(function t(e,n,r,i){var a=i===r-1,o=n.dimension(i);return a?o.map((function(t){return Rm(t,e.length),e[t]})).valueOf():o.map((function(a){Rm(a,e.length);var o=e[a];return t(o,n,r,i+1)})).valueOf()}(t._data,e,r.length,0),t._datatype)}function i(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,a=e.size(),s=e.isScalar();if(bp(n)?(i=n.size(),n=n.valueOf()):i=Om(n),s){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(a.length<t._size.length)throw new Pm(a.length,t._size.length,"<");if(i.length<a.length){for(var l=0,u=0;1===a[l]&&1===i[l];)l++;for(;1===a[l];)u++,l++;n=Fm(n,a.length,u,i)}if(!tm(a,i))throw new Pm(a,i,">");o(t,e.max().map((function(t){return t+1})),r);var c=a.length;!function t(e,n,r,i,a){var o=a===i-1,s=n.dimension(a);o?s.forEach((function(t,n){Rm(t),e[t]=r[n[0]]})):s.forEach((function(o,s){Rm(o),t(e[o],n,r[s[0]],i,a+1)}))}(t._data,e,n,c,0)}return t}function a(t,e,n){if(0===e.length){for(var r=t._data;yp(r);)r=r[0];return r}return t._size=e.slice(0),t._data=Lm(t._data,t._size,n),t}function o(t,e,n){for(var r=t._size.slice(0),i=!1;r.length<e.length;)r.push(0),i=!0;for(var o=0,s=e.length;o<s;o++)e[o]>r[o]&&(r[o]=e[o],i=!0);i&&a(t,r,n)}return n.prototype=new e,n.prototype.createDenseMatrix=function(t,e){return new n(t,e)},n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return Vm(this._data,Xp)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(t,e){return new n(t,e)},n.prototype.subset=function(t,e,n){switch(arguments.length){case 1:return r(this,t);case 2:case 3:return i(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(t){if(!yp(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Pm(t.length,this._size.length);for(var e=0;e<t.length;e++)Rm(t[e],this._size[e]);for(var n=this._data,r=0,i=t.length;r<i;r++){var a=t[r];Rm(a,n.length),n=n[a]}return n},n.prototype.set=function(t,e,n){if(!yp(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new Pm(t.length,this._size.length,"<");var r,i,a;o(this,t.map((function(t){return t+1})),n);var s=this._data;for(r=0,i=t.length-1;r<i;r++)Rm(a=t[r],s.length),s=s[a];return Rm(a=t[t.length-1],s.length),s[a]=e,this},n.prototype.resize=function(t,e,n){if(!xp(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);return a(n?this.clone():this,r,e)},n.prototype.reshape=function(t,e){var n=e?this.clone():this;n._data=Im(n._data,t);var r=n._size.reduce((t,e)=>t*e);return n._size=Dm(t,r),n},n.prototype.clone=function(){return new n({data:Zp(this._data),size:Zp(this._size),datatype:this._datatype})},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(t){var e=this,r=function n(r,i){return yp(r)?r.map((function(t,e){return n(t,i.concat(e))})):t(r,i,e)}(this._data,[]);return new n(r,void 0!==this._datatype?Vm(r,Xp):void 0)},n.prototype.forEach=function(t){var e=this;!function n(r,i){yp(r)?r.forEach((function(t,e){n(t,i.concat(e))})):t(r,i,e)}(this._data,[])},n.prototype.toArray=function(){return Zp(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(t){return km(this._data,t)},n.prototype.toString=function(){return km(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(t){if(t){if(fp(t)&&(t=t.toNumber()),!dp(t)||!om(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],a=this._size[1],o=Math.min(i-r,a-e),s=[],l=0;l<o;l++)s[l]=this._data[l+r][l+e];return new n({data:s,size:[o],datatype:this._datatype})},n.diagonal=function(t,e,r,i){if(!yp(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(fp(t)&&(t=t.toNumber()),!dp(t)||!om(t)||t<1)throw new Error("Size values must be positive integers");return t})),r){if(fp(r)&&(r=r.toNumber()),!dp(r)||!om(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var a,o=r>0?r:0,s=r<0?-r:0,l=t[0],u=t[1],c=Math.min(l-s,u-o);if(yp(e)){if(e.length!==c)throw new Error("Invalid value array length");a=function(t){return e[t]}}else if(bp(e)){var h=e.size();if(1!==h.length||h[0]!==c)throw new Error("Invalid matrix length");a=function(t){return e.get([t])}}else a=function(){return e};i||(i=fp(a(0))?a(0).mul(0):0);var d=[];if(t.length>0){d=Lm(d,t,i);for(var f=0;f<c;f++)d[f+s][f+o]=a(f)}return new n({data:d,size:[l,u]})},n.fromJSON=function(t){return new n(t)},n.prototype.swapRows=function(t,e){if(!(dp(t)&&om(t)&&dp(e)&&om(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Rm(t,this._size[0]),Rm(e,this._size[0]),n._swapRows(t,e,this._data),this},n._swapRows=function(t,e,n){var r=n[t];n[t]=n[e],n[e]=r},n},{isClass:!0}),ag=n(73),og=n.n(ag),sg=function(){return sg=og.a.create,og.a},lg=jm("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(t){var{BigNumber:e,Complex:n,DenseMatrix:r,Fraction:i}=t,a=sg();return a.types=[{name:"number",test:dp},{name:"Complex",test:pp},{name:"BigNumber",test:fp},{name:"Fraction",test:mp},{name:"Unit",test:gp},{name:"string",test:vp},{name:"Chain",test:Qp},{name:"Array",test:yp},{name:"Matrix",test:bp},{name:"DenseMatrix",test:_p},{name:"SparseMatrix",test:wp},{name:"Range",test:Sp},{name:"Index",test:Ep},{name:"boolean",test:Mp},{name:"ResultSet",test:Cp},{name:"Help",test:Tp},{name:"function",test:kp},{name:"Date",test:Pp},{name:"RegExp",test:Ap},{name:"null",test:Np},{name:"undefined",test:Rp},{name:"AccessorNode",test:Lp},{name:"ArrayNode",test:Ip},{name:"AssignmentNode",test:Dp},{name:"BlockNode",test:zp},{name:"ConditionalNode",test:Fp},{name:"ConstantNode",test:Bp},{name:"FunctionNode",test:jp},{name:"FunctionAssignmentNode",test:Vp},{name:"IndexNode",test:Hp},{name:"Node",test:Up},{name:"ObjectNode",test:Gp},{name:"OperatorNode",test:qp},{name:"ParenthesisNode",test:Wp},{name:"RangeNode",test:$p},{name:"SymbolNode",test:Yp},{name:"Object",test:Op}],a.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(e||ug(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return n||cg(t),new n(t,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(t){return n||cg(t),new n(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return n||cg(t),new n(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||hg(t);var e=new i(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||ug(t);try{return new e(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){i||hg(t);try{return new i(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){n||cg(t);try{return new n(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||ug(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||hg(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return r||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new r(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],a}));function ug(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function cg(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function hg(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}function dg(t,e,n){return t&&"function"==typeof t.map?t.map((function(t){return dg(t,e,n)})):e(t)}function fg(t){return t<0}function pg(t){return t>0}function mg(t){return 0===t}function gg(t){return Number.isNaN(t)}fg.signature="number",pg.signature="number",mg.signature="number",gg.signature="number";function vg(t,e,n){if(null==n)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var r=t.minus(e).abs();if(r.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return r.lte(i.times(n))}return!1}var yg=jm("equalScalar",["typed","config"],t=>{var{typed:e,config:n}=t;return e("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return xm(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||vg(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return function(t,e,n){return xm(t.re,e.re,n)&&xm(t.im,e.im,n)}(t,e,n.epsilon)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)}})}),bg=(jm("equalScalar",["typed","config"],t=>{var{typed:e,config:n}=t;return e("equalScalar",{"number, number":function(t,e){return xm(t,e,n.epsilon)}})}),jm("number",["typed"],t=>{var{typed:e}=t,n=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e=0,n=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);n&&(e=Number(n[2]),t=n[1]);var r=Number(t);if(isNaN(r))throw new SyntaxError('String "'+t+'" is no valid number');if(n){if(r>2**e-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));r>=2**(e-1)&&(r-=2**e)}return r},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return dg(t,this)}});return n.fromJSON=function(t){return parseFloat(t.value)},n})),xg="number, number";function _g(t){return Math.abs(t)}function wg(t,e){return t+e}function Sg(t,e){return t*e}function Eg(t){return-t}function Mg(t){return t}function Cg(t){return cm(t)}function Tg(t){return Math.ceil(t)}function kg(t){return t*t*t}function Pg(t){return Math.exp(t)}function Ag(t){return hm(t)}function Og(t,e){if(!om(t)||!om(e))throw new Error("Parameters in function gcd must be integer numbers");for(var n;0!==e;)n=t%e,t=e,e=n;return t<0?-t:t}function Ng(t,e){if(!om(t)||!om(e))throw new Error("Parameters in function lcm must be integer numbers");if(0===t||0===e)return 0;for(var n,r=t*e;0!==e;)e=t%(n=e),t=n;return Math.abs(r/t)}function Rg(t){return Math.log(t)}function Lg(t){return um(t)}function Ig(t){return lm(t)}function Dg(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}function zg(t,e){var n=e<0;if(n&&(e=-e),0===e)throw new Error("Root must be non-zero");if(t<0&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0===t)return n?1/0:0;if(!isFinite(t))return n?0:t;var r=Math.pow(Math.abs(t),1/e);return r=t<0?-r:r,n?1/r:r}function Fg(t){return sm(t)}function Bg(t){return t*t}function Vg(t,e){var n,r,i,a=0,o=1,s=1,l=0;if(!om(t)||!om(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)i=t-(r=Math.floor(t/e))*e,n=a,a=o-r*a,o=n,n=s,s=l-r*s,l=n,t=e,e=i;return t<0?[-t,-o,-l]:[t,t?o:0,l]}function jg(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function Hg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(mm(t,e))}_g.signature="number",wg.signature=xg,Sg.signature=xg,Eg.signature="number",Mg.signature="number",Cg.signature="number",Tg.signature="number",kg.signature="number",Pg.signature="number",Ag.signature="number",Og.signature=xg,Ng.signature=xg,Rg.signature="number",Lg.signature="number",Ig.signature="number",Dg.signature=xg,zg.signature=xg,Fg.signature="number",Bg.signature="number",Vg.signature=xg,jg.signature=xg,Hg.signature=xg;var Ug=jm("multiplyScalar",["typed"],t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":Sg,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var n=e.clone();return n.value=null===n.value?n._normalize(t):this(n.value,t),n},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var n=t.clone();return n.value=null===n.value?n._normalize(e):this(n.value,e),n},"Unit, Unit":function(t,e){return t.multiply(e)}})}),Gg=jm("square",["typed"],t=>{var{typed:e}=t;return e("square",{number:Bg,Complex:function(t){return t.mul(t)},BigNumber:function(t){return t.times(t)},Fraction:function(t){return t.mul(t)},"Array | Matrix":function(t){return dg(t,this,!0)},Unit:function(t){return t.pow(2)}})});var qg="number, number";function Wg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function bitAnd");return t&e}function $g(t){if(!om(t))throw new Error("Integer expected in function bitNot");return~t}function Yg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function bitOr");return t|e}function Qg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function bitXor");return t^e}function Xg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function leftShift");return t<<e}function Zg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function rightArithShift");return t>>e}function Jg(t,e){if(!om(t)||!om(e))throw new Error("Integers expected in function rightLogShift");return t>>>e}Wg.signature=qg,$g.signature="number",Yg.signature=qg,Qg.signature=qg,Xg.signature=qg,Zg.signature=qg,Jg.signature=qg;function Kg(t){return!t}function tv(t,e){return!(!t&&!e)}function ev(t,e){return!!t!=!!e}function nv(t,e){return!(!t||!e)}Kg.signature="number",tv.signature="number, number",ev.signature="number, number",nv.signature="number, number";Math.pow(2,53),jm("oct",["typed","format"],t=>{var{typed:e,format:n}=t;return e("oct",{"number | BigNumber":function(t){return n(t,{notation:"oct"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"oct",wordSize:e})}})});function rv(t){return _m(t)}function iv(t){return Math.atan(1/t)}function av(t){return isFinite(t)?(Math.log((t+1)/t)+Math.log(t/(t-1)))/2:0}function ov(t){return Math.asin(1/t)}function sv(t){var e=1/t;return Math.log(e+Math.sqrt(e*e+1))}function lv(t){return Math.acos(1/t)}function uv(t){var e=1/t,n=Math.sqrt(e*e-1);return Math.log(n+e)}function cv(t){return wm(t)}function hv(t){return Sm(t)}function dv(t){return 1/Math.tan(t)}function fv(t){var e=Math.exp(2*t);return(e+1)/(e-1)}function pv(t){return 1/Math.sin(t)}function mv(t){return 0===t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*sm(t)}function gv(t){return 1/Math.cos(t)}function vv(t){return 2/(Math.exp(t)+Math.exp(-t))}function yv(t){return Em(t)}rv.signature="number",iv.signature="number",av.signature="number",ov.signature="number",sv.signature="number",lv.signature="number",uv.signature="number",cv.signature="number",hv.signature="number",dv.signature="number",fv.signature="number",pv.signature="number",mv.signature="number",gv.signature="number",vv.signature="number",yv.signature="number";var bv=jm("atan",["typed"],t=>{var{typed:e}=t;return e("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return dg(t,this,!0)}})});function xv(t,e){if(e<t)return 1;if(e===t)return e;var n=e+t>>1;return xv(t,n)*xv(n+1,e)}function _v(t,e){if(!om(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!om(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");var n=t-e;return e<n?xv(n+1,t)/xv(1,e):xv(e+1,t)/xv(1,n)}_v.signature="number, number";var wv=n(74),Sv=n.n(wv);Date.now();var Ev=jm("fraction",["typed","Fraction"],t=>{var{typed:e,Fraction:n}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new n(t)},string:function(t){return new n(t)},"number, number":function(t,e){return new n(t,e)},null:function(t){return new n(0)},BigNumber:function(t){return new n(t.toString())},Fraction:function(t){return t},Object:function(t){return new n(t)},"Array | Matrix":function(t){return dg(t,this)}})}),Mv=jm("unaryMinus",["typed"],t=>{var{typed:e}=t;return e("unaryMinus",{number:Eg,Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=this(t.value),e},"Array | Matrix":function(t){return dg(t,this,!0)}})}),Cv=jm("addScalar",["typed"],t=>{var{typed:e}=t;return e("addScalar",{"number, number":wg,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null===t.value||void 0===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value||void 0===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n}})}),Tv=jm("sqrt",["config","typed","Complex"],t=>{var{config:e,typed:n,Complex:r}=t;return n("sqrt",{number:i,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():i(t.toNumber())},"Array | Matrix":function(t){return dg(t,this,!0)},Unit:function(t){return t.pow(.5)}});function i(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new r(t,0).sqrt()}}),kv=jm("conj",["typed"],t=>{var{typed:e}=t;return e("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return dg(t,this)}})}),Pv=(jm("bin",["typed","format"],t=>{var{typed:e,format:n}=t;return e("bin",{"number | BigNumber":function(t){return n(t,{notation:"bin"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"bin",wordSize:e})}})}),jm("cos",["typed"],t=>{var{typed:e}=t;return e("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return this(t.value)},"Array | Matrix":function(t){return dg(t,this)}})})),Av=jm("sin",["typed"],t=>{var{typed:e}=t;return e("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return this(t.value)},"Array | Matrix":function(t){return dg(t,this,!0)}})});var Ov=jm("SparseMatrix",["typed","equalScalar","Matrix"],t=>{var{typed:e,equalScalar:n,Matrix:r}=t;function i(t,e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!vp(e))throw new Error("Invalid datatype: "+e);if(bp(t))!function(t,e,n){"SparseMatrix"===e.type?(t._values=e._values?Zp(e._values):void 0,t._index=Zp(e._index),t._ptr=Zp(e._ptr),t._size=Zp(e._size),t._datatype=n||e._datatype):a(t,e.valueOf(),n||e._datatype)}(this,t,e);else if(t&&yp(t.index)&&yp(t.ptr)&&yp(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(yp(t))a(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+Xp(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function a(t,r,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var a=r.length,o=0,s=n,l=0;if(vp(i)&&(s=e.find(n,[i,i])||n,l=e.convert(0,i)),a>0){var u=0;do{t._ptr.push(t._index.length);for(var c=0;c<a;c++){var h=r[c];if(yp(h)){if(0===u&&o<h.length&&(o=h.length),u<h.length){var d=h[u];s(d,l)||(t._values.push(d),t._index.push(c))}}else 0===u&&o<1&&(o=1),s(h,l)||(t._values.push(h),t._index.push(c))}u++}while(u<o)}t._ptr.push(t._index.length),t._size=[a,o]}function o(t,e){if(!Ep(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var n,r,a,o,s=e.size();if(s.length!==t._size.length)throw new Pm(s.length,t._size.length);var l=e.min(),u=e.max();for(n=0,r=t._size.length;n<r;n++)Rm(l[n],t._size[n]),Rm(u[n],t._size[n]);var c=t._values,h=t._index,d=t._ptr,f=e.dimension(0),p=e.dimension(1),m=[],g=[];f.forEach((function(t,e){g[t]=e[0],m[t]=!0}));var v=c?[]:void 0,y=[],b=[];return p.forEach((function(t){for(b.push(y.length),a=d[t],o=d[t+1];a<o;a++)n=h[a],!0===m[n]&&(y.push(g[n]),v&&v.push(c[a]))})),b.push(y.length),new i({values:v,index:y,ptr:b,size:s,datatype:t._datatype})}function s(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,a=e.size(),o=e.isScalar();if(bp(n)?(i=n.size(),n=n.toArray()):i=Om(n),o){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(1!==a.length&&2!==a.length)throw new Pm(a.length,t._size.length,"<");if(i.length<a.length){for(var s=0,l=0;1===a[s]&&1===i[s];)s++;for(;1===a[s];)l++,s++;n=Fm(n,a.length,l,i)}if(!tm(a,i))throw new Pm(a,i,">");for(var u=e.min()[0],c=e.min()[1],h=i[0],d=i[1],f=0;f<h;f++)for(var p=0;p<d;p++){var m=n[f][p];t.set([f+u,p+c],m,r)}}return t}function l(t,e,n,r){if(n-e==0)return n;for(var i=e;i<n;i++)if(r[i]===t)return i;return e}function u(t,e,n,r,i,a,o){i.splice(t,0,r),a.splice(t,0,e);for(var s=n+1;s<o.length;s++)o[s]++}function c(t,r,i,a){var o=a||0,s=n,l=0;vp(t._datatype)&&(s=e.find(n,[t._datatype,t._datatype])||n,l=e.convert(0,t._datatype),o=e.convert(o,t._datatype));var u,c,h,d=!s(o,l),f=t._size[0],p=t._size[1];if(i>p){for(c=p;c<i;c++)if(t._ptr[c]=t._values.length,d)for(u=0;u<f;u++)t._values.push(o),t._index.push(u);t._ptr[i]=t._values.length}else i<p&&(t._ptr.splice(i+1,p-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(p=i,r>f){if(d){var m=0;for(c=0;c<p;c++){t._ptr[c]=t._ptr[c]+m,h=t._ptr[c+1]+m;var g=0;for(u=f;u<r;u++,g++)t._values.splice(h+g,0,o),t._index.splice(h+g,0,u),m++}t._ptr[p]=t._values.length}}else if(r<f){var v=0;for(c=0;c<p;c++){t._ptr[c]=t._ptr[c]-v;var y=t._ptr[c],b=t._ptr[c+1]-v;for(h=y;h<b;h++)(u=t._index[h])>r-1&&(t._values.splice(h,1),t._index.splice(h,1),v++)}t._ptr[c]=t._values.length}return t._size[0]=r,t._size[1]=i,t}function h(t,e,n,r,i){var a,o,s=r[0],l=r[1],u=[];for(a=0;a<s;a++)for(u[a]=[],o=0;o<l;o++)u[a][o]=0;for(o=0;o<l;o++)for(var c=n[o],h=n[o+1],d=c;d<h;d++)u[a=e[d]][o]=t?i?Zp(t[d]):t[d]:1;return u}return i.prototype=new r,i.prototype.createSparseMatrix=function(t,e){return new i(t,e)},i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Vm(this._values,Xp)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(t,e){return new i(t,e)},i.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},i.prototype.subset=function(t,e,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,t);case 2:case 3:return s(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(t){if(!yp(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Pm(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],n=t[1];Rm(e,this._size[0]),Rm(n,this._size[1]);var r=l(e,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===e?this._values[r]:0},i.prototype.set=function(t,r,i){if(!yp(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Pm(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var a=t[0],o=t[1],s=this._size[0],h=this._size[1],d=n,f=0;vp(this._datatype)&&(d=e.find(n,[this._datatype,this._datatype])||n,f=e.convert(0,this._datatype)),(a>s-1||o>h-1)&&(c(this,Math.max(a+1,s),Math.max(o+1,h),i),s=this._size[0],h=this._size[1]),Rm(a,s),Rm(o,h);var p=l(a,this._ptr[o],this._ptr[o+1],this._index);return p<this._ptr[o+1]&&this._index[p]===a?d(r,f)?function(t,e,n,r,i){n.splice(t,1),r.splice(t,1);for(var a=e+1;a<i.length;a++)i[a]--}(p,o,this._values,this._index,this._ptr):this._values[p]=r:u(p,a,o,r,this._values,this._index,this._ptr),this},i.prototype.resize=function(t,e,n){if(!xp(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map(t=>Array.isArray(t)&&1===t.length?t[0]:t);if(2!==r.length)throw new Error("Only two dimensions matrix are supported");return r.forEach((function(t){if(!dp(t)||!om(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+km(r)+")")})),c(n?this.clone():this,r[0],r[1],e)},i.prototype.reshape=function(t,e){if(!yp(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");t.forEach((function(e){if(!dp(e)||!om(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+km(t)+")")}));var n=this._size[0]*this._size[1];if(n!==(t=Dm(t,n))[0]*t[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var r=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return r;for(var i=[],a=0;a<r._ptr.length;a++)for(var o=0;o<r._ptr[a+1]-r._ptr[a];o++)i.push(a);for(var s=r._values.slice(),c=r._index.slice(),h=0;h<r._index.length;h++){var d=c[h],f=i[h],p=d*r._size[1]+f;i[h]=p%t[1],c[h]=Math.floor(p/t[1])}r._values.length=0,r._index.length=0,r._ptr.length=t[1]+1,r._size=t.slice();for(var m=0;m<r._ptr.length;m++)r._ptr[m]=0;for(var g=0;g<s.length;g++){var v=c[g],y=i[g],b=s[g];u(l(v,r._ptr[y],r._ptr[y+1],r._index),v,y,b,r._values,r._index,r._ptr)}return r},i.prototype.clone=function(){return new i({values:this._values?Zp(this._values):void 0,index:Zp(this._index),ptr:Zp(this._ptr),size:Zp(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(t,r){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var a=this;return function(t,r,a,o,s,l,u){var c=[],h=[],d=[],f=n,p=0;vp(t._datatype)&&(f=e.find(n,[t._datatype,t._datatype])||n,p=e.convert(0,t._datatype));for(var m=function(t,e,n){t=l(t,e,n),f(t,p)||(c.push(t),h.push(e))},g=o;g<=s;g++){d.push(c.length);var v=t._ptr[g],y=t._ptr[g+1];if(u)for(var b=v;b<y;b++){var x=t._index[b];x>=r&&x<=a&&m(t._values[b],x-r,g-o)}else{for(var _={},w=v;w<y;w++){var S=t._index[w];_[S]=t._values[w]}for(var E=r;E<=a;E++){var M=E in _?_[E]:0;m(M,E-r,g-o)}}}return d.push(c.length),new i({values:c,index:h,ptr:d,size:[a-r+1,s-o+1]})}(this,0,this._size[0]-1,0,this._size[1]-1,(function(e,n,r){return t(e,[n,r],a)}),r)},i.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this._size[0],r=this._size[1],i=0;i<r;i++){var a=this._ptr[i],o=this._ptr[i+1];if(e)for(var s=a;s<o;s++){var l=this._index[s];t(this._values[s],[l,i],this)}else{for(var u={},c=a;c<o;c++){u[this._index[c]]=this._values[c]}for(var h=0;h<n;h++){t(h in u?u[h]:0,[h,i],this)}}}},i.prototype.toArray=function(){return h(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return h(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(t){for(var e=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+km(e,t)+" x "+km(n,t)+"] density: "+km(r,t)+"\n",a=0;a<n;a++)for(var o=this._ptr[a],s=this._ptr[a+1],l=o;l<s;l++){i+="\n    ("+km(this._index[l],t)+", "+km(a,t)+") ==> "+(this._values?km(this._values[l],t):"X")}return i},i.prototype.toString=function(){return km(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(t){if(t){if(fp(t)&&(t=t.toNumber()),!dp(t)||!om(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,n=t<0?-t:0,r=this._size[0],a=this._size[1],o=Math.min(r-n,a-e),s=[],l=[],u=[];u[0]=0;for(var c=e;c<a&&s.length<o;c++)for(var h=this._ptr[c],d=this._ptr[c+1],f=h;f<d;f++){var p=this._index[f];if(p===c-e+n){s.push(this._values[f]),l[s.length-1]=p-n;break}}return u.push(s.length),new i({values:s,index:l,ptr:u,size:[o,1]})},i.fromJSON=function(t){return new i(t)},i.diagonal=function(t,r,a,o,s){if(!yp(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(fp(t)&&(t=t.toNumber()),!dp(t)||!om(t)||t<1)throw new Error("Size values must be positive integers");return t})),a){if(fp(a)&&(a=a.toNumber()),!dp(a)||!om(a))throw new TypeError("The parameter k must be an integer number")}else a=0;var l=n,u=0;vp(s)&&(l=e.find(n,[s,s])||n,u=e.convert(0,s));var c,h=a>0?a:0,d=a<0?-a:0,f=t[0],p=t[1],m=Math.min(f-d,p-h);if(yp(r)){if(r.length!==m)throw new Error("Invalid value array length");c=function(t){return r[t]}}else if(bp(r)){var g=r.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");c=function(t){return r.get([t])}}else c=function(){return r};for(var v=[],y=[],b=[],x=0;x<p;x++){b.push(v.length);var _=x-h;if(_>=0&&_<m){var w=c(_);l(w,u)||(y.push(_+d),v.push(w))}}return b.push(v.length),new i({values:v,index:y,ptr:b,size:[f,p]})},i.prototype.swapRows=function(t,e){if(!(dp(t)&&om(t)&&dp(e)&&om(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Rm(t,this._size[0]),Rm(e,this._size[0]),i._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(t,e,n,r,i){for(var a=r[t],o=r[t+1],s=a;s<o;s++)i(n[s],e[s])},i._swapRows=function(t,e,n,r,i,a){for(var o=0;o<n;o++){var s=a[o],u=a[o+1],c=l(t,s,u,i),h=l(e,s,u,i);if(c<u&&h<u&&i[c]===t&&i[h]===e){if(r){var d=r[c];r[c]=r[h],r[h]=d}}else if(c<u&&i[c]===t&&(h>=u||i[h]!==e)){var f=r?r[c]:void 0;i.splice(h,0,e),r&&r.splice(h,0,f),i.splice(h<=c?c+1:c,1),r&&r.splice(h<=c?c+1:c,1)}else if(h<u&&i[h]===e&&(c>=u||i[c]!==t)){var p=r?r[h]:void 0;i.splice(c,0,t),r&&r.splice(c,0,p),i.splice(c<=h?h+1:h,1),r&&r.splice(c<=h?h+1:h,1)}}},i},{isClass:!0}),Nv=jm("matrix",["typed","Matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,Matrix:n,DenseMatrix:r,SparseMatrix:i}=t;return e("matrix",{"":function(){return a([])},string:function(t){return a([],t)},"string, string":function(t,e){return a([],t,e)},Array:function(t){return a(t)},Matrix:function(t){return a(t,t.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(t,e,n){if("dense"===e||"default"===e||void 0===e)return new r(t,n);if("sparse"===e)return new i(t,n);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}}),Rv=jm("algorithm01",["typed"],t=>{var{typed:e}=t;return function(t,n,r,i){var a=t._data,o=t._size,s=t._datatype,l=n._values,u=n._index,c=n._ptr,h=n._size,d=n._datatype;if(o.length!==h.length)throw new Pm(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p,m=o[0],g=o[1],v="string"==typeof s&&s===d?s:void 0,y=v?e.find(r,[v,v]):r,b=[];for(f=0;f<m;f++)b[f]=[];var x=[],_=[];for(p=0;p<g;p++){for(var w=p+1,S=c[p],E=c[p+1],M=S;M<E;M++)x[f=u[M]]=i?y(l[M],a[f][p]):y(a[f][p],l[M]),_[f]=w;for(f=0;f<m;f++)_[f]===w?b[f][p]=x[f]:b[f][p]=a[f][p]}return t.createDenseMatrix({data:b,size:[m,g],datatype:v})}}),Lv=jm("algorithm04",["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i){var a=t._values,o=t._index,s=t._ptr,l=t._size,u=t._datatype,c=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype;if(l.length!==f.length)throw new Pm(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],v=l[1],y=n,b=0,x=i;"string"==typeof u&&u===p&&(m=u,y=e.find(n,[m,m]),b=e.convert(0,m),x=e.find(i,[m,m]));var _,w,S,E,M,C=a&&c?[]:void 0,T=[],k=[],P=a&&c?[]:void 0,A=a&&c?[]:void 0,O=[],N=[];for(w=0;w<v;w++){k[w]=T.length;var R=w+1;for(E=s[w],M=s[w+1],S=E;S<M;S++)_=o[S],T.push(_),O[_]=R,P&&(P[_]=a[S]);for(E=d[w],M=d[w+1],S=E;S<M;S++)if(O[_=h[S]]===R){if(P){var L=x(P[_],c[S]);y(L,b)?O[_]=null:P[_]=L}}else T.push(_),N[_]=R,A&&(A[_]=c[S]);if(P&&A)for(S=k[w];S<T.length;)O[_=T[S]]===R?(C[S]=P[_],S++):N[_]===R?(C[S]=A[_],S++):T.splice(S,1)}return k[v]=T.length,t.createSparseMatrix({values:C,index:T,ptr:k,size:[g,v],datatype:m})}}),Iv=jm("algorithm10",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:n}=t;return function(t,r,i,a){var o=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=u[0],f=u[1],p=i;"string"==typeof c&&(h=c,r=e.convert(r,h),p=e.find(i,[h,h]));for(var m=[],g=[],v=[],y=0;y<f;y++){for(var b=y+1,x=l[y],_=l[y+1],w=x;w<_;w++){var S=s[w];g[S]=o[w],v[S]=b}for(var E=0;E<d;E++)0===y&&(m[E]=[]),v[E]===b?m[E][y]=a?p(r,g[E]):p(g[E],r):m[E][y]=r}return new n({data:m,size:[d,f],datatype:h})}}),Dv=jm("algorithm13",["typed"],t=>{var{typed:e}=t;return function(t,n,r){var i,a=t._data,o=t._size,s=t._datatype,l=n._data,u=n._size,c=n._datatype,h=[];if(o.length!==u.length)throw new Pm(o.length,u.length);for(var d=0;d<o.length;d++){if(o[d]!==u[d])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+u+")");h[d]=o[d]}var f=r;"string"==typeof s&&s===c&&(i=s,f=e.find(r,[i,i]));var p=h.length>0?function t(e,n,r,i,a,o){var s=[];if(n===r.length-1)for(var l=0;l<i;l++)s[l]=e(a[l],o[l]);else for(var u=0;u<i;u++)s[u]=t(e,n+1,r,r[n+1],a[u],o[u]);return s}(f,0,h,h[0],a,l):[];return t.createDenseMatrix({data:p,size:h,datatype:i})}}),zv=jm("algorithm14",["typed"],t=>{var{typed:e}=t;return function(t,n,r,i){var a,o=t._data,s=t._size,l=t._datatype,u=r;"string"==typeof l&&(a=l,n=e.convert(n,a),u=e.find(r,[a,a]));var c=s.length>0?function t(e,n,r,i,a,o,s){var l=[];if(n===r.length-1)for(var u=0;u<i;u++)l[u]=s?e(o,a[u]):e(a[u],o);else for(var c=0;c<i;c++)l[c]=t(e,n+1,r,r[n+1],a[c],o,s);return l}(u,0,s,s[0],o,n,i):[];return t.createDenseMatrix({data:c,size:Zp(s),datatype:a})}}),Fv=jm("algorithm03",["typed"],t=>{var{typed:e}=t;return function(t,n,r,i){var a=t._data,o=t._size,s=t._datatype,l=n._values,u=n._index,c=n._ptr,h=n._size,d=n._datatype;if(o.length!==h.length)throw new Pm(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p=o[0],m=o[1],g=0,v=r;"string"==typeof s&&s===d&&(f=s,g=e.convert(0,f),v=e.find(r,[f,f]));for(var y=[],b=0;b<p;b++)y[b]=[];for(var x=[],_=[],w=0;w<m;w++){for(var S=w+1,E=c[w],M=c[w+1],C=E;C<M;C++){var T=u[C];x[T]=i?v(l[C],a[T][w]):v(a[T][w],l[C]),_[T]=S}for(var k=0;k<p;k++)_[k]===S?y[k][w]=x[k]:y[k][w]=i?v(g,a[k][w]):v(a[k][w],g)}return t.createDenseMatrix({data:y,size:[p,m],datatype:f})}}),Bv=jm("algorithm05",["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i){var a=t._values,o=t._index,s=t._ptr,l=t._size,u=t._datatype,c=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype;if(l.length!==f.length)throw new Pm(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],v=l[1],y=n,b=0,x=i;"string"==typeof u&&u===p&&(m=u,y=e.find(n,[m,m]),b=e.convert(0,m),x=e.find(i,[m,m]));var _,w,S,E,M=a&&c?[]:void 0,C=[],T=[],k=M?[]:void 0,P=M?[]:void 0,A=[],O=[];for(w=0;w<v;w++){T[w]=C.length;var N=w+1;for(S=s[w],E=s[w+1];S<E;S++)_=o[S],C.push(_),A[_]=N,k&&(k[_]=a[S]);for(S=d[w],E=d[w+1];S<E;S++)A[_=h[S]]!==N&&C.push(_),O[_]=N,P&&(P[_]=c[S]);if(M)for(S=T[w];S<C.length;){var R=A[_=C[S]],L=O[_];if(R===N||L===N){var I=x(R===N?k[_]:b,L===N?P[_]:b);y(I,b)?C.splice(S,1):(M.push(I),S++)}}}return T[v]=C.length,t.createSparseMatrix({values:M,index:C,ptr:T,size:[g,v],datatype:m})}}),Vv=jm("algorithm11",["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return function(t,r,i,a){var o=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=u[0],f=u[1],p=n,m=0,g=i;"string"==typeof c&&(h=c,p=e.find(n,[h,h]),m=e.convert(0,h),r=e.convert(r,h),g=e.find(i,[h,h]));for(var v=[],y=[],b=[],x=0;x<f;x++){b[x]=y.length;for(var _=l[x],w=l[x+1],S=_;S<w;S++){var E=s[S],M=a?g(r,o[S]):g(o[S],r);p(M,m)||(y.push(E),v.push(M))}}return b[f]=y.length,t.createSparseMatrix({values:v,index:y,ptr:b,size:[d,f],datatype:h})}}),jv=jm("algorithm12",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:n}=t;return function(t,r,i,a){var o=t._values,s=t._index,l=t._ptr,u=t._size,c=t._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=u[0],f=u[1],p=i;"string"==typeof c&&(h=c,r=e.convert(r,h),p=e.find(i,[h,h]));for(var m=[],g=[],v=[],y=0;y<f;y++){for(var b=y+1,x=l[y],_=l[y+1],w=x;w<_;w++){var S=s[w];g[S]=o[w],v[S]=b}for(var E=0;E<d;E++)0===y&&(m[E]=[]),v[E]===b?m[E][y]=a?p(r,g[E]):p(g[E],r):m[E][y]=a?p(r,0):p(0,r)}return new n({data:m,size:[d,f],datatype:h})}}),Hv=jm("algorithm07",["typed","DenseMatrix"],t=>{var{typed:e,DenseMatrix:n}=t;return function(t,i,a){var o=t._size,s=t._datatype,l=i._size,u=i._datatype;if(o.length!==l.length)throw new Pm(o.length,l.length);if(o[0]!==l[0]||o[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");var c,h,d,f=o[0],p=o[1],m=0,g=a;"string"==typeof s&&s===u&&(c=s,m=e.convert(0,c),g=e.find(a,[c,c]));var v=[];for(h=0;h<f;h++)v[h]=[];var y=[],b=[],x=[],_=[];for(d=0;d<p;d++){var w=d+1;for(r(t,d,x,y,w),r(i,d,_,b,w),h=0;h<f;h++){var S=x[h]===w?y[h]:m,E=_[h]===w?b[h]:m;v[h][d]=g(S,E)}}return new n({data:v,size:[f,p],datatype:c})};function r(t,e,n,r,i){for(var a=t._values,o=t._index,s=t._ptr,l=s[e],u=s[e+1];l<u;l++){var c=o[l];n[c]=i,r[c]=a[l]}}});var Uv=jm("diag",["typed","matrix","DenseMatrix","SparseMatrix"],t=>{var{typed:e,matrix:n,DenseMatrix:r,SparseMatrix:i}=t;return e("diag",{Array:function(t){return a(t,0,Om(t),null)},"Array, number":function(t,e){return a(t,e,Om(t),null)},"Array, BigNumber":function(t,e){return a(t,e.toNumber(),Om(t),null)},"Array, string":function(t,e){return a(t,0,Om(t),e)},"Array, number, string":function(t,e,n){return a(t,e,Om(t),n)},"Array, BigNumber, string":function(t,e,n){return a(t,e.toNumber(),Om(t),n)},Matrix:function(t){return a(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return a(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return a(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return a(t,0,t.size(),e)},"Matrix, number, string":function(t,e,n){return a(t,e,t.size(),n)},"Matrix, BigNumber, string":function(t,e,n){return a(t,e.toNumber(),t.size(),n)}});function a(t,e,a,o){if(!om(e))throw new TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,l=e<0?-e:0;switch(a.length){case 1:return function(t,e,n,a,o,s){var l=[a+o,a+s];if(n&&"sparse"!==n&&"dense"!==n)throw new TypeError("Unknown matrix type ".concat(n,'"'));var u="sparse"===n?i.diagonal(l,t,e):r.diagonal(l,t,e);return null!==n?u:u.valueOf()}(t,e,o,a[0],l,s);case 2:return function(t,e,r,i,a,o){if(bp(t)){var s=t.diagonal(e);return null!==r?r!==s.storage()?n(s,r):s:s.valueOf()}for(var l=Math.min(i[0]-a,i[1]-o),u=[],c=0;c<l;c++)u[c]=t[c+a][c+o];return null!==r?n(u):u}(t,e,o,a,l,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}}),Gv=jm("identity",["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],t=>{var{typed:e,config:n,matrix:r,BigNumber:i,DenseMatrix:a,SparseMatrix:o}=t;return e("identity",{"":function(){return"Matrix"===n.matrix?r([]):[]},string:function(t){return r(t)},"number | BigNumber":function(t){return l(t,t,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return l(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return l(t,e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,n){return l(t,e,n)},Array:function(t){return s(t)},"Array, string":function(t,e){return s(t,e)},Matrix:function(t){return s(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return s(t.valueOf(),e)}});function s(t,e){switch(t.length){case 0:return e?r(e):[];case 1:return l(t[0],t[0],e);case 2:return l(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function l(t,e,n){var r=fp(t)||fp(e)?i:null;if(fp(t)&&(t=t.toNumber()),fp(e)&&(e=e.toNumber()),!om(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!om(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var s=r?new i(1):1,l=r?new r(0):0,u=[t,e];if(n){if("sparse"===n)return o.diagonal(u,s,0,l);if("dense"===n)return a.diagonal(u,s,0,l);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var c=Lm([],u,l),h=t<e?t:e,d=0;d<h;d++)c[d][d]=s;return c}}),qv=jm("ones",["typed","config","matrix","BigNumber"],t=>{var{typed:e,config:n,matrix:r,BigNumber:i}=t;return e("ones",{"":function(){return"Array"===n.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var e=t.pop();return a(t,e)}return"Array"===n.matrix?a(t):a(t,"default")},Array:a,Matrix:function(t){var e=t.storage();return a(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return a(t.valueOf(),e)}});function a(t,e){var n=function(t){var e=!1;return t.forEach((function(t,n,r){fp(t)&&(e=!0,r[n]=t.toNumber())})),e}(t)?new i(1):1;if(function(t){t.forEach((function(t){if("number"!=typeof t||!om(t)||t<0)throw new Error("Parameters in function ones must be positive integers")}))}(t),e){var a=r(e);return t.length>0?a.resize(t,n):a}var o=[];return t.length>0?Lm(o,t,n):o}});function Wv(){throw new Error('No "bignumber" implementation available')}function $v(){throw new Error('No "fraction" implementation available')}function Yv(){throw new Error('No "matrix" implementation available')}var Qv=jm("size",["typed","config","?matrix"],t=>{var{typed:e,config:n,matrix:r}=t;return e("size",{Matrix:function(t){return t.create(t.size())},Array:Om,string:function(t){return"Array"===n.matrix?[t.length]:r([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===n.matrix?[]:r?r([]):Yv()}})});jm("hex",["typed","format"],t=>{var{typed:e,format:n}=t;return e("hex",{"number | BigNumber":function(t){return n(t,{notation:"hex"})},"number | BigNumber, number":function(t,e){return n(t,{notation:"hex",wordSize:e})}})});var Xv=jm("smaller",["typed","config","matrix","DenseMatrix"],t=>{var{typed:e,config:n,matrix:r,DenseMatrix:i}=t,a=Fv({typed:e}),o=Hv({typed:e,DenseMatrix:i}),s=jv({typed:e,DenseMatrix:i}),l=Dv({typed:e}),u=zv({typed:e});return e("smaller",{"boolean, boolean":function(t,e){return t<e},"number, number":function(t,e){return t<e&&!xm(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!vg(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return u(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, any":function(t,e){return u(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return u(r(e),t,this,!0).valueOf()}})}),Zv=jm("larger",["typed","config","matrix","DenseMatrix"],t=>{var{typed:e,config:n,matrix:r,DenseMatrix:i}=t,a=Fv({typed:e}),o=Hv({typed:e,DenseMatrix:i}),s=jv({typed:e,DenseMatrix:i}),l=Dv({typed:e}),u=zv({typed:e});return e("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,e){return t>e&&!xm(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!vg(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return u(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, any":function(t,e){return u(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return u(r(e),t,this,!0).valueOf()}})}),Jv=(jm("unequal",["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return e("unequal",{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:!n(t,e)}})}),jm("FibonacciHeap",["smaller","larger"],t=>{var{smaller:e,larger:n}=t,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function a(t,e,n){e.left.right=e.right,e.right.left=e.left,n.degree--,n.child===e&&(n.child=e.right),0===n.degree&&(n.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(t,n){var r={key:t,value:n,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,e(t,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var i=this._minimum,a=t.degree,s=t.child;a>0;){var l=s.right;s.left.right=s.right,s.right.left=s.left,s.left=i,s.right=i.right,i.right=s,s.right.left=s,s.parent=null,s=l,a--}return t.left.right=t.right,t.right.left=t.left,i=t===t.right?null:function(t,i){var a,s=Math.floor(Math.log(i)*r)+1,l=new Array(s),u=0,c=t;if(c)for(u++,c=c.right;c!==t;)u++,c=c.right;for(;u>0;){for(var h=c.degree,d=c.right;a=l[h];){if(n(c.key,a.key)){var f=a;a=c,c=f}o(a,c),l[h]=null,h++}l[h]=c,c=d,u--}t=null;for(var p=0;p<s;p++)(a=l[p])&&(t?(a.left.right=a.right,a.right.left=a.left,a.left=t,a.right=t.right,t.right=a,a.right.left=a,e(a.key,t.key)&&(t=a)):t=a);return t}(i=t.right,this._size),this._size--,this._minimum=i,t},i.prototype.remove=function(t){this._minimum=function(t,n,r){n.key=r;var i=n.parent;i&&e(n.key,i.key)&&(a(t,n,i),function t(e,n){var r=n.parent;if(!r)return;n.mark?(a(e,n,r),t(r)):n.mark=!0}(t,i));e(n.key,t.key)&&(t=n);return t}(this._minimum,t,-1),this.extractMinimum()};var o=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};return i},{isClass:!0})),Kv=jm("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],t=>{var{typed:e,matrix:n,addScalar:r,equalScalar:i,DenseMatrix:a,SparseMatrix:o}=t,s=Rv({typed:e}),l=Lv({typed:e,equalScalar:i}),u=Iv({typed:e,DenseMatrix:a}),c=Dv({typed:e}),h=zv({typed:e});return e("add",Kp({"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,r)},"DenseMatrix, SparseMatrix":function(t,e){return s(t,e,r,!1)},"SparseMatrix, DenseMatrix":function(t,e){return s(e,t,r,!0)},"SparseMatrix, SparseMatrix":function(t,e){return l(t,e,r)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"DenseMatrix, any":function(t,e){return h(t,e,r,!1)},"SparseMatrix, any":function(t,e){return u(t,e,r,!1)},"any, DenseMatrix":function(t,e){return h(e,t,r,!0)},"any, SparseMatrix":function(t,e){return u(e,t,r,!0)},"Array, any":function(t,e){return h(n(t),e,r,!1).valueOf()},"any, Array":function(t,e){return h(n(e),t,r,!0).valueOf()},"any, any":r,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},r.signatures))}),ty=jm("dot",["typed","addScalar","multiplyScalar","conj","size"],t=>{var{typed:e,addScalar:n,multiplyScalar:r,conj:i,size:a}=t;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,a){var l=o(t,a),u=bp(t)?t._data:t,c=bp(t)?t._datatype:void 0,h=bp(a)?a._data:a,d=bp(a)?a._datatype:void 0,f=2===s(t).length,p=2===s(a).length,m=n,g=r;if(c&&d&&c===d&&"string"==typeof c){var v=c;m=e.find(n,[v,v]),g=e.find(r,[v,v])}if(!f&&!p){for(var y=g(i(u[0]),h[0]),b=1;b<l;b++)y=m(y,g(i(u[b]),h[b]));return y}if(!f&&p){for(var x=g(i(u[0]),h[0][0]),_=1;_<l;_++)x=m(x,g(i(u[_]),h[_][0]));return x}if(f&&!p){for(var w=g(i(u[0][0]),h[0]),S=1;S<l;S++)w=m(w,g(i(u[S][0]),h[S]));return w}if(f&&p){for(var E=g(i(u[0][0]),h[0][0]),M=1;M<l;M++)E=m(E,g(i(u[M][0]),h[M][0]));return E}},"SparseMatrix, SparseMatrix":function(t,e){o(t,e);var i=t._index,a=t._values,s=e._index,l=e._values,u=0,c=n,h=r,d=0,f=0;for(;d<i.length&&f<s.length;){var p=i[d],m=s[f];p<m?d++:p>m?f++:p===m&&(u=c(u,h(a[d],l[f])),d++,f++)}return u}});function o(t,e){var n,r,i=s(t),a=s(e);if(1===i.length)n=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");n=i[0]}if(1===a.length)r=a[0];else{if(2!==a.length||1!==a[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");r=a[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}function s(t){return bp(t)?t.size():a(t)}}),ey=jm("abs",["typed"],t=>{var{typed:e}=t;return e("abs",{number:_g,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return dg(t,this,!0)},Unit:function(t){return t.abs()}})}),ny=jm("multiply",["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],t=>{var{typed:e,matrix:n,addScalar:r,multiplyScalar:i,equalScalar:a,dot:o}=t,s=Vv({typed:e,equalScalar:a}),l=zv({typed:e});function u(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}function c(t,n){if("dense"!==n.storage())throw new Error("Support for SparseMatrix not implemented");return function(t,n){var a,o=t._data,s=t._size,l=t._datatype,u=n._data,c=n._size,h=n._datatype,d=s[0],f=c[1],p=r,m=i;l&&h&&l===h&&"string"==typeof l&&(a=l,p=e.find(r,[a,a]),m=e.find(i,[a,a]));for(var g=[],v=0;v<f;v++){for(var y=m(o[0],u[0][v]),b=1;b<d;b++)y=p(y,m(o[b],u[b][v]));g[v]=y}return t.createDenseMatrix({data:g,size:[f],datatype:a})}(t,n)}var h=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,n){var a,o=t._data,s=t._size,l=t._datatype,u=n._data,c=n._datatype,h=s[0],d=s[1],f=r,p=i;l&&c&&l===c&&"string"==typeof l&&(a=l,f=e.find(r,[a,a]),p=e.find(i,[a,a]));for(var m=[],g=0;g<h;g++){for(var v=o[g],y=p(v[0],u[0]),b=1;b<d;b++)y=f(y,p(v[b],u[b]));m[g]=y}return t.createDenseMatrix({data:m,size:[h],datatype:a})},"SparseMatrix, any":function(t,n){var o=t._values,s=t._index,l=t._ptr,u=t._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,h=n._data,d=n._datatype,f=t._size[0],p=n._size[0],m=[],g=[],v=[],y=r,b=i,x=a,_=0;u&&d&&u===d&&"string"==typeof u&&(c=u,y=e.find(r,[c,c]),b=e.find(i,[c,c]),x=e.find(a,[c,c]),_=e.convert(0,c));var w=[],S=[];v[0]=0;for(var E=0;E<p;E++){var M=h[E];if(!x(M,_))for(var C=l[E],T=l[E+1],k=C;k<T;k++){var P=s[k];S[P]?w[P]=y(w[P],b(M,o[k])):(S[P]=!0,g.push(P),w[P]=b(M,o[k]))}}for(var A=g.length,O=0;O<A;O++){var N=g[O];m[O]=w[N]}return v[1]=g.length,t.createSparseMatrix({values:m,index:g,ptr:v,size:[f,1],datatype:c})}}),d=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,n){var a,o=t._data,s=t._size,l=t._datatype,u=n._data,c=n._size,h=n._datatype,d=s[0],f=s[1],p=c[1],m=r,g=i;l&&h&&l===h&&"string"==typeof l&&(a=l,m=e.find(r,[a,a]),g=e.find(i,[a,a]));for(var v=[],y=0;y<d;y++){var b=o[y];v[y]=[];for(var x=0;x<p;x++){for(var _=g(b[0],u[0][x]),w=1;w<f;w++)_=m(_,g(b[w],u[w][x]));v[y][x]=_}}return t.createDenseMatrix({data:v,size:[d,p],datatype:a})},"DenseMatrix, SparseMatrix":function(t,n){var o=t._data,s=t._size,l=t._datatype,u=n._values,c=n._index,h=n._ptr,d=n._size,f=n._datatype;if(!u)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,m=s[0],g=d[1],v=r,y=i,b=a,x=0;l&&f&&l===f&&"string"==typeof l&&(p=l,v=e.find(r,[p,p]),y=e.find(i,[p,p]),b=e.find(a,[p,p]),x=e.convert(0,p));for(var _=[],w=[],S=[],E=n.createSparseMatrix({values:_,index:w,ptr:S,size:[m,g],datatype:p}),M=0;M<g;M++){S[M]=w.length;var C=h[M],T=h[M+1];if(T>C)for(var k=0,P=0;P<m;P++){for(var A=P+1,O=void 0,N=C;N<T;N++){var R=c[N];k!==A?(O=y(o[P][R],u[N]),k=A):O=v(O,y(o[P][R],u[N]))}k!==A||b(O,x)||(w.push(P),_.push(O))}}return S[g]=w.length,E},"SparseMatrix, DenseMatrix":function(t,n){var o=t._values,s=t._index,l=t._ptr,u=t._datatype;if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,h=n._data,d=n._datatype,f=t._size[0],p=n._size[0],m=n._size[1],g=r,v=i,y=a,b=0;u&&d&&u===d&&"string"==typeof u&&(c=u,g=e.find(r,[c,c]),v=e.find(i,[c,c]),y=e.find(a,[c,c]),b=e.convert(0,c));for(var x=[],_=[],w=[],S=t.createSparseMatrix({values:x,index:_,ptr:w,size:[f,m],datatype:c}),E=[],M=[],C=0;C<m;C++){w[C]=_.length;for(var T=C+1,k=0;k<p;k++){var P=h[k][C];if(!y(P,b))for(var A=l[k],O=l[k+1],N=A;N<O;N++){var R=s[N];M[R]!==T?(M[R]=T,_.push(R),E[R]=v(P,o[N])):E[R]=g(E[R],v(P,o[N]))}}for(var L=w[C],I=_.length,D=L;D<I;D++){var z=_[D];x[D]=E[z]}}return w[m]=_.length,S},"SparseMatrix, SparseMatrix":function(t,n){var a,o=t._values,s=t._index,l=t._ptr,u=t._datatype,c=n._values,h=n._index,d=n._ptr,f=n._datatype,p=t._size[0],m=n._size[1],g=o&&c,v=r,y=i;u&&f&&u===f&&"string"==typeof u&&(a=u,v=e.find(r,[a,a]),y=e.find(i,[a,a]));for(var b,x,_,w,S,E,M,C,T=g?[]:void 0,k=[],P=[],A=t.createSparseMatrix({values:T,index:k,ptr:P,size:[p,m],datatype:a}),O=g?[]:void 0,N=[],R=0;R<m;R++){P[R]=k.length;var L=R+1;for(S=d[R],E=d[R+1],w=S;w<E;w++)if(C=h[w],g)for(x=l[C],_=l[C+1],b=x;b<_;b++)M=s[b],N[M]!==L?(N[M]=L,k.push(M),O[M]=y(c[w],o[b])):O[M]=v(O[M],y(c[w],o[b]));else for(x=l[C],_=l[C+1],b=x;b<_;b++)M=s[b],N[M]!==L&&(N[M]=L,k.push(M));if(g)for(var I=P[R],D=k.length,z=I;z<D;z++){var F=k[z];T[z]=O[F]}}return P[m]=k.length,A}});return e("multiply",Kp({"Array, Array":function(t,e){u(Om(t),Om(e));var r=this(n(t),n(e));return bp(r)?r.valueOf():r},"Matrix, Matrix":function(t,e){var n=t.size(),r=e.size();return u(n,r),1===n.length?1===r.length?function(t,e,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return o(t,e)}(t,e,n[0]):c(t,e):1===r.length?h(t,e):d(t,e)},"Matrix, Array":function(t,e){return this(t,n(e))},"Array, Matrix":function(t,e){return this(n(t,e.storage()),e)},"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return l(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return l(e,t,i,!0)},"Array, any":function(t,e){return l(n(t),e,i,!1).valueOf()},"any, Array":function(t,e){return l(n(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},i.signatures))});function ry(t,e,n,r){if(!(this instanceof ry))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+n+(null!=r?"-"+r:"")+" expected)",this.stack=(new Error).stack}ry.prototype=new Error,ry.prototype.constructor=Error,ry.prototype.name="ArgumentsError",ry.prototype.isArgumentsError=!0;n(25);function iy(t){var e;if(om(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:xv(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*iy(1-t));if(t>=171.35)return 1/0;if(t>85){var n=t*t,r=n*t,i=r*t,a=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*n)-139/(51840*r)-571/(2488320*i)+163879/(209018880*a)+5246819/(75246796800*a*t))}--t,e=oy[0];for(var o=1;o<oy.length;++o)e+=oy[o]/(t+o);var s=t+ay+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,t+.5)*Math.exp(-s)*e}iy.signature="number";var ay=4.7421875,oy=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],sy=jm("bignumber",["typed","BigNumber"],t=>{var{typed:e,BigNumber:n}=t;return e("bignumber",{"":function(){return new n(0)},number:function(t){return new n(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var r=e[2],i=n(e[1]),a=new n(2).pow(Number(r));if(i.gt(a.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var o=new n(2).pow(Number(r)-1);return i.gte(o)?i.sub(a):i}return new n(t)},BigNumber:function(t){return t},Fraction:function(t){return new n(t.n).div(t.d).times(t.s)},null:function(t){return new n(0)},"Array | Matrix":function(t){return dg(t,this)}})}),ly=jm("transpose",["typed","matrix"],t=>{var{typed:e,matrix:n}=t;return e("transpose",{Array:function(t){return this(n(t)).valueOf()},Matrix:function(t){var e,n=t.size();switch(n.length){case 1:e=t.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+km(n)+")");switch(t.storage()){case"dense":e=function(t,e,n){for(var r,i=t._data,a=[],o=0;o<n;o++){r=a[o]=[];for(var s=0;s<e;s++)r[s]=Zp(i[s][o])}return t.createDenseMatrix({data:a,size:[n,e],datatype:t._datatype})}(t,r,i);break;case"sparse":e=function(t,e,n){for(var r,i,a,o=t._values,s=t._index,l=t._ptr,u=o?[]:void 0,c=[],h=[],d=[],f=0;f<e;f++)d[f]=0;for(r=0,i=s.length;r<i;r++)d[s[r]]++;for(var p=0,m=0;m<e;m++)h.push(p),p+=d[m],d[m]=h[m];for(h.push(p),a=0;a<n;a++)for(var g=l[a],v=l[a+1],y=g;y<v;y++){var b=d[s[y]]++;c[b]=a,o&&(u[b]=Zp(o[y]))}return t.createSparseMatrix({values:u,index:c,ptr:h,size:[n,e],datatype:t._datatype})}(t,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+km(this._size)+")")}return e},any:function(t){return Zp(t)}})}),uy=jm("numeric",["number","?bignumber","?fraction"],t=>{var{number:e,bignumber:n,fraction:r}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:t=>e(t),BigNumber:n?t=>n(t):Wv,Fraction:r?t=>r(t):$v};return function(t,e){var n=Xp(t);if(!(n in i))throw new TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in a))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(a).join(", "));return e===n?t:a[e](t)}});var cy=jm("subtract",["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],t=>{var{typed:e,matrix:n,equalScalar:r,addScalar:i,unaryMinus:a,DenseMatrix:o}=t,s=Rv({typed:e}),l=Fv({typed:e}),u=Bv({typed:e,equalScalar:r}),c=Iv({typed:e,DenseMatrix:o}),h=Dv({typed:e}),d=zv({typed:e});return e("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n},"SparseMatrix, SparseMatrix":function(t,e){return hy(t,e),u(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return hy(t,e),l(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return hy(t,e),s(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return hy(t,e),h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return c(t,a(e),i)},"DenseMatrix, any":function(t,e){return d(t,e,this)},"any, SparseMatrix":function(t,e){return c(e,t,this,!0)},"any, DenseMatrix":function(t,e){return d(e,t,this,!0)},"Array, any":function(t,e){return d(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return d(n(e),t,this,!0).valueOf()}})});function hy(t,e){var n=t.size(),r=e.size();if(n.length!==r.length)throw new Pm(n.length,r.length)}var dy=jm("equal",["typed","matrix","equalScalar","DenseMatrix"],t=>{var{typed:e,matrix:n,equalScalar:r,DenseMatrix:i}=t,a=Fv({typed:e}),o=Hv({typed:e,DenseMatrix:i}),s=jv({typed:e,DenseMatrix:i}),l=Dv({typed:e}),u=zv({typed:e});return e("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)},"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,r)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,r,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,r,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,r)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return s(t,e,r,!1)},"DenseMatrix, any":function(t,e){return u(t,e,r,!1)},"any, SparseMatrix":function(t,e){return s(e,t,r,!0)},"any, DenseMatrix":function(t,e){return u(e,t,r,!0)},"Array, any":function(t,e){return u(n(t),e,r,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,r,!0).valueOf()}})}),fy=(jm("equal",["typed","equalScalar"],t=>{var{typed:e,equalScalar:n}=t;return e("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:n(t,e)}})}),jm("divideScalar",["typed","numeric"],t=>{var{typed:e,numeric:n}=t;return e("divideScalar",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var r=t.clone(),i=n(1,Xp(e));return r.value=this(null===r.value?r._normalize(i):r.value,e),r},"number | Fraction | BigNumber, Unit":function(t,e){var r=e.clone();r=r.pow(-1);var i=n(1,Xp(t));return r.value=this(t,null===e.value?e._normalize(i):e.value),r},"Unit, Unit":function(t,e){return t.divide(e)}})}));var py=jm("Spa",["addScalar","equalScalar","FibonacciHeap"],t=>{var{addScalar:e,equalScalar:n,FibonacciHeap:r}=t;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var n=this._heap.insert(t,e);this._values[t]=n}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,n){var r=this._values[t];r?r.value=e(r.value,n):(r=this._heap.insert(t,n),this._values[t]=r)},i.prototype.forEach=function(t,e,r){var i=this._heap,a=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=e;)s.key>=t&&(n(s.value,0)||r(s.key,s.value,this)),(s=i.extractMinimum())&&o.push(s);for(var l=0;l<o.length;l++){var u=o[l];a[(s=i.insert(u.key,u.value)).key]=s}},i.prototype.swap=function(t,e){var n=this._values[t],r=this._values[e];if(!n&&r)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(n&&!r)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i},{isClass:!0}),my=jm("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],t=>{var{typed:e,matrix:n,abs:r,addScalar:i,divideScalar:a,multiplyScalar:o,subtract:s,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:h,SparseMatrix:d,Spa:f}=t;return e("lup",{DenseMatrix:function(t){return p(t)},SparseMatrix:function(t){return m(t)},Array:function(t){var e=p(n(t));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function p(t){var e,n,c,d=t._size[0],f=t._size[1],p=Math.min(d,f),m=Zp(t._data),g=[],v=[d,p],y=[],b=[p,f],x=[];for(e=0;e<d;e++)x[e]=e;for(n=0;n<f;n++){if(n>0)for(e=0;e<d;e++){var _=Math.min(e,n),w=0;for(c=0;c<_;c++)w=i(w,o(m[e][c],m[c][n]));m[e][n]=s(m[e][n],w)}var S=n,E=0,M=0;for(e=n;e<d;e++){var C=m[e][n],T=r(C);l(T,E)&&(S=e,E=T,M=C)}if(n!==S&&(x[n]=[x[S],x[S]=x[n]][0],h._swapRows(n,S,m)),n<d)for(e=n+1;e<d;e++){var k=m[e][n];u(k,0)||(m[e][n]=a(m[e][n],M))}}for(n=0;n<f;n++)for(e=0;e<d;e++)0===n&&(e<f&&(y[e]=[]),g[e]=[]),e<n?(e<f&&(y[e][n]=m[e][n]),n<d&&(g[e][n]=0)):e!==n?(e<f&&(y[e][n]=0),n<d&&(g[e][n]=m[e][n])):(e<f&&(y[e][n]=m[e][n]),n<d&&(g[e][n]=1));var P=new h({data:g,size:v}),A=new h({data:y,size:b}),O=[];for(e=0,p=x.length;e<p;e++)O[x[e]]=e;return{L:P,U:A,p:O,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function m(t){var e,n,i,s=t._size[0],h=t._size[1],p=Math.min(s,h),m=t._values,g=t._index,v=t._ptr,y=[],b=[],x=[],_=[s,p],w=[],S=[],E=[],M=[p,h],C=[],T=[];for(e=0;e<s;e++)C[e]=e,T[e]=e;var k=function(){var t=new f;n<s&&(x.push(y.length),y.push(1),b.push(n)),E.push(w.length);var h=v[n],p=v[n+1];for(i=h;i<p;i++)e=g[i],t.set(C[e],m[i]);n>0&&t.forEach(0,n-1,(function(e,n){d._forEachRow(e,y,b,x,(function(r,i){r>e&&t.accumulate(r,c(o(i,n)))}))}));var k=n,P=t.get(n),A=r(P);t.forEach(n+1,s-1,(function(t,e){var n=r(e);l(n,A)&&(k=t,A=n,P=e)})),n!==k&&(d._swapRows(n,k,_[1],y,b,x),d._swapRows(n,k,M[1],w,S,E),t.swap(n,k),function(t,e){var n=T[t],r=T[e];C[n]=e,C[r]=t,T[t]=r,T[e]=n}(n,k)),t.forEach(0,s-1,(function(t,e){t<=n?(w.push(e),S.push(t)):(e=a(e,P),u(e,0)||(y.push(e),b.push(t)))}))};for(n=0;n<h;n++)k();return E.push(w.length),x.push(y.length),{L:new d({values:y,index:b,ptr:x,size:_}),U:new d({values:w,index:S,ptr:E,size:M}),p:C,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}});var gy=jm("det",["typed","matrix","subtract","multiply","unaryMinus","lup"],t=>{var{typed:e,matrix:n,subtract:r,multiply:i,unaryMinus:a,lup:o}=t;return e("det",{any:function(t){return Zp(t)},"Array | Matrix":function(t){var e;switch((e=bp(t)?t.size():Array.isArray(t)?(t=n(t)).size():[]).length){case 0:return Zp(t);case 1:if(1===e[0])return Zp(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+km(e)+")");case 2:var s=e[0],l=e[1];if(s===l)return function(t,e,n){if(1===e)return Zp(t[0][0]);if(2===e)return r(i(t[0][0],t[1][1]),i(t[1][0],t[0][1]));for(var s=o(t),l=s.U[0][0],u=1;u<e;u++)l=i(l,s.U[u][u]);for(var c=0,h=0,d=[];;){for(;d[h];)h++;if(h>=e)break;for(var f=h,p=0;!d[s.p[f]];)d[s.p[f]]=!0,f=s.p[f],p++;p%2==0&&c++}return c%2==0?l:a(l)}(t.clone().valueOf(),s);throw new RangeError("Matrix must be square (size: "+km(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+km(e)+")")}}})});var vy=jm("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],t=>{var{typed:e,matrix:n,divideScalar:r,addScalar:i,multiply:a,unaryMinus:o,det:s,identity:l,abs:u}=t;return e("inv",{"Array | Matrix":function(t){var e=bp(t)?t.size():Om(t);switch(e.length){case 1:if(1===e[0])return bp(t)?n([r(1,t.valueOf()[0])]):[r(1,t[0])];throw new RangeError("Matrix must be square (size: "+km(e)+")");case 2:var i=e[0],a=e[1];if(i===a)return bp(t)?n(c(t.valueOf(),i,a),t.storage()):c(t,i,a);throw new RangeError("Matrix must be square (size: "+km(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+km(e)+")")}},any:function(t){return r(1,t)}});function c(t,e,n){var c,h,d,f,p;if(1===e){if(0===(f=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,f)]]}if(2===e){var m=s(t);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[r(t[1][1],m),r(o(t[0][1]),m)],[r(o(t[1][0]),m),r(t[0][0],m)]]}var g=t.concat();for(c=0;c<e;c++)g[c]=g[c].concat();for(var v=l(e).valueOf(),y=0;y<n;y++){var b=u(g[y][y]),x=y;for(c=y+1;c<e;)u(g[c][y])>b&&(b=u(g[c][y]),x=c),c++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");(c=x)!==y&&(p=g[y],g[y]=g[c],g[c]=p,p=v[y],v[y]=v[c],v[c]=p);var _=g[y],w=v[y];for(c=0;c<e;c++){var S=g[c],E=v[c];if(c!==y){if(0!==S[y]){for(d=r(o(S[y]),_[y]),h=y;h<n;h++)S[h]=i(S[h],a(d,_[h]));for(h=0;h<n;h++)E[h]=i(E[h],a(d,w[h]))}}else{for(d=_[y],h=y;h<n;h++)S[h]=r(S[h],d);for(h=0;h<n;h++)E[h]=r(E[h],d)}}}return v}});var yy=jm("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","inv","bignumber","multiply","add"],t=>{var{config:e,typed:n,matrix:r,addScalar:i,subtract:a,equal:o,abs:s,atan:l,cos:u,sin:c,multiplyScalar:h,inv:d,bignumber:f,multiply:p,add:m}=t;return n("eigs",{Array:function(t){var e=r(t),n=e.size();if(2!==n.length||n[0]!==n[1])throw new RangeError("Matrix must be square (size: "+km(n)+")");var i=g(e,n[0]);return{values:i[0],vectors:i[1]}},Matrix:function(t){var e=t.size();if(2!==e.length||e[0]!==e[1])throw new RangeError("Matrix must be square (size: "+km(e)+")");var n=g(t,e[0]);return{values:r(n[0]),vectors:r(n[1])}}});function g(t,n){var r=t.datatype();if(void 0===r&&(r=t.getDataType()),"number"!==r&&"BigNumber"!==r&&"Fraction"!==r)throw"mixed"===r?new TypeError("Mixed matrix element type is not supported"):new TypeError("Matrix element type not supported ("+r+")");if(function(t,e){for(var n=0;n<e;n++)for(var r=n;r<e;r++)if(!o(t[n][r],t[r][n]))throw new TypeError("Input matrix is not symmetric")}(t.toArray(),n),"number"===r)return v(t.toArray());if("Fraction"===r){for(var i=t.toArray(),a=0;a<n;a++)for(var l=a;l<n;l++)i[a][l]=i[a][l].valueOf(),i[l][a]=i[a][l];return v(t.toArray())}return"BigNumber"===r?function(t){for(var n,r=t.length,i=s(e.epsilon/r),a=new Array(r),o=0;o<r;o++)a[o]=T(r,0),a[o][o]=1;var l=M(t);for(;s(l[1])>=s(i);){var u=l[0][0],c=l[0][1];n=b(t[u][u],t[c][c],t[u][c]),t=w(t,n,u,c),a=_(a,n,u,c),l=M(t)}for(var h=T(r,0),d=0;d<r;d++)h[d]=t[d][d];return C(Zp(h),Zp(a))}(t.toArray()):void 0}function v(t){for(var n,r=t.length,i=Math.abs(e.epsilon/r),a=new Array(r),o=0;o<r;o++)a[o]=T(r,0),a[o][o]=1;for(var s=E(t);Math.abs(s[1])>=Math.abs(i);){var l=s[0][0],u=s[0][1];t=S(t,n=y(t[l][l],t[u][u],t[l][u]),l,u),a=x(a,n,l,u),s=E(t)}for(var c=T(r,0),h=0;h<r;h++)c[h]=t[h][h];return C(Zp(c),Zp(a))}function y(t,n,r){var i=n-t;return Math.abs(i)<=e.epsilon?Math.PI/4:.5*Math.atan(2*r/(n-t))}function b(t,n,r){var i=a(n,t);return s(i)<=e.epsilon?f(-1).acos().div(4):h(.5,l(p(2,r,d(i))))}function x(t,e,n,r){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=T(i,0),l=T(i,0),u=0;u<i;u++)s[u]=a*t[u][n]-o*t[u][r],l[u]=o*t[u][n]+a*t[u][r];for(var c=0;c<i;c++)t[c][n]=s[c],t[c][r]=l[c];return t}function _(t,e,n,r){for(var o=t.length,s=u(e),l=c(e),d=T(o,f(0)),p=T(o,f(0)),m=0;m<o;m++)d[m]=a(h(s,t[m][n]),h(l,t[m][r])),p[m]=i(h(l,t[m][n]),h(s,t[m][r]));for(var g=0;g<o;g++)t[g][n]=d[g],t[g][r]=p[g];return t}function w(t,e,n,r){for(var o=t.length,s=f(u(e)),l=f(c(e)),d=h(s,s),g=h(l,l),v=T(o,f(0)),y=T(o,f(0)),b=p(f(2),s,l,t[n][r]),x=i(a(h(d,t[n][n]),b),h(g,t[r][r])),_=m(h(g,t[n][n]),b,h(d,t[r][r])),w=0;w<o;w++)v[w]=a(h(s,t[n][w]),h(l,t[r][w])),y[w]=i(h(l,t[n][w]),h(s,t[r][w]));t[n][n]=x,t[r][r]=_,t[n][r]=f(0),t[r][n]=f(0);for(var S=0;S<o;S++)S!==n&&S!==r&&(t[n][S]=v[S],t[S][n]=v[S],t[r][S]=y[S],t[S][r]=y[S]);return t}function S(t,e,n,r){for(var i=t.length,a=Math.cos(e),o=Math.sin(e),s=a*a,l=o*o,u=T(i,0),c=T(i,0),h=s*t[n][n]-2*a*o*t[n][r]+l*t[r][r],d=l*t[n][n]+2*a*o*t[n][r]+s*t[r][r],f=0;f<i;f++)u[f]=a*t[n][f]-o*t[r][f],c[f]=o*t[n][f]+a*t[r][f];t[n][n]=h,t[r][r]=d,t[n][r]=0,t[r][n]=0;for(var p=0;p<i;p++)p!==n&&p!==r&&(t[n][p]=u[p],t[p][n]=u[p],t[r][p]=c[p],t[p][r]=c[p]);return t}function E(t){for(var e=t.length,n=0,r=[0,1],i=0;i<e;i++)for(var a=i+1;a<e;a++)Math.abs(n)<Math.abs(t[i][a])&&(n=Math.abs(t[i][a]),r=[i,a]);return[r,n]}function M(t){for(var e=t.length,n=0,r=[0,1],i=0;i<e;i++)for(var a=i+1;a<e;a++)s(n)<s(t[i][a])&&(n=s(t[i][a]),r=[i,a]);return[r,n]}function C(t,e){for(var n=t.length,r=Array(n),i=Array(n),a=0;a<n;a++)i[a]=Array(n);for(var o=0;o<n;o++){for(var s=0,l=t[0],u=0;u<t.length;u++)t[u]<l&&(l=t[s=u]);r[o]=t.splice(s,1)[0];for(var c=0;c<n;c++)i[c][o]=e[c][s],e[c].splice(s,1)}return[Zp(r),Zp(i)]}function T(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e;return n}});var by=qm({}),xy=Jm({config:am}),_y=Km({}),wy=rg({}),Sy=ig({Matrix:_y}),Ey=lg({BigNumber:xy,Complex:by,DenseMatrix:Sy,Fraction:wy}),My=yg({config:am,typed:Ey}),Cy=bg({typed:Ey}),Ty=Ug({typed:Ey}),ky=Gg({typed:Ey}),Py=bv({typed:Ey}),Ay=Ev({Fraction:wy,typed:Ey}),Oy=Mv({typed:Ey}),Ny=Cv({typed:Ey}),Ry=Tv({Complex:by,config:am,typed:Ey}),Ly=kv({typed:Ey}),Iy=Pv({typed:Ey}),Dy=Av({typed:Ey}),zy=Ov({Matrix:_y,equalScalar:My,typed:Ey}),Fy=Nv({DenseMatrix:Sy,Matrix:_y,SparseMatrix:zy,typed:Ey}),By=Uv({DenseMatrix:Sy,SparseMatrix:zy,matrix:Fy,typed:Ey}),Vy=Gv({BigNumber:xy,DenseMatrix:Sy,SparseMatrix:zy,config:am,matrix:Fy,typed:Ey}),jy=qv({BigNumber:xy,config:am,matrix:Fy,typed:Ey}),Hy=Qv({matrix:Fy,config:am,typed:Ey}),Uy=Xv({DenseMatrix:Sy,config:am,matrix:Fy,typed:Ey}),Gy=Zv({DenseMatrix:Sy,config:am,matrix:Fy,typed:Ey}),qy=Jv({larger:Gy,smaller:Uy}),Wy=Kv({DenseMatrix:Sy,SparseMatrix:zy,addScalar:Ny,equalScalar:My,matrix:Fy,typed:Ey}),$y=ty({addScalar:Ny,conj:Ly,multiplyScalar:Ty,size:Hy,typed:Ey}),Yy=ey({typed:Ey}),Qy=ny({addScalar:Ny,dot:$y,equalScalar:My,matrix:Fy,multiplyScalar:Ty,typed:Ey}),Xy=sy({BigNumber:xy,typed:Ey}),Zy=ly({matrix:Fy,typed:Ey}),Jy=uy({bignumber:Xy,fraction:Ay,number:Cy}),Ky=cy({DenseMatrix:Sy,addScalar:Ny,equalScalar:My,matrix:Fy,typed:Ey,unaryMinus:Oy}),tb=dy({DenseMatrix:Sy,equalScalar:My,matrix:Fy,typed:Ey}),eb=fy({numeric:Jy,typed:Ey}),nb=py({FibonacciHeap:qy,addScalar:Ny,equalScalar:My}),rb=my({DenseMatrix:Sy,Spa:nb,SparseMatrix:zy,abs:Yy,addScalar:Ny,divideScalar:eb,equalScalar:My,larger:Gy,matrix:Fy,multiplyScalar:Ty,subtract:Ky,typed:Ey,unaryMinus:Oy}),ib=gy({lup:rb,matrix:Fy,multiply:Qy,subtract:Ky,typed:Ey,unaryMinus:Oy}),ab=vy({abs:Yy,addScalar:Ny,det:ib,divideScalar:eb,identity:Vy,matrix:Fy,multiply:Qy,typed:Ey,unaryMinus:Oy}),ob=yy({abs:Yy,add:Wy,addScalar:Ny,atan:Py,bignumber:Xy,config:am,cos:Iy,equal:tb,inv:ab,matrix:Fy,multiply:Qy,multiplyScalar:Ty,sin:Dy,subtract:Ky,typed:Ey});function sb(t){return pb(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||db(t)||hb()}function lb(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=db(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ub(t){return(ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cb(t,e){return pb(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||db(t,e)||hb()}function hb(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function db(t,e){if(t){if("string"==typeof t)return fb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fb(t,e):void 0}}function fb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pb(t){if(Array.isArray(t))return t}function mb(t,e){for(var n=[],r=0;r<e;r++)n.push([]);if("object"===ub(t[0]))for(var i=0;i<t.length;i++)n[t[i].cluster].push(i);else for(var a=0;a<t.length;a++)n[t[a]].push(a);return n}function gb(t,e,n,r,i,a){for(var o=0,s=0,l=0;l<t.length;l++)o+=t[l]*r[l];switch(i.metric){case"Euclidean":break;case"DTWD":if(i.window>0)for(var u=0;u<e.length;u++){var c=Rb(e[u],n,a,i.window,i.distFunc);s+=r[u]*c[c.length-1][c[0].length-1]}else for(var h=0;h<e.length;h++){var d=Ob(e[h],n,a,i.distFunc);s+=r[h]*d[d.length-1][d[0].length-1]}break;case"DTWI":if(i.window>0)for(var f=function(t){var o=Nb(e[t],n,a,i.window,i.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=r[t]*l},p=0;p<e.length;p++)f(p);else for(var m=function(t){var o=Ab(e[t],n,a,i.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=r[t]*l},g=0;g<e.length;g++)m(g);break;case"DTW":if(i.window>0)for(var v=function(t){var o=Nb(e[t],n,a,i.window,i.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=r[t]*l},y=0;y<e.length;y++)v(y);else for(var b=function(t){var o=Ab(e[t],n,a,i.distFunc),l=0;a.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),s+=r[t]*l},x=0;x<e.length;x++)b(x)}var _=r.reduce((function(t,e){return t+e}),0);return s/o*((_-e.length)/(e.length-1))}function vb(t,e){for(var n=[],r=0;r<t.length;r++)for(var i=r;i<t.length;i++){var a=t[i].z-t[r].z;if(a>e[1])break;e[0]<=a&&a<=e[1]&&n.push([r,i])}return n}function yb(t,e){for(var n=[],r=function(r){var i={};e.forEach((function(e){i[e]=t[e][r]})),n.push(i)},i=0;i<t.z.length;i++)r(i);return n}function bb(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;if(!Array.isArray(t)){var s={},l={};for(var u in t)if(r)if(o[u]){for(var c=[],h=[],d=0;d<e[u].length;d++){var f=(t[u][e[u][d][1]].z-t[u][e[u][d][0]].z)/n,p={},m=[];m=t[u].slice(e[u][d][0],e[u][d][1]+1);for(var g=function(n){for(var r=n*f+t[u][e[u][d][0]].z,i={},o=e[u][d][0];o<=e[u][d][1];o++){if(i={},t[u][o].z===r){if("break"===function(){i=Object.assign({},t[u][o]);var e=a.filter((function(t){return!(t in i)})),n={},s={};e.forEach((function(t){n[t]=[],s[t]=[]}));for(var l=1;(0<=o-l||o+l<t[u].length)&&mt(n,s);){if(0<=o-l)for(var c in n)n[c].length<2&&c in t[u][o-l]&&n[c].unshift(t[u][o-l]);if(o+l<t[u].length)for(var h in s)s[h].length<2&&h in t[u][o+l]&&s[h].push(t[u][o+l]);l++}for(var d in n)if(0===n[d].length){var f=Ec(s[d][0],Ec(s[d][1],s[d][0])),p=Ec(f,Ec(s[d][0],f));n[d].push(p,f)}else if(1===n[d].length){var m=Ec(n[d][0],Ec(s[d][0],n[d][0]));n[d].unshift(m)}for(var g in s)if(0===s[g].length){var v=Sc(n[g][1],Ec(n[g][1],n[g][0])),y=Sc(v,Ec(v,n[g][1]));s[g].push(v,y)}else if(1===s[g].length){var b=Sc(s[g][0],Ec(s[g][0],n[g][1]));s[g].push(b)}return e.forEach((function(t){var e=xb((r-n[t][1].z)/(s[t][0].z-n[t][1].z),n[t][0],n[t][1],s[t][0],s[t][1]);i[t]=e[t]})),i.z=r,"break"}())break}else if(t[u][o].z<r&&r<t[u][o+1].z){if("break"===function(){var e={},n={};a.forEach((function(t){e[t]=[],n[t]=[]}));for(var s=1;(0<=o-s||o+s<t[u].length)&&mt(e,n);){if(0<=o-s)for(var l in e)e[l].length<2&&l in t[u][o-s]&&e[l].unshift(t[u][o-s]);if(o+s<t[u].length)for(var c in n)n[c].length<2&&c in t[u][o+s]&&n[c].push(t[u][o+s]);s++}for(var h in e)if(0===e[h].length){var d=Ec(n[h][0],Ec(n[h][1],n[h][0])),f=Ec(d,Ec(n[h][0],d));e[h].push(f,d)}else if(1===e[h].length){var p=Ec(e[h][0],Ec(n[h][0],e[h][0]));e[h].unshift(p)}for(var m in n)if(0===n[m].length){var g=Sc(e[m][1],Ec(e[m][1],e[m][0])),v=Sc(g,Ec(g,e[m][1]));n[m].push(g,v)}else if(1===n[m].length){var y=Sc(n[m][0],Ec(n[m][0],e[m][1]));n[m].push(y)}return a.forEach((function(t){var a=xb((r-e[t][1].z)/(n[t][0].z-e[t][1].z),e[t][0],e[t][1],n[t][0],n[t][1]);i[t]=a[t]})),i.z=r,"break"}())break}}p[n]=i},v=0;v<=n;v++)g(v);p.length=n+1,h.push(Sb(m,i[u].min,i[u].max));var y=[],b=void 0,x=void 0,_=wb(p,["z"]),w=cb(_,3);p=w[0],b=w[1],x=w[2],p.length=n+1;for(var S=0;S<m.length;S++){var E={};for(var M in p[0])"z"===M?E[M]=m[S].z:M in m[S]&&(E[M]=(m[S][M]-b[M])/x[M]);y.push(E)}p.dataPoints=y,p.id=Number(u),p.idx=d,c.push(p)}s[u]=c,l[u]=h}else{for(var C=[],T=[],k=0;k<e[u].length;k++){var P=(t[u][e[u][k][1]].z-t[u][e[u][k][0]].z)/n,A={},O=[];O=t[u].slice(e[u][k][0],e[u][k][1]+1);for(var N=0;N<=n;N++){for(var R=N*P+t[u][e[u][k][0]].z,L=void 0,I=e[u][k][0];I<=e[u][k][1];I++){if(t[u][I].z===R){L=t[u][I];break}if(t[u][I].z<R&&R<t[u][I+1].z){var D=(R-t[u][I].z)/(t[u][I+1].z-t[u][I].z);if(0===I){var z=Ec(t[u][I],Ec(t[u][I+1],t[u][I]));(L=xb(D,z,t[u][I],t[u][I+1],t[u][I+2])).z=R}else if(I==t[u].length-2){var F=Sc(t[u][I+1],Ec(t[u][I+1],t[u][I]));(L=xb(D,t[u][I-1],t[u][I],t[u][I+1],F)).z=R}else(L=xb(D,t[u][I-1],t[u][I],t[u][I+1],t[u][I+2])).z=R;break}}A[N]=L}A.length=n+1,T.push(Sb(O,i[u].min,i[u].max));var B=[],V=void 0,j=void 0,H=wb(A,["z"]),U=cb(H,3);A=U[0],V=U[1],j=U[2],A.length=n+1;for(var G=0;G<O.length;G++){var q={};for(var W in A[0])q[W]="z"===W?O[G].z:(O[G][W]-V[W])/j[W];B.push(q)}A.dataPoints=B,A.id=Number(u),A.idx=k,C.push(A)}s[u]=C,l[u]=T}else{var $=_b(t[u],i[u].mean,i[u].std,["z"]);if(o[u]){for(var Y=[],Q=[],X=0;X<e[u].length;X++){var Z=($[e[u][X][1]].z-$[e[u][X][0]].z)/n,J={},K=[];K=$.slice(e[u][X][0],e[u][X][1]+1);for(var tt=function(t){for(var n=t*Z+$[e[u][X][0]].z,r={},i=e[u][X][0];i<=e[u][X][1];i++){if(r={},$[i].z===n){r=Object.assign({},$[i]),a.indexOf("V")>=0&&("x"in $[i]||"y"in $[i])?function(){for(var t=[],e=[],o=1;0<=i-o&&t.length<2||i+o<$.length&&e.length<2;)t.length<2&&0<=i-o&&"V"in $[i-o]&&t.unshift($[i-o]),e.length<2&&i+o<$.length&&"V"in $[i+o]&&e.push($[i+o]),o++;if(0===t.length){var s=Ec(e[0],Ec(e[1],e[0])),l=Ec(s,Ec(e[0],s));t.push(l,s)}else if(1===t.length){var u=Ec(t[0],Ec(e[0],t[0]));t.unshift(u)}if(0===e.length){var c=Sc(t[1],Ec(t[1],t[0])),h=Sc(c,Ec(c,t[1]));e.push(c,h)}else if(1===e.length){var d=Sc(e[0],Ec(e[0],t[1]));e.push(d)}var f=xb((n-t[1].z)/(e[0].z-t[1].z),t[0],t[1],e[0],e[1]);a.forEach((function(t){t in f&&(r[t]=f[t])})),r.z=n}():(a.indexOf("x")>=0||a.indexOf("y")>=0)&&"V"in $[i]&&function(){for(var t=[],e=[],o=1;0<=i-o&&t.length<2||i+o<$.length&&e.length<2;)t.length<2&&0<=i-o&&("x"in $[i-o]||"y"in $[i-o])&&t.unshift($[i-o]),e.length<2&&i+o<$.length&&"x"in $[i+o]&&e.push($[i+o]),o++;if(0===t.length){var s=Ec(e[0],Ec(e[1],e[0])),l=Ec(s,Ec(e[0],s));t.push(l,s)}else if(1===t.length){var u=Ec(t[0],Ec(e[0],t[0]));t.unshift(u)}if(0===e.length){var c=Sc(t[1],Ec(t[1],t[0])),h=Sc(c,Ec(c,t[1]));e.push(c,h)}else if(1===e.length){var d=Sc(e[0],Ec(e[0],t[1]));e.push(d)}var f=xb((n-t[1].z)/(e[0].z-t[1].z),t[0],t[1],e[0],e[1]);a.forEach((function(t){t in f&&(r[t]=f[t])})),r.z=n}();break}if($[i].z<n&&n<$[i+1].z&&"break"===function(){for(var t=[],e=[],o=[],s=[],l=1;0<=i-l&&(t.length<2||o.length<2)||i+l<$.length&&(e.length<2||s.length<2);)0<=i-l&&(t.length<2&&("x"in $[i-l]||"y"in $[i-l])&&t.unshift($[i-l]),o.length<2&&"V"in $[i-l]&&o.unshift($[i-l])),i+l<$.length&&(e.length<2&&("x"in $[i+l]||"y"in $[i+l])&&e.push($[i+l]),s.length<2&&"V"in $[i+l]&&s.push($[i+l])),l++;if(0===o.length){var u=Ec(s[0],Ec(s[1],s[0])),c=Ec(u,Ec(s[0],u));o.push(c,u)}else if(1===o.length){var h=Ec(o[0],Ec(s[0],o[0]));o.unshift(h)}if(0===s.length){var d=Sc(o[1],Ec(o[1],o[0])),f=Sc(d,Ec(d,o[1]));s.push(d,f)}else if(1===s.length){var p=Sc(s[0],Ec(s[0],o[1]));s.push(p)}if(0===t.length){var m=Ec(e[0],Ec(e[1],e[0])),g=Ec(m,Ec(e[0],m));t.push(g,m)}else if(1===t.length){var v=Ec(t[0],Ec(e[0],t[0]));t.unshift(v)}if(0===e.length){var y=Sc(t[1],Ec(t[1],t[0])),b=Sc(y,Ec(y,t[1]));e.push(y,b)}else if(1===e.length){var x=Sc(e[0],Ec(e[0],t[1]));e.push(x)}var _=xb((n-o[1].z)/(s[0].z-o[1].z),o[0],o[1],s[0],s[1]);a.forEach((function(t){t in _&&(r[t]=_[t])}));var w=xb((n-t[1].z)/(e[0].z-t[1].z),t[0],t[1],e[0],e[1]);return a.forEach((function(t){t in w&&(r[t]=w[t])})),r.z=n,"break"}())break}J[t]=r},et=0;et<=n;et++)tt(et);J.length=n+1,Q.push(Sb(K,i[u].min,i[u].max)),J.dataPoints=t[u].slice(e[u][X][0],e[u][X][1]+1),J.id=Number(u),J.idx=X,Y.push(J)}s[u]=Y,l[u]=Q}else{for(var nt=[],rt=[],it=0;it<e[u].length;it++){var at=($[e[u][it][1]].z-$[e[u][it][0]].z)/n,ot={},st=[];st=$.slice(e[u][it][0],e[u][it][1]+1);for(var lt=0;lt<=n;lt++){for(var ut=lt*at+$[e[u][it][0]].z,ct=void 0,ht=e[u][it][0];ht<=e[u][it][1];ht++){if($[ht].z===ut){ct=$[ht];break}if($[ht].z<ut&&ut<$[ht+1].z){var dt=(ut-$[ht].z)/($[ht+1].z-$[ht].z);if(0===ht){var ft=Ec($[ht],Ec($[ht+1],$[ht]));(ct=xb(dt,ft,$[ht],$[ht+1],$[ht+2])).z=ut}else if(ht==$.length-2){var pt=Sc($[ht+1],Ec($[ht+1],$[ht]));(ct=xb(dt,$[ht-1],$[ht],$[ht+1],pt)).z=ut}else(ct=xb(dt,$[ht-1],$[ht],$[ht+1],$[ht+2])).z=ut;break}}ot[lt]=ct}ot.length=n+1,rt.push(Sb(st,i[u].min,i[u].max)),ot.dataPoints=t[u].slice(e[u][it][0],e[u][it][1]+1),ot.id=Number(u),ot.idx=it,nt.push(ot)}s[u]=nt,l[u]=rt}}return[s,l]}function mt(t,e){var n=!1;for(var r in t)if(t[r].length<2){n=!0;break}for(var i in e)if(e[i].length<2){n=!0;break}return n}}function xb(t,e,n,r,i){var a=n,o=Sc(Mc(-.5,e),Mc(.5,r)),s=Ec(Sc(Ec(e,Mc(2.5,n)),Mc(2,r)),Mc(.5,i)),l=Sc(Ec(Sc(Mc(-.5,e),Mc(1.5,n)),Mc(1.5,r)),Mc(.5,i));return Sc(Mc(Sc(Mc(Sc(Mc(l,t),s),t),o),t),a)}function _b(t,e,n,r){if(Array.isArray(t)){for(var i=[],a=0;a<t.length;a++){var o={};for(var s in t[a])r.indexOf(s)>=0?o[s]=t[a][s]:o[s]=s in e?(t[a][s]-e[s])/n[s]:t[a][s];i.push(o)}return i}var l={};for(var u in t){l[u]=[];for(var c=0;c<t[u].length;c++){var h={};for(var d in t[u][c])r.indexOf(d)>=0?h[d]=t[u][c][d]:d in e[u]?h[d]=(t[u][c][d]-e[u][d])/n[u][d]:h[d]=t[u][c][d];l[u].push(h)}}return l}function wb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n={},r={},i={};for(var a in t[0])(void 0===e||e.indexOf(a)<0)&&(r[a]=0,i[a]=0);for(var o=0;o<t.length;o++)for(var s in t[o])(void 0===e||e.indexOf(s)<0)&&(r[s]+=t[o][s]);for(var l in r)r[l]/=t.length;for(var u=0;u<t.length;u++)for(var c in t[u])(void 0===e||e.indexOf(c)<0)&&(i[c]+=Math.pow(t[u][c]-r[c],2));for(var h in i)i[h]=Math.sqrt(i[h]/t.length);for(var d=0;d<t.length;d++){var f={};for(var p in t[d])(void 0===e||e.indexOf(p)<0)&&(f[p]=(t[d][p]-r[p])/i[p]),void 0!==e&&e.indexOf(p)>=0&&(f[p]=t[d][p]);n[d]=f}return[n,r,i]}function Sb(t,e,n){var r=Ec(n,e),i={};for(var a in t[0])i[a]=0;for(var o=0;o<t.length-1;o++){var s=Cc(Ec(t[o],e),r);i=Sc(i,Tc(Cc(Ec(t[o+1],e),r),s))}return function(t,e){var n=0;if(e)for(var r in t)e.indexOf(r)<0&&(n+=t[r]);else for(var i in t)n+=t[i];return n}(i,["z"])/(t[t.length-1].z-t[0].z)}function Eb(t,e){var n=0;return t[0]<=e[0]&&e[0]<=t[1]?n=e[1]<=t[1]?(e[1]-e[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:(t[1]-e[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:e[0]<=t[0]&&t[0]<=e[1]&&(n=t[1]<=e[1]?(t[1]-t[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100:(e[1]-t[0]+1)/Math.max(t[1]-t[0]+1,e[1]-e[0]+1)*100),n}function Mb(t,e,n){for(var r=[],i=0;i<t.length;i++){r.push([]);for(var a=0;a<t.length;a++)r[i].push(0)}switch(e.metric){case"DTWD":if(e.window>0)for(var o=0;o<t.length-1;o++)for(var s=o+1;s<t.length;s++){var l=Rb(t[o],t[s],n,e.window,e.distFunc);r[o][s]=l[l.length-1][l[0].length-1],r[s][o]=l[l.length-1][l[0].length-1]}else for(var u=0;u<t.length-1;u++)for(var c=u+1;c<t.length;c++){var h=Ob(t[u],t[c],n,e.distFunc);r[u][c]=h[h.length-1][h[0].length-1],r[c][u]=h[h.length-1][h[0].length-1]}break;case"DTWI":if(e.window>0)for(var d=0;d<t.length-1;d++)for(var f=function(i){var a=0,o=Nb(t[d],t[i],n,e.window,disranceParameter.distFunc);n.forEach((function(t){a+=o[t][o[t].length-1][o[t][0].length-1]})),r[d][i]=a,r[i][d]=a},p=d+1;p<t.length;p++)f(p);else for(var m=0;m<t.length-1;m++)for(var g=function(i){var a=0,o=Ab(t[m],t[i],n,e.distFunc);n.forEach((function(t){a+=o[t][o[t].length-1][o[t][0].length-1]})),r[m][i]=a,r[i][m]=a},v=m+1;v<t.length;v++)g(v);break;case"DTW":if(e.window>0)for(var y=0;y<t.length-1;y++)for(var b=function(i){var a={},o=Nb(t[y],t[i],n,e.window,disranceParameter.distFunc);n.forEach((function(t){a[t]=o[t][o[t].length-1][o[t][0].length-1]})),r[y][i]=a,r[i][y]=a},x=y+1;x<t.length;x++)b(x);else for(var _=0;_<t.length-1;_++)for(var w=function(i){var a={},o=Ab(t[_],t[i],n,e.distFunc);n.forEach((function(t){a[t]=o[t][o[t].length-1][o[t][0].length-1]})),r[_][i]=a,r[i][_]=a},S=_+1;S<t.length;S++)w(S);var E={};n.forEach((function(t){E[t]=0}));for(var M=0;M<t.length;M++)r[M][M]=E}return r}function Cb(t,e,n,r){var i=[],a=[],o=0,s=e.metric;switch("DTW"===s&&(s="DTWI"),s){case"Euclidean":break;case"DTWD":i=t[Math.floor(Math.random()*Math.floor(t.length))];for(var l=function(){for(var s=[],l=[],u=function(t){var e={};n.forEach((function(t){e[t]=0})),s.push(e),l.push(0)},c=0;c<=r;c++)u();if(e.window>0)for(var h=function(r){for(var a=Lb(Rb(i,t[r],n,e.window,e.distFunc)),o=function(e){n.forEach((function(n){s[a[e][0]][n]+=t[r][a[e][1]][n]})),l[a[e][0]]++},u=0;u<a.length;u++)o(u)},d=0;d<t.length;d++)h(d);else for(var f=function(r){for(var a=Lb(Ob(i,t[r],n,e.distFunc)),o=function(e){n.forEach((function(n){s[a[e][0]][n]+=t[r][a[e][1]][n]})),l[a[e][0]]++},u=0;u<a.length;u++)o(u)},p=0;p<t.length;p++)f(p);for(var m=0;m<s.length;m++)for(var g in s[m])s[m][g]/=l[m];a=s,o++};o<300&&c(i,a);)l();break;case"DTWI":i=t[Math.floor(Math.random()*Math.floor(t.length))];for(var u=function(){for(var s=[],l=[],u=function(t){var e={},r={};n.forEach((function(t){e[t]=0,r[t]=0})),s.push(e),l.push(r)},c=0;c<=r;c++)u();if(e.window>0)for(var h=function(r){var a=Lb(Nb(i,t[r],n,e.window,e.distFunc));n.forEach((function(e){for(var n=0;n<a[e].length;n++)s[a[e][n][0]][e]+=t[r][a[e][n][1]][e],l[a[e][n][0]][e]++}))},d=0;d<t.length;d++)h(d);else for(var f=function(r){var a=Lb(Ab(i,t[r],n,e.distFunc));n.forEach((function(e){for(var n=0;n<a[e].length;n++)s[a[e][n][0]][e]+=t[r][a[e][n][1]][e],l[a[e][n][0]][e]++}))},p=0;p<t.length;p++)f(p);for(var m=0;m<s.length;m++)for(var g in s[m])s[m][g]/=l[m][g];a=s,o++};o<300&&c(i,a);)u()}return a;function c(t,e){var r=!1;if(0===t.length||0===e.length)return!0;for(var i=0;i<t.length;i++){for(var a in n)if(t[i][a]!==e[i][a]){r=!0;break}if(r)break}return r}}function Tb(t,e,n,r,i,a){var o,s,l,u,c=r.filter((function(t){return"z"!==t})),h=Mb(t,n,c),d=[],f=[],p={},m=1/0;if(Array.isArray(a)){u={};for(var g=a[0];g<=a[1];g++)if(g!==e){var v=1/0;d=[],f=[];for(var y=0;y<5;y++){var b=cb(dt(c,g),3),x=b[0],_=b[1],w=b[2];_<v&&(v=_,d=x,f=w)}for(var S=[],E=[],M=[],C=0;!ft(d,S,c)&&C<300;){0!==S.length&&0!==E.length&&(d=S,f=E);var T=cb(mt(f,c,g),2);S=T[0],M=T[1],E=pt(S,c),C++}d=S,E=f;for(var k=0,P=0;P<M.length;P++)for(var A in M[P])k+=M[P][A];u[g]=k}}for(var O=0;O<i;O++){var N=1/0;d=[],f=[];for(var R=0;R<5;R++){var L=cb(dt(c,e),3),I=L[0],D=L[1],z=L[2];D<N&&(N=D,d=I,f=z)}for(var F=[],B=[],V=[],j=0;!ft(d,F,c)&&j<300;){0!==F.length&&0!==B.length&&(d=F,f=B);var H=cb(mt(f,c,e),2);F=H[0],V=H[1],B=pt(F,c),j++}d=F,B=f;for(var U=0,G=[],q=0;q<V.length;q++){var W=0;for(var $ in V[q])U+=V[q][$],W+=V[q][$];G.push(W)}U<m&&(m=U,l=G,o=d,s=f)}d=o,f=s,Array.isArray(a)&&(u[e]=m);for(var Y=[],Q=0;Q<d.length;Q++){for(var X=[],Z=0;Z<t[0].length;Z++)X.push({});for(var J in d[Q])for(var K=0;K<t[d[Q][J]].length;K++)X[K][J]=t[d[Q][J]][K][J];Y.push(X)}var tt=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var r=0;r<f.length;r++)t[f[r]].push(r);return t}();p.clusterRadiuses=function(t){for(var n=[],r=0;r<e;r++)n.push(l[r]/t[r]);return n}(tt.map((function(t){return t.length})));for(var et=[],nt=0;nt<p.clusterRadiuses.length;nt++)et.push([p.clusterRadiuses[nt],nt]);et.sort((function(t,e){return t[0]<e[0]?-1:1})),p.clusterRadiuses.sort((function(t,e){return t<e?-1:1}));for(var rt=[],it=0;it<e;it++)rt.push(it);for(var at=0;at<et.length;at++)rt[et[at][1]]=at;for(var ot=[],st=[],lt=0;lt<d.length;lt++){var ut=rt.indexOf(lt);ot.push(d[ut]),st.push(Y[ut])}for(var ct=0;ct<f.length;ct++)f[ct]=rt[f[ct]];d=ot,Y=st;var ht=cb(function(){var e,n=[];n=Array(t.length).fill(0);for(var r=function(t){for(var e=function(e){for(var r=0,i=0,a=void 0,o=1/0,s=function(n){if(n!==t){var r=0;c.forEach((function(i){tt[t][e]!==d[n][i]&&(r+=h[tt[t][e]][d[n][i]][i])})),r<o&&(o=r,a=n)}},l=0;l<d.length;l++)s(l);if(tt[t].length-1==0)r=0;else{for(var u=function(n){tt[t][e]!==tt[t][n]&&c.forEach((function(i){r+=h[tt[t][e]][tt[t][n]][i]}))},f=0;f<tt[t].length;f++)u(f);r/=tt[t].length-1}for(var p=function(n){c.forEach((function(r){i+=h[tt[t][e]][tt[a][n]][r]}))},m=0;m<tt[a].length;m++)p(m);i/=tt[a].length,n[tt[t][e]]=(i-r)/Math.max(r,i)},r=0;r<tt[t].length;r++)e(r)},i=0;i<tt.length;i++)r(i);return e=n.reduce((function(t,e){return t+e}),0),[e/=n.length,n]}(),2);return p.silhouette=ht[0],p.silhouetteSS=ht[1],p.davisBouldin=function(){for(var t=0,e=function(e){for(var n=-1/0,r=function(t){if(e===t)return"continue";var r=0;c.forEach((function(n){r+=h[d[e][n]][d[t][n]][n]}));var i=(p.clusterRadiuses[e]+p.clusterRadiuses[t])/r;n<i&&(n=i)},i=e+1;i<tt.length;i++)r(i);isFinite(n)&&(t+=n)},n=0;n<tt.length;n++)e(n);return t/=tt.length}(),[Y,d,f,p,h,u];function dt(e,n){for(var r=[],i=function(){var n={};e.forEach((function(e){for(var i;void 0===i;){i=Math.floor(Math.random()*Math.floor(t.length));for(var a=0;a<r.length;a++)if(r[a][e]===i){i=void 0;break}}n[e]=i})),r.push(n)};r.length<n;)i();var a=pt(r,e),o=function(t,e,n){for(var r=0,i=function(i){n.forEach((function(n){r+=h[i][t[e[i]][n]][n]}))},a=0;a<e.length;a++)i(a);return r}(r,a,e);return[r,o,a]}function ft(t,e,n){var r=!0;if(t.length!==e.length)r=!1;else for(var i=0;i<e.length;i++){for(var a=!1,o=0;o<t.length;o++){var s,l=!0,u=lb(n);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(e[i][c]!==t[o][c]){l=!1;break}}}catch(t){u.e(t)}finally{u.f()}if(l){a=!0;break}}if(!a){r=!1;break}}return r}function pt(e,n){for(var r=[],i=function(t){for(var i=0,a=1/0,o=function(r){var o=0;n.forEach((function(n){t!==e[r][n]&&(o+=h[t][e[r][n]][n])})),o<a&&(i=r,a=o)},s=0;s<e.length;s++)o(s);r.push(i)},a=0;a<t.length;a++)i(a);return r}function mt(t,e,n){for(var r=[],i=0;i<n;i++)r.push([]);for(var a=0;a<t.length;a++)r[t[a]].push(a);for(var o=[],s=[],l=function(t){var n={},i={};e.forEach((function(t){n[t]=0,i[t]=1/0}));for(var a=0;a<r[t].length;a++){var l={};for(var u in i)l[u]=0;for(var c=0;c<r[t].length;c++){var d=0;if(r[t][a]!==r[t][c]){for(var f in i)l[f]+=h[r[t][a]][r[t][c]][f],i[f]<l[f]&&d++;if(d===Object.keys(i))break}}for(var p in i)l[p]<i[p]&&(i[p]=l[p],n[p]=r[t][a])}o.push(n),s.push(i)},u=0;u<n;u++)l(u);return[o,s]}}function kb(t,e,n,r,i,a){var o,s,l,u,c,h,d=r.filter((function(t){return"z"!==t})),f=Mb(t,n,d),p=1/0,m={},g=1/0;if(Array.isArray(a)){h={};for(var v=a[0];v<=a[1];v++)v!==e&&function(){for(var t=0;t<5;t++){var e=cb(L(v),3),n=e[0],r=e[1],i=e[2];r<p&&(p=r,o=n,s=i)}for(var a=[],l=[],u=[],c=0;o.filter((function(t){return-1==a.indexOf(t)})).length>0&&c<300;){0!==a.length&&0!==l.length&&(o=a,s=l);var d=cb(D(s,v),2);a=d[0],u=d[1],l=I(a),c++}o=a,l=s;for(var f=0,m=0;m<u.length;m++)f+=u[m];h[v]=f}()}for(var y=function(t){for(var n=0;n<5;n++){var r=cb(L(e),3),i=r[0],a=r[1],h=r[2];a<p&&(p=a,o=i,s=h)}for(var d=[],f=[],m=[],v=0;o.filter((function(t){return-1==d.indexOf(t)})).length>0&&v<300;){0!==d.length&&0!==f.length&&(o=d,s=f);var y=cb(D(s,e),2);d=y[0],m=y[1],f=I(d),v++}o=d,f=s;for(var b=0,x=0;x<m.length;x++)b+=m[x];b<g&&(g=b,c=m,l=o,u=s)},b=0;b<i;b++)y();o=l,s=u,Array.isArray(a)&&(h[e]=g);for(var x=[],_=0;_<o.length;_++)x.push(t[o[_]]);var w=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var r=0;r<s.length;r++)t[s[r]].push(r);return t}();m.clusterRadiuses=function(t){for(var n=[],r=0;r<e;r++)n.push(c[r]/t[r]);return n}(w.map((function(t){return t.length})));for(var S=[],E=0;E<m.clusterRadiuses.length;E++)S.push([m.clusterRadiuses[E],E]);S.sort((function(t,e){return t[0]<e[0]?-1:1})),m.clusterRadiuses.sort((function(t,e){return t<e?-1:1}));for(var M=[],C=0;C<e;C++)M.push(C);for(var T=0;T<S.length;T++)M[S[T][1]]=T;for(var k=[],P=[],A=0;A<o.length;A++){var O=M.indexOf(A);k.push(o[O]),P.push(x[O])}for(var N=0;N<s.length;N++)s[N]=M[s[N]];o=k,x=P;var R=cb(function(){var e,n=[];n=Array(t.length).fill(0);for(var r=0;r<w.length;r++)for(var i=0;i<w[r].length;i++){for(var a=0,s=0,l=void 0,u=1/0,c=0;c<o.length;c++)if(c!==r){var h=f[w[r][i]][o[c]];h<u&&(u=h,l=c)}for(var d=0;d<w[r].length;d++)w[r][i]!==w[r][d]&&(a+=f[w[r][i]][w[r][d]]);a/=w[r].length-1;for(var p=0;p<w[l].length;p++)s+=f[w[r][i]][w[l][p]];s/=w[l].length,n[w[r][i]]=(s-a)/Math.max(a,s)}return e=n.reduce((function(t,e){return t+e}),0),[e/=n.length,n]}(),2);return m.silhouette=R[0],m.silhouetteSS=R[1],m.davisBouldin=function(){for(var t=0,e=0;e<w.length;e++){for(var n=-1/0,r=e+1;r<w.length;r++)if(e!==r){var i=f[o[e]][o[r]],a=(m.clusterRadiuses[e]+m.clusterRadiuses[r])/i;n<a&&(n=a)}isFinite(n)&&(t+=n)}return t/=w.length}(),[x,o,s,m,f,h];function L(e){for(var n=[];n.length<e;){var r=Math.floor(Math.random()*Math.floor(t.length));n.indexOf(r)<0&&n.push(r)}var i=I(n);return[n,function(t,e){for(var n=0,r=0;r<e.length;r++)r!==t[e[r]]&&(n+=f[r][t[e[r]]]);return n}(n,i),i]}function I(e){for(var n=[],r=0;r<t.length;r++){var i=e.indexOf(r);if(i>=0)n.push(i);else{for(var a=0,o=f[r][a],s=1;s<e.length;s++)f[r][e[s]]<o&&(a=s,o=f[r][e[s]]);n.push(a)}}return n}function D(t,e){for(var n=[],r=0;r<e;r++)n.push([]);for(var i=0;i<t.length;i++)n[t[i]].push(i);for(var a=[],o=[],s=0;s<e;s++){for(var l=0,u=1/0,c=0;c<n[s].length;c++){for(var h=0,d=0;d<n[s].length&&!(n[s][c]!==n[s][d]&&u<(h+=f[n[s][c]][n[s][d]]));d++);h<u&&(l=n[s][c],u=h)}a.push(l),o.push(u)}return[a,o]}}function Pb(t,e,n,r,i,a){var o,s,l,u,c,h=r.filter((function(t){return"z"!==t})),d=Mb(t,n,h),f=t[0].length,p={},m=[],g=[],v=1/0;if(Array.isArray(a)){c={};for(var y=a[0];y<=a[1];y++)if(y!==e){m=[],g=[],[];var b,x=cb(ot(m=at(y),y),2);g=x[0],(b=x[1]).length>0&&(m=b);for(var _,w=[],S=[],E=0;E<100&&ct(g,S);){0!==w.length&&0!==S.length&&(m=w,g=S);var M,C=cb(ot(w=st(g,f,y),y),2);S=C[0],(M=C[1]).length>0&&(w=M),E++}for(E=0;E<100&&ht(m,w);){m=w;var T=cb(lt(g=S,f,y),2);w=T[0],S=T[1],E++}g=S,_=ut(m=w);for(var k=0,P=0;P<_.length;P++)k+=_[P][g[P].cluster];c[y]=k}}for(var A=0;A<i;A++){m=[],g=[],[];var O,N=cb(ot(m=at(e),e),2);g=N[0],(O=N[1]).length>0&&(m=O);for(var R,L=[],I=[],D=0;D<100&&ct(g,I);){0!==L.length&&0!==I.length&&(m=L,g=I);var z,F=cb(ot(L=st(g,f,e),e),2);I=F[0],(z=F[1]).length>0&&(L=z),D++}for(D=0;D<100&&ht(m,L);){m=L;var B=cb(lt(g=I,f,e),2);L=B[0],I=B[1],D++}g=I,R=ut(m=L);for(var V=0,j=0;j<R.length;j++)V+=R[j][g[j].cluster];V<v&&(v=V,s=m,l=g,u=R)}m=s,g=l,o=u,Array.isArray(a)&&(c[e]=v);var H,U=function(){for(var t=[],n=0;n<e;n++)t.push([]);for(var r=0;r<g.length;r++)t[g[r].cluster].push(r);return t}();p.clusterRadiuses=function(t){for(var n=[],r=[],i=0;i<e;i++)r.push(0);for(var a=0;a<g.length;a++)r[g[a].cluster]+=o[a][g[a].cluster];for(var s=0;s<e;s++)n.push(r[s]/t[s]);return n}(U.map((function(t){return t.length})));for(var G=[],q=0;q<p.clusterRadiuses.length;q++)G.push([p.clusterRadiuses[q],q]);G.sort((function(t,e){return t[0]<e[0]?-1:1})),p.clusterRadiuses.sort((function(t,e){return t<e?-1:1}));for(var W=[],$=0;$<e;$++)W.push($);for(var Y=0;Y<G.length;Y++)W[G[Y][1]]=Y;for(var Q=new Array(m.length).fill([]),X=new Array(m.length).fill([]),Z=0;Z<m.length;Z++)Q[W[Z]]=m[Z],X[W[Z]]=U[Z];m=Q,U=X;for(var J=[],K=[],tt=0;tt<g.length;tt++){K.push({cluster:W[g[tt].cluster],path:g[tt].path});for(var et=new Array(o[tt].length).fill(0),nt=0;nt<o[tt].length;nt++)et[W[nt]]=o[tt][nt];J.push(et)}g=K,o=J;var rt=cb(function(){var n,r=[];r=Array(t.length).fill(0);for(var i=0;i<U.length;i++)for(var a=0;a<U[i].length;a++){for(var s=0,l=0,u=void 0,c=1/0,h=0;h<e;h++)h!==i&&o[U[i][a]][h]<c&&(c=o[U[i][a]][h],u=h);for(var f=0;f<U[i].length;f++)U[i][a]!==U[i][f]&&(s+=d[U[i][a]][U[i][f]]);s/=U[i].length-1;for(var p=0;p<U[u].length;p++)l+=d[U[i][a]][U[u][p]];l/=U[u].length,r[U[i][a]]=(l-s)/Math.max(s,l)}return n=r.reduce((function(t,e){return t+e}),0),[n/=r.length,r]}(),2);p.silhouette=rt[0],p.silhouetteSS=rt[1];var it=cb(function(){for(var t=0,e=[],r=0;r<U.length;r++){e.push([]);for(var i=0;i<U.length;i++)e[r].push(0)}for(var a=0;a<U.length;a++){for(var o=-1/0,s=a+1;s<U.length;s++)if(a!==s)switch(n.metric){case"Euclidean":break;case"DTWD":if(n.window>0){var l=Rb(m[a],m[s],h,n.window,n.distFunc);e[a][s]=l[l.length-1][l[0].length-1],e[s][a]=l[l.length-1][l[0].length-1];var u=(p.clusterRadiuses[a]+p.clusterRadiuses[s])/l[l.length-1][l[0].length-1];o<u&&(o=u)}else{var c=Ob(m[a],m[s],h,n.distFunc);e[a][s]=c[c.length-1][c[0].length-1],e[s][a]=c[c.length-1][c[0].length-1];var d=(p.clusterRadiuses[a]+p.clusterRadiuses[s])/c[c.length-1][c[0].length-1];o<d&&(o=d)}break;case"DTWI":n.window>0?function(){var t=Nb(m[a],m[s],h,n.window,n.distFunc),r=0;h.forEach((function(e){r+=t[e][t[e].length-1][t[e][0].length-1]})),e[a][s]=r,e[s][a]=r;var i=(p.clusterRadiuses[a]+p.clusterRadiuses[s])/r;o<i&&(o=i)}():function(){var t=Ab(m[a],m[s],h,n.distFunc),r=0;h.forEach((function(e){r+=t[e][t[e].length-1][t[e][0].length-1]})),e[a][s]=r,e[s][a]=r;var i=(p.clusterRadiuses[a]+p.clusterRadiuses[s])/r;o<i&&(o=i)}()}isFinite(o)&&(t+=o)}return[t/=U.length,e]}(),2);return p.davisBouldin=it[0],H=it[1],[m,g,p,d,o,H,c];function at(e){for(var r=[],i=[],a=[],o=0;o<2*e;o++)i.push(o%e);for(var s=2*e;s<t.length;s++)i.push(Math.floor(Math.random()*e));i=Db(i);for(var l=0;l<e;l++)r.push([]),a.push([]);for(var u=0;u<i.length;u++)r[i[u]].push(u);switch(n.metric){case"Euclidean":break;case"DTWD":for(var c=function(e){var i=t[r[e][Math.floor(Math.random()*r[e].length)]],o=0;if(n.window>0){o=0;for(var s=function(){for(var s=[],l=[],u=function(t){var e={};h.forEach((function(t){e[t]=0})),s.push(e),l.push(0)},c=0;c<f;c++)u();for(var d=function(a){for(var o=Lb(Rb(i,t[r[e][a]],h,n.window,n.distFunc)),u=function(n){h.forEach((function(i){s[o[n][0]][i]+=t[r[e][a]][o[n][1]][i]})),l[o[n][0]]++},c=0;c<o.length;c++)u(c)},p=0;p<r[e].length;p++)d(p);for(var m=0;m<s.length;m++)for(var v in s[m])s[m][v]/=l[m];if(!g(i,s)){for(var y=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},b=0;b<s.length;b++)y(b);return"break"}if(10===++o&&a[e].length!==e+1)for(var x=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},_=0;_<s.length;_++)x(_)};o<10;){if("break"===s())break}}else{o=0;for(var l=function(){for(var s=[],l=[],u=function(t){var e={};h.forEach((function(t){e[t]=0})),s.push(e),l.push(0)},c=0;c<f;c++)u();for(var d=function(a){for(var o=Lb(Ob(i,t[r[e][a]],h,n.distFunc)),u=function(n){h.forEach((function(i){s[o[n][0]][i]+=t[r[e][a]][o[n][1]][i]})),l[o[n][0]]++},c=0;c<o.length;c++)u(c)},p=0;p<r[e].length;p++)d(p);for(var m=0;m<s.length;m++)for(var v in s[m])s[m][v]/=l[m];if(!g(i,s)){for(var y=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},b=0;b<s.length;b++)y(b);return"break"}if(10===++o&&0===a[e].length)for(var x=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},_=0;_<s.length;_++)x(_)};o<10;){if("break"===l())break}}},d=0;d<r.length;d++)c(d);break;case"DTWI":for(var p=function(e){var i=t[r[e][Math.floor(Math.random()*r[e].length)]],o=0;if(n.window>0){o=0;for(var s=function(){for(var s=[],l=[],u=function(t){var e={},n={};h.forEach((function(t){e[t]=0,n[t]=0})),s.push(e),l.push(n)},c=0;c<f;c++)u();for(var d=function(a){var o=Lb(Nb(i,t[r[e][a]],h,n.window,n.distFunc));h.forEach((function(n){for(var i=0;i<o[n].length;i++)s[o[n][i][0]][n]+=t[r[e][a]][o[n][i][1]][n],l[o[n][i][0]][n]++}))},p=0;p<r[e].length;p++)d(p);for(var m=0;m<s.length;m++)for(var v in s[m])s[m][v]/=l[m][v];if(!g(i,s)){for(var y=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},b=0;b<s.length;b++)y(b);return"break"}if(10===++o&&a[e].length!==e+1)for(var x=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},_=0;_<s.length;_++)x(_)};o<10;){if("break"===s())break}}else{o=0;for(var l=function(){for(var s=[],l=[],u=function(t){var e={},n={};h.forEach((function(t){e[t]=0,n[t]=0})),s.push(e),l.push(n)},c=0;c<f;c++)u();for(var d=function(a){var o=Lb(Ab(i,t[r[e][a]],h,n.distFunc));h.forEach((function(n){for(var i=0;i<o[n].length;i++)s[o[n][i][0]][n]+=t[r[e][a]][o[n][i][1]][n],l[o[n][i][0]][n]++}))},p=0;p<r[e].length;p++)d(p);for(var m=0;m<s.length;m++)for(var v in s[m])s[m][v]/=l[m][v];if(!g(i,s)){for(var y=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},b=0;b<s.length;b++)y(b);return"break"}if(10===++o&&a[e].length!==e+1)for(var x=function(t){var n={};h.forEach((function(e){n[e]=s[t][e]})),a[e].push(n)},_=0;_<s.length;_++)x(_)};o<10;){if("break"===l())break}}},m=0;m<r.length;m++)p(m)}return a;function g(t,e){for(var n=!1,r=0;r<t.length;r++){for(var i in t[r])if(t[r][i]!==e[r][i]){n=!0;break}if(n)break}return n}}function ot(e,r){for(var i=[],a=[],o=[],s=[],l=0;l<r;l++)s.push(0);for(var u=0;u<t.length;u++){var c=1/0,d=void 0,p=void 0;o.push([]);for(var m=function(r){var i=0;switch(n.metric){case"Euclidean":break;case"DTWD":n.window>0?(i=Rb(e[r],t[u],h,n.window,n.distFunc),o[u].push(i[i.length-1][i[0].length-1]),i[i.length-1][i[0].length-1]<c&&(c=i[i.length-1][i[0].length-1],p=r,d=i)):(i=Ob(e[r],t[u],h,n.distFunc),o[u].push(i[i.length-1][i[0].length-1]),i[i.length-1][i[0].length-1]<c&&(c=i[i.length-1][i[0].length-1],p=r,d=i));break;case"DTWI":if(n.window>0){i=Nb(e[r],t[u],h,n.window,n.distFunc);var a=0;h.forEach((function(t){a+=i[t][i[t].length-1][i[t][0].length-1]})),o[u].push(a),a<c&&(c=a,p=r,d=i)}else{i=Ab(e[r],t[u],h,n.distFunc);var s=0;h.forEach((function(t){s+=i[t][i[t].length-1][i[t][0].length-1]})),o[u].push(s),s<c&&(c=s,p=r,d=i)}}},g=0;g<e.length;g++)m(g);a.push({cluster:p,path:Lb(d)}),s[p]++}for(var v=[],y=0;y<r;y++)0===s[y]&&function(){for(var e=-1,r=-1/0,i=0;i<o.length;i++)r<o[i][y]&&(e=i,r=o[i][y]);var s={};h.forEach((function(t){for(var e=[],n=0;n<f;n++)e.push([n,n]);s[t]=e})),a[e]={cluster:y,path:s};for(var l=[],u=Object.keys(t[e][0]),c=function(n){var r=Object.assign({},t[e][n]);u.forEach((function(t){h.indexOf(t)<0&&delete r[t]})),l.push(r)},d=0;d<t[e].length;d++)c(d);v.push({maxIdx:e,cluster:y,centroid:l});for(var p=function(r){if(r===e)return o[e][y]=0,"continue";var i=0;switch(n.metric){case"Euclidean":break;case"DTWD":n.window>0?(i=Rb(l,t[r],h,n.window,n.distFunc),o[r][y]=i[i.length-1][i[0].length-1]):(i=Ob(l,t[r],h,n.distFunc),o[r][y]=i[i.length-1][i[0].length-1]);break;case"DTWI":if(n.window>0){i=Nb(l,t[r],h,n.window,n.distFunc);var a=0;h.forEach((function(t){a+=i[t][i[t].length-1][i[t][0].length-1]})),o[r][y]=a}else{i=Ab(l,t[r],h,n.distFunc);var s=0;h.forEach((function(t){s+=i[t][i[t].length-1][i[t][0].length-1]})),o[r][y]=s}}},m=0;m<t.length;m++)p(m)}();if(v.length>0){i=e.slice(0,e.length);for(var b=0;b<v.length;b++)i[v[b].cluster]=v[b].centroid;a=[];for(var x=0;x<t.length;x++){for(var _=1/0,w=-1,S=0;S<r;S++)o[x][S]<_&&(_=o[x][S],w=S);var E=void 0;switch(n.metric){case"Euclidean":break;case"DTWD":E=n.window>0?Rb(i[w],t[x],h,n.window,n.distFunc):Ob(i[w],t[x],h,n.distFunc);break;case"DTWI":E=n.window>0?Nb(i[w],t[x],h,n.window,n.distFunc):Ab(i[w],t[x],h,n.distFunc)}a.push({cluster:w,path:Lb(E)})}}return[a,i]}function st(e,r,i){for(var a=[],o=0;o<i;o++)a.push([]);for(var s=0;s<e.length;s++)a[e[s].cluster].push(s);var l=[];switch(n.metric){case"Euclidean":break;case"DTWD":for(var u=function(n){for(var i=[],o=[],s=function(t){var e={};h.forEach((function(t){e[t]=0})),i.push(e),o.push(0)},u=0;u<r;u++)s();for(var c=function(r){for(var s=function(s){h.forEach((function(o){i[e[a[n][r]].path[s][0]][o]+=t[a[n][r]][e[a[n][r]].path[s][1]][o]})),o[e[a[n][r]].path[s][0]]++},l=0;l<e[a[n][r]].path.length;l++)s(l)},d=0;d<a[n].length;d++)c(d);for(var f=function(t){h.forEach((function(e){i[t][e]/=o[t]}))},p=0;p<i.length;p++)f(p);l.push(i)},c=0;c<a.length;c++)u(c);break;case"DTWI":for(var d=function(n){for(var i=[],o=[],s=function(t){var e={},n={};h.forEach((function(t){e[t]=0,n[t]=0})),i.push(e),o.push(n)},u=0;u<r;u++)s();for(var c=function(r){h.forEach((function(s){for(var l=0;l<e[a[n][r]].path[s].length;l++)i[e[a[n][r]].path[s][l][0]][s]+=t[a[n][r]][e[a[n][r]].path[s][l][1]][s],o[e[a[n][r]].path[s][l][0]][s]++}))},d=0;d<a[n].length;d++)c(d);for(var f=function(t){h.forEach((function(e){i[t][e],i[t][e]/=o[t][e]}))},p=0;p<i.length;p++)f(p);l.push(i)},f=0;f<a.length;f++)d(f)}return l}function lt(e,r,i){for(var a=[],o=0;o<i;o++)a.push([]);for(var s=0;s<e.length;s++)a[e[s].cluster].push(s);var l=[];switch(n.metric){case"Euclidean":break;case"DTWD":for(var u=function(n){for(var i=[],o=[],s=function(t){var e={};h.forEach((function(t){e[t]=0})),i.push(e),o.push(0)},u=0;u<r;u++)s();for(var c=function(r){for(var s=function(s){h.forEach((function(o){i[e[a[n][r]].path[s][0]][o]+=t[a[n][r]][e[a[n][r]].path[s][1]][o]})),o[e[a[n][r]].path[s][0]]++},l=0;l<e[a[n][r]].path.length;l++)s(l)},d=0;d<a[n].length;d++)c(d);for(var f=function(t){h.forEach((function(e){i[t][e]/=o[t]}))},p=0;p<i.length;p++)f(p);l.push(i)},c=0;c<a.length;c++)u(c);for(var d=0;d<t.length;d++){var f=0;f=n.window>0?Rb(l[e[d].cluster],t[d],h,n.window,n.distFunc):Ob(l[e[d].cluster],t[d],h,n.distFunc),e[d].path=Lb(f)}break;case"DTWI":for(var p=function(n){for(var i=[],o=[],s=function(t){var e={},n={};h.forEach((function(t){e[t]=0,n[t]=0})),i.push(e),o.push(n)},u=0;u<r;u++)s();for(var c=function(r){h.forEach((function(s){for(var l=0;l<e[a[n][r]].path[s].length;l++)i[e[a[n][r]].path[s][l][0]][s]+=t[a[n][r]][e[a[n][r]].path[s][l][1]][s],o[e[a[n][r]].path[s][l][0]][s]++}))},d=0;d<a[n].length;d++)c(d);for(var f=function(t){h.forEach((function(e){i[t][e],i[t][e]/=o[t][e]}))},p=0;p<i.length;p++)f(p);l.push(i)},m=0;m<a.length;m++)p(m);for(var g=0;g<t.length;g++){var v=0;v=n.window>0?Nb(l[e[g].cluster],t[g],h,n.window,n.distFunc):Ab(l[e[g].cluster],t[g],h,n.distFunc),e[g].path=Lb(v)}}return[l,e]}function ut(e){for(var r=[],i=0;i<t.length;i++){r.push([]);for(var a=function(a){var o=0;switch(n.metric){case"Euclidean":break;case"DTWD":o=0,n.window>0?(o=Rb(e[a],t[i],h,n.window,n.distFunc),r[i].push(o[o.length-1][o[0].length-1])):(o=Ob(e[a],t[i],h,n.distFunc),r[i].push(o[o.length-1][o[0].length-1]));break;case"DTWI":if(n.window>0){o=Nb(e[a],t[i],h,n.window,n.distFunc);var s=0;h.forEach((function(t){s+=o[t][o[t].length-1][o[t][0].length-1]})),r[i].push(s)}else{o=Ab(e[a],t[i],h,n.distFunc);var l=0;h.forEach((function(t){l+=o[t][o[t].length-1][o[t][0].length-1]})),r[i].push(l)}}},o=0;o<e.length;o++)a(o)}return r}function ct(t,e){var n=!1;if(0===t.length||0===e.length)n=!0;else for(var r=0;r<t.length;r++)if(t[r].cluster!==e[r].cluster){n=!0;break}return n}function ht(t,e){var n=!1;if(0===t.length||0===e.length)n=!0;else for(var r=function(r){if(t[r].length!==e[r].length)return{v:n=!0};if(n)return"break";for(var i=function(i){h.forEach((function(a){var o=e[r][i][a]-t[r][i][a];0!==(o=Math.floor(o*Math.pow(10,7)))&&(n=!0)}))},a=0;a<t[r].length;a++)i(a);return n?"break":void 0},i=0;i<t.length;i++){var a=r(i);if("break"===a)break;if("object"===ub(a))return a.v}return n}}function Ab(t,e,n,r){var i={};n.forEach((function(n){for(var r=[],a=0;a<=t.length;a++){r.push([]);for(var o=0;o<=e.length;o++)r[a].push(1/0)}r[0][0]=0,i[n]=r}));for(var a=function(a){for(var o=function(o){n.forEach((function(n){i[n][a][o]=r(t[a-1][n],e[o-1][n])+Math.min(i[n][a-1][o],i[n][a][o-1],i[n][a-1][o-1])}))},s=1;s<=e.length;s++)o(s)},o=1;o<=t.length;o++)a(o);var s={};return n.forEach((function(t){s[t]=[];for(var e=1;e<i[t].length;e++)s[t].push(i[t][e].slice(1,i[t][e].length))})),s}function Ob(t,e,n,r){for(var i=[],a=0;a<=t.length;a++){i[a]=[];for(var o=0;o<=e.length;o++)i[a][o]=1/0}i[0][0]=0;for(var s=1;s<=t.length;s++)for(var l=1;l<=e.length;l++)i[s][l]=r(t[s-1],e[l-1],n)+Math.min(i[s-1][l],i[s][l-1],i[s-1][l-1]);for(var u=[],c=1;c<i.length;c++)u.push(i[c].slice(1,i[c].length));return u}function Nb(t,e,n,r,i){var a={};r=Math.max(r,Math.abs(t.length-e.length)),n.forEach((function(n){for(var i=[],o=0;o<=t.length;o++){i[o]=[];for(var s=0;s<=e.length;s++)i[o][s]=1/0}i[0][0]=0;for(var l=1;l<=t.length;l++)for(var u=Math.max(1,l-r),c=Math.min(e.length,l+r),h=u;h<=c;h++)i[l][h]=0;a[n]=i}));for(var o=function(o){for(var s=Math.max(1,o-r),l=Math.min(e.length,o+r),u=function(r){n.forEach((function(n){a[n][o][r]=i(t[o-1][n],e[r-1][n])+Math.min(a[n][o-1][r],a[n][o][r-1],a[n][o-1][r-1])}))},c=s;c<=l;c++)u(c)},s=1;s<=t.length;s++)o(s);var l={};return n.forEach((function(t){l[t]=[];for(var e=1;e<a[t].length;e++)l[t].push(a[t][e].slice(1,a[t][e].length))})),l}function Rb(t,e,n,r,i){var a=[];r=Math.max(r,Math.abs(t.length-e.length));for(var o=0;o<=t.length;o++){a[o]=[];for(var s=0;s<=e.length;s++)a[o][s]=1/0}a[0][0]=0;for(var l=1;l<=t.length;l++)for(var u=Math.max(1,l-r),c=Math.min(e.length,l+r),h=u;h<=c;h++)a[l][h]=0;for(var d=1;d<=t.length;d++)for(var f=Math.max(1,d-r),p=Math.min(e.length,d+r),m=f;m<=p;m++)a[d][m]=i(t[d-1],e[m-1],n)+Math.min(a[d-1][m],a[d][m-1],a[d-1][m-1]);for(var g=[],v=1;v<a.length;v++)g.push(a[v].slice(1,a[v].length));return g}function Lb(t){if(Array.isArray(t)){var e,n=t.length-1,r=t[0].length-1;for(e=[[n,r]];n>0||r>0;)n>0?r>0?t[n-1][r]<t[n-1][r-1]?t[n-1][r]<t[n][r-1]?(e.push([n-1,r]),n--):(e.push([n,r-1]),r--):t[n-1][r-1]<t[n][r-1]?(e.push([n-1,r-1]),n--,r--):(e.push([n,r-1]),r--):(e.push([n-1,r]),n--):(e.push([n,r-1]),r--);return e}var i={};for(var a in t){var o=void 0,s=t[a].length-1,l=t[a][0].length-1;for(o=[[s,l]];s>0||l>0;)s>0?l>0?t[a][s-1][l]<t[a][s-1][l-1]?t[a][s-1][l]<t[a][s][l-1]?(o.push([s-1,l]),s--):(o.push([s,l-1]),l--):t[a][s-1][l-1]<t[a][s][l-1]?(o.push([s-1,l-1]),s--,l--):(o.push([s,l-1]),l--):(o.push([s-1,l]),s--):(o.push([s,l-1]),l--);i[a]=o}return i}function Ib(t,e,n){if(Array.isArray(t)){for(var r=0,i=0;i<t.length;i++)r+=Math.pow(t[i]-e[i],2);return Math.sqrt(r)}if("number"==typeof t)return Math.abs(t-e);if("object"===ub(t)){var a=0;return n.forEach((function(n){a+=Math.pow(t[n]-e[n],2)})),Math.sqrt(a)}}var Db=function(t){for(var e=sb(t).slice(0),n=e.length-1;n>=0;n--){var r=Math.floor(Math.random()*(n+1)),i=[e[r],e[n]];e[n]=i[0],e[r]=i[1]}return e};function zb(t){for(var e=ky(t),n=Vy(e.length),r=jy(e.length,e.length),i=Ky(n,Qy(1/e.length,r)),a=Qy(-.5,i,e,i),o=0;o<a._data.length;o++)for(var s=0;s<a._data.length;s++)a._data[s][o]=a._data[o][s];var l=ob(a._data),u=l.values,c=l.vectors,h=Zy(c),d=u[u.length-1],f=u[u.length-2],p=h[h.length-1],m=h[h.length-2],g=By([d,f]),v=Ry(g),y=[];return y.push(p),y.push(m),y=Zy(y),Qy(y,v)}function Fb(t){hu.dispatch({type:"SHOW_CLUSTER_DETAILS",cluster:t})}function Bb(t){hu.dispatch({type:"SHOW_FILTERING_STEP",selectedProcess:t})}function Vb(t,e){hu.dispatch({type:"UPDATE_SS_SELECTION",selectedSS:t,updatedSS:e})}function jb(t,e){hu.dispatch({type:"SHOW_TTVIEW_OF_SELECTED_SS_CLUSTERING",id:t,period:e})}function Hb(t){return(Hb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ub(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Gb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gb(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wb(t,e){return(Wb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qb(t);if(e){var i=Qb(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yb(this,n)}}function Yb(t,e){return!e||"object"!==Hb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qb(t){return(Qb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wb(t,e)}(o,t);var e,n,r,a=$b(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:Rh.getMode(),normalize:!0,clusteringMethod:"kmedoids",distanceMetric:"DTW",medoidDefinition:"each",targetList:Rh.getTarget(),filteringSS:["dataDrivenSlidingWindow","sameStartingPoint","overlappingDegree"],elbow:!1},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#targetLengthMinClustering").val(20),$("#targetLengthMaxClustering").val(30),$("#resolutionOfTimeNormalizedSS").val(30),$("#overlappingDegreeThreshold").val(70),$("#maxTrialNum").val(10),$("#clusterNumber").val(6),Rh.on("switchQueryMode",(function(e){t.setState({queryMode:e})})),Rh.on("updateTarget",(function(){t.setState({targetList:Rh.getTarget()})})),zc.on("recoverClusteringSession",(function(){var e=zc.getSubsequenceParameters(),n=zc.getClusteringParameters(),r=zc.getDatasets(),i=zc.getSSEClusters();$("#targetLengthMinClustering").val(e.SSperiod[0]),$("#targetLengthMaxClustering").val(e.SSperiod[1]),$("#resolutionOfTimeNormalizedSS").val(e.isometryLen),e.filtering.indexOf("overlappingDegree")>=0&&$("#overlappingDegreeThreshold").val(e.overlappingTh),$("input[name=clusteringVariables]").each((function(t,e){n.variables.indexOf($(e).val())>=0?$(e).prop("checked",!0):$(e).prop("checked",!1)})),$("#clusterNumber").val(n.clusterNum);for(var a=document.getElementById("clusteringMethod"),o=0;o<a.options.length;o++)if(a.options[o].value===n.method){a.selectedIndex=o;break}var s=void 0!==i;if(s){var l=Object.keys(i).sort((function(t,e){return t-e}));$("#elbowMethodMinCluster").val(l[0]),$("#elbowMethodMaxCluster").val(l[l.length-1])}t.setState({normalize:e.normalize,clusteringMethod:n.method,distanceMetric:n.distanceMetric,medoidDefinition:n.medoidDefinition,targetList:r.filter((function(t){return t>=0})),filteringSS:e.filtering,elbow:s})}))}},{key:"render",value:function(){return i.a.createElement("div",{id:"clusteringSetting",className:"controllersElem featureArea"},this.subsequenceSetting(),this.clusteringMethodsSetting(),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"runAutomaticExtractionBtn",style:{float:"right"},onClick:this.clickRunButton.bind(this)},"Run"))}},{key:"subsequenceSetting",value:function(){var t;return this.state.filteringSS.indexOf("overlappingDegree")>=0&&(t=i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Threshold of overlapping degree"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"overlappingDegreeThreshold",style:{width:"40%",marginRight:"0.5rem"},required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," %")))),i.a.createElement("div",{className:"featureElem"},i.a.createElement("h5",null,"Subsequence setting"),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Length of the target time series"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"targetLengthMinClustering",style:{width:"20%",marginRight:"0.5rem"},required:!0}),"~",i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"targetLengthMaxClustering",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"normalizeSwitchClustering",checked:this.state.normalize,onClick:this.onClickNormalize.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"normalizeSwitchClustering"},"Normalize"))),i.a.createElement("div",{className:"col"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"normalizationOptionsClustering",style:{width:"60%"},disabled:!this.state.normalize},i.a.createElement("option",{value:"zScore"},"z-score")))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Division number of subsequences"),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"resolution",id:"resolutionOfTimeNormalizedSS",style:{width:"40%",marginRight:"0.5rem"},required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," days"))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Options of filtering subsequences"),i.a.createElement("div",{className:"col form-group",id:"filteringSSOptions",onChange:this.onChangeFilteringSS.bind(this)},i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"dataDrivenSlidingWindow",name:"filteringSS",value:"dataDrivenSlidingWindow",checked:this.state.filteringSS.indexOf("dataDrivenSlidingWindow")>=0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"dataDrivenSlidingWindow"},"Data-driven sliding window")),i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"SSFilterStartingPoint",name:"filteringSS",value:"sameStartingPoint",checked:this.state.filteringSS.indexOf("sameStartingPoint")>=0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"SSFilterStartingPoint"},"Subsequences starting from the same data sample")),i.a.createElement("div",{className:"custom-control custom-checkbox"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"SSFilterOverlappingDegree",name:"filteringSS",value:"overlappingDegree",checked:this.state.filteringSS.indexOf("overlappingDegree")>=0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"SSFilterOverlappingDegree"},"Highly overlapping subsequences")))),t,this.variableSelector())}},{key:"onChangeFilteringSS",value:function(){for(var t=document.getElementsByName("filteringSS"),e=[],n=0;n<t.length;n++)t[n].checked&&e.push(t[n].value);this.setState({filteringSS:e})}},{key:"variableSelector",value:function(){var t=[],e={},n=Rh.getTarget();if(n.length>0){for(var r=0;r<n.length;r++){var a=Ju.getData(n[r]).data.lookup;for(var o in a)if(o in e)for(var s=0;s<a[o].length;s++)e[o].indexOf(a[o][s])<0&&e[o].push(a[o][s]);else e[o]=a[o]}for(var l in e){var u="";"z"!==l&&(u=e[l].length>1?e[l].join(","):e[l][0],t.push(i.a.createElement("div",{className:"form-check form-check-inline",key:l},i.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"clusteringVariables",value:l,id:"clusteringVaribales_"+l}),i.a.createElement("label",{className:"form-check-label",htmlFor:"clusteringVaribales_"+l},u))))}}return i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Variables to be consideded"),i.a.createElement("div",{className:"col"},t))}},{key:"clusteringMethodsSetting",value:function(){var t,e=i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"custom-select custom-select-sm",id:"clusteringMethod",style:{width:"60%"},onChange:this.onChangeClusteringMethod.bind(this)},i.a.createElement("option",{value:"kmedoids"},"kMedoids"),i.a.createElement("option",{value:"kmeans"},"kMeans")));switch(this.state.clusteringMethod){case"kmedoids":var n=i.a.createElement("form",{className:"form-check",id:"distanceMetricClustering",onChange:this.switchDistanceMetric.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"EuclideanClustering",name:"distanceMetricClustering",value:"Euclidean",checked:"Euclidean"===this.state.distanceMetric,disabled:!0,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"EuclideanClustering"},"Euclidean")),i.a.createElement("div",{className:"custom-control custom-radio",style:{display:"each"===this.state.medoidDefinition?"block":"none"}},i.a.createElement("input",{type:"radio",id:"DTWClustering",name:"distanceMetricClustering",value:"DTW",checked:"DTW"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWClustering"},"DTW")),i.a.createElement("div",{className:"custom-control custom-radio",style:{display:"unified"===this.state.medoidDefinition?"block":"none"}},i.a.createElement("input",{type:"radio",id:"DTWIClustering",name:"distanceMetricClustering",value:"DTWI",checked:"DTWI"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWIClustering"},"DTW",i.a.createElement("sub",null,"I"))),i.a.createElement("div",{className:"custom-control custom-radio",style:{display:"unified"===this.state.medoidDefinition?"block":"none"}},i.a.createElement("input",{type:"radio",id:"DTWDClustering",name:"distanceMetricClustering",value:"DTWD",checked:"DTWD"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWDClustering"},"DTW",i.a.createElement("sub",null,"D")))),r=i.a.createElement("form",{className:"form-check",id:"medoidDefinition",onChange:this.switchMedoidDefinition.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"medoidEachVariable",name:"medoidDefinition",value:"each",checked:"each"===this.state.medoidDefinition,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"medoidEachVariable"},"Independent medoid for each variable")),i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"medoidAllVariables",name:"medoidDefinition",value:"unified",checked:"unified"===this.state.medoidDefinition,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"medoidAllVariables"},"Unified medoid for all variables")));t=i.a.createElement("div",{id:"clusteringOptions"},i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Cluster number"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"cluster number",id:"clusterNumber",style:{width:"50%",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Distance metric"),i.a.createElement("div",{className:"col"},n)),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Definition of medoids"),i.a.createElement("div",{className:"col"},r)),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Max trial"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"maxTrialNum",style:{width:"40%",marginRight:"0.5rem"},required:!0}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"elbowMethodSwitch",checked:this.state.elbow,onClick:this.onClickElbowMethod.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"elbowMethodSwitch"},"Elbow method"))),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"elbowMethodMinCluster",style:{width:"20%",marginRight:"0.5rem"},disabled:!this.state.elbow,required:!0}),"~",i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"elbowMethodMaxCluster",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},disabled:!this.state.elbow,required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," clusters"))));break;case"kmeans":t=i.a.createElement("div",{id:"clusteringOptions"},i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Cluster number"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"cluster number",id:"clusterNumber",style:{width:"50%",marginRight:"0.5rem"}}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Distance metric"),i.a.createElement("div",{className:"col"},i.a.createElement("form",{className:"form-check",id:"distanceMetricClustering",onChange:this.switchDistanceMetric.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"EuclideanClustering",name:"distanceMetricClustering",value:"Euclidean",checked:"Euclidean"===this.state.distanceMetric,disabled:!0,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"EuclideanClustering"},"Euclidean")),i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"DTWIClustering",name:"distanceMetricClustering",value:"DTWI",checked:"DTWI"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWIClustering"},"DTW",i.a.createElement("sub",null,"I"))),i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"DTWDClustering",name:"distanceMetricClustering",value:"DTWD",checked:"DTWD"===this.state.distanceMetric,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DTWDClustering"},"DTW",i.a.createElement("sub",null,"D")))))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Cluster center definition"),i.a.createElement("div",{className:"col"},i.a.createElement("form",{className:"form-check",id:"clusterCenter",style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"DBA",name:"clusterCenter",value:"DBA",className:"custom-control-input",checked:!0,readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"DBA"},"DTW barycenter averaging"))))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Max trial"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"maxTrialNum",style:{width:"40%",marginRight:"0.5rem"},required:!0}))),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"elbowMethodSwitch",checked:this.state.elbow,onClick:this.onClickElbowMethod.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"elbowMethodSwitch"},"Elbow method"))),i.a.createElement("div",{className:"col form-inline"},i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"min",id:"elbowMethodMinCluster",style:{width:"20%",marginRight:"0.5rem"},disabled:!this.state.elbow,required:!0}),"~",i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"max",id:"elbowMethodMaxCluster",style:{width:"20%",marginRight:"0.5rem",marginLeft:"0.5rem"},disabled:!this.state.elbow,required:!0}),i.a.createElement("label",{className:"col-form-label col-form-label-sm"}," clusters"))))}return i.a.createElement("div",{className:"featureElem"},i.a.createElement("h5",null,"Clustering settings"),i.a.createElement("div",{className:"row matchingOption"},i.a.createElement("div",{className:"col-5"},"Method"),i.a.createElement("div",{className:"col"},e)),t)}},{key:"switchDistanceMetric",value:function(){var t=$("input[name=distanceMetricClustering]:checked").val();this.setState({distanceMetric:t})}},{key:"switchMedoidDefinition",value:function(){var t=$("input[name=medoidDefinition]:checked").val();this.setState({distanceMetric:"each"===t?"DTW":"DTWD",medoidDefinition:t})}},{key:"onChangeClusteringMethod",value:function(){var t,e=document.getElementById("clusteringMethod"),n=e.selectedIndex,r=e.options[n].value;t=r,hu.dispatch({type:"CHANGE_CLUSTERING_METHOD",method:t}),this.setState({clusteringMethod:r,distanceMetric:"kmedoids"===r?"DTW":"DTWD"})}},{key:"onClickNormalize",value:function(){var t=this.state.normalize;this.setState({normalize:!t})}},{key:"onClickElbowMethod",value:function(){var t=this.state.elbow;this.setState({elbow:!t})}},{key:"clickRunButton",value:function(){for(var t=[],e=document.getElementsByName("clusteringVariables"),n=0;n<e.length;n++)e[n].checked&&t.push(e[n].value);if(t.indexOf("x")>=0&&t.indexOf("y")<0&&t.indexOf("PA")>=0&&t.indexOf("PD")<0||t.indexOf("x")>=0&&t.indexOf("y")<0&&t.indexOf("PA")<0&&t.indexOf("PD")>=0||t.indexOf("x")<0&&t.indexOf("y")>=0&&t.indexOf("PA")>=0&&t.indexOf("PD")<0||t.indexOf("x")<0&&t.indexOf("y")>=0&&t.indexOf("PA")<0&&t.indexOf("PD")>=0)alert("Tentatively, the combinations of q and PA, q and PD, u and PA, and u and PD are not allowed. If you are interested in the variations on the Stokes plane, please select PA and PD or q and u.");else{for(var r,i=[],a=0;a<this.state.targetList.length;a++)i.push(Ju.getData(this.state.targetList[a]));switch(this.state.clusteringMethod){case"kmedoids":r={method:"kmedoids",clusterNum:Number($("#clusterNumber").val()),medoidDefinition:this.state.medoidDefinition,distanceMetric:this.state.distanceMetric,window:0,variables:t,maxTrial:Number($("#maxTrialNum").val()),elbow:!!this.state.elbow&&[Number($("#elbowMethodMinCluster").val()),Number($("#elbowMethodMaxCluster").val())]};break;case"kmeans":r={method:"kmeans",clusterNum:Number($("#clusterNumber").val()),distanceMetric:this.state.distanceMetric,window:0,clusterCenter:$("input[name=clusterCenter]:checked").val(),variables:t,maxTrial:Number($("#maxTrialNum").val()),elbow:!!this.state.elbow&&[Number($("#elbowMethodMinCluster").val()),Number($("#elbowMethodMaxCluster").val())]}}var o={};o.filtering=this.state.filteringSS,o.SSperiod=[Number($("#targetLengthMinClustering").val()),Number($("#targetLengthMaxClustering").val())],o.isometryLen=Number($("#resolutionOfTimeNormalizedSS").val()),o.normalize=this.state.normalize,this.state.filteringSS.indexOf("overlappingDegree")>=0&&(o.overlappingTh=Number($("#overlappingDegreeThreshold").val()));for(var s=Ub(function(t,e,n){var r=e.variables.slice();r.push("z");for(var i={},a={},o={},s=0;s<t.length;s++){for(var l=[],u=0;u<t[s].data.spatial.length;u++){var c={};c.z=t[s].data.spatial[u].z;for(var h=0;h<r.length;h++)t[s].data.spatial[u][r[h]]&&(c[r[h]]=t[s].data.spatial[u][r[h]]);1!==Object.keys(c).length&&l.push(c)}i[t[s].id]=l,a[t[s].id]=t[s].data.meta,o[t[s].id]=t[s].data.polarPhotoSplit}var d,f,p={},m=[],g=[],v={};if(n.filtering.indexOf("dataDrivenSlidingWindow")>=0){var y=function(t,e){var n={};for(var r in t){for(var i=[],a=0;a<t[r].length;a++)for(var o=a;o<t[r].length;o++){var s=t[r][o].z-t[r][a].z;if(s>e[1])break;e[0]<=s&&s<=e[1]&&i.push([a,o])}n[r]=i}return n}(i,n.SSperiod);for(var b in v.dataDrivenSlidingWindow={},y){p[b]=[],v.dataDrivenSlidingWindow[b]=[];for(var x=0;x<y[b].length;x++)p[b].push(x),v.dataDrivenSlidingWindow[b].push(x)}var _=cb(bb(i,y,n.isometryLen,n.normalize,a,e.variables,o),2);if(d=_[0],f=_[1],v.subsequences=d,n.filtering.indexOf("sameStartingPoint")>=0)for(var w in v.sameStartingPoint={},y){for(var S=0,E=[];S<y[w].length;){var M=y[w][S][0],C=S;for(S++;S<y[w].length&&y[w][S][0]==M;)if(f[w][C]<f[w][S])C=S,S++;else{if(S+1<y[w].length&&y[w][S+1][0]!==M)break;S++}E.push(C),S++}p[w]=E,v.sameStartingPoint[w]=E}if(n.filtering.indexOf("overlappingDegree")>=0&&(v.overlappingDegree={},n.overlappingTh>0))for(var T in y){for(var k=[],P=0;P<p[T].length;){for(var A=y[T][p[T][P]],O=p[T][P],N=P+1;N<p[T].length;){var R=Eb(A,y[T][p[T][N]]);if(R<n.overlappingTh)break;R>=n.overlappingTh&&(f[O]<f[p[T][N]]?O=p[T][N]:f[O]===f[p[T][N]]&&(O=y[T][p[T][P]][1]-y[T][p[T][P]][0]<y[T][p[T][N]][1]-y[T][p[T][N]][0]?p[T][N]:p[T][P])),N++}k.push(O),P=N}p[T]=k,v.overlappingDegree[T]=k}for(var L in p)for(var I=0;I<p[L].length;I++){var D=d[L][p[L][I]];m.push(D),g.push(y[L][p[L][I]])}}else{v.normalSlidingWindow={};for(var z=0;z<t.length;z++){var F=t[z].id,B=Ju.getDataArray(F,1),V=vb(B=yb(B,r),n.SSperiod);p[F]=[],v.normalSlidingWindow[F]=[];for(var j=0;j<V.length;j++)p[F].push(j),v.normalSlidingWindow[F].push(j);var H=cb(bb(B,V,n.isometryLen,n.normalize,a[F],e.variables,o),2);if(d=H[0],f=H[1],v.subsequences=d,n.filtering.indexOf("sameStartingPoint")>=0){var U=0,G=[];for(v.sameStartingPoint={};U<V.length;){var q=V[U][0],W=U;for(U++;U<V.length&&V[U][0]==q;)if(f[W]<f[U])W=U,U++;else{if(U+1<V.length&&V[U+1][0]!==q)break;U++}G.push(W),U++}p[F]=G,v.sameStartingPoint[F]=G}if(n.filtering.indexOf("overlappingDegree")>=0&&(v.overlappingDegree={},n.overlappingTh>0)){for(var $=[],Y=0;Y<p[F].length;){for(var Q=V[p[F][Y]],X=p[F][Y],Z=Y+1;Z<p[F].length;){var J=Eb(Q,V[p[F][Z]]);if(J<n.overlappingTh)break;J>=n.overlappingTh&&(f[X]<f[p[F][Z]]?X=p[F][Z]:f[X]===f[p[F][Z]]&&(X=V[F][p[F][Y]][1]-V[F][p[F][Y]][0]<V[F][p[F][Z]][1]-V[F][p[F][Z]][0]?p[F][Z]:p[F][Y])),Z++}$.push(X),Y=Z}p[F]=$,v.overlappingDegree[F]=$}for(var K=0;K<p[F].length;K++){var tt=d[p[F][K]];m.push(tt),g.push(V[p[F][K]])}}}var et,nt,rt,it,at,ot,st,lt,ut={window:e.window,metric:e.distanceMetric,distFunc:Ib};switch(e.method){case"kmedoids":st=[];for(var ct=0;ct<e.clusterNum;ct++){st.push([]);for(var ht=0;ht<e.clusterNum;ht++)st[ct].push(0)}if("unified"===e.medoidDefinition){var dt=cb(kb(m,e.clusterNum,ut,r,e.maxTrial,e.elbow),6);et=dt[0],nt=dt[1],rt=dt[2],it=dt[3],at=dt[4],lt=dt[5];for(var ft=0;ft<e.clusterNum-1;ft++)for(var pt=ft+1;pt<e.clusterNum;pt++)st[ft][pt]=at[nt[ft]][nt[pt]],st[pt][ft]=at[nt[pt]][nt[ft]]}else if("each"===e.medoidDefinition){var mt=cb(Tb(m,e.clusterNum,ut,r,e.maxTrial,e.elbow),6);et=mt[0],nt=mt[1],rt=mt[2],it=mt[3],at=mt[4],lt=mt[5];for(var gt=function(t){for(var n=function(e){var n=0;r.forEach((function(r){"z"!==r&&(n+=at[nt[t][r]][nt[e][r]][r])})),st[t][e]=n,st[e][t]=n},i=t+1;i<e.clusterNum;i++)n(i)},vt=0;vt<e.clusterNum-1;vt++)gt(vt);for(var yt=0;yt<m.length;yt++){var bt=new Array(e.clusterNum).fill(0);at[yt]=at[yt].concat(bt)}for(var xt=0;xt<e.clusterNum;xt++)at.push(new Array(m.length+e.clusterNum).fill(0));for(var _t=0;_t<e.clusterNum;_t++)for(var wt=0;wt<m.length;wt++){var St=0;for(var Et in nt[_t])St+=at[wt][nt[_t][Et]][Et];at[wt][m.length+_t]=St,at[m.length+_t][wt]=St}for(var Mt=0;Mt<e.clusterNum-1;Mt++)for(var Ct=Mt+1;Ct<e.clusterNum;Ct++)at[m.length+Mt][m.length+Ct]=st[Mt][Ct],at[m.length+Ct][m.length+Mt]=st[Mt][Ct];for(var Tt=0;Tt<m.length-1;Tt++){at[Tt][Tt]=0;for(var kt=Tt+1;kt<m.length;kt++){var Pt=0;for(var At in at[Tt][kt])Pt+=at[Tt][kt][At];at[Tt][kt]=Pt,at[kt][Tt]=Pt}}at[m.length-1][m.length-1]=0}break;case"kmeans":var Ot=cb(Pb(m,e.clusterNum,ut,r,e.maxTrial,e.elbow),7);et=Ot[0],rt=Ot[1],it=Ot[2],at=Ot[3],ot=Ot[4],st=Ot[5],lt=Ot[6];for(var Nt=0;Nt<m.length;Nt++){var Rt=new Array(e.clusterNum).fill(0);at[Nt]=at[Nt].concat(Rt)}for(var Lt=0;Lt<e.clusterNum;Lt++)at.push(new Array(m.length+e.clusterNum).fill(0));for(var It=0;It<m.length;It++)for(var Dt=0;Dt<e.clusterNum;Dt++)at[It][m.length+Dt]=ot[It][Dt],at[m.length+Dt][It]=ot[It][Dt];for(var zt=0;zt<e.clusterNum-1;zt++)for(var Ft=zt+1;Ft<e.clusterNum;Ft++)at[m.length+zt][m.length+Ft]=st[zt][Ft],at[m.length+Ft][m.length+zt]=st[zt][Ft]}var Bt=Cb(m,ut,r.filter((function(t){return"z"!==t})),n.isometryLen),Vt=mb(rt,e.clusterNum);return it.pseudoF=gb(it.clusterRadiuses,et,Bt,Vt.map((function(t){return t.length})),ut,r.filter((function(t){return"z"!==t}))),[m,g,et,rt,it,v,{clustersCoord:zb(st),dataCoord:zb(at),medoidIdx:nt},lt]}(i,r,o),8),l=s[0],u=s[1],c=s[2],h=s[3],d=s[4],f=s[5],p=s[6],m=s[7],g=[],v=0;v<i.length;v++)g.push(i[v].id);yh("none"),$("#clusteringResults").css("width","100%"),function(t,e,n,r,i,a,o,s,l,u,c){hu.dispatch({type:"SHOW_CLUSTERING_RESULTS",datasets:t,subsequences:e,ranges:n,clusterCenters:r,labels:i,clusteringParameters:a,subsequenceParameters:o,clusteringScores:s,filteringProcess:l,resultsCoordinates:u,SSEClusters:c})}(g,l,u,c,h,r,o,d,f,p,m)}}}])&&qb(e.prototype,n),r&&qb(e,r),o}(i.a.Component);function Zb(t){return(Zb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kb(t,e){return(Kb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=nx(t);if(e){var i=nx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ex(this,n)}}function ex(t,e){return!e||"object"!==Zb(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nx(t){return(nx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kb(t,e)}(o,t);var e,n,r,a=tx(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:Rh.getMode()},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=window.innerHeight-$("#appHeader").outerHeight(!0)-$("#targetDatasetsList").outerHeight(!0)-$("#extractionMenuNavTabs").outerHeight(!0);$("#extractionMenuTabs").height(e),Rh.on("switchQueryMode",(function(e){t.setState({queryMode:e})})),Rh.on("recoverQuery",(function(e){var n=Rh.getMode();t.setState({queryMode:n});var r=$("#automaticExtraction"),i=$("#visualQuery"),a=$("#clusteringSetting");"AE"===n?(r.hasClass("active")||r.addClass("show").addClass("active"),i.hasClass("active")&&i.removeClass("show").removeClass("active"),a.hasClass("active")&&a.removeClass("show").removeClass("active")):"QBE"!==n&&"QBS"!==n||(i.hasClass("active")||i.addClass("show").addClass("active"),r.hasClass("active")&&r.removeClass("show").removeClass("active"),a.hasClass("active")&&a.removeClass("show").removeClass("active"));for(var o=$("input[name=targetList]"),s=0;s<o.length;s++)o[s].checked=!0})),zc.on("recoverClusteringSession",(function(){var t=zc.getDatasets();$("input[name=targetList]").each((function(e,n){t.indexOf(Number($(n).val()))>=0?$(n).prop("checked",!0):$(n).prop("checked",!1)}))}))}},{key:"componentDidUpdate",value:function(){var t=window.innerHeight-$("#appHeader").outerHeight(!0)-$("#targetDatasetsList").outerHeight(!0)-$("#extractionMenuNavTabs").outerHeight(!0);$("#extractionMenuTabs").height(t)}},{key:"selectTabAE",value:function(){Zc("AE")}},{key:"selectTabClustering",value:function(){Zc("Clustering")}},{key:"updateTargets",value:function(){for(var t=$("input[name=targetList]:checked"),e=[],n=0;n<t.length;n++)e.push(Number(t[n].value));Wc(e)}},{key:"clickCloseExtractionMenu",value:function(){yh(),fu()}},{key:"render",value:function(){var t=Ju.getAllIdsFileNames().map((function(t){return i.a.createElement("label",{className:"form-check form-check-inline",htmlFor:"inlineCheckbox1",key:t.id},i.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"targetList",id:"checkboxTarget"+t.id,value:t.id,key:t.id}),t.name)}));return i.a.createElement("div",{id:"extractionMenu",className:"featureColumn",style:{float:"left",position:"relative"}},i.a.createElement("div",{id:"extractionMainMenu"},i.a.createElement("div",{id:"targetDatasetsList",className:"controllersElem"},i.a.createElement("h5",null,"Target"),i.a.createElement("form",{onChange:this.updateTargets.bind(this)},t)),i.a.createElement("ul",{className:"nav nav-tabs",id:"extractionMenuNavTabs"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link active","data-toggle":"tab",href:"#automaticExtraction",onClick:this.selectTabAE},"Automatic Extraction")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#visualQuery"},"Visual Query")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#clustering",onClick:this.selectTabClustering},"Clustering"))),i.a.createElement("div",{id:"extractionMenuTabs",className:"tab-content"},i.a.createElement("div",{className:"tab-pane fade show active",id:"automaticExtraction"},i.a.createElement(cp,null)),i.a.createElement("div",{className:"tab-pane fade",id:"visualQuery"},i.a.createElement(rp,null)),i.a.createElement("div",{className:"tab-pane fade",id:"clustering"},i.a.createElement(Xb,null)))),i.a.createElement("button",{id:"collapseExtractionMenu",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",top:"0px",right:"-4rem",zIndex:100},onClick:this.clickCloseExtractionMenu},"Close"))}}])&&Jb(e.prototype,n),r&&Jb(e,r),o}(i.a.Component);function ix(t){return(ix="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ax(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ox(t,e){return(ox=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ux(t);if(e){var i=ux(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return lx(this,n)}}function lx(t,e){return!e||"object"!==ix(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ux(t){return(ux=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ox(t,e)}(o,t);var e,n,r,a=sx(o);function o(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:30,bottom:30,right:30,left:60},e.tickWidth=10,e.id=t.id,e.item=t.item,e.itemName=Ju.getData(e.id).data.lookup[e.item],void 0===e.itemName&&(e.itemName=e.item),e.query=t.query,e.target=t.target,e.path=t.path,e.filter=!1,e.query.indexOf(null)>=0&&(e.filter=!0),e.yMinMax,e.filter){var n=e.query.filter((function(t){return null!==t}));if(n.length>0){for(var r=n[0][0],i=n[0][1],s=1;s<n.length;s++)n[s][0]<r&&(r=n[s][0]),i<n[s][1]&&(i=n[s][1]);e.yMinMax=[Math.min(r,Math.min.apply(null,e.target)),Math.max(i,Math.max.apply(null,e.target))]}else e.yMinMax=[Math.min.apply(null,e.target),Math.max.apply(null,e.target)]}else{var l=Math.min.apply(null,e.query),u=Math.max.apply(null,e.query);"PA"===e.item&&(l/=2,u/=2),"PD"===e.item&&(l*=100,u*=100),e.yMinMax=[Math.min(l,Math.min.apply(null,e.target)),Math.max(u,Math.max.apply(null,e.target))]}return e.state={width:t.width,height:t.height},e}return e=o,(n=[{key:"componentDidMount",value:function(){this.initLineChart()}},{key:"componentWillUnmount",value:function(){}},{key:"initLineChart",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;if(this.parentArea=se("#lineChartArea_"+this.item),this.svg=this.parentArea.append("svg").attr("id","lineChart_"+this.item).attr("class","lineChart").attr("width",this.state.width).attr("height",this.state.height),this.graphName=this.svg.append("text").attr("x",this.margin.left+t/2).attr("y",this.margin.top).attr("text-anchor","middle").style("fill","black").style("font-size","0.8rem").text(this.itemName),this.xScale=Na().domain([0,this.filter?this.target.length-1:Math.max(this.query.length-1,this.target.length-1)]).nice().range([0,t]),this.xLabel=V(this.xScale).tickFormat(wd),this.xAxis=this.svg.append("g").attr("class","x_axis").attr("transform","translate("+this.margin.left+","+(this.margin.top+e)+")").call(this.xLabel),this.yScale=Na().domain(this.yMinMax).nice().range([e,0]),this.yLabel=j(this.yScale).ticks(5).tickFormat(wd),this.yAxis=this.svg.append("g").attr("class","y_axis").attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.yLabel),this.filter){for(var n=[],r=0;r<this.query.length;r++)if(this.query[r])for(var i=0;i<this.path.length&&!(this.path[i][1]<r);i++)this.path[i][1]===r&&n.push({x:this.path[i][0],range:this.query[r]});this.ranges=this.svg.selectAll("line.filteredRange").data(n).enter().append("line").attr("class","filteredRange").attr("x1",function(t){return this.xScale(t.x)}.bind(this)).attr("x2",function(t){return this.xScale(t.x)}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeTop=this.svg.selectAll("line.filteredRangeTop").data(n).enter().append("line").attr("class","filteredRangeTop").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[0])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeBottom=this.svg.selectAll("line.filteredRangeBottom").data(n).enter().append("line").attr("class","filteredRangeBottom").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[1])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}else this.queryPath=this.svg.append("path").datum(this.query).attr("fill","none").attr("stroke","#80b139").attr("stroke-width",1.5).attr("id","lineChartQuery_"+this.item).attr("d",Qs().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){var e=t;return"PA"===this.item&&(e/=2),"PD"===this.item&&(e*=100),this.yScale(e)}.bind(this))).attr("transform","translate("+this.margin.left+","+this.margin.top+")");this.targetPath=this.svg.append("path").datum(this.target).attr("fill","none").attr("stroke","#f26418").attr("stroke-width",1.5).attr("id","lineChartTarget_"+this.item).attr("d",Qs().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){return this.yScale(t)}.bind(this))).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}},{key:"updateLineChart",value:function(){if(this.id=this.props.id,this.item=this.props.item,this.query=this.props.query,this.target=this.props.target,this.path=this.props.path,this.filter=!1,this.query.indexOf(null)>=0&&(this.filter=!0),this.filter){var t=this.query.filter((function(t){return null!==t}));if(t.length>0){for(var e=t[0][0],n=t[0][1],r=1;r<t.length;r++)t[r][0]<e&&(e=t[r][0]),n<t[r][1]&&(n=t[r][1]);this.yMinMax=[Math.min(e,Math.min.apply(null,this.target)),Math.max(n,Math.max.apply(null,this.target))]}else this.yMinMax=[Math.min.apply(null,this.target),Math.max.apply(null,this.target)]}else this.yMinMax=[Math.min(Math.min.apply(null,this.query),Math.min.apply(null,this.target)),Math.max(Math.max.apply(null,this.query),Math.max.apply(null,this.target))];this.svg.selectAll("line.filteredRange").remove(),this.svg.selectAll("line.filteredRangeTop").remove(),this.svg.selectAll("line.filteredRangeBottom").remove(),this.changeLineChart()}},{key:"changeLineChart",value:function(){if(this.xScale.domain([0,Math.max(this.query.length,this.target.length)]).nice(),this.xLabel=V(this.xScale).tickFormat(wd),this.xAxis.call(this.xLabel),this.yScale.domain(this.yMinMax).nice(),this.yLabel=j(this.yScale).ticks(5).tickFormat(wd),this.yAxis.call(this.yLabel),this.filter){for(var t=[],e=0;e<this.query.length;e++)if(this.query[e])for(var n=0;n<this.path.length&&!(this.path[n][1]<e);n++)this.path[n][1]===e&&t.push({x:this.path[n][0],range:this.query[e]});this.ranges=this.svg.selectAll("line.filteredRange").data(t).enter().append("line").attr("class","filteredRange").attr("x1",function(t){return this.xScale(t.x)}.bind(this)).attr("x2",function(t){return this.xScale(t.x)}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeTop=this.svg.selectAll("line.filteredRangeTop").data(t).enter().append("line").attr("class","filteredRangeTop").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[0])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[0])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.rangeBottom=this.svg.selectAll("line.filteredRangeBottom").data(t).enter().append("line").attr("class","filteredRangeBottom").attr("x1",function(t){return this.xScale(t.x)-this.tickWidth/2}.bind(this)).attr("x2",function(t){return this.xScale(t.x)+this.tickWidth/2}.bind(this)).attr("y1",function(t){return this.yScale(t.range[1])}.bind(this)).attr("y2",function(t){return this.yScale(t.range[1])}.bind(this)).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}else this.queryPath.datum(this.query).attr("d",Qs().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){var e=t;return"PA"===this.item&&(e/=2),"PD"===this.item&&(e*=100),this.yScale(e)}.bind(this)));this.targetPath.datum(this.target).attr("d",Qs().x(function(t,e){return this.xScale(e)}.bind(this)).y(function(t){return this.yScale(t)}.bind(this)))}},{key:"render",value:function(){return document.getElementById("lineChartArea_"+this.item)&&this.updateLineChart(),i.a.createElement("div",{id:"lineChartArea_"+this.item})}}])&&ax(e.prototype,n),r&&ax(e,r),o}(i.a.Component);function hx(t){return(hx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fx(t,e){return(fx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function px(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gx(t);if(e){var i=gx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mx(this,n)}}function mx(t,e){return!e||"object"!==hx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gx(t){return(gx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var vx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fx(t,e)}(o,t);var e,n,r,a=px(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).data=Ju.getData(t.id),e.margin={left:20,right:20},e.importedFlag=t.importedFlag,e.divId=e.importedFlag?"resultTimeline_"+t.id+"_imported":"resultTimeline_"+t.id,e.state={id:t.id,results:t.results,importedResults:[],height:t.height,width:0},e.resultsVQ=null,e.resultsFlare=null,e.resultsRotation=null,e.resultsAnomaly=null,e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{id:this.divId,className:"timeline"})}},{key:"componentDidMount",value:function(){var t=this;this.initializeTimeline(),this.setUpTimeline(),Rh.on("updateShownResults",(function(e){t.updateTimeline()})),Rh.on("switchQueryMode",(function(e){t.setState({width:$("#resultTimelineArea_"+t.state.id).width()}),t.resizeTimeLine()})),Su.on("resizeExtractionResultsArea",(function(){$("#extractionResults").length&&(t.setState({width:$("#resultTimelineArea_"+t.state.id).width()}),t.resizeTimeLine())})),Rh.on("recoverQuery",(function(e){"QBE"===Rh.getMode()&&t.state.results.length>0&&(t.setState({width:Math.max($("#resultTimelineArea_"+t.state.id).width(),400)}),t.resizeTimeLine())}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById(this.divId);if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"initializeTimeline",value:function(){this.svg=se("#"+this.divId).append("svg").attr("id","resultTimelineSVG_"+this.state.id),this.xScale=Na().domain([this.data.data.meta.min.z,this.data.data.meta.max.z]),this.xAxis=this.svg.append("g").attr("class","x-axis"),this.tooltip=se("#"+this.divId).append("div").attr("class","tooltip").attr("id","tooltipResultTimeline_"+this.state.id).style("opacity",.75).style("visibility","hidden")}},{key:"updateTimeline",value:function(){this.data=Ju.getData(this.props.id),this.setState({id:this.props.id,results:this.props.results,height:this.props.height}),this.resultsVQ=null,this.resultsFlare=null,this.resultsRotation=null,this.resultsAnomaly=null,this.setUpTimeline()}},{key:"setUpTimeline",value:function(){var t=$("#resultTimelineArea_"+this.state.id).width(),e=this.state.height;this.setState({width:t});var n=t-this.margin.left-this.margin.right,r=e;this.svg.attr("width",t).attr("height",e),this.xScale.domain([this.data.data.meta.min.z,this.data.data.meta.max.z]).nice().range([0,n]),this.xLabel=V(this.xScale).ticks(10).tickSize(10),this.xAxis.attr("transform","translate("+this.margin.left+","+(r/2-5)+")").call(this.xLabel);var i=this.state.results.filter((function(t){return void 0!==t.distance})),a=this.state.results.filter((function(t){return t.angle})),o=[];this.state.results.forEach((function(t){t.V?o=o.concat(t):t.flares&&(o=o.concat(t.flares))}));var s=this.state.results.filter((function(t){return t.anomalyDegree}));this.svg.selectAll("line.resultsVQ").remove(),this.svg.selectAll("line.resultsRotation").remove(),this.svg.selectAll("circle.resultsFlare").remove(),this.svg.selectAll("circle.resultsAnomaly").remove(),i.length>0&&(this.resultsVQ=this.svg.selectAll("line.resultsVQ").data(i).enter().append("line").attr("class","resultsVQ").attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("y1",r/2-5).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)).attr("y2",r/2-5).attr("stroke",this.importedFlag?"#1d33c6":"#1d95c6").attr("stroke-width",20).attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),a.length>0&&(this.resultsRotation=this.svg.selectAll("line.resultsRotation").data(a).enter().append("line").attr("class","resultsRotation").attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("y1",r/2-5).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)).attr("y2",r/2-5).attr("stroke",this.importedFlag?"#b1a639":"#80b139").attr("stroke-width",20).attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),o.length>0&&(this.resultsFlare=this.svg.selectAll("circle.resultsFlare").data(o).enter().append("circle").attr("class","resultsFlare").attr("cx",function(t){return this.xScale(t.start)}.bind(this)).attr("cy",r/2-5).attr("r",10).attr("fill",this.importedFlag?"#f2d118":"#f26418").attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick())),s.length>0&&(this.resultsAnomaly=this.svg.selectAll("circle.resultsAnomaly").data(s).enter().append("circle").attr("class","resultsAnomaly").attr("cx",function(t){return this.xScale(t.start)}.bind(this)).attr("cy",r/2-5).attr("r",10).attr("fill",this.importedFlag?"#f2d118":"#d23430").attr("opacity",.5).attr("transform","translate("+this.margin.left+",0)").on("mouseover",this.importedFlag?this.timelineImportedResultsMouseOver():this.timelineMouseOver()).on("mouseout",this.importedFlag?this.timelineImportedReusltsMouseOut():this.timelineMouseOut()).on("click",this.importedFlag?null:this.timelineClick()))}},{key:"resizeTimeLine",value:function(){var t=$("#resultTimelineArea_"+this.state.id).width(),e=t-this.margin.left-this.margin.right;this.svg.attr("width",t),this.xScale.range([0,e]),this.xLabel=V(this.xScale).ticks(10).tickSize(10),this.xAxis.call(this.xLabel),this.resultsVQ&&this.resultsVQ.attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)),this.resultsRotation&&this.resultsRotation.attr("x1",function(t){return this.xScale(t.start)}.bind(this)).attr("x2",function(t){return this.xScale(t.start+t.period)}.bind(this)),this.resultsFlare&&this.resultsFlare.attr("cx",function(t){return this.xScale(t.start)}.bind(this)),this.resultsAnomaly&&this.resultsAnomaly.attr("cx",function(t){return this.xScale(t.start)}.bind(this))}},{key:"timelineMouseOver",value:function(){var t=this.tooltip,e=this.xScale,n=this.svg.attr("width");return function(r){var i=se(this);i.attr("stroke")?i.attr("stroke","#284a6c").moveToFront():i.attr("fill")&&i.attr("fill","#284a6c").moveToFront(),t.transition().duration(50).style("visibility","visible");var a,o="";for(var s in r)if("id"!==s&&"start"!==s&&"period"!==s&&"flares"!==s&&"path"!==s){var l=r[s];if("object"===hx(r[s])){for(var u in l="(",r[s])l+=Sd(r[s][u])+", ";l=l.slice(0,l.length-2),l+=")"}else"number"==typeof r[s]&&(l=Sd(r[s]));o+="<tr><td>"+wh(s)+"</td><td>"+l+"</td></tr>"}if(e(r.start)<n/2)t.html("<table><tbody>"+o+"</tbody></table>").style("left",e(r.start)+50+"px").style("top","10px");else{var c=Number(t.style("width").slice(0,-2));t.html("<table><tbody>"+o+"</tbody></table>").style("left",e(r.start)-c+20+"px").style("top","10px")}a=r,hu.dispatch({type:"FOCUS_RESULT_FROM_TIMELINE",result:a})}}},{key:"timelineImportedResultsMouseOver",value:function(){var t=this.tooltip,e=this.xScale,n=this.svg.attr("width");return function(r){var i=se(this);i.attr("stroke")?i.attr("stroke","#28286c").moveToFront():i.attr("fill")&&i.attr("fill","#28286c").moveToFront(),t.transition().duration(50).style("visibility","visible");var a="";for(var o in r)if("fileName"!==o&&"path"!==o){var s=r[o];if(Array.isArray(r[o]))s=r[o].join(", ");else if("object"===hx(r[o])){for(var l in s="(",r[o])s+=Sd(r[o][l])+", ";s=s.slice(0,s.length-2),s+=")"}else"number"==typeof r[o]&&(s=Sd(r[o]));a+="<tr><td>"+wh(o)+"</td><td>"+s+"</td></tr>"}if(e(r.start)<n/2)t.html("<table><tbody>"+a+"</tbody></table>").style("left",e(r.start)+50+"px").style("top","10px");else{var u=Number(t.style("width").slice(0,-2));t.html("<table><tbody>"+a+"</tbody></table>").style("left",e(r.start)-u+20+"px").style("top","10px")}}}},{key:"timelineMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);e.distance?n.attr("stroke","#1d95c6"):e.angle?n.attr("stroke","#80b139"):e.V?n.attr("fill","#f26418"):e.anomalyDegree&&n.attr("fill","#d23430"),t.transition().duration(100).style("visibility","hidden")}}},{key:"timelineImportedReusltsMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);e.distance?n.attr("stroke","#1d33c6"):e.angle?n.attr("stroke","#b1a639"):(e.V||e.anomalyDegree)&&n.attr("fill","#f2d118"),t.transition().duration(100).style("visibility","hidden")}}},{key:"timelineClick",value:function(){return function(t){var e;e=t,hu.dispatch({type:"SELECT_RESULT_FROM_TIMELINE",result:e})}}}])&&dx(e.prototype,n),r&&dx(e,r),o}(i.a.Component);function yx(t){return(yx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xx(t,e){return(xx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Sx(t);if(e){var i=Sx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wx(this,n)}}function wx(t,e){return!e||"object"!==yx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sx(t){return(Sx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ex=n(379),Mx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xx(t,e)}(o,t);var e,n,r,a=_x(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).height=100,e.margin={left:30,right:10,top:5,bottom:22},e.results=[],e.bins=[],e.dragFlag=!1,e.handleFlag=!1,e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{id:"distanceHistogram",style:{width:"100%"}})}},{key:"componentDidMount",value:function(){var t=this;this.initHistogram(),Su.on("resizeExtractionResultsArea",(function(){$("#extractionResults").length&&t.results.length>0&&t.updateHistogram()})),Rh.on("updateShownResults",(function(){var e=Rh.getParameters(),n=Rh.getQuery();e&&"visual query"===n.mode&&(t.results=Rh.getExtractionResults(),t.updateHistogram())})),Rh.on("recoverQuery",(function(e){"QBE"===Rh.getMode()&&t.results.length>0&&t.updateHistogram()}))}},{key:"initHistogram",value:function(){this.svg=se("#distanceHistogram").append("svg").attr("id","distanceHistogramSVG"),this.xScale=Na(),this.xAxis=this.svg.append("g").attr("class","x-axis"),this.yScale=Na(),this.yAxis=this.svg.append("g").attr("class","y-axis"),this.brushRect=this.svg.append("rect").attr("id","brushingRectHistogram").style("fill","rgb(119, 119, 119)").style("fill-opacity",.3),this.brushLine=this.svg.append("line").attr("id","brushingLineHistogram").attr("stroke","#80b139").attr("stroke-width",4),this.horizontalLine=this.svg.append("line").attr("id","horizontalLineHistogram").attr("stroke","orange").attr("stroke-width",2).attr("fill","none").style("visibility","hidden")}},{key:"updateHistogram",value:function(){var t=Math.max($("#distanceHistogram").width(),400),e=t-this.margin.left-this.margin.right,n=this.height-this.margin.top-this.margin.bottom;this.svg.attr("width",t).attr("height",this.height);var r=p(this.results,(function(t){return t.distance}));this.xScale.domain(r).range([0,e]).nice(),this.xLabel=V(this.xScale).tickFormat(wd),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+n)+")").call(this.xLabel);var i=T().value((function(t){return t.distance})).domain(this.xScale.domain()).thresholds(this.xScale.ticks(Math.min(20,Math.floor(this.results.length/4))));this.bins=i(this.results),this.yScale.range([n,0]).domain([0,k(this.bins,(function(t){return t.length}))]),this.yLabel=j(this.yScale).ticks(5),this.yAxis.attr("transform","translate("+this.margin.left+","+this.margin.top+")").call(this.yLabel),this.svg.selectAll("rect.histogramRect").remove(),this.bars=this.svg.selectAll("rect.histogramRect").data(this.bins).enter().append("rect").attr("class","histogramRect").attr("x",1).attr("transform",function(t){return"translate("+(this.xScale(t.x0)+this.margin.left)+","+(this.yScale(t.length)+this.margin.top)+")"}.bind(this)).attr("width",function(t){return this.xScale(t.x1)-this.xScale(t.x0)-1}.bind(this)).attr("height",function(t){return n-this.yScale(t.length)}.bind(this)).style("fill","#284a6c").style("opacity",.75).on("mouseover",this.mouseOverOnHistogram()).on("mouseout",this.mouseOutFromHistogram());for(var a=Rh.getKValue(),o=0,s=0;s<this.bins.length;s++){if(o+this.bins[s].length>=a){var l=this.xScale(this.bins[s].x0+(this.bins[s].x1-this.bins[s].x0)/this.bins[s].length*(a-o));this.brushRect.attr("x",this.margin.left).attr("y",this.margin.top).attr("width",l).attr("height",this.yScale(0)),this.brushLine.attr("x1",l+this.margin.left).attr("y1",this.margin.top).attr("x2",l+this.margin.left).attr("y2",this.yScale(0)+this.margin.top);break}o+=this.bins[s].length}var u=pi().on("start",this.dragStartOnHistogram()).on("drag",this.dragOnHistogram()).on("end",this.dragEndOnHistogram());this.brushLine.call(u),Ex.element(this.brushLine.node()).toTop()}},{key:"mouseOverOnHistogram",value:function(){var t=this.horizontalLine,e=this.xScale,n=this.yScale,r=this.margin;return function(i){Us("rect.histogramRect").style("fill","#7b7971"),se(this).style("fill","#284a6c"),t.attr("x1",e(e.domain()[0])+r.left).attr("y1",n(i.length)+r.top).attr("x2",e(i.x1)+r.left).attr("y2",n(i.length)+r.top).style("visibility","visible"),Ex.element(t.node()).toTop()}}},{key:"mouseOutFromHistogram",value:function(){var t=this.horizontalLine;return function(e){Us("rect.histogramRect").style("fill","#284a6c"),t.style("visibility","hidden")}}},{key:"dragStartOnHistogram",value:function(){return function(){se(this).classed("brushingLineHistogram",!0)}}},{key:"dragOnHistogram",value:function(){var t=this.margin,e=this.xScale.range(),n=this.xScale,r=this.bins;return function(){var i=se("#brushingLineHistogram"),a=$t.x;a<=t.left?a=t.left:t.left+e[1]<=a&&(a=t.left+e[1]),i.attr("x1",a).attr("x2",a),se("rect#brushingRectHistogram").attr("width",a-t.left);for(var o=se("rect#brushingRectHistogram").attr("width"),s=n.invert(o),l=0,u=0;u<r.length;u++)if(r[u].x1<=s)l+=r[u].length;else if(r[u].x0<=s&&s<=r[u].x1){var c=s-r[u].x0;l+=Math.ceil(r[u].length*c/(r[u].x1-r[u].x0));break}$("#topKLabelResults").text("Top "+l+" results")}}},{key:"dragEndOnHistogram",value:function(){var t=this.xScale,e=this.bins;return function(){se(this).classed("brushingLineHistogram",!0);for(var n=se("rect#brushingRectHistogram").attr("width"),r=t.invert(n),i=0,a=0;a<e.length;a++)if(e[a].x1<=r)i+=e[a].length;else if(e[a].x0<=r&&r<=e[a].x1){var o=r-e[a].x0;i+=Math.ceil(e[a].length*o/(e[a].x1-e[a].x0));break}rh(i),$("#topKResults").val(i),$("#topKLabelResults").text("Top "+i+" results"),$("#matchingStatus").text("searching..."),setTimeout(function(){Uf()}.bind(this),0)}}}])&&bx(e.prototype,n),r&&bx(e,r),o}(i.a.Component);function Cx(t){return(Cx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kx(t,e){return(kx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Px(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ox(t);if(e){var i=Ox(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ax(this,n)}}function Ax(t,e){return!e||"object"!==Cx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ox(t){return(Ox=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kx(t,e)}(o,t);var e,n,r,a=Px(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).LCWidth=300,e.LCHeight=200,e.optimalWarpPath=null,e.state={shownResults:[],LC:[],selected:{},accessibility:"private",mode:Rh.getMode(),AEOptions:Rh.getAEOptions(),importedResults:{}},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#topKResults").val(20);var e=window.innerHeight-$("#appHeader").outerHeight(!0);$("#extractionResults").height(e),Rh.on("setExtractionResults",(function(){t.setState({selected:{}}),"block"===$("#resultDetailArea").css("display")&&xh()})),Rh.on("showLineCharts",(function(e){t.setState({LC:e})})),Rh.on("updateSelectedResult",(function(e,n,r){t.LCWidth=Math.max(300,n),t.LCHeight=Math.max(200,r),e.path&&(t.optimalWarpPath=e.path),t.setState({selected:e})})),Rh.on("clearResults",(function(){t.setState({shownResults:[],importedResults:{}})})),Rh.on("updateShownResults",(function(e){t.setState({shownResults:e,importedResults:{}})})),Rh.on("selectResultFromTimeline",(function(e){var n=$("#extractionDetailLC").width();t.LCWidth=Math.max(300,n),t.LCHeight=200,e.path&&(t.optimalWarpPath=e.path),t.setState({selected:e})})),Rh.on("switchQueryMode",(function(){t.setState({mode:Rh.getMode()})})),Rh.on("updateAEOption",(function(){t.setState({AEOptions:Rh.getAEOptions()})})),Rh.on("recoverQuery",(function(e){t.setState({mode:Rh.getMode()}),"block"===$("#resultDetailArea").css("display")&&xh()}))}},{key:"updateOrder",value:function(){var t=document.getElementById("resultOrderList"),e=t.selectedIndex;ih(t.options[e].value),Uf()}},{key:"updateKValue",value:function(){rh(Number($("#topKResults").val())),$("#topKLabelResults").text("Top "+$("#topKResults").val()+" results"),Uf()}},{key:"updateDistanceThreshold",value:function(){var t;t=$("#distanceThreshold").val(),hu.dispatch({type:"UPDATE_DISTANCE_THRESHOLD",threshold:t}),Uf()}},{key:"orderOfResults",value:function(){return i.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"},onChange:this.updateOrder.bind(this)},i.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Sort results by"),i.a.createElement("select",{id:"resultOrderList",className:"custom-select custom-select-sm",style:{width:"7rem"}},function(){var t=[];t.push("Time stamp"),t.push("Data");var e=[];"AE"===Rh.getMode()?(Rh.getAEOptionStatus("flare")&&(t.push("Significance"),t.push("Intensity")),Rh.getAEOptionStatus("rotation")&&(t.push("Angle"),t.push("Diameter"),t.push("Period")),Rh.getAEOptionStatus("anomaly")&&t.push("Anomaly degree")):t.push("Distance");for(var n=0;n<t.length;n++){var r=Sh(t[n]);e.push(i.a.createElement("option",{value:r,key:r},t[n]))}return e}()))}},{key:"distanceThreshold",value:function(){return i.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"}},i.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Distance threshold"),i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"threshold",id:"distanceThreshold",onChange:this.updateDistanceThreshold.bind(this),style:{width:"7rem"}}))}},{key:"topKResults",value:function(){var t=!1;return"AE"===this.state.mode&&(this.state.AEOptions.flare||this.state.AEOptions.rotation)&&(t=!0),i.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"left",marginLeft:"1rem"}},i.a.createElement("label",{className:"col-form-label col-form-label-sm",style:{marginRight:"0.5rem"}},"Top k result"),i.a.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"k value",id:"topKResults",disabled:t,onChange:this.updateKValue.bind(this),style:{width:"7rem"}}))}},{key:"importResultsButton",value:function(){return i.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"right"}},i.a.createElement("button",{id:"importResultsBtn",className:"btn btn-primary btn-sm",onClick:this.importResultsClick.bind(this)},"Import"))}},{key:"importResultsClick",value:function(){"block"===document.getElementById("importResultsForm").style.display?document.getElementById("importResultsForm").style.display="none":document.getElementById("importResultsForm").style.display="block"}},{key:"exportResultsButton",value:function(){return i.a.createElement("div",{className:"form-group form-inline resultMenu",style:{float:"right"}},i.a.createElement("button",{id:"exportResultsBtn",className:"btn btn-primary btn-sm",onClick:this.exportResults.bind(this)},"Export"))}},{key:"exportResults",value:function(){var t={};t.query=Rh.getQuery(),t.query.parameters=Rh.getParameters(),t.results=[];for(var e=0;e<this.state.shownResults.length;e++){var n={};for(var r in this.state.shownResults[e])"id"===r?n.fileName=Ju.getFileName(Number(this.state.shownResults[e][r])):n[r]=this.state.shownResults[e][r];t.results.push(n)}t=JSON.stringify(t,null,"\t");var i="extractionResults_"+mh()+".json",a=new Blob([t],{type:"application/json"}),o=(window.URL||window.webkitURL).createObjectURL(a),s=document.createElement("a");s.download=decodeURI(i),s.href=o,s.click()}},{key:"popupCommentForm",value:function(){return i.a.createElement("div",{className:"formPopup",id:"commentFormFeatureExtraction"},i.a.createElement("form",{className:"formContainer"},i.a.createElement("h6",null,"User name"),i.a.createElement("input",{type:"text",id:"userNameComment",className:"form-control form-control-sm",placeholder:"Enter Name",name:"name",required:!0}),i.a.createElement("h6",null,"Accessibility"),i.a.createElement("div",{className:"form-check form-inline",id:"accessibility",onChange:this.updateAccessibility.bind(this),style:{paddingLeft:"0px"}},i.a.createElement("div",{className:"custom-control custom-radio"},i.a.createElement("input",{type:"radio",id:"privateComment",name:"accessibility",value:"private",checked:"private"===this.state.accessibility,className:"custom-control-input",readOnly:!0}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"privateComment"},"Private"))),i.a.createElement("h6",null,"Label"),i.a.createElement("div",{className:"form-check form-check-inline menuItem"},i.a.createElement("select",{className:"form-control custom-select",id:"commentLabelColorList",style:{fontSize:"0.8rem",height:"1.5rem",width:"7rem"}},i.a.createElement("option",{value:"0x29ABE0",style:{color:"#29ABE0"}},"Blue"),i.a.createElement("option",{value:"0x80b139",style:{color:"#80b139"}},"Green"),i.a.createElement("option",{value:"0xffd700",style:{color:"#ffd700"}},"Yellow"),i.a.createElement("option",{value:"0xF47C3C",style:{color:"#F47C3C"}},"Orange"),i.a.createElement("option",{value:"0xd9534f",style:{color:"#d9534f"}},"Red"),i.a.createElement("option",{value:"0xba55d3",style:{color:"#ba55d3"}},"Purple"))),i.a.createElement("h6",null,"Comment"),i.a.createElement("textarea",{className:"form-control",id:"textareaComment",placeholder:"Enter comment",rows:"3",style:{marginBottom:"0.5rem"}}),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"submitCommentBtn",onClick:this.submitComment.bind(this),style:{float:"right"}},"Submit"),i.a.createElement("button",{className:"btn btn-secondary btn-sm",type:"button",id:"cancelCommentBtn",style:{float:"right"},onClick:this.cancelComment.bind(this)},"Cancel")))}},{key:"popupImportResultsForm",value:function(){var t=[];if(Object.keys(this.state.importedResults).length>0)for(var e in this.state.importedResults.query)if("mode"===e||"option"===e){var n=this.state.importedResults.query[e];Array.isArray(n)&&(n=n.join(", ")),t.push(i.a.createElement("tr",{key:e},i.a.createElement("td",null,wh(e)),i.a.createElement("td",null,n)))}else if("query"===e)for(var r in this.state.importedResults.query.query)if("controlPoints"!==r&&"path"!==r&&"size"!==r&&"length"!==r){var a=this.state.importedResults.query.query[r];if("inactiveVariables"===r){for(var o=[],s=0;s<this.state.importedResults.query.query[r].length;s++)o.push(this.state.importedResults.query.query[r][s].join(", "));a=o.join(", ")}else if("activeVariables"===r){for(var l=[],u=0;u<this.state.importedResults.query.query[r].length;u++)l.push(this.state.importedResults.query.query[r][u].join(", "));a=l.join(", ")}else Array.isArray(a)&&(a=a.join(", "));t.push(i.a.createElement("tr",{key:r},i.a.createElement("td",null,wh(r)),i.a.createElement("td",null,a)))}return i.a.createElement("div",{className:"formPopup",id:"importResultsForm"},i.a.createElement("h6",null,"From a file"),i.a.createElement("div",{className:"custom-file",style:{marginRight:"0.5rem"}},i.a.createElement("input",{type:"file",id:"importResultsFile",className:"custom-file-input",onChange:this.importResultsFile.bind(this)}),i.a.createElement("label",{className:"custom-file-label",htmlFor:"importResultsFile",style:{justifyContent:"start"}},"Import results")),i.a.createElement("div",{id:"importedQueryInfo",style:{display:Object.keys(this.state.importedResults).length>0?"block":"none"}},i.a.createElement("h6",null,"Query information"),i.a.createElement("table",{id:"importedQueryInfoTable",className:"table table-hover"},i.a.createElement("tbody",{id:"importedQueryInfoBody"},t)),i.a.createElement("div",{id:"importedQueryMenu",style:{float:"right"}},i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"clearTheImportedResultsBtn",onClick:this.clearTheImportedResults.bind(this)},"Clear"),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"recoverTheImportedQueryBtn",onClick:this.recoverTheQuery.bind(this)},"Recover the query"))))}},{key:"importResultsFile",value:function(){var t=document.getElementById("importResultsFile").files,e=new FileReader;e.readAsText(t[0]),e.onload=function(){var t=JSON.parse(e.result);this.setState({importedResults:t})}.bind(this)}},{key:"recoverTheQuery",value:function(){if(Object.keys(this.state.importedResults).length>0){var t=!0;"visual query"===this.state.importedResults.query.mode&&"query-by-example"===this.state.importedResults.query.option?Ju.getIdFromName(this.state.importedResults.query.query.source)<0&&(alert("You have to open the file whose file name is "+this.state.importedResults.query.query.source+"to recover the query-by-example."),t=!1):"visual query"===this.state.importedResults.query.mode&&this.state.importedResults.query.option,t&&(ah(this.state.importedResults.query),du("feature"))}}},{key:"clearTheImportedResults",value:function(){this.setState({importedResults:{}}),"block"===document.getElementById("importResultsForm").style.display&&(document.getElementById("importResultsForm").style.display="none")}},{key:"updateAccessibility",value:function(){var t=$("input[name=accessibility]:checked").val();this.setState({accessibility:t})}},{key:"addComment",value:function(){document.getElementById("commentFormFeatureExtraction").style.display="block"}},{key:"cancelComment",value:function(){document.getElementById("commentFormFeatureExtraction").style.display="none"}},{key:"submitComment",value:function(t){var e=$("#userNameComment").val(),n=this.state.accessibility,r=$("#textareaComment").val(),i=(new Date).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),a=document.getElementById("commentLabelColorList"),o=a.selectedIndex,s=a.options[o].value;"private"===n&&function(t,e,n){var r=hh();null===lh&&(lh=JSON.parse(localStorage.getItem("privateComment"))),null===uh&&(uh=JSON.parse(localStorage.getItem("queryTable")));var i,a=!1;for(i in uh)if(uh[i].mode!==e.mode||JSON.stringify(uh[i].option)!==JSON.stringify(e.option));else{var o=!0;for(var s in uh[i])if("id"!==s)if("parameters"===s){if(!Object(Pc.isEqual)(n,uh[i][s])){o=!1;break}}else if(!(s in e)||!Object(Pc.isEqual)(e[s],uh[i][s])){o=!1;break}if(o){a=!0;break}}if(a)t.queryId=i;else{var l={},u=hh();for(var c in e)"values"!==c&&(l[c]=e[c]);l.parameters=n,uh[u]=l,localStorage.setItem("queryTable",JSON.stringify(uh)),t.queryId=u}lh[r]=t,localStorage.setItem("privateComment",JSON.stringify(lh))}({timeStamp:i,fileName:Ju.getData(this.state.selected.id).name,userName:e,labelColor:s,start:this.state.selected.start,period:"period"in this.state.selected?this.state.selected.period:void 0,comment:r},Rh.getQuery(),Rh.getParameters()),document.getElementById("commentFormFeatureExtraction").style.display="none",$("#userNameComment").val(""),$("#textareaComment").val(""),bc()}},{key:"showTT",value:function(){var t,e,n;du("visualization"),this.state.selected.angle?(t=this.state.selected.id,e=[this.state.selected.start,this.state.selected.start+this.state.selected.period],n=this.state.selected.center,hu.dispatch({type:"SHOW_ROTATION_CENTER",id:t,period:e,center:n})):this.state.selected.period?Vu(this.state.selected.id,[this.state.selected.start,this.state.selected.start+this.state.selected.period]):Ru(this.state.selected.id,this.state.selected.start)}},{key:"showLegendOfLC",value:function(){return i.a.createElement("svg",{id:"lineChartLegend",height:"20px",width:"300px"},i.a.createElement("line",{x1:"0",y1:"12",x2:"40",y2:"12",style:{stroke:"#80b139",strokeWidth:3}}),i.a.createElement("text",{x:"50px",y:"15px",fill:"black",fontSize:"0.8rem"},"Query"),i.a.createElement("line",{x1:"100",y1:"12",x2:"140",y2:"12",style:{stroke:"#f26418",strokeWidth:3}}),i.a.createElement("text",{x:"150px",y:"15px",fill:"black",fontSize:"0.8rem"},"Result"))}},{key:"splitResultsByData",value:function(){for(var t=this.state.shownResults.slice().sort(jf("data")),e={},n=0,r=[],i=t[0].id;n<t.length;)t[n].id!==i&&(e[i]=r,i=t[n].id,r=[]),r.push(t[n]),n++;return r.length>0&&(e[i]=r),e}},{key:"splitImportedResultsByData",value:function(){for(var t=this.state.importedResults.results.slice().sort(jf("fileName")),e={},n=0,r=[],i=t[0].fileName,a=Ju.getIdFromName(i);n<t.length;)a>=0&&(t[n].fileName!==i&&(e[a]=r,i=t[n].fileName,a=Ju.getIdFromName(i),r=[]),r.push(t[n])),n++;return r.length>0&&(e[a]=r),e}},{key:"render",value:function(){var t=[],e=[];if(Object.keys(this.state.selected).length>0){if(this.state.selected.period&&!this.state.selected.angle){var n,r=Ju.getDataArray(this.state.selected.id,1),a=Rh.getQuery(),o=r.z.indexOf(this.state.selected.start),s=r.z.indexOf(this.state.selected.start+this.state.selected.period);for(var l in a.values)if(Array.isArray(a.values[l])&&(Array.isArray(r[l])||"r"==l||"theta"===l)&&"z"!==l){if(a.values[l].indexOf(null)>=0){for(var u=!1,c=0;c<a.values[l].length;c++)if(a.values[l][c]){u=!0;break}if(!u)continue}var h=l;"r"===l?(n=r.PD.slice(o,s+1),h="PD"):"theta"===l?(n=r.PA.slice(o,s+1),h="PA"):n=r[l].slice(o,s+1),t.push(i.a.createElement(cx,{key:l,id:this.state.selected.id,item:h,query:a.values[l],target:n,width:this.LCWidth,height:this.LCHeight,path:"Object"==typeof this.optimalWarpPath?this.optimalWarpPath[l]:this.optimalWarpPath}))}}for(var d in this.state.selected)if("id"!==d&&"path"!==d&&!Array.isArray(this.state.selected[d])){var f=void 0;f="V"===d?"Flx(V)":wh(d);var p=this.state.selected[d];if("object"===Cx(p)){var m="(";for(var g in p)m+=Sd(p[g])+", ";m=m.slice(0,m.length-2),p=m+=")"}else"string"==typeof p||"number"==typeof p&&(p=Sd(p));e.push(i.a.createElement("tr",{id:"extractionDetail"+f,key:d},i.a.createElement("td",null,f),i.a.createElement("td",{id:"extractionDetail"+f+"Value"},p)))}var v=Ju.getData(this.state.selected.id).data.lookup,y=Rh.getActive();if(y){for(var b="",x=0;x<y.length;x++)b+=v[y[x]]+", ";b=b.slice(0,b.length-2),e.push(i.a.createElement("tr",{id:"extractionDetailVariables",key:"variables"},i.a.createElement("td",null,"Variables"),i.a.createElement("td",{id:"extractionDetailVariablesValue"},b)))}}var _=[];if(this.state.shownResults.length>0){var w=this.splitResultsByData();if(Object.keys(this.state.importedResults).length<=0)for(var S in w)_.push(i.a.createElement("div",{className:"row",key:S},i.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},i.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Ju.getFileName(Number(S)))),i.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+S},i.a.createElement(vx,{id:Number(S),results:w[S],importedFlag:!1,height:40}))));else{var E=this.splitImportedResultsByData();for(var M in w)E[M]?_.push(i.a.createElement("div",{className:"row",key:M},i.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},i.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Ju.getFileName(Number(M)))),i.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+M},i.a.createElement(vx,{id:Number(M),results:w[M],importedFlag:!1,height:40}),i.a.createElement(vx,{id:Number(M),results:E[M],importedFlag:!0,height:40})))):_.push(i.a.createElement("div",{className:"row",key:M},i.a.createElement("div",{className:"col-2",style:{wordWrap:"anywhere",position:"relative",fontSize:"0.7rem",lineHeight:"90%"}},i.a.createElement("label",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},Ju.getFileName(Number(M)))),i.a.createElement("div",{className:"col-10",id:"resultTimelineArea_"+M},i.a.createElement(vx,{id:Number(M),results:w[M],importedFlag:!1,height:40}))))}}return i.a.createElement("div",{id:"extractionResults",className:"resultElem"},i.a.createElement("div",{id:"resultMenus",style:{overflow:"hidden",height:"2rem"}},this.topKResults(),this.distanceThreshold(),this.orderOfResults(),this.exportResultsButton(),this.importResultsButton(),this.popupImportResultsForm()),i.a.createElement("div",{id:"mainResultArea"},i.a.createElement("div",{id:"distanceHistogramArea",className:"resultAreaElem",style:{display:"QBE"===this.state.mode||"QBS"===this.state.mode?"block":"none"}},i.a.createElement("h5",null,"Distance distribution (number vs. distance)"),i.a.createElement("label",{id:"topKLabelResults"}),i.a.createElement(Mx,null)),i.a.createElement("div",{id:"resultTimelinesArea",className:"container resultAreaElem"},_),i.a.createElement("div",{id:"resultDetail",style:{position:"relative",height:"1.5rem",marginBottom:"0px"}},i.a.createElement("div",{id:"resultDetailArea",className:"container",style:{display:"none"}},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3",id:"extractionDetailThumbnail"},i.a.createElement("canvas",{id:"detailThumbnailCanvas"})),i.a.createElement("div",{className:"col-3",id:"extractionDetailInfo"},i.a.createElement("table",{id:"extractionDetailInfoTable",style:{width:"100%"}},i.a.createElement("tbody",null,e)),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"showTTBtn",style:{float:"right"},onClick:this.showTT.bind(this)},"TimeTubes"),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"commentBtn",style:{float:"right"},onClick:this.addComment.bind(this)},"Comment")),i.a.createElement("div",{className:"col",id:"extractionDetailLC"},this.showLegendOfLC(),t))),this.popupCommentForm(),i.a.createElement("button",{id:"collapseResultDetailPanel",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",right:"0.5rem"},onClick:xh},"Open")),i.a.createElement("label",{id:"matchingStatus"}),i.a.createElement("div",{id:"resultsArea"})))}}])&&Tx(e.prototype,n),r&&Tx(e,r),o}(i.a.Component);function Rx(t){return(Rx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ix(t,e){return(Ix=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Fx(t);if(e){var i=Fx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return zx(this,n)}}function zx(t,e){return!e||"object"!==Rx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fx(t){return(Fx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Bx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ix(t,e)}(o,t);var e,n,r,a=Dx(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).margin={top:10,bottom:30,right:10,left:50},e.id=t.id,e.divID=t.divID,e.SPID="QBE_SP_Selector",e.data=Ju.getData(e.id);var n=sd.getTimeRange(e.id);return e.timeRange=void 0===n?[e.data.data.meta.min.z,e.data.data.meta.max.z]:n,e.slicedData=e.data.data.spatial,e.xMinMax=[0,0],e.yMinMax=[0,0],e.selectedPeriod=Rh.getSelectedPeriod(),e.selector="selectRegion",e.state={yItem:t.yItem,yItemonPanel:t.yItem,width:t.width,height:Math.max(t.height,200)},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;this.initalizeElements(),this.computeRange(this.state.yItem),this.drawScatterplots(),this.selectedPeriod[0]>0&&this.selectedPeriod[1]>0&&(this.highlightSelectedTimePeriod(),this.timeRange=[this.selectedPeriod[0]-10,this.selectedPeriod[1]+10],this.updateTimeRange()),lc.on("updateFocus",(function(e,n,r){e===t.id&&(r?t.highlightCurrentPlot(n):t.updateCurrentPos(n))})),lc.on("changePlotColor",(function(e){e===t.id&&t.changePlotColor(lc.getPlotColor(e))})),Rh.on("switchQueryMode",(function(e){"QBE"===e&&"default"!==Rh.getSource()&&t.setState({width:t.props.width,height:Math.max(t.props.height,200)})})),Rh.on("updateSelectedPeriod",(function(){"QBE"===Rh.getMode()&&Number(Rh.getSource())===t.id&&(t.selectedPeriod=Rh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.timeRange=[t.selectedPeriod[0]-10,t.selectedPeriod[1]+10],t.updateTimeRange())})),Rh.on("convertResultIntoQuery",(function(e,n,r){"QBE"===Rh.getMode()&&Number(e)===t.id&&(t.selectedPeriod=Rh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.timeRange=[t.selectedPeriod[0]-10,t.selectedPeriod[1]+10],t.updateTimeRange())})),Rh.on("switchQBESelectorSP",(function(e){"reset"===e?t.resetScatterplots():(t.selector=e,t.switchMouseInteraction())})),Rh.on("resetSelection",(function(){t.resetSelection()})),Rh.on("selectTimeInterval",(function(e,n){"QBE"===Rh.getMode()&&Number(e)===t.id&&(t.selectedPeriod=Rh.getSelectedPeriod(),t.highlightSelectedTimePeriod(),t.spBrusher.call(t.brush.move,[t.xScale(t.selectedPeriod[0]),t.xScale(t.selectedPeriod[1])]))}))}},{key:"initalizeElements",value:function(){this.zoom=cu().scaleExtent([.05,10]),this.sp=se("#"+this.divID).append("svg").attr("id",this.SPID).attr("class","scatterplot scatterplots"+this.id+" "+this.divID),this.xScale=Na(),this.xScaleTmp=this.xScale,this.xAxis=this.sp.append("g").attr("class","x_axis "+this.divID),this.xAxisText=Us("g.x_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("text-anchor","middle"),this.yScale=Na(),this.yScaleTmp=this.yScale,this.yAxis=this.sp.append("g").attr("class","y_axis "+this.divID).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.yAxisText=Us("g.y_axis."+this.divID).append("text").attr("class","axisLabel "+this.divID).attr("fill","black").attr("transform","rotate(-90)").attr("text-anchor","middle"),this.tooltip=se("#"+this.divID).append("div").attr("class","tooltip "+this.divID).attr("id","tooltip_"+this.SPID).style("opacity",.75).style("visibility","hidden"),this.line=Qs().x((function(t){return t[0]})).y((function(t){return t[1]})),this.lineH=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineH "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.lineV=this.sp.append("path").attr("stroke","orange").attr("fill","none").attr("class","currentLineV "+this.divID+" scatterplots"+this.id).style("opacity",.75).style("visibility","hidden"),this.clip=this.sp.append("defs").append("clipPath").attr("id","clipScatterplots_"+this.SPID).append("rect"),this.point_g=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").classed("points_g",!0);var t=this.state.yItem;this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").select((function(e){return"z"in e&&t in e?this:null})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id),this.brush=Yr(),this.spBrusher=this.sp.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")").attr("clip-path","url(#clipScatterplots_"+this.SPID+")").attr("class","brush");var e=this.props.width,n=Math.max(this.props.height,200);this.setState({width:e,height:n})}},{key:"drawScatterplots",value:function(){var t=this.SPID,e=this.margin,n=this.state.width,r=this.state.height,i=n-this.margin.left-this.margin.right,a=r-this.margin.top-this.margin.bottom,o=this.state.yItem;this.zoom.extent([[0,0],[i,a]]).on("zoom",this.zoomed().bind(this)),this.sp.attr("width",n).attr("height",r).call(this.zoom).on("dblclick.zoom",null).on("mousedown.zoom",null),this.brush.extent([[0,0],[i,a]]).on("start brush",this.brushed().bind(this)).on("end",this.brushedEnd().bind(this)),this.spBrusher.call(this.brush),this.xScale.domain(this.xMinMax).nice().range([0,i]),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-a).tickFormat(wd),this.xAxis.attr("transform","translate("+this.margin.left+","+(this.margin.top+a)+")").call(this.xLabel),this.xAxisText.attr("x",i/2).attr("y",this.margin.bottom/2+10).text(this.data.data.lookup.z),this.yScale.domain(this.yMinMax).nice().range([a,0]),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-i).tickFormat(wd),this.yAxis.call(this.yLabel),this.yAxisText.attr("x",-a/2).attr("y",-this.margin.left/2-10).text(this.data.data.lookup[o]).on("click",function(){var n=se("#changeYAxisPanel_"+t);if("visible"===n.style("visibility"))n.transition().duration(50).style("visibility","hidden"),this.setState({yItemonPanel:this.state.yItem});else{var r=document.getElementById("changeXAxisPanel_"+t).clientHeight;document.getElementById("changeXAxisPanel_"+t).clientWidth,n.style("transform","translate("+e.left+"px,"+(a/2+e.top-r/2)+"px)").style("visibility","visible")}}.bind(this)).on("mouseover",(function(){se(this).style("fill","orange")})).on("mouseout",(function(){se(this).style("fill","black")}));var s=[[0,this.margin.top],[i,this.margin.top]],l=[[this.margin.left,0],[this.margin.left,a]];if(this.lineH.attr("d",this.line(s)),this.lineV.attr("d",this.line(l)),this.clip.attr("width",i).attr("height",a),this.data.data.merge){for(var u={},c=this.data.name.split(","),h=[],d=0;d<c.length;d++){var f=Ju.getIdFromName(c[d]);u[c[d]]=d;var p=c[d].split("+");if(p.length>1)for(var m=0;m<p.length;m++)u[p[m]]=d;h.push(lc.getPlotColor(f))}this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[o])}.bind(this)).attr("fill",(function(t){return h[u[t.source]]})).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var g=lc.getPlotColor(this.id);this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[o])}.bind(this)).attr("fill",g).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}}},{key:"zoomed",value:function(){return function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom,n=this.state.yItem,r=$t.transform.rescaleX(this.xScale),i=$t.transform.rescaleY(this.yScale);this.xScaleTmp=r,this.yScaleTmp=i,this.xMinMax=r.domain(),this.yMinMax=i.domain(),this.xAxis.call(this.xLabel.scale(r)),this.yAxis.call(this.yLabel.scale(i)),this.points.attr("cx",(function(t){return r(t.z)})).attr("cy",(function(t){return i(t[n])})),this.spBrusher.call(this.brush.move,[r(this.selectedPeriod[0]),r(this.selectedPeriod[1])]);var a=se("circle.current."+this.divID);if(a._groups[0][0]){var o=a.attr("cx"),s=a.attr("cy");s<=0||e<=s?this.lineH.attr("transform","translate("+this.margin.left+","+s+")").style("visibility","hidden"):this.lineH.transition().duration(0).attr("transform","translate("+this.margin.left+","+s+")").style("visibility","visible"),o<=0||t<=o?this.lineV.attr("transform","translate("+o+","+this.margin.top+")").style("visibility","hidden"):this.lineV.transition().duration(0).attr("transform","translate("+o+","+this.margin.top+")").style("visibility","visible")}}}},{key:"brushed",value:function(){return function(){var t=($t.selection||this.xScaleTmp.range).map(this.xScaleTmp.invert,this.xScaleTmp);this.selectedPeriod=t}}},{key:"brushedEnd",value:function(){return function(){if("QBE"===Rh.getMode()&&Number(Rh.getSource())===this.id){var t=Rh.getSelectedPeriod();(Math.abs(t[0]-this.selectedPeriod[0])>1e-5||Math.abs(t[1]-this.selectedPeriod[1])>1e-5)&&(e=this.selectedPeriod,hu.dispatch({type:"SELECT_PERIOD_FROM_SP",period:e}),this.selectedPeriod[1]-this.selectedPeriod[0]>0?(this.highlightSelectedTimePeriod(),this.timeRange=[this.selectedPeriod[0]-10,this.selectedPeriod[1]+10],this.updateTimeRange()):(this.resetSelection(),this.timeRange=[this.data.data.meta.min.z,this.data.data.meta.max.z],this.updateTimeRange()))}var e}}},{key:"spMouseOver",value:function(){var t=this.tooltip,e=this.data,n=this.state.yItem;return function(r){se(this).attr("stroke-width",1).attr("stroke","black"),t.transition().duration(50).style("visibility","visible"),t.html("<i>"+e.data.lookup.z+"</i>: "+r.z+"<br/><i>"+e.data.lookup[n]+"</i>: "+r[n]).style("left",$t.pageX+20+"px").style("top",$t.pageY-30+"px")}}},{key:"spMouseOut",value:function(){var t=this.tooltip;return function(e){var n=se(this);n.style("fill")!==ke("red").toString()&&(n.attr("stroke-width",.5).attr("stroke","dimgray"),n.attr("class").indexOf("current")<0?n.attr("stroke-width",.5).attr("stroke","dimgray"):n.attr("stroke","orange").attr("stroke-width",1)),t.transition().duration(150).style("visibility","hidden")}}},{key:"spDblClick",value:function(){var t=this.id;return function(e){Ru(t,e.z)}}},{key:"resetScatterplots",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;switch(this.timeRange=[this.data.data.meta.min.z,this.data.data.meta.max.z],this.updateTimeRange(),this.zoom=cu().scaleExtent([.05,10]).extent([[0,0],[t,e]]).on("zoom",this.zoomed().bind(this)),this.selector){case"selectRegion":this.sp.call(this.zoom).call(this.zoom.transform,eu).on("dblclick.zoom",null).on("mousedown.zoom",null);break;case"move":this.sp.call(this.zoom).call(this.zoom.transform,eu).on("dblclick.zoom",null)}}},{key:"highlightCurrentPlot",value:function(t){var e=this.margin,n=this.divID,r=t+this.data.data.spatial[0].z,i=Us("svg."+n),a=this.state.yItem;function o(t){var r=se(this),i=(r.attr("class").split(" ")[1],se("svg."+n)),a=i.selectAll(".currentLineH"),o=i.selectAll(".currentLineV");a.transition().duration(0).style("visibility","visible").attr("transform","translate("+e.left+","+r.attr("cy")+")"),o.transition().duration(0).style("visibility","visible").attr("transform","translate("+r.attr("cx")+","+e.top+")")}i.each((function(t){var e=se(this),n=e.selectAll("circle"),i=e.attr("class").split(" ");n.attr("stroke-width",.5).attr("stroke","dimgray").attr("class",i[1]+" "+i[2]);var s=n.filter((function(t){return t.z===r&&a in t}));s._groups.length>0&&s.attr("stroke","orange").attr("stroke-width",1).attr("class",i[1]+" "+i[2]+" current").moveToFront().each(o)}))}},{key:"updateCurrentPos",value:function(t){var e=this.state.width-this.margin.left-this.margin.right,n=Na().domain([this.xMinMax[0],this.xMinMax[1]]).range([0,e]),r=t+this.data.data.spatial[0].z;this.lineH.style("visibility","hidden"),this.lineV.transition().duration(0).style("visibility","visible").attr("transform","translate("+n(r)+","+this.margin.top+")")}},{key:"changePlotColor",value:function(t){se("#"+this.divID).selectAll("circle").attr("fill",t)}},{key:"onSelectYItem",value:function(t){this.setState({yItemonPanel:t.target.value})}},{key:"onClickYAxisDone",value:function(t){this.setState({yItem:this.state.yItemonPanel}),this.computeRange(this.state.yItemonPanel),this.updateScatterplots(this.state.yItemonPanel),this.yAxisText.text(this.data.data.lookup[this.state.yItemonPanel]),se("#changeYAxisPanel_"+this.SPID).transition().duration(50).style("visibility","hidden")}},{key:"computeRange",value:function(t){this.slicedData=this.data.data.spatial.filter(function(t){return this.timeRange[0]<=t.z&&t.z<=this.timeRange[1]}.bind(this)),this.xMinMax=this.timeRange,this.yMinMax=p(this.slicedData,(function(e){return e[t]}))}},{key:"updateScatterplots",value:function(t){if(this.xScale.domain(this.xMinMax).nice(),this.yScale.domain(this.yMinMax).nice(),this.xMinMax=this.xScale.domain(),this.yMinMax=this.yScale.domain(),this.points.remove(),this.data.data.merge){for(var e={},n=this.data.name.split(","),r=[],i=0;i<n.length;i++){var a=Ju.getIdFromName(n[i]);e[n[i]]=i;var o=n[i].split("+");if(o.length>1)for(var s=0;s<o.length;s++)e[o[s]]=i;r.push(lc.getPlotColor(a))}this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(e){return this.yScale(e[t])}.bind(this)).select((function(e){return z in e&&t in e?this:null})).attr("fill",(function(t){return r[e[t.source]]})).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}else{var l=lc.getPlotColor(this.id);this.points=this.point_g.selectAll("circle").data(this.slicedData).enter().append("circle").attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(e){return this.yScale(e[t])}.bind(this)).select((function(e){return"z"in e&&t in e?this:null})).attr("fill",l).attr("opacity",.7).attr("stroke-width",.5).attr("stroke","dimgray").attr("r",4).attr("class",this.divID+" scatterplots"+this.id).on("mouseover",this.spMouseOver()).on("mouseout",this.spMouseOut()).on("dblclick",this.spDblClick())}this.xAxis.call(this.xLabel.scale(this.xScale)),this.yAxis.call(this.yLabel.scale(this.yScale))}},{key:"highlightSelectedTimePeriod",value:function(){var t=this.selectedPeriod;this.points.attr("stroke","dimgray").attr("stroke-width",.5),this.points.select((function(e){return t[0]<=e.z&&e.z<=t[1]?this:null})).attr("stroke","#d23430").attr("stroke-width",1)}},{key:"updateTimeRange",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;this.computeRange(this.state.yItem),this.xScale.domain(this.xMinMax).nice(),this.xScaleTmp=this.xScale,this.xMinMax=this.xScale.domain(),this.xLabel=V(this.xScale).ticks(10).tickSize(-e).tickFormat(wd),this.xAxis.transition().duration(500).call(this.xLabel.scale(this.xScale)),this.yScale.domain(this.yMinMax).nice(),this.yScaleTmp=this.yScale,this.yMinMax=this.yScale.domain(),this.yLabel=j(this.yScale).ticks(5).tickSize(-t).tickFormat(wd),this.yAxis.transition().duration(500).call(this.yLabel.scale(this.yScale)),this.points.attr("cx",function(t){return this.xScale(t.z)}.bind(this)).attr("cy",function(t){return this.yScale(t[this.state.yItem])}.bind(this)),this.spBrusher.call(this.brush.move,[this.xScale(this.selectedPeriod[0]),this.xScale(this.selectedPeriod[1])])}},{key:"resetSelection",value:function(){this.selectedPeriod=[-1,-1],this.points.attr("stroke","dimgray").attr("stroke-width",.5)}},{key:"switchMouseInteraction",value:function(){var t=this.state.width-this.margin.left-this.margin.right,e=this.state.height-this.margin.top-this.margin.bottom;switch(this.zoom=cu().scaleExtent([.05,10]).extent([[0,0],[t,e]]).on("zoom",this.zoomed().bind(this)),this.selector){case"selectRegion":this.sp.call(this.zoom).on("dblclick.zoom",null).on("mousedown.zoom",null),this.spBrusher.attr("class","brush").call(this.brush);break;case"move":this.sp.call(this.zoom).on("dblclick.zoom",null),this.spBrusher.on(".brush",null)}}},{key:"render",value:function(){"feature"===Su.getMenu()&&Us("svg#"+this.SPID).size()>0&&this.drawScatterplots();var t=[],e=this.data.data.lookup;for(var n in e){var r="";(r=e[n].length>1?e[n].join(","):e[n]).indexOf("JD")<0?t.push(i.a.createElement("div",{className:"form-check",key:r},i.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:r},r))):t.unshift(i.a.createElement("div",{className:"form-check",key:r},i.a.createElement("input",{type:"radio",name:"selectYAxisForm_"+this.SPID,value:n,checked:this.state.yItemonPanel===n,onChange:this.onSelectYItem.bind(this)}),i.a.createElement("label",{className:"form-check-label",htmlFor:"inlineCheckbox1",key:r},r)))}return i.a.createElement("div",{id:"scatterplotsSelectors_"+this.SPID},i.a.createElement("div",{className:"overlayPanel",id:"changeYAxisPanel_"+this.SPID,style:{visibility:"hidden",textAlign:"center"}},i.a.createElement("h6",null,"Change y axis"),i.a.createElement("div",{id:"changeYAxisItem_"+this.SPID,style:{float:"left",textAlign:"left"}},i.a.createElement("form",{id:"selectYAxisForm_"+this.SPID},t)),i.a.createElement("button",{className:"btn btn-primary btn-sm",id:"changeYAxisBtn_"+this.SPID,onClick:this.onClickYAxisDone.bind(this)},"Done")))}}])&&Lx(e.prototype,n),r&&Lx(e,r),o}(i.a.Component);function Vx(t){return(Vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hx(t,e){return(Hx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ux(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=qx(t);if(e){var i=qx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gx(this,n)}}function Gx(t,e){return!e||"object"!==Vx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qx(t){return(qx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hx(t,e)}(o,t);var e,n,r,a=Ux(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={data:Ju.getAllData(),source:Rh.getSource()},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=window.innerHeight-$("#appHeader").outerHeight(!0);$("#QBESource").height(e),Ju.on("upload",(function(){t.setState({data:Ju.getAllData()})})),Ju.on("updateDetail",(function(e,n){if(Number(t.state.source)===e){var r=document.getElementById("currentJDValue");r&&(r.innerText=(n+t.state.data[e].data.meta.min.z).toFixed(3))}})),Rh.on("updateSource",(function(){t.setState({source:Rh.getSource()})})),Rh.on("recoverQuery",(function(e){"QBE"===Rh.getMode()&&t.setState({source:Rh.getSource()})}))}},{key:"render",value:function(){var t=this,e=400;if(null!==document.getElementById("featureArea")){var n=$("#featureArea").outerWidth(!0)-2*Number($("#featureArea").css("padding-left").replace("px",""));n>0&&(e=n)}var r=this.state.data.map((function(n){return i.a.createElement("div",{key:n.id,id:"QBE_SP_"+n.id,style:{display:n.id===Number(t.state.source)?"block":"none"}},i.a.createElement(Bx,{key:n.id,id:n.id,divID:"QBE_SP_"+n.id,xItem:"z",yItem:"V",width:e,height:Math.ceil(.8*e)}))}));return i.a.createElement("div",{id:"QBESource",className:"controllersElem",style:{float:"left",width:"30%",position:"relative"}},i.a.createElement("div",{id:"QBESourceMain",style:{display:"block"}},this.QBESelector(),i.a.createElement("div",{id:"QBESourceTT",className:"featureElem"},this.selectorOptionsTT(),i.a.createElement("canvas",{id:"QBESourceTTCanvas",width:"1000",height:"1000",style:{width:e,height:e}})),i.a.createElement("div",{id:"QBESourceSP",className:"featureElem"},this.selectorOptionsSP(),r)),i.a.createElement("button",{id:"collapseSourcePanel",className:"btn btn-primary btn-sm",style:{width:"4rem",height:"1.5rem",position:"absolute",top:"0px",right:"-4rem"},onClick:this.clickCloseSourcePanelBtn},"Close"))}},{key:"clickCloseSourcePanelBtn",value:function(){bh(),fu()}},{key:"QBESelector",value:function(){return i.a.createElement("div",{className:"featureElem"},i.a.createElement("div",{id:"selectTimeInterval",className:"form-row featureRow"},i.a.createElement("span",{style:{marginRight:"0.3rem"}},"Select"),i.a.createElement("input",{type:"text",className:"form-control custom-input",id:"selectTimeIntervalInput",style:{width:"5rem"}}),i.a.createElement("span",{style:{marginLeft:"0.3rem"}},"days from JD="),i.a.createElement("span",{id:"currentJDValue"}),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"selectTimeIntervalBtn",style:{display:"block",margin:"0 0 0 auto"},onClick:this.selectTimeInterval.bind(this)},"Select")),i.a.createElement("button",{id:"resetSelectionBtn",className:"btn btn-primary btn-sm featureRow",style:{display:"block",margin:"0 0 0 auto"},onClick:this.resetSelection.bind(this)},"Deselect all"))}},{key:"selectorOptionsTT",value:function(){return i.a.createElement("div",{id:"selectorForQBETT"},i.a.createElement("h5",null,"Selection options for TimeTubes"),i.a.createElement("form",{className:"form-check form-check-inline selector featureRow",id:"QBESelectorTT"},i.a.createElement("img",{id:"QBESelectTT",className:"selectorIcon selected",name:"QBESelectorTT",value:"Select",src:"img/icons/pen.png",alt:"pen",width:"30",height:"30",title:"select a part of the tube",onClick:this.selectSelect.bind(this),readOnly:!0}),i.a.createElement("img",{id:"QBEDeselectTT",className:"selectorIcon",name:"QBESelectorTT",value:"Deselect",src:"img/icons/eraser.png",alt:"eraser",width:"30",height:"30",title:"deselect a part of the tube",onClick:this.selectDeselect.bind(this),readOnly:!0})))}},{key:"selectorOptionsSP",value:function(){return i.a.createElement("div",{id:"selectorForQBESP"},i.a.createElement("h5",null,"Selection options for scatterplots"),i.a.createElement("form",{className:"form-check form-check-inline selector featureRow",id:"QBESelectorSP"},i.a.createElement("img",{id:"QBESelectRegionSP",className:"selectorIcon selected",name:"QBESelectorSP",value:"SelectRegion",src:"img/icons/selectRegion.png",alt:"select region",width:"30",height:"30",title:"select a part of the scatterplot",onClick:this.selectSelectRegion.bind(this),readOnly:!0}),i.a.createElement("img",{id:"QBEMoveSP",className:"selectorIcon",name:"QBESelectorSP",value:"Move",src:"img/icons/move.png",alt:"move",width:"30",height:"30",title:"move the scatteplot",onClick:this.selectMove.bind(this),readOnly:!0}),i.a.createElement("img",{id:"QBEResetSP",className:"selectorIcon",name:"QBESelectorSP",value:"Reset",src:"img/icons/reset.png",alt:"reset",width:"30",height:"30",title:"reset changes on the scatterplot",onClick:this.selectReset.bind(this),readOnly:!0})))}},{key:"selectTimeInterval",value:function(){var t=$("#selectTimeIntervalInput").val();isNaN(t)||""==t||Qc(t)}},{key:"resetSelection",value:function(){Yc()}},{key:"selectSelect",value:function(){$("img[name=QBESelectorTT]").each((function(){$(this).removeClass("selected")})),$("#QBESelectTT").addClass("selected"),$c(!0)}},{key:"selectDeselect",value:function(){$("img[name=QBESelectorTT]").each((function(){$(this).removeClass("selected")})),$("#QBEDeselectTT").addClass("selected"),$c(!1)}},{key:"selectSelectRegion",value:function(){$("img[name=QBESelectorSP]").each((function(){$(this).removeClass("selected")})),$("#QBESelectRegionSP").addClass("selected"),nh("selectRegion")}},{key:"selectMove",value:function(){$("img[name=QBESelectorSP]").each((function(){$(this).removeClass("selected")})),$("#QBEMoveSP").addClass("selected"),nh("move")}},{key:"selectReset",value:function(){nh("reset")}}])&&jx(e.prototype,n),r&&jx(e,r),o}(i.a.Component);function $x(t){return($x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qx(t,e){return(Qx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Jx(t);if(e){var i=Jx(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zx(this,n)}}function Zx(t,e){return!e||"object"!==$x(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jx(t){return(Jx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var Kx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qx(t,e)}(o,t);var e,n,r,a=Xx(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:20,right:20},t.datasets=[],t.custerCenters=[],t.subsequences=[],t.labels=[],t.dataIdxInCluster=[],t.clusterColors=[],t.timelines=[],t.xScales=[],t.xLabels=[],t.xAxes=[],t}return e=o,(n=[{key:"render",value:function(){var t=this;return i.a.createElement("div",{id:"clusteringTimeline",className:"resultAreaElem",ref:function(e){t.mount=e}})}},{key:"componentDidMount",value:function(){var t=this;zc.on("showClusteringResults",(function(){t.datasets=zc.getDatasets(),t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.labels=zc.getLabels(),t.clusterColors=zc.getClusterColors(),t.divideDataIntoCluster(),t.drawTimelines()})),zc.on("updateClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.labels=zc.getLabels(),t.divideDataIntoCluster(),t.drawTimelines()})),zc.on("resetClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.labels=zc.getLabels(),t.divideDataIntoCluster(),t.drawTimelines()})),zc.on("recoverClusteringSession",(function(){t.datasets=zc.getDatasets(),t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.labels=zc.getLabels(),t.clusterColors=zc.getClusterColors(),t.divideDataIntoCluster(),t.drawTimelines()})),Su.on("resizeExtractionResultsArea",(function(){$("#clusteringResults").length&&t.resizeTimelines()}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringTimeline");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"divideDataIntoCluster",value:function(){this.dataIdxInCluster=[];for(var t=0;t<this.clusterCenters.length;t++)this.dataIdxInCluster.push([]);for(var e=0;e<this.labels.length;e++)"object"===$x(this.labels[e])?this.dataIdxInCluster[this.labels[e].cluster].push(e):this.dataIdxInCluster[this.labels[e]].push(e)}},{key:"drawTimelines",value:function(){var t=this;$("#clusteringTimelineArea").remove(),this.timelines=[],this.xScales=[],this.xLabels=[],this.xAxes=[];for(var e=$("#clusteringResultsOverview").width()-(this.margin.left+this.margin.right),n=e-(this.margin.left+this.margin.right),r=n-100,i=se("#clusteringTimeline").append("div").attr("id","clusteringTimelineArea"),a=function(n){var a=Ju.getData(t.datasets[n]),o=i.append("svg").attr("id","clusteringTimelineSVG_"+t.datasets[n]).attr("class","clusteringTimelineSVG").attr("width",e).attr("height",40),s=[];if(a.name.length>20)for(var l=0;20*l<a.name.length;)s.push(a.name.slice(20*l,Math.min(20*l+20+1,a.name.length))),l++;else s.push(a.name);o.selectAll("text.clusteringTimelineFileName").data(s).enter().append("text").attr("x",0).attr("y",(function(t,e){return 40*e/s.length+20/s.length})).attr("width",100).attr("id","clusteringTimeline_"+t.datasets[n]).attr("class","clusteringTimelineFileName").attr("text-anchor","left").style("font-size","10px").text((function(t){return t})).on("click",function(t,e,n){var r=Number(n[0].id.split("_")[1]);if(40===Number(this.timelines[r].attr("height"))){this.timelines[r].transition().duration(1e3).attr("height",40*this.clusterCenters.length);for(var i=0;i<this.clusterCenters.length;i++)0!==i&&this.timelines[r].append("g").attr("class","x-axis clusteringTimelineXAxis_"+r).attr("id","clusteringTimelineXAxis_"+r+"_"+i).attr("transform","translate("+(this.margin.left+100)+",15)").transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+","+(40*i+20-5)+")").call(this.xLabels[r]),this.timelines[r].selectAll("rect.clusterLine_"+r+"_"+i).transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+","+40*i+")")}else this.timelines[r].selectAll("rect.clusterLine_"+r).transition().duration(1e3).attr("transform","translate("+(this.margin.left+100)+",0)"),Us(".clusteringTimelineXAxis_"+r).transition().duration(1e3).attr("translate("+ +(this.margin.left+100)+",15)"),Us(".clusteringTimelineXAxis_"+r).transition().delay(1e3).remove(),this.timelines[r].transition().duration(1e3).attr("height",40);setTimeout((function(){fu()}),1e3)}.bind(t));var u=Na().domain([a.data.meta.min.z,a.data.meta.max.z]).nice().range([0,r]),c=V(u).ticks(10).tickSize(10),h=o.append("g").attr("class","x-axis").attr("id","clusteringTimelineXAxis_"+t.datasets[n]).attr("transform","translate("+(t.margin.left+100)+",15)").call(c);t.timelines.push(o),t.xScales.push(u),t.xLabels.push(c),t.xAxes.push(h)},o=0;o<this.datasets.length;o++)a(o);for(var s=0;s<this.dataIdxInCluster.length;s++)for(var l=function(e){t.timelines[e].selectAll("line.clusterLine_"+t.datasets[e]+"_"+s).data(t.dataIdxInCluster[s].filter(function(t){return Number(this.subsequences[t].id)===this.datasets[e]}.bind(t))).enter().append("rect").attr("class","clusterLine_"+t.datasets[e]+" clusterLine_"+t.datasets[e]+"_"+s).attr("id",function(t){return"clusterLine_"+this.datasets[e]+"_"+this.subsequences[t].idx}.bind(t)).attr("x",function(t){return this.xScales[e](this.subsequences[t][0].z)}.bind(t)).attr("y",5).attr("width",function(t){return this.xScales[e](this.subsequences[t][this.subsequences[t].length-1].z)-this.xScales[e](this.subsequences[t][0].z)}.bind(t)).attr("height",20).attr("fill",Be(t.clusterColors[s][0],t.clusterColors[s][1],t.clusterColors[s][2])).attr("opacity",.5).attr("transform","translate("+(t.margin.left+100)+",0)").on("mouseover",t.onMouseOverClusterLine().bind(t)).on("mouseout",t.onMouseOutClusterLine().bind(t)).on("click",t.onClickClusterLine().bind(t)).on("dblclick",t.onDoubleClickClusterLine().bind(t))},u=0;u<this.datasets.length;u++)l(u)}},{key:"onMouseOverClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){var n,r=$("#tooltipClusteringResults"),i=$("#tooltipClusteringResultsTable"),a=e.split("_"),o=Number(a[1]),s=Number(a[2]),l=0;for(l=0;l<this.subsequences.length;l++)if(this.subsequences[l].id===o&&this.subsequences[l].idx===s){n=this.subsequences[l];break}var u,c,h=Ju.getFileName(o),d=[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z],f=n.dataPoints.length,p=window.pageYOffset,m=$("#clusteringResults").offset();p<m.top?(u=$t.clientX-m.left+5,c=$t.clientY-(m.top-p)+5):(u=$t.clientX-m.left+5,c=$t.clientY+5),i.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+h+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(d[0])+"-"+Sd(d[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+f+"</td></tr></tbody></table>"),r.css({left:u+"px",top:c+"px",right:"unset",bottom:"unset"}),r.css("display","block");var g=[void 0,void 0];l-1>=0&&this.subsequences[l-1].id===this.subsequences[l].id&&(g[0]="object"===$x(this.labels[l-1])?this.labels[l-1].cluster:this.labels[l-1]),l+1<this.labels.length&&this.subsequences[l].id===this.subsequences[l+1].id&&(g[1]="object"===$x(this.labels[l+1])?this.labels[l+1].cluster:this.labels[l+1]),Eh(o,s,d,g),jb(Number(o),d)}}}},{key:"onMouseOutClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]);$("#tooltipClusteringResults").css("display","none"),Mh(r,i)}}}},{key:"onClickClusterLine",value:function(){return function(t){if($t.target){var e=$t.target.classList[1].split("_");Fb(Number(e[2]))}}}},{key:"onDoubleClickClusterLine",value:function(){return function(t){var e=$t.target.id;if(e){for(var n,r=e.split("_"),i=Number(r[1]),a=Number(r[2]),o=0;o<this.subsequences.length;o++)if(this.subsequences[o].id===i&&this.subsequences[o].idx===a){n=this.subsequences[o];break}$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(i,[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"resizeTimelines",value:function(){for(var t=this,e=$("#clusteringResultsOverview").width()-(this.margin.left+this.margin.right),n=e-(this.margin.left+this.margin.right)-100,r=function(r){t.timelines[r].attr("width",e),t.xScales[r].range([0,n]),t.xLabels[r]=V(t.xScales[r]).ticks(10).tickSize(10),t.xAxes[r].call(t.xLabels[r]),Us(".x-axis.clusteringTimelineXAxis_"+t.datasets[r]).call(t.xLabels[r]);for(var i=0;i<t.dataIdxInCluster.length;i++)Us("rect.clusterLine_"+t.datasets[r]+"_"+i).attr("x",function(t){return this.xScales[r](this.subsequences[t][0].z)}.bind(t)).attr("width",function(t){return this.xScales[r](this.subsequences[t][this.subsequences[t].length-1].z)-this.xScales[r](this.subsequences[t][0].z)}.bind(t))},i=0;i<this.datasets.length;i++)r(i)}}])&&Yx(e.prototype,n),r&&Yx(e,r),o}(i.a.Component),t_=n(145),e_=n.n(t_);function n_(t){return(n_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i_(t,e){return(i_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s_(t);if(e){var i=s_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o_(this,n)}}function o_(t,e){return!e||"object"!==n_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s_(t){return(s_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))},oe.prototype.moveToBack=function(){return this.each((function(){var t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)}))};var l_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i_(t,e)}(o,t);var e,n,r,a=a_(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).tubes=[],t.axes=[],t.labels=[],t.tubeNum=16,t.segment=16,t.division=5,t.cameraPosZ=50,t.minGridSize=3,t.tubeGroups=[],t.splines=[],t.opacityCurve=lc.getOpacityCurve("Default"),t.vertex=document.getElementById("vertexShader_tube").textContent,t.fragment=document.getElementById("fragmentShader_tube").textContent,t.raycaster=new ju.Raycaster,t.clusterCenters=[],t.clusterColors=[],t.tubeCoords=[],t.gridSize=void 0,t.selectedCluster=void 0,t.clusterRadiuses=void 0,t.update2DGraphsFlag=!1,t.queryMode=Rh.getMode(),t.clickedX,t.clickedY,t.chartsSize={MDS:{width:.75,height:1},barChart:{width:.25,height:1},elbowLineChart:{width:0,height:0},featureHeatmap:{width:0,height:0}},t.state={clusteringScores:{}},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=$("#clusteringResultsOverview").width(),n=$("#appHeader").outerHeight(!0),r=$("#clusteringResultsOverview").height()-n;this.scene=new ju.Scene,this.setCameras(e,r),this.renderer=new ju.WebGLRenderer,this.renderer.setClearColor(new ju.Color(Number(lc.getBackgroundColor()))),this.renderer.setSize(e,r),this.renderer.localClippingEnabled=!0,this.renderer.domElement.id="clusteringResultsViewport",this.canvas=document.getElementById("clusteringOverviewTimeTubesCanvas"),this.renderScene(),this.start();var i=new ju.DirectionalLight(16777215,.7);i.position.set(-20,40,60),this.scene.add(i);var a=new ju.AmbientLight(2697513);this.scene.add(a),this.addControls();var o=this.onMouseClick();this.canvas.addEventListener("click",o.bind(this),!1),Su.on("selectMenu",(function(e){"feature"===e&&$("#clusteringResults").length&&(t.setRendererSize(),t.setMDSScatterplotsSize())})),Su.on("resizeExtractionResultsArea",(function(){$("#clusteringResults").length&&(t.setRendererSize(),t.setMDSScatterplotsSize())})),zc.on("showClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.SSLabels=zc.getLabels(),t.clusterColors=zc.getClusterColors(),t.selectedCluster=void 0,t.update2DGraphsFlag=!0;var e=zc.getClusteringScores();t.setState({clusteringScores:e})})),zc.on("showClusterDetails",(function(e){t.selectedCluster=e,t.setCameraDetail(),t.setDetailView(e)})),zc.on("updateClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.SSLabels=zc.getLabels(),t.selectedCluster=void 0,t.update2DGraphsFlag=!0;var e=zc.getClusteringScores();t.setState({clusteringScores:e})})),zc.on("resetClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.SSLabels=zc.getLabels(),t.selectedCluster=void 0,t.update2DGraphsFlag=!0;var e=zc.getClusteringScores();t.setState({clusteringScores:e})})),zc.on("recoverClusteringSession",(function(){t.clusterCenters=zc.getClusterCenters(),t.subsequences=zc.getSubsequences(),t.SSLabels=zc.getLabels(),t.clusterColors=zc.getClusterColors(),t.selectedCluster=void 0,t.update2DGraphsFlag=!0;var e=zc.getClusteringScores();t.setState({clusteringScores:e})}))}},{key:"componentDidUpdate",value:function(){if(this.update2DGraphsFlag){var t=zc.getClusteringScores();this.setRendererSize(),this.computeSplines(),this.computeTubePositions(),this.drawClusterCentersAsTubes(),this.drawClusterRadiusesAsRings(t.clusterRadiuses),this.showClusteringParameters(),this.resetDetailView(),this.drawMDSScatterplots(),this.drawClustersSummaryStuckedBarChart(),this.drawSilhouetteBarChart(),this.drawElbowMethodLineChart(),this.drawFeatureHeatmap(),this.update2DGraphsFlag=!1}}},{key:"render",value:function(){var t,e=this,n=$("#clusteringResultsOverview").width(),r=$("#appHeader").outerHeight(!0),a=$("#clusteringTimeline").outerHeight(!0),o=window.innerHeight-r-a,s=[];if(this.state.clusteringScores.clusterRadiuses)for(var l=0;l<this.state.clusteringScores.clusterRadiuses.length;l++)s.push(i.a.createElement("tr",{key:l},i.a.createElement("td",null,"Cluster ",l),i.a.createElement("td",null,Sd(this.state.clusteringScores.clusterRadiuses[l]))));var u=zc.getClusteringParameters(),c=zc.getSubsequenceParameters();return Object.keys(u).length>0&&(c.normalize&&!Array.isArray(u.elbow)?(t=i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-9",id:"clusteringOverviewMDSScatterplots"}),i.a.createElement("div",{className:"col-3",id:"silhouetteBarChart"}))),this.chartsSize={MDS:{width:.75,height:1},barChart:{width:.25,height:1},elbowLineChart:{width:0,height:0},featureHeatmap:{width:0,height:0}}):c.normalize||Array.isArray(u.elbow)?c.normalize&&Array.isArray(u.elbow)?(t=i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-9",id:"clusteringOverviewMDSScatterplots"}),i.a.createElement("div",{className:"col-3"},i.a.createElement("div",{id:"silhouetteBarChart"}),i.a.createElement("div",{id:"elbowMethodLineChart"})))),this.chartsSize={MDS:{width:.75,height:1},barChart:{width:.25,height:.75},elbowLineChart:{width:.25,height:.25},featureHeatmap:{width:0,height:0}}):!c.normalize&&Array.isArray(u.elbow)&&(t=i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-9",id:"clusteringOverviewMDSScatterplots"}),i.a.createElement("div",{className:"col",id:"silhouetteBarChart"})),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6",id:"clusterFeatureHeatmap"}),i.a.createElement("div",{className:"col-6",id:"elbowMethodLineChart"}))),this.chartsSize={MDS:{width:.75,height:.75},barChart:{width:.25,height:.75},elbowLineChart:{width:.5,height:.25},featureHeatmap:{width:.5,height:.25}}):(t=i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-9",id:"clusteringOverviewMDSScatterplots"}),i.a.createElement("div",{className:"col-3"},i.a.createElement("div",{id:"silhouetteBarChart"}),i.a.createElement("div",{id:"clusterFeatureHeatmap"})))),this.chartsSize={MDS:{width:.75,height:1},barChart:{width:.25,height:.75},elbowLineChart:{width:0,height:0},featureHeatmap:{width:.25,height:.25}})),i.a.createElement("div",{id:"clusteringOverview",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)},ref:function(t){e.mount=t}},i.a.createElement("div",{id:"clusteringOverviewCarousel",className:"carousel slide","data-ride":"carousel","data-interval":"false","data-pause":"hover"},i.a.createElement("div",{className:"carousel-inner"},i.a.createElement("div",{id:"clusteringOverviewTimeTubes",className:"carousel-item active",style:{height:o+"px"}},i.a.createElement("canvas",{id:"clusteringOverviewTimeTubesCanvas",width:"2000",height:"2000",style:{width:n+"px",height:o+"px",position:"absolute"}}),i.a.createElement("div",{id:"clusteringParameters"},i.a.createElement("details",null,i.a.createElement("summary",null,"Clustering parameters"),i.a.createElement("table",{id:"clusteringParametersTable"},i.a.createElement("tbody",null,i.a.createElement("tr",{key:"clusteringMethod"},i.a.createElement("td",null,"Method"),i.a.createElement("td",{id:"clusteringTableMethod",className:"parametersValues"})),i.a.createElement("tr",{key:"clusterNumber"},i.a.createElement("td",null,"Cluster number"),i.a.createElement("td",{id:"clusteringTableClusterNumber",className:"parametersValues"})),i.a.createElement("tr",{key:"clusteringVariables"},i.a.createElement("td",null,"Variables"),i.a.createElement("td",{id:"clusteringTableVariables",className:"parametersValues"})),i.a.createElement("tr",{key:"distanceMetric"},i.a.createElement("td",null,"Distance metric"),i.a.createElement("td",{id:"clusteringTableDistanceMetric",className:"parametersValues"})),i.a.createElement("tr",null,i.a.createElement("td",null,"Subsequence period"),i.a.createElement("td",{id:"subsequenceTablePeriod",className:"parametersValues"})),i.a.createElement("tr",null,i.a.createElement("td",null,"Normalization"),i.a.createElement("td",{id:"subsequenceTableNormalization",className:"parametersValues"})))))),i.a.createElement("div",{id:"clusteringOverviewRightTables"},i.a.createElement("div",{id:"clusteringScores"},i.a.createElement("details",null,i.a.createElement("summary",null,"Performance evaluation"),i.a.createElement("table",{id:"clusteringScoresTable"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Pseudo F"),i.a.createElement("td",{id:"pseudoFValue",className:"clusteringScoresValues"},void 0!==this.state.clusteringScores.pseudoF?Sd(this.state.clusteringScores.pseudoF):"")),i.a.createElement("tr",null,i.a.createElement("td",null,"Silhouette coefficient"),i.a.createElement("td",{id:"silhouetteValue",className:"clusteringScoresValues"},void 0!==this.state.clusteringScores.silhouette?Sd(this.state.clusteringScores.silhouette):"")),i.a.createElement("tr",null,i.a.createElement("td",null,"Davis Bouldin index"),i.a.createElement("td",{id:"davisBouldinValue",className:"clusteringScoresValues"},void 0!==this.state.clusteringScores.davisBouldin?Sd(this.state.clusteringScores.davisBouldin):"")))))),i.a.createElement("div",{id:"clusterRadiuses"},i.a.createElement("details",null,i.a.createElement("summary",null,"Cluster radiuses"),i.a.createElement("table",{id:"clusterRadiusesTable"},i.a.createElement("tbody",null,s)))))),i.a.createElement("div",{id:"clusteringOverview2DCharts",className:"carousel-item resultAreaElemNoPadding"},t)),i.a.createElement("a",{className:"carousel-control-prev",id:"carouselControlPrevClusteringOverview",href:"#clusteringOverviewCarousel",role:"button","data-slide":"prev",style:{top:o/2-25}},i.a.createElement("span",{className:"carousel-control-prev-icon","aria-hidden":"true"})),i.a.createElement("a",{className:"carousel-control-next",id:"carouselControlNextClusteringOverview",href:"#clusteringOverviewCarousel",role:"button","data-slide":"next",style:{top:o/2-25}},i.a.createElement("span",{className:"carousel-control-next-icon","aria-hidden":"true"}))))}},{key:"showClusteringParameters",value:function(){var t=zc.getClusteringParameters();if(Object.keys(t).length>0){$("#clusteringTableMethod").text(t.method),$("#clusteringTableClusterNumber").text(t.clusterNum);for(var e="",n=0;n<t.variables.length;n++)e+=$('label[for="clusteringVaribales_'+t.variables[n]+'"]').text()+", ";e=e.slice(0,-2),$("#clusteringTableVariables").text(e),$("#clusteringTableDistanceMetric").text(t.distanceMetric)}var r=zc.getSubsequenceParameters();Object.keys(r).length>0&&($("#subsequenceTablePeriod").text(r.SSperiod[0]+"-"+r.SSperiod[1]+" days"),$("#subsequenceTableNormalization").text(r.normalize))}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"animate",value:function(){this.renderScene(),this.frameId=window.requestAnimationFrame(this.animate.bind(this))}},{key:"renderScene",value:function(){this.renderClusteringOverviewRenderer(),void 0!==this.selectedCluster&&this.renderClusteringDetailRenderer()}},{key:"renderClusteringOverviewRenderer",value:function(){var t=document.getElementById("clusteringOverviewTimeTubesCanvas");if(t){var e=this.renderer.domElement.width,n=this.renderer.domElement.height,r=t.getContext("2d");this.renderer.render(this.scene,this.camera),r.drawImage(this.renderer.domElement,0,0,e,n,0,0,t.width,t.height)}}},{key:"renderClusteringDetailRenderer",value:function(){var t=document.getElementById("selectedClusterCenterTimeTubesCanvas");if(t){var e=this.renderer.domElement.width,n=this.renderer.domElement.height,r=t.getContext("2d");this.renderer.render(this.scene,this.cameraDetail),r.drawImage(this.renderer.domElement,0,0,e,n,0,0,t.width,t.height)}}},{key:"setRendererSize",value:function(){var t=$("#clusteringResultsOverview").width(),e=$("#appHeader").outerHeight(!0),n=$("#clusteringTimeline").outerHeight(!0),r=window.innerHeight-e-n,i=document.getElementById("clusteringOverviewTimeTubesCanvas");i.style.width=t+"px",i.style.height=r+"px",this.renderer.setSize(t,r);var a=t/r,o=2*Math.tan(22.5*Math.PI/180),s=o*this.cameraPosZ,l=o*this.cameraPosZ*a;this.camera=new ju.OrthographicCamera(-l/2,l/2,s/2,-s/2,.1,1e3),this.camera.position.z=this.cameraPosZ,this.camera.lookAt(this.scene.position),this.renderer.render(this.scene,this.camera),this.addControls()}},{key:"setDetailView",value:function(t){if(void 0!==t&&$("#selectedClusterCenterTimeTubes").length){var e=$("#selectedClusterCenterTimeTubes").width()-32;$("#selectedClusterCenterTimeTubesCanvas").width(e),$("#selectedClusterCenterTimeTubesCanvas").height(e);var n=this.tubeCoords[t].x,r=this.tubeCoords[t].y;this.cameraDetail.position.x=n,this.cameraDetail.position.y=r,this.cameraDetail.lookAt(n,r,0),document.getElementById("selectedClusterCenterTimeTubesCanvas").addEventListener("mousedown",this.onMouseDownClusterCenterTimeTubesRenderer().bind(this),!1)}}},{key:"onMouseDownClusterCenterTimeTubesRenderer",value:function(){return function(t){if(this.queryMode=Rh.getMode(),"QBE"===this.queryMode||"QBS"===this.queryMode){var e=t.target;e.classList.add("drag"),this.clickedX=t.pageX-e.offsetLeft,this.clickedY=t.pageY-e.offsetTop,document.body.addEventListener("mousemove",this.onMouseMoveClusterCenterTimeTubesRenderer().bind(this),!1),e.addEventListener("mouseup",this.onMouseUpClusterCenterTimeTubesRenderer().bind(this),!1)}}}},{key:"onMouseMoveClusterCenterTimeTubesRenderer",value:function(){return function(t){var e=document.getElementsByClassName("drag")[0];if(e)switch(e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX-e.clientWidth/2-$("#extractionMenu").width()+"px",this.queryMode){case"QBE":var n=$("#selectedTimeSliceView"),r=n.offset(),i=n.width(),a=n.height();if(r.left<=t.pageX&&t.pageX<=r.left+i&&r.top<=t.pageY&&t.pageY<=r.top+a){var o=$("#selectedTimeSliceView > .overlayHidingPanel");o.css("display","block"),o.css("width",Math.min(i,a)),o.css("height",Math.min(i,a))}break;case"QBS":var s=$("#QBSSketchPad"),l=s.offset(),u=s.width(),c=s.innerHeight();if(l.left<=t.pageX&&t.pageX<=l.left+u&&l.top<=t.pageY&&t.pageY<=l.top+c){var h=$("#QBSCanvasArea > .overlayHidingPanel");h.css("display","block"),h.css("width",Math.min(u,c)),h.css("height",Math.min(u,c))}}}}},{key:"onMouseUpClusterCenterTimeTubesRenderer",value:function(){return function(t){document.body.removeEventListener("mousemove",this.onMouseMoveClusterCenterTimeTubesRenderer().bind(this),!1);var e=document.getElementsByClassName("drag")[0];e&&(e.removeEventListener("mouseup",this.onMouseUpClusterCenterTimeTubesRenderer.bind(this),!1),e.classList.remove("drag"),e.style.position="static");var n=zc.getSelectedCluster(),r=zc.getClusteringParameters(),i=zc.getSubsequenceParameters();switch(this.queryMode){case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var a=$("#selectedTimeSliceView"),o=a.offset(),s=a.width(),l=a.height();if(o&&o.left<=t.pageX&&t.pageX<=o.left+s&&o.top<=t.pageY&&t.pageY<=o.top+l){for(var u={},c=0;c<r.variables.length;c++)u[r.variables[c]]=[];for(var h=0;h<r.variables.length;h++)for(var d=0;d<this.clusterCenters[n].length;d++)u[r.variables[h]].push(this.clusterCenters[n][d][r.variables[h]]);u.arrayLength=this.clusterCenters[n].length;var f={parameters:r,values:u};if(i.normalize){$("#NormalizeSwitch").prop("checked",!0);for(var p=document.getElementById("normalizationOptions"),m=0;m<p.options.length;m++)if("zScore"===p.options[m].value){p.selectedIndex=m;break}$("#NormalizeSwitch").prop("disabled",!0),$("#normalizationOptions").prop("disabled",!0)}switch(r.distanceMetric){case"DTWD":sh("DTWD");break;case"DTWI":case"DTW":sh("DTWI")}$("#warpingWindowSize").val(r.window),Jc(r.variables),oh(f)}break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var g=$("#QBSSketchPad"),v=g.offset(),y=g.width(),b=g.innerHeight();if(v&&v.left<=t.pageX&&t.pageX<=v.left+y&&v.top<=t.pageY&&t.pageY<=v.top+b){for(var x={},_=0;_<r.variables.length;_++)x[r.variables[_]]=[];for(var w=0;w<r.variables.length;w++)for(var S=0;S<this.clusterCenters[n].length;S++)x[r.variables[w]].push(this.clusterCenters[n][S][r.variables[w]]);x.arrayLength=this.clusterCenters[n].length;var E={parameters:r,subsequenceParameters:zc.getSubsequenceParameters(),values:x};if(i.normalize){$("#NormalizeSwitch").prop("checked",!0);for(var M=document.getElementById("normalizationOptions"),C=0;C<M.options.length;C++)if("zScore"===M.options[C].value){M.selectedIndex=C;break}}sh("DTWD"),$("#warpingWindowSize").val(r.window),oh(E)}}}}},{key:"resetDetailView",value:function(){$("#selectedClusterCenterTimeTubes").length&&($("#selectedClusterCenterTimeTubes").width(),this.cameraDetail.position.x=0,this.cameraDetail.position.y=0,this.cameraDetail.lookAt(0,0,0))}},{key:"addControls",value:function(){this.controls=new zh.a(this.camera,document.getElementById("clusteringOverviewTimeTubesCanvas")),this.controls.position0.set(0,0,50),this.controls.screenSpacePanning=!1,this.controls.enableZoom=!1}},{key:"onMouseClick",value:function(){return function(t){var e=this.getIntersectedIndex(t);e&&Fb(e=Number(e.split("_")[1]))}}},{key:"getIntersectedIndex",value:function(t){var e,n=new ju.Vector2,r=document.getElementById("clusteringOverviewTimeTubesCanvas"),i=r.getBoundingClientRect(),a=window.pageXOffset+i.left,o=window.pageYOffset+i.top,s=t.pageX-a,l=t.pageY-o;n.x=s/Number(r.style.width.slice(0,-2))*2-1,n.y=-l/Number(r.style.height.slice(0,-2))*2+1,this.raycaster.setFromCamera(n,this.camera);for(var u=0;u<this.labels.length;u++){var c=this.raycaster.intersectObject(this.labels[u]);if(c.length>0){e=c[0].object.name;break}}return e}},{key:"setCameras",value:function(t,e){var n=2*Math.tan(22.5*Math.PI/180),r=t/e;this.cameraSet={},this.cameraSet.perspective=new ju.PerspectiveCamera(45,r,.1,1e3);var i=n*this.cameraPosZ,a=n*this.cameraPosZ*r;this.cameraSet.orthographic=new ju.OrthographicCamera(-a/2,a/2,i/2,-i/2,.1,1e3),this.camera=this.cameraSet.orthographic,this.camera.position.z=this.cameraPosZ,this.camera.lookAt(this.scene.position);var o=.7*zc.getGridSize();this.cameraDetail=new ju.OrthographicCamera(-o/2,o/2,o/2,-o/2,.1,1e3),this.cameraDetail.position.z=this.cameraPosZ}},{key:"setCameraDetail",value:function(){var t=void 0===this.gridSize?.5*zc.getViewportSize():1.4*this.gridSize;this.cameraDetail=new ju.OrthographicCamera(-t/2,t/2,t/2,-t/2,.1,1e3),this.cameraDetail.position.z=this.cameraPosZ}},{key:"computeSplines",value:function(){var t=this;this.minmax={},this.splines=[],this.range=void 0;var e=zc.getDatasets(),n=zc.getSubsequenceParameters(),r=zc.getClusteringParameters().variables;if(this.minmax.x=[1/0,-1/0],this.minmax.y=[1/0,-1/0],this.minmax.H=[1/0,-1/0],this.minmax.V=[1/0,-1/0],r.indexOf("x")>=0&&r.indexOf("y")>=0)for(var i=0;i<this.clusterCenters.length;i++){for(var a=[],o=[],s=[],l=0;l<this.clusterCenters[i].length;l++){var u=this.clusterCenters[i][l],c={x:u.x,y:u.y,r_x:"r_x"in u?u.r_x:.5,r_y:"r_y"in u?u.r_y:.5,H:"H"in u?u.H:.5,V:"V"in u?u.V:.5};for(var h in a.push(new ju.Vector3(c.x,c.y,l)),o.push(new ju.Vector3(c.r_x,c.r_y,l)),s.push(new ju.Vector3(c.H,c.V,l)),this.minmax)c[h]<this.minmax[h][0]&&(this.minmax[h][0]=c[h]),this.minmax[h][1]<c[h]&&(this.minmax[h][1]=c[h])}var d={};d.position=new ju.CatmullRomCurve3(a,!1,"catmullrom"),d.radius=new ju.CatmullRomCurve3(o,!1,"catmullrom"),d.color=new ju.CatmullRomCurve3(s,!1,"catmullrom"),this.splines.push(d)}else if(r.indexOf("PA")>=0&&r.indexOf("PD")>=0)for(var f=0;f<this.clusterCenters.length;f++){var m=[],g=[],v=[];if(n.normalize){for(var y=p(this.clusterCenters[f],(function(t){return t.PA})),b=A(this.clusterCenters[f],(function(t){return t.PD})),x=Math.PI/Math.max(Math.abs(y[0]),Math.abs(y[1])),_=0;_<this.clusterCenters[f].length;_++){var w=this.clusterCenters[f][_],S=w.PA*x,E=w.PD;b<0&&(E+=Math.abs(b));var M={x:E*Math.cos(S),y:E*Math.sin(S),r_x:"r_x"in w?w.r_x:.5,r_y:"r_y"in w?w.r_y:.5,H:"H"in w?w.H:.5,V:"V"in w?w.V:.5};for(var C in m.push(new ju.Vector3(M.x,M.y,_)),g.push(new ju.Vector3(M.r_x,M.r_y,_)),v.push(new ju.Vector3(M.H,M.V,_)),this.minmax)M[C]<this.minmax[C][0]&&(this.minmax[C][0]=M[C]),this.minmax[C][1]<M[C]&&(this.minmax[C][1]=M[C])}var T={};T.position=new ju.CatmullRomCurve3(m,!1,"catmullrom"),T.radius=new ju.CatmullRomCurve3(g,!1,"catmullrom"),T.color=new ju.CatmullRomCurve3(v,!1,"catmullrom"),this.splines.push(T)}else if(1===e.length){for(var k=Ju.getData(e[0]).data.meta,P=0;P<this.clusterCenters[f].length;P++){var O=this.clusterCenters[f][P],N=O.PA*k.std.PA+k.mean.PA;90<N&&N<=180&&(N-=180),N=(N*=2)*Math.PI/180;var R={x:(O.PD*k.std.PD+k.mean.PD)*Math.cos(N),y:(O.PD*k.std.PD+k.mean.PD)*Math.sin(N),r_x:"r_x"in O?O.r_x*k.std.r_x+k.mean.r_x:.5,r_y:"r_y"in O?O.r_y*k.std.r_y+k.mean.r_y:.5,H:"H"in O?O.H*k.std.H+k.mean.H:.5,V:"V"in O?O.V*k.std.V+k.mean.V:.5};for(var L in m.push(new ju.Vector3(R.x,R.y,P)),g.push(new ju.Vector3(R.r_x,R.r_y,P)),v.push(new ju.Vector3(R.H,R.V,P)),this.minmax)R[L]<this.minmax[L][0]&&(this.minmax[L][0]=R[L]),this.minmax[L][1]<R[L]&&(this.minmax[L][1]=R[L])}var I={};I.position=new ju.CatmullRomCurve3(m,!1,"catmullrom"),I.radius=new ju.CatmullRomCurve3(g,!1,"catmullrom"),I.color=new ju.CatmullRomCurve3(v,!1,"catmullrom"),this.splines.push(I)}else!function(){var n={},i={},a={};r.forEach((function(t){n[t]=0,i[t]=0,a[t]=0}));for(var o=function(t){var o=Ju.getData(e[t]);r.forEach((function(t){var e=0;"PA"===t||"PD"===t||"r_x"===t||"r_y"===t?e=o.data.splines.PDPA.points.length:"H"===t?e=o.data.splines.hue.points.length:"V"===t&&(e=o.data.splines.value.points.length),n[t]+=o.data.meta.mean[t]*e,i[t]+=Math.pow(o.data.meta.std[t],2)*e,a[t]+=e}))},s=0;s<e.length;s++)o(s);r.forEach((function(t){n[t]/=a[t],i[t]=Math.sqrt(i[t]/a[t])}));for(var l=0;l<t.clusterCenters[f].length;l++){var u=t.clusterCenters[f][l],c=u.PA*i.PA+n.PA;90<c&&c<=180&&(c-=180),c=(c*=2)*Math.PI/180;var h={x:(u.PD*i.PD+n.PD)*Math.cos(c),y:(u.PD*i.PD+n.PD)*Math.sin(c),r_x:"r_x"in u?u.r_x*i.r_x+n.r_x:.5,r_y:"r_y"in u?u.r_y*i.r_y+n.r_y:.5,H:"H"in u?u.H*i.H+n.H:.5,V:"V"in u?u.V*i.V+n.V:.5};for(var d in m.push(new ju.Vector3(h.x,h.y,l)),g.push(new ju.Vector3(h.r_x,h.r_y,l)),v.push(new ju.Vector3(h.H,h.V,l)),t.minmax)h[d]<t.minmax[d][0]&&(t.minmax[d][0]=h[d]),t.minmax[d][1]<h[d]&&(t.minmax[d][1]=h[d])}var p={};p.position=new ju.CatmullRomCurve3(m,!1,"catmullrom"),p.radius=new ju.CatmullRomCurve3(g,!1,"catmullrom"),p.color=new ju.CatmullRomCurve3(v,!1,"catmullrom"),t.splines.push(p)}()}else if((r.indexOf("x")>=0||r.indexOf("y")>=0)&&(r.indexOf("PA")>=0||r.indexOf("PD")>=0));else if(r.indexOf("x")>=0||r.indexOf("y")>=0)for(var D=0;D<this.clusterCenters.length;D++){for(var z=[],F=[],B=[],V=0;V<this.clusterCenters[D].length;V++){var j=this.clusterCenters[D][V],H={x:"x"in j?j.x:0,y:"y"in j?j.y:0,r_x:"r_x"in j?j.r_x:.5,r_y:"r_y"in j?j.r_y:.5,H:"H"in j?j.H:.5,V:"V"in j?j.V:.5};for(var U in z.push(new ju.Vector3(H.x,H.y,V)),F.push(new ju.Vector3(H.r_x,H.r_y,V)),B.push(new ju.Vector3(H.H,H.V,V)),this.minmax)H[U]<this.minmax[U][0]&&(this.minmax[U][0]=H[U]),this.minmax[U][1]<H[U]&&(this.minmax[U][1]=H[U])}var G={};G.position=new ju.CatmullRomCurve3(z,!1,"catmullrom"),G.radius=new ju.CatmullRomCurve3(F,!1,"catmullrom"),G.color=new ju.CatmullRomCurve3(B,!1,"catmullrom"),this.splines.push(G)}else if(r.indexOf("PA")>=0||r.indexOf("PD")>=0)for(var q=0;q<this.clusterCenters.length;q++){var W=[],$=[],Y=[];if(n.normalize){var Q=void 0,X=void 0,Z=void 0;r.indexOf("PA")>=0?(Q=p(this.clusterCenters[q],(function(t){return t.PA})),X=Math.PI/Math.max(Math.abs(Q[0]),Math.abs(Q[1]))):r.indexOf("PD")>=0&&(Z=A(this.clusterCenters[q],(function(t){return t.PD})));for(var J=void 0,K=void 0,tt=0;tt<this.clusterCenters[q].length;tt++){var et=this.clusterCenters[q][tt];if(r.indexOf("PA")>=0)J=1*Math.cos(et.PA*X),K=1*Math.sin(et.PA*X);else if(r.indexOf("PD")>=0){var nt=et.PD;Z<0&&(nt+=Math.abs(Z));var rt=.5*Math.PI;J=nt*Math.cos(rt),K=nt*Math.sin(rt)}var it={x:J,y:K,r_x:"r_x"in et?et.r_x:.5,r_y:"r_y"in et?et.r_y:.5,H:"H"in et?et.H:.5,V:"V"in et?et.V:.5};for(var at in W.push(new ju.Vector3(it.x,it.y,tt)),$.push(new ju.Vector3(it.r_x,it.r_y,tt)),Y.push(new ju.Vector3(it.H,it.V,tt)),this.minmax)it[at]<this.minmax[at][0]&&(this.minmax[at][0]=it[at]),this.minmax[at][1]<it[at]&&(this.minmax[at][1]=it[at])}}else if(1===e.length)for(var ot=Ju.getData(e[0]).data.meta,st=0;st<this.clusterCenters[q].length;st++){var lt=this.clusterCenters[q][st],ut=void 0,ct=void 0;if(r.indexOf("PA")>=0){var ht=lt.PA*ot.std.PA+ot.mean.PA;90<ht&&ht<=180&&(ht-=180),ht=(ht*=2)*Math.PI/180,ut=Math.cos(ht),ct=Math.sin(ht)}else r.indexOf("PD")>=0&&(ut=(lt.PD*ot.std.PD+ot.mean.PD)*Math.cos(.5*Math.PI),ct=(lt.PD*ot.std.PD+ot.mean.PD)*Math.sin(.5*Math.PI));var dt={x:ut,y:ct,r_x:"r_x"in lt?lt.r_x*ot.std.r_x+ot.mean.r_x:.5,r_y:"r_y"in lt?lt.r_y*ot.std.r_y+ot.mean.r_y:.5,H:"H"in lt?lt.H*ot.std.H+ot.mean.H:.5,V:"V"in lt?lt.V*ot.std.V+ot.mean.V:.5};for(var ft in W.push(new ju.Vector3(dt.x,dt.y,st)),$.push(new ju.Vector3(dt.r_x,dt.r_y,st)),Y.push(new ju.Vector3(dt.H,dt.V,st)),this.minmax)dt[ft]<this.minmax[ft][0]&&(this.minmax[ft][0]=dt[ft]),this.minmax[ft][1]<dt[ft]&&(this.minmax[ft][1]=dt[ft])}else!function(){var n={},i={},a={};r.forEach((function(t){n[t]=0,i[t]=0,a[t]=0}));for(var o=function(t){var o=Ju.getData(e[t]);r.forEach((function(t){var e=0;"PA"===t||"PD"===t||"r_x"===t||"r_y"===t?e=o.data.splines.PDPA.points.length:"H"===t?e=o.data.splines.hue.points.length:"V"===t&&(e=o.data.splines.value.points.length),n[t]+=o.data.meta.mean[t]*e,i[t]+=Math.pow(o.data.meta.std[t],2)*e,a[t]+=e}))},s=0;s<e.length;s++)o(s);r.forEach((function(t){n[t]/=a[t],i[t]=Math.sqrt(i[t]/a[t])}));for(var l=0;l<t.clusterCenters[q].length;l++){var u=t.clusterCenters[q][l],c=void 0,h=void 0;if(r.indexOf("PA")>=0){var d=u.PA*i.PA+n.PA;90<d&&d<=180&&(d-=180),d=(d*=2)*Math.PI/180,c=Math.cos(d),h=Math.sin(d)}else r.indexOf("PD")>=0&&(c=(u.PD*i.PD+n.PD)*Math.cos(.5*Math.PI),h=(u.PD*i.PD+n.PD)*Math.sin(.5*Math.PI));var f={x:c,y:h,r_x:"r_x"in u?u.r_x*i.r_x+n.r_x:.5,r_y:"r_y"in u?u.r_y*i.r_y+n.r_y:.5,H:"H"in u?u.H*i.H+n.H:.5,V:"V"in u?u.V*i.V+n.V:.5};for(var p in W.push(new ju.Vector3(f.x,f.y,l)),$.push(new ju.Vector3(f.r_x,f.r_y,l)),Y.push(new ju.Vector3(f.H,f.V,l)),t.minmax)f[p]<t.minmax[p][0]&&(t.minmax[p][0]=f[p]),t.minmax[p][1]<f[p]&&(t.minmax[p][1]=f[p])}}();var pt={};pt.position=new ju.CatmullRomCurve3(W,!1,"catmullrom"),pt.radius=new ju.CatmullRomCurve3($,!1,"catmullrom"),pt.color=new ju.CatmullRomCurve3(Y,!1,"catmullrom"),this.splines.push(pt)}var mt=this.minmax.x[1]-this.minmax.x[0],gt=this.minmax.y[1]-this.minmax.y[0],vt=Math.round(Math.max(mt,gt)*Math.pow(10,2-Math.ceil(Math.log10(Math.max(mt,gt)))));this.range=zc.getGridSize()/(5*Math.ceil(vt/5)*Math.pow(10,-(2-Math.ceil(Math.log10(Math.max(mt,gt))))))}},{key:"drawClusterCentersAsTubes",value:function(){void 0===this.texture?(new ju.TextureLoader).load("img/1_256.png",function(t){this.texture=t,this.drawTubes()}.bind(this)):this.drawTubes(),this.drawAxes(),this.drawLabels()}},{key:"drawClusterRadiusesAsRings",value:function(t){if(this.clusterRadiuses){var e=this.clusterRadiuses.geometry,n=this.clusterRadiuses.material;this.scene.remove(this.clusterRadiuses),this.clusterRadiuses=void 0,e.dispose(),n.dispose()}this.clusterRadiuses=void 0;for(var r=0,i=0;i<t.length;i++)if(t[i]>0){r=t[i];break}for(var a=.7*this.gridSize/r,o=Array(64*t.filter((function(t){return 0!==t})).length),s=[],l=2*Math.PI/32,u=0,c=0;c<t.length;c++)if(t[c]>0){var h=64*u;o[h]=32*u,o[h+64-1]=32*u;for(var d=0;d<32;d++)s.push(this.tubeCoords[c].x+t[c]*a*Math.cos(l*d)),s.push(this.tubeCoords[c].y+t[c]*a*Math.sin(l*d)),s.push(0),0!==d&&(o[h+2*(d-1)+1]=32*u+d,o[h+2*(d-1)+2]=32*u+d);u++}var f=new ju.BufferGeometry;f.setIndex(o),f.setAttribute("position",new ju.Float32BufferAttribute(s,3));var p=new ju.LineBasicMaterial({color:16777215,linewidth:1});this.clusterRadiuses=new ju.LineSegments(f,p),this.scene.add(this.clusterRadiuses)}},{key:"computeTubePositions",value:function(){this.tubeCoords=[],this.gridSize=void 0;var t,e,n,r=zc.getResultsCoordinates().clustersCoord;if(r){for(var i=[1/0,-1/0],a=[1/0,-1/0],o=1/0,s=0;s<r.length;s++){r[s][0]<i[0]&&(i[0]=r[s][0]),i[1]<r[s][0]&&(i[1]=r[s][0]),r[s][1]<a[0]&&(a[0]=r[s][1]),a[1]<r[s][1]&&(a[1]=r[s][1]);for(var l=s+1;l<r.length;l++){var u=Math.sqrt(Math.pow(r[s][0]-r[l][0],2)+Math.pow(r[s][1]-r[l][1],2));u<o&&(o=u)}}var c=$("#clusteringResultsOverview").width(),h=$("#clusteringResultsOverview").height(),d=c/h,f=Math.max(Math.abs(i[1]-i[0])/d,Math.abs(a[1]-a[0])),p=f*d,m=.8*zc.getViewportSize(),g=c>h?.9*zc.getViewportSize()*d:m,v=c<h?.9*zc.getViewportSize()/d:m,y=2*m/(h<c?f:p);if(o*y<2*zc.getGridSize()&&(this.gridSize=o*y/2),this.gridSize<this.minGridSize){var b=function t(e){for(var n=e+1;n<S[e].length;n++)S[e][n]<6&&(O.push(n),t(n))};this.gridSize=this.minGridSize;for(var x=-1*(i[1]-(i[1]-i[0])/2)*y,_=-1*(a[1]-(a[1]-a[0])/2)*y,w=0;w<r.length;w++)this.tubeCoords.push({x:x+r[w][0]*y,y:_+r[w][1]*y});for(var S=[],E=0;E<r.length;E++){S.push([]);for(var M=0;M<r.length;M++)S[E].push(0)}for(var C=0;C<this.tubeCoords.length;C++)for(var T=C+1;T<this.tubeCoords.length;T++){var k=Math.sqrt(Math.pow(this.tubeCoords[C].x-this.tubeCoords[T].x,2)+Math.pow(this.tubeCoords[C].y-this.tubeCoords[T].y,2));S[C][T]=k,S[T][C]=k,k<o&&(o=k)}for(var P=!0,A=0,O=[];P&&A<10;){for(var N=0;N<S.length-1;){if(O=[],b(N),O.length>0){O.push(N),O=Array.from(new Set(O));for(var R=[],L=0;L<O.length;L++){var I=Object.assign({},this.tubeCoords[O[L]]);I.idx=O[L],R.push(I)}var D={x:0,y:0};if(O.length>=3){R.sort((function(t,e){return t.x<e.x?-1:1}));for(var z=R;1!==z.length;){for(var F=[],B=1;B<z.length-1;B++)F.push((t=z[0],e=z[B],n=z[B+1],{x:(t.x+e.x+n.x)/3,y:(t.y+e.y+n.y)/3}));z=F}D=z}else{for(var V=0;V<R.length;V++)D.x+=R[V].x,D.y+=R[V].y;D.x/=R.length,D.y/=R.length}for(var j=1/0,H=0;H<O.length-1;H++)for(var U=H+1;U<O.length;U++)S[H][U]<j&&(j=S[H][U]);for(var G=2*this.minGridSize/o,q=0,W=0,Y=0;Y<O.length;Y++){if(this.tubeCoords[O[Y]].x*=G,this.tubeCoords[O[Y]].y*=G,Math.abs(this.tubeCoords[O[Y]].x)>g)if(this.tubeCoords[O[Y]].x>=0){var Q=this.tubeCoords[O[Y]].x-g;q<Q&&(q=Q)}else{var X=this.tubeCoords[O[Y]].x+g;X<q&&(q=X)}if(Math.abs(this.tubeCoords[O[Y]].y)>v)if(this.tubeCoords[O[Y]].y>=0){var Z=this.tubeCoords[O[Y]].y-v;W<Z&&(W=Z)}else{var J=this.tubeCoords[O[Y]].y+v;J<W&&(W=J)}}if(0!==q||0!==W)for(var K=0;K<O.length;K++)0!==q&&(this.tubeCoords[O[K]].x-=q),0!==W&&(this.tubeCoords[O[K]].y-=W);for(var tt=0;tt<this.tubeCoords.length;tt++)for(var et=tt+1;et<this.tubeCoords.length;et++){var nt=Math.sqrt(Math.pow(this.tubeCoords[tt].x-this.tubeCoords[et].x,2)+Math.pow(this.tubeCoords[tt].y-this.tubeCoords[et].y,2));S[tt][et]=nt,S[et][tt]=nt,nt<o&&(o=nt)}if(this.minGridSize<o){P=!1;break}}N++}N>=S.length-1&&0===O.length&&(P=!1),A++}this.range=this.gridSize*this.range/zc.getGridSize()}else{this.range=this.gridSize*this.range/zc.getGridSize();for(var rt=-1*(i[1]-(i[1]-i[0])/2)*y,it=-1*(a[1]-(a[1]-a[0])/2)*y,at=0;at<r.length;at++)this.tubeCoords.push({x:rt+r[at][0]*y,y:it+r[at][1]*y})}}else{this.gridSize=zc.getGridSize();for(var ot=.7*zc.getViewportSize(),st=0;st<this.clusterCenters.length;st++){var lt=ot*Math.cos(.5*Math.PI-2*Math.PI/this.clusterCenters.length*st),ut=ot*Math.sin(.5*Math.PI-2*Math.PI/this.clusterCenters.length*st);this.tubeCoords.push({x:lt,y:ut})}}}},{key:"drawTubes",value:function(){for(var t=0;t<this.tubes.length;t++){var e=this.tubes[t].geometry,n=this.tubes[t].material;this.scene.remove(this.tubes[t]),e.dispose(),n.dispose(),this.tubes[t]=void 0}this.tubes=[];for(var r=zc.getClusteringParameters().variables,i=zc.getSubsequenceParameters().isometryLen+1,a=this.division*i,o=2*Math.PI/(this.segment-1),s=void 0===this.gridSize?.5:.5*this.gridSize/zc.getGridSize(),l=0;l<this.splines.length;l++){var u=void 0,c=[],h=[],d=[],f=this.splines[l].position.getSpacedPoints(a),p=this.splines[l].radius.getSpacedPoints(a),m=this.splines[l].color.getSpacedPoints(a),g=this.tubeCoords[l].x,v=this.tubeCoords[l].y;if("r_x"in r||"r_y"in r){for(var y=this.opacityCurve.getSpacedPoints(this.tubeNum),b=[],x=1;x<=this.tubeNum;x++)b.push(1-(1-y[x-1].y)/(1-y[x].y));for(var _=0;_<this.tubeNum;_++)c[_]=[],h[_]=[];for(var w=0;w<=a;w++)for(var S=("r_x"in this.clusterCenters[0][0]?p[w].x*this.range:s),E=("r_y"in this.clusterCenters[0][0]?p[w].y*this.range:s),M=0;M<this.segment;M++){for(var C=0;C<this.tubeNum;C++){var T=1/this.tubeNum*(C+1),k=o*M;c[C].push(-1*(g+f[w].x*this.range+T*S*Math.cos(k))),c[C].push(v+f[w].y*this.range+T*E*Math.sin(k)),c[C].push(f[w].z),h[C].push(m[w].x),h[C].push(m[w].y),h[C].push(b[C])}M!==this.segment-1&&(d.push(M+w*this.segment),d.push(M+this.segment+w*this.segment),d.push(M+1+w*this.segment),d.push(M+this.segment+w*this.segment),d.push(M+1+this.segment+w*this.segment),d.push(M+1+w*this.segment))}d=d.slice(0,-1*this.segment*3*2);for(var P=new Float32Array(c[0].length),A=[],O=0;O<this.tubeNum;O++){var N=new ju.BufferGeometry;N.setAttribute("position",new ju.BufferAttribute(new Float32Array(c[O]),3)),N.setAttribute("normal",new ju.BufferAttribute(P,3)),N.setAttribute("colorData",new ju.BufferAttribute(new Float32Array(h[O]),3)),N.setIndex(new ju.BufferAttribute(new Uint32Array(d),1)),N.computeVertexNormals(),A.push(N)}u=Ih.mergeBufferGeometries(A)}else{for(var R=0;R<=a;R++)for(var L=0;L<this.segment;L++){var I=o*L;c.push(-1*(g+f[R].x*this.range+s*Math.cos(I))),c.push(v+f[R].y*this.range+s*Math.sin(I)),c.push(f[R].z),h.push(m[R].x),h.push(m[R].y),h.push(1),L!==this.segment-1&&(d.push(L+R*this.segment),d.push(L+this.segment+R*this.segment),d.push(L+1+R*this.segment),d.push(L+this.segment+R*this.segment),d.push(L+1+this.segment+R*this.segment),d.push(L+1+R*this.segment))}d=d.slice(0,-1*this.segment*3*2);var D=new Float32Array(c.length);(u=new ju.BufferGeometry).setAttribute("position",new ju.BufferAttribute(new Float32Array(c),3)),u.setAttribute("normal",new ju.BufferAttribute(D,3)),u.setAttribute("colorData",new ju.BufferAttribute(new Float32Array(h),3)),u.setIndex(new ju.BufferAttribute(new Uint32Array(d),1)),u.computeVertexNormals()}var z=new ju.ShaderMaterial({vertexShader:this.vertex,fragmentShader:this.fragment,uniforms:{lightPosition:{value:new ju.Vector3(-20,40,60)},shade:{value:!0},texture:{value:this.texture},minmaxH:{value:new ju.Vector2(this.minmax.H[0],this.minmax.H[1])},minmaxV:{value:new ju.Vector2(this.minmax.V[0],this.minmax.V[1])},flagH:{value:!0},flagV:{value:!0}},side:ju.DoubleSide,transparent:!0}),F=new ju.Mesh(u,z);F.rotateY(Math.PI),this.scene.add(F),this.tubes.push(F)}}},{key:"drawAxes",value:function(){for(var t=0;t<this.axes.length;t++){var e=this.axes[t].geometry,n=this.axes[t].material;this.scene.remove(this.axes[t]),this.axes[t]=void 0,e.dispose(),n.dispose()}var r;this.axes=[],r=void 0!==this.gridSize?.7*this.gridSize:.7*zc.getGridSize();for(var i=0;i<this.clusterCenters.length;i++){var a=new ju.BufferGeometry,o=new ju.LineBasicMaterial({color:"white",opacity:.5}),s=[],l=[],u=0;s.push(-1*r,0,0),s.push(r,0,0),s.push(0,r,0),s.push(0,-1*r,0),s.push(0,0,0),s.push(0,0,this.clusterCenters[i].length),l.push(u+0,u+1,u+2,u+3,u+4,u+5),u+=6,a.setIndex(l),a.setAttribute("position",new ju.Float32BufferAttribute(s,3)),this.axes.push(new ju.LineSegments(a,o)),this.axes[this.axes.length-1].translateX(this.tubeCoords[i].x),this.axes[this.axes.length-1].translateY(this.tubeCoords[i].y),this.axes[this.axes.length-1].rotateY(Math.PI),this.scene.add(this.axes[this.axes.length-1])}}},{key:"drawLabels",value:function(){for(var t=0;t<this.labels.length;t++)this.scene.remove(this.labels[t]),this.labels[t].dispose(),this.labels[t]=void 0;var e;this.labels=[],e=void 0!==this.gridSize?.7*this.gridSize:.7*zc.getGridSize();for(var n=0;n<this.clusterCenters.length;n++){var r=new e_.a({alignment:"center",color:"hsl("+this.clusterColors[n][0]+","+100*this.clusterColors[n][1]+"%,"+100*this.clusterColors[n][2]+"%)",fontFamily:"Arial, Helvetica, sans-serif",textSize:.8,text:"Cluster "+n});r.name="Cluster_"+n,this.labels.push(r);var i=this.tubeCoords[n].x,a=this.tubeCoords[n].y+e;this.labels[this.labels.length-1].position.set(i,a,-3),this.scene.add(this.labels[this.labels.length-1])}}},{key:"drawMDSScatterplots",value:function(){var t=this;if($("#clusteringOverviewMDSScatterplotsSVG").remove(),this.clusterCenters.length>0){var e=$("#clusteringResultsOverview").width()*this.chartsSize.MDS.width-45,n=$("#appHeader").outerHeight(!0),r=$("#clusteringTimeline").outerHeight(!0),i=(window.innerHeight-n-r)*this.chartsSize.MDS.height,a={left:30,right:30,top:30,bottom:30};this.MDSSPSvg=se("#clusteringOverviewMDSScatterplots").append("svg").attr("id","clusteringOverviewMDSScatterplotsSVG").attr("width",e).attr("height",i).style("background-color","white");var o,s=zc.getClusteringParameters(),l=zc.getResultsCoordinates(),u=l.dataCoord;if("kmeans"===s.method||"kmedoids"===s.method&&"each"===s.medoidDefinition)o=u.slice(u.length-this.clusterCenters.length,u.length);else{o=[];for(var c=0;c<l.medoidIdx.length;c++)o.push(u[l.medoidIdx[c]])}("kmeans"===s.method||"kmedoids"===s.method&&"each"===s.medoidDefinition)&&(u=u.slice(0,u.length-this.clusterCenters.length));var h=p(u,(function(t){return t[0]})),d=p(u,(function(t){return t[1]}));if(e/i<(h[1]-h[0])/(d[1]-d[0])){var f=(h[1]-h[0])/e*i/(d[1]-d[0]);this.xScale=Na().domain(h).range([a.left,e-a.right]).nice(),this.yScale=Na().domain([d[0]*f,d[1]*f]).range([i-a.bottom,a.top]).nice()}else{var m=(d[1]-d[0])/i*e/(h[1]-h[0]);this.xScale=Na().domain([h[0]*m,h[1]*m]).range([a.left,e-a.right]).nice(),this.yScale=Na().domain(d).range([i-a.bottom,a.top]).nice()}this.dataPlots=this.MDSSPSvg.selectAll("circle.dataPointsMDS").data(u).enter().append("circle").attr("cx",function(t){return this.xScale(t[0])}.bind(this)).attr("cy",function(t){return this.yScale(t[1])}.bind(this)).attr("r",3).attr("class",function(t,e){return"dataPointsMDS dataPointsMDS_"+("object"===n_(this.SSLabels[e])?this.SSLabels[e].cluster:this.SSLabels[e])}.bind(this)).attr("id",function(t,e){return"dataPointsMDS_"+this.subsequences[e].id+"_"+this.subsequences[e].idx}.bind(this)).attr("fill",function(t,e){var n=this.clusterColors["object"===n_(this.SSLabels[e])?this.SSLabels[e].cluster:this.SSLabels[e]];return Be(n[0],n[1],n[2])}.bind(this)).on("mouseover",this.onMouseOverDataPointsMDS().bind(this)).on("mouseout",this.onMouseOutDataPointsMDS().bind(this)).on("click",this.onClickDataPointsMDS().bind(this)).on("dblclick",this.onDoubleClickDataPointsMDS().bind(this)),this.clusterCenterPlots=this.MDSSPSvg.selectAll("circle.clusterCentersMDS").data(o).enter().append("circle").attr("class","clusterCentersMDS").attr("cx",function(t){return this.xScale(t[0])}.bind(this)).attr("cy",function(t){return this.yScale(t[1])}.bind(this)).attr("r",5).attr("id",(function(t,e){return"clusterCentersMDS_"+e})).attr("fill","none").attr("stroke",function(t,e){var n=this.clusterColors[e];return Be(n[0],n[1],n[2])}.bind(this)).attr("stroke-width",2).on("mouseover",this.onMouseOverClusterCentersMDS().bind(this)).on("mouseout",this.onMouseOutClusterCentersMDS().bind(this)).on("click",this.onClickClusterCentersMDS().bind(this)),this.clusterNameLabels=this.MDSSPSvg.selectAll("text.clusterNameLabelMDS").data(o).enter().append("text").attr("class","clusterNameLabelMDS").attr("x",function(t){return this.xScale(t[0])}.bind(this)).attr("y",function(t){return this.yScale(t[1])+16}.bind(this)).attr("id",(function(t,e){return"clusterCentersLabelMDS_"+e})).attr("fill",function(t,e){var n=this.clusterColors[e];return Be(n[0],n[1],n[2])}.bind(this)).attr("font-size","0.8rem").attr("text-anchor","middle").text((function(t,e){return"Cluster "+e})).on("mouseover",this.onMouseOverClusterCentersMDS().bind(this)).on("mouseout",this.onMouseOutClusterCentersMDS().bind(this)).on("click",this.onClickClusterCentersMDS().bind(this)).moveToBack(),this.SSClusterCoords=[],this.SSCluster=[];for(var g=[],v=0;v<this.clusterCenters.length;v++)this.SSClusterCoords.push([]),g.push([]),this.SSClusterCoords[v].push(o[v]),g[v].push([this.xScale(o[v][0]),this.yScale(o[v][1])]),this.SSCluster.push([]);for(var y=0;y<this.SSLabels.length;y++)"object"===n_(this.SSLabels[y])?(this.SSClusterCoords[this.SSLabels[y].cluster].push(u[y]),g[this.SSLabels[y].cluster].push([this.xScale(u[y][0]),this.yScale(u[y][1])]),this.SSCluster[this.SSLabels[y].cluster].push(this.subsequences[y])):(this.SSClusterCoords[this.SSLabels[y]].push(u[y]),g[this.SSLabels[y]].push([this.xScale(u[y][0]),this.yScale(u[y][1])]),this.SSCluster[this.SSLabels[y]].push(this.subsequences[y]));this.hulls=[];for(var b=function(e){var n=$i(g[e]);t.hulls.push(t.MDSSPSvg.append("path").attr("class","hull").attr("id","hull_"+e).attr("fill",function(t){return Be(this.clusterColors[e][0],.8,.8)}.bind(t)).style("opacity",.2).attr("d",null===n?null:"M"+n.join("L")+"Z").style("visibility","hidden").moveToBack())},x=0;x<this.clusterCenters.length;x++)b(x)}}},{key:"drawClustersSummaryStuckedBarChart",value:function(){for(var t=new Array(this.clusterCenters.length).fill(0),e=0;e<this.SSLabels.length;e++){var n="object"===n_(this.SSLabels[e])?this.SSLabels[e].cluster:this.SSLabels[e];t[n]++}var r=$("#clusteringResultsOverview").width()*this.chartsSize.MDS.width-45;this.clusterSummaryBarChart=this.MDSSPSvg.selectAll("rect.clusterSummaryBar").data(t).enter().append("rect").attr("id",(function(t,e){return"clusterSummaryBar_"+e})).attr("class","clusterSummaryBar").attr("x",function(e,n){for(var i=0,a=0;a<n;a++)i+=t[a];return i*r/this.SSLabels.length}.bind(this)).attr("y",5).attr("width",function(t){return t*r/this.SSLabels.length}.bind(this)).attr("height",10).attr("fill",function(t,e){var n=this.clusterColors[e];return Be(n[0],n[1],n[2])}.bind(this)).on("mouseover",this.onMouseOverClusterCentersMDS().bind(this)).on("mouseout",this.onMouseOutClusterCentersMDS().bind(this)).on("click",this.onClickClusterCentersMDS().bind(this))}},{key:"drawSilhouetteBarChart",value:function(){if($("#silhouetteBarChartSVG").remove(),this.SSLabels.length>0){var t={left:30,right:15,top:15,bottom:30},e=$("#clusteringResultsOverview").width()*this.chartsSize.barChart.width-45,n=$("#appHeader").outerHeight(!0),r=$("#clusteringTimeline").outerHeight(!0),i=(window.innerHeight-n-r)*this.chartsSize.barChart.height;this.SilhouetteSVG=se("#silhouetteBarChart").append("svg").attr("id","silhouetteBarChartSVG").attr("width",e).attr("height",i).style("background-color","white");for(var a=[],o=0;o<this.clusterCenters.length;o++)a.push([]);for(var s=0;s<this.SSLabels.length;s++)a["object"===n_(this.SSLabels[s])?this.SSLabels[s].cluster:this.SSLabels[s]].push({idx:s,silhouette:this.state.clusteringScores.silhouetteSS[s]});this.xScaleSilhouette=Na().range([0,e-t.left-t.right]).domain([0,1]);var l=V(this.xScaleSilhouette).ticks(5).tickSize(-i+t.top+t.bottom);this.xLabelSilhouette=this.SilhouetteSVG.append("g").attr("class","x_axis").attr("transform","translate("+t.left+","+(i-t.bottom)+")").call(l),this.yScaleSilhouette=ia().range([t.top,i-t.bottom]).domain(this.SSLabels.map((function(t,e){return e}))).padding(.05),this.SilhouetteBars=this.SilhouetteSVG.append("g").attr("class","SilhouetteBars").on("mouseover",this.onMouseOverSilhouetteBarChart().bind(this)).on("mouseout",this.onMouseOutSilhouetteBarChart().bind(this)).on("click",this.onClickSilhouetteBarChart().bind(this)).on("dblclick",this.onDoubleClickSilhouetteBarChart().bind(this));for(var u=0;u<a.length;u++){a[u].sort((function(t,e){return e.silhouette-t.silhouette}));for(var c=0;c<a[u].length;c++){for(var h=0,d=0;d<u;d++)h+=a[d].length;a[u][c].order=h+c}}for(var f=0;f<this.clusterCenters.length;f++){var p=this.clusterColors[f];p=Be(p[0],p[1],p[2]),this.SilhouetteBars.selectAll("rect.SilhouetteBarCluster_"+f).data(a[f]).enter().append("rect").attr("class","SilhouetteBar SilhouetteBarCluster_"+f).attr("id",(function(t){return"SilhouetteBar_"+t.idx})).attr("width",function(t){return this.xScaleSilhouette(t.silhouette)}.bind(this)).attr("x",t.left).attr("y",function(t){return this.yScaleSilhouette(t.order)}.bind(this)).attr("height",this.yScaleSilhouette.bandwidth()).attr("fill",p)}this.silhouetteVerticalLine=this.SilhouetteSVG.append("line").attr("stroke-width",2).attr("stroke","black").attr("id","silhouetteVerticalLine").attr("x1",this.xScaleSilhouette(this.state.clusteringScores.silhouette)+t.left).attr("y1",t.top).attr("x2",this.xScaleSilhouette(this.state.clusteringScores.silhouette)+t.left).attr("y2",i-t.bottom)}}},{key:"drawElbowMethodLineChart",value:function(){if($("#elbowMethodLineChartSVG").remove(),$("#elbowMethodLineChart").length>0){var t=$("#clusteringResultsOverview").width()*this.chartsSize.elbowLineChart.width-45,e=$("#appHeader").outerHeight(!0),n=$("#clusteringTimeline").outerHeight(!0),r=(window.innerHeight-e-n)*this.chartsSize.elbowLineChart.height,i={left:45,right:15,top:15,bottom:30};this.elbowMethodLineChartSVG=se("#elbowMethodLineChart").append("svg").attr("id","elbowMethodLineChartSVG").attr("width",t).attr("height",r).style("background-color","white");var a=zc.getSSEClusters(),o=Object.keys(a);o.sort((function(t,e){return t-e}));for(var s=[],l=0;l<o.length;l++)o[l]=Number(o[l]),s.push({clusterNum:Number(o[l]),SSE:a[o[l]]});this.xScaleSSE=Na().range([i.left,t-i.right]).domain(p(o));var u=V(this.xScaleSSE).ticks(o.length);this.xLabelSSE=this.elbowMethodLineChartSVG.append("g").attr("class","x_axis").attr("transform","translate(0,"+(r-i.bottom)+")").call(u).attr("font-size","0.5rem"),this.yScaleSSE=Na().range([r-i.bottom,i.top]).domain([0,k(s,(function(t){return t.SSE}))]).nice();var c=j(this.yScaleSSE).ticks(5);this.yLabelSSE=this.elbowMethodLineChartSVG.append("g").attr("class","y_axis").attr("transform","translate("+i.left+",0)").call(c).attr("font-size","0.5rem"),this.elbowMethodLineChartSVG.append("path").datum(s).attr("id","elbowMethodLineChartPath").attr("fill","none").attr("stroke","gray").attr("stroke-width",1.5).attr("d",Qs().x(function(t){return this.xScaleSSE(t.clusterNum)}.bind(this)).y(function(t){return this.yScaleSSE(t.SSE)}.bind(this)));var h=this.elbowMethodLineChartSVG.append("g").attr("id","elbowMethodLineChartPlotGroup");h.append("line").attr("id","elbowMethodLineChartFocusedV").attr("x1",i.left).attr("y1",i.top).attr("x2",i.left).attr("y2",r-i.bottom).attr("stroke","orange").attr("stroke-width",1).style("visibility","hidden"),h.append("line").attr("id","elbowMethodLineChartFocusedH").attr("x1",i.left).attr("y1",i.top).attr("x2",t-i.right).attr("y2",i.top).attr("stroke","orange").attr("stroke-width",1).style("visibility","hidden"),h.selectAll("circle").data(s).enter().append("circle").attr("cx",function(t){return this.xScaleSSE(t.clusterNum)}.bind(this)).attr("cy",function(t){return this.yScaleSSE(t.SSE)}.bind(this)).attr("r",2).attr("fill","white").attr("stroke-width",1).attr("stroke","gray").on("mouseover",(function(){var t=se(this).attr("cx"),e=se(this).attr("cy");se("#elbowMethodLineChartFocusedV").attr("x1",t).attr("x2",t).style("visibility","visible"),se("#elbowMethodLineChartFocusedH").attr("y1",e).attr("y2",e).style("visibility","visible")})).on("mouseout",(function(){se("#elbowMethodLineChartFocusedV").style("visibility","hidden"),se("#elbowMethodLineChartFocusedH").style("visibility","hidden")})),this.elbowMethodLineChartSVG.append("text").attr("x",i.left+(t-i.left)/2).attr("y",r-8).attr("id","elbowMethodLineChartXLabel").attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("Cluster number"),this.elbowMethodLineChartSVG.append("text").attr("transform","rotate(-90)").attr("y",8).attr("x",-1*(r-i.bottom)/2).attr("id","elbowMethodLineChartYLabel").attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("SSE")}}},{key:"drawFeatureHeatmap",value:function(){var t=this;$("#clusterFeatureHeatmapSVG").remove(),$("#clusterFeatureHeatmap").length>0&&function(){var e=function(){if($t.target){var t=$t.target.id.split("_"),e=Number(t[1]),n=$("#tooltipFeatureHeatmap");n.text(Sd(f[e][t[2]])),n.css("display","block");var r,i,a=$("#clusteringResults").offset(),o=window.pageYOffset;if(o<a.top)if(r=$t.clientX-a.left+5,$t.clientY<$("#clusteringResults").height()/2)i=$t.clientY-(a.top-o)+5;else{var s=0===n.height()?30:n.height();i=$t.clientY-(a.top-o)-s-5}else if(r=$t.clientX-a.left+5,$t.clientY<$("#clusteringOverviewMDSScatterplots").height()/2)i=$t.clientY+5;else{var l=0===n.height()?30:n.height();i=$t.clientY-l-5}n.css({left:r+"px",top:i+"px",right:"unset",bottom:"unset"}),this.hulls[e].style("visibility","visible"),Us("circle.dataPointsMDS").style("opacity",.3),Us("circle.clusterCentersMDS").style("opacity",.3),Us("circle.dataPointsMDS_"+e).style("opacity",1),se("#clusterCentersMDS_"+e).style("opacity",1)}},n=function(){if($t.target){var t=$t.target.id.split("_"),e=Number(t[1]);$("#tooltipFeatureHeatmap").css("display","none"),this.hulls[e].style("visibility","hidden"),Us("circle.dataPointsMDS").style("opacity",1),Us("circle.clusterCentersMDS").style("opacity",1)}},r=function(){if($t.target){var t=$t.target.id.split("_");Fb(Number(t[1]))}},i=$("#clusteringResultsOverview").width()*t.chartsSize.featureHeatmap.width-45,a=$("#appHeader").outerHeight(!0),o=$("#clusteringTimeline").outerHeight(!0),s=(window.innerHeight-a-o)*t.chartsSize.featureHeatmap.height,l=45,u=15,c=20,h=30;t.featureHeatmapSVG=se("#clusterFeatureHeatmap").append("svg").attr("id","clusterFeatureHeatmapSVG").attr("width",i).attr("height",s).style("background-color","white");for(var d=zc.getClusteringParameters().variables,f=[],p=function(e){var n={},r={};d.forEach(function(t){n[t]=0,r[t]=0;for(var i=0;i<this.SSCluster[e].length;i++)for(var a=0;a<this.SSCluster[e][i].dataPoints.length;a++)t in this.SSCluster[e][i].dataPoints[a]&&(n[t]+=this.SSCluster[e][i].dataPoints[a][t],r[t]++)}.bind(t)),d.forEach(function(t){n[t]/=r[t]}.bind(t)),f.push(n)},m=0;m<t.SSCluster.length;m++)p(m);var g={};d.forEach((function(t){g[t]=[1/0,-1/0]}));for(var v=function(t){d.forEach((function(e){f[t][e]<g[e][0]&&(g[e][0]=f[t][e]),g[e][1]<f[t][e]&&(g[e][1]=f[t][e])}))},y=0;y<f.length;y++)v(y);for(var b={},x=zc.getDatasets(),_=0;_<x.length;_++){var w=Ju.getData(x[_]).data.lookup;for(var S in w)if(S in b)for(var E=0;E<w[S].length;E++)b[S].indexOf(w[S][E])<0&&b[S].push(w[S][E]);else b[S]=w[S]}var M=[];d.forEach((function(t){M.push(b[t].join(", "))}));var C=Array(t.clusterCenters.length).fill().map((function(t,e){return e}));t.xScaleFeatureHeatmap=ia().range([l,i-u]).domain(C).padding(.05),t.xLabelFeatureHeatmap=t.featureHeatmapSVG.append("g").attr("class","x_axis").attr("transform","translate(0,"+(s-h)+")").call(V(t.xScaleFeatureHeatmap)),t.xLabelFeatureHeatmap.selectAll("text").attr("fill",function(t){var e=this.clusterColors[t];return Be(e[0],e[1],e[2])}.bind(t)),t.yScaleFeatureHeatmap=ia().range([c,s-h]).domain(M).padding(.05),t.yLabelFeatureHeatmap=t.featureHeatmapSVG.append("g").attr("class","y_axis").attr("transform","translate("+l+",0)").call(j(t.yScaleFeatureHeatmap));for(var T=function(i){t.featureHeatmapSVG.selectAll("rect.featureHeatmapRect_"+i).data(M).enter().append("rect").attr("class","featureHeatmapRect featureHeatmapRect_"+i).attr("id",(function(t,e){return"featureHeatmapRect_"+i+"_"+d[e]})).attr("x",function(t){return this.xScaleFeatureHeatmap(i)}.bind(t)).attr("y",function(t,e){return this.yScaleFeatureHeatmap(t)}.bind(t)).attr("width",t.xScaleFeatureHeatmap.bandwidth()).attr("height",t.yScaleFeatureHeatmap.bandwidth()).attr("fill",(function(t,e){return js((f[i][d[e]]-g[d[e]][0])/(g[d[e]][1]-g[d[e]][0]))})).on("mouseover",e.bind(t)).on("mouseout",n.bind(t)).on("click",r)},k=0;k<f.length;k++)T(k);t.featureHeatmapSVG.append("text").attr("x",l+(i-l)/2).attr("y",s-8).attr("id","featureHeatmapXLabel").attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("Cluster name"),t.featureHeatmapSVG.append("text").attr("transform","rotate(-90)").attr("y",8).attr("x",-1*(s-h)/2).attr("id","featureHeatmapYLabel").attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("Variables");var P=(i-l-u)/2/t.clusterCenters.length,A=t.featureHeatmapSVG.append("g").attr("class","featureHeatmapLegend");A.selectAll("rect.featureHeatmapLegendRect").data(C).enter().append("rect").attr("class","featureHeatmapLegendRect").attr("x",(function(t){return i/2+t*P})).attr("y",0).attr("width",P).attr("height",10).attr("fill",function(t){return js(t/(this.clusterCenters.length-1))}.bind(t)),A.append("text").attr("id","featureHeatmapLegendLabelSmall").attr("x",i/2-15).attr("y",10).attr("text-anchor","middle").attr("fill","black").attr("font-size","0.6rem").text("small"),A.append("text").attr("id","featureHeatmapLegendLabelLarge").attr("x",i-u-2).attr("y",10).attr("text-anchor","middle").attr("fill","black").attr("font-size","0.6rem").text("large")}()}},{key:"onClickDataPointsMDS",value:function(){return function(){if($t.target){var t=$t.target.classList[1];Fb(Number(t.split("_")[1]))}}}},{key:"onDoubleClickDataPointsMDS",value:function(){return function(){var t=$t.target.id;if(t){for(var e,n=t.split("_"),r=Number(n[1]),i=Number(n[2]),a=0;a<this.subsequences.length;a++)if(this.subsequences[a].id===r&&this.subsequences[a].idx===i){e=this.subsequences[a];break}$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(r,[e.dataPoints[0].z,e.dataPoints[e.dataPoints.length-1].z])}}}},{key:"onMouseOverDataPointsMDS",value:function(){return function(){var t=$t.target.id;if(t){var e,n=$("#tooltipClusteringResults"),r=$("#tooltipClusteringResultsTable"),i=t.split("_"),a=Number(i[1]),o=Number(i[2]),s=0;for(s=0;s<this.subsequences.length;s++)if(this.subsequences[s].id===a&&this.subsequences[s].idx===o){e=this.subsequences[s];break}var l,u,c=Ju.getFileName(a),h=[e.dataPoints[0].z,e.dataPoints[e.dataPoints.length-1].z],d=e.dataPoints.length,f=window.pageYOffset,p=$("#clusteringResults").offset();if(f<p.top)if(l=$t.clientX-p.left+5,$t.clientY<$("#clusteringResults").height()/2)u=$t.clientY-(p.top-f)+5;else{var m=0===n.height()?230:n.height();u=$t.clientY-(p.top-f)-m-5}else if(l=$t.clientX-p.left+5,$t.clientY<$("#clusteringOverviewMDSScatterplots").height()/2)u=$t.clientY+5;else{var g=0===n.height()?230:n.height();u=$t.clientY-g-5}r.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+c+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(h[0])+"-"+Sd(h[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+d+"</td></tr></tbody></table>"),n.css({left:l+"px",top:u+"px",right:"unset",bottom:"unset"}),n.css("display","block");var v=[void 0,void 0];s-1>=0&&this.subsequences[s-1].id===this.subsequences[s].id&&(v[0]="object"===n_(this.SSLabels[s-1])?this.SSLabels[s-1].cluster:this.SSLabels[s-1]),s+1<this.SSLabels.length&&this.subsequences[s].id===this.subsequences[s+1].id&&(v[1]="object"===n_(this.SSLabels[s+1])?this.SSLabels[s+1].cluster:this.SSLabels[s+1]),Eh(a,o,h,v),jb(Number(a),h)}}}},{key:"onMouseOutDataPointsMDS",value:function(){return function(){var t=$t.target.id;if(t){var e=t.split("_"),n=Number(e[1]),r=Number(e[2]);$("#tooltipClusteringResults").css("display","none"),Mh(n,r)}}}},{key:"onClickSilhouetteBarChart",value:function(){return function(){if($t.target){var t=$t.target.classList[1];Fb(Number(t.split("_")[1]))}}}},{key:"onDoubleClickSilhouetteBarChart",value:function(){return function(){var t=$t.target.id;if(t){var e=t.split("_"),n=Number(e[1]),r=this.subsequences[n];$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(r.id,[r.dataPoints[0].z,r.dataPoints[r.dataPoints.length-1].z])}}}},{key:"onMouseOverSilhouetteBarChart",value:function(){return function(){var t=$t.target.id;if(t){var e,n,r=$("#tooltipClusteringResults"),i=$("#tooltipClusteringResultsTable"),a=t.split("_"),o=Number(a[1]),s=this.subsequences[o],l=Ju.getFileName(s.id),u=[s.dataPoints[0].z,s.dataPoints[s.dataPoints.length-1].z],c=s.dataPoints.length,h=window.pageYOffset,d=$("#clusteringResults").offset();if(h<d.top)if(e=$t.clientX-d.left+5,$t.clientY<$("#clusteringResults").height()/2)n=$t.clientY-(d.top-h)+5;else{var f=0===r.height()?230:r.height();n=$t.clientY-(d.top-h)-f-5}else if(e=$t.clientX-d.left+5,$t.clientY<$("#clusteringOverviewMDSScatterplots").height()/2)n=$t.clientY+5;else{var p=0===r.height()?230:r.height();n=$t.clientY-p-5}i.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+l+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(u[0])+"-"+Sd(u[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+c+"</td></tr></tbody></table>"),r.css({left:e+"px",top:n+"px",right:"unset",bottom:"unset"}),r.css("display","block");var m=[void 0,void 0];o-1>=0&&this.subsequences[o-1].id===this.subsequences[o].id&&(m[0]="object"===n_(this.SSLabels[o-1])?this.SSLabels[o-1].cluster:this.SSLabels[o-1]),o+1<this.SSLabels.length&&this.subsequences[o].id===this.subsequences[o+1].id&&(m[1]="object"===n_(this.SSLabels[o+1])?this.SSLabels[o+1].cluster:this.SSLabels[o+1]),Eh(s.id,s.idx,u,m),jb(s.id,u)}}}},{key:"onMouseOutSilhouetteBarChart",value:function(){return function(){var t=$t.target.id;if(t){var e=t.split("_"),n=Number(e[1]);$("#tooltipClusteringResults").css("display","none"),Mh(this.subsequences[n].id,this.subsequences[n].idx)}}}},{key:"onMouseOverClusterCentersMDS",value:function(){return function(){var t=$t.target.id;if(t){var e=Number(t.split("_")[1]);this.hulls[e].style("visibility","visible"),Us("circle.dataPointsMDS").style("opacity",.3),Us("circle.clusterCentersMDS").style("opacity",.3),Us("circle.dataPointsMDS_"+e).style("opacity",1),se("#clusterCentersMDS_"+e).style("opacity",1)}}}},{key:"onMouseOutClusterCentersMDS",value:function(){return function(){var t=$t.target.id;if(t){var e=Number(t.split("_")[1]);this.hulls[e].style("visibility","hidden"),Us("circle.dataPointsMDS").style("opacity",1),Us("circle.clusterCentersMDS").style("opacity",1)}}}},{key:"onClickClusterCentersMDS",value:function(){return function(){if($t.target){var t=$t.target.id;Fb(Number(t.split("_")[1]))}}}},{key:"setMDSScatterplotsSize",value:function(){var t=this;if($("#clusteringOverviewMDSScatterplotsSVG").length){var e=$("#clusteringResultsOverview").width(),n=$("#appHeader").outerHeight(!0),r=$("#clusteringTimeline").outerHeight(!0),i=window.innerHeight-n-r,a={left:30,right:30,top:30,bottom:30};this.MDSSPSvg.attr("width",e*this.chartsSize.MDS.width-45).attr("height",i*this.chartsSize.MDS.height),this.xScale.range([a.left,e*this.chartsSize.MDS.width-45-a.right]),this.yScale.range([i*this.chartsSize.MDS.height-a.bottom,a.top]),this.dataPlots.attr("cx",function(t){return this.xScale(t[0])}.bind(this)).attr("cy",function(t){return this.yScale(t[1])}.bind(this)),this.clusterCenterPlots.attr("cx",function(t){return this.xScale(t[0])}.bind(this)).attr("cy",function(t){return this.yScale(t[1])}.bind(this)),this.clusterNameLabels.attr("x",function(t){return this.xScale(t[0])}.bind(this)).attr("y",function(t){return this.yScale(t[1])+16}.bind(this));for(var o=[],s=0;s<this.SSClusterCoords.length;s++){o.push([]);for(var l=0;l<this.SSClusterCoords[s].length;l++)o[s].push([this.xScale(this.SSClusterCoords[s][l][0]),this.yScale(this.SSClusterCoords[s][l][1])])}for(var u=0;u<this.hulls.length;u++){var c=$i(o[u]);this.hulls[u].attr("d",null===c?null:"M"+c.join("L")+"Z")}for(var h=new Array(this.clusterCenters.length).fill(0),d=0;d<this.SSLabels.length;d++){var f="object"===n_(this.SSLabels[d])?this.SSLabels[d].cluster:this.SSLabels[d];h[f]++}if(this.clusterSummaryBarChart.attr("x",function(t,n){for(var r=0,i=0;i<n;i++)r+=h[i];return r*(e*this.chartsSize.MDS.width-45)/this.SSLabels.length}.bind(this)).attr("y",5).attr("width",function(t){return t*(e*this.chartsSize.MDS.width-45)/this.SSLabels.length}.bind(this)),this.SilhouetteSVG.attr("width",e*this.chartsSize.barChart.width-45).attr("height",i*this.chartsSize.barChart.height),this.xScaleSilhouette.range([0,e*this.chartsSize.barChart.width-45-a.left-a.right/2]),this.xLabelSilhouette.attr("transform","translate("+a.left+","+(i*this.chartsSize.barChart.height-a.bottom)+")").call(V(this.xScaleSilhouette).ticks(5).tickSize(-i*this.chartsSize.barChart.height+a.top/2+a.bottom)),this.yScaleSilhouette.range([a.top/2,i*this.chartsSize.barChart.height-a.bottom]),this.SilhouetteBars.selectAll("rect.SilhouetteBar").attr("width",function(t){return this.xScaleSilhouette(t.silhouette)}.bind(this)).attr("y",function(t){return this.yScaleSilhouette(t.order)}.bind(this)).attr("height",this.yScaleSilhouette.bandwidth()),this.silhouetteVerticalLine.attr("x1",this.xScaleSilhouette(this.state.clusteringScores.silhouette)+a.left).attr("y1",a.top/2).attr("x2",this.xScaleSilhouette(this.state.clusteringScores.silhouette)+a.left).attr("y2",i*this.chartsSize.barChart.height-a.bottom),$("#elbowMethodLineChart").length>0&&(this.elbowMethodLineChartSVG.attr("width",e*this.chartsSize.elbowLineChart.width-45).attr("height",i*this.chartsSize.elbowLineChart.height),this.xScaleSSE.range([1.5*a.left,e*this.chartsSize.elbowLineChart.width-45-a.right/2]),this.xLabelSSE.attr("transform","translate(0,"+(i*this.chartsSize.elbowLineChart.height-a.bottom)+")").call(V(this.xScaleSSE).ticks(Object.keys(zc.getSSEClusters()).length)),this.yScaleSSE.range([i*this.chartsSize.elbowLineChart.height-a.bottom,a.top/2]),this.yLabelSSE.call(j(this.yScaleSSE).ticks(5)),se("#elbowMethodLineChartPath").attr("d",Qs().x(function(t){return this.xScaleSSE(t.clusterNum)}.bind(this)).y(function(t){return this.yScaleSSE(t.SSE)}.bind(this))),se("g#elbowMethodLineChartPlotGroup").selectAll("circle").attr("cx",function(t){return this.xScaleSSE(t.clusterNum)}.bind(this)).attr("cy",function(t){return this.yScaleSSE(t.SSE)}.bind(this)),se("#elbowMethodLineChartXLabel").attr("x",1.5*a.left+(e*this.chartsSize.elbowLineChart.width-45-1.5*a.left)/2).attr("y",i*this.chartsSize.elbowLineChart.height-8),se("#elbowMethodLineChartYLabel").attr("x",-1*(i*this.chartsSize.elbowLineChart.height-a.bottom)/2),se("#elbowMethodLineChartFocusedV").attr("y2",i*this.chartsSize.elbowLineChart.height-a.bottom),se("#elbowMethodLineChartFocusedH").attr("x2",e*this.chartsSize.elbowLineChart.width-45-a.right)),$("#clusterFeatureHeatmap").length>0){this.featureHeatmapSVG.attr("width",e*this.chartsSize.featureHeatmap.width-45).attr("height",i*this.chartsSize.featureHeatmap.height),this.xScaleFeatureHeatmap.range([1.5*a.left,e*this.chartsSize.featureHeatmap.width-45-a.right/2]),this.xLabelFeatureHeatmap.attr("transform","translate(0,"+(i*this.chartsSize.featureHeatmap.height-a.bottom)+")").call(V(this.xScaleFeatureHeatmap)),this.yScaleFeatureHeatmap.range([2*a.top/3,i*this.chartsSize.featureHeatmap.height-a.bottom]),this.yLabelFeatureHeatmap.call(j(this.yScaleFeatureHeatmap));for(var p=function(e){Us("rect.featureHeatmapRect_"+e).attr("x",function(t){return this.xScaleFeatureHeatmap(e)}.bind(t)).attr("y",function(t,e){return this.yScaleFeatureHeatmap(t)}.bind(t)).attr("width",t.xScaleFeatureHeatmap.bandwidth()).attr("height",t.yScaleFeatureHeatmap.bandwidth())},m=0;m<this.clusterCenters.length;m++)p(m);se("#featureHeatmapXLabel").attr("x",1.5*a.left+(e*this.chartsSize.featureHeatmap.width-45-1.5*a.left)/2).attr("y",i*this.chartsSize.featureHeatmap.height-8),se("#featureHeatmapYLabel").attr("x",-1*(i*this.chartsSize.featureHeatmap.height-a.bottom)/2);var g=(e*this.chartsSize.featureHeatmap.width-45-1.5*a.left-a.right/2)/2/this.clusterCenters.length;Us("rect.featureHeatmapLegendRect").attr("x",function(t){return(e*this.chartsSize.featureHeatmap.width-45)/2+t*g}.bind(this)).attr("width",g),se("#featureHeatmapLegendLabelSmall").attr("x",(e*this.chartsSize.featureHeatmap.width-45)/2-15),se("#featureHeatmapLegendLabelLarge").attr("x",e*this.chartsSize.featureHeatmap.width-45-a.right/2-2)}}}}])&&r_(e.prototype,n),r&&r_(e,r),o}(i.a.Component);function u_(t){return(u_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c_(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return h_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h_(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h_(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f_(t,e){return(f_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g_(t);if(e){var i=g_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m_(this,n)}}function m_(t,e){return!e||"object"!==u_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g_(t){return(g_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var v_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f_(t,e)}(o,t);var e,n,r,a=p_(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:10,right:10,top:10,bottom:20},t.areaPadding={left:16,right:16,top:8,bottom:8},t.steps=[],t.filteringProcess={},t.yMinMax={},t.updateSparklineTableFlag=!1,t.updataUpdatedSSSparklineTableFlag=!1,t.filteringStepColors=[Hs(1),Hs(.8),Hs(.6),Hs(.4),Hs(.2)],t.filteringNames={normalSlidingWindow:"Normal sliding window",dataDrivenSlidingWindow:"Data-driven sliding window",sameStartingPoint:"Same starting data point",overlappingDegree:"Overlapping degree"},t.state={subsequencesFilteringProcess:[],selectedProcess:"",selectedSS:{},updatedSS:{}},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;zc.on("showClusteringResults",(function(){t.filteringProcess=zc.getFilteringProcess(),t.steps=Object.keys(t.filteringProcess),t.steps=t.steps.filter((function(t){return"subsequences"!==t})),t.steps.sort(function(t,e){var n=0;for(var r in this.filteringProcess[t])n+=this.filteringProcess[t][r].length;var i=0;for(var a in this.filteringProcess[e])i+=this.filteringProcess[e][a].length;return n<i?1:-1}.bind(t)),t.datasetsIdx=zc.getDatasets(),t.variables=zc.getClusteringParameters().variables,t.variables=t.variables.filter((function(t){return"z"!==t})),t.clusterColors=zc.getClusterColors(),t.subsequences=zc.getSubsequences(),t.labels=zc.getLabels(),t.createVariableLabels(),t.filteringSummary(),t.initSparklines(),t.setState({selectedSS:zc.getSelectedSS(),updatedSS:zc.getUpdatedSS()})})),zc.on("showFilteringStep",(function(e){t.updateSparklineTableFlag=!0,t.updataUpdatedSSSparklineTableFlag=!0,t.setState({selectedProcess:e})})),zc.on("updateSSSelection",(function(){t.updataUpdatedSSSparklineTableFlag=!0,t.setState({selectedSS:zc.getSelectedSS(),updatedSS:zc.getUpdatedSS()})})),zc.on("recoverClusteringSession",(function(){}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringProcess");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"componentDidUpdate",value:function(){this.drawSparklinesOfSubsequencesInTheSelectedStep(),this.checkCurrentlySelectedSS(),this.drawSparklinesOfUpdatedSubsequences()}},{key:"render",value:function(){var t,e,n=this;return""!==this.state.selectedProcess?(t=this.subsequencesInTheSelectedStepTable(),e=this.updatedSubsequencesTable()):this.updataUpdatedSSSparklineTableFlag&&(e=this.updatedSubsequencesTable()),i.a.createElement("div",{id:"clusteringProcess",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)-$("#clusteringResultsLeftColumnNavTabs").outerHeight(!0)},ref:function(t){n.mount=t}},i.a.createElement("div",{id:"filteringProcessSummary",className:"resultAreaElem"},i.a.createElement("svg",{id:"filteringProcessSummarySVG"})),i.a.createElement("div",{id:"SSFilteringStep",className:"resultAreaElem"},i.a.createElement("h6",null,"Subsequences in the selected filtering step"),t),i.a.createElement("div",{id:"selectedSSList",className:"resultAreaElem"},i.a.createElement("h6",null,"Subsequences that will be ",i.a.createElement("span",{style:{color:"#80b139"}},"added"),"/",i.a.createElement("span",{style:{color:"#d9534f"}},"removed")),e),i.a.createElement("div",{id:"updateClusteringControllers",className:"resultAreaElem",style:{float:"right"}},i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",style:{float:"right"},onClick:this.onClickRunClusteringAgainButton().bind(this)},"Run again"),i.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",style:{float:"right"},onClick:this.onClickClearButton().bind(this)},"Clear")))}},{key:"initSparklines",value:function(){var t=this;this.yMinMax={};for(var e=0;e<this.variables.length;e++)this.yMinMax[this.variables[e]]=[1/0,-1/0];for(var n in this.filteringProcess.subsequences)for(var r=0;r<this.filteringProcess.subsequences[n].length;r++)for(var i=0;i<this.filteringProcess.subsequences[n][r].length;i++)for(var a=0;a<this.variables.length;a++)this.filteringProcess.subsequences[n][r][i][this.variables[a]]<this.yMinMax[this.variables[a]][0]&&(this.yMinMax[this.variables[a]][0]=this.filteringProcess.subsequences[n][r][i][this.variables[a]]),this.yMinMax[this.variables[a]][1]<this.filteringProcess.subsequences[n][r][i][this.variables[a]]&&(this.yMinMax[this.variables[a]][1]=this.filteringProcess.subsequences[n][r][i][this.variables[a]]);for(var o=($("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right-30)/this.variables.length-6,s=[0,zc.getSubsequenceParameters().isometryLen],l=Na().range([1,o-1]).domain(s),u={},c={},h=function(e){u[t.variables[e]]=Na().range([23,1]).domain(t.yMinMax[t.variables[e]]).nice(),c[t.variables[e]]=Qs().x((function(t,e){return l(e)})).y(function(t){return u[this.variables[e]](t[this.variables[e]])}.bind(t)).curve(ul.alpha(1))},d=0;d<this.variables.length;d++)h(d);this.xScale=l,this.yScales=u,this.curves=c}},{key:"createVariableLabels",value:function(){for(var t={},e=0;e<this.datasetsIdx.length;e++){var n=Ju.getData(this.datasetsIdx[e]).data.lookup;for(var r in n)if(r in t)for(var i=0;i<n[r].length;i++)t[r].indexOf(n[r][i])<0&&t[r].push(n[r][i]);else t[r]=n[r]}this.variableLabels=t}},{key:"filteringSummary",value:function(){$("#filteringProcessSummarySVG").children().remove();for(var t=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,e=t-this.margin.left-this.margin.right,n=Math.sqrt(3)*e/2,r=n*this.steps.length/(this.steps.length+1)+this.margin.top+this.margin.bottom,i=.5*e/(this.steps.length+1),a=n/(this.steps.length+1),o=se("#filteringProcessSummarySVG").attr("height",r).attr("width",t),s=0;s<this.steps.length;s++){var l=e*(this.steps.length+1-s)/(this.steps.length+1),u=e*(this.steps.length+1-s-1)/(this.steps.length+1),c=[{x:i*s,y:a*s},{x:i*(s+1),y:a*(s+1)},{x:i*(s+1)+u,y:a*(s+1)},{x:i*s+l,y:a*s},{x:i*s,y:a*s}],h=o.append("g").attr("class","filteringTrapezoidGroup");0!==s&&h.on("click",g),h.append("path").datum(c).attr("class","filteringTrapezoid").attr("id","filteringTrapezoid_"+this.steps[s]).attr("d",Qs().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",this.filteringStepColors[s]).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),h.append("text").attr("x",t/2).attr("y",a*s+a/2+this.margin.top).text(this.filteringNames[this.steps[s]]).attr("fill","white").attr("text-anchor","middle").attr("text-weight","bold").attr("height",a).attr("width",u).attr("class","filteringProcessLabel")}for(var d=0;d<this.steps.length;d++){var f=0;for(var p in this.filteringProcess[this.steps[d]])f+=this.filteringProcess[this.steps[d]][p].length;var m=o.append("g").attr("class","filteredSSLabelGroup");m.append("rect").attr("id","filteredSSNumRect_"+this.steps[d]).attr("x",t/2-25).attr("y",a*(d+1)-10+this.margin.top).attr("width",50).attr("height",20).attr("fill","white").attr("class","filteredSSRect"),m.append("text").attr("id","filteredSSNumLabel_"+this.steps[d]).attr("x",t/2).attr("y",a*(d+1)+6+this.margin.top).text(f).attr("fill","#3e3f3a").attr("text-anchor","middle").attr("class","filteredSSNumber").attr("font-size","1rem")}function g(){var t=$("path",this),e=$("text",this),n=t.attr("fill"),r=e.attr("fill");if("white"===n)t.attr("fill",r).attr("stroke-width",0),e.attr("fill","white"),Bb("");else{for(var i=$(this).parent().children("g.filteringTrapezoidGroup"),a=0;a<i.length;a++){var o=i[a].children[0],s=i[a].children[1];"white"===$(o).attr("fill")&&($(o).attr("fill",$(s).attr("fill")).attr("stroke-width",0),$(s).attr("fill","white"))}e.attr("fill",n),t.attr("fill","white").attr("stroke",n).attr("stroke-width","1.5px"),Bb(t.attr("id").split("_")[1])}}}},{key:"subsequencesInTheSelectedStepTable",value:function(){var t=this.steps[this.steps.indexOf(this.state.selectedProcess)-1],e=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,n=(this.mount.clientHeight-$("#filteringProcessSummary").height())/2,r=(e-30)/this.variables.length,a=[];a.push("");for(var o=0;o<this.variables.length;o++)this.variableLabels[this.variables[o]].length>1?a.push(this.variableLabels[this.variables[o]].join(", ")):a.push(this.variableLabels[this.variables[o]]);for(var s=[],l=0;l<a.length;l++)s.push(i.a.createElement("th",{key:l,style:{width:0===l?30:r,height:30}},a[l]));var u=i.a.createElement("thead",{style:{width:e,height:30},id:"subsequencesFilteringProcessTableHeader"},i.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},s)),c=[];this.yMinMax={};for(var h=0;h<this.variables.length;h++)this.yMinMax[this.variables[h]]=[1/0,-1/0];for(var d in this.filteringProcess[t])for(var f=0;f<this.filteringProcess[t][d].length;f++){var p=[],m=this.filteringProcess[t][d][f];p.push(i.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},i.a.createElement("input",{type:"checkbox",className:"subsequenceFilteringCheckbox",name:"subsequenceSelector",id:"selectSSFilteringProcess_"+d+"_"+m,onClick:this.onClickSSSelector().bind(this)})));for(var g=0;g<this.variables.length;g++){p.push(i.a.createElement("td",{key:this.variables[g],id:"subsequenceTd_"+d+"_"+m+"_"+this.variables[g],style:{width:r,height:30}}));for(var v=0;v<this.filteringProcess.subsequences[d][m].length;v++)this.filteringProcess.subsequences[d][m][v][this.variables[g]]<this.yMinMax[this.variables[g]][0]&&(this.yMinMax[this.variables[g]][0]=this.filteringProcess.subsequences[d][m][v][this.variables[g]]),this.yMinMax[this.variables[g]][1]<this.filteringProcess.subsequences[d][m][v][this.variables[g]]&&(this.yMinMax[this.variables[g]][1]=this.filteringProcess.subsequences[d][m][v][this.variables[g]])}c.push(i.a.createElement("tr",{id:"subsequenceTr_"+d+"_"+m,className:"subsequenceTr",key:"subsequenceTr_"+d+"_"+m,style:{width:e,height:30},onMouseOver:this.onMouseOverFilteringStepSSRow().bind(this),onMouseOut:this.onMouseOutFilteringStepSSRow().bind(this),onClick:this.onClickFilteringStepSSRow().bind(this),onDoubleClick:this.onDoubleClickFilteringStepSSRow().bind(this)},p))}return i.a.createElement("table",{id:"subsequencesFilteringProcessTable",className:"table table-hover sparkTable",style:{width:e,height:n}},u,i.a.createElement("tbody",{id:"subsequencesFilteringProcessTableBody",style:{height:n-30}},c))}},{key:"updatedSubsequencesTable",value:function(){var t=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right,e=(this.mount.clientHeight,$("#filteringProcessSummary").height(),(t-30)/this.variables.length),n=[];n.push("");for(var r=0;r<this.variables.length;r++)this.variableLabels[this.variables[r]].length>1?n.push(this.variableLabels[this.variables[r]].join(", ")):n.push(this.variableLabels[this.variables[r]]);for(var a=[],o=0;o<n.length;o++)a.push(i.a.createElement("th",{key:o,style:{width:0===o?30:e,height:30}},n[o]));var s=i.a.createElement("thead",{style:{width:t,height:30},id:"updatedSubsequencesTableHeader"},i.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},a)),l=[];for(var u in this.state.updatedSS)for(var c=0;c<this.state.updatedSS[u].length;c++){var h=[],d=this.state.updatedSS[u][c].idx;h.push(i.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},i.a.createElement("input",{type:"checkbox",className:"subsequenceCheckbox",name:"subsequenceSelector",id:"selectUpdatedSSFilteringProcess_"+u+"_"+d,onClick:this.onClickUpdatedSSSelector().bind(this)})));for(var f=0;f<this.variables.length;f++)h.push(i.a.createElement("td",{key:this.variables[f],id:"updatedSubsequenceTd_"+u+"_"+d+"_"+this.variables[f],style:{width:e,height:30}}));l.push(i.a.createElement("tr",{id:"updatedSubsequenceTr_"+u+"_"+d,className:"updatedSubsequenceTr",key:"updatedSubsequenceTr_"+u+"_"+d,style:{width:t,height:30},onMouseOver:this.onMouseOverUpdatedSSRow().bind(this),onMouseOut:this.onMouseOutUpdatedSSRow().bind(this),onClick:this.onClickUpdatedSSRow().bind(this),onDoubleClick:this.onDoubleClickUpdatedSSRow().bind(this)},h))}return i.a.createElement("table",{id:"updatedSubsequencesTable",className:"table table-hover sparkTable",style:{width:t}},s,i.a.createElement("tbody",{id:"updatedSubsequencesTableBody"},l))}},{key:"onClickSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]),a=$("#"+t.target.id).prop("checked"),o=!(this.filteringProcess[this.steps[this.steps.length-1]][r].indexOf(i)<0);if(a){var s=this.state.selectedSS;s[r].push(i);var l=this.state.updatedSS;if(o){for(var u=0;u<l[r].length;u++)if(l[r][u].idx===i){l[r].splice(u,1),se("#subsequenceTr_"+r+"_"+i).classed("table-danger",!1);break}}else l[r].push({idx:i,status:"add"}),se("#subsequenceTr_"+r+"_"+i).classed("table-success",!0);this.updataUpdatedSSSparklineTableFlag=!0,this.setState({selectedSS:s,updatedSS:l})}else{var c=this.state.selectedSS;c[r].splice(c[r].indexOf(i),1);var h=this.state.updatedSS;if(o)h[r].push({idx:i,status:"remove"}),se("#subsequenceTr_"+r+"_"+i).classed("table-danger",!0);else for(var d=0;d<h[r].length;d++)if(h[r][d].idx===i){h[r].splice(d,1),se("#subsequenceTr_"+r+"_"+i).classed("table-success",!1);break}this.updataUpdatedSSSparklineTableFlag=!0,Vb(c,h),this.setState({selectedSS:c,updatedSS:h})}}}}},{key:"onClickUpdatedSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]),a=$("#"+t.target.id).prop("checked"),o=!(this.filteringProcess[this.steps[this.steps.length-1]][r].indexOf(i)<0);if(a){var s=this.state.selectedSS;s[r].push(i);var l=this.state.updatedSS;if(o){for(var u=0;u<l[r].length;u++)if(l[r][u].idx===i){l[r].splice(u,1),se("#subsequenceTr_"+r+"_"+i).classed("table-danger",!1);break}}else l[r].push({idx:i,status:"add"}),se("#subsequenceTr_"+r+"_"+i).classed("table-success",!0);this.updataUpdatedSSSparklineTableFlag=!0,Vb(s,l),this.setState({selectedSS:s,updatedSS:l})}else{var c=this.state.selectedSS;c[r].splice(c[r].indexOf(i),1);var h=this.state.updatedSS;if(o)h[r].push({idx:i,status:"remove"}),se("#subsequenceTr_"+r+"_"+i).classed("table-danger",!0);else for(var d=0;d<h[r].length;d++)if(h[r][d].idx===i){h[r].splice(d,1),se("#subsequenceTr_"+r+"_"+i).classed("table-success",!1);break}this.updataUpdatedSSSparklineTableFlag=!0,Vb(c,h),this.setState({selectedSS:c,updatedSS:h})}}}}},{key:"onClickRunClusteringAgainButton",value:function(){return function(){var t=[];for(var e in this.state.selectedSS){this.state.selectedSS[e].sort((function(t,e){return t-e}));for(var n=0;n<this.state.selectedSS[e].length;n++)t.push(this.filteringProcess.subsequences[e][this.state.selectedSS[e][n]])}var r=c_(function(t,e,n){var r=e.variables.slice();r.push("z");var i,a,o,s,l,u,c,h,d={window:e.window,metric:e.distanceMetric,distFunc:Ib};switch(e.method){case"kmedoids":c=[];for(var f=0;f<e.clusterNum;f++){c.push([]);for(var p=0;p<e.clusterNum;p++)c[f].push(0)}if("unified"===e.medoidDefinition){var m=cb(kb(t,e.clusterNum,d,r,e.maxTrial,e.elbow),6);i=m[0],a=m[1],o=m[2],s=m[3],l=m[4],h=m[5];for(var g=0;g<e.clusterNum-1;g++)for(var v=g+1;v<e.clusterNum;v++)c[g][v]=l[a[g]][a[v]],c[v][g]=l[a[v]][a[g]]}else if("each"===e.medoidDefinition){var y=cb(Tb(t,e.clusterNum,d,r,e.maxTrial,e.elbow),6);i=y[0],a=y[1],o=y[2],s=y[3],l=y[4],h=y[5];for(var b=function(t){for(var n=function(n){var r=0;e.variables.forEach((function(e){"z"!==e&&(r+=l[a[t][e]][a[n][e]][e])})),c[t][n]=r,c[n][t]=r},r=t+1;r<e.clusterNum;r++)n(r)},x=0;x<e.clusterNum-1;x++)b(x);for(var _=0;_<t.length;_++){var w=new Array(e.clusterNum).fill(0);l[_]=l[_].concat(w)}for(var S=0;S<e.clusterNum;S++)l.push(new Array(t.length+e.clusterNum).fill(0));for(var E=0;E<e.clusterNum;E++)for(var M=0;M<t.length;M++){var C=0;for(var T in a[E])C+=l[M][a[E][T]][T];l[M][t.length+E]=C,l[t.length+E][M]=C}for(var k=0;k<e.clusterNum-1;k++)for(var P=k+1;P<e.clusterNum;P++)l[t.length+k][t.length+P]=c[k][P],l[t.length+P][t.length+k]=c[k][P];for(var A=0;A<t.length-1;A++){l[A][A]=0;for(var O=A+1;O<t.length;O++){var N=0;for(var R in l[A][O])N+=l[A][O][R];l[A][O]=N,l[O][A]=N}}l[t.length-1][t.length-1]=0}break;case"kmeans":var L=cb(Pb(t,e.clusterNum,d,r,e.maxTrial,e.elbow),7);i=L[0],o=L[1],s=L[2],l=L[3],u=L[4],c=L[5],h=L[6];for(var I=0;I<e.clusterNum;I++){l.push([]);for(var D=0;D<t.length;D++)l[D].push(0),l[t.length+I].push(0);for(var z=0;z<e.clusterNum;z++)l[t.length+I].push(0)}for(var F=0;F<t.length;F++)for(var B=0;B<e.clusterNum;B++)l[F][t.length+B]=u[F][B],l[t.length+B][F]=u[F][B];for(var V=0;V<e.clusterNum-1;V++)for(var j=V+1;j<e.clusterNum;j++)l[t.length+V][t.length+j]=c[V][j],l[t.length+j][t.length+V]=c[V][j]}var H=Cb(t,d,e.variables,n),U=mb(o,e.clusterNum);return s.pseudoF=gb(s.clusterRadiuses,i,H,U.map((function(t){return t.length})),d,e.variables),[i,o,s,{clustersCoord:zb(c),dataCoord:zb(l),medoidIdx:a},h]}(t,zc.getClusteringParameters(),zc.getSubsequenceParameters().isometryLen),4),i=r[0],a=r[1],o=r[2],s=r[3],l=0,u=0;for(var c in this.state.updatedSS)for(var h=0;h<this.state.updatedSS[c].length;h++)"add"===this.state.updatedSS[c][h].status&&l++,"remove"===this.state.updatedSS[c][h].status&&u++;var d=0;for(var f in this.filteringProcess[this.steps[this.steps.length-1]])d+=this.filteringProcess[this.steps[this.steps.length-1]][f].length;var p=d;l>0&&(p+=' <tspan style="fill:#80b139">+'+l+"</tspan>"),u>0&&(p+=' <tspan style="fill:#d9534f">-'+u+"</tspan>");var m=se("#filteredSSNumLabel_"+this.steps[this.steps.length-1]);m.html(p);var g=m.node().getBBox().width,v=$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right;se("#filteredSSNumRect_"+this.steps[this.steps.length-1]).attr("x",v/2-g/2).attr("width",g),function(t,e,n,r,i,a,o){hu.dispatch({type:"UPDATE_CLUSTERING_RESULTS",subsequences:t,clusterCenters:e,labels:n,clusteringScores:r,selectedSS:i,updatedSS:a,resultsCoordinates:o})}(t,i,a,o,this.state.selectedSS,this.state.updatedSS,s)}}},{key:"onClickClearButton",value:function(){return function(){this.setState({selectedSS:{},updatedSS:{},selectedProcess:""}),this.filteringSummary(),hu.dispatch({type:"RESET_CLUSTERING_RESULTS"})}}},{key:"onMouseOverFilteringStepSSRow",value:function(){return function(t){var e=this,n=t.target.id;n&&function(){for(var r=n.split("_"),i=Number(r[1]),a=Number(r[2]),o=e.xScale.domain(),s=zc.getSubsequenceParameters(),l=Ju.getData(i).data.meta,u=e.filteringProcess.subsequences[i][a],c=function(t){se("#subsequenceSVG_"+i+"_"+a+"_"+e.variables[t]).select("g").selectAll("circle").data(u.dataPoints).enter().append("circle").attr("cx",function(t){var e=(t.z-u.dataPoints[0].z)/(u.dataPoints[u.dataPoints.length-1].z-u.dataPoints[0].z)*o[1];return this.xScale(e)}.bind(e)).attr("cy",function(e){var n=e[this.variables[t]];return s.normalize||(n=(n-l.mean[this.variables[t]])/l.std[this.variables[t]]),this.yScales[this.variables[t]](n)}.bind(e)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},h=0;h<e.variables.length;h++)c(h);var d=$("#tooltipClusteringResults"),f=$("#tooltipClusteringResultsTable"),p=Ju.getFileName(i),m=[u.dataPoints[0].z,u.dataPoints[u.dataPoints.length-1].z],g=u.dataPoints.length,v=t.clientX+15,y=window.innerHeight-t.clientY+5;f.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+p+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(m[0])+"-"+Sd(m[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+g+"</td></tr></tbody></table>"),d.css({left:v+"px",top:"unset",right:"unset",bottom:y+"px"}),d.css("display","block");var b=0,x=!1;for(b=0;b<e.subsequences.length;b++)if(e.subsequences[b].id===i&&e.subsequences[b].idx===a){x=!0;break}var _=[void 0,void 0];x&&(b-1>=0&&e.subsequences[b-1].id===e.subsequences[b].id&&(_[0]="object"===u_(e.labels[b-1])?e.labels[b-1].cluster:e.labels[b-1]),b+1<e.labels.length&&e.subsequences[b].id===e.subsequences[b+1].id&&(_[1]="object"===u_(e.labels[b+1])?e.labels[b+1].cluster:e.labels[b+1])),Eh(i,a,m,_),jb(i,m)}()}}},{key:"onMouseOutFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n=e.split("_"),r=Number(n[1]),i=Number(n[2]),a=0;a<this.variables.length;a++)se("#subsequenceSVG_"+r+"_"+i+"_"+this.variables[a]).select("g").selectAll("circle").remove();$("#tooltipClusteringResults").css("display","none"),Mh(r,i)}}}},{key:"onClickFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]);if(e.indexOf("selectSSFilteringProcess_")<0){var a=document.getElementById("subsequenceTr_"+r+"_"+i).classList;if(a.length>0)for(var o=0;o<a.length;o++)if(a[o].indexOf("subsequenceTrCluster")>=0){var s=a[o].split("_");Fb(Number(s[1]))}}}}}},{key:"onDoubleClickFilteringStepSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n,r=e.split("_"),i=Number(r[1]),a=Number(r[2]),o=0;o<this.filteringProcess.subsequences[i].length;o++)if(this.filteringProcess.subsequences[i][o].id===i&&this.filteringProcess.subsequences[i][o].idx===a){n=this.filteringProcess.subsequences[i][o];break}$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(i,[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"onMouseOverUpdatedSSRow",value:function(){return function(t){var e=this,n=t.target.id;n&&function(){for(var r=n.split("_"),i=Number(r[1]),a=Number(r[2]),o=e.xScale.domain(),s=zc.getSubsequenceParameters(),l=Ju.getData(i).data.meta,u=e.filteringProcess.subsequences[i][a],c=function(t){se("#updateSubsequenceSVG_"+i+"_"+a+"_"+e.variables[t]).select("g").selectAll("circle").data(u.dataPoints).enter().append("circle").attr("cx",function(t){var e=(t.z-u.dataPoints[0].z)/(u.dataPoints[u.dataPoints.length-1].z-u.dataPoints[0].z)*o[1];return this.xScale(e)}.bind(e)).attr("cy",function(e){var n=e[this.variables[t]];return s.normalize||(n=(n-l.mean[this.variables[t]])/l.std[this.variables[t]]),this.yScales[this.variables[t]](n)}.bind(e)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},h=0;h<e.variables.length;h++)c(h);var d=$("#tooltipClusteringResults"),f=$("#tooltipClusteringResultsTable"),p=Ju.getFileName(i),m=[u.dataPoints[0].z,u.dataPoints[u.dataPoints.length-1].z],g=u.dataPoints.length,v=t.clientX+15,y=window.innerHeight-t.clientY+5;f.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+p+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(m[0])+"-"+Sd(m[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+g+"</td></tr></tbody></table>"),d.css({left:v+"px",top:"unset",right:"unset",bottom:y+"px"}),d.css("display","block");var b=0,x=!1;for(b=0;b<e.subsequences.length;b++)if(e.subsequences[b].id===i&&e.subsequences[b].idx===a){x=!0;break}var _=[void 0,void 0];x&&(b-1>=0&&e.subsequences[b-1].id===e.subsequences[b].id&&(_[0]="object"===u_(e.labels[b-1])?e.labels[b-1].cluster:e.labels[b-1]),b+1<e.labels.length&&e.subsequences[b].id===e.subsequences[b+1].id&&(_[1]="object"===u_(e.labels[b+1])?e.labels[b+1].cluster:e.labels[b+1])),Eh(i,a,m,_),jb(i,m)}()}}},{key:"onMouseOutUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n=e.split("_"),r=Number(n[1]),i=Number(n[2]),a=0;a<this.variables.length;a++)se("#updateSubsequenceSVG_"+r+"_"+i+"_"+this.variables[a]).select("g").selectAll("circle").remove();$("#tooltipClusteringResults").css("display","none"),Mh(r,i)}}}},{key:"onClickUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]);if(e.indexOf("selectUpdatedSSFilteringProcess_")<0){var a=document.getElementById("updatedSubsequenceTr_"+r+"_"+i).classList;if(a.length>0)for(var o=0;o<a.length;o++)if(a[o].indexOf("updatedSubsequenceTrCluster")>=0){var s=a[o].split("_");Fb(Number(s[1]))}}}}}},{key:"onDoubleClickUpdatedSSRow",value:function(){return function(t){var e=t.target.id;if(e){for(var n,r=e.split("_"),i=Number(r[1]),a=Number(r[2]),o=0;o<this.filteringProcess.subsequences[i].length;o++)if(this.filteringProcess.subsequences[i][o].id===i&&this.filteringProcess.subsequences[i][o].idx===a){n=this.filteringProcess.subsequences[i][o];break}$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(i,[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}},{key:"drawSparklinesOfSubsequencesInTheSelectedStep",value:function(){var t=this;if(this.state.selectedProcess&&this.updateSparklineTableFlag){$("#subsequencesFilteringProcessTable svg").remove();var e=this.steps.indexOf(this.state.selectedProcess),n=this.steps[this.steps.indexOf(this.state.selectedProcess)-1],r=($("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right-30)/this.variables.length-6;for(var i in this.filteringProcess[n])for(var a=0;a<this.filteringProcess[n][i].length;a++)for(var o=this.filteringProcess[n][i][a],s=this.filteringProcess.subsequences[i][o],l=function(n){for(var a=se("#subsequenceTd_"+i+"_"+o+"_"+t.variables[n]).append("svg").attr("id","subsequenceSVG_"+i+"_"+o+"_"+t.variables[n]).attr("class","spark").attr("width",r).attr("height",24),l=t.filteringProcess[t.state.selectedProcess][i].indexOf(o)<0?t.filteringStepColors[e-1]:t.filteringStepColors[e],u=0;u<t.subsequences.length;u++)if(t.subsequences[u].id===Number(i)&&t.subsequences[u].idx===o){l="object"===u_(t.labels[u])?Be(t.clusterColors[t.labels[u].cluster][0],t.clusterColors[t.labels[u].cluster][1],t.clusterColors[t.labels[u].cluster][2]):Be(t.clusterColors[t.labels[u]][0],t.clusterColors[t.labels[u]][1],t.clusterColors[t.labels[u]][2]);var c="";c="object"===u_(t.labels[u])?"subsequenceTrCluster_"+t.labels[u].cluster:"subsequenceTrCluster_"+t.labels[u],se("#subsequenceTr_"+i+"_"+o).classed(c,!0);break}a.append("g").datum(s).append("path").attr("fill","none").attr("stroke",l).attr("stroke-width",1.5).attr("d",function(t,e){return this.curves[this.variables[n]](t)}.bind(t))},u=0;u<this.variables.length;u++)l(u);this.updateSparklineTableFlag=!1}}},{key:"drawSparklinesOfUpdatedSubsequences",value:function(){var t=this;if(this.updataUpdatedSSSparklineTableFlag){$("#updatedSubsequencesTable svg").remove();var e=this.steps.indexOf(this.state.selectedProcess),n=(this.steps[this.steps.indexOf(this.state.selectedProcess)-1],$("#clusteringProcess").width()-this.areaPadding.left-this.areaPadding.right),r=.3*(this.mount.clientHeight-$("#filteringProcessSummary").height()),i=(n-30)/this.variables.length-6,a=0;for(var o in Object.keys(this.state.updatedSS).forEach(function(t){a+=this.state.updatedSS[t].length}.bind(this)),se("#updatedSubsequencesTable").attr("height",Math.min(r,30*(a+1))),se("#updatedSubsequencesTableBody").attr("height",Math.min(r-30,30*a)),this.state.updatedSS)for(var s=0;s<this.state.updatedSS[o].length;s++)for(var l=this.state.updatedSS[o][s].idx,u=this.filteringProcess.subsequences[o][l],c=function(n){var r="add"===t.state.updatedSS[o][s].status?"table-success":"table-danger";se("#updatedSubsequenceTr_"+o+"_"+l).classed(r,!0),se("#subsequenceTr_"+o+"_"+l).classed(r,!0);var a=se("#updatedSubsequenceTd_"+o+"_"+l+"_"+t.variables[n]).append("svg").attr("id","updateSubsequenceSVG_"+o+"_"+l+"_"+t.variables[n]).attr("class","spark").attr("width",i).attr("height",24),c=void 0;c=t.state.selectedProcess?t.filteringProcess[t.state.selectedProcess][o].indexOf(l)<0?t.filteringStepColors[e-1]:t.filteringStepColors[e]:t.filteringStepColors[t.steps.length-1];for(var h=0;h<t.subsequences.length;h++)if(t.subsequences[h].id===Number(o)&&t.subsequences[h].idx===l){c="object"===u_(t.labels[h])?Be(t.clusterColors[t.labels[h].cluster][0],t.clusterColors[t.labels[h].cluster][1],t.clusterColors[t.labels[h].cluster][2]):Be(t.clusterColors[t.labels[h]][0],t.clusterColors[t.labels[h]][1],t.clusterColors[t.labels[h]][2]);var d="updatedSubsequenceTrCluster_"+t.labels[h];se("#updatedSubsequenceTr_"+o+"_"+l).classed(d,!0);break}a.append("g").datum(u).append("path").attr("fill","none").attr("stroke",c).attr("stroke-width",1.5).attr("d",function(t,e){return this.curves[this.variables[n]](t)}.bind(t))},h=0;h<this.variables.length;h++)c(h);this.updataUpdatedSSSparklineTableFlag=!1}}},{key:"checkCurrentlySelectedSS",value:function(){if(this.state.selectedProcess){for(var t in $(".subsequenceFilteringCheckbox").prop("checked",!1),this.state.selectedSS)for(var e=0;e<this.state.selectedSS[t].length;e++)$("#selectSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).prop("checked",!0),$("#selectUpdatedSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).length&&$("#selectUpdatedSSFilteringProcess_"+t+"_"+this.state.selectedSS[t][e]).prop("checked",!0);for(var n in this.state.updatedSS)for(var r=0;r<this.state.updatedSS[n].length;r++){var i="add"===this.state.updatedSS[n][r].status?"table-success":"table-danger";se("#subsequenceTr_"+n+"_"+this.state.updatedSS[n][r].idx).attr("class","").classed(i,!0)}}}}])&&d_(e.prototype,n),r&&d_(e,r),o}(i.a.Component);
/**!
 * Sortable 1.13.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function y_(t){return(y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x_(){return(x_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function __(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){b_(t,e,n[e])}))}return t}function w_(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function S_(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var E_=S_(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),M_=S_(/Edge/i),C_=S_(/firefox/i),T_=S_(/safari/i)&&!S_(/chrome/i)&&!S_(/android/i),k_=S_(/iP(ad|od|hone)/i),P_=S_(/chrome/i)&&S_(/android/i),A_={capture:!1,passive:!1};function O_(t,e,n){t.addEventListener(e,n,!E_&&A_)}function N_(t,e,n){t.removeEventListener(e,n,!E_&&A_)}function R_(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return!1}return!1}}function L_(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function I_(t,e,n,r){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&R_(t,e):R_(t,e))||r&&t===n)return t;if(t===n)break}while(t=L_(t))}return null}var D_,z_=/\s+/g;function F_(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(z_," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(z_," ")}}function B_(t,e,n){var r=t&&t.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in r||-1!==e.indexOf("webkit")||(e="-webkit-"+e),r[e]=n+("string"==typeof n?"":"px")}}function V_(t,e){var n="";if("string"==typeof t)n=t;else do{var r=B_(t,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function j_(t,e,n){if(t){var r=t.getElementsByTagName(e),i=0,a=r.length;if(n)for(;i<a;i++)n(r[i],i);return r}return[]}function H_(){var t=document.scrollingElement;return t||document.documentElement}function U_(t,e,n,r,i){if(t.getBoundingClientRect||t===window){var a,o,s,l,u,c,h;if(t!==window&&t.parentNode&&t!==H_()?(o=(a=t.getBoundingClientRect()).top,s=a.left,l=a.bottom,u=a.right,c=a.height,h=a.width):(o=0,s=0,l=window.innerHeight,u=window.innerWidth,c=window.innerHeight,h=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!E_))do{if(i&&i.getBoundingClientRect&&("none"!==B_(i,"transform")||n&&"static"!==B_(i,"position"))){var d=i.getBoundingClientRect();o-=d.top+parseInt(B_(i,"border-top-width")),s-=d.left+parseInt(B_(i,"border-left-width")),l=o+a.height,u=s+a.width;break}}while(i=i.parentNode);if(r&&t!==window){var f=V_(i||t),p=f&&f.a,m=f&&f.d;f&&(l=(o/=m)+(c/=m),u=(s/=p)+(h/=p))}return{top:o,left:s,bottom:l,right:u,width:h,height:c}}}function G_(t,e,n){for(var r=Q_(t,!0),i=U_(t)[e];r;){var a=U_(r)[n];if(!("top"===n||"left"===n?i>=a:i<=a))return r;if(r===H_())break;r=Q_(r,!1)}return!1}function q_(t,e,n){for(var r=0,i=0,a=t.children;i<a.length;){if("none"!==a[i].style.display&&a[i]!==Jw.ghost&&a[i]!==Jw.dragged&&I_(a[i],n.draggable,t,!1)){if(r===e)return a[i];r++}i++}return null}function W_(t,e){for(var n=t.lastElementChild;n&&(n===Jw.ghost||"none"===B_(n,"display")||e&&!R_(n,e));)n=n.previousElementSibling;return n||null}function $_(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Jw.clone||e&&!R_(t,e)||n++;return n}function Y_(t){var e=0,n=0,r=H_();if(t)do{var i=V_(t),a=i.a,o=i.d;e+=t.scrollLeft*a,n+=t.scrollTop*o}while(t!==r&&(t=t.parentNode));return[e,n]}function Q_(t,e){if(!t||!t.getBoundingClientRect)return H_();var n=t,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=B_(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return H_();if(r||e)return n;r=!0}}}while(n=n.parentNode);return H_()}function X_(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function Z_(t,e){return function(){if(!D_){var n=arguments,r=this;1===n.length?t.call(r,n[0]):t.apply(r,n),D_=setTimeout((function(){D_=void 0}),e)}}}function J_(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function K_(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}var tw="Sortable"+(new Date).getTime();function ew(){var t,e=[];return{captureAnimationState:function(){(e=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(t){if("none"!==B_(t,"display")&&t!==Jw.ghost){e.push({target:t,rect:U_(t)});var n=__({},e[e.length-1].rect);if(t.thisAnimationDuration){var r=V_(t,!0);r&&(n.top-=r.f,n.left-=r.e)}t.fromRect=n}}))},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(function(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[n][r])return Number(n);return-1}(e,{target:t}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(t),void("function"==typeof n&&n());var i=!1,a=0;e.forEach((function(t){var e=0,n=t.target,o=n.fromRect,s=U_(n),l=n.prevFromRect,u=n.prevToRect,c=t.rect,h=V_(n,!0);h&&(s.top-=h.f,s.left-=h.e),n.toRect=s,n.thisAnimationDuration&&X_(l,s)&&!X_(o,s)&&(c.top-s.top)/(c.left-s.left)==(o.top-s.top)/(o.left-s.left)&&(e=function(t,e,n,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*r.animation}(c,l,u,r.options)),X_(s,o)||(n.prevFromRect=o,n.prevToRect=s,e||(e=r.options.animation),r.animate(n,c,s,e)),e&&(i=!0,a=Math.max(a,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),i?t=setTimeout((function(){"function"==typeof n&&n()}),a):"function"==typeof n&&n(),e=[]},animate:function(t,e,n,r){if(r){B_(t,"transition",""),B_(t,"transform","");var i=V_(this.el),a=i&&i.a,o=i&&i.d,s=(e.left-n.left)/(a||1),l=(e.top-n.top)/(o||1);t.animatingX=!!s,t.animatingY=!!l,B_(t,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(t){return t.offsetWidth}(t),B_(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),B_(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){B_(t,"transition",""),B_(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),r)}}}}var nw=[],rw={initializeByDefault:!0},iw={mount:function(t){for(var e in rw)rw.hasOwnProperty(e)&&!(e in t)&&(t[e]=rw[e]);nw.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),nw.push(t)},pluginEvent:function(t,e,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var i=t+"Global";nw.forEach((function(r){e[r.pluginName]&&(e[r.pluginName][i]&&e[r.pluginName][i](__({sortable:e},n)),e.options[r.pluginName]&&e[r.pluginName][t]&&e[r.pluginName][t](__({sortable:e},n)))}))},initializePlugins:function(t,e,n,r){for(var i in nw.forEach((function(r){var i=r.pluginName;if(t.options[i]||r.initializeByDefault){var a=new r(t,e,t.options);a.sortable=t,a.options=t.options,t[i]=a,x_(n,a.defaults)}})),t.options)if(t.options.hasOwnProperty(i)){var a=this.modifyOption(t,i,t.options[i]);void 0!==a&&(t.options[i]=a)}},getEventProperties:function(t,e){var n={};return nw.forEach((function(r){"function"==typeof r.eventProperties&&x_(n,r.eventProperties.call(e[r.pluginName],t))})),n},modifyOption:function(t,e,n){var r;return nw.forEach((function(i){t[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[e]&&(r=i.optionListeners[e].call(t[i.pluginName],n))})),r}};function aw(t){var e=t.sortable,n=t.rootEl,r=t.name,i=t.targetEl,a=t.cloneEl,o=t.toEl,s=t.fromEl,l=t.oldIndex,u=t.newIndex,c=t.oldDraggableIndex,h=t.newDraggableIndex,d=t.originalEvent,f=t.putSortable,p=t.extraEventProperties;if(e=e||n&&n[tw]){var m,g=e.options,v="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||E_||M_?(m=document.createEvent("Event")).initEvent(r,!0,!0):m=new CustomEvent(r,{bubbles:!0,cancelable:!0}),m.to=o||n,m.from=s||n,m.item=i||n,m.clone=a,m.oldIndex=l,m.newIndex=u,m.oldDraggableIndex=c,m.newDraggableIndex=h,m.originalEvent=d,m.pullMode=f?f.lastPutMode:void 0;var y=__({},p,iw.getEventProperties(r,e));for(var b in y)m[b]=y[b];n&&n.dispatchEvent(m),g[v]&&g[v].call(e,m)}}var ow=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,i=w_(n,["evt"]);iw.pluginEvent.bind(Jw)(t,e,__({dragEl:lw,parentEl:uw,ghostEl:cw,rootEl:hw,nextEl:dw,lastDownEl:fw,cloneEl:pw,cloneHidden:mw,dragStarted:kw,putSortable:_w,activeSortable:Jw.active,originalEvent:r,oldIndex:gw,oldDraggableIndex:yw,newIndex:vw,newDraggableIndex:bw,hideGhostForTarget:Yw,unhideGhostForTarget:Qw,cloneNowHidden:function(){mw=!0},cloneNowShown:function(){mw=!1},dispatchSortableEvent:function(t){sw({sortable:e,name:t,originalEvent:r})}},i))};function sw(t){aw(__({putSortable:_w,cloneEl:pw,targetEl:lw,rootEl:hw,oldIndex:gw,oldDraggableIndex:yw,newIndex:vw,newDraggableIndex:bw},t))}var lw,uw,cw,hw,dw,fw,pw,mw,gw,vw,yw,bw,xw,_w,ww,Sw,Ew,Mw,Cw,Tw,kw,Pw,Aw,Ow,Nw,Rw=!1,Lw=!1,Iw=[],Dw=!1,zw=!1,Fw=[],Bw=!1,Vw=[],jw="undefined"!=typeof document,Hw=k_,Uw=M_||E_?"cssFloat":"float",Gw=jw&&!P_&&!k_&&"draggable"in document.createElement("div"),qw=function(){if(jw){if(E_)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),Ww=function(t,e){var n=B_(t),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=q_(t,0,e),a=q_(t,1,e),o=i&&B_(i),s=a&&B_(a),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+U_(i).width,u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+U_(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&"none"!==o.float){var c="left"===o.float?"left":"right";return!a||"both"!==s.clear&&s.clear!==c?"horizontal":"vertical"}return i&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=r&&"none"===n[Uw]||a&&"none"===n[Uw]&&l+u>r)?"vertical":"horizontal"},$w=function(t){function e(t,n){return function(r,i,a,o){var s=r.options.group.name&&i.options.group.name&&r.options.group.name===i.options.group.name;if(null==t&&(n||s))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"==typeof t)return e(t(r,i,a,o),n)(r,i,a,o);var l=(n?r:i).options.group.name;return!0===t||"string"==typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var n={},r=t.group;r&&"object"==y_(r)||(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n},Yw=function(){!qw&&cw&&B_(cw,"display","none")},Qw=function(){!qw&&cw&&B_(cw,"display","")};jw&&document.addEventListener("click",(function(t){if(Lw)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Lw=!1,!1}),!0);var Xw=function(t){if(lw){t=t.touches?t.touches[0]:t;var e=(i=t.clientX,a=t.clientY,Iw.some((function(t){if(!W_(t)){var e=U_(t),n=t[tw].options.emptyInsertThreshold,r=i>=e.left-n&&i<=e.right+n,s=a>=e.top-n&&a<=e.bottom+n;return n&&r&&s?o=t:void 0}})),o);if(e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[tw]._onDragOver(n)}}var i,a,o},Zw=function(t){lw&&lw.parentNode[tw]._isOutsideThisEl(t.target)};function Jw(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=x_({},e),t[tw]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ww(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Jw.supportPointer&&"PointerEvent"in window&&!T_,emptyInsertThreshold:5};for(var r in iw.initializePlugins(this,t,n),n)!(r in e)&&(e[r]=n[r]);for(var i in $w(e),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!e.forceFallback&&Gw,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?O_(t,"pointerdown",this._onTapStart):(O_(t,"mousedown",this._onTapStart),O_(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(O_(t,"dragover",this),O_(t,"dragenter",this)),Iw.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),x_(this,ew())}function Kw(t,e,n,r,i,a,o,s){var l,u,c=t[tw],h=c.options.onMove;return!window.CustomEvent||E_||M_?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=n,l.draggedRect=r,l.related=i||e,l.relatedRect=a||U_(e),l.willInsertAfter=s,l.originalEvent=o,t.dispatchEvent(l),h&&(u=h.call(c,l,o)),u}function tS(t){t.draggable=!1}function eS(){Bw=!1}function nS(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;n--;)r+=e.charCodeAt(n);return r.toString(36)}function rS(t){return setTimeout(t,0)}function iS(t){return clearTimeout(t)}Jw.prototype={constructor:Jw,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(Pw=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,lw):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,r=this.options,i=r.preventOnFilter,a=t.type,o=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(o||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,u=r.filter;if(function(t){Vw.length=0;var e=t.getElementsByTagName("input"),n=e.length;for(;n--;){var r=e[n];r.checked&&Vw.push(r)}}(n),!lw&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||r.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!T_||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=I_(s,r.draggable,n,!1))&&s.animated||fw===s)){if(gw=$_(s),yw=$_(s,r.draggable),"function"==typeof u){if(u.call(this,t,s,this))return sw({sortable:e,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),ow("filter",e,{evt:t}),void(i&&t.cancelable&&t.preventDefault())}else if(u&&(u=u.split(",").some((function(r){if(r=I_(l,r.trim(),n,!1))return sw({sortable:e,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),ow("filter",e,{evt:t}),!0}))))return void(i&&t.cancelable&&t.preventDefault());r.handle&&!I_(l,r.handle,n,!1)||this._prepareDragStart(t,o,s)}}},_prepareDragStart:function(t,e,n){var r,i=this,a=i.el,o=i.options,s=a.ownerDocument;if(n&&!lw&&n.parentNode===a){var l=U_(n);if(hw=a,uw=(lw=n).parentNode,dw=lw.nextSibling,fw=n,xw=o.group,Jw.dragged=lw,ww={target:lw,clientX:(e||t).clientX,clientY:(e||t).clientY},Cw=ww.clientX-l.left,Tw=ww.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,lw.style["will-change"]="all",r=function(){ow("delayEnded",i,{evt:t}),Jw.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!C_&&i.nativeDraggable&&(lw.draggable=!0),i._triggerDragStart(t,e),sw({sortable:i,name:"choose",originalEvent:t}),F_(lw,o.chosenClass,!0))},o.ignore.split(",").forEach((function(t){j_(lw,t.trim(),tS)})),O_(s,"dragover",Xw),O_(s,"mousemove",Xw),O_(s,"touchmove",Xw),O_(s,"mouseup",i._onDrop),O_(s,"touchend",i._onDrop),O_(s,"touchcancel",i._onDrop),C_&&this.nativeDraggable&&(this.options.touchStartThreshold=4,lw.draggable=!0),ow("delayStart",this,{evt:t}),!o.delay||o.delayOnTouchOnly&&!e||this.nativeDraggable&&(M_||E_))r();else{if(Jw.eventCanceled)return void this._onDrop();O_(s,"mouseup",i._disableDelayedDrag),O_(s,"touchend",i._disableDelayedDrag),O_(s,"touchcancel",i._disableDelayedDrag),O_(s,"mousemove",i._delayedDragTouchMoveHandler),O_(s,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&O_(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(r,o.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){lw&&tS(lw),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;N_(t,"mouseup",this._disableDelayedDrag),N_(t,"touchend",this._disableDelayedDrag),N_(t,"touchcancel",this._disableDelayedDrag),N_(t,"mousemove",this._delayedDragTouchMoveHandler),N_(t,"touchmove",this._delayedDragTouchMoveHandler),N_(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?O_(document,"pointermove",this._onTouchMove):O_(document,e?"touchmove":"mousemove",this._onTouchMove):(O_(lw,"dragend",this),O_(hw,"dragstart",this._onDragStart));try{document.selection?rS((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){if(Rw=!1,hw&&lw){ow("dragStarted",this,{evt:e}),this.nativeDraggable&&O_(document,"dragover",Zw);var n=this.options;!t&&F_(lw,n.dragClass,!1),F_(lw,n.ghostClass,!0),Jw.active=this,t&&this._appendGhost(),sw({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(Sw){this._lastX=Sw.clientX,this._lastY=Sw.clientY,Yw();for(var t=document.elementFromPoint(Sw.clientX,Sw.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(Sw.clientX,Sw.clientY))!==e;)e=t;if(lw.parentNode[tw]._isOutsideThisEl(t),e)do{if(e[tw]){if(e[tw]._onDragOver({clientX:Sw.clientX,clientY:Sw.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);Qw()}},_onTouchMove:function(t){if(ww){var e=this.options,n=e.fallbackTolerance,r=e.fallbackOffset,i=t.touches?t.touches[0]:t,a=cw&&V_(cw,!0),o=cw&&a&&a.a,s=cw&&a&&a.d,l=Hw&&Nw&&Y_(Nw),u=(i.clientX-ww.clientX+r.x)/(o||1)+(l?l[0]-Fw[0]:0)/(o||1),c=(i.clientY-ww.clientY+r.y)/(s||1)+(l?l[1]-Fw[1]:0)/(s||1);if(!Jw.active&&!Rw){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(cw){a?(a.e+=u-(Ew||0),a.f+=c-(Mw||0)):a={a:1,b:0,c:0,d:1,e:u,f:c};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");B_(cw,"webkitTransform",h),B_(cw,"mozTransform",h),B_(cw,"msTransform",h),B_(cw,"transform",h),Ew=u,Mw=c,Sw=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!cw){var t=this.options.fallbackOnBody?document.body:hw,e=U_(lw,!0,Hw,!0,t),n=this.options;if(Hw){for(Nw=t;"static"===B_(Nw,"position")&&"none"===B_(Nw,"transform")&&Nw!==document;)Nw=Nw.parentNode;Nw!==document.body&&Nw!==document.documentElement?(Nw===document&&(Nw=H_()),e.top+=Nw.scrollTop,e.left+=Nw.scrollLeft):Nw=H_(),Fw=Y_(Nw)}F_(cw=lw.cloneNode(!0),n.ghostClass,!1),F_(cw,n.fallbackClass,!0),F_(cw,n.dragClass,!0),B_(cw,"transition",""),B_(cw,"transform",""),B_(cw,"box-sizing","border-box"),B_(cw,"margin",0),B_(cw,"top",e.top),B_(cw,"left",e.left),B_(cw,"width",e.width),B_(cw,"height",e.height),B_(cw,"opacity","0.8"),B_(cw,"position",Hw?"absolute":"fixed"),B_(cw,"zIndex","100000"),B_(cw,"pointerEvents","none"),Jw.ghost=cw,t.appendChild(cw),B_(cw,"transform-origin",Cw/parseInt(cw.style.width)*100+"% "+Tw/parseInt(cw.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,i=n.options;ow("dragStart",this,{evt:t}),Jw.eventCanceled?this._onDrop():(ow("setupClone",this),Jw.eventCanceled||((pw=K_(lw)).draggable=!1,pw.style["will-change"]="",this._hideClone(),F_(pw,this.options.chosenClass,!1),Jw.clone=pw),n.cloneId=rS((function(){ow("clone",n),Jw.eventCanceled||(n.options.removeCloneOnHide||hw.insertBefore(pw,lw),n._hideClone(),sw({sortable:n,name:"clone"}))})),!e&&F_(lw,i.dragClass,!0),e?(Lw=!0,n._loopId=setInterval(n._emulateDragOver,50)):(N_(document,"mouseup",n._onDrop),N_(document,"touchend",n._onDrop),N_(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(n,r,lw)),O_(document,"drop",n),B_(lw,"transform","translateZ(0)")),Rw=!0,n._dragStartId=rS(n._dragStarted.bind(n,e,t)),O_(document,"selectstart",n),kw=!0,T_&&B_(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,r,i,a=this.el,o=t.target,s=this.options,l=s.group,u=Jw.active,c=xw===l,h=s.sort,d=_w||u,f=this,p=!1;if(!Bw){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),o=I_(o,s.draggable,a,!0),k("dragOver"),Jw.eventCanceled)return p;if(lw.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||f._ignoreWhileAnimating===o)return A(!1);if(Lw=!1,u&&!s.disabled&&(c?h||(r=!hw.contains(lw)):_w===this||(this.lastPutMode=xw.checkPull(this,u,lw,t))&&l.checkPut(this,u,lw,t))){if(i="vertical"===this._getDirection(t,o),e=U_(lw),k("dragOverValid"),Jw.eventCanceled)return p;if(r)return uw=hw,P(),this._hideClone(),k("revert"),Jw.eventCanceled||(dw?hw.insertBefore(lw,dw):hw.appendChild(lw)),A(!0);var m=W_(a,s.draggable);if(!m||function(t,e,n){var r=U_(W_(n.el,n.options.draggable));return e?t.clientX>r.right+10||t.clientX<=r.right&&t.clientY>r.bottom&&t.clientX>=r.left:t.clientX>r.right&&t.clientY>r.top||t.clientX<=r.right&&t.clientY>r.bottom+10}(t,i,this)&&!m.animated){if(m===lw)return A(!1);if(m&&a===t.target&&(o=m),o&&(n=U_(o)),!1!==Kw(hw,a,lw,e,o,n,t,!!o))return P(),a.appendChild(lw),uw=a,O(),A(!0)}else if(o.parentNode===a){n=U_(o);var g,v,y,b=lw.parentNode!==a,x=!function(t,e,n){var r=n?t.left:t.top,i=n?t.right:t.bottom,a=n?t.width:t.height,o=n?e.left:e.top,s=n?e.right:e.bottom,l=n?e.width:e.height;return r===o||i===s||r+a/2===o+l/2}(lw.animated&&lw.toRect||e,o.animated&&o.toRect||n,i),_=i?"top":"left",w=G_(o,"top","top")||G_(lw,"top","top"),S=w?w.scrollTop:void 0;if(Pw!==o&&(v=n[_],Dw=!1,zw=!x&&s.invertSwap||b),0!==(g=function(t,e,n,r,i,a,o,s){var l=r?t.clientY:t.clientX,u=r?n.height:n.width,c=r?n.top:n.left,h=r?n.bottom:n.right,d=!1;if(!o)if(s&&Ow<u*i){if(!Dw&&(1===Aw?l>c+u*a/2:l<h-u*a/2)&&(Dw=!0),Dw)d=!0;else if(1===Aw?l<c+Ow:l>h-Ow)return-Aw}else if(l>c+u*(1-i)/2&&l<h-u*(1-i)/2)return function(t){return $_(lw)<$_(t)?1:-1}(e);if((d=d||o)&&(l<c+u*a/2||l>h-u*a/2))return l>c+u/2?1:-1;return 0}(t,o,n,i,x?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,zw,Pw===o))){var E=$_(lw);do{E-=g,y=uw.children[E]}while(y&&("none"===B_(y,"display")||y===cw))}if(0===g||y===o)return A(!1);Pw=o,Aw=g;var M=o.nextElementSibling,C=!1,T=Kw(hw,a,lw,e,o,n,t,C=1===g);if(!1!==T)return 1!==T&&-1!==T||(C=1===T),Bw=!0,setTimeout(eS,30),P(),C&&!M?a.appendChild(lw):o.parentNode.insertBefore(lw,C?M:o),w&&J_(w,0,S-w.scrollTop),uw=lw.parentNode,void 0===v||zw||(Ow=Math.abs(v-U_(o)[_])),O(),A(!0)}if(a.contains(lw))return A(!1)}return!1}function k(s,l){ow(s,f,__({evt:t,isOwner:c,axis:i?"vertical":"horizontal",revert:r,dragRect:e,targetRect:n,canSort:h,fromSortable:d,target:o,completed:A,onMove:function(n,r){return Kw(hw,a,lw,e,n,U_(n),t,r)},changed:O},l))}function P(){k("dragOverAnimationCapture"),f.captureAnimationState(),f!==d&&d.captureAnimationState()}function A(e){return k("dragOverCompleted",{insertion:e}),e&&(c?u._hideClone():u._showClone(f),f!==d&&(F_(lw,_w?_w.options.ghostClass:u.options.ghostClass,!1),F_(lw,s.ghostClass,!0)),_w!==f&&f!==Jw.active?_w=f:f===Jw.active&&_w&&(_w=null),d===f&&(f._ignoreWhileAnimating=o),f.animateAll((function(){k("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(o===lw&&!lw.animated||o===a&&!o.animated)&&(Pw=null),s.dragoverBubble||t.rootEl||o===document||(lw.parentNode[tw]._isOutsideThisEl(t.target),!e&&Xw(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),p=!0}function O(){vw=$_(lw),bw=$_(lw,s.draggable),sw({sortable:f,name:"change",toEl:a,newIndex:vw,newDraggableIndex:bw,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){N_(document,"mousemove",this._onTouchMove),N_(document,"touchmove",this._onTouchMove),N_(document,"pointermove",this._onTouchMove),N_(document,"dragover",Xw),N_(document,"mousemove",Xw),N_(document,"touchmove",Xw)},_offUpEvents:function(){var t=this.el.ownerDocument;N_(t,"mouseup",this._onDrop),N_(t,"touchend",this._onDrop),N_(t,"pointerup",this._onDrop),N_(t,"touchcancel",this._onDrop),N_(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;vw=$_(lw),bw=$_(lw,n.draggable),ow("drop",this,{evt:t}),uw=lw&&lw.parentNode,vw=$_(lw),bw=$_(lw,n.draggable),Jw.eventCanceled||(Rw=!1,zw=!1,Dw=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),iS(this.cloneId),iS(this._dragStartId),this.nativeDraggable&&(N_(document,"drop",this),N_(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),T_&&B_(document.body,"user-select",""),B_(lw,"transform",""),t&&(kw&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),cw&&cw.parentNode&&cw.parentNode.removeChild(cw),(hw===uw||_w&&"clone"!==_w.lastPutMode)&&pw&&pw.parentNode&&pw.parentNode.removeChild(pw),lw&&(this.nativeDraggable&&N_(lw,"dragend",this),tS(lw),lw.style["will-change"]="",kw&&!Rw&&F_(lw,_w?_w.options.ghostClass:this.options.ghostClass,!1),F_(lw,this.options.chosenClass,!1),sw({sortable:this,name:"unchoose",toEl:uw,newIndex:null,newDraggableIndex:null,originalEvent:t}),hw!==uw?(vw>=0&&(sw({rootEl:uw,name:"add",toEl:uw,fromEl:hw,originalEvent:t}),sw({sortable:this,name:"remove",toEl:uw,originalEvent:t}),sw({rootEl:uw,name:"sort",toEl:uw,fromEl:hw,originalEvent:t}),sw({sortable:this,name:"sort",toEl:uw,originalEvent:t})),_w&&_w.save()):vw!==gw&&vw>=0&&(sw({sortable:this,name:"update",toEl:uw,originalEvent:t}),sw({sortable:this,name:"sort",toEl:uw,originalEvent:t})),Jw.active&&(null!=vw&&-1!==vw||(vw=gw,bw=yw),sw({sortable:this,name:"end",toEl:uw,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){ow("nulling",this),hw=lw=uw=cw=dw=pw=fw=mw=ww=Sw=kw=vw=bw=gw=yw=Pw=Aw=_w=xw=Jw.dragged=Jw.ghost=Jw.clone=Jw.active=null,Vw.forEach((function(t){t.checked=!0})),Vw.length=Ew=Mw=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":lw&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,r=0,i=n.length,a=this.options;r<i;r++)I_(t=n[r],a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||nS(t));return e},sort:function(t,e){var n={},r=this.el;this.toArray().forEach((function(t,e){var i=r.children[e];I_(i,this.options.draggable,r,!1)&&(n[t]=i)}),this),e&&this.captureAnimationState(),t.forEach((function(t){n[t]&&(r.removeChild(n[t]),r.appendChild(n[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return I_(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var r=iw.modifyOption(this,t,e);n[t]=void 0!==r?r:e,"group"===t&&$w(n)},destroy:function(){ow("destroy",this);var t=this.el;t[tw]=null,N_(t,"mousedown",this._onTapStart),N_(t,"touchstart",this._onTapStart),N_(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(N_(t,"dragover",this),N_(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Iw.splice(Iw.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!mw){if(ow("hideClone",this),Jw.eventCanceled)return;B_(pw,"display","none"),this.options.removeCloneOnHide&&pw.parentNode&&pw.parentNode.removeChild(pw),mw=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(mw){if(ow("showClone",this),Jw.eventCanceled)return;lw.parentNode!=hw||this.options.group.revertClone?dw?hw.insertBefore(pw,dw):hw.appendChild(pw):hw.insertBefore(pw,lw),this.options.group.revertClone&&this.animate(lw,pw),B_(pw,"display",""),mw=!1}}else this._hideClone()}},jw&&O_(document,"touchmove",(function(t){(Jw.active||Rw)&&t.cancelable&&t.preventDefault()})),Jw.utils={on:O_,off:N_,css:B_,find:j_,is:function(t,e){return!!I_(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},throttle:Z_,closest:I_,toggleClass:F_,clone:K_,index:$_,nextTick:rS,cancelNextTick:iS,detectDirection:Ww,getChild:q_},Jw.get=function(t){return t[tw]},Jw.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Jw.utils=__({},Jw.utils,t.utils)),iw.mount(t)}))},Jw.create=function(t,e){return new Jw(t,e)},Jw.version="1.13.0";var aS,oS,sS,lS,uS,cS,hS=[],dS=!1;function fS(){hS.forEach((function(t){clearInterval(t.pid)})),hS=[]}function pS(){clearInterval(cS)}var mS=Z_((function(t,e,n,r){if(e.scroll){var i,a=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,u=H_(),c=!1;oS!==n&&(oS=n,fS(),aS=e.scroll,i=e.scrollFn,!0===aS&&(aS=Q_(n,!0)));var h=0,d=aS;do{var f=d,p=U_(f),m=p.top,g=p.bottom,v=p.left,y=p.right,b=p.width,x=p.height,_=void 0,w=void 0,S=f.scrollWidth,E=f.scrollHeight,M=B_(f),C=f.scrollLeft,T=f.scrollTop;f===u?(_=b<S&&("auto"===M.overflowX||"scroll"===M.overflowX||"visible"===M.overflowX),w=x<E&&("auto"===M.overflowY||"scroll"===M.overflowY||"visible"===M.overflowY)):(_=b<S&&("auto"===M.overflowX||"scroll"===M.overflowX),w=x<E&&("auto"===M.overflowY||"scroll"===M.overflowY));var k=_&&(Math.abs(y-a)<=s&&C+b<S)-(Math.abs(v-a)<=s&&!!C),P=w&&(Math.abs(g-o)<=s&&T+x<E)-(Math.abs(m-o)<=s&&!!T);if(!hS[h])for(var A=0;A<=h;A++)hS[A]||(hS[A]={});hS[h].vx==k&&hS[h].vy==P&&hS[h].el===f||(hS[h].el=f,hS[h].vx=k,hS[h].vy=P,clearInterval(hS[h].pid),0==k&&0==P||(c=!0,hS[h].pid=setInterval(function(){r&&0===this.layer&&Jw.active._onTouchMove(uS);var e=hS[this.layer].vy?hS[this.layer].vy*l:0,n=hS[this.layer].vx?hS[this.layer].vx*l:0;"function"==typeof i&&"continue"!==i.call(Jw.dragged.parentNode[tw],n,e,t,uS,hS[this.layer].el)||J_(hS[this.layer].el,n,e)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&d!==u&&(d=Q_(d,!1)));dS=c}}),30),gS=function(t){var e=t.originalEvent,n=t.putSortable,r=t.dragEl,i=t.activeSortable,a=t.dispatchSortableEvent,o=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(e){var l=n||i;o();var u=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,c=document.elementFromPoint(u.clientX,u.clientY);s(),l&&!l.el.contains(c)&&(a("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function vS(){}function yS(){}vS.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=q_(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:gS},x_(vS,{pluginName:"revertOnSpill"}),yS.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable||this.sortable;n.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),n.animateAll()},drop:gS},x_(yS,{pluginName:"removeOnSpill"});Jw.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?O_(document,"dragover",this._handleAutoScroll):this.options.supportPointer?O_(document,"pointermove",this._handleFallbackAutoScroll):e.touches?O_(document,"touchmove",this._handleFallbackAutoScroll):O_(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?N_(document,"dragover",this._handleAutoScroll):(N_(document,"pointermove",this._handleFallbackAutoScroll),N_(document,"touchmove",this._handleFallbackAutoScroll),N_(document,"mousemove",this._handleFallbackAutoScroll)),pS(),fS(),clearTimeout(D_),D_=void 0},nulling:function(){uS=oS=aS=dS=cS=sS=lS=null,hS.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,r=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=document.elementFromPoint(r,i);if(uS=t,e||M_||E_||T_){mS(t,this.options,a,e);var o=Q_(a,!0);!dS||cS&&r===sS&&i===lS||(cS&&pS(),cS=setInterval((function(){var a=Q_(document.elementFromPoint(r,i),!0);a!==o&&(o=a,fS()),mS(t,n.options,a,e)}),10),sS=r,lS=i)}else{if(!this.options.bubbleScroll||Q_(a,!0)===H_())return void fS();mS(t,this.options,Q_(a,!1),!1)}}},x_(t,{pluginName:"scroll",initializeByDefault:!0})}),Jw.mount(yS,vS);var bS=Jw;function xS(t){return(xS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wS(t,e){return(wS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function SS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=MS(t);if(e){var i=MS(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ES(this,n)}}function ES(t,e){return!e||"object"!==xS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function MS(t){return(MS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var CS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wS(t,e)}(o,t);var e,n,r,a=SS(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).cardPadding=4,e.SSId=t.SSId,e}return e=o,(n=[{key:"render",value:function(){var t=$("#clusteringSubsequenceComparison").width()-Number($("#clusteringSubsequenceComparison").css("padding-left").replace("px",""))-Number($("#clusteringSubsequenceComparison").css("padding-right").replace("px",""))-2*this.cardPadding;return i.a.createElement("div",{className:"card border-light mb-1",style:{maxWidth:"20rem"}},i.a.createElement("div",{className:"card-header cardHeaderSubsequenceComparison"},i.a.createElement("div",{className:"hamburger",onMouseDown:this.onMouseDownSubsequenceView().bind(this)},i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null)),i.a.createElement("span",{className:"subsequenceComparisonViewFileName"},Ju.getFileName(this.props.dataId)),i.a.createElement("span",{className:"subsequenceComparisonViewPeriod"},Sd(this.props.period[0]),"",Sd(this.props.period[1])),i.a.createElement("button",{type:"button",className:"ml-2 mb-1 close",id:"closeSubsequenceFromComparisonPanel_"+this.props.SSId,"aria-label":"Close",onClick:this.onClickCloseSubsequenceView().bind(this)},i.a.createElement("span",{"aria-hidden":"true"},""))),i.a.createElement("div",{className:"card-body cardBodySubsequenceComparison"},i.a.createElement("canvas",{className:"subsequenceComparisonCanvas",id:"subsequenceComparisonCanvas_"+this.props.SSId,width:"500",height:"500",style:{width:t,height:t}})))}},{key:"onClickCloseSubsequenceView",value:function(){return function(t){var e;e=this.SSId,hu.dispatch({type:"REMOVE_SELECTED_SUBSEQUENCE_FROM_COMPARISON_PANEL",SSId:e})}}},{key:"onMouseDownSubsequenceView",value:function(){return function(t){}}}])&&_S(e.prototype,n),r&&_S(e,r),o}(i.a.Component);function TS(t){return(TS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function PS(t,e){return(PS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function AS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=NS(t);if(e){var i=NS(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return OS(this,n)}}function OS(t,e){return!e||"object"!==TS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function NS(t){return(NS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&PS(t,e)}(o,t);var e,n,r,a=AS(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={selectedSubsequences:[]},e}return e=o,(n=[{key:"render",value:function(){for(var t=[],e=0;e<this.state.selectedSubsequences.length;e++)t.push(i.a.createElement(CS,{key:e,idx:e,dataId:this.state.selectedSubsequences[e].id,period:this.state.selectedSubsequences[e].period,SSId:this.state.selectedSubsequences[e].SSId}));return i.a.createElement("div",{id:"clusteringSubsequenceComparison",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)-$("#clusteringResultsLeftColumnNavTabs").outerHeight(!0)}},i.a.createElement("div",{className:"overlayHidingPanel"}),t)}},{key:"componentDidMount",value:function(){var t=this,e=document.getElementById("clusteringSubsequenceComparison");bS.create(e,{handle:".hamburger",animation:150}),zc.on("showSelectedSubsequenceInComparisonPanel",(function(e,n,r){var i=t.state.selectedSubsequences;i.push({id:e,period:n,SSId:r}),t.setState({selectedSubsequences:i})})),zc.on("removeSelectedSubsequenceFromComparisonPanel",(function(e){var n=0,r=t.state.selectedSubsequences;for(n=0;n<r.length&&r[n].SSId!==e;n++);r.splice(n,1),t.setState({selectedSubsequences:r})}))}}])&&kS(e.prototype,n),r&&kS(e,r),o}(i.a.Component);function LS(t){return(LS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function DS(t,e){return(DS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=BS(t);if(e){var i=BS(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return FS(this,n)}}function FS(t,e){return!e||"object"!==LS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function BS(t){return(BS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var VS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DS(t,e)}(o,t);var e,n,r,a=zS(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).padding={left:10,right:5,top:20,bottom:10},e.timestampWidth=50,e.metaInfoWidth=50,e.barHeight=60,e.clusters={},e.symbolGenerator=nl().size(50),e.state={sessions:vh("clusteringHistory")},e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{id:"clusteringHistory",className:"clusteringPanel"},i.a.createElement("button",{type:"button",id:"saveCurrentClusteringSessionBtn",className:"btn btn-sm btn-primary",onClick:this.saveCurrentClusteringSession().bind(this)},"Save the clustering results"),i.a.createElement("div",{id:"clusteringHistoryChart",style:{height:$("#mainFeatureArea").outerHeight(!0)-$("#clusteringResultsLeftColumnNavTabs").outerHeight(!0)}}))}},{key:"componentDidMount",value:function(){var t=.95*Math.max($("#clusteringResultsLeftColumn").width(),.2*$("#mainFeatureArea").outerWidth(!0)),e=$("#mainFeatureArea").outerHeight(!0)-$("#clusteringResultsLeftColumnNavTabs").outerHeight(!0)-$("#saveCurrentClusteringSessionBtn").height();this.clusteringHistorySVG=se("#clusteringHistoryChart").append("svg").attr("id","clusteringHistoryChartSVG").attr("width",t).attr("height",e),Object.keys(this.state.sessions).length>0&&(this.divideSSIntoClusters(),this.drawClusteringHistoryChart())}},{key:"componentDidUpdate",value:function(){var t=.95*Math.max($("#clusteringResultsLeftColumn").width(),.2*$("#mainFeatureArea").outerWidth(!0)),e=$("#mainFeatureArea").outerHeight(!0)-$("#clusteringResultsLeftColumnNavTabs").outerHeight(!0)-$("#saveCurrentClusteringSessionBtn").height();this.clusteringHistorySVG.attr("width",t).attr("height",e),Object.keys(this.state.sessions).length>0&&(this.divideSSIntoClusters(),this.updateClusteringHistoryChart())}},{key:"divideSSIntoClusters",value:function(){var t=Object.keys(this.state.sessions);this.clusters={};for(var e=0;e<t.length;e++){var n=t[e];this.clusters[n]=[];for(var r=0;r<this.state.sessions[n].clusterCenters.length;r++)this.clusters[n].push([]);for(var i=0;i<this.state.sessions[n].labels.length;i++){var a="object"===LS(this.state.sessions[n].labels[i])?this.state.sessions[n].labels[i].cluster:this.state.sessions[n].labels[i];this.clusters[n][a].push(i)}}}},{key:"saveCurrentClusteringSession",value:function(){return function(t){var e={};e.timeStamp=(new Date).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1});var n,r,i=zc.getDatasets();e.datasets={};for(var a=0;a<i.length;a++)e.datasets[i[a]]=Ju.getFileName(i[a]);e.clusteringParameters=zc.getClusteringParameters(),e.subsequenceParameters=zc.getSubsequenceParameters(),e.subsequences=zc.getSubsequences(),e.clusterCenters=zc.getClusterCenters(),e.labels=zc.getLabels(),e.clusteringScores=zc.getClusteringScores(),e.resultsCoordinates=zc.getResultsCoordinates(),e.SSEClusters=zc.getSSEClusters(),e.clusterColors=zc.getClusterColors(),n=e,r=hh(),null===gh&&(gh=JSON.parse(sessionStorage.getItem("clusteringHistory"))),n.sessionId=r,gh[r]=n,sessionStorage.setItem("clusteringHistory",JSON.stringify(gh)),this.setState({sessions:vh("clusteringHistory")})}}},{key:"drawClusteringHistoryChart",value:function(){var t=this;Object.keys(this.state.sessions).length>0&&function(){var e=Object.keys(t.state.sessions),n=0;for(var r in t.state.sessions)n<t.state.sessions[r].subsequences.length&&(n=t.state.sessions[r].subsequences.length);var i=.95*Math.max($("#clusteringResultsLeftColumn").width(),.2*$("#mainFeatureArea").outerWidth(!0)),a=t.padding.top+t.padding.bottom+t.barHeight*(e.length+2*(e.length-1));t.clusteringHistorySVG.attr("width",i).attr("height",a);var o=(i-(t.padding.left+t.padding.right+t.timestampWidth+t.metaInfoWidth))/n,s=$("g.clusteringHistoryGroup");e.length>s.length?t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).enter().append("g").attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t})):e.length<s.length?t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t})).exit().remove():e.length===s.length&&t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).enter().attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t}));for(var l=function(n){var r=e[n],a=t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+r);a.append("text").attr("x",i-t.padding.right-5).attr("y",t.padding.top+3*t.barHeight*n).attr("id","removeClusteringSession_"+r).attr("class","removeClusteringSession").attr("text-anchor","middle").text("x").on("click",t.removeClusteringSession().bind(t));var s=t.state.sessions[r].timeStamp.toLocaleString("en-US").split(", ");a.selectAll("text.clusteringHistoryTimeStamps_"+r).data(s).enter().append("text").attr("class","clusteringHistoryTimeStamps_"+r).attr("x",5).attr("y",function(t,e){return 0===e?this.padding.top+3*this.barHeight*n+this.barHeight/2:this.padding.top+3*this.barHeight*n+this.barHeight/2+8}.bind(t)).attr("font-size","0.6rem").attr("text-anchor","left").attr("fill","black").text((function(t){return t}));var l=a.append("g").attr("class","recoverButtonGroup btn btn-primary").attr("id","recoverButtonGroup_"+r).on("click",t.onClickRecoverButton().bind(t));l.append("rect").attr("id","recoverButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5).attr("width",48).attr("height",23).attr("fill","#325d88").attr("rx",4).attr("ry",4),l.append("text").attr("id","recoverButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+8+11.5).attr("fill","white").attr("font-size","0.6rem").attr("text-anchor","middle").text("RECOVER");var u=a.append("g").attr("class","detailButtonGroup btn btn-primary").attr("id","detailButtonGroup_"+r).on("mouseover",t.onMouseOverDetailButton().bind(t)).on("mouseout",t.onMouseOutDetailButton().bind(t));u.append("rect").attr("id","detailButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5+23+4).attr("width",48).attr("height",23).attr("fill","#325d88").attr("rx",4).attr("ry",4),u.append("text").attr("id","detailButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+5+23+4+3+11.5).attr("fill","white").attr("font-size","0.6rem").attr("text-anchor","middle").text("DETAIL");for(var c=function(e){var i=t.state.sessions[r].clusterColors[e];a.selectAll("rect.clusteringHistoryRect_"+r+"_"+e).data(t.clusters[r][e]).enter().append("rect").attr("class","clusteringHistoryRect clusteringHistoryRect_"+r+"_"+e).attr("id",function(t){return"clusteringHistoryRect_"+r+"_"+e+"_"+this.state.sessions[r].datasets[this.state.sessions[r].subsequences[t].id]+"_"+this.state.sessions[r].subsequences[t].idx}.bind(t)).attr("x",function(t,n){var i=0;return e>0&&this.clusters[r].forEach((function(t,n){n<e&&(i+=t.length)})),this.timestampWidth+this.padding.left+o*(i+n)}.bind(t)).attr("y",function(t){return this.padding.top+3*this.barHeight*n}.bind(t)).attr("width",o).attr("height",t.barHeight).attr("fill",Be(i[0],i[1],i[2])).on("mouseover",t.onMouseOverRectOnSessionBar().bind(t)).on("mouseout",t.onMouseOutRectOnSessionBar().bind(t))},h=0;h<t.clusters[r].length;h++)c(h);if(n>0){var d=t.state.sessions[e[n-1]],f=t.state.sessions[r],p=Object.keys(d.datasets).map((function(t){return d.datasets[t]})).sort((function(t,e){return t-e})),m=Object.keys(f.datasets).map((function(t){return f.datasets[t]})).sort((function(t,e){return t-e})),g=Object(Pc.isEqual)(p,m),v=!1,y=Object(Pc.isEqual)(d.subsequences,f.subsequences);if(d.subsequenceParameters.filtering.indexOf("dataDrivenSlidingWindow")===f.subsequenceParameters.filtering.indexOf("dataDrivenSlidingWindow")&&Object(Pc.isEqual)(d.subsequenceParameters.SSperiod,f.subsequenceParameters.SSperiod)&&(v=!0),g&&v&&y){$("#clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r).remove();for(var b=t.clusteringHistorySVG.append("g").attr("class","clusteringHistoryCorrelationGroup").attr("id","clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r),x=0;x<t.clusters[r].length;x++)for(var _=0;_<t.clusters[r][x].length;_++)for(var w=f.datasets[f.subsequences[t.clusters[r][x][_]].id],S=f.subsequences[t.clusters[r][x][_]].idx,E=0;E<t.clusters[e[n-1]].length;E++)for(var M=0;M<t.clusters[e[n-1]][E].length;M++){var C=d.datasets[d.subsequences[t.clusters[e[n-1]][E][M]].id],T=d.subsequences[t.clusters[e[n-1]][E][M]].idx;if(w===C&&S===T){var k=lc.getPlotColor(Ju.getIdFromName(w));void 0===k&&(k="gray");var P,A,O=0;if(x>0)for(var N=0;N<x;N++)O+=t.clusters[r][N].length;var R=0;if(E>0)for(var L=0;L<E;L++)R+=t.clusters[e[n-1]][L].length;P=t.padding.left+t.timestampWidth+o*(O+_);var I=[{x:A=t.padding.left+t.timestampWidth+o*(R+M),y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:A+o,y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:P+o,y:t.padding.top+t.barHeight*(n+2*n)},{x:P,y:t.padding.top+t.barHeight*(n+2*n)},{x:A,y:t.padding.top+t.barHeight*(n+2*(n-1))}];b.append("path").datum(I).attr("class","clusteringHistoryCorrelationPath").attr("id","clusteringHistoryCorrelationPath_"+e[n-1]+"_"+r+"_"+w+"_"+S).attr("d",Qs().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",k).style("opacity",.3).on("mouseover",t.onMouseOverCorrelationPath().bind(t)).on("mouseout",t.onMouseOutCorrelationPath().bind(t))}}}else if(g&&v&&!y||!g&&v&&!y){for(var D=[],z=[],F=0;F<f.subsequences.length;F++){for(var B=!0,V=0;V<d.subsequences.length;V++)if(d.datasets[d.subsequences[V].id]===f.datasets[f.subsequences[F].id]&&d.subsequences[V].idx===f.subsequences[F].idx){B=!1;break}B&&D.push(F)}for(var j=0;j<d.subsequences.length;j++){for(var H=!0,U=0;U<f.subsequences.length;U++)if(d.datasets[d.subsequences[j].id]===f.datasets[f.subsequences[U].id]&&d.subsequences[j].idx===f.subsequences[U].idx){H=!1;break}H&&z.push(j)}D.length>0&&t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+r).append("g").attr("class","addedMarksGroup").selectAll("path.addedMark").data(D).enter().append("path").attr("class","addedMark").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(t)).attr("fill","#93c54b").style("transform",function(t){for(var e="object"===LS(f.labels[t])?f.labels[t].cluster:f.labels[t],i=0,a=0;a<e;a++)i+=this.clusters[r][a].length;var s=this.clusters[r][e].indexOf(t);return"translate("+(this.padding.left+this.timestampWidth+(i+s)*o+o/2)+"px,"+(this.padding.top+this.barHeight*(n+2*n)-5)+"px) rotate(180deg)"}.bind(t)),z.length>0&&t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+e[n-1]).append("g").attr("class","removedMarksGroup").selectAll("path.removedMark").data(z).enter().append("path").attr("class","removedMark").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(t)).attr("fill","#d9534f").style("transform",function(t){for(var r="object"===LS(d.labels[t])?d.labels[t].cluster:d.labels[t],i=0,a=0;a<r;a++)i+=this.clusters[e[n-1]][a].length;var s=this.clusters[e[n-1]][r].indexOf(t);return"translate("+(this.padding.left+this.timestampWidth+(i+s)*o+o/2)+"px,"+(this.padding.top+this.barHeight*(n+2*(n-1>0?n-1:0))+5)+"px)"}.bind(t)),$("#clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r).remove();for(var G=t.clusteringHistorySVG.append("g").attr("class","clusteringHistoryCorrelationGroup").attr("id","clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r),q=0;q<t.clusters[r].length;q++)for(var W=0;W<t.clusters[r][q].length;W++){var Y=f.datasets[f.subsequences[t.clusters[r][q][W]].id],Q=f.subsequences[t.clusters[r][q][W]].idx;if(D.indexOf(t.clusters[r][q][W])<0)for(var X=0;X<t.clusters[e[n-1]].length;X++)for(var Z=0;Z<t.clusters[e[n-1]][X].length;Z++)if(z.indexOf(t.clusters[e[n-1]][X][Z])<0){var J=d.datasets[d.subsequences[t.clusters[e[n-1]][X][Z]].id],K=d.subsequences[t.clusters[e[n-1]][X][Z]].idx;if(Y===J&&Q===K){var tt=lc.getPlotColor(Ju.getIdFromName(Y));void 0===tt&&(tt="gray");var et,nt,rt=0;if(q>0)for(var it=0;it<q;it++)rt+=t.clusters[r][it].length;var at=0;if(X>0)for(var ot=0;ot<X;ot++)at+=t.clusters[e[n-1]][ot].length;et=t.padding.left+t.timestampWidth+o*(rt+W);var st=[{x:nt=t.padding.left+t.timestampWidth+o*(at+Z),y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:nt+o,y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:et+o,y:t.padding.top+t.barHeight*(n+2*n)},{x:et,y:t.padding.top+t.barHeight*(n+2*n)},{x:nt,y:t.padding.top+t.barHeight*(n+2*(n-1))}];G.append("path").datum(st).attr("class","clusteringHistoryCorrelationPath").attr("id","clusteringHistoryCorrelationPath_"+e[n-1]+"_"+r+"_"+Y+"_"+Q).attr("d",Qs().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",tt).style("opacity",.3).on("mouseover",t.onMouseOverCorrelationPath().bind(t)).on("mouseout",t.onMouseOutCorrelationPath().bind(t))}}}}else if(!g&&v&&!y){for(var lt=[],ut=Object.keys(d.datasets).map((function(t){return d.datasets[t]})).sort((function(t,e){return t-e})),ct=Object.keys(f.datasets).map((function(t){return f.datasets[t]})).sort((function(t,e){return t-e})),ht=0;ht<ut.length;ht++)if(ct.indexOf(ut[ht])>=0){var dt=void 0,ft=void 0;for(var pt in d.datasets)if(d.datasets[pt]===ut[ht]){dt=pt;break}for(var mt in f.datasets)if(f.datasets[mt]===ut[ht]){ft=mt;break}lt.push({fileName:ut[ht],pDataId:dt,cDataId:ft})}if(lt.length>0){for(var gt=[],vt=[],yt=0;yt<f.subsequences.length;yt++){for(var bt=!0,xt=0;xt<d.subsequences.length;xt++)if(d.datasets[d.subsequences[xt].id]===f.datasets[f.subsequences[yt].id]&&d.subsequences[xt].idx===f.subsequences[yt].idx){bt=!1;break}bt&&gt.push(yt)}for(var _t=0;_t<d.subsequences.length;_t++){for(var wt=!0,St=0;St<f.subsequences.length;St++)if(d.datasets[d.subsequences[_t].id]===f.datasets[f.subsequences[St].id]&&d.subsequences[_t].idx===f.subsequences[St].idx){wt=!1;break}wt&&vt.push(_t)}}}}},u=0;u<e.length;u++)l(u)}()}},{key:"updateClusteringHistoryChart",value:function(){var t=this;Object.keys(this.state.sessions).length>0&&function(){var e=Object.keys(t.state.sessions),n=0;for(var r in t.state.sessions)n<t.state.sessions[r].subsequences.length&&(n=t.state.sessions[r].subsequences.length);var i=.95*Math.max($("#clusteringResultsLeftColumn").width(),.2*$("#mainFeatureArea").outerWidth(!0)),a=t.padding.top+t.padding.bottom+t.barHeight*(e.length+2*(e.length-1));t.clusteringHistorySVG.attr("width",i).attr("height",a);var o=(i-(t.padding.left+t.padding.right+t.timestampWidth+t.metaInfoWidth))/n,s=$("g.clusteringHistoryGroup");e.length>s.length?t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).enter().append("g").attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t})):e.length<s.length?t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t})).exit().remove():e.length===s.length&&t.clusteringHistorySVG.selectAll("g.clusteringHistoryGroup").data(e).enter().attr("class","clusteringHistoryGroup").attr("id",(function(t){return"clusteringHistoryGroup_"+t})),$(".addedMarksGroup").remove(),$(".removedMarksGroup").remove();for(var l=function(n){var r=e[n],a=t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+r);if($("#removeClusteringSession_"+r).length>0?se("#removeClusteringSession_"+r).attr("x",i-t.padding.right-5).attr("y",t.padding.top+3*t.barHeight*n):a.append("text").attr("id","removeClusteringSession_"+r).attr("class","removeClusteringSession").attr("x",i-t.padding.right-5).attr("y",t.padding.top+3*t.barHeight*n).attr("text-anchor","middle").text("x").on("click",t.removeClusteringSession().bind(t)),$("text.clusteringHistoryTimeStamps_"+r).length)a.selectAll("text.clusteringHistoryTimeStamps_"+r).attr("y",function(t,e){return 0===e?this.padding.top+3*this.barHeight*n+this.barHeight/2:this.padding.top+3*this.barHeight*n+this.barHeight/2+8}.bind(t));else{var s=t.state.sessions[r].timeStamp.toLocaleString("en-US").split(", ");a.selectAll("text.clusteringHistoryTimeStamps_"+r).data(s).enter().append("text").attr("class","clusteringHistoryTimeStamps_"+r).attr("x",5).attr("y",function(t,e){return 0===e?this.padding.top+3*this.barHeight*n+this.barHeight/2:this.padding.top+3*this.barHeight*n+this.barHeight/2+8}.bind(t)).attr("font-size","0.6rem").attr("text-anchor","left").attr("fill","black").text((function(t){return t}))}if($("#recoverButtonGroup_"+r).length>0)se("#recoverButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5),se("#recoverButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+8+11.5),se("#detailButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5+23+4),se("#detailButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+5+23+4+3+11.5);else{var l=a.append("g").attr("class","recoverButtonGroup btn btn-primary").attr("id","recoverButtonGroup_"+r).on("click",t.onClickRecoverButton().bind(t));l.append("rect").attr("id","recoverButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5).attr("width",48).attr("height",23).attr("fill","#325d88").attr("rx",4).attr("ry",4),l.append("text").attr("id","recoverButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+8+11.5).attr("fill","white").attr("font-size","0.6rem").attr("text-anchor","middle").text("RECOVER");var u=a.append("g").attr("class","detailButtonGroup btn btn-primary").attr("id","detailButtonGroup_"+r).on("mouseover",t.onMouseOverDetailButton().bind(t)).on("mouseout",t.onMouseOutDetailButton().bind(t));u.append("rect").attr("id","detailButtonRect_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5).attr("y",t.padding.top+3*t.barHeight*n+5+23+4).attr("width",48).attr("height",23).attr("fill","#325d88").attr("rx",4).attr("ry",4),u.append("text").attr("id","detailButtonText_"+r).attr("x",i-t.padding.right-t.metaInfoWidth+5+24).attr("y",t.padding.top+3*t.barHeight*n+5+23+4+3+11.5).attr("fill","white").attr("font-size","0.6rem").attr("text-anchor","middle").text("DETAIL")}for(var c=function(i){if(a.selectAll("rect.clusteringHistoryRect_"+r+"_"+i).size()>0)a.selectAll("rect.clusteringHistoryRect_"+r+"_"+i).attr("x",function(t,e){var n=0;return i>0&&this.clusters[r].forEach((function(t,e){e<i&&(n+=t.length)})),this.timestampWidth+this.padding.left+o*(n+e)}.bind(t)).attr("y",function(t){return this.padding.top+3*this.barHeight*n}.bind(t)).attr("width",o).attr("height",t.barHeight);else{var s=t.state.sessions[r].clusterColors[i];a.selectAll("rect.clusteringHistoryRect_"+r+"_"+i).data(t.clusters[r][i]).enter().append("rect").attr("class","clusteringHistoryRect clusteringHistoryRect_"+r+"_"+i).attr("id",function(t){return"clusteringHistoryRect_"+r+"_"+i+"_"+this.state.sessions[r].datasets[this.state.sessions[r].subsequences[t].id]+"_"+this.state.sessions[r].subsequences[t].idx}.bind(t)).attr("x",function(t,e){var n=0;return i>0&&this.clusters[r].forEach((function(t,e){e<i&&(n+=t.length)})),this.timestampWidth+this.padding.left+o*(n+e)}.bind(t)).attr("y",function(t){return this.padding.top+3*this.barHeight*n}.bind(t)).attr("width",o).attr("height",t.barHeight).attr("fill",Be(s[0],s[1],s[2])).on("mouseover",t.onMouseOverRectOnSessionBar().bind(t)).on("mouseout",t.onMouseOutRectOnSessionBar().bind(t))}if(n>0){var l=t.state.sessions[e[n-1]],u=t.state.sessions[r],c=Object(Pc.isEqual)(l.datasets,u.datasets),h=!1,d=Object(Pc.isEqual)(l.subsequences,u.subsequences);if(l.subsequenceParameters.filtering.indexOf("dataDrivenSlidingWindow")===u.subsequenceParameters.filtering.indexOf("dataDrivenSlidingWindow")&&Object(Pc.isEqual)(l.subsequenceParameters.SSperiod,u.subsequenceParameters.SSperiod)&&(h=!0),c&&h&&d){$("#clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r).remove();for(var f=t.clusteringHistorySVG.append("g").attr("class","clusteringHistoryCorrelationGroup").attr("id","clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r),p=0;p<t.clusters[r].length;p++)for(var m=0;m<t.clusters[r][p].length;m++)for(var g=u.datasets[u.subsequences[t.clusters[r][p][m]].id],v=u.subsequences[t.clusters[r][p][m]].idx,y=0;y<t.clusters[e[n-1]].length;y++)for(var b=0;b<t.clusters[e[n-1]][y].length;b++){var x=l.datasets[l.subsequences[t.clusters[e[n-1]][y][b]].id],_=l.subsequences[t.clusters[e[n-1]][y][b]].idx;if(g===x&&v===_){var w=lc.getPlotColor(Ju.getIdFromName(g));void 0===w&&(w="gray");var S,E,M=0;if(p>0)for(var C=0;C<p;C++)M+=t.clusters[r][C].length;var T=0;if(y>0)for(var k=0;k<y;k++)T+=t.clusters[e[n-1]][k].length;S=t.padding.left+t.timestampWidth+o*(M+m);var P=[{x:E=t.padding.left+t.timestampWidth+o*(T+b),y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:E+o,y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:S+o,y:t.padding.top+t.barHeight*(n+2*n)},{x:S,y:t.padding.top+t.barHeight*(n+2*n)},{x:E,y:t.padding.top+t.barHeight*(n+2*(n-1))}];f.append("path").datum(P).attr("class","clusteringHistoryCorrelationPath").attr("id","clusteringHistoryCorrelationPath_"+e[n-1]+"_"+r+"_"+g+"_"+v).attr("d",Qs().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",w).style("opacity",.3).on("mouseover",t.onMouseOverCorrelationPath().bind(t)).on("mouseout",t.onMouseOutCorrelationPath().bind(t))}}}else if(c&&h&&!d||!c&&h&&!d){t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+r).selectAll(".addedMarksGroup").remove(),t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+e[n-1]).selectAll(".removedMarksGroup").remove();for(var A=[],O=[],N=0;N<u.subsequences.length;N++){for(var R=!0,L=0;L<l.subsequences.length;L++)if(l.datasets[l.subsequences[L].id]===u.datasets[u.subsequences[N].id]&&l.subsequences[L].idx===u.subsequences[N].idx){R=!1;break}R&&A.push(N)}for(var I=0;I<l.subsequences.length;I++){for(var D=!0,z=0;z<u.subsequences.length;z++)if(l.datasets[l.subsequences[I].id]===u.datasets[u.subsequences[z].id]&&l.subsequences[I].idx===u.subsequences[z].idx){D=!1;break}D&&O.push(I)}A.length>0&&t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+r).append("g").attr("class","addedMarksGroup").selectAll("path.addedMark").data(A).enter().append("path").attr("class","addedMark").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(t)).attr("fill","#93c54b").style("transform",function(t){for(var e="object"===LS(u.labels[t])?u.labels[t].cluster:u.labels[t],i=0,a=0;a<e;a++)i+=this.clusters[r][a].length;var s=this.clusters[r][e].indexOf(t);return"translate("+(this.padding.left+this.timestampWidth+(i+s)*o+o/2)+"px,"+(this.padding.top+this.barHeight*(n+2*n)-5)+"px) rotate(180deg)"}.bind(t)),O.length>0&&t.clusteringHistorySVG.select("#clusteringHistoryGroup_"+e[n-1]).append("g").attr("class","removedMarksGroup").selectAll("path.removedMark").data(O).enter().append("path").attr("class","removedMark").attr("d",function(t){return this.symbolGenerator.type(el),this.symbolGenerator()}.bind(t)).attr("fill","#d9534f").style("transform",function(t){for(var r="object"===LS(l.labels[t])?l.labels[t].cluster:l.labels[t],i=0,a=0;a<r;a++)i+=this.clusters[e[n-1]][a].length;var s=this.clusters[e[n-1]][r].indexOf(t);return"translate("+(this.padding.left+this.timestampWidth+(i+s)*o+o/2)+"px,"+(this.padding.top+this.barHeight*(n+2*(n-1>0?n-1:0))+5)+"px)"}.bind(t)),$("#clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r).remove();for(var F=t.clusteringHistorySVG.append("g").attr("class","clusteringHistoryCorrelationGroup").attr("id","clusteringHistoryCorrelationGroup_"+e[n-1]+"_"+r),B=0;B<t.clusters[r].length;B++)for(var V=0;V<t.clusters[r][B].length;V++){var j=u.datasets[u.subsequences[t.clusters[r][B][V]].id],H=u.subsequences[t.clusters[r][B][V]].idx;if(A.indexOf(t.clusters[r][B][V])<0)for(var U=0;U<t.clusters[e[n-1]].length;U++)for(var G=0;G<t.clusters[e[n-1]][U].length;G++)if(O.indexOf(t.clusters[e[n-1]][U][G])<0){var q=l.datasets[l.subsequences[t.clusters[e[n-1]][U][G]].id],W=l.subsequences[t.clusters[e[n-1]][U][G]].idx;if(j===q&&H===W){var Y=lc.getPlotColor(Ju.getIdFromName(j));void 0===Y&&(Y="gray");var Q,X,Z=0;if(B>0)for(var J=0;J<B;J++)Z+=t.clusters[r][J].length;var K=0;if(U>0)for(var tt=0;tt<U;tt++)K+=t.clusters[e[n-1]][tt].length;Q=t.padding.left+t.timestampWidth+o*(Z+V);var et=[{x:X=t.padding.left+t.timestampWidth+o*(K+G),y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:X+o,y:t.padding.top+t.barHeight*(n+2*(n-1))},{x:Q+o,y:t.padding.top+t.barHeight*(n+2*n)},{x:Q,y:t.padding.top+t.barHeight*(n+2*n)},{x:X,y:t.padding.top+t.barHeight*(n+2*(n-1))}];F.append("path").datum(et).attr("class","clusteringHistoryCorrelationPath").attr("id","clusteringHistoryCorrelationPath_"+e[n-1]+"_"+r+"_"+j+"_"+H).attr("d",Qs().x((function(t){return t.x})).y((function(t){return t.y}))).attr("fill",Y).style("opacity",.3).on("mouseover",t.onMouseOverCorrelationPath().bind(t)).on("mouseout",t.onMouseOutCorrelationPath().bind(t))}}}}}},h=0;h<t.clusters[r].length;h++)c(h)},u=0;u<e.length;u++)l(u)}()}},{key:"removeClusteringSession",value:function(){return function(t){var e=$t.target.id;if(e){var n=Object.keys(this.state.sessions),r=e.split("_"),i=n.indexOf(r[1]);$("#clusteringHistoryGroup_"+r[1]).remove(),i>0&&i<n.length-1?($("#clusteringHistoryCorrelationGroup_"+n[i-1]+"_"+r[1]).remove(),$("#clusteringHistoryCorrelationGroup_"+r[1]+"_"+n[i+1]).remove()):0===i&&n.length>=2?$("#clusteringHistoryCorrelationGroup_"+r[1]+"_"+n[i+1]).remove():i===n.length-1&&n.length>=2&&$("#clusteringHistoryCorrelationGroup_"+n[i-1]+"_"+r[1]).remove(),function(t){if(t in gh)for(var e in gh)if(gh[e].sessionId===t){delete gh[t],sessionStorage.setItem("clusteringHistory",JSON.stringify(gh));break}}(r[1]),this.setState({sessions:vh("clusteringHistory")})}}}},{key:"onMouseOverRectOnSessionBar",value:function(){return function(t){var e=$t.target.id;if(e){var n,r=e.split("_"),i=r[1],a=r[2];n=r.length>4?r.slice(3,-1).join("_"):r[3];for(var o=this.state.sessions[i].clusterColors[Number(a)],s=[],l=0;l<this.clusters[i][a].length;l++)s.push(this.state.sessions[i].subsequences[this.clusters[i][a][l]].idx);for(var u=Object.keys(this.state.sessions),c=0;c<u.length-1;c++)for(var h=0;h<s.length;h++){var d=document.getElementById("clusteringHistoryCorrelationPath_"+u[c]+"_"+u[c+1]+"_"+n+"_"+s[h]);d&&(d.style.stroke=Be(o[0],o[1],o[2]),d.style.strokeWidth=2)}}}}},{key:"onMouseOutRectOnSessionBar",value:function(){return function(t){$t.target.id&&Us(".clusteringHistoryCorrelationPath").style("stroke-width",0)}}},{key:"onMouseOverCorrelationPath",value:function(){return function(t){var e=$t.target.id;if(e){var n,r=e.split("_"),i=r[r.length-1];n=r.length>4?r.slice(3,-1).join("_"):r[3];for(var a=Object.keys(this.state.sessions),o=0;o<a.length-1;o++){var s=document.getElementById("clusteringHistoryCorrelationPath_"+a[o]+"_"+a[o+1]+"_"+n+"_"+i);s&&(s.style.stroke="black",s.style.strokeWidth=2)}}}}},{key:"onMouseOutCorrelationPath",value:function(){return function(t){Us(".clusteringHistoryCorrelationPath").style("stroke-width",0)}}},{key:"onClickRecoverButton",value:function(){return function(t){var e,n=$t.target.id;if(n){var r=n.split("_"),i=Object.assign({},this.state.sessions[r[1]]),a=[];for(var o in i.datasets)a.push(Ju.getIdFromName(i.datasets[o]));i.datasets=a,Wc(a),e=i,hu.dispatch({type:"RECOVER_CLUSTERING_SESSION",sessionInfo:e})}}}},{key:"onMouseOverDetailButton",value:function(){return function(t){var e=$t.target.id;if(e){var n=e.split("_"),r=this.state.sessions[n[1]],i=$("#sessionDetailInfo"),a=$("#detailButtonRect_"+n[1]);i.css("display","block"),i.css("top",a.offset().top-$("#appHeader").outerHeight(!0)-32),i.css("left",a.offset().left+50);var o=Object.keys(r.datasets).map((function(t){return r.datasets[t]}));$("#sessionDetailPopoverTitle").text(o.join(", "));var s={};for(var l in r.datasets){var u=Ju.getIdFromName(r.datasets[l]);if(u>=0){var c=Ju.getData(u).data.lookup;for(var h in c)if(h in s)for(var d=0;d<c[h].length;d++)s[h].indexOf(c[h][d])<0&&s[h].push(c[h][d]);else s[h]=c[h]}}var f="";if(0===Object.keys(s).length)f=r.clusteringParameters.variables.join(", ");else for(var p=0;p<r.clusteringParameters.variables.length;p++)f+=s[r.clusteringParameters.variables[p]].join(", "),p!==r.clusteringParameters.variables.length-1&&(f+=", ");var m,g='<h6>Clustering Parameters</h6><table id="clusteringParameterTableCluteringHistoryChart"><tbody><tr><td>Method</td><td>'+r.clusteringParameters.method+"</td></tr><tr><td>Cluster number</td><td>"+r.clusteringParameters.clusterNum+"</td></tr><tr><td>Variables</td><td>"+f+"</td></tr><tr><td>Distance metric</td><td>"+r.clusteringParameters.distanceMetric+"</td></tr></tbody></table>";r.subsequenceParameters.overlappingTh&&(m="<tr><td>Overlapping degree</td><td>"+r.subsequenceParameters.overlappingTh+"%</td></tr>");var v='<h6>Subsequence Parameters</h6><table id="SSParameterTableCluteringHistoryChart"><tbody><tr><td>Subsquence period</td><td>'+r.subsequenceParameters.SSperiod[0]+"-"+r.subsequenceParameters.SSperiod[1]+"</td></tr><tr><td>Filtering</td><td>"+r.subsequenceParameters.filtering.join(", ")+"</td></tr>"+m+"<tr><td>Normalize</td><td>"+r.subsequenceParameters.normalize+"</td></tr></tbody></table>",y='<h6>Clustering scores</h6><table id="clusteringScoreTableCluteringHistoryChart"><tbody><tr><td>Pseudo F</td><td>'+Sd(r.clusteringScores.pseudoF)+"<tr><td>Silhouette coefficient</td><td>"+Sd(r.clusteringScores.silhouette)+"<tr><td>Davis Bouldin index</td><td>"+Sd(r.clusteringScores.davisBouldin)+"</td></tr></tbody></table>";$("#sessionDetailPopoverBody").html(g+v+y)}}}},{key:"onMouseOutDetailButton",value:function(){return function(t){$("#sessionDetailInfo").css("display","none")}}}])&&IS(e.prototype,n),r&&IS(e,r),o}(i.a.Component);function jS(t){return(jS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function US(t,e){return(US=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function GS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$S(t);if(e){var i=$S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qS(this,n)}}function qS(t,e){return!e||"object"!==jS(e)&&"function"!=typeof e?WS(t):e}function WS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $S(t){return($S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oe.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};var YS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&US(t,e)}(o,t);var e,n,r,a=GS(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).margin={left:30,right:10,top:20,bottom:20},t.paddingCard=16,t.areaPadding={left:16,right:16,top:8,bottom:8},t.queryMode,t.clickedX,t.clickedY,t.clusterCenters,t.clusterColors,t.subsequences,t.datasetsIdx,t.labels,t.clusteringScores,t.subsequenceParameters,t.variables,t.selectedTrIdx=-1,t.SSCluster,t.onMouseMoveSubsequenceDetailTrFnc=t.onMouseMoveSubsequenceDetailTr().bind(WS(t)),t.onMouseUpSubsequenceDetailTrFnc=t.onMouseUpSubsequenceDetailTr().bind(WS(t)),t.state={cluster:-1,sparklineOrder:"timestamp"},t}return e=o,(n=[{key:"render",value:function(){var t,e,n,r,a,o,s=this;return t=this.clusterCenterTimeTubesView(),e=this.clusterCenterLineCharts(),n=this.subsequenceLengthDistribution(),r=this.clustersTemporalDistribution(),a=this.clusterFeatureTable(),o=this.subsequencesOverview(),i.a.createElement("div",{id:"clusteringDetail",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)},ref:function(t){s.mount=t}},t,e,n,r,a,o)}},{key:"componentDidMount",value:function(){var t=this;$("#selectedClusterCenterTimeTubesCanvas").css("width",$("#clusteringDetail").width()),$("#selectedClusterCenterTimeTubesCanvas").css("height",$("#clusteringDetail").width()),zc.on("showClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.clusterColors=zc.getClusterColors(),t.labels=zc.getLabels(),t.subsequences=zc.getSubsequences(),t.datasetsIdx=zc.getDatasets(),t.clusteringScores=zc.getClusteringScores(),t.subsequenceParameters=zc.getSubsequenceParameters(),t.clearCanvas(),t.setState({cluster:-1})})),zc.on("showClusterDetails",(function(e){t.variables=zc.getClusteringParameters().variables,t.variables=t.variables.filter((function(t){return"z"!==t})),t.createVariableLabels(),t.extractSubsequencesInCluster(e),$("#selectedClusterCenterName").text("Cluster "+e),t.setState({cluster:e})})),zc.on("updateClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.labels=zc.getLabels(),t.subsequences=zc.getSubsequences(),t.clusteringScores=zc.getClusteringScores(),t.extractSubsequencesInCluster(-1),t.clearCanvas(),t.setState({cluster:-1})})),zc.on("resetClusteringResults",(function(){t.clusterCenters=zc.getClusterCenters(),t.labels=zc.getLabels(),t.subsequences=zc.getSubsequences(),t.clusteringScores=zc.getClusteringScores(),t.extractSubsequencesInCluster(-1),t.clearCanvas(),t.setState({cluster:-1})})),zc.on("updateSSSelection",(function(){t.showSSStatus()})),zc.on("recoverClusteringSession",(function(){t.clusterCenters=zc.getClusterCenters(),t.clusterColors=zc.getClusterColors(),t.labels=zc.getLabels(),t.subsequences=zc.getSubsequences(),t.datasetsIdx=zc.getDatasets(),t.clusteringScores=zc.getClusteringScores(),t.subsequenceParameters=zc.getSubsequenceParameters(),t.clearCanvas(),t.setState({cluster:-1})}))}},{key:"componentWillUnmount",value:function(){var t=document.getElementById("clusteringDetail");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"componentDidUpdate",value:function(){this.drawClusterCenterLineCharts(),this.drawSubsequenceLengthHistogram(),this.drawClustersTemporalDistributionHistogram(),this.drawSparklinesTable(),this.showSSStatus()}},{key:"clusterCenterTimeTubesView",value:function(){return i.a.createElement("div",{id:"selectedClusterCenterTimeTubes",className:"resultAreaElem"},i.a.createElement("h5",{id:"selectedClusterCenterName",style:{textAlign:"center"}}),i.a.createElement("canvas",{id:"selectedClusterCenterTimeTubesCanvas",width:"500",height:"500"}))}},{key:"clusterCenterLineCharts",value:function(){return i.a.createElement("div",{id:"selectedClusterCenterLineCharts",className:"resultAreaElem"})}},{key:"subsequenceLengthDistribution",value:function(){return i.a.createElement("div",{id:"subsequenceLengthHistogram",className:"resultAreaElem"})}},{key:"clustersTemporalDistribution",value:function(){return i.a.createElement("div",{id:"clustersTemporalDistributionHistogram",className:"resultAreaElem"})}},{key:"clearCanvas",value:function(){var t=document.getElementById("selectedClusterCenterTimeTubesCanvas");t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"clusterFeatureTable",value:function(){var t,e=this;return this.state.cluster>=0&&function(){var n=$("#clusteringDetail"),r=Number(n.css("padding-left").slice(0,-2)),a=Number(n.css("padding-right").slice(0,-2)),o=n.width()-r-a-2*e.paddingCard,s=0,l=0,u={};e.variables.forEach((function(t){u[t]=0}));for(var c=function(t){if(s+=e.SSCluster[t].dataPoints.length,l+=e.SSCluster[t].dataPoints[e.SSCluster[t].dataPoints.length-1].z-e.SSCluster[t].dataPoints[0].z,!1===e.subsequenceParameters.normalize)for(var n=function(n){e.variables.forEach((function(r){u[r]+=e.SSCluster[t].dataPoints[n][r]}))},r=0;r<e.SSCluster[t].dataPoints.length;r++)n(r)},h=0;h<e.SSCluster.length;h++)c(h);e.variables.forEach((function(t){u[t]/=s})),s/=e.SSCluster.length,l/=e.SSCluster.length;var d=[];!1===e.subsequenceParameters.normalize&&e.variables.forEach((function(t){d.push(i.a.createElement("tr",{key:t},i.a.createElement("td",{style:{width:o/2}},"Average of ",e.variableLabels[t]),i.a.createElement("td",{className:"clusterFeaturesValues",style:{width:o/2}},Sd(u[t]))))})),t=i.a.createElement("table",{id:"clusterFeatureTable",className:"table table-hover",style:{width:o,marginBottom:"unset"}},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",{style:{width:o/2}},"Member number"),i.a.createElement("td",{className:"clusterFeaturesValues",style:{width:o/2}},e.SSCluster.length)),i.a.createElement("tr",null,i.a.createElement("td",{style:{width:o/2}},"Cluster radius"),i.a.createElement("td",{className:"clusterFeaturesValues",style:{width:o/2}},Sd(e.clusteringScores.clusterRadiuses[e.state.cluster]))),i.a.createElement("tr",null,i.a.createElement("td",{style:{width:o/2}},"Average data point number"),i.a.createElement("td",{className:"clusterFeaturesValues",style:{width:o/2}},Sd(s))),i.a.createElement("tr",null,i.a.createElement("td",{style:{width:o/2}},"Average period"),i.a.createElement("td",{className:"clusterFeaturesValues",style:{width:o/2}},Sd(l))),d))}(),i.a.createElement("div",{id:"clusterFeature",className:"resultAreaElem"},t)}},{key:"subsequencesOverview",value:function(){if(this.state.cluster>=0){var t=$("#clusteringDetail"),e=Number(t.css("padding-left").slice(0,-2)),n=Number(t.css("padding-right").slice(0,-2)),r=t.width()-e-n-2*this.paddingCard,a=(r-30)/this.variables.length,o=[];o.push("");for(var s=0;s<this.variables.length;s++)this.variableLabels[this.variables[s]].length>1?o.push(this.variableLabels[this.variables[s]].join(", ")):o.push(this.variableLabels[this.variables[s]]);for(var l=[],u=0;u<o.length;u++)l.push(i.a.createElement("th",{key:u,id:0===u?"subsequencesOverviewTableTh_checkbox":"subsequencesOverviewTableTh_"+this.variables[u-1],style:{width:0===u?30:a,height:30}},o[u]));var c=i.a.createElement("thead",{style:{width:r,height:30},id:"subsequencesOverviewTableHeader"},i.a.createElement("tr",{style:{textAlign:"center",fontSize:"10px"}},l));"timestamp"===this.state.sparklineOrder?this.SSCluster.sort((function(t,e){return t.idx<e.idx?-1:1})):"Silhouette"===this.state.sparklineOrder&&this.SSCluster.sort((function(t,e){return t.Silhouette>e.Silhouette?-1:1}));for(var h=[],d=0;d<this.SSCluster.length;d++){var f=[],p=this.SSCluster[d].id,m=this.SSCluster[d].idx;f.push(i.a.createElement("td",{key:"checkbox",style:{textAlign:"center",width:30,height:30}},i.a.createElement("input",{type:"checkbox",className:"subsequenceDetailCheckbox",name:"subsequenceSelector",id:"selectSSDetail_"+p+"_"+m,onClick:this.onClickSSSelector().bind(this)})));for(var g=0;g<this.variables.length;g++)f.push(i.a.createElement("td",{key:this.variables[g],id:"subsequenceDetailTd_"+p+"_"+m+"_"+this.variables[g],style:{width:a,height:30}}));h.push(i.a.createElement("tr",{id:"subsequenceDetailTr_"+p+"_"+m,className:"subsequenceDetailTr",key:"subsequenceDetailTr_"+p+"_"+m,style:{width:r,height:30},onMouseOver:this.onMouseOverSubsequenceDetailTr().bind(this),onMouseOut:this.onMouseOutSubsequenceDetailTr().bind(this),onMouseDown:this.onMouseDownSubsequenceDetailTr().bind(this),onDoubleClick:this.onDoubleClickSubsequenceDetailTr().bind(this)},f))}return i.a.createElement("div",{id:"subsequencesOverview",className:"resultAreaElem"},i.a.createElement("div",{id:"switchSparklineOrder",className:"form-group form-inline"},i.a.createElement("span",{className:"switchSparklineOrderLabel"},"Silhouette"),i.a.createElement("div",{className:"custom-control custom-switch"},i.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"switchSparklineSort",checked:"timestamp"===this.state.sparklineOrder,onChange:this.switchSparklineOrder.bind(this)}),i.a.createElement("label",{className:"custom-control-label",htmlFor:"switchSparklineSort"})),i.a.createElement("span",{className:"switchSparklineOrderLabel"},"Time stamp")),i.a.createElement("table",{id:"subsequencesOverviewTable",className:"table table-hover sparkTable",style:{width:r}},c,i.a.createElement("tbody",{id:"subsequencesOverviewTableBody"},h)))}}},{key:"switchSparklineOrder",value:function(){"timestamp"===this.state.sparklineOrder?this.setState({sparklineOrder:"Silhouette"}):"Silhouette"===this.state.sparklineOrder&&this.setState({sparklineOrder:"timestamp"})}},{key:"extractSubsequencesInCluster",value:function(t){var e=this;if(this.SSCluster=[],this.yMinMax={},t>=0){this.variables.forEach(function(t){this.yMinMax[t]=[1/0,-1/0]}.bind(this));for(var n=function(n){if("object"===jS(e.labels[n])){if(e.labels[n].cluster===t){var r=e.subsequences[n];r.Silhouette=e.clusteringScores.silhouetteSS[n],e.SSCluster.push(r);for(var i=function(t){e.variables.forEach(function(e){this.subsequences[n][t][e]<this.yMinMax[e][0]&&(this.yMinMax[e][0]=this.subsequences[n][t][e]),this.yMinMax[e][1]<this.subsequences[n][t][e]&&(this.yMinMax[e][1]=this.subsequences[n][t][e])}.bind(e))},a=0;a<e.subsequences[n].length;a++)i(a)}}else if(e.labels[n]===t){var o=e.subsequences[n];o.Silhouette=e.clusteringScores.silhouetteSS[n],e.SSCluster.push(o);for(var s=function(t){e.variables.forEach(function(e){this.subsequences[n][t][e]<this.yMinMax[e][0]&&(this.yMinMax[e][0]=this.subsequences[n][t][e]),this.yMinMax[e][1]<this.subsequences[n][t][e]&&(this.yMinMax[e][1]=this.subsequences[n][t][e])}.bind(e))},l=0;l<e.subsequences[n].length;l++)s(l)}},r=0;r<this.labels.length;r++)n(r)}}},{key:"createVariableLabels",value:function(){for(var t={},e=0;e<this.datasetsIdx.length;e++){var n=Ju.getData(this.datasetsIdx[e]).data.lookup;for(var r in n)if(r in t)for(var i=0;i<n[r].length;i++)t[r].indexOf(n[r][i])<0&&t[r].push(n[r][i]);else t[r]=n[r]}this.variableLabels=t}},{key:"drawClusterCenterLineCharts",value:function(){var t=this;if($("#clusterCenterLineChartsSVG").remove(),this.state.cluster>=0)for(var e=$("#clusteringDetail"),n=Number(e.css("padding-left").slice(0,-2)),r=Number(e.css("padding-right").slice(0,-2)),i=e.width()-n-r-2*this.paddingCard,a=i/2,o=i/2*.6,s=se("#selectedClusterCenterLineCharts").append("svg").attr("id","clusterCenterLineChartsSVG").attr("width",i).attr("height",o*Math.ceil(this.variables.length/2)),l=function(e){var n=Na().domain([0,t.clusterCenters[t.state.cluster].length-1]).range([a*(e%2)+t.margin.left,a*(e%2)+a-t.margin.right]),r=Na().domain(t.yMinMax[t.variables[e]]).range([o*Math.floor(e/2)+o-t.margin.bottom,o*Math.floor(e/2)+t.margin.top]),i=V(n).ticks(5),l=j(r).ticks(5).tickFormat(wd),u=a*(e%2),c=o*Math.floor(e/2);s.append("g").attr("transform","translate(0,"+(c+o-t.margin.bottom)+")").call(i).selectAll("text").attr("font-size","0.5rem"),s.append("g").attr("transform","translate("+(u+t.margin.left)+",0)").call(l).selectAll("text").attr("font-size","0.5rem");for(var h=0;h<t.SSCluster.length;h++)s.append("path").datum(t.SSCluster[h]).attr("fill","none").attr("stroke","lightgray").attr("stroke-width",.7).attr("class","clusterMemberLineChart_"+t.SSCluster[h].id+"_"+t.SSCluster[h].idx).attr("id","clusterMemberLineChart_"+t.SSCluster[h].id+"_"+t.SSCluster[h].idx+"_"+t.variables[e]).attr("d",Qs().x((function(t,e){return n(e)})).y(function(t){return r(t[this.variables[e]])}.bind(t)).curve(ul.alpha(1)));s.append("path").datum(t.clusterCenters[t.state.cluster]).attr("fill","none").attr("stroke",Be(t.clusterColors[t.state.cluster][0],t.clusterColors[t.state.cluster][1],t.clusterColors[t.state.cluster][2])).attr("stroke-width",1.5).attr("d",Qs().x((function(t,e){return n(e)})).y(function(t){return r(t[this.variables[e]])}.bind(t)).curve(ul.alpha(1)));var d="";d=t.variableLabels[t.variables[e]].length>1?t.variableLabels[t.variables[e]].join(", "):t.variableLabels[t.variables[e]],s.append("text").attr("x",u+a/2).attr("y",c+t.margin.top/2).attr("fill","black").attr("font-size","0.5rem").attr("text-anchor","middle").text(d)},u=0;u<this.variables.length;u++)l(u)}},{key:"drawSubsequenceLengthHistogram",value:function(){if($("#subsequenceLengthHistogramSVG").remove(),this.state.cluster>=0){var t=$("#clusteringDetail"),e=Number(t.css("padding-left").slice(0,-2)),n=Number(t.css("padding-right").slice(0,-2)),r=t.width()-e-n-2*this.paddingCard,i=.35*r,a={left:30,right:10,top:15,bottom:20},o=se("#subsequenceLengthHistogram").append("svg").attr("id","subsequenceLengthHistogramSVG").attr("width",r).attr("height",i),s=zc.getSubsequenceParameters().SSperiod,l=Na().domain(s).range([a.left,r-a.right]);o.append("g").attr("transform","translate(0,"+(i-a.bottom)+")").call(V(l)).selectAll("text").attr("font-size","0.5rem");for(var u=[],c=0;c<this.labels.length;c++)("object"===jS(this.labels[c])?this.labels[c].cluster:this.labels[c])===this.state.cluster&&u.push(this.subsequences[c]);var h=T().value((function(t){return t[t.length-1].z-t[0].z})).domain(s).thresholds(l.ticks(10))(u),d=Na().range([i-a.bottom,a.top]).domain([0,k(h,(function(t){return t.length}))]);if(o.append("g").attr("transform","translate("+a.left+",0)").call(j(d).ticks(5)).selectAll("text").attr("font-size","0.5rem"),o.append("text").attr("x",r/2).attr("y",a.top/2).attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("Subsequence length"),1===this.datasetsIdx.length){var f=lc.getPlotColor(this.datasetsIdx[0]);void 0===f&&(f="gray"),o.selectAll("rect").data(h).enter().append("rect").attr("class","SSLengthBar").attr("id",(function(t){return"SSLengthBar_"+t.x0})).attr("x",1).attr("transform",(function(t){return"translate("+l(t.x0)+","+d(t.length)+")"})).attr("width",(function(t){return l(t.x1)-l(t.x0)-1})).attr("height",function(t){return i-a.bottom-d(t.length)}.bind(this)).attr("fill",f)}else if(this.datasetsIdx.length>1){for(var p=[],m=0;m<h.length;m++){for(var g={},v=0;v<this.datasetsIdx.length;v++)g[this.datasetsIdx[v]]=0;for(var y=0;y<h[m].length;y++)g[h[m][y].id]++;p.push(g)}for(var b=function(){var t=Gs([]),e=dl,n=hl,r=fl;function i(i){var a,o,s=t.apply(this,arguments),l=i.length,u=s.length,c=new Array(u);for(a=0;a<u;++a){for(var h,d=s[a],f=c[a]=new Array(l),p=0;p<l;++p)f[p]=h=[0,+r(i[p],d,p,i)],h.data=i[p];f.key=d}for(a=0,o=e(c);a<u;++a)c[o[a]].index=a;return n(c,o),c}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:Gs(cl.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:Gs(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?dl:"function"==typeof t?t:Gs(cl.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?hl:t,i):n},i}().keys(this.datasetsIdx),x=[],_=0;_<this.datasetsIdx.length;_++)x.push(lc.getPlotColor(this.datasetsIdx[_]));var w=b(p);o.selectAll("g.stackedBarGroup").data(w).enter().append("g").attr("class","stackedBarGroup").style("fill",(function(t,e){return x[e]})).selectAll("rect").data((function(t){return t})).enter().append("rect").attr("x",(function(t,e){return l(h[e].x0)})).attr("y",(function(t,e){return d(t[1])})).attr("width",(function(t,e){return l(h[e].x1)-l(h[e].x0)-1})).attr("height",function(t){return d(t[0])-d(t[1])}.bind(this))}}}},{key:"drawClustersTemporalDistributionHistogram",value:function(){if($("#clustersTemporalDistributionHistogramSVG").remove(),this.state.cluster>=0){for(var t=[],e=[],n=0;n<this.clusterCenters.length;n++)t.push(0),e.push(0);if("object"===jS(this.labels[0]))for(var r=0;r<this.labels.length;r++)this.labels[r].cluster===this.state.cluster&&(r-1>=0&&t[this.labels[r-1].cluster]++,r+1<this.labels.length&&e[this.labels[r+1].cluster]++);else for(var i=0;i<this.labels.length;i++)this.labels[i]===this.state.cluster&&(i-1>=0&&t[this.labels[i-1]]++,i+1<this.labels.length&&e[this.labels[i+1]]++);var a=k([k(t),k(e)]),o=$("#clusteringDetail"),s=Number(o.css("padding-left").slice(0,-2)),l=Number(o.css("padding-right").slice(0,-2)),u=o.width()-s-l-2*this.paddingCard,c=u/2,h=u/2*.6,d={left:20,right:10,top:15,bottom:20},f=se("#clustersTemporalDistributionHistogram").append("svg").attr("id","clustersTemporalDistributionHistogramSVG").attr("width",u).attr("height",h),p=Na().domain([-.5,this.clusterCenters.length-1+.5]).range([d.left,c-d.right]);f.append("g").attr("id","clusterBeforeHistogramAxisX").attr("transform","translate(0,"+(h-d.bottom)+")").call(V(p).ticks(this.clusterCenters.length)).selectAll("text").attr("font-size","0.5rem"),f.append("g").attr("id","clusterAfterHistogramAxisX").attr("transform","translate("+c+","+(h-d.bottom)+")").call(V(p).ticks(this.clusterCenters.length)).selectAll("text").attr("font-size","0.5rem");var m=Na().domain([0,a]).range([h-d.bottom,d.top]);f.append("g").attr("id","clusterBeforeHistogramAxisY").attr("transform","translate("+d.left+",0)").call(j(m).ticks(a<=5?a:Math.floor(a/3))).selectAll("text").attr("font-size","0.5rem"),f.append("g").attr("id","clusterAfterHistogramAxisY").attr("transform","translate("+(c+d.left)+",0)").call(j(m).ticks(a<=5?a:Math.floor(a/3))).selectAll("text").attr("font-size","0.5rem");var g=(c-d.left-d.right)/this.clusterCenters.length;f.append("g").attr("id","clusterBeforeHistogramRects").selectAll("rect").data(t).enter().append("rect").attr("id",(function(t,e){return"clusterBeforeHistogramRects_"+e})).attr("x",1).attr("transform",(function(t,e){return"translate("+p(e-.5)+","+m(t)+")"})).attr("width",g-1).attr("height",(function(t,e){return h-d.bottom-m(t)})).attr("fill",function(t,e){return Be(this.clusterColors[e][0],this.clusterColors[e][1],this.clusterColors[e][2])}.bind(this)),f.append("g").attr("id","clusterAfterHistogramRects").selectAll("rect").data(e).enter().append("rect").attr("id",(function(t,e){return"clusterAfterHistogramRects_"+e})).attr("x",1).attr("transform",(function(t,e){return"translate("+(c+p(e-.5))+","+m(t)+")"})).attr("width",g-1).attr("height",(function(t,e){return h-d.bottom-m(t)})).attr("fill",function(t,e){return Be(this.clusterColors[e][0],this.clusterColors[e][1],this.clusterColors[e][2])}.bind(this)),f.append("text").attr("x",c/2).attr("y",d.top/2).attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("Before Cluster "+this.state.cluster),f.append("text").attr("x",c+c/2).attr("y",d.top/2).attr("fill","black").attr("font-size","0.6rem").attr("text-anchor","middle").text("After Cluster "+this.state.cluster)}}},{key:"drawSparklinesTable",value:function(){var t=this;$("#subsequencesOverviewTable svg").remove(),this.state.cluster>=0&&function(){for(var e=$("#clusteringDetail"),n=Number(e.css("padding-left").slice(0,-2)),r=Number(e.css("padding-right").slice(0,-2)),i=e.width()-n-r-2*t.paddingCard,a=(i-30)/t.variables.length,o=a-6,s=[0,zc.getSubsequenceParameters().isometryLen],l={},u=0;u<t.variables.length;u++){l[t.variables[u]]=[1/0,-1/0];for(var c=0;c<t.SSCluster.length;c++)for(var h=0;h<t.SSCluster[c].length;h++)t.SSCluster[c][h][t.variables[u]]<l[t.variables[u]][0]&&(l[t.variables[u]][0]=t.SSCluster[c][h][t.variables[u]]),l[t.variables[u]][1]<t.SSCluster[c][h][t.variables[u]]&&(l[t.variables[u]][1]=t.SSCluster[c][h][t.variables[u]])}for(var d=Na().range([1,o-1]).domain(s),f={},p={},m=function(e){f[t.variables[e]]=Na().range([23,1]).domain(l[t.variables[e]]).nice(),p[t.variables[e]]=Qs().x((function(t,e){return d(e)})).y(function(t){return f[this.variables[e]](t[this.variables[e]])}.bind(t)).curve(ul.alpha(1))},g=0;g<t.variables.length;g++)m(g);for(var v={},y=0;y<t.datasetsIdx.length;y++){var b=lc.getPlotColor(t.datasetsIdx[y]);v[t.datasetsIdx[y]]=void 0!==b?b:"gray"}for(var x=0;x<t.variables.length;x++)se("#subsequencesOverviewTableTh_"+t.variables[x]).attr("width",a);se("#subsequencesOverviewTable").attr("height",Math.min(i,30*(t.SSCluster.length+1))),se("#subsequencesOverviewTableBody").attr("height",Math.min(i,30*t.SSCluster.length));for(var _=zc.getDatasets(),w={},S=0;S<_.length;S++)w[_[S]]=Ju.getData(_[S]).data.meta;for(var E=function(e){for(var n=t.SSCluster[e].id,r=t.SSCluster[e].idx,i=function(i){var a=se("#subsequenceDetailTd_"+n+"_"+r+"_"+t.variables[i]).append("svg").attr("id","subsequenceDetailSVG_"+n+"_"+r+"_"+t.variables[i]).attr("class","spark").attr("width",o).attr("height",24).append("g");a.datum(t.SSCluster[e]).append("path").attr("fill","none").attr("stroke",v[t.SSCluster[e].id]).attr("stroke-width",1.5).attr("d",function(t,e){return p[this.variables[i]](t)}.bind(t)),a.selectAll("circle").data(t.SSCluster[e].dataPoints.filter(function(t){return this.variables[i]in t}.bind(t))).enter().append("circle").attr("cx",function(t){var n=(t.z-this.SSCluster[e].dataPoints[0].z)/(this.SSCluster[e].dataPoints[this.SSCluster[e].dataPoints.length-1].z-this.SSCluster[e].dataPoints[0].z)*s[1];return d(n)}.bind(t)).attr("cy",function(t){var e=t[this.variables[i]];return this.subsequenceParameters.normalize||(e=(e-w[n].mean[this.variables[i]])/w[n].std[this.variables[i]]),f[this.variables[i]](e)}.bind(t)).attr("fill","white").attr("stroke","black").attr("stroke-width",.5).attr("r",1.2)},a=0;a<t.variables.length;a++)i(a)},M=0;M<t.SSCluster.length;M++)E(M)}()}},{key:"showSSStatus",value:function(){var t=zc.getSelectedSS(),e=zc.getUpdatedSS();for(var n in t)for(var r=0;r<t[n].length;r++){var i=t[n][r],a=$("#selectSSDetail_"+n+"_"+i);a.length>0&&a.prop("checked",!0)}for(var o in e)for(var s=0;s<e[o].length;s++){var l=e[o][s].idx,u=$("#subsequenceDetailTr_"+o+"_"+l);u.length>0&&("add"===e[o][s].status?u.addClass("table-success"):"remove"===e[o][s].status&&u.addClass("table-danger"))}}},{key:"onClickSSSelector",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]),a=zc.getSelectedSS(),o=zc.getUpdatedSS();if($("#"+t.target.id).prop("checked")){a[r].indexOf(i)<0&&(a[r].push(i),se("#subsequenceDetailTr_"+r+"_"+i).classed("table-danger",!1));for(var s=0;s<o[r].length;s++)if(o[r][s].idx===i){o[r].splice(s,1);break}}else a[r].splice(a[r].indexOf(i),1),o[r].push({idx:i,status:"remove"}),se("#subsequenceDetailTr_"+r+"_"+i).classed("table-danger",!0);Vb(a,o)}}}},{key:"onMouseOverSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){var n,r=$("#tooltipClusteringResults"),i=$("#tooltipClusteringResultsTable"),a=e.split("_"),o=Number(a[1]),s=Number(a[2]),l=0;for(l=0;l<this.subsequences.length;l++)if(this.subsequences[l].id===o&&this.subsequences[l].idx===s){n=this.subsequences[l];break}var u=Ju.getFileName(o),c=[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z],h=n.dataPoints.length,d=this.clusteringScores.silhouetteSS[l];i.html('<table><tbody><tr><td class="tooltipTableLabel">File name</td><td class="tooltipTableValues">'+u+'</td></tr><tr><td class="tooltipTableLabel">Period</td><td class="tooltipTableValues">'+Sd(c[0])+"-"+Sd(c[1])+'</td></tr><tr><td class="tooltipTableLabel">Data points number</td><td class="tooltipTableValues">'+h+'</td></tr><tr><td class="tooltipTableLabel">Silhouette coefficient</td><td class="tooltipTableValues">'+Sd(d)+"</td></tr></tbody></table>");var f=document.body.clientWidth-t.clientX+5,p=document.body.clientHeight-t.clientY+5;r.css({right:f+"px",bottom:p+"px",left:"unset",top:"unset"}),r.css("display","block");var m=[void 0,void 0];l-1>=0&&this.subsequences[l-1].id===this.subsequences[l].id&&(m[0]="object"===jS(this.labels[l-1])?this.labels[l-1].cluster:this.labels[l-1]),l+1<this.labels.length&&this.subsequences[l].id===this.subsequences[l+1].id&&(m[1]="object"===jS(this.labels[l+1])?this.labels[l+1].cluster:this.labels[l+1]),Eh(o,s,c,m),jb(o,c)}}}},{key:"onMouseOutSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){var n=e.split("_"),r=Number(n[1]),i=Number(n[2]);$("#tooltipClusteringResults").css("display","none"),Mh(r,i)}}}},{key:"onMouseDownSubsequenceDetailTr",value:function(){return function(t){if(this.queryMode=Rh.getMode(),"QBE"===this.queryMode||"QBS"===this.queryMode||$("#subsequenceComparisonNavLink").length>0&&$("#subsequenceComparisonNavLink").hasClass("active")){var e=t.target.id.split("_"),n=document.getElementById("subsequenceDetailTr_"+e[1]+"_"+e[2]);n&&(n.classList.add("drag"),this.clickedX=n.offsetLeft,this.clickedY=n.offsetTop,this.selectedTrId=n.id,this.selectedTrIdx=n.rowIndex,document.body.addEventListener("mousemove",this.onMouseMoveSubsequenceDetailTrFnc,!1),document.body.addEventListener("mouseup",this.onMouseUpSubsequenceDetailTrFnc,!1))}}}},{key:"onMouseMoveSubsequenceDetailTr",value:function(){return function(t){var e=document.getElementsByClassName("drag")[0];if(e){e.style.position="absolute",t.preventDefault(),e.style.top=t.pageY-this.clickedY+"px",e.style.left=t.pageX-this.clickedX-e.clientWidth/2-$("#extractionMenu").width()+"px";var n=$("#subsequenceComparisonNavLink");if("block"===$("#clusteringResultsLeftColumn").css("display")&&n.length>0&&n.hasClass("active")){var r=$("#subsequenceComparisonTab"),i=r.offset(),a=r.width()-Number($("#clusteringSubsequenceComparison").css("padding-left").replace("px",""))-Number($("#clusteringSubsequenceComparison").css("padding-right").replace("px","")),o=r.height();if(i.left<=t.pageX&&t.pageX<=i.left+a&&i.top<=t.pageY&&t.pageY<=i.top+o){var s=$("#clusteringSubsequenceComparison > .overlayHidingPanel");s.css("display","block"),s.css("width",a),s.css("height",o)}}else switch(this.queryMode){case"QBE":var l=$("#selectedTimeSliceView"),u=l.offset(),c=l.width(),h=l.height();if(u.left<=t.pageX&&t.pageX<=u.left+c&&u.top<=t.pageY&&t.pageY<=u.top+h){var d=$("#selectedTimeSliceView > .overlayHidingPanel");d.css("display","block"),d.css("width",Math.min(c,h)),d.css("height",Math.min(c,h))}break;case"QBS":var f=$("#QBSSketchPad"),p=f.offset(),m=f.width(),g=f.innerHeight();if(p.left<=t.pageX&&t.pageX<=p.left+m&&p.top<=t.pageY&&t.pageY<=p.top+g){var v=$("#QBSCanvasArea > .overlayHidingPanel");v.css("display","block"),v.css("width",Math.min(m,g)),v.css("height",Math.min(m,g))}}}}}},{key:"onMouseUpSubsequenceDetailTr",value:function(){return function(t){document.body.removeEventListener("mousemove",this.onMouseMoveSubsequenceDetailTrFnc,!1),document.body.removeEventListener("mouseup",this.onMouseUpSubsequenceDetailTrFnc,!1);var e=document.getElementsByClassName("drag")[0];e&&(e.classList.remove("drag"),e.style.position="static");for(var n=this.selectedTrId.split("_"),r=Number(n[1]),i=Number(n[2]),a=[0,0],o=0;o<this.SSCluster.length;o++)if(this.SSCluster[o].id===r&&this.SSCluster[o].idx===i){a[0]=this.SSCluster[o].dataPoints[0].z,a[1]=this.SSCluster[o].dataPoints[this.SSCluster[o].dataPoints.length-1].z;break}var s=$("#subsequenceComparisonNavLink");if("block"===$("#clusteringResultsLeftColumn").css("display")&&s.length>0&&s.hasClass("active")){$("#clusteringSubsequenceComparison > .overlayHidingPanel").css("display","none");var l=$("#subsequenceComparisonTab"),u=l.offset(),c=l.width()-Number($("#clusteringSubsequenceComparison").css("padding-left").replace("px",""))-Number($("#clusteringSubsequenceComparison").css("padding-right").replace("px","")),h=l.height();u.left<=t.pageX&&t.pageX<=u.left+c&&u.top<=t.pageY&&t.pageY<=u.top+h&&function(t,e,n){hu.dispatch({type:"SHOW_SELECTED_SUBSEQUENCE_IN_COMPARISON_PANEL",id:t,period:e,SSId:n})}(r,a,i)}else switch(this.queryMode){case"QBE":$("#selectedTimeSliceView > .overlayHidingPanel").css("display","none");var d=$("#selectedTimeSliceView"),f=d.offset(),p=d.width(),m=d.height();f&&f.left<=t.pageX&&t.pageX<=f.left+p&&f.top<=t.pageY&&t.pageY<=f.top+m&&(th(r,a,this.variables),Rh.getSource()!==r&&Promise.resolve().then((function(){pu(r),bh(!0),fu()})).then((function(){qc(r)})));break;case"QBS":$("#QBSCanvasArea > .overlayHidingPanel").css("display","none");var g=$("#QBSSketchPad"),v=g.offset(),y=g.width(),b=g.innerHeight();v&&v.left<=t.pageX&&t.pageX<=v.left+y&&v.top<=t.pageY&&t.pageY<=v.top+b&&th(r,a,this.variables)}this.moveToOriginalPos(),this.selectedTrId=void 0,this.selectedTrIdx=void 0}}},{key:"moveToOriginalPos",value:function(){var t=document.getElementById("subsequencesOverviewTable").rows[this.selectedTrIdx-1].id;if(t)$("#"+t).after($("#"+this.selectedTrId));else{var e=document.getElementById("subsequencesOverviewTable").rows[this.selectedTrIdx+1].id;$("#"+e).before($("#"+this.selectedTrId))}}},{key:"onDoubleClickSubsequenceDetailTr",value:function(){return function(t){var e=t.target.id;if(e){for(var n,r=e.split("_"),i=Number(r[1]),a=Number(r[2]),o=0;o<this.subsequences.length;o++)if(this.subsequences[o].id===i&&this.subsequences[o].idx===a){n=this.subsequences[o];break}$("#tooltipClusteringResults").css("display","none"),du("visualization"),Vu(i,[n.dataPoints[0].z,n.dataPoints[n.dataPoints.length-1].z])}}}}])&&HS(e.prototype,n),r&&HS(e,r),o}(i.a.Component);function QS(t){return(QS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function XS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ZS(t,e){return(ZS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function JS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tE(t);if(e){var i=tE(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return KS(this,n)}}function KS(t,e){return!e||"object"!==QS(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tE(t){return(tE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ZS(t,e)}(o,t);var e,n,r,a=JS(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).clusteringMethod="kmeans",e.subsequences=[],e.clusterCenters=[],e.labels=[],e.resultsSVGTmp=[],e}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{id:"clusteringResults",className:"clusteringPanel",style:{height:window.innerHeight-$("#appHeader").outerHeight(!0)}},i.a.createElement("div",{id:"clusteringResultsLeftColumn"},i.a.createElement("ul",{className:"nav nav-tabs",id:"clusteringResultsLeftColumnNavTabs"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{id:"filteringProcessNavLink",className:"nav-link active","data-toggle":"tab",href:"#filteringProcessTab"},"Filtering process")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{id:"subsequenceComparisonNavLink",className:"nav-link","data-toggle":"tab",href:"#subsequenceComparisonTab"},"Comparison")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{id:"clusteringHistoryNavLink",className:"nav-link","data-toggle":"tab",href:"#clusteringHistoryTab"},"History"))),i.a.createElement("div",{id:"clusteringResultsLeftColumnTabContent",className:"tab-content"},i.a.createElement("div",{className:"tab-pane fade show active",id:"filteringProcessTab"},i.a.createElement(v_,null)),i.a.createElement("div",{className:"tab-pane fade",id:"subsequenceComparisonTab"},i.a.createElement(RS,null)),i.a.createElement("div",{className:"tab-pane fade",id:"clusteringHistoryTab"},i.a.createElement(VS,null)))),i.a.createElement("div",{id:"clusteringResultsOverview"},i.a.createElement(Kx,null),i.a.createElement(l_,null)),i.a.createElement(YS,null),i.a.createElement("div",{className:"tooltip clusteringResults",id:"tooltipClusteringResults",style:{display:"none"}},i.a.createElement("canvas",{id:"tooltipClusteringResultsSubsequencesTTView",width:"150",height:"150",style:{width:"150px",height:"150px"}}),i.a.createElement("div",{id:"tooltipClusteringResultsTable"})),i.a.createElement("div",{className:"tooltip",id:"tooltipFeatureHeatmap",style:{display:"none"}}),i.a.createElement("div",{className:"popover fade show bs-popover-right",id:"sessionDetailInfo","x-placement":"right",style:{display:"none"}},i.a.createElement("div",{className:"arrow",style:{top:"24px"}}),i.a.createElement("h3",{className:"popover-header",id:"sessionDetailPopoverTitle"}),i.a.createElement("div",{className:"popover-body",id:"sessionDetailPopoverBody"})))}},{key:"componentDidMount",value:function(){}}])&&XS(e.prototype,n),r&&XS(e,r),o}(i.a.Component);function nE(t){return(nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function iE(t,e){return(iE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function aE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=sE(t);if(e){var i=sE(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return oE(this,n)}}function oE(t,e){return!e||"object"!==nE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sE(t){return(sE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&iE(t,e)}(o,t);var e,n,r,a=aE(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a.call(this)).state={queryMode:Rh.getMode(),showQBESource:!1,resultsPanel:"featureExtraction"},e}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this,e=window.innerHeight-$("#appHeader").outerHeight(!0);$("#mainFeatureArea").height(e),Rh.on("switchQueryMode",(function(e){if(setTimeout((function(){return t.setState({queryMode:e})})),"QBE"===e){$("#extractionResults").css({width:"70%"});var n=window.innerHeight-$("#appHeader").outerHeight(!0);$("#extractionResults").height(n)}else if("Clustering"===e)$("#clusteringResults").css({width:"70%"});else{$("#extractionResults").css({width:"70%"});var r=window.innerHeight-$("#appHeader").outerHeight(!0);$("#extractionResults").height(r)}t.showResultsPanel(e)})),Rh.on("setExtractionResults",(function(){$("#extractionResults").css({width:"70%"}),t.setState({resultsPanel:"featureExtraction"})})),Rh.on("recoverQuery",(function(e){var n=Rh.getMode();t.setState({queryMode:n}),"QBE"===n?($("#extractionResults").css({width:"70%"}),t.setState({resultsPanel:"featureExtraction"})):"Clustering"===n?($("#clusteringResults").css({width:"70%"}),t.setState({resultsPanel:"clustering"})):($("#extractionResults").css({width:"70%"}),t.setState({resultsPanel:"featureExtraction"}))})),Rh.on("setQuery",(function(){"featureExtraction"!==t.state.resultsPanel&&t.setState({resultsPanel:"featureExtraction"})})),Su.on("showExtractionSourcePanel",(function(e){"default"!==e&&Number(e)>=0?($("#extractionResults").css({width:"40%"}),t.setState({showQBESource:!0,resultsPanel:"featureExtraction"})):t.setState({showQBESource:!1})})),Su.on("showResultsPanel",(function(e){t.setState({resultsPanel:e})}))}},{key:"showResultsPanel",value:function(t){var e;e=$("#clusteringTimelineArea").length>0?"AE"===t?"featureExtraction":"clustering":"Clustering"===t?"clustering":"featureExtraction",this.setState({resultsPanel:e})}},{key:"render",value:function(){var t,e;return this.state.showQBESource&&(t=i.a.createElement(Wx,null)),"clustering"===this.state.resultsPanel?e=i.a.createElement(eE,null):"featureExtraction"===this.state.resultsPanel&&(e=i.a.createElement(Nx,null)),i.a.createElement("div",{className:"contents",id:"mainFeatureArea",style:{display:"flex"}},i.a.createElement(rx,null),t,e)}}])&&rE(e.prototype,n),r&&rE(e,r),o}(i.a.Component);function uE(t){return(uE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hE(t,e){return(hE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=pE(t);if(e){var i=pE(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fE(this,n)}}function fE(t,e){return!e||"object"!==uE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pE(t){return(pE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hE(t,e)}(o,t);var e,n,r,a=dE(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),a.call(this)}return e=o,(n=[{key:"render",value:function(){return i.a.createElement("div",{className:"container"},this.overview(),this.demoVideo(),this.github(),this.authors())}},{key:"overview",value:function(){return i.a.createElement("div",{className:"aboutContainer"},i.a.createElement("h2",null,"TimeTubesX"),i.a.createElement("p",{style:{marginLeft:"2rem",marginRight:"2rem"}},"TimeTubes Web is a web-based visualization tool for BLAZAR observation data. It visualized observation time stamp and 6 variables simultaneously. It is helpful for the astronomers to analyze time variations of and correlations among intensity, polarization, and color of the light from blazars. It supports visual comparison of multiple datasets, feature extractions, etc."),i.a.createElement("p",null,"For more detail information about TimeTubes project, please refer our prior papers."),i.a.createElement("ul",null,i.a.createElement("li",null,"Naoko Sawada, Masanori Nakayama, Makoto Uemura, and Issei Fujishiro. TimeTubes: Automatic Extraction of Observable Blazar Features from Long-Term, Multi-Dimensional Datasets, in ",i.a.createElement("em",null,"Proceedings of 2018 IEEE Scientific Visualization Conference (SciVis),")," Berlin, Germany, DOI: 10.1109/SciVis.2018.8823802, October 2018.",i.a.createElement("a",{href:"https://ieeexplore.ieee.org/document/8823802"},"IEEE Xplore")),i.a.createElement("li",null,"Issei Fujishiro, Naoko Sawada, Masanori Nakayama, Hsiang-Yun Wu, Kazuho Watanabe, Shigeo Takahashi, and Makoto Uemura. TimeTubes: Visual Exploration of Observed Blazar Datasets,",i.a.createElement("em",null,"Journal of Physics: Conference Series (JPCS),"),"Vol. 1036, No. 1, Article No. 012011, DOI: 10.1088/1742-6596/1036/1/012011, Kyoto, Japan, 2018.",i.a.createElement("a",{href:"http://iopscience.iop.org/article/10.1088/1742-6596/1036/1/012011"},"IOPscience")),i.a.createElement("li",null,"Makoto Uemura, Ryosuke Itoh, Ioannis Liodakis, Dmitry Blinov, Masanori Nakayama, Longyin Xu, Naoko Sawada, Hsiang-Yun Wu, Issei Fujishiro. Optical polarization variations in the blazar PKS 1749+096,",i.a.createElement("em",null,"Publications of the Astronomical Society of Japan (PASJ),")," Vol. 69, No. 6, Article No. 96, DOI: 10.1093/pasj/psx111, November 2017.",i.a.createElement("a",{href:"https://academic.oup.com/pasj/article/69/6/96/4609697"},"Oxford Academic")),i.a.createElement("li",null,"Naoko Sawada, Masanori Nakayama, Hsiang-Yun Wu, Makoto Uemura, and Issei Fujishiro. TimeTubes: Visual Fusion and Validation for Ameliorating Uncertainty of Blazar Datasets from Different Observatories, Short papers, in ",i.a.createElement("em",null,"Proceedings of the Computer Graphics International Conference (CGI 2017),")," Article No. 14, Yokohama, Japan, DOI: 10.1145/3095140.3095154, June 2017.",i.a.createElement("a",{href:"http://dl.acm.org/citation.cfm?id=3095154"},"ACM Digital Library"))))}},{key:"demoVideo",value:function(){return i.a.createElement("div",{className:"aboutContainer"},i.a.createElement("h2",null,"Demo Videos"),i.a.createElement("h4",null,"Conventional Visualization in Astronomy"),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/izChQ4uKksQ",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("h4",null,"Automatic Feature Extraction"),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/B-0vTcWEc0s",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/L-5wIOhKko8",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/Ye7bqzJIjG4",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("h4",null,"Interactive Feature Extraction"),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/NmSI1F3qKwY",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/0o1kqOZ4eBk",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/8vGVtYPibqo",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("h4",null,"Auxiliary Functions"),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/CEMEJ9KDIpk",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),i.a.createElement("iframe",{width:"448",height:"252",src:"https://www.youtube.com/embed/J0VlciD_ohs",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))}},{key:"github",value:function(){return i.a.createElement("div",{className:"aboutContainer"},i.a.createElement("h2",null,"Source code"),i.a.createElement("p",null,"All the source code of TimeTubesX is publicly accessible and open-source."),i.a.createElement("img",{className:"aboutIcons",src:"../../img/GitHub-Mark-120px-plus.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://github.com/MistletoeNaoko/TimeTubesWeb"},"https://github.com/MistletoeNaoko/TimeTubesWeb"))}},{key:"authors",value:function(){return i.a.createElement("div",{className:"aboutContainer"},i.a.createElement("h2",null,"Authors"),i.a.createElement("div",{className:"authorList"},i.a.createElement("h4",null,"Naoko Sawada"),i.a.createElement("p",null,"Ph.D Student at Keio University, visiting scholar in Visual Computing Group (VCG) at Harvard University (2018-2020)"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://mistletoenaoko.github.io/"},"https://mistletoenaoko.github.io/"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/Twitter_Logo_Blue.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://twitter.com/NaokoVis"},"NaokoVis"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"mailto:naoko.sawada@fj.ics.keio.ac.jp"},"Email")),i.a.createElement("div",{className:"authorList"},i.a.createElement("h4",null,"Makoto Uemura"),i.a.createElement("p",null,"Associate Professor in Hiroshima Astrophysical Science Center (HASC) at Hiroshima University"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://home.hiroshima-u.ac.jp/uemuram/"},"https://home.hiroshima-u.ac.jp/uemuram/")),i.a.createElement("div",{className:"authorList"},i.a.createElement("h4",null,"Johanna Beyer"),i.a.createElement("p",null,"Research Associate in Visual Computing Group (VCG) at Harvard University"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://johanna-b.github.io/"},"https://johanna-b.github.io/"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"mailto:jbeyer@g.harvard.edu"},"Email")),i.a.createElement("div",{className:"authorList"},i.a.createElement("h4",null,"Hanspeter Pfister"),i.a.createElement("p",null,"An Wang Professor of Computer Science at Harvard University"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://vcg.seas.harvard.edu/"},"https://vcg.seas.harvard.edu/"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/Twitter_Logo_Blue.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"https://twitter.com/hpfister"},"hpfister"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"mailto:pfister@seas.harvard.edu"},"Email")),i.a.createElement("div",{className:"authorList"},i.a.createElement("h4",null,"Issei Fujishiro"),i.a.createElement("p",null,"Professor of Information and Computer Science at Keio University, Adjunct Professor at School of Computer Science and Engineering at Hangzhou Dianzi University"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/website.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"http://fj.ics.keio.ac.jp/"},"http://fj.ics.keio.ac.jp/"),i.a.createElement("img",{className:"aboutIcons",src:"../../img/mail.png",width:"20px",height:"20px"}),i.a.createElement("a",{href:"mailto:fuji@ics.keio.ac.jp"},"Email")))}}])&&cE(e.prototype,n),r&&cE(e,r),o}(i.a.Component);function gE(t){return(gE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yE(t,e){return(yE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_E(t);if(e){var i=_E(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xE(this,n)}}function xE(t,e){return!e||"object"!==gE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _E(t){return(_E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yE(t,e)}(o,t);var e,n,r,a=bE(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),t=a.call(this);var e=dh("privateComment");return Array.isArray(e)&&(e=ch()),t.state={privateComments:e,selectedComment:{},selectedQuery:{},selectedCommentId:"",selectedQueryId:""},t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;$("#privateCommentTable").tablesorter(),Su.on("selectMenu",(function(e){"comment"===e&&t.setState({privateComments:dh("privateComment")})}))}},{key:"privateCommentListTr",value:function(){var t=[];if(this.state.privateComments)for(var e in this.state.privateComments){var n=this.state.privateComments[e].labelColor.replace("0x","#");t.push(i.a.createElement("tr",{key:e,className:"privateCommentBody",id:e,onClick:this.onClickCommentTableRow.bind(this)},i.a.createElement("td",{style:{textAlign:"center"}},i.a.createElement("input",{type:"checkbox",className:e+" selectComment",name:"privateCommentSelector"})),i.a.createElement("td",{style:{textAlign:"center"}},i.a.createElement("span",{style:{color:n}},"")),i.a.createElement("td",null,this.state.privateComments[e].timeStamp.toLocaleString("en-US")),i.a.createElement("td",null,this.state.privateComments[e].fileName),i.a.createElement("td",null,this.state.privateComments[e].start),i.a.createElement("td",null,this.state.privateComments[e].comment),i.a.createElement("td",null,this.state.privateComments[e].userName)))}return t}},{key:"commentDetailTr",value:function(){var t=[];for(var e in this.state.selectedComment)"labelColor"===e?t.push(i.a.createElement("tr",{key:e,className:"commentDetailTableTr",id:e},i.a.createElement("td",null,"Label"),i.a.createElement("td",null,i.a.createElement("span",{style:{color:this.state.selectedComment[e].replace("0x","#")}},"")))):"query"!==e&&"parameters"!==e&&"queryId"!==e&&t.push(i.a.createElement("tr",{key:e,className:"commentDetailTableTr",id:e},i.a.createElement("td",null,wh(e)),i.a.createElement("td",null,this.state.selectedComment[e])));return t}},{key:"queryDetailTr",value:function(){var t=[];for(var e in this.state.selectedQuery)"object"!==gE(this.state.selectedQuery[e])&&t.push(i.a.createElement("tr",{key:e,className:"queryDetailTableTr",id:e},i.a.createElement("td",null,wh(e)),i.a.createElement("td",null,this.state.selectedQuery[e])));for(var n in this.state.selectedQuery.query)if("path"!==n&&"controlPoints"!==n){var r=this.state.selectedQuery.query[n];if(Array.isArray(this.state.selectedQuery.query[n])&&this.state.selectedQuery.query[n].length>1)if(Number(this.state.selectedQuery.query[n][0])){r="";for(var a=0;a<this.state.selectedQuery.query[n].length;a++)r+=Sd(Number(this.state.selectedQuery.query[n][a]))+", ";r=r.substr(0,r.length-2)}else r=r.join(", ");t.push(i.a.createElement("tr",{key:n,className:"queryDetailTableTr",id:n},i.a.createElement("td",null,wh(n)),i.a.createElement("td",null,r)))}return t}},{key:"queryParametersDetailTr",value:function(){var t=[];for(var e in this.state.selectedQuery.parameters){var n="DTWType"===e?"DTW Type":wh(e),r="boolean"==typeof this.state.selectedQuery.parameters[e]?this.state.selectedQuery.parameters[e].toString():this.state.selectedQuery.parameters[e];if(Array.isArray(r)){for(var a="",o=0;o<r.length;o++)a+=Sd(Number(r[o]))+", ";r=a=a.substr(0,a.length-2)}t.push(i.a.createElement("tr",{key:e,className:"queryParameterDetailTableTr",id:e},i.a.createElement("td",null,n),i.a.createElement("td",null,r)))}return t}},{key:"onClickCommentTableRow",value:function(t){this.updateCommentDetail(t.target.parentNode.id)}},{key:"updateCommentDetail",value:function(t){var e=ph(t);if(e){var n=function(t){return uh[t]?uh[t]:{}}(e.queryId);this.setState({selectedCommentId:t,selectedComment:e,selectedQueryId:e.queryId,selectedQuery:n})}}},{key:"privateCommentListHeader",value:function(){return i.a.createElement("thead",null,i.a.createElement("tr",{id:"privateCommentHeader"},i.a.createElement("th",{className:"col-1"},"Select"),i.a.createElement("th",{className:"col-1"},"Label"),i.a.createElement("th",{className:"col-2 num",value:"timeStamp"},"Date (GMT)"),i.a.createElement("th",{className:"col-2 case",value:"fileName"},"File name"),i.a.createElement("th",{className:"col-1 num",value:"start"},"JD"),i.a.createElement("th",{className:"col-3",value:"comment"},"Comment"),i.a.createElement("th",{className:"col-2 case",value:"userName"},"User name")))}},{key:"getSelectedPrivateComment",value:function(){for(var t=$("input[name=privateCommentSelector]:checked"),e=[],n=0;n<t.length;n++)e.push($(t[n]).attr("class").split(" ")[0]);return e}},{key:"editPrivateComment",value:function(){}},{key:"deletePrivateComment",value:function(t){for(var e=this.getSelectedPrivateComment(),n=!1,r=0;r<e.length;r++)fh(e[r]),e[r]===this.state.selectedCommentId&&(n=!0);n?this.setState({privateComments:dh("privateComment"),selectedCommentId:"",selectedComment:{},selectedQueryId:"",selectedQuery:{}}):this.setState({privateComments:dh("privateComment")}),bc()}},{key:"deleteThisComment",value:function(){fh(this.state.selectedCommentId),this.setState({privateComments:dh("privateComment"),selectedCommentId:"",selectedComment:{},selectedQueryId:"",selectedQuery:{}}),bc()}},{key:"recoverTheQuery",value:function(){if(Object.keys(this.state.selectedQuery).length>0){var t=!0;"visual query"===this.state.selectedQuery.mode&&"query-by-example"===this.state.selectedQuery.option?Ju.getIdFromName(this.state.selectedQuery.query.source)<0&&(alert("You have to open the file whose file name is "+this.state.selectedQuery.query.source+"to recover the query-by-example."),t=!1):"visual query"===this.state.selectedQuery.mode&&this.state.selectedQuery.option,t&&("visual query"===this.state.selectedQuery.mode&&"query-by-example"===this.state.selectedQuery.option?Promise.resolve().then(function(){pu(Ju.getIdFromName(this.state.selectedQuery.query.source))}.bind(this)).then(function(){ah(this.state.selectedQuery),du("feature")}.bind(this)):(ah(this.state.selectedQuery),du("feature")))}else Object.keys(this.state.selectedComment).length>0?alert("No query information is stored with this comment."):alert("Please select a comment from the left table.")}},{key:"exportPrivateComment",value:function(){!function(t){for(var e=[],n=[],r=0;r<t.length;r++){var i=lh[t[r]];e.push(i),n.indexOf(i.queryId)<0&&n.push(uh[i.queryId])}var a={comments:e,query:n};a=JSON.stringify(a,null,"\t");var o="privateComment_"+mh()+".json",s=new Blob([a],{type:"application/json"}),l=(window.URL||window.webkitURL).createObjectURL(s),u=document.createElement("a");u.download=decodeURI(o),u.href=l,u.click()}(this.getSelectedPrivateComment())}},{key:"selectAllPrivateComment",value:function(){var t=$("#selectAllPrivateCommentBtn").text(),e=$("input[name=privateCommentSelector]");"Select All"===t?(e.prop("checked",!0),$("#selectAllPrivateCommentBtn").text("Deselect All")):"Deselect All"===t&&(e.prop("checked",!1),$("#selectAllPrivateCommentBtn").text("Select All"))}},{key:"render",value:function(){var t=this.privateCommentListHeader(),e=this.privateCommentListTr(),n=this.commentDetailTr(),r=this.queryDetailTr(),a=this.queryParametersDetailTr();return i.a.createElement("div",{className:"contents commentRow",id:"mainCommentsArea"},i.a.createElement("div",{className:"commentColumn",id:"commentTableArea"},i.a.createElement("ul",{className:"nav nav-tabs"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link active","data-toggle":"tab",href:"#private"},"Private comments")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link disabled","data-toggle":"tab",href:"#public"},"Public comments"))),i.a.createElement("div",{id:"myTabContent",className:"tab-content"},i.a.createElement("div",{className:"tab-pane fade active show commentsArea",id:"private"},i.a.createElement("div",{id:"privateCommentMenu",style:{float:"right",marginBottom:"15px"}},i.a.createElement("button",{className:"btn btn-danger btn-sm",type:"button",id:"deleteCommentBtn",onClick:this.deletePrivateComment.bind(this)},"Delete"),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"selectAllPrivateCommentBtn",onClick:this.selectAllPrivateComment.bind(this)},"Select All"),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"exportPrivateCommentBtn",onClick:this.exportPrivateComment.bind(this)},"Export")),i.a.createElement("table",{id:"privateCommentTable",className:"table table-hover tablesorter"},t,i.a.createElement("tbody",{id:"privateCommentBody"},e))),i.a.createElement("div",{className:"tab-pane fade commentsArea",id:"public"},"Public comments will be here."))),i.a.createElement("div",{className:"commentColumn",id:"commentDetailArea"},i.a.createElement("div",{id:"commentMenu",style:{float:"right",marginBottom:"15px"}},i.a.createElement("button",{className:"btn btn-danger btn-sm",type:"button",id:"deleteThisCommentBtn",onClick:this.deleteThisComment.bind(this)},"Delete this comment"),i.a.createElement("button",{className:"btn btn-primary btn-sm",type:"button",id:"recoverTheQueryBtn",onClick:this.recoverTheQuery.bind(this)},"Recover the query")),i.a.createElement("div",{style:{clear:"both"}}),i.a.createElement("h5",null,"Comment"),i.a.createElement("table",{id:"commentDetailTable",className:"table table-hover"},i.a.createElement("tbody",{id:"commentDetailBody"},n)),i.a.createElement("h5",null,"Query"),i.a.createElement("table",{id:"queryDetailTable",className:"table table-hover"},i.a.createElement("tbody",{id:"queryDetailBody"},r)),i.a.createElement("table",{id:"queryParametersDetailTable",className:"table table-hover"},i.a.createElement("tbody",{id:"queryParametersDetailBody"},a))))}}])&&vE(e.prototype,n),r&&vE(e,r),o}(i.a.Component);function SE(t){return(SE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function EE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ME(t,e){return(ME=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function CE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=kE(t);if(e){var i=kE(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return TE(this,n)}}function TE(t,e){return!e||"object"!==SE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kE(t){return(kE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var PE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ME(t,e)}(o,t);var e,n,r,a=CE(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).state={menu:"visualization"},t.selectMainView("visualization"),t}return e=o,(n=[{key:"componentDidMount",value:function(){var t=this;Su.on("selectMenu",(function(e){t.selectMainView(e),scrollTo(0,0),t.setState({menu:e})})),Rh.on("recoverQuery",(function(e){setTimeout(function(){this.setState({menu:"feature"})}.bind(t),0)}))}},{key:"selectMainView",value:function(t){switch(t){case"about":$("body").css("overflow-y","scroll");break;case"visualization":case"feature":$("body").css("overflow-y","hidden");break;case"comment":$("body").css("overflow-y","scroll")}}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(Au,null),i.a.createElement("div",{className:"maincontainer",id:"about",style:{display:"about"===this.state.menu?"block":"none",height:$(window).height()-$("#appHeader").outerHeight()}},i.a.createElement(mE,null)),i.a.createElement("div",{className:"maincontainer",id:"visualization",style:{display:"visualization"===this.state.menu?"block":"none"}},i.a.createElement(Zd,null)),i.a.createElement("div",{className:"maincontainer",id:"featureExtraction",style:{display:"feature"===this.state.menu?"block":"none"}},i.a.createElement(lE,null)),i.a.createElement("div",{className:"maincontainer",id:"fuserComments",style:{display:"comment"===this.state.menu?"block":"none"}},i.a.createElement(wE,null)))}}])&&EE(e.prototype,n),r&&EE(e,r),o}(i.a.Component),AE=document.getElementById("app");o.a.render(i.a.createElement(PE,null),AE),null!==localStorage.getItem("privateComment")&&"[]"!==localStorage.getItem("privateComment")||localStorage.setItem("privateComment",JSON.stringify({})),Array.isArray(JSON.parse(localStorage.getItem("privateComment")))&&ch(),null!==localStorage.getItem("queryTable")&&"[]"!==localStorage.getItem("queryTable")||localStorage.setItem("queryTable",JSON.stringify({})),null===sessionStorage.getItem("clusteringHistory")&&sessionStorage.setItem("clusteringHistory",JSON.stringify({}))}]);